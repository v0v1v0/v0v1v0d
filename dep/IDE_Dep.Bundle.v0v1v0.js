/*! For license information please see IDE_Dep.Bundle.v0v1v0.js.LICENSE.txt */
(()=>{var __webpack_modules__={616:e=>{var t;self,t=()=>(()=>{"use strict";var e,t={};return e=t,Object.defineProperty(e,"__esModule",{value:!0}),e.FitAddon=void 0,e.FitAddon=class{activate(e){this._terminal=e}dispose(){}fit(){const e=this.proposeDimensions();if(!e||!this._terminal||isNaN(e.cols)||isNaN(e.rows))return;const t=this._terminal._core;this._terminal.rows===e.rows&&this._terminal.cols===e.cols||(t._renderService.clear(),this._terminal.resize(e.cols,e.rows))}proposeDimensions(){if(!this._terminal)return;if(!this._terminal.element||!this._terminal.element.parentElement)return;const e=this._terminal._core,t=e._renderService.dimensions;if(0===t.css.cell.width||0===t.css.cell.height)return;const i=0===this._terminal.options.scrollback?0:e.viewport.scrollBarWidth,n=window.getComputedStyle(this._terminal.element.parentElement),s=parseInt(n.getPropertyValue("height")),r=Math.max(0,parseInt(n.getPropertyValue("width"))),o=window.getComputedStyle(this._terminal.element),a=s-(parseInt(o.getPropertyValue("padding-top"))+parseInt(o.getPropertyValue("padding-bottom"))),l=r-(parseInt(o.getPropertyValue("padding-right"))+parseInt(o.getPropertyValue("padding-left")))-i;return{cols:Math.max(2,Math.floor(l/t.css.cell.width)),rows:Math.max(1,Math.floor(a/t.css.cell.height))}}},t})(),e.exports=t()},856:e=>{var t;globalThis,t=()=>(()=>{"use strict";var e={4567:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.AccessibilityManager=void 0;const r=i(9042),o=i(9924),a=i(844),l=i(4725),c=i(2585),h=i(3656);let d=t.AccessibilityManager=class extends a.Disposable{constructor(e,t,i,n){super(),this._terminal=e,this._coreBrowserService=i,this._renderService=n,this._rowColumns=new WeakMap,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=this._coreBrowserService.mainDocument.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=this._coreBrowserService.mainDocument.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let e=0;e<this._terminal.rows;e++)this._rowElements[e]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[e]);if(this._topBoundaryFocusListener=e=>this._handleBoundaryFocus(e,0),this._bottomBoundaryFocusListener=e=>this._handleBoundaryFocus(e,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=this._coreBrowserService.mainDocument.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new o.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize((e=>this._handleResize(e.rows)))),this.register(this._terminal.onRender((e=>this._refreshRows(e.start,e.end)))),this.register(this._terminal.onScroll((()=>this._refreshRows()))),this.register(this._terminal.onA11yChar((e=>this._handleChar(e)))),this.register(this._terminal.onLineFeed((()=>this._handleChar("\n")))),this.register(this._terminal.onA11yTab((e=>this._handleTab(e)))),this.register(this._terminal.onKey((e=>this._handleKey(e.key)))),this.register(this._terminal.onBlur((()=>this._clearLiveRegion()))),this.register(this._renderService.onDimensionsChange((()=>this._refreshRowsDimensions()))),this.register((0,h.addDisposableDomListener)(document,"selectionchange",(()=>this._handleSelectionChange()))),this.register(this._coreBrowserService.onDprChange((()=>this._refreshRowsDimensions()))),this._refreshRows(),this.register((0,a.toDisposable)((()=>{this._accessibilityContainer.remove(),this._rowElements.length=0})))}_handleTab(e){for(let t=0;t<e;t++)this._handleChar(" ")}_handleChar(e){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==e&&(this._charsToAnnounce+=e):this._charsToAnnounce+=e,"\n"===e&&(this._liveRegionLineCount++,21===this._liveRegionLineCount&&(this._liveRegion.textContent+=r.tooMuchOutput)))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0}_handleKey(e){this._clearLiveRegion(),/\p{Control}/u.test(e)||this._charsToConsume.push(e)}_refreshRows(e,t){this._liveRegionDebouncer.refresh(e,t,this._terminal.rows)}_renderRows(e,t){const i=this._terminal.buffer,n=i.lines.length.toString();for(let s=e;s<=t;s++){const e=i.lines.get(i.ydisp+s),t=[],r=e?.translateToString(!0,void 0,void 0,t)||"",o=(i.ydisp+s+1).toString(),a=this._rowElements[s];a&&(0===r.length?(a.innerText="Â ",this._rowColumns.set(a,[0,1])):(a.textContent=r,this._rowColumns.set(a,t)),a.setAttribute("aria-posinset",o),a.setAttribute("aria-setsize",n))}this._announceCharacters()}_announceCharacters(){0!==this._charsToAnnounce.length&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(e,t){const i=e.target,n=this._rowElements[0===t?1:this._rowElements.length-2];if(i.getAttribute("aria-posinset")===(0===t?"1":`${this._terminal.buffer.lines.length}`))return;if(e.relatedTarget!==n)return;let s,r;if(0===t?(s=i,r=this._rowElements.pop(),this._rowContainer.removeChild(r)):(s=this._rowElements.shift(),r=i,this._rowContainer.removeChild(s)),s.removeEventListener("focus",this._topBoundaryFocusListener),r.removeEventListener("focus",this._bottomBoundaryFocusListener),0===t){const e=this._createAccessibilityTreeNode();this._rowElements.unshift(e),this._rowContainer.insertAdjacentElement("afterbegin",e)}else{const e=this._createAccessibilityTreeNode();this._rowElements.push(e),this._rowContainer.appendChild(e)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(0===t?-1:1),this._rowElements[0===t?1:this._rowElements.length-2].focus(),e.preventDefault(),e.stopImmediatePropagation()}_handleSelectionChange(){if(0===this._rowElements.length)return;const e=document.getSelection();if(!e)return;if(e.isCollapsed)return void(this._rowContainer.contains(e.anchorNode)&&this._terminal.clearSelection());if(!e.anchorNode||!e.focusNode)return void console.error("anchorNode and/or focusNode are null");let t={node:e.anchorNode,offset:e.anchorOffset},i={node:e.focusNode,offset:e.focusOffset};if((t.node.compareDocumentPosition(i.node)&Node.DOCUMENT_POSITION_PRECEDING||t.node===i.node&&t.offset>i.offset)&&([t,i]=[i,t]),t.node.compareDocumentPosition(this._rowElements[0])&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_FOLLOWING)&&(t={node:this._rowElements[0].childNodes[0],offset:0}),!this._rowContainer.contains(t.node))return;const n=this._rowElements.slice(-1)[0];if(i.node.compareDocumentPosition(n)&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_PRECEDING)&&(i={node:n,offset:n.textContent?.length??0}),!this._rowContainer.contains(i.node))return;const s=({node:e,offset:t})=>{const i=e instanceof Text?e.parentNode:e;let n=parseInt(i?.getAttribute("aria-posinset"),10)-1;if(isNaN(n))return console.warn("row is invalid. Race condition?"),null;const s=this._rowColumns.get(i);if(!s)return console.warn("columns is null. Race condition?"),null;let r=t<s.length?s[t]:s.slice(-1)[0]+1;return r>=this._terminal.cols&&(++n,r=0),{row:n,column:r}},r=s(t),o=s(i);if(r&&o){if(r.row>o.row||r.row===o.row&&r.column>=o.column)throw new Error("invalid range");this._terminal.select(r.column,r.row,(o.row-r.row)*this._terminal.cols-r.column+o.column)}}_handleResize(e){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let e=this._rowContainer.children.length;e<this._terminal.rows;e++)this._rowElements[e]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[e]);for(;this._rowElements.length>e;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const e=this._coreBrowserService.mainDocument.createElement("div");return e.setAttribute("role","listitem"),e.tabIndex=-1,this._refreshRowDimensions(e),e}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let e=0;e<this._terminal.rows;e++)this._refreshRowDimensions(this._rowElements[e])}}_refreshRowDimensions(e){e.style.height=`${this._renderService.dimensions.css.cell.height}px`}};t.AccessibilityManager=d=n([s(1,c.IInstantiationService),s(2,l.ICoreBrowserService),s(3,l.IRenderService)],d)},3614:(e,t)=>{function i(e){return e.replace(/\r?\n/g,"\r")}function n(e,t){return t?"[200~"+e+"[201~":e}function s(e,t,s,r){e=n(e=i(e),s.decPrivateModes.bracketedPasteMode&&!0!==r.rawOptions.ignoreBracketedPasteMode),s.triggerDataEvent(e,!0),t.value=""}function r(e,t,i){const n=i.getBoundingClientRect(),s=e.clientX-n.left-10,r=e.clientY-n.top-10;t.style.width="20px",t.style.height="20px",t.style.left=`${s}px`,t.style.top=`${r}px`,t.style.zIndex="1000",t.focus()}Object.defineProperty(t,"__esModule",{value:!0}),t.rightClickHandler=t.moveTextAreaUnderMouseCursor=t.paste=t.handlePasteEvent=t.copyHandler=t.bracketTextForPaste=t.prepareTextForTerminal=void 0,t.prepareTextForTerminal=i,t.bracketTextForPaste=n,t.copyHandler=function(e,t){e.clipboardData&&e.clipboardData.setData("text/plain",t.selectionText),e.preventDefault()},t.handlePasteEvent=function(e,t,i,n){e.stopPropagation(),e.clipboardData&&s(e.clipboardData.getData("text/plain"),t,i,n)},t.paste=s,t.moveTextAreaUnderMouseCursor=r,t.rightClickHandler=function(e,t,i,n,s){r(e,t,i),s&&n.rightClickSelect(e),t.value=n.selectionText,t.select()}},7239:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorContrastCache=void 0;const n=i(1505);t.ColorContrastCache=class{constructor(){this._color=new n.TwoKeyMap,this._css=new n.TwoKeyMap}setCss(e,t,i){this._css.set(e,t,i)}getCss(e,t){return this._css.get(e,t)}setColor(e,t,i){this._color.set(e,t,i)}getColor(e,t){return this._color.get(e,t)}clear(){this._color.clear(),this._css.clear()}}},3656:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addDisposableDomListener=void 0,t.addDisposableDomListener=function(e,t,i,n){e.addEventListener(t,i,n);let s=!1;return{dispose:()=>{s||(s=!0,e.removeEventListener(t,i,n))}}}},3551:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Linkifier=void 0;const r=i(3656),o=i(8460),a=i(844),l=i(2585),c=i(4725);let h=t.Linkifier=class extends a.Disposable{get currentLink(){return this._currentLink}constructor(e,t,i,n,s){super(),this._element=e,this._mouseService=t,this._renderService=i,this._bufferService=n,this._linkProviderService=s,this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new o.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new o.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,a.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,a.toDisposable)((()=>{this._lastMouseEvent=void 0,this._activeProviderReplies?.clear()}))),this.register(this._bufferService.onResize((()=>{this._clearCurrentLink(),this._wasResized=!0}))),this.register((0,r.addDisposableDomListener)(this._element,"mouseleave",(()=>{this._isMouseOut=!0,this._clearCurrentLink()}))),this.register((0,r.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,r.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,r.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(e){this._lastMouseEvent=e;const t=this._positionFromMouseEvent(e,this._element,this._mouseService);if(!t)return;this._isMouseOut=!1;const i=e.composedPath();for(let e=0;e<i.length;e++){const t=i[e];if(t.classList.contains("xterm"))break;if(t.classList.contains("xterm-hover"))return}this._lastBufferCell&&t.x===this._lastBufferCell.x&&t.y===this._lastBufferCell.y||(this._handleHover(t),this._lastBufferCell=t)}_handleHover(e){if(this._activeLine!==e.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(e,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,e)||(this._clearCurrentLink(),this._askForLink(e,!0))}_askForLink(e,t){this._activeProviderReplies&&t||(this._activeProviderReplies?.forEach((e=>{e?.forEach((e=>{e.link.dispose&&e.link.dispose()}))})),this._activeProviderReplies=new Map,this._activeLine=e.y);let i=!1;for(const[n,s]of this._linkProviderService.linkProviders.entries())if(t){const t=this._activeProviderReplies?.get(n);t&&(i=this._checkLinkProviderResult(n,e,i))}else s.provideLinks(e.y,(t=>{if(this._isMouseOut)return;const s=t?.map((e=>({link:e})));this._activeProviderReplies?.set(n,s),i=this._checkLinkProviderResult(n,e,i),this._activeProviderReplies?.size===this._linkProviderService.linkProviders.length&&this._removeIntersectingLinks(e.y,this._activeProviderReplies)}))}_removeIntersectingLinks(e,t){const i=new Set;for(let n=0;n<t.size;n++){const s=t.get(n);if(s)for(let t=0;t<s.length;t++){const n=s[t],r=n.link.range.start.y<e?0:n.link.range.start.x,o=n.link.range.end.y>e?this._bufferService.cols:n.link.range.end.x;for(let e=r;e<=o;e++){if(i.has(e)){s.splice(t--,1);break}i.add(e)}}}}_checkLinkProviderResult(e,t,i){if(!this._activeProviderReplies)return i;const n=this._activeProviderReplies.get(e);let s=!1;for(let t=0;t<e;t++)this._activeProviderReplies.has(t)&&!this._activeProviderReplies.get(t)||(s=!0);if(!s&&n){const e=n.find((e=>this._linkAtPosition(e.link,t)));e&&(i=!0,this._handleNewLink(e))}if(this._activeProviderReplies.size===this._linkProviderService.linkProviders.length&&!i)for(let e=0;e<this._activeProviderReplies.size;e++){const n=this._activeProviderReplies.get(e)?.find((e=>this._linkAtPosition(e.link,t)));if(n){i=!0,this._handleNewLink(n);break}}return i}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(e){if(!this._currentLink)return;const t=this._positionFromMouseEvent(e,this._element,this._mouseService);t&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,t)&&this._currentLink.link.activate(e,this._currentLink.link.text)}_clearCurrentLink(e,t){this._currentLink&&this._lastMouseEvent&&(!e||!t||this._currentLink.link.range.start.y>=e&&this._currentLink.link.range.end.y<=t)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,a.disposeArray)(this._linkCacheDisposables))}_handleNewLink(e){if(!this._lastMouseEvent)return;const t=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);t&&this._linkAtPosition(e.link,t)&&(this._currentLink=e,this._currentLink.state={decorations:{underline:void 0===e.link.decorations||e.link.decorations.underline,pointerCursor:void 0===e.link.decorations||e.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,e.link,this._lastMouseEvent),e.link.decorations={},Object.defineProperties(e.link.decorations,{pointerCursor:{get:()=>this._currentLink?.state?.decorations.pointerCursor,set:e=>{this._currentLink?.state&&this._currentLink.state.decorations.pointerCursor!==e&&(this._currentLink.state.decorations.pointerCursor=e,this._currentLink.state.isHovered&&this._element.classList.toggle("xterm-cursor-pointer",e))}},underline:{get:()=>this._currentLink?.state?.decorations.underline,set:t=>{this._currentLink?.state&&this._currentLink?.state?.decorations.underline!==t&&(this._currentLink.state.decorations.underline=t,this._currentLink.state.isHovered&&this._fireUnderlineEvent(e.link,t))}}}),this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange((e=>{if(!this._currentLink)return;const t=0===e.start?0:e.start+1+this._bufferService.buffer.ydisp,i=this._bufferService.buffer.ydisp+1+e.end;if(this._currentLink.link.range.start.y>=t&&this._currentLink.link.range.end.y<=i&&(this._clearCurrentLink(t,i),this._lastMouseEvent)){const e=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);e&&this._askForLink(e,!1)}}))))}_linkHover(e,t,i){this._currentLink?.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(t,!0),this._currentLink.state.decorations.pointerCursor&&e.classList.add("xterm-cursor-pointer")),t.hover&&t.hover(i,t.text)}_fireUnderlineEvent(e,t){const i=e.range,n=this._bufferService.buffer.ydisp,s=this._createLinkUnderlineEvent(i.start.x-1,i.start.y-n-1,i.end.x,i.end.y-n-1,void 0);(t?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(s)}_linkLeave(e,t,i){this._currentLink?.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(t,!1),this._currentLink.state.decorations.pointerCursor&&e.classList.remove("xterm-cursor-pointer")),t.leave&&t.leave(i,t.text)}_linkAtPosition(e,t){const i=e.range.start.y*this._bufferService.cols+e.range.start.x,n=e.range.end.y*this._bufferService.cols+e.range.end.x,s=t.y*this._bufferService.cols+t.x;return i<=s&&s<=n}_positionFromMouseEvent(e,t,i){const n=i.getCoords(e,t,this._bufferService.cols,this._bufferService.rows);if(n)return{x:n[0],y:n[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(e,t,i,n,s){return{x1:e,y1:t,x2:i,y2:n,cols:this._bufferService.cols,fg:s}}};t.Linkifier=h=n([s(1,c.IMouseService),s(2,c.IRenderService),s(3,l.IBufferService),s(4,c.ILinkProviderService)],h)},9042:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tooMuchOutput=t.promptLabel=void 0,t.promptLabel="Terminal input",t.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OscLinkProvider=void 0;const r=i(511),o=i(2585);let a=t.OscLinkProvider=class{constructor(e,t,i){this._bufferService=e,this._optionsService=t,this._oscLinkService=i}provideLinks(e,t){const i=this._bufferService.buffer.lines.get(e-1);if(!i)return void t(void 0);const n=[],s=this._optionsService.rawOptions.linkHandler,o=new r.CellData,a=i.getTrimmedLength();let c=-1,h=-1,d=!1;for(let t=0;t<a;t++)if(-1!==h||i.hasContent(t)){if(i.loadCell(t,o),o.hasExtendedAttrs()&&o.extended.urlId){if(-1===h){h=t,c=o.extended.urlId;continue}d=o.extended.urlId!==c}else-1!==h&&(d=!0);if(d||-1!==h&&t===a-1){const i=this._oscLinkService.getLinkData(c)?.uri;if(i){const r={start:{x:h+1,y:e},end:{x:t+(d||t!==a-1?0:1),y:e}};let o=!1;if(!s?.allowNonHttpProtocols)try{const e=new URL(i);["http:","https:"].includes(e.protocol)||(o=!0)}catch(e){o=!0}o||n.push({text:i,range:r,activate:(e,t)=>s?s.activate(e,t,r):l(0,t),hover:(e,t)=>s?.hover?.(e,t,r),leave:(e,t)=>s?.leave?.(e,t,r)})}d=!1,o.hasExtendedAttrs()&&o.extended.urlId?(h=t,c=o.extended.urlId):(h=-1,c=-1)}}t(n)}};function l(e,t){if(confirm(`Do you want to navigate to ${t}?\n\nWARNING: This link could potentially be dangerous`)){const e=window.open();if(e){try{e.opener=null}catch{}e.location.href=t}else console.warn("Opening link blocked as opener could not be cleared")}}t.OscLinkProvider=a=n([s(0,o.IBufferService),s(1,o.IOptionsService),s(2,o.IOscLinkService)],a)},6193:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RenderDebouncer=void 0,t.RenderDebouncer=class{constructor(e,t){this._renderCallback=e,this._coreBrowserService=t,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(e){return this._refreshCallbacks.push(e),this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame((()=>this._innerRefresh()))),this._animationFrame}refresh(e,t,i){this._rowCount=i,e=void 0!==e?e:0,t=void 0!==t?t:this._rowCount-1,this._rowStart=void 0!==this._rowStart?Math.min(this._rowStart,e):e,this._rowEnd=void 0!==this._rowEnd?Math.max(this._rowEnd,t):t,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame((()=>this._innerRefresh())))}_innerRefresh(){if(this._animationFrame=void 0,void 0===this._rowStart||void 0===this._rowEnd||void 0===this._rowCount)return void this._runRefreshCallbacks();const e=Math.max(this._rowStart,0),t=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(e,t),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const e of this._refreshCallbacks)e(0);this._refreshCallbacks=[]}}},3236:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Terminal=void 0;const n=i(3614),s=i(3656),r=i(3551),o=i(9042),a=i(3730),l=i(1680),c=i(3107),h=i(5744),d=i(2950),u=i(1296),p=i(428),f=i(4269),m=i(5114),g=i(8934),v=i(3230),_=i(9312),b=i(4725),y=i(6731),C=i(8055),w=i(8969),S=i(8460),E=i(844),x=i(6114),T=i(8437),A=i(2584),O=i(7399),I=i(5941),k=i(9074),D=i(2585),j=i(5435),R=i(4567),L=i(779);class M extends w.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(e={}){super(e),this.browser=x,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this.register(new E.MutableDisposable),this._onCursorMove=this.register(new S.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new S.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new S.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new S.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new S.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new S.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new S.EventEmitter),this._onBlur=this.register(new S.EventEmitter),this._onA11yCharEmitter=this.register(new S.EventEmitter),this._onA11yTabEmitter=this.register(new S.EventEmitter),this._onWillOpen=this.register(new S.EventEmitter),this._setup(),this._decorationService=this._instantiationService.createInstance(k.DecorationService),this._instantiationService.setService(D.IDecorationService,this._decorationService),this._linkProviderService=this._instantiationService.createInstance(L.LinkProviderService),this._instantiationService.setService(b.ILinkProviderService,this._linkProviderService),this._linkProviderService.registerLinkProvider(this._instantiationService.createInstance(a.OscLinkProvider)),this.register(this._inputHandler.onRequestBell((()=>this._onBell.fire()))),this.register(this._inputHandler.onRequestRefreshRows(((e,t)=>this.refresh(e,t)))),this.register(this._inputHandler.onRequestSendFocus((()=>this._reportFocus()))),this.register(this._inputHandler.onRequestReset((()=>this.reset()))),this.register(this._inputHandler.onRequestWindowsOptionsReport((e=>this._reportWindowsOptions(e)))),this.register(this._inputHandler.onColor((e=>this._handleColorEvent(e)))),this.register((0,S.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,S.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,S.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,S.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize((e=>this._afterResize(e.cols,e.rows)))),this.register((0,E.toDisposable)((()=>{this._customKeyEventHandler=void 0,this.element?.parentNode?.removeChild(this.element)})))}_handleColorEvent(e){if(this._themeService)for(const t of e){let e,i="";switch(t.index){case 256:e="foreground",i="10";break;case 257:e="background",i="11";break;case 258:e="cursor",i="12";break;default:e="ansi",i="4;"+t.index}switch(t.type){case 0:const n=C.color.toColorRGB("ansi"===e?this._themeService.colors.ansi[t.index]:this._themeService.colors[e]);this.coreService.triggerDataEvent(`${A.C0.ESC}]${i};${(0,I.toRgbString)(n)}${A.C1_ESCAPED.ST}`);break;case 1:if("ansi"===e)this._themeService.modifyColors((e=>e.ansi[t.index]=C.channels.toColor(...t.color)));else{const i=e;this._themeService.modifyColors((e=>e[i]=C.channels.toColor(...t.color)))}break;case 2:this._themeService.restoreColor(t.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(e){e?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(R.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(e){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(A.C0.ESC+"[I"),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){return this.textarea?.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(A.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const e=this.buffer.ybase+this.buffer.y,t=this.buffer.lines.get(e);if(!t)return;const i=Math.min(this.buffer.x,this.cols-1),n=this._renderService.dimensions.css.cell.height,s=t.getWidth(i),r=this._renderService.dimensions.css.cell.width*s,o=this.buffer.y*this._renderService.dimensions.css.cell.height,a=i*this._renderService.dimensions.css.cell.width;this.textarea.style.left=a+"px",this.textarea.style.top=o+"px",this.textarea.style.width=r+"px",this.textarea.style.height=n+"px",this.textarea.style.lineHeight=n+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,s.addDisposableDomListener)(this.element,"copy",(e=>{this.hasSelection()&&(0,n.copyHandler)(e,this._selectionService)})));const e=e=>(0,n.handlePasteEvent)(e,this.textarea,this.coreService,this.optionsService);this.register((0,s.addDisposableDomListener)(this.textarea,"paste",e)),this.register((0,s.addDisposableDomListener)(this.element,"paste",e)),x.isFirefox?this.register((0,s.addDisposableDomListener)(this.element,"mousedown",(e=>{2===e.button&&(0,n.rightClickHandler)(e,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)}))):this.register((0,s.addDisposableDomListener)(this.element,"contextmenu",(e=>{(0,n.rightClickHandler)(e,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)}))),x.isLinux&&this.register((0,s.addDisposableDomListener)(this.element,"auxclick",(e=>{1===e.button&&(0,n.moveTextAreaUnderMouseCursor)(e,this.textarea,this.screenElement)})))}_bindKeys(){this.register((0,s.addDisposableDomListener)(this.textarea,"keyup",(e=>this._keyUp(e)),!0)),this.register((0,s.addDisposableDomListener)(this.textarea,"keydown",(e=>this._keyDown(e)),!0)),this.register((0,s.addDisposableDomListener)(this.textarea,"keypress",(e=>this._keyPress(e)),!0)),this.register((0,s.addDisposableDomListener)(this.textarea,"compositionstart",(()=>this._compositionHelper.compositionstart()))),this.register((0,s.addDisposableDomListener)(this.textarea,"compositionupdate",(e=>this._compositionHelper.compositionupdate(e)))),this.register((0,s.addDisposableDomListener)(this.textarea,"compositionend",(()=>this._compositionHelper.compositionend()))),this.register((0,s.addDisposableDomListener)(this.textarea,"input",(e=>this._inputEvent(e)),!0)),this.register(this.onRender((()=>this._compositionHelper.updateCompositionElements())))}open(e){if(!e)throw new Error("Terminal requires a parent element.");if(e.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this.element?.ownerDocument.defaultView&&this._coreBrowserService)return void(this.element.ownerDocument.defaultView!==this._coreBrowserService.window&&(this._coreBrowserService.window=this.element.ownerDocument.defaultView));this._document=e.ownerDocument,this.options.documentOverride&&this.options.documentOverride instanceof Document&&(this._document=this.optionsService.rawOptions.documentOverride),this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),e.appendChild(this.element);const t=this._document.createDocumentFragment();this._viewportElement=this._document.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),t.appendChild(this._viewportElement),this._viewportScrollArea=this._document.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=this._document.createElement("div"),this.screenElement.classList.add("xterm-screen"),this.register((0,s.addDisposableDomListener)(this.screenElement,"mousemove",(e=>this.updateCursorStyle(e)))),this._helperContainer=this._document.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),t.appendChild(this.screenElement),this.textarea=this._document.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",o.promptLabel),x.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this.register(this._instantiationService.createInstance(m.CoreBrowserService,this.textarea,e.ownerDocument.defaultView??window,this._document??"undefined"!=typeof window?window.document:null)),this._instantiationService.setService(b.ICoreBrowserService,this._coreBrowserService),this.register((0,s.addDisposableDomListener)(this.textarea,"focus",(e=>this._handleTextAreaFocus(e)))),this.register((0,s.addDisposableDomListener)(this.textarea,"blur",(()=>this._handleTextAreaBlur()))),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(p.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(b.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(y.ThemeService),this._instantiationService.setService(b.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(f.CharacterJoinerService),this._instantiationService.setService(b.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(v.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(b.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange((e=>this._onRender.fire(e)))),this.onResize((e=>this._renderService.resize(e.cols,e.rows))),this._compositionView=this._document.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(d.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this._mouseService=this._instantiationService.createInstance(g.MouseService),this._instantiationService.setService(b.IMouseService,this._mouseService),this.linkifier=this.register(this._instantiationService.createInstance(r.Linkifier,this.screenElement)),this.element.appendChild(t);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this.viewport=this._instantiationService.createInstance(l.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines((e=>this.scrollLines(e.amount,e.suppressScrollEvent,1))),this.register(this._inputHandler.onRequestSyncScrollBar((()=>this.viewport.syncScrollArea()))),this.register(this.viewport),this.register(this.onCursorMove((()=>{this._renderService.handleCursorMove(),this._syncTextArea()}))),this.register(this.onResize((()=>this._renderService.handleResize(this.cols,this.rows)))),this.register(this.onBlur((()=>this._renderService.handleBlur()))),this.register(this.onFocus((()=>this._renderService.handleFocus()))),this.register(this._renderService.onDimensionsChange((()=>this.viewport.syncScrollArea()))),this._selectionService=this.register(this._instantiationService.createInstance(_.SelectionService,this.element,this.screenElement,this.linkifier)),this._instantiationService.setService(b.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines((e=>this.scrollLines(e.amount,e.suppressScrollEvent)))),this.register(this._selectionService.onSelectionChange((()=>this._onSelectionChange.fire()))),this.register(this._selectionService.onRequestRedraw((e=>this._renderService.handleSelectionChanged(e.start,e.end,e.columnSelectMode)))),this.register(this._selectionService.onLinuxMouseSelection((e=>{this.textarea.value=e,this.textarea.focus(),this.textarea.select()}))),this.register(this._onScroll.event((e=>{this.viewport.syncScrollArea(),this._selectionService.refresh()}))),this.register((0,s.addDisposableDomListener)(this._viewportElement,"scroll",(()=>this._selectionService.refresh()))),this.register(this._instantiationService.createInstance(c.BufferDecorationRenderer,this.screenElement)),this.register((0,s.addDisposableDomListener)(this.element,"mousedown",(e=>this._selectionService.handleMouseDown(e)))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(R.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",(e=>this._handleScreenReaderModeOptionChange(e)))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(h.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",(e=>{!this._overviewRulerRenderer&&e&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(h.OverviewRulerRenderer,this._viewportElement,this.screenElement)))})),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(u.DomRenderer,this,this._document,this.element,this.screenElement,this._viewportElement,this._helperContainer,this.linkifier)}bindMouse(){const e=this,t=this.element;function i(t){const i=e._mouseService.getMouseReportCoords(t,e.screenElement);if(!i)return!1;let n,s;switch(t.overrideType||t.type){case"mousemove":s=32,void 0===t.buttons?(n=3,void 0!==t.button&&(n=t.button<3?t.button:3)):n=1&t.buttons?0:4&t.buttons?1:2&t.buttons?2:3;break;case"mouseup":s=0,n=t.button<3?t.button:3;break;case"mousedown":s=1,n=t.button<3?t.button:3;break;case"wheel":if(e._customWheelEventHandler&&!1===e._customWheelEventHandler(t))return!1;if(0===e.viewport.getLinesScrolled(t))return!1;s=t.deltaY<0?0:1,n=4;break;default:return!1}return!(void 0===s||void 0===n||n>4)&&e.coreMouseService.triggerMouseEvent({col:i.col,row:i.row,x:i.x,y:i.y,button:n,action:s,ctrl:t.ctrlKey,alt:t.altKey,shift:t.shiftKey})}const n={mouseup:null,wheel:null,mousedrag:null,mousemove:null},r={mouseup:e=>(i(e),e.buttons||(this._document.removeEventListener("mouseup",n.mouseup),n.mousedrag&&this._document.removeEventListener("mousemove",n.mousedrag)),this.cancel(e)),wheel:e=>(i(e),this.cancel(e,!0)),mousedrag:e=>{e.buttons&&i(e)},mousemove:e=>{e.buttons||i(e)}};this.register(this.coreMouseService.onProtocolChange((e=>{e?("debug"===this.optionsService.rawOptions.logLevel&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(e)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&e?n.mousemove||(t.addEventListener("mousemove",r.mousemove),n.mousemove=r.mousemove):(t.removeEventListener("mousemove",n.mousemove),n.mousemove=null),16&e?n.wheel||(t.addEventListener("wheel",r.wheel,{passive:!1}),n.wheel=r.wheel):(t.removeEventListener("wheel",n.wheel),n.wheel=null),2&e?n.mouseup||(n.mouseup=r.mouseup):(this._document.removeEventListener("mouseup",n.mouseup),n.mouseup=null),4&e?n.mousedrag||(n.mousedrag=r.mousedrag):(this._document.removeEventListener("mousemove",n.mousedrag),n.mousedrag=null)}))),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,s.addDisposableDomListener)(t,"mousedown",(e=>{if(e.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(e))return i(e),n.mouseup&&this._document.addEventListener("mouseup",n.mouseup),n.mousedrag&&this._document.addEventListener("mousemove",n.mousedrag),this.cancel(e)}))),this.register((0,s.addDisposableDomListener)(t,"wheel",(e=>{if(!n.wheel){if(this._customWheelEventHandler&&!1===this._customWheelEventHandler(e))return!1;if(!this.buffer.hasScrollback){const t=this.viewport.getLinesScrolled(e);if(0===t)return;const i=A.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(e.deltaY<0?"A":"B");let n="";for(let e=0;e<Math.abs(t);e++)n+=i;return this.coreService.triggerDataEvent(n,!0),this.cancel(e,!0)}return this.viewport.handleWheel(e)?this.cancel(e):void 0}}),{passive:!1})),this.register((0,s.addDisposableDomListener)(t,"touchstart",(e=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(e),this.cancel(e)}),{passive:!0})),this.register((0,s.addDisposableDomListener)(t,"touchmove",(e=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(e)?void 0:this.cancel(e)}),{passive:!1}))}refresh(e,t){this._renderService?.refreshRows(e,t)}updateCursorStyle(e){this._selectionService?.shouldColumnSelect(e)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(e,t,i=0){1===i?(super.scrollLines(e,t,i),this.refresh(0,this.rows-1)):this.viewport?.scrollLines(e)}paste(e){(0,n.paste)(e,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(e){this._customKeyEventHandler=e}attachCustomWheelEventHandler(e){this._customWheelEventHandler=e}registerLinkProvider(e){return this._linkProviderService.registerLinkProvider(e)}registerCharacterJoiner(e){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const t=this._characterJoinerService.register(e);return this.refresh(0,this.rows-1),t}deregisterCharacterJoiner(e){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(e)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(e){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+e)}registerDecoration(e){return this._decorationService.registerDecoration(e)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(e,t,i){this._selectionService.setSelection(e,t,i)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){this._selectionService?.clearSelection()}selectAll(){this._selectionService?.selectAll()}selectLines(e,t){this._selectionService?.selectLines(e,t)}_keyDown(e){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&!1===this._customKeyEventHandler(e))return!1;const t=this.browser.isMac&&this.options.macOptionIsMeta&&e.altKey;if(!t&&!this._compositionHelper.keydown(e))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;t||"Dead"!==e.key&&"AltGraph"!==e.key||(this._unprocessedDeadKey=!0);const i=(0,O.evaluateKeyboardEvent)(e,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(e),3===i.type||2===i.type){const t=this.rows-1;return this.scrollLines(2===i.type?-t:t),this.cancel(e,!0)}return 1===i.type&&this.selectAll(),!!this._isThirdLevelShift(this.browser,e)||(i.cancel&&this.cancel(e,!0),!i.key||!!(e.key&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&1===e.key.length&&e.key.charCodeAt(0)>=65&&e.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(i.key!==A.C0.ETX&&i.key!==A.C0.CR||(this.textarea.value=""),this._onKey.fire({key:i.key,domEvent:e}),this._showCursor(),this.coreService.triggerDataEvent(i.key,!0),!this.optionsService.rawOptions.screenReaderMode||e.altKey||e.ctrlKey?this.cancel(e,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(e,t){const i=e.isMac&&!this.options.macOptionIsMeta&&t.altKey&&!t.ctrlKey&&!t.metaKey||e.isWindows&&t.altKey&&t.ctrlKey&&!t.metaKey||e.isWindows&&t.getModifierState("AltGraph");return"keypress"===t.type?i:i&&(!t.keyCode||t.keyCode>47)}_keyUp(e){this._keyDownSeen=!1,this._customKeyEventHandler&&!1===this._customKeyEventHandler(e)||(function(e){return 16===e.keyCode||17===e.keyCode||18===e.keyCode}(e)||this.focus(),this.updateCursorStyle(e),this._keyPressHandled=!1)}_keyPress(e){let t;if(this._keyPressHandled=!1,this._keyDownHandled)return!1;if(this._customKeyEventHandler&&!1===this._customKeyEventHandler(e))return!1;if(this.cancel(e),e.charCode)t=e.charCode;else if(null===e.which||void 0===e.which)t=e.keyCode;else{if(0===e.which||0===e.charCode)return!1;t=e.which}return!(!t||(e.altKey||e.ctrlKey||e.metaKey)&&!this._isThirdLevelShift(this.browser,e)||(t=String.fromCharCode(t),this._onKey.fire({key:t,domEvent:e}),this._showCursor(),this.coreService.triggerDataEvent(t,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(e){if(e.data&&"insertText"===e.inputType&&(!e.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const t=e.data;return this.coreService.triggerDataEvent(t,!0),this.cancel(e),!0}return!1}resize(e,t){e!==this.cols||t!==this.rows?super.resize(e,t):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(e,t){this._charSizeService?.measure(),this.viewport?.syncScrollArea(!0)}clear(){if(0!==this.buffer.ybase||0!==this.buffer.y){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let e=1;e<this.rows;e++)this.buffer.lines.push(this.buffer.getBlankLine(T.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),this.viewport?.reset(),this.refresh(0,this.rows-1)}}reset(){this.options.rows=this.rows,this.options.cols=this.cols;const e=this._customKeyEventHandler;this._setup(),super.reset(),this._selectionService?.reset(),this._decorationService.reset(),this.viewport?.reset(),this._customKeyEventHandler=e,this.refresh(0,this.rows-1)}clearTextureAtlas(){this._renderService?.clearTextureAtlas()}_reportFocus(){this.element?.classList.contains("focus")?this.coreService.triggerDataEvent(A.C0.ESC+"[I"):this.coreService.triggerDataEvent(A.C0.ESC+"[O")}_reportWindowsOptions(e){if(this._renderService)switch(e){case j.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const e=this._renderService.dimensions.css.canvas.width.toFixed(0),t=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${A.C0.ESC}[4;${t};${e}t`);break;case j.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const i=this._renderService.dimensions.css.cell.width.toFixed(0),n=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${A.C0.ESC}[6;${n};${i}t`)}}cancel(e,t){if(this.options.cancelEvents||t)return e.preventDefault(),e.stopPropagation(),!1}}t.Terminal=M},9924:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TimeBasedDebouncer=void 0,t.TimeBasedDebouncer=class{constructor(e,t=1e3){this._renderCallback=e,this._debounceThresholdMS=t,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(e,t,i){this._rowCount=i,e=void 0!==e?e:0,t=void 0!==t?t:this._rowCount-1,this._rowStart=void 0!==this._rowStart?Math.min(this._rowStart,e):e,this._rowEnd=void 0!==this._rowEnd?Math.max(this._rowEnd,t):t;const n=Date.now();if(n-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=n,this._innerRefresh();else if(!this._additionalRefreshRequested){const e=n-this._lastRefreshMs,t=this._debounceThresholdMS-e;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout((()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0}),t)}}_innerRefresh(){if(void 0===this._rowStart||void 0===this._rowEnd||void 0===this._rowCount)return;const e=Math.max(this._rowStart,0),t=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(e,t)}}},1680:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Viewport=void 0;const r=i(3656),o=i(4725),a=i(8460),l=i(844),c=i(2585);let h=t.Viewport=class extends l.Disposable{constructor(e,t,i,n,s,o,l,c){super(),this._viewportElement=e,this._scrollArea=t,this._bufferService=i,this._optionsService=n,this._charSizeService=s,this._renderService=o,this._coreBrowserService=l,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new a.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,r.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate((e=>this._activeBuffer=e.activeBuffer))),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange((e=>this._renderDimensions=e))),this._handleThemeChange(c.colors),this.register(c.onChangeColors((e=>this._handleThemeChange(e)))),this.register(this._optionsService.onSpecificOptionChange("scrollback",(()=>this.syncScrollArea()))),setTimeout((()=>this.syncScrollArea()))}_handleThemeChange(e){this._viewportElement.style.backgroundColor=e.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame((()=>this.syncScrollArea()))}_refresh(e){if(e)return this._innerRefresh(),void(null!==this._refreshAnimationFrame&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));null===this._refreshAnimationFrame&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame((()=>this._innerRefresh())))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderDimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderDimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const e=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderDimensions.css.canvas.height);this._lastRecordedBufferHeight!==e&&(this._lastRecordedBufferHeight=e,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const e=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==e&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=e),this._refreshAnimationFrame=null}syncScrollArea(e=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(e);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(e)}_handleScroll(e){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});const t=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:t,suppressScrollEvent:!0})}_smoothScroll(){if(this._isDisposed||-1===this._smoothScrollState.origin||-1===this._smoothScrollState.target)return;const e=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(e*(this._smoothScrollState.target-this._smoothScrollState.origin)),e<1?this._coreBrowserService.window.requestAnimationFrame((()=>this._smoothScroll())):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(e,t){const i=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(t<0&&0!==this._viewportElement.scrollTop||t>0&&i<this._lastRecordedBufferHeight)||(e.cancelable&&e.preventDefault(),!1)}handleWheel(e){const t=this._getPixelsScrolled(e);return 0!==t&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,-1===this._smoothScrollState.target?this._smoothScrollState.target=this._viewportElement.scrollTop+t:this._smoothScrollState.target+=t,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=t,this._bubbleScroll(e,t))}scrollLines(e){if(0!==e)if(this._optionsService.rawOptions.smoothScrollDuration){const t=e*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+t,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:e,suppressScrollEvent:!1})}_getPixelsScrolled(e){if(0===e.deltaY||e.shiftKey)return 0;let t=this._applyScrollModifier(e.deltaY,e);return e.deltaMode===WheelEvent.DOM_DELTA_LINE?t*=this._currentRowHeight:e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(t*=this._currentRowHeight*this._bufferService.rows),t}getBufferElements(e,t){let i,n="";const s=[],r=t??this._bufferService.buffer.lines.length,o=this._bufferService.buffer.lines;for(let t=e;t<r;t++){const e=o.get(t);if(!e)continue;const r=o.get(t+1)?.isWrapped;if(n+=e.translateToString(!r),!r||t===o.length-1){const e=document.createElement("div");e.textContent=n,s.push(e),n.length>0&&(i=e),n=""}}return{bufferElements:s,cursorElement:i}}getLinesScrolled(e){if(0===e.deltaY||e.shiftKey)return 0;let t=this._applyScrollModifier(e.deltaY,e);return e.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(t/=this._currentRowHeight+0,this._wheelPartialScroll+=t,t=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(t*=this._bufferService.rows),t}_applyScrollModifier(e,t){const i=this._optionsService.rawOptions.fastScrollModifier;return"alt"===i&&t.altKey||"ctrl"===i&&t.ctrlKey||"shift"===i&&t.shiftKey?e*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:e*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(e){this._lastTouchY=e.touches[0].pageY}handleTouchMove(e){const t=this._lastTouchY-e.touches[0].pageY;return this._lastTouchY=e.touches[0].pageY,0!==t&&(this._viewportElement.scrollTop+=t,this._bubbleScroll(e,t))}};t.Viewport=h=n([s(2,c.IBufferService),s(3,c.IOptionsService),s(4,o.ICharSizeService),s(5,o.IRenderService),s(6,o.ICoreBrowserService),s(7,o.IThemeService)],h)},3107:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferDecorationRenderer=void 0;const r=i(4725),o=i(844),a=i(2585);let l=t.BufferDecorationRenderer=class extends o.Disposable{constructor(e,t,i,n,s){super(),this._screenElement=e,this._bufferService=t,this._coreBrowserService=i,this._decorationService=n,this._renderService=s,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange((()=>this._doRefreshDecorations()))),this.register(this._renderService.onDimensionsChange((()=>{this._dimensionsChanged=!0,this._queueRefresh()}))),this.register(this._coreBrowserService.onDprChange((()=>this._queueRefresh()))),this.register(this._bufferService.buffers.onBufferActivate((()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt}))),this.register(this._decorationService.onDecorationRegistered((()=>this._queueRefresh()))),this.register(this._decorationService.onDecorationRemoved((e=>this._removeDecoration(e)))),this.register((0,o.toDisposable)((()=>{this._container.remove(),this._decorationElements.clear()})))}_queueRefresh(){void 0===this._animationFrame&&(this._animationFrame=this._renderService.addRefreshCallback((()=>{this._doRefreshDecorations(),this._animationFrame=void 0})))}_doRefreshDecorations(){for(const e of this._decorationService.decorations)this._renderDecoration(e);this._dimensionsChanged=!1}_renderDecoration(e){this._refreshStyle(e),this._dimensionsChanged&&this._refreshXPosition(e)}_createElement(e){const t=this._coreBrowserService.mainDocument.createElement("div");t.classList.add("xterm-decoration"),t.classList.toggle("xterm-decoration-top-layer","top"===e?.options?.layer),t.style.width=`${Math.round((e.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,t.style.height=(e.options.height||1)*this._renderService.dimensions.css.cell.height+"px",t.style.top=(e.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",t.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const i=e.options.x??0;return i&&i>this._bufferService.cols&&(t.style.display="none"),this._refreshXPosition(e,t),t}_refreshStyle(e){const t=e.marker.line-this._bufferService.buffers.active.ydisp;if(t<0||t>=this._bufferService.rows)e.element&&(e.element.style.display="none",e.onRenderEmitter.fire(e.element));else{let i=this._decorationElements.get(e);i||(i=this._createElement(e),e.element=i,this._decorationElements.set(e,i),this._container.appendChild(i),e.onDispose((()=>{this._decorationElements.delete(e),i.remove()}))),i.style.top=t*this._renderService.dimensions.css.cell.height+"px",i.style.display=this._altBufferIsActive?"none":"block",e.onRenderEmitter.fire(i)}}_refreshXPosition(e,t=e.element){if(!t)return;const i=e.options.x??0;"right"===(e.options.anchor||"left")?t.style.right=i?i*this._renderService.dimensions.css.cell.width+"px":"":t.style.left=i?i*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(e){this._decorationElements.get(e)?.remove(),this._decorationElements.delete(e),e.dispose()}};t.BufferDecorationRenderer=l=n([s(1,a.IBufferService),s(2,r.ICoreBrowserService),s(3,a.IDecorationService),s(4,r.IRenderService)],l)},5871:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorZoneStore=void 0,t.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(e){if(e.options.overviewRulerOptions){for(const t of this._zones)if(t.color===e.options.overviewRulerOptions.color&&t.position===e.options.overviewRulerOptions.position){if(this._lineIntersectsZone(t,e.marker.line))return;if(this._lineAdjacentToZone(t,e.marker.line,e.options.overviewRulerOptions.position))return void this._addLineToZone(t,e.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=e.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=e.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=e.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=e.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:e.options.overviewRulerOptions.color,position:e.options.overviewRulerOptions.position,startBufferLine:e.marker.line,endBufferLine:e.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(e){this._linePadding=e}_lineIntersectsZone(e,t){return t>=e.startBufferLine&&t<=e.endBufferLine}_lineAdjacentToZone(e,t,i){return t>=e.startBufferLine-this._linePadding[i||"full"]&&t<=e.endBufferLine+this._linePadding[i||"full"]}_addLineToZone(e,t){e.startBufferLine=Math.min(e.startBufferLine,t),e.endBufferLine=Math.max(e.endBufferLine,t)}}},5744:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OverviewRulerRenderer=void 0;const r=i(5871),o=i(4725),a=i(844),l=i(2585),c={full:0,left:0,center:0,right:0},h={full:0,left:0,center:0,right:0},d={full:0,left:0,center:0,right:0};let u=t.OverviewRulerRenderer=class extends a.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(e,t,i,n,s,o,l){super(),this._viewportElement=e,this._screenElement=t,this._bufferService=i,this._decorationService=n,this._renderService=s,this._optionsService=o,this._coreBrowserService=l,this._colorZoneStore=new r.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=this._coreBrowserService.mainDocument.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),this._viewportElement.parentElement?.insertBefore(this._canvas,this._viewportElement);const c=this._canvas.getContext("2d");if(!c)throw new Error("Ctx cannot be null");this._ctx=c,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,a.toDisposable)((()=>{this._canvas?.remove()})))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered((()=>this._queueRefresh(void 0,!0)))),this.register(this._decorationService.onDecorationRemoved((()=>this._queueRefresh(void 0,!0))))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange((()=>this._queueRefresh()))),this.register(this._bufferService.buffers.onBufferActivate((()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"}))),this.register(this._bufferService.onScroll((()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())})))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender((()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)}))),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",(()=>this._queueRefresh(!0)))),this.register(this._coreBrowserService.onDprChange((()=>this._queueRefresh(!0)))),this._queueRefresh(!0)}_refreshDrawConstants(){const e=Math.floor(this._canvas.width/3),t=Math.ceil(this._canvas.width/3);h.full=this._canvas.width,h.left=e,h.center=t,h.right=e,this._refreshDrawHeightConstants(),d.full=0,d.left=0,d.center=h.left,d.right=h.left+h.center}_refreshDrawHeightConstants(){c.full=Math.round(2*this._coreBrowserService.dpr);const e=this._canvas.height/this._bufferService.buffer.lines.length,t=Math.round(Math.max(Math.min(e,12),6)*this._coreBrowserService.dpr);c.left=t,c.center=t,c.right=t}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*c.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*c.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*c.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*c.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowserService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowserService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const e of this._decorationService.decorations)this._colorZoneStore.addDecoration(e);this._ctx.lineWidth=1;const e=this._colorZoneStore.zones;for(const t of e)"full"!==t.position&&this._renderColorZone(t);for(const t of e)"full"===t.position&&this._renderColorZone(t);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(e){this._ctx.fillStyle=e.color,this._ctx.fillRect(d[e.position||"full"],Math.round((this._canvas.height-1)*(e.startBufferLine/this._bufferService.buffers.active.lines.length)-c[e.position||"full"]/2),h[e.position||"full"],Math.round((this._canvas.height-1)*((e.endBufferLine-e.startBufferLine)/this._bufferService.buffers.active.lines.length)+c[e.position||"full"]))}_queueRefresh(e,t){this._shouldUpdateDimensions=e||this._shouldUpdateDimensions,this._shouldUpdateAnchor=t||this._shouldUpdateAnchor,void 0===this._animationFrame&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame((()=>{this._refreshDecorations(),this._animationFrame=void 0})))}};t.OverviewRulerRenderer=u=n([s(2,l.IBufferService),s(3,l.IDecorationService),s(4,o.IRenderService),s(5,l.IOptionsService),s(6,o.ICoreBrowserService)],u)},2950:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CompositionHelper=void 0;const r=i(4725),o=i(2585),a=i(2584);let l=t.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(e,t,i,n,s,r){this._textarea=e,this._compositionView=t,this._bufferService=i,this._optionsService=n,this._coreService=s,this._renderService=r,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(e){this._compositionView.textContent=e.data,this.updateCompositionElements(),setTimeout((()=>{this._compositionPosition.end=this._textarea.value.length}),0)}compositionend(){this._finalizeComposition(!0)}keydown(e){if(this._isComposing||this._isSendingComposition){if(229===e.keyCode)return!1;if(16===e.keyCode||17===e.keyCode||18===e.keyCode)return!1;this._finalizeComposition(!1)}return 229!==e.keyCode||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(e){if(this._compositionView.classList.remove("active"),this._isComposing=!1,e){const e={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout((()=>{if(this._isSendingComposition){let t;this._isSendingComposition=!1,e.start+=this._dataAlreadySent.length,t=this._isComposing?this._textarea.value.substring(e.start,e.end):this._textarea.value.substring(e.start),t.length>0&&this._coreService.triggerDataEvent(t,!0)}}),0)}else{this._isSendingComposition=!1;const e=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(e,!0)}}_handleAnyTextareaChanges(){const e=this._textarea.value;setTimeout((()=>{if(!this._isComposing){const t=this._textarea.value,i=t.replace(e,"");this._dataAlreadySent=i,t.length>e.length?this._coreService.triggerDataEvent(i,!0):t.length<e.length?this._coreService.triggerDataEvent(`${a.C0.DEL}`,!0):t.length===e.length&&t!==e&&this._coreService.triggerDataEvent(t,!0)}}),0)}updateCompositionElements(e){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const e=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),t=this._renderService.dimensions.css.cell.height,i=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,n=e*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=n+"px",this._compositionView.style.top=i+"px",this._compositionView.style.height=t+"px",this._compositionView.style.lineHeight=t+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const s=this._compositionView.getBoundingClientRect();this._textarea.style.left=n+"px",this._textarea.style.top=i+"px",this._textarea.style.width=Math.max(s.width,1)+"px",this._textarea.style.height=Math.max(s.height,1)+"px",this._textarea.style.lineHeight=s.height+"px"}e||setTimeout((()=>this.updateCompositionElements(!0)),0)}}};t.CompositionHelper=l=n([s(2,o.IBufferService),s(3,o.IOptionsService),s(4,o.ICoreService),s(5,r.IRenderService)],l)},9806:(e,t)=>{function i(e,t,i){const n=i.getBoundingClientRect(),s=e.getComputedStyle(i),r=parseInt(s.getPropertyValue("padding-left")),o=parseInt(s.getPropertyValue("padding-top"));return[t.clientX-n.left-r,t.clientY-n.top-o]}Object.defineProperty(t,"__esModule",{value:!0}),t.getCoords=t.getCoordsRelativeToElement=void 0,t.getCoordsRelativeToElement=i,t.getCoords=function(e,t,n,s,r,o,a,l,c){if(!o)return;const h=i(e,t,n);return h?(h[0]=Math.ceil((h[0]+(c?a/2:0))/a),h[1]=Math.ceil(h[1]/l),h[0]=Math.min(Math.max(h[0],1),s+(c?1:0)),h[1]=Math.min(Math.max(h[1],1),r),h):void 0}},9504:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.moveToCellSequence=void 0;const n=i(2584);function s(e,t,i,n){const s=e-r(e,i),a=t-r(t,i),h=Math.abs(s-a)-function(e,t,i){let n=0;const s=e-r(e,i),a=t-r(t,i);for(let r=0;r<Math.abs(s-a);r++){const a="A"===o(e,t)?-1:1,l=i.buffer.lines.get(s+a*r);l?.isWrapped&&n++}return n}(e,t,i);return c(h,l(o(e,t),n))}function r(e,t){let i=0,n=t.buffer.lines.get(e),s=n?.isWrapped;for(;s&&e>=0&&e<t.rows;)i++,n=t.buffer.lines.get(--e),s=n?.isWrapped;return i}function o(e,t){return e>t?"A":"B"}function a(e,t,i,n,s,r){let o=e,a=t,l="";for(;o!==i||a!==n;)o+=s?1:-1,s&&o>r.cols-1?(l+=r.buffer.translateBufferLineToString(a,!1,e,o),o=0,e=0,a++):!s&&o<0&&(l+=r.buffer.translateBufferLineToString(a,!1,0,e+1),o=r.cols-1,e=o,a--);return l+r.buffer.translateBufferLineToString(a,!1,e,o)}function l(e,t){const i=t?"O":"[";return n.C0.ESC+i+e}function c(e,t){e=Math.floor(e);let i="";for(let n=0;n<e;n++)i+=t;return i}t.moveToCellSequence=function(e,t,i,n){const o=i.buffer.x,h=i.buffer.y;if(!i.buffer.hasScrollback)return function(e,t,i,n,o,h){return 0===s(t,n,o,h).length?"":c(a(e,t,e,t-r(t,o),!1,o).length,l("D",h))}(o,h,0,t,i,n)+s(h,t,i,n)+function(e,t,i,n,o,h){let d;d=s(t,n,o,h).length>0?n-r(n,o):t;const u=n,p=function(e,t,i,n,o,a){let l;return l=s(i,n,o,a).length>0?n-r(n,o):t,e<i&&l<=n||e>=i&&l<n?"C":"D"}(e,t,i,n,o,h);return c(a(e,d,i,u,"C"===p,o).length,l(p,h))}(o,h,e,t,i,n);let d;if(h===t)return d=o>e?"D":"C",c(Math.abs(o-e),l(d,n));d=h>t?"D":"C";const u=Math.abs(h-t);return c(function(e,t){return t.cols-e}(h>t?e:o,i)+(u-1)*i.cols+1+((h>t?o:e)-1),l(d,n))}},1296:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DomRenderer=void 0;const r=i(3787),o=i(2550),a=i(2223),l=i(6171),c=i(6052),h=i(4725),d=i(8055),u=i(8460),p=i(844),f=i(2585),m="xterm-dom-renderer-owner-",g="xterm-rows",v="xterm-fg-",_="xterm-bg-",b="xterm-focus",y="xterm-selection";let C=1,w=t.DomRenderer=class extends p.Disposable{constructor(e,t,i,n,s,a,h,d,f,v,_,b,w){super(),this._terminal=e,this._document=t,this._element=i,this._screenElement=n,this._viewportElement=s,this._helperContainer=a,this._linkifier2=h,this._charSizeService=f,this._optionsService=v,this._bufferService=_,this._coreBrowserService=b,this._themeService=w,this._terminalClass=C++,this._rowElements=[],this._selectionRenderModel=(0,c.createSelectionRenderModel)(),this.onRequestRedraw=this.register(new u.EventEmitter).event,this._rowContainer=this._document.createElement("div"),this._rowContainer.classList.add(g),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=this._document.createElement("div"),this._selectionContainer.classList.add(y),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,l.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange((()=>this._handleOptionsChanged()))),this.register(this._themeService.onChangeColors((e=>this._injectCss(e)))),this._injectCss(this._themeService.colors),this._rowFactory=d.createInstance(r.DomRendererRowFactory,document),this._element.classList.add(m+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline((e=>this._handleLinkHover(e)))),this.register(this._linkifier2.onHideLinkUnderline((e=>this._handleLinkLeave(e)))),this.register((0,p.toDisposable)((()=>{this._element.classList.remove(m+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()}))),this._widthCache=new o.WidthCache(this._document,this._helperContainer),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const e=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*e,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*e),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/e),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/e),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const e of this._rowElements)e.style.width=`${this.dimensions.css.canvas.width}px`,e.style.height=`${this.dimensions.css.cell.height}px`,e.style.lineHeight=`${this.dimensions.css.cell.height}px`,e.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const t=`${this._terminalSelector} .${g} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=t,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(e){this._themeStyleElement||(this._themeStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let t=`${this._terminalSelector} .${g} { color: ${e.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;t+=`${this._terminalSelector} .${g} .xterm-dim { color: ${d.color.multiplyOpacity(e.foreground,.5).css};}`,t+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`;const i=`blink_underline_${this._terminalClass}`,n=`blink_bar_${this._terminalClass}`,s=`blink_block_${this._terminalClass}`;t+=`@keyframes ${i} { 50% {  border-bottom-style: hidden; }}`,t+=`@keyframes ${n} { 50% {  box-shadow: none; }}`,t+=`@keyframes ${s} { 0% {  background-color: ${e.cursor.css};  color: ${e.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${e.cursor.css}; }}`,t+=`${this._terminalSelector} .${g}.${b} .xterm-cursor.xterm-cursor-blink.xterm-cursor-underline { animation: ${i} 1s step-end infinite;}${this._terminalSelector} .${g}.${b} .xterm-cursor.xterm-cursor-blink.xterm-cursor-bar { animation: ${n} 1s step-end infinite;}${this._terminalSelector} .${g}.${b} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: ${s} 1s step-end infinite;}${this._terminalSelector} .${g} .xterm-cursor.xterm-cursor-block { background-color: ${e.cursor.css}; color: ${e.cursorAccent.css};}${this._terminalSelector} .${g} .xterm-cursor.xterm-cursor-block:not(.xterm-cursor-blink) { background-color: ${e.cursor.css} !important; color: ${e.cursorAccent.css} !important;}${this._terminalSelector} .${g} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${e.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${g} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${e.cursor.css} inset;}${this._terminalSelector} .${g} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${e.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,t+=`${this._terminalSelector} .${y} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${y} div { position: absolute; background-color: ${e.selectionBackgroundOpaque.css};}${this._terminalSelector} .${y} div { position: absolute; background-color: ${e.selectionInactiveBackgroundOpaque.css};}`;for(const[i,n]of e.ansi.entries())t+=`${this._terminalSelector} .${v}${i} { color: ${n.css}; }${this._terminalSelector} .${v}${i}.xterm-dim { color: ${d.color.multiplyOpacity(n,.5).css}; }${this._terminalSelector} .${_}${i} { background-color: ${n.css}; }`;t+=`${this._terminalSelector} .${v}${a.INVERTED_DEFAULT_COLOR} { color: ${d.color.opaque(e.background).css}; }${this._terminalSelector} .${v}${a.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${d.color.multiplyOpacity(d.color.opaque(e.background),.5).css}; }${this._terminalSelector} .${_}${a.INVERTED_DEFAULT_COLOR} { background-color: ${e.foreground.css}; }`,this._themeStyleElement.textContent=t}_setDefaultSpacing(){const e=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${e}px`,this._rowFactory.defaultSpacing=e}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(e,t){for(let e=this._rowElements.length;e<=t;e++){const e=this._document.createElement("div");this._rowContainer.appendChild(e),this._rowElements.push(e)}for(;this._rowElements.length>t;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(e,t){this._refreshRowElements(e,t),this._updateDimensions(),this.handleSelectionChanged(this._selectionRenderModel.selectionStart,this._selectionRenderModel.selectionEnd,this._selectionRenderModel.columnSelectMode)}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(b),this.renderRows(0,this._bufferService.rows-1)}handleFocus(){this._rowContainer.classList.add(b),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(e,t,i){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(e,t,i),this.renderRows(0,this._bufferService.rows-1),!e||!t)return;this._selectionRenderModel.update(this._terminal,e,t,i);const n=this._selectionRenderModel.viewportStartRow,s=this._selectionRenderModel.viewportEndRow,r=this._selectionRenderModel.viewportCappedStartRow,o=this._selectionRenderModel.viewportCappedEndRow;if(r>=this._bufferService.rows||o<0)return;const a=this._document.createDocumentFragment();if(i){const i=e[0]>t[0];a.appendChild(this._createSelectionElement(r,i?t[0]:e[0],i?e[0]:t[0],o-r+1))}else{const i=n===r?e[0]:0,l=r===s?t[0]:this._bufferService.cols;a.appendChild(this._createSelectionElement(r,i,l));const c=o-r-1;if(a.appendChild(this._createSelectionElement(r+1,0,this._bufferService.cols,c)),r!==o){const e=s===o?t[0]:this._bufferService.cols;a.appendChild(this._createSelectionElement(o,0,e))}}this._selectionContainer.appendChild(a)}_createSelectionElement(e,t,i,n=1){const s=this._document.createElement("div"),r=t*this.dimensions.css.cell.width;let o=this.dimensions.css.cell.width*(i-t);return r+o>this.dimensions.css.canvas.width&&(o=this.dimensions.css.canvas.width-r),s.style.height=n*this.dimensions.css.cell.height+"px",s.style.top=e*this.dimensions.css.cell.height+"px",s.style.left=`${r}px`,s.style.width=`${o}px`,s}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(const e of this._rowElements)e.replaceChildren()}renderRows(e,t){const i=this._bufferService.buffer,n=i.ybase+i.y,s=Math.min(i.x,this._bufferService.cols-1),r=this._optionsService.rawOptions.cursorBlink,o=this._optionsService.rawOptions.cursorStyle,a=this._optionsService.rawOptions.cursorInactiveStyle;for(let l=e;l<=t;l++){const e=l+i.ydisp,t=this._rowElements[l],c=i.lines.get(e);if(!t||!c)break;t.replaceChildren(...this._rowFactory.createRow(c,e,e===n,o,a,s,r,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${m}${this._terminalClass}`}_handleLinkHover(e){this._setCellUnderline(e.x1,e.x2,e.y1,e.y2,e.cols,!0)}_handleLinkLeave(e){this._setCellUnderline(e.x1,e.x2,e.y1,e.y2,e.cols,!1)}_setCellUnderline(e,t,i,n,s,r){i<0&&(e=0),n<0&&(t=0);const o=this._bufferService.rows-1;i=Math.max(Math.min(i,o),0),n=Math.max(Math.min(n,o),0),s=Math.min(s,this._bufferService.cols);const a=this._bufferService.buffer,l=a.ybase+a.y,c=Math.min(a.x,s-1),h=this._optionsService.rawOptions.cursorBlink,d=this._optionsService.rawOptions.cursorStyle,u=this._optionsService.rawOptions.cursorInactiveStyle;for(let o=i;o<=n;++o){const p=o+a.ydisp,f=this._rowElements[o],m=a.lines.get(p);if(!f||!m)break;f.replaceChildren(...this._rowFactory.createRow(m,p,p===l,d,u,c,h,this.dimensions.css.cell.width,this._widthCache,r?o===i?e:0:-1,r?(o===n?t:s)-1:-1))}}};t.DomRenderer=w=n([s(7,f.IInstantiationService),s(8,h.ICharSizeService),s(9,f.IOptionsService),s(10,f.IBufferService),s(11,h.ICoreBrowserService),s(12,h.IThemeService)],w)},3787:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DomRendererRowFactory=void 0;const r=i(2223),o=i(643),a=i(511),l=i(2585),c=i(8055),h=i(4725),d=i(4269),u=i(6171),p=i(3734);let f=t.DomRendererRowFactory=class{constructor(e,t,i,n,s,r,o){this._document=e,this._characterJoinerService=t,this._optionsService=i,this._coreBrowserService=n,this._coreService=s,this._decorationService=r,this._themeService=o,this._workCell=new a.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(e,t,i){this._selectionStart=e,this._selectionEnd=t,this._columnSelectMode=i}createRow(e,t,i,n,s,a,l,h,u,f,g){const v=[],_=this._characterJoinerService.getJoinedCharacters(t),b=this._themeService.colors;let y,C=e.getNoBgTrimmedLength();i&&C<a+1&&(C=a+1);let w=0,S="",E=0,x=0,T=0,A=!1,O=0,I=!1,k=0;const D=[],j=-1!==f&&-1!==g;for(let R=0;R<C;R++){e.loadCell(R,this._workCell);let C=this._workCell.getWidth();if(0===C)continue;let L=!1,M=R,P=this._workCell;if(_.length>0&&R===_[0][0]){L=!0;const t=_.shift();P=new d.JoinedCellData(this._workCell,e.translateToString(!0,t[0],t[1]),t[1]-t[0]),M=t[1]-1,C=P.getWidth()}const N=this._isCellInSelection(R,t),F=i&&R===a,H=j&&R>=f&&R<=g;let B=!1;this._decorationService.forEachDecorationAtCell(R,t,void 0,(e=>{B=!0}));let z=P.getChars()||o.WHITESPACE_CELL_CHAR;if(" "===z&&(P.isUnderline()||P.isOverline())&&(z="Â "),k=C*h-u.get(z,P.isBold(),P.isItalic()),y){if(w&&(N&&I||!N&&!I&&P.bg===E)&&(N&&I&&b.selectionForeground||P.fg===x)&&P.extended.ext===T&&H===A&&k===O&&!F&&!L&&!B){P.isInvisible()?S+=o.WHITESPACE_CELL_CHAR:S+=z,w++;continue}w&&(y.textContent=S),y=this._document.createElement("span"),w=0,S=""}else y=this._document.createElement("span");if(E=P.bg,x=P.fg,T=P.extended.ext,A=H,O=k,I=N,L&&a>=R&&a<=M&&(a=R),!this._coreService.isCursorHidden&&F&&this._coreService.isCursorInitialized)if(D.push("xterm-cursor"),this._coreBrowserService.isFocused)l&&D.push("xterm-cursor-blink"),D.push("bar"===n?"xterm-cursor-bar":"underline"===n?"xterm-cursor-underline":"xterm-cursor-block");else if(s)switch(s){case"outline":D.push("xterm-cursor-outline");break;case"block":D.push("xterm-cursor-block");break;case"bar":D.push("xterm-cursor-bar");break;case"underline":D.push("xterm-cursor-underline")}if(P.isBold()&&D.push("xterm-bold"),P.isItalic()&&D.push("xterm-italic"),P.isDim()&&D.push("xterm-dim"),S=P.isInvisible()?o.WHITESPACE_CELL_CHAR:P.getChars()||o.WHITESPACE_CELL_CHAR,P.isUnderline()&&(D.push(`xterm-underline-${P.extended.underlineStyle}`)," "===S&&(S="Â "),!P.isUnderlineColorDefault()))if(P.isUnderlineColorRGB())y.style.textDecorationColor=`rgb(${p.AttributeData.toColorRGB(P.getUnderlineColor()).join(",")})`;else{let e=P.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&P.isBold()&&e<8&&(e+=8),y.style.textDecorationColor=b.ansi[e].css}P.isOverline()&&(D.push("xterm-overline")," "===S&&(S="Â ")),P.isStrikethrough()&&D.push("xterm-strikethrough"),H&&(y.style.textDecoration="underline");let V=P.getFgColor(),W=P.getFgColorMode(),$=P.getBgColor(),U=P.getBgColorMode();const q=!!P.isInverse();if(q){const e=V;V=$,$=e;const t=W;W=U,U=t}let G,K,Y,X=!1;switch(this._decorationService.forEachDecorationAtCell(R,t,void 0,(e=>{"top"!==e.options.layer&&X||(e.backgroundColorRGB&&(U=50331648,$=e.backgroundColorRGB.rgba>>8&16777215,G=e.backgroundColorRGB),e.foregroundColorRGB&&(W=50331648,V=e.foregroundColorRGB.rgba>>8&16777215,K=e.foregroundColorRGB),X="top"===e.options.layer)})),!X&&N&&(G=this._coreBrowserService.isFocused?b.selectionBackgroundOpaque:b.selectionInactiveBackgroundOpaque,$=G.rgba>>8&16777215,U=50331648,X=!0,b.selectionForeground&&(W=50331648,V=b.selectionForeground.rgba>>8&16777215,K=b.selectionForeground)),X&&D.push("xterm-decoration-top"),U){case 16777216:case 33554432:Y=b.ansi[$],D.push(`xterm-bg-${$}`);break;case 50331648:Y=c.channels.toColor($>>16,$>>8&255,255&$),this._addStyle(y,`background-color:#${m(($>>>0).toString(16),"0",6)}`);break;default:q?(Y=b.foreground,D.push(`xterm-bg-${r.INVERTED_DEFAULT_COLOR}`)):Y=b.background}switch(G||P.isDim()&&(G=c.color.multiplyOpacity(Y,.5)),W){case 16777216:case 33554432:P.isBold()&&V<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(V+=8),this._applyMinimumContrast(y,Y,b.ansi[V],P,G,void 0)||D.push(`xterm-fg-${V}`);break;case 50331648:const e=c.channels.toColor(V>>16&255,V>>8&255,255&V);this._applyMinimumContrast(y,Y,e,P,G,K)||this._addStyle(y,`color:#${m(V.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(y,Y,b.foreground,P,G,K)||q&&D.push(`xterm-fg-${r.INVERTED_DEFAULT_COLOR}`)}D.length&&(y.className=D.join(" "),D.length=0),F||L||B?y.textContent=S:w++,k!==this.defaultSpacing&&(y.style.letterSpacing=`${k}px`),v.push(y),R=M}return y&&w&&(y.textContent=S),v}_applyMinimumContrast(e,t,i,n,s,r){if(1===this._optionsService.rawOptions.minimumContrastRatio||(0,u.treatGlyphAsBackgroundColor)(n.getCode()))return!1;const o=this._getContrastCache(n);let a;if(s||r||(a=o.getColor(t.rgba,i.rgba)),void 0===a){const e=this._optionsService.rawOptions.minimumContrastRatio/(n.isDim()?2:1);a=c.color.ensureContrastRatio(s||t,r||i,e),o.setColor((s||t).rgba,(r||i).rgba,a??null)}return!!a&&(this._addStyle(e,`color:${a.css}`),!0)}_getContrastCache(e){return e.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(e,t){e.setAttribute("style",`${e.getAttribute("style")||""}${t};`)}_isCellInSelection(e,t){const i=this._selectionStart,n=this._selectionEnd;return!(!i||!n)&&(this._columnSelectMode?i[0]<=n[0]?e>=i[0]&&t>=i[1]&&e<n[0]&&t<=n[1]:e<i[0]&&t>=i[1]&&e>=n[0]&&t<=n[1]:t>i[1]&&t<n[1]||i[1]===n[1]&&t===i[1]&&e>=i[0]&&e<n[0]||i[1]<n[1]&&t===n[1]&&e<n[0]||i[1]<n[1]&&t===i[1]&&e>=i[0])}};function m(e,t,i){for(;e.length<i;)e=t+e;return e}t.DomRendererRowFactory=f=n([s(1,h.ICharacterJoinerService),s(2,l.IOptionsService),s(3,h.ICoreBrowserService),s(4,l.ICoreService),s(5,l.IDecorationService),s(6,h.IThemeService)],f)},2550:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WidthCache=void 0,t.WidthCache=class{constructor(e,t){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=e.createElement("div"),this._container.classList.add("xterm-width-cache-measure-container"),this._container.setAttribute("aria-hidden","true"),this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";const i=e.createElement("span");i.classList.add("xterm-char-measure-element");const n=e.createElement("span");n.classList.add("xterm-char-measure-element"),n.style.fontWeight="bold";const s=e.createElement("span");s.classList.add("xterm-char-measure-element"),s.style.fontStyle="italic";const r=e.createElement("span");r.classList.add("xterm-char-measure-element"),r.style.fontWeight="bold",r.style.fontStyle="italic",this._measureElements=[i,n,s,r],this._container.appendChild(i),this._container.appendChild(n),this._container.appendChild(s),this._container.appendChild(r),t.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(e,t,i,n){e===this._font&&t===this._fontSize&&i===this._weight&&n===this._weightBold||(this._font=e,this._fontSize=t,this._weight=i,this._weightBold=n,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${i}`,this._measureElements[1].style.fontWeight=`${n}`,this._measureElements[2].style.fontWeight=`${i}`,this._measureElements[3].style.fontWeight=`${n}`,this.clear())}get(e,t,i){let n=0;if(!t&&!i&&1===e.length&&(n=e.charCodeAt(0))<256){if(-9999!==this._flat[n])return this._flat[n];const t=this._measure(e,0);return t>0&&(this._flat[n]=t),t}let s=e;t&&(s+="B"),i&&(s+="I");let r=this._holey.get(s);if(void 0===r){let n=0;t&&(n|=1),i&&(n|=2),r=this._measure(e,n),r>0&&this._holey.set(s,r)}return r}_measure(e,t){const i=this._measureElements[t];return i.textContent=e.repeat(32),i.offsetWidth/32}}},2223:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TEXT_BASELINE=t.DIM_OPACITY=t.INVERTED_DEFAULT_COLOR=void 0;const n=i(6114);t.INVERTED_DEFAULT_COLOR=257,t.DIM_OPACITY=.5,t.TEXT_BASELINE=n.isFirefox||n.isLegacyEdge?"bottom":"ideographic"},6171:(e,t)=>{function i(e){return 57508<=e&&e<=57558}function n(e){return e>=128512&&e<=128591||e>=127744&&e<=128511||e>=128640&&e<=128767||e>=9728&&e<=9983||e>=9984&&e<=10175||e>=65024&&e<=65039||e>=129280&&e<=129535||e>=127462&&e<=127487}Object.defineProperty(t,"__esModule",{value:!0}),t.computeNextVariantOffset=t.createRenderDimensions=t.treatGlyphAsBackgroundColor=t.allowRescaling=t.isEmoji=t.isRestrictedPowerlineGlyph=t.isPowerlineGlyph=t.throwIfFalsy=void 0,t.throwIfFalsy=function(e){if(!e)throw new Error("value must not be falsy");return e},t.isPowerlineGlyph=i,t.isRestrictedPowerlineGlyph=function(e){return 57520<=e&&e<=57527},t.isEmoji=n,t.allowRescaling=function(e,t,s,r){return 1===t&&s>Math.ceil(1.5*r)&&void 0!==e&&e>255&&!n(e)&&!i(e)&&!function(e){return 57344<=e&&e<=63743}(e)},t.treatGlyphAsBackgroundColor=function(e){return i(e)||function(e){return 9472<=e&&e<=9631}(e)},t.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}},t.computeNextVariantOffset=function(e,t,i=0){return(e-(2*Math.round(t)-i))%(2*Math.round(t))}},6052:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createSelectionRenderModel=void 0;class i{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(e,t,i,n=!1){if(this.selectionStart=t,this.selectionEnd=i,!t||!i||t[0]===i[0]&&t[1]===i[1])return void this.clear();const s=e.buffers.active.ydisp,r=t[1]-s,o=i[1]-s,a=Math.max(r,0),l=Math.min(o,e.rows-1);a>=e.rows||l<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=n,this.viewportStartRow=r,this.viewportEndRow=o,this.viewportCappedStartRow=a,this.viewportCappedEndRow=l,this.startCol=t[0],this.endCol=i[0])}isCellSelected(e,t,i){return!!this.hasSelection&&(i-=e.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?t>=this.startCol&&i>=this.viewportCappedStartRow&&t<this.endCol&&i<=this.viewportCappedEndRow:t<this.startCol&&i>=this.viewportCappedStartRow&&t>=this.endCol&&i<=this.viewportCappedEndRow:i>this.viewportStartRow&&i<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&i===this.viewportStartRow&&t>=this.startCol&&t<this.endCol||this.viewportStartRow<this.viewportEndRow&&i===this.viewportEndRow&&t<this.endCol||this.viewportStartRow<this.viewportEndRow&&i===this.viewportStartRow&&t>=this.startCol)}}t.createSelectionRenderModel=function(){return new i}},456:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionModel=void 0,t.SelectionModel=class{constructor(e){this._bufferService=e,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const e=this.selectionStart[0]+this.selectionStartLength;return e>this._bufferService.cols?e%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(e/this._bufferService.cols)-1]:[e%this._bufferService.cols,this.selectionStart[1]+Math.floor(e/this._bufferService.cols)]:[e,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const e=this.selectionStart[0]+this.selectionStartLength;return e>this._bufferService.cols?[e%this._bufferService.cols,this.selectionStart[1]+Math.floor(e/this._bufferService.cols)]:[Math.max(e,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const e=this.selectionStart,t=this.selectionEnd;return!(!e||!t)&&(e[1]>t[1]||e[1]===t[1]&&e[0]>t[0])}handleTrim(e){return this.selectionStart&&(this.selectionStart[1]-=e),this.selectionEnd&&(this.selectionEnd[1]-=e),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CharSizeService=void 0;const r=i(2585),o=i(8460),a=i(844);let l=t.CharSizeService=class extends a.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(e,t,i){super(),this._optionsService=i,this.width=0,this.height=0,this._onCharSizeChange=this.register(new o.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event;try{this._measureStrategy=this.register(new d(this._optionsService))}catch{this._measureStrategy=this.register(new h(e,t,this._optionsService))}this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],(()=>this.measure())))}measure(){const e=this._measureStrategy.measure();e.width===this.width&&e.height===this.height||(this.width=e.width,this.height=e.height,this._onCharSizeChange.fire())}};t.CharSizeService=l=n([s(2,r.IOptionsService)],l);class c extends a.Disposable{constructor(){super(...arguments),this._result={width:0,height:0}}_validateAndSet(e,t){void 0!==e&&e>0&&void 0!==t&&t>0&&(this._result.width=e,this._result.height=t)}}class h extends c{constructor(e,t,i){super(),this._document=e,this._parentElement=t,this._optionsService=i,this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){return this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`,this._validateAndSet(Number(this._measureElement.offsetWidth)/32,Number(this._measureElement.offsetHeight)),this._result}}class d extends c{constructor(e){super(),this._optionsService=e,this._canvas=new OffscreenCanvas(100,100),this._ctx=this._canvas.getContext("2d");const t=this._ctx.measureText("W");if(!("width"in t&&"fontBoundingBoxAscent"in t&&"fontBoundingBoxDescent"in t))throw new Error("Required font metrics not supported")}measure(){this._ctx.font=`${this._optionsService.rawOptions.fontSize}px ${this._optionsService.rawOptions.fontFamily}`;const e=this._ctx.measureText("W");return this._validateAndSet(e.width,e.fontBoundingBoxAscent+e.fontBoundingBoxDescent),this._result}}},4269:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CharacterJoinerService=t.JoinedCellData=void 0;const r=i(3734),o=i(643),a=i(511),l=i(2585);class c extends r.AttributeData{constructor(e,t,i){super(),this.content=0,this.combinedData="",this.fg=e.fg,this.bg=e.bg,this.combinedData=t,this._width=i}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(e){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}t.JoinedCellData=c;let h=t.CharacterJoinerService=class e{constructor(e){this._bufferService=e,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new a.CellData}register(e){const t={id:this._nextCharacterJoinerId++,handler:e};return this._characterJoiners.push(t),t.id}deregister(e){for(let t=0;t<this._characterJoiners.length;t++)if(this._characterJoiners[t].id===e)return this._characterJoiners.splice(t,1),!0;return!1}getJoinedCharacters(e){if(0===this._characterJoiners.length)return[];const t=this._bufferService.buffer.lines.get(e);if(!t||0===t.length)return[];const i=[],n=t.translateToString(!0);let s=0,r=0,a=0,l=t.getFg(0),c=t.getBg(0);for(let e=0;e<t.getTrimmedLength();e++)if(t.loadCell(e,this._workCell),0!==this._workCell.getWidth()){if(this._workCell.fg!==l||this._workCell.bg!==c){if(e-s>1){const e=this._getJoinedRanges(n,a,r,t,s);for(let t=0;t<e.length;t++)i.push(e[t])}s=e,a=r,l=this._workCell.fg,c=this._workCell.bg}r+=this._workCell.getChars().length||o.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-s>1){const e=this._getJoinedRanges(n,a,r,t,s);for(let t=0;t<e.length;t++)i.push(e[t])}return i}_getJoinedRanges(t,i,n,s,r){const o=t.substring(i,n);let a=[];try{a=this._characterJoiners[0].handler(o)}catch(e){console.error(e)}for(let t=1;t<this._characterJoiners.length;t++)try{const i=this._characterJoiners[t].handler(o);for(let t=0;t<i.length;t++)e._mergeRanges(a,i[t])}catch(e){console.error(e)}return this._stringRangesToCellRanges(a,s,r),a}_stringRangesToCellRanges(e,t,i){let n=0,s=!1,r=0,a=e[n];if(a){for(let l=i;l<this._bufferService.cols;l++){const i=t.getWidth(l),c=t.getString(l).length||o.WHITESPACE_CELL_CHAR.length;if(0!==i){if(!s&&a[0]<=r&&(a[0]=l,s=!0),a[1]<=r){if(a[1]=l,a=e[++n],!a)break;a[0]<=r?(a[0]=l,s=!0):s=!1}r+=c}}a&&(a[1]=this._bufferService.cols)}}static _mergeRanges(e,t){let i=!1;for(let n=0;n<e.length;n++){const s=e[n];if(i){if(t[1]<=s[0])return e[n-1][1]=t[1],e;if(t[1]<=s[1])return e[n-1][1]=Math.max(t[1],s[1]),e.splice(n,1),e;e.splice(n,1),n--}else{if(t[1]<=s[0])return e.splice(n,0,t),e;if(t[1]<=s[1])return s[0]=Math.min(t[0],s[0]),e;t[0]<s[1]&&(s[0]=Math.min(t[0],s[0]),i=!0)}}return i?e[e.length-1][1]=t[1]:e.push(t),e}};t.CharacterJoinerService=h=n([s(0,l.IBufferService)],h)},5114:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CoreBrowserService=void 0;const n=i(844),s=i(8460),r=i(3656);class o extends n.Disposable{constructor(e,t,i){super(),this._textarea=e,this._window=t,this.mainDocument=i,this._isFocused=!1,this._cachedIsFocused=void 0,this._screenDprMonitor=new a(this._window),this._onDprChange=this.register(new s.EventEmitter),this.onDprChange=this._onDprChange.event,this._onWindowChange=this.register(new s.EventEmitter),this.onWindowChange=this._onWindowChange.event,this.register(this.onWindowChange((e=>this._screenDprMonitor.setWindow(e)))),this.register((0,s.forwardEvent)(this._screenDprMonitor.onDprChange,this._onDprChange)),this._textarea.addEventListener("focus",(()=>this._isFocused=!0)),this._textarea.addEventListener("blur",(()=>this._isFocused=!1))}get window(){return this._window}set window(e){this._window!==e&&(this._window=e,this._onWindowChange.fire(this._window))}get dpr(){return this.window.devicePixelRatio}get isFocused(){return void 0===this._cachedIsFocused&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask((()=>this._cachedIsFocused=void 0))),this._cachedIsFocused}}t.CoreBrowserService=o;class a extends n.Disposable{constructor(e){super(),this._parentWindow=e,this._windowResizeListener=this.register(new n.MutableDisposable),this._onDprChange=this.register(new s.EventEmitter),this.onDprChange=this._onDprChange.event,this._outerListener=()=>this._setDprAndFireIfDiffers(),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._updateDpr(),this._setWindowResizeListener(),this.register((0,n.toDisposable)((()=>this.clearListener())))}setWindow(e){this._parentWindow=e,this._setWindowResizeListener(),this._setDprAndFireIfDiffers()}_setWindowResizeListener(){this._windowResizeListener.value=(0,r.addDisposableDomListener)(this._parentWindow,"resize",(()=>this._setDprAndFireIfDiffers()))}_setDprAndFireIfDiffers(){this._parentWindow.devicePixelRatio!==this._currentDevicePixelRatio&&this._onDprChange.fire(this._parentWindow.devicePixelRatio),this._updateDpr()}_updateDpr(){this._outerListener&&(this._resolutionMediaMatchList?.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._outerListener=void 0)}}},779:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LinkProviderService=void 0;const n=i(844);class s extends n.Disposable{constructor(){super(),this.linkProviders=[],this.register((0,n.toDisposable)((()=>this.linkProviders.length=0)))}registerLinkProvider(e){return this.linkProviders.push(e),{dispose:()=>{const t=this.linkProviders.indexOf(e);-1!==t&&this.linkProviders.splice(t,1)}}}}t.LinkProviderService=s},8934:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.MouseService=void 0;const r=i(4725),o=i(9806);let a=t.MouseService=class{constructor(e,t){this._renderService=e,this._charSizeService=t}getCoords(e,t,i,n,s){return(0,o.getCoords)(window,e,t,i,n,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,s)}getMouseReportCoords(e,t){const i=(0,o.getCoordsRelativeToElement)(window,e,t);if(this._charSizeService.hasValidSize)return i[0]=Math.min(Math.max(i[0],0),this._renderService.dimensions.css.canvas.width-1),i[1]=Math.min(Math.max(i[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(i[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(i[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(i[0]),y:Math.floor(i[1])}}};t.MouseService=a=n([s(0,r.IRenderService),s(1,r.ICharSizeService)],a)},3230:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.RenderService=void 0;const r=i(6193),o=i(4725),a=i(8460),l=i(844),c=i(7226),h=i(2585);let d=t.RenderService=class extends l.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(e,t,i,n,s,o,h,d){super(),this._rowCount=e,this._charSizeService=n,this._renderer=this.register(new l.MutableDisposable),this._pausedResizeTask=new c.DebouncedIdleTask,this._observerDisposable=this.register(new l.MutableDisposable),this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new a.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new a.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new a.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new a.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new r.RenderDebouncer(((e,t)=>this._renderRows(e,t)),h),this.register(this._renderDebouncer),this.register(h.onDprChange((()=>this.handleDevicePixelRatioChange()))),this.register(o.onResize((()=>this._fullRefresh()))),this.register(o.buffers.onBufferActivate((()=>this._renderer.value?.clear()))),this.register(i.onOptionChange((()=>this._handleOptionsChanged()))),this.register(this._charSizeService.onCharSizeChange((()=>this.handleCharSizeChanged()))),this.register(s.onDecorationRegistered((()=>this._fullRefresh()))),this.register(s.onDecorationRemoved((()=>this._fullRefresh()))),this.register(i.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio","rescaleOverlappingGlyphs"],(()=>{this.clear(),this.handleResize(o.cols,o.rows),this._fullRefresh()}))),this.register(i.onMultipleOptionChange(["cursorBlink","cursorStyle"],(()=>this.refreshRows(o.buffer.y,o.buffer.y,!0)))),this.register(d.onChangeColors((()=>this._fullRefresh()))),this._registerIntersectionObserver(h.window,t),this.register(h.onWindowChange((e=>this._registerIntersectionObserver(e,t))))}_registerIntersectionObserver(e,t){if("IntersectionObserver"in e){const i=new e.IntersectionObserver((e=>this._handleIntersectionChange(e[e.length-1])),{threshold:0});i.observe(t),this._observerDisposable.value=(0,l.toDisposable)((()=>i.disconnect()))}}_handleIntersectionChange(e){this._isPaused=void 0===e.isIntersecting?0===e.intersectionRatio:!e.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(e,t,i=!1){this._isPaused?this._needsFullRefresh=!0:(i||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(e,t,this._rowCount))}_renderRows(e,t){this._renderer.value&&(e=Math.min(e,this._rowCount-1),t=Math.min(t,this._rowCount-1),this._renderer.value.renderRows(e,t),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:e,end:t}),this._onRender.fire({start:e,end:t}),this._isNextRenderRedrawOnly=!0)}resize(e,t){this._rowCount=t,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(e){this._renderer.value=e,this._renderer.value&&(this._renderer.value.onRequestRedraw((e=>this.refreshRows(e.start,e.end,!0))),this._needsSelectionRefresh=!0,this._fullRefresh())}addRefreshCallback(e){return this._renderDebouncer.addRefreshCallback(e)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){this._renderer.value&&(this._renderer.value.clearTextureAtlas?.(),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(e,t){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set((()=>this._renderer.value?.handleResize(e,t))):this._renderer.value.handleResize(e,t),this._fullRefresh())}handleCharSizeChanged(){this._renderer.value?.handleCharSizeChanged()}handleBlur(){this._renderer.value?.handleBlur()}handleFocus(){this._renderer.value?.handleFocus()}handleSelectionChanged(e,t,i){this._selectionState.start=e,this._selectionState.end=t,this._selectionState.columnSelectMode=i,this._renderer.value?.handleSelectionChanged(e,t,i)}handleCursorMove(){this._renderer.value?.handleCursorMove()}clear(){this._renderer.value?.clear()}};t.RenderService=d=n([s(2,h.IOptionsService),s(3,o.ICharSizeService),s(4,h.IDecorationService),s(5,h.IBufferService),s(6,o.ICoreBrowserService),s(7,o.IThemeService)],d)},9312:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionService=void 0;const r=i(9806),o=i(9504),a=i(456),l=i(4725),c=i(8460),h=i(844),d=i(6114),u=i(4841),p=i(511),f=i(2585),m=String.fromCharCode(160),g=new RegExp(m,"g");let v=t.SelectionService=class extends h.Disposable{constructor(e,t,i,n,s,r,o,l,d){super(),this._element=e,this._screenElement=t,this._linkifier=i,this._bufferService=n,this._coreService=s,this._mouseService=r,this._optionsService=o,this._renderService=l,this._coreBrowserService=d,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new p.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new c.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new c.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new c.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new c.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=e=>this._handleMouseMove(e),this._mouseUpListener=e=>this._handleMouseUp(e),this._coreService.onUserInput((()=>{this.hasSelection&&this.clearSelection()})),this._trimListener=this._bufferService.buffer.lines.onTrim((e=>this._handleTrim(e))),this.register(this._bufferService.buffers.onBufferActivate((e=>this._handleBufferActivate(e)))),this.enable(),this._model=new a.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,h.toDisposable)((()=>{this._removeMouseDownListeners()})))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd;return!(!e||!t||e[0]===t[0]&&e[1]===t[1])}get selectionText(){const e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd;if(!e||!t)return"";const i=this._bufferService.buffer,n=[];if(3===this._activeSelectionMode){if(e[0]===t[0])return"";const s=e[0]<t[0]?e[0]:t[0],r=e[0]<t[0]?t[0]:e[0];for(let o=e[1];o<=t[1];o++){const e=i.translateBufferLineToString(o,!0,s,r);n.push(e)}}else{const s=e[1]===t[1]?t[0]:void 0;n.push(i.translateBufferLineToString(e[1],!0,e[0],s));for(let s=e[1]+1;s<=t[1]-1;s++){const e=i.lines.get(s),t=i.translateBufferLineToString(s,!0);e?.isWrapped?n[n.length-1]+=t:n.push(t)}if(e[1]!==t[1]){const e=i.lines.get(t[1]),s=i.translateBufferLineToString(t[1],!0,0,t[0]);e&&e.isWrapped?n[n.length-1]+=s:n.push(s)}}return n.map((e=>e.replace(g," "))).join(d.isWindows?"\r\n":"\n")}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(e){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame((()=>this._refresh()))),d.isLinux&&e&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:3===this._activeSelectionMode})}_isClickInSelection(e){const t=this._getMouseBufferCoords(e),i=this._model.finalSelectionStart,n=this._model.finalSelectionEnd;return!!(i&&n&&t)&&this._areCoordsInSelection(t,i,n)}isCellInSelection(e,t){const i=this._model.finalSelectionStart,n=this._model.finalSelectionEnd;return!(!i||!n)&&this._areCoordsInSelection([e,t],i,n)}_areCoordsInSelection(e,t,i){return e[1]>t[1]&&e[1]<i[1]||t[1]===i[1]&&e[1]===t[1]&&e[0]>=t[0]&&e[0]<i[0]||t[1]<i[1]&&e[1]===i[1]&&e[0]<i[0]||t[1]<i[1]&&e[1]===t[1]&&e[0]>=t[0]}_selectWordAtCursor(e,t){const i=this._linkifier.currentLink?.link?.range;if(i)return this._model.selectionStart=[i.start.x-1,i.start.y-1],this._model.selectionStartLength=(0,u.getRangeLength)(i,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const n=this._getMouseBufferCoords(e);return!!n&&(this._selectWordAt(n,t),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(e,t){this._model.clearSelection(),e=Math.max(e,0),t=Math.min(t,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,e],this._model.selectionEnd=[this._bufferService.cols,t],this.refresh(),this._onSelectionChange.fire()}_handleTrim(e){this._model.handleTrim(e)&&this.refresh()}_getMouseBufferCoords(e){const t=this._mouseService.getCoords(e,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(t)return t[0]--,t[1]--,t[1]+=this._bufferService.buffer.ydisp,t}_getMouseEventScrollAmount(e){let t=(0,r.getCoordsRelativeToElement)(this._coreBrowserService.window,e,this._screenElement)[1];const i=this._renderService.dimensions.css.canvas.height;return t>=0&&t<=i?0:(t>i&&(t-=i),t=Math.min(Math.max(t,-50),50),t/=50,t/Math.abs(t)+Math.round(14*t))}shouldForceSelection(e){return d.isMac?e.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:e.shiftKey}handleMouseDown(e){if(this._mouseDownTimeStamp=e.timeStamp,(2!==e.button||!this.hasSelection)&&0===e.button){if(!this._enabled){if(!this.shouldForceSelection(e))return;e.stopPropagation()}e.preventDefault(),this._dragScrollAmount=0,this._enabled&&e.shiftKey?this._handleIncrementalClick(e):1===e.detail?this._handleSingleClick(e):2===e.detail?this._handleDoubleClick(e):3===e.detail&&this._handleTripleClick(e),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval((()=>this._dragScroll()),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(e){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(e))}_handleSingleClick(e){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(e)?3:0,this._model.selectionStart=this._getMouseBufferCoords(e),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const t=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);t&&t.length!==this._model.selectionStart[0]&&0===t.hasWidth(this._model.selectionStart[0])&&this._model.selectionStart[0]++}_handleDoubleClick(e){this._selectWordAtCursor(e,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(e){const t=this._getMouseBufferCoords(e);t&&(this._activeSelectionMode=2,this._selectLineAt(t[1]))}shouldColumnSelect(e){return e.altKey&&!(d.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(e){if(e.stopImmediatePropagation(),!this._model.selectionStart)return;const t=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(e),!this._model.selectionEnd)return void this.refresh(!0);2===this._activeSelectionMode?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:1===this._activeSelectionMode&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(e),3!==this._activeSelectionMode&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const i=this._bufferService.buffer;if(this._model.selectionEnd[1]<i.lines.length){const e=i.lines.get(this._model.selectionEnd[1]);e&&0===e.hasWidth(this._model.selectionEnd[0])&&this._model.selectionEnd[0]<this._bufferService.cols&&this._model.selectionEnd[0]++}t&&t[0]===this._model.selectionEnd[0]&&t[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const e=this._bufferService.buffer;this._dragScrollAmount>0?(3!==this._activeSelectionMode&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(e.ydisp+this._bufferService.rows,e.lines.length-1)):(3!==this._activeSelectionMode&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=e.ydisp),this.refresh()}}_handleMouseUp(e){const t=e.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&t<500&&e.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const t=this._mouseService.getCoords(e,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(t&&void 0!==t[0]&&void 0!==t[1]){const e=(0,o.moveToCellSequence)(t[0]-1,t[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(e,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd,i=!(!e||!t||e[0]===t[0]&&e[1]===t[1]);i?e&&t&&(this._oldSelectionStart&&this._oldSelectionEnd&&e[0]===this._oldSelectionStart[0]&&e[1]===this._oldSelectionStart[1]&&t[0]===this._oldSelectionEnd[0]&&t[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(e,t,i)):this._oldHasSelection&&this._fireOnSelectionChange(e,t,i)}_fireOnSelectionChange(e,t,i){this._oldSelectionStart=e,this._oldSelectionEnd=t,this._oldHasSelection=i,this._onSelectionChange.fire()}_handleBufferActivate(e){this.clearSelection(),this._trimListener.dispose(),this._trimListener=e.activeBuffer.lines.onTrim((e=>this._handleTrim(e)))}_convertViewportColToCharacterIndex(e,t){let i=t;for(let n=0;t>=n;n++){const s=e.loadCell(n,this._workCell).getChars().length;0===this._workCell.getWidth()?i--:s>1&&t!==n&&(i+=s-1)}return i}setSelection(e,t,i){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[e,t],this._model.selectionStartLength=i,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(e){this._isClickInSelection(e)||(this._selectWordAtCursor(e,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(e,t,i=!0,n=!0){if(e[0]>=this._bufferService.cols)return;const s=this._bufferService.buffer,r=s.lines.get(e[1]);if(!r)return;const o=s.translateBufferLineToString(e[1],!1);let a=this._convertViewportColToCharacterIndex(r,e[0]),l=a;const c=e[0]-a;let h=0,d=0,u=0,p=0;if(" "===o.charAt(a)){for(;a>0&&" "===o.charAt(a-1);)a--;for(;l<o.length&&" "===o.charAt(l+1);)l++}else{let t=e[0],i=e[0];0===r.getWidth(t)&&(h++,t--),2===r.getWidth(i)&&(d++,i++);const n=r.getString(i).length;for(n>1&&(p+=n-1,l+=n-1);t>0&&a>0&&!this._isCharWordSeparator(r.loadCell(t-1,this._workCell));){r.loadCell(t-1,this._workCell);const e=this._workCell.getChars().length;0===this._workCell.getWidth()?(h++,t--):e>1&&(u+=e-1,a-=e-1),a--,t--}for(;i<r.length&&l+1<o.length&&!this._isCharWordSeparator(r.loadCell(i+1,this._workCell));){r.loadCell(i+1,this._workCell);const e=this._workCell.getChars().length;2===this._workCell.getWidth()?(d++,i++):e>1&&(p+=e-1,l+=e-1),l++,i++}}l++;let f=a+c-h+u,m=Math.min(this._bufferService.cols,l-a+h+d-u-p);if(t||""!==o.slice(a,l).trim()){if(i&&0===f&&32!==r.getCodePoint(0)){const t=s.lines.get(e[1]-1);if(t&&r.isWrapped&&32!==t.getCodePoint(this._bufferService.cols-1)){const t=this._getWordAt([this._bufferService.cols-1,e[1]-1],!1,!0,!1);if(t){const e=this._bufferService.cols-t.start;f-=e,m+=e}}}if(n&&f+m===this._bufferService.cols&&32!==r.getCodePoint(this._bufferService.cols-1)){const t=s.lines.get(e[1]+1);if(t?.isWrapped&&32!==t.getCodePoint(0)){const t=this._getWordAt([0,e[1]+1],!1,!1,!0);t&&(m+=t.length)}}return{start:f,length:m}}}_selectWordAt(e,t){const i=this._getWordAt(e,t);if(i){for(;i.start<0;)i.start+=this._bufferService.cols,e[1]--;this._model.selectionStart=[i.start,e[1]],this._model.selectionStartLength=i.length}}_selectToWordAt(e){const t=this._getWordAt(e,!0);if(t){let i=e[1];for(;t.start<0;)t.start+=this._bufferService.cols,i--;if(!this._model.areSelectionValuesReversed())for(;t.start+t.length>this._bufferService.cols;)t.length-=this._bufferService.cols,i++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?t.start:t.start+t.length,i]}}_isCharWordSeparator(e){return 0!==e.getWidth()&&this._optionsService.rawOptions.wordSeparator.indexOf(e.getChars())>=0}_selectLineAt(e){const t=this._bufferService.buffer.getWrappedRangeForLine(e),i={start:{x:0,y:t.first},end:{x:this._bufferService.cols-1,y:t.last}};this._model.selectionStart=[0,t.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,u.getRangeLength)(i,this._bufferService.cols)}};t.SelectionService=v=n([s(3,f.IBufferService),s(4,f.ICoreService),s(5,l.IMouseService),s(6,f.IOptionsService),s(7,l.IRenderService),s(8,l.ICoreBrowserService)],v)},4725:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ILinkProviderService=t.IThemeService=t.ICharacterJoinerService=t.ISelectionService=t.IRenderService=t.IMouseService=t.ICoreBrowserService=t.ICharSizeService=void 0;const n=i(8343);t.ICharSizeService=(0,n.createDecorator)("CharSizeService"),t.ICoreBrowserService=(0,n.createDecorator)("CoreBrowserService"),t.IMouseService=(0,n.createDecorator)("MouseService"),t.IRenderService=(0,n.createDecorator)("RenderService"),t.ISelectionService=(0,n.createDecorator)("SelectionService"),t.ICharacterJoinerService=(0,n.createDecorator)("CharacterJoinerService"),t.IThemeService=(0,n.createDecorator)("ThemeService"),t.ILinkProviderService=(0,n.createDecorator)("LinkProviderService")},6731:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ThemeService=t.DEFAULT_ANSI_COLORS=void 0;const r=i(7239),o=i(8055),a=i(8460),l=i(844),c=i(2585),h=o.css.toColor("#ffffff"),d=o.css.toColor("#000000"),u=o.css.toColor("#ffffff"),p=o.css.toColor("#000000"),f={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};t.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const e=[o.css.toColor("#2e3436"),o.css.toColor("#cc0000"),o.css.toColor("#4e9a06"),o.css.toColor("#c4a000"),o.css.toColor("#3465a4"),o.css.toColor("#75507b"),o.css.toColor("#06989a"),o.css.toColor("#d3d7cf"),o.css.toColor("#555753"),o.css.toColor("#ef2929"),o.css.toColor("#8ae234"),o.css.toColor("#fce94f"),o.css.toColor("#729fcf"),o.css.toColor("#ad7fa8"),o.css.toColor("#34e2e2"),o.css.toColor("#eeeeec")],t=[0,95,135,175,215,255];for(let i=0;i<216;i++){const n=t[i/36%6|0],s=t[i/6%6|0],r=t[i%6];e.push({css:o.channels.toCss(n,s,r),rgba:o.channels.toRgba(n,s,r)})}for(let t=0;t<24;t++){const i=8+10*t;e.push({css:o.channels.toCss(i,i,i),rgba:o.channels.toRgba(i,i,i)})}return e})());let m=t.ThemeService=class extends l.Disposable{get colors(){return this._colors}constructor(e){super(),this._optionsService=e,this._contrastCache=new r.ColorContrastCache,this._halfContrastCache=new r.ColorContrastCache,this._onChangeColors=this.register(new a.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:h,background:d,cursor:u,cursorAccent:p,selectionForeground:void 0,selectionBackgroundTransparent:f,selectionBackgroundOpaque:o.color.blend(d,f),selectionInactiveBackgroundTransparent:f,selectionInactiveBackgroundOpaque:o.color.blend(d,f),ansi:t.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",(()=>this._contrastCache.clear()))),this.register(this._optionsService.onSpecificOptionChange("theme",(()=>this._setTheme(this._optionsService.rawOptions.theme))))}_setTheme(e={}){const i=this._colors;if(i.foreground=g(e.foreground,h),i.background=g(e.background,d),i.cursor=g(e.cursor,u),i.cursorAccent=g(e.cursorAccent,p),i.selectionBackgroundTransparent=g(e.selectionBackground,f),i.selectionBackgroundOpaque=o.color.blend(i.background,i.selectionBackgroundTransparent),i.selectionInactiveBackgroundTransparent=g(e.selectionInactiveBackground,i.selectionBackgroundTransparent),i.selectionInactiveBackgroundOpaque=o.color.blend(i.background,i.selectionInactiveBackgroundTransparent),i.selectionForeground=e.selectionForeground?g(e.selectionForeground,o.NULL_COLOR):void 0,i.selectionForeground===o.NULL_COLOR&&(i.selectionForeground=void 0),o.color.isOpaque(i.selectionBackgroundTransparent)){const e=.3;i.selectionBackgroundTransparent=o.color.opacity(i.selectionBackgroundTransparent,e)}if(o.color.isOpaque(i.selectionInactiveBackgroundTransparent)){const e=.3;i.selectionInactiveBackgroundTransparent=o.color.opacity(i.selectionInactiveBackgroundTransparent,e)}if(i.ansi=t.DEFAULT_ANSI_COLORS.slice(),i.ansi[0]=g(e.black,t.DEFAULT_ANSI_COLORS[0]),i.ansi[1]=g(e.red,t.DEFAULT_ANSI_COLORS[1]),i.ansi[2]=g(e.green,t.DEFAULT_ANSI_COLORS[2]),i.ansi[3]=g(e.yellow,t.DEFAULT_ANSI_COLORS[3]),i.ansi[4]=g(e.blue,t.DEFAULT_ANSI_COLORS[4]),i.ansi[5]=g(e.magenta,t.DEFAULT_ANSI_COLORS[5]),i.ansi[6]=g(e.cyan,t.DEFAULT_ANSI_COLORS[6]),i.ansi[7]=g(e.white,t.DEFAULT_ANSI_COLORS[7]),i.ansi[8]=g(e.brightBlack,t.DEFAULT_ANSI_COLORS[8]),i.ansi[9]=g(e.brightRed,t.DEFAULT_ANSI_COLORS[9]),i.ansi[10]=g(e.brightGreen,t.DEFAULT_ANSI_COLORS[10]),i.ansi[11]=g(e.brightYellow,t.DEFAULT_ANSI_COLORS[11]),i.ansi[12]=g(e.brightBlue,t.DEFAULT_ANSI_COLORS[12]),i.ansi[13]=g(e.brightMagenta,t.DEFAULT_ANSI_COLORS[13]),i.ansi[14]=g(e.brightCyan,t.DEFAULT_ANSI_COLORS[14]),i.ansi[15]=g(e.brightWhite,t.DEFAULT_ANSI_COLORS[15]),e.extendedAnsi){const n=Math.min(i.ansi.length-16,e.extendedAnsi.length);for(let s=0;s<n;s++)i.ansi[s+16]=g(e.extendedAnsi[s],t.DEFAULT_ANSI_COLORS[s+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(e){this._restoreColor(e),this._onChangeColors.fire(this.colors)}_restoreColor(e){if(void 0!==e)switch(e){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[e]=this._restoreColors.ansi[e]}else for(let e=0;e<this._restoreColors.ansi.length;++e)this._colors.ansi[e]=this._restoreColors.ansi[e]}modifyColors(e){e(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function g(e,t){if(void 0!==e)try{return o.css.toColor(e)}catch{}return t}t.ThemeService=m=n([s(0,c.IOptionsService)],m)},6349:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CircularList=void 0;const n=i(8460),s=i(844);class r extends s.Disposable{constructor(e){super(),this._maxLength=e,this.onDeleteEmitter=this.register(new n.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new n.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new n.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(e){if(this._maxLength===e)return;const t=new Array(e);for(let i=0;i<Math.min(e,this.length);i++)t[i]=this._array[this._getCyclicIndex(i)];this._array=t,this._maxLength=e,this._startIndex=0}get length(){return this._length}set length(e){if(e>this._length)for(let t=this._length;t<e;t++)this._array[t]=void 0;this._length=e}get(e){return this._array[this._getCyclicIndex(e)]}set(e,t){this._array[this._getCyclicIndex(e)]=t}push(e){this._array[this._getCyclicIndex(this._length)]=e,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(e,t,...i){if(t){for(let i=e;i<this._length-t;i++)this._array[this._getCyclicIndex(i)]=this._array[this._getCyclicIndex(i+t)];this._length-=t,this.onDeleteEmitter.fire({index:e,amount:t})}for(let t=this._length-1;t>=e;t--)this._array[this._getCyclicIndex(t+i.length)]=this._array[this._getCyclicIndex(t)];for(let t=0;t<i.length;t++)this._array[this._getCyclicIndex(e+t)]=i[t];if(i.length&&this.onInsertEmitter.fire({index:e,amount:i.length}),this._length+i.length>this._maxLength){const e=this._length+i.length-this._maxLength;this._startIndex+=e,this._length=this._maxLength,this.onTrimEmitter.fire(e)}else this._length+=i.length}trimStart(e){e>this._length&&(e=this._length),this._startIndex+=e,this._length-=e,this.onTrimEmitter.fire(e)}shiftElements(e,t,i){if(!(t<=0)){if(e<0||e>=this._length)throw new Error("start argument out of range");if(e+i<0)throw new Error("Cannot shift elements in list beyond index 0");if(i>0){for(let n=t-1;n>=0;n--)this.set(e+n+i,this.get(e+n));const n=e+t+i-this._length;if(n>0)for(this._length+=n;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let n=0;n<t;n++)this.set(e+n+i,this.get(e+n))}}_getCyclicIndex(e){return(this._startIndex+e)%this._maxLength}}t.CircularList=r},1439:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clone=void 0,t.clone=function e(t,i=5){if("object"!=typeof t)return t;const n=Array.isArray(t)?[]:{};for(const s in t)n[s]=i<=1?t[s]:t[s]&&e(t[s],i-1);return n}},8055:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.contrastRatio=t.toPaddedHex=t.rgba=t.rgb=t.css=t.color=t.channels=t.NULL_COLOR=void 0;let i=0,n=0,s=0,r=0;var o,a,l,c,h;function d(e){const t=e.toString(16);return t.length<2?"0"+t:t}function u(e,t){return e<t?(t+.05)/(e+.05):(e+.05)/(t+.05)}t.NULL_COLOR={css:"#00000000",rgba:0},function(e){e.toCss=function(e,t,i,n){return void 0!==n?`#${d(e)}${d(t)}${d(i)}${d(n)}`:`#${d(e)}${d(t)}${d(i)}`},e.toRgba=function(e,t,i,n=255){return(e<<24|t<<16|i<<8|n)>>>0},e.toColor=function(t,i,n,s){return{css:e.toCss(t,i,n,s),rgba:e.toRgba(t,i,n,s)}}}(o||(t.channels=o={})),function(e){function t(e,t){return r=Math.round(255*t),[i,n,s]=h.toChannels(e.rgba),{css:o.toCss(i,n,s,r),rgba:o.toRgba(i,n,s,r)}}e.blend=function(e,t){if(r=(255&t.rgba)/255,1===r)return{css:t.css,rgba:t.rgba};const a=t.rgba>>24&255,l=t.rgba>>16&255,c=t.rgba>>8&255,h=e.rgba>>24&255,d=e.rgba>>16&255,u=e.rgba>>8&255;return i=h+Math.round((a-h)*r),n=d+Math.round((l-d)*r),s=u+Math.round((c-u)*r),{css:o.toCss(i,n,s),rgba:o.toRgba(i,n,s)}},e.isOpaque=function(e){return!(255&~e.rgba)},e.ensureContrastRatio=function(e,t,i){const n=h.ensureContrastRatio(e.rgba,t.rgba,i);if(n)return o.toColor(n>>24&255,n>>16&255,n>>8&255)},e.opaque=function(e){const t=(255|e.rgba)>>>0;return[i,n,s]=h.toChannels(t),{css:o.toCss(i,n,s),rgba:t}},e.opacity=t,e.multiplyOpacity=function(e,i){return r=255&e.rgba,t(e,r*i/255)},e.toColorRGB=function(e){return[e.rgba>>24&255,e.rgba>>16&255,e.rgba>>8&255]}}(a||(t.color=a={})),function(e){let t,a;try{const e=document.createElement("canvas");e.width=1,e.height=1;const i=e.getContext("2d",{willReadFrequently:!0});i&&(t=i,t.globalCompositeOperation="copy",a=t.createLinearGradient(0,0,1,1))}catch{}e.toColor=function(e){if(e.match(/#[\da-f]{3,8}/i))switch(e.length){case 4:return i=parseInt(e.slice(1,2).repeat(2),16),n=parseInt(e.slice(2,3).repeat(2),16),s=parseInt(e.slice(3,4).repeat(2),16),o.toColor(i,n,s);case 5:return i=parseInt(e.slice(1,2).repeat(2),16),n=parseInt(e.slice(2,3).repeat(2),16),s=parseInt(e.slice(3,4).repeat(2),16),r=parseInt(e.slice(4,5).repeat(2),16),o.toColor(i,n,s,r);case 7:return{css:e,rgba:(parseInt(e.slice(1),16)<<8|255)>>>0};case 9:return{css:e,rgba:parseInt(e.slice(1),16)>>>0}}const l=e.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(l)return i=parseInt(l[1]),n=parseInt(l[2]),s=parseInt(l[3]),r=Math.round(255*(void 0===l[5]?1:parseFloat(l[5]))),o.toColor(i,n,s,r);if(!t||!a)throw new Error("css.toColor: Unsupported css format");if(t.fillStyle=a,t.fillStyle=e,"string"!=typeof t.fillStyle)throw new Error("css.toColor: Unsupported css format");if(t.fillRect(0,0,1,1),[i,n,s,r]=t.getImageData(0,0,1,1).data,255!==r)throw new Error("css.toColor: Unsupported css format");return{rgba:o.toRgba(i,n,s,r),css:e}}}(l||(t.css=l={})),function(e){function t(e,t,i){const n=e/255,s=t/255,r=i/255;return.2126*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.7152*(s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4))+.0722*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))}e.relativeLuminance=function(e){return t(e>>16&255,e>>8&255,255&e)},e.relativeLuminance2=t}(c||(t.rgb=c={})),function(e){function t(e,t,i){const n=e>>24&255,s=e>>16&255,r=e>>8&255;let o=t>>24&255,a=t>>16&255,l=t>>8&255,h=u(c.relativeLuminance2(o,a,l),c.relativeLuminance2(n,s,r));for(;h<i&&(o>0||a>0||l>0);)o-=Math.max(0,Math.ceil(.1*o)),a-=Math.max(0,Math.ceil(.1*a)),l-=Math.max(0,Math.ceil(.1*l)),h=u(c.relativeLuminance2(o,a,l),c.relativeLuminance2(n,s,r));return(o<<24|a<<16|l<<8|255)>>>0}function a(e,t,i){const n=e>>24&255,s=e>>16&255,r=e>>8&255;let o=t>>24&255,a=t>>16&255,l=t>>8&255,h=u(c.relativeLuminance2(o,a,l),c.relativeLuminance2(n,s,r));for(;h<i&&(o<255||a<255||l<255);)o=Math.min(255,o+Math.ceil(.1*(255-o))),a=Math.min(255,a+Math.ceil(.1*(255-a))),l=Math.min(255,l+Math.ceil(.1*(255-l))),h=u(c.relativeLuminance2(o,a,l),c.relativeLuminance2(n,s,r));return(o<<24|a<<16|l<<8|255)>>>0}e.blend=function(e,t){if(r=(255&t)/255,1===r)return t;const a=t>>24&255,l=t>>16&255,c=t>>8&255,h=e>>24&255,d=e>>16&255,u=e>>8&255;return i=h+Math.round((a-h)*r),n=d+Math.round((l-d)*r),s=u+Math.round((c-u)*r),o.toRgba(i,n,s)},e.ensureContrastRatio=function(e,i,n){const s=c.relativeLuminance(e>>8),r=c.relativeLuminance(i>>8);if(u(s,r)<n){if(r<s){const r=t(e,i,n),o=u(s,c.relativeLuminance(r>>8));if(o<n){const t=a(e,i,n);return o>u(s,c.relativeLuminance(t>>8))?r:t}return r}const o=a(e,i,n),l=u(s,c.relativeLuminance(o>>8));if(l<n){const r=t(e,i,n);return l>u(s,c.relativeLuminance(r>>8))?o:r}return o}},e.reduceLuminance=t,e.increaseLuminance=a,e.toChannels=function(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]}}(h||(t.rgba=h={})),t.toPaddedHex=d,t.contrastRatio=u},8969:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CoreTerminal=void 0;const n=i(844),s=i(2585),r=i(4348),o=i(7866),a=i(744),l=i(7302),c=i(6975),h=i(8460),d=i(1753),u=i(1480),p=i(7994),f=i(9282),m=i(5435),g=i(5981),v=i(2660);let _=!1;class b extends n.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new h.EventEmitter),this._onScroll.event((e=>{this._onScrollApi?.fire(e.position)}))),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(e){for(const t in e)this.optionsService.options[t]=e[t]}constructor(e){super(),this._windowsWrappingHeuristics=this.register(new n.MutableDisposable),this._onBinary=this.register(new h.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new h.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new h.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new h.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new h.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new h.EventEmitter),this._instantiationService=new r.InstantiationService,this.optionsService=this.register(new l.OptionsService(e)),this._instantiationService.setService(s.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(a.BufferService)),this._instantiationService.setService(s.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(o.LogService)),this._instantiationService.setService(s.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(c.CoreService)),this._instantiationService.setService(s.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(d.CoreMouseService)),this._instantiationService.setService(s.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(u.UnicodeService)),this._instantiationService.setService(s.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(p.CharsetService),this._instantiationService.setService(s.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(v.OscLinkService),this._instantiationService.setService(s.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new m.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,h.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,h.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,h.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,h.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom((()=>this.scrollToBottom()))),this.register(this.coreService.onUserInput((()=>this._writeBuffer.handleUserInput()))),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],(()=>this._handleWindowsPtyOptionChange()))),this.register(this._bufferService.onScroll((e=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)}))),this.register(this._inputHandler.onScroll((e=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)}))),this._writeBuffer=this.register(new g.WriteBuffer(((e,t)=>this._inputHandler.parse(e,t)))),this.register((0,h.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(e,t){this._writeBuffer.write(e,t)}writeSync(e,t){this._logService.logLevel<=s.LogLevelEnum.WARN&&!_&&(this._logService.warn("writeSync is unreliable and will be removed soon."),_=!0),this._writeBuffer.writeSync(e,t)}input(e,t=!0){this.coreService.triggerDataEvent(e,t)}resize(e,t){isNaN(e)||isNaN(t)||(e=Math.max(e,a.MINIMUM_COLS),t=Math.max(t,a.MINIMUM_ROWS),this._bufferService.resize(e,t))}scroll(e,t=!1){this._bufferService.scroll(e,t)}scrollLines(e,t,i){this._bufferService.scrollLines(e,t,i)}scrollPages(e){this.scrollLines(e*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(e){const t=e-this._bufferService.buffer.ydisp;0!==t&&this.scrollLines(t)}registerEscHandler(e,t){return this._inputHandler.registerEscHandler(e,t)}registerDcsHandler(e,t){return this._inputHandler.registerDcsHandler(e,t)}registerCsiHandler(e,t){return this._inputHandler.registerCsiHandler(e,t)}registerOscHandler(e,t){return this._inputHandler.registerOscHandler(e,t)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let e=!1;const t=this.optionsService.rawOptions.windowsPty;t&&void 0!==t.buildNumber&&void 0!==t.buildNumber?e=!!("conpty"===t.backend&&t.buildNumber<21376):this.optionsService.rawOptions.windowsMode&&(e=!0),e?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){const e=[];e.push(this.onLineFeed(f.updateWindowsModeWrappedState.bind(null,this._bufferService))),e.push(this.registerCsiHandler({final:"H"},(()=>((0,f.updateWindowsModeWrappedState)(this._bufferService),!1)))),this._windowsWrappingHeuristics.value=(0,n.toDisposable)((()=>{for(const t of e)t.dispose()}))}}}t.CoreTerminal=b},8460:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.runAndSubscribe=t.forwardEvent=t.EventEmitter=void 0,t.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=e=>(this._listeners.push(e),{dispose:()=>{if(!this._disposed)for(let t=0;t<this._listeners.length;t++)if(this._listeners[t]===e)return void this._listeners.splice(t,1)}})),this._event}fire(e,t){const i=[];for(let e=0;e<this._listeners.length;e++)i.push(this._listeners[e]);for(let n=0;n<i.length;n++)i[n].call(void 0,e,t)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},t.forwardEvent=function(e,t){return e((e=>t.fire(e)))},t.runAndSubscribe=function(e,t){return t(void 0),e((e=>t(e)))}},5435:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.InputHandler=t.WindowsOptionsReportType=void 0;const r=i(2584),o=i(7116),a=i(2015),l=i(844),c=i(482),h=i(8437),d=i(8460),u=i(643),p=i(511),f=i(3734),m=i(2585),g=i(1480),v=i(6242),_=i(6351),b=i(5941),y={"(":0,")":1,"*":2,"+":3,"-":1,".":2},C=131072;function w(e,t){if(e>24)return t.setWinLines||!1;switch(e){case 1:return!!t.restoreWin;case 2:return!!t.minimizeWin;case 3:return!!t.setWinPosition;case 4:return!!t.setWinSizePixels;case 5:return!!t.raiseWin;case 6:return!!t.lowerWin;case 7:return!!t.refreshWin;case 8:return!!t.setWinSizeChars;case 9:return!!t.maximizeWin;case 10:return!!t.fullscreenWin;case 11:return!!t.getWinState;case 13:return!!t.getWinPosition;case 14:return!!t.getWinSizePixels;case 15:return!!t.getScreenSizePixels;case 16:return!!t.getCellSizePixels;case 18:return!!t.getWinSizeChars;case 19:return!!t.getScreenSizeChars;case 20:return!!t.getIconTitle;case 21:return!!t.getWinTitle;case 22:return!!t.pushTitle;case 23:return!!t.popTitle;case 24:return!!t.setWinLines}return!1}var S;!function(e){e[e.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",e[e.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"}(S||(t.WindowsOptionsReportType=S={}));let E=0;class x extends l.Disposable{getAttrData(){return this._curAttrData}constructor(e,t,i,n,s,l,u,f,m=new a.EscapeSequenceParser){super(),this._bufferService=e,this._charsetService=t,this._coreService=i,this._logService=n,this._optionsService=s,this._oscLinkService=l,this._coreMouseService=u,this._unicodeService=f,this._parser=m,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new c.StringToUtf32,this._utf8Decoder=new c.Utf8ToUtf32,this._workCell=new p.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=h.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=h.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new d.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new d.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new d.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new d.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new d.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new d.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new d.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new d.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new d.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new d.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new d.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new d.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new d.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new T(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate((e=>this._activeBuffer=e.activeBuffer))),this._parser.setCsiHandlerFallback(((e,t)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(e),params:t.toArray()})})),this._parser.setEscHandlerFallback((e=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(e)})})),this._parser.setExecuteHandlerFallback((e=>{this._logService.debug("Unknown EXECUTE code: ",{code:e})})),this._parser.setOscHandlerFallback(((e,t,i)=>{this._logService.debug("Unknown OSC code: ",{identifier:e,action:t,data:i})})),this._parser.setDcsHandlerFallback(((e,t,i)=>{"HOOK"===t&&(i=i.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(e),action:t,payload:i})})),this._parser.setPrintHandler(((e,t,i)=>this.print(e,t,i))),this._parser.registerCsiHandler({final:"@"},(e=>this.insertChars(e))),this._parser.registerCsiHandler({intermediates:" ",final:"@"},(e=>this.scrollLeft(e))),this._parser.registerCsiHandler({final:"A"},(e=>this.cursorUp(e))),this._parser.registerCsiHandler({intermediates:" ",final:"A"},(e=>this.scrollRight(e))),this._parser.registerCsiHandler({final:"B"},(e=>this.cursorDown(e))),this._parser.registerCsiHandler({final:"C"},(e=>this.cursorForward(e))),this._parser.registerCsiHandler({final:"D"},(e=>this.cursorBackward(e))),this._parser.registerCsiHandler({final:"E"},(e=>this.cursorNextLine(e))),this._parser.registerCsiHandler({final:"F"},(e=>this.cursorPrecedingLine(e))),this._parser.registerCsiHandler({final:"G"},(e=>this.cursorCharAbsolute(e))),this._parser.registerCsiHandler({final:"H"},(e=>this.cursorPosition(e))),this._parser.registerCsiHandler({final:"I"},(e=>this.cursorForwardTab(e))),this._parser.registerCsiHandler({final:"J"},(e=>this.eraseInDisplay(e,!1))),this._parser.registerCsiHandler({prefix:"?",final:"J"},(e=>this.eraseInDisplay(e,!0))),this._parser.registerCsiHandler({final:"K"},(e=>this.eraseInLine(e,!1))),this._parser.registerCsiHandler({prefix:"?",final:"K"},(e=>this.eraseInLine(e,!0))),this._parser.registerCsiHandler({final:"L"},(e=>this.insertLines(e))),this._parser.registerCsiHandler({final:"M"},(e=>this.deleteLines(e))),this._parser.registerCsiHandler({final:"P"},(e=>this.deleteChars(e))),this._parser.registerCsiHandler({final:"S"},(e=>this.scrollUp(e))),this._parser.registerCsiHandler({final:"T"},(e=>this.scrollDown(e))),this._parser.registerCsiHandler({final:"X"},(e=>this.eraseChars(e))),this._parser.registerCsiHandler({final:"Z"},(e=>this.cursorBackwardTab(e))),this._parser.registerCsiHandler({final:"`"},(e=>this.charPosAbsolute(e))),this._parser.registerCsiHandler({final:"a"},(e=>this.hPositionRelative(e))),this._parser.registerCsiHandler({final:"b"},(e=>this.repeatPrecedingCharacter(e))),this._parser.registerCsiHandler({final:"c"},(e=>this.sendDeviceAttributesPrimary(e))),this._parser.registerCsiHandler({prefix:">",final:"c"},(e=>this.sendDeviceAttributesSecondary(e))),this._parser.registerCsiHandler({final:"d"},(e=>this.linePosAbsolute(e))),this._parser.registerCsiHandler({final:"e"},(e=>this.vPositionRelative(e))),this._parser.registerCsiHandler({final:"f"},(e=>this.hVPosition(e))),this._parser.registerCsiHandler({final:"g"},(e=>this.tabClear(e))),this._parser.registerCsiHandler({final:"h"},(e=>this.setMode(e))),this._parser.registerCsiHandler({prefix:"?",final:"h"},(e=>this.setModePrivate(e))),this._parser.registerCsiHandler({final:"l"},(e=>this.resetMode(e))),this._parser.registerCsiHandler({prefix:"?",final:"l"},(e=>this.resetModePrivate(e))),this._parser.registerCsiHandler({final:"m"},(e=>this.charAttributes(e))),this._parser.registerCsiHandler({final:"n"},(e=>this.deviceStatus(e))),this._parser.registerCsiHandler({prefix:"?",final:"n"},(e=>this.deviceStatusPrivate(e))),this._parser.registerCsiHandler({intermediates:"!",final:"p"},(e=>this.softReset(e))),this._parser.registerCsiHandler({intermediates:" ",final:"q"},(e=>this.setCursorStyle(e))),this._parser.registerCsiHandler({final:"r"},(e=>this.setScrollRegion(e))),this._parser.registerCsiHandler({final:"s"},(e=>this.saveCursor(e))),this._parser.registerCsiHandler({final:"t"},(e=>this.windowOptions(e))),this._parser.registerCsiHandler({final:"u"},(e=>this.restoreCursor(e))),this._parser.registerCsiHandler({intermediates:"'",final:"}"},(e=>this.insertColumns(e))),this._parser.registerCsiHandler({intermediates:"'",final:"~"},(e=>this.deleteColumns(e))),this._parser.registerCsiHandler({intermediates:'"',final:"q"},(e=>this.selectProtected(e))),this._parser.registerCsiHandler({intermediates:"$",final:"p"},(e=>this.requestMode(e,!0))),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},(e=>this.requestMode(e,!1))),this._parser.setExecuteHandler(r.C0.BEL,(()=>this.bell())),this._parser.setExecuteHandler(r.C0.LF,(()=>this.lineFeed())),this._parser.setExecuteHandler(r.C0.VT,(()=>this.lineFeed())),this._parser.setExecuteHandler(r.C0.FF,(()=>this.lineFeed())),this._parser.setExecuteHandler(r.C0.CR,(()=>this.carriageReturn())),this._parser.setExecuteHandler(r.C0.BS,(()=>this.backspace())),this._parser.setExecuteHandler(r.C0.HT,(()=>this.tab())),this._parser.setExecuteHandler(r.C0.SO,(()=>this.shiftOut())),this._parser.setExecuteHandler(r.C0.SI,(()=>this.shiftIn())),this._parser.setExecuteHandler(r.C1.IND,(()=>this.index())),this._parser.setExecuteHandler(r.C1.NEL,(()=>this.nextLine())),this._parser.setExecuteHandler(r.C1.HTS,(()=>this.tabSet())),this._parser.registerOscHandler(0,new v.OscHandler((e=>(this.setTitle(e),this.setIconName(e),!0)))),this._parser.registerOscHandler(1,new v.OscHandler((e=>this.setIconName(e)))),this._parser.registerOscHandler(2,new v.OscHandler((e=>this.setTitle(e)))),this._parser.registerOscHandler(4,new v.OscHandler((e=>this.setOrReportIndexedColor(e)))),this._parser.registerOscHandler(8,new v.OscHandler((e=>this.setHyperlink(e)))),this._parser.registerOscHandler(10,new v.OscHandler((e=>this.setOrReportFgColor(e)))),this._parser.registerOscHandler(11,new v.OscHandler((e=>this.setOrReportBgColor(e)))),this._parser.registerOscHandler(12,new v.OscHandler((e=>this.setOrReportCursorColor(e)))),this._parser.registerOscHandler(104,new v.OscHandler((e=>this.restoreIndexedColor(e)))),this._parser.registerOscHandler(110,new v.OscHandler((e=>this.restoreFgColor(e)))),this._parser.registerOscHandler(111,new v.OscHandler((e=>this.restoreBgColor(e)))),this._parser.registerOscHandler(112,new v.OscHandler((e=>this.restoreCursorColor(e)))),this._parser.registerEscHandler({final:"7"},(()=>this.saveCursor())),this._parser.registerEscHandler({final:"8"},(()=>this.restoreCursor())),this._parser.registerEscHandler({final:"D"},(()=>this.index())),this._parser.registerEscHandler({final:"E"},(()=>this.nextLine())),this._parser.registerEscHandler({final:"H"},(()=>this.tabSet())),this._parser.registerEscHandler({final:"M"},(()=>this.reverseIndex())),this._parser.registerEscHandler({final:"="},(()=>this.keypadApplicationMode())),this._parser.registerEscHandler({final:">"},(()=>this.keypadNumericMode())),this._parser.registerEscHandler({final:"c"},(()=>this.fullReset())),this._parser.registerEscHandler({final:"n"},(()=>this.setgLevel(2))),this._parser.registerEscHandler({final:"o"},(()=>this.setgLevel(3))),this._parser.registerEscHandler({final:"|"},(()=>this.setgLevel(3))),this._parser.registerEscHandler({final:"}"},(()=>this.setgLevel(2))),this._parser.registerEscHandler({final:"~"},(()=>this.setgLevel(1))),this._parser.registerEscHandler({intermediates:"%",final:"@"},(()=>this.selectDefaultCharset())),this._parser.registerEscHandler({intermediates:"%",final:"G"},(()=>this.selectDefaultCharset()));for(const e in o.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:e},(()=>this.selectCharset("("+e))),this._parser.registerEscHandler({intermediates:")",final:e},(()=>this.selectCharset(")"+e))),this._parser.registerEscHandler({intermediates:"*",final:e},(()=>this.selectCharset("*"+e))),this._parser.registerEscHandler({intermediates:"+",final:e},(()=>this.selectCharset("+"+e))),this._parser.registerEscHandler({intermediates:"-",final:e},(()=>this.selectCharset("-"+e))),this._parser.registerEscHandler({intermediates:".",final:e},(()=>this.selectCharset("."+e))),this._parser.registerEscHandler({intermediates:"/",final:e},(()=>this.selectCharset("/"+e)));this._parser.registerEscHandler({intermediates:"#",final:"8"},(()=>this.screenAlignmentPattern())),this._parser.setErrorHandler((e=>(this._logService.error("Parsing error: ",e),e))),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new _.DcsHandler(((e,t)=>this.requestStatusString(e,t))))}_preserveStack(e,t,i,n){this._parseStack.paused=!0,this._parseStack.cursorStartX=e,this._parseStack.cursorStartY=t,this._parseStack.decodedLength=i,this._parseStack.position=n}_logSlowResolvingAsync(e){this._logService.logLevel<=m.LogLevelEnum.WARN&&Promise.race([e,new Promise(((e,t)=>setTimeout((()=>t("#SLOW_TIMEOUT")),5e3)))]).catch((e=>{if("#SLOW_TIMEOUT"!==e)throw e;console.warn("async parser handler taking longer than 5000 ms")}))}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(e,t){let i,n=this._activeBuffer.x,s=this._activeBuffer.y,r=0;const o=this._parseStack.paused;if(o){if(i=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,t))return this._logSlowResolvingAsync(i),i;n=this._parseStack.cursorStartX,s=this._parseStack.cursorStartY,this._parseStack.paused=!1,e.length>C&&(r=this._parseStack.position+C)}if(this._logService.logLevel<=m.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+("string"==typeof e?` "${e}"`:` "${Array.prototype.map.call(e,(e=>String.fromCharCode(e))).join("")}"`),"string"==typeof e?e.split("").map((e=>e.charCodeAt(0))):e),this._parseBuffer.length<e.length&&this._parseBuffer.length<C&&(this._parseBuffer=new Uint32Array(Math.min(e.length,C))),o||this._dirtyRowTracker.clearRange(),e.length>C)for(let t=r;t<e.length;t+=C){const r=t+C<e.length?t+C:e.length,o="string"==typeof e?this._stringDecoder.decode(e.substring(t,r),this._parseBuffer):this._utf8Decoder.decode(e.subarray(t,r),this._parseBuffer);if(i=this._parser.parse(this._parseBuffer,o))return this._preserveStack(n,s,o,t),this._logSlowResolvingAsync(i),i}else if(!o){const t="string"==typeof e?this._stringDecoder.decode(e,this._parseBuffer):this._utf8Decoder.decode(e,this._parseBuffer);if(i=this._parser.parse(this._parseBuffer,t))return this._preserveStack(n,s,t,0),this._logSlowResolvingAsync(i),i}this._activeBuffer.x===n&&this._activeBuffer.y===s||this._onCursorMove.fire();const a=this._dirtyRowTracker.end+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp),l=this._dirtyRowTracker.start+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp);l<this._bufferService.rows&&this._onRequestRefreshRows.fire(Math.min(l,this._bufferService.rows-1),Math.min(a,this._bufferService.rows-1))}print(e,t,i){let n,s;const r=this._charsetService.charset,o=this._optionsService.rawOptions.screenReaderMode,a=this._bufferService.cols,l=this._coreService.decPrivateModes.wraparound,d=this._coreService.modes.insertMode,p=this._curAttrData;let f=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&i-t>0&&2===f.getWidth(this._activeBuffer.x-1)&&f.setCellFromCodepoint(this._activeBuffer.x-1,0,1,p);let m=this._parser.precedingJoinState;for(let v=t;v<i;++v){if(n=e[v],n<127&&r){const e=r[String.fromCharCode(n)];e&&(n=e.charCodeAt(0))}const t=this._unicodeService.charProperties(n,m);s=g.UnicodeService.extractWidth(t);const i=g.UnicodeService.extractShouldJoin(t),_=i?g.UnicodeService.extractWidth(m):0;if(m=t,o&&this._onA11yChar.fire((0,c.stringFromCodePoint)(n)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),this._activeBuffer.x+s-_>a)if(l){const e=f;let t=this._activeBuffer.x-_;for(this._activeBuffer.x=_,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),f=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y),_>0&&f instanceof h.BufferLine&&f.copyCellsFrom(e,t,0,_,!1);t<a;)e.setCellFromCodepoint(t++,0,1,p)}else if(this._activeBuffer.x=a-1,2===s)continue;if(i&&this._activeBuffer.x){const e=f.getWidth(this._activeBuffer.x-1)?1:2;f.addCodepointToCell(this._activeBuffer.x-e,n,s);for(let e=s-_;--e>=0;)f.setCellFromCodepoint(this._activeBuffer.x++,0,0,p)}else if(d&&(f.insertCells(this._activeBuffer.x,s-_,this._activeBuffer.getNullCell(p)),2===f.getWidth(a-1)&&f.setCellFromCodepoint(a-1,u.NULL_CELL_CODE,u.NULL_CELL_WIDTH,p)),f.setCellFromCodepoint(this._activeBuffer.x++,n,s,p),s>0)for(;--s;)f.setCellFromCodepoint(this._activeBuffer.x++,0,0,p)}this._parser.precedingJoinState=m,this._activeBuffer.x<a&&i-t>0&&0===f.getWidth(this._activeBuffer.x)&&!f.hasContent(this._activeBuffer.x)&&f.setCellFromCodepoint(this._activeBuffer.x,0,1,p),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(e,t){return"t"!==e.final||e.prefix||e.intermediates?this._parser.registerCsiHandler(e,t):this._parser.registerCsiHandler(e,(e=>!w(e.params[0],this._optionsService.rawOptions.windowOptions)||t(e)))}registerDcsHandler(e,t){return this._parser.registerDcsHandler(e,new _.DcsHandler(t))}registerEscHandler(e,t){return this._parser.registerEscHandler(e,t)}registerOscHandler(e,t){return this._parser.registerOscHandler(e,new v.OscHandler(t))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(0===this._activeBuffer.x&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)?.isWrapped){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const e=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);e.hasWidth(this._activeBuffer.x)&&!e.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const e=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-e),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(e=this._bufferService.cols-1){this._activeBuffer.x=Math.min(e,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(e,t){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=e,this._activeBuffer.y=this._activeBuffer.scrollTop+t):(this._activeBuffer.x=e,this._activeBuffer.y=t),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(e,t){this._restrictCursor(),this._setCursor(this._activeBuffer.x+e,this._activeBuffer.y+t)}cursorUp(e){const t=this._activeBuffer.y-this._activeBuffer.scrollTop;return t>=0?this._moveCursor(0,-Math.min(t,e.params[0]||1)):this._moveCursor(0,-(e.params[0]||1)),!0}cursorDown(e){const t=this._activeBuffer.scrollBottom-this._activeBuffer.y;return t>=0?this._moveCursor(0,Math.min(t,e.params[0]||1)):this._moveCursor(0,e.params[0]||1),!0}cursorForward(e){return this._moveCursor(e.params[0]||1,0),!0}cursorBackward(e){return this._moveCursor(-(e.params[0]||1),0),!0}cursorNextLine(e){return this.cursorDown(e),this._activeBuffer.x=0,!0}cursorPrecedingLine(e){return this.cursorUp(e),this._activeBuffer.x=0,!0}cursorCharAbsolute(e){return this._setCursor((e.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(e){return this._setCursor(e.length>=2?(e.params[1]||1)-1:0,(e.params[0]||1)-1),!0}charPosAbsolute(e){return this._setCursor((e.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(e){return this._moveCursor(e.params[0]||1,0),!0}linePosAbsolute(e){return this._setCursor(this._activeBuffer.x,(e.params[0]||1)-1),!0}vPositionRelative(e){return this._moveCursor(0,e.params[0]||1),!0}hVPosition(e){return this.cursorPosition(e),!0}tabClear(e){const t=e.params[0];return 0===t?delete this._activeBuffer.tabs[this._activeBuffer.x]:3===t&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(e){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let t=e.params[0]||1;for(;t--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(e){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let t=e.params[0]||1;for(;t--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(e){const t=e.params[0];return 1===t&&(this._curAttrData.bg|=536870912),2!==t&&0!==t||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(e,t,i,n=!1,s=!1){const r=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);r.replaceCells(t,i,this._activeBuffer.getNullCell(this._eraseAttrData()),s),n&&(r.isWrapped=!1)}_resetBufferLine(e,t=!1){const i=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);i&&(i.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),t),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+e),i.isWrapped=!1)}eraseInDisplay(e,t=!1){let i;switch(this._restrictCursor(this._bufferService.cols),e.params[0]){case 0:for(i=this._activeBuffer.y,this._dirtyRowTracker.markDirty(i),this._eraseInBufferLine(i++,this._activeBuffer.x,this._bufferService.cols,0===this._activeBuffer.x,t);i<this._bufferService.rows;i++)this._resetBufferLine(i,t);this._dirtyRowTracker.markDirty(i);break;case 1:for(i=this._activeBuffer.y,this._dirtyRowTracker.markDirty(i),this._eraseInBufferLine(i,0,this._activeBuffer.x+1,!0,t),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(i+1).isWrapped=!1);i--;)this._resetBufferLine(i,t);this._dirtyRowTracker.markDirty(0);break;case 2:for(i=this._bufferService.rows,this._dirtyRowTracker.markDirty(i-1);i--;)this._resetBufferLine(i,t);this._dirtyRowTracker.markDirty(0);break;case 3:const e=this._activeBuffer.lines.length-this._bufferService.rows;e>0&&(this._activeBuffer.lines.trimStart(e),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-e,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-e,0),this._onScroll.fire(0))}return!0}eraseInLine(e,t=!1){switch(this._restrictCursor(this._bufferService.cols),e.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,0===this._activeBuffer.x,t);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,t);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,t)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(e){this._restrictCursor();let t=e.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const i=this._activeBuffer.ybase+this._activeBuffer.y,n=this._bufferService.rows-1-this._activeBuffer.scrollBottom,s=this._bufferService.rows-1+this._activeBuffer.ybase-n+1;for(;t--;)this._activeBuffer.lines.splice(s-1,1),this._activeBuffer.lines.splice(i,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(e){this._restrictCursor();let t=e.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const i=this._activeBuffer.ybase+this._activeBuffer.y;let n;for(n=this._bufferService.rows-1-this._activeBuffer.scrollBottom,n=this._bufferService.rows-1+this._activeBuffer.ybase-n;t--;)this._activeBuffer.lines.splice(i,1),this._activeBuffer.lines.splice(n,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(e){this._restrictCursor();const t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return t&&(t.insertCells(this._activeBuffer.x,e.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(e){this._restrictCursor();const t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return t&&(t.deleteCells(this._activeBuffer.x,e.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(e){let t=e.params[0]||1;for(;t--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(e){let t=e.params[0]||1;for(;t--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(h.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const t=e.params[0]||1;for(let e=this._activeBuffer.scrollTop;e<=this._activeBuffer.scrollBottom;++e){const i=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);i.deleteCells(0,t,this._activeBuffer.getNullCell(this._eraseAttrData())),i.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const t=e.params[0]||1;for(let e=this._activeBuffer.scrollTop;e<=this._activeBuffer.scrollBottom;++e){const i=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);i.insertCells(0,t,this._activeBuffer.getNullCell(this._eraseAttrData())),i.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const t=e.params[0]||1;for(let e=this._activeBuffer.scrollTop;e<=this._activeBuffer.scrollBottom;++e){const i=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);i.insertCells(this._activeBuffer.x,t,this._activeBuffer.getNullCell(this._eraseAttrData())),i.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const t=e.params[0]||1;for(let e=this._activeBuffer.scrollTop;e<=this._activeBuffer.scrollBottom;++e){const i=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);i.deleteCells(this._activeBuffer.x,t,this._activeBuffer.getNullCell(this._eraseAttrData())),i.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(e){this._restrictCursor();const t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return t&&(t.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(e.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(e){const t=this._parser.precedingJoinState;if(!t)return!0;const i=e.params[0]||1,n=g.UnicodeService.extractWidth(t),s=this._activeBuffer.x-n,r=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).getString(s),o=new Uint32Array(r.length*i);let a=0;for(let e=0;e<r.length;){const t=r.codePointAt(e)||0;o[a++]=t,e+=t>65535?2:1}let l=a;for(let e=1;e<i;++e)o.copyWithin(l,0,a),l+=a;return this.print(o,0,l),!0}sendDeviceAttributesPrimary(e){return e.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(r.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(r.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(e){return e.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(r.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(r.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(e.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(r.C0.ESC+"[>83;40003;0c")),!0}_is(e){return 0===(this._optionsService.rawOptions.termName+"").indexOf(e)}setMode(e){for(let t=0;t<e.length;t++)switch(e.params[t]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(e){for(let t=0;t<e.length;t++)switch(e.params[t]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,o.DEFAULT_CHARSET),this._charsetService.setgCharset(1,o.DEFAULT_CHARSET),this._charsetService.setgCharset(2,o.DEFAULT_CHARSET),this._charsetService.setgCharset(3,o.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(e){for(let t=0;t<e.length;t++)switch(e.params[t]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(e){for(let t=0;t<e.length;t++)switch(e.params[t]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),1049===e.params[t]&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(e,t){const i=this._coreService.decPrivateModes,{activeProtocol:n,activeEncoding:s}=this._coreMouseService,o=this._coreService,{buffers:a,cols:l}=this._bufferService,{active:c,alt:h}=a,d=this._optionsService.rawOptions,u=e=>e?1:2,p=e.params[0];return f=p,m=t?2===p?4:4===p?u(o.modes.insertMode):12===p?3:20===p?u(d.convertEol):0:1===p?u(i.applicationCursorKeys):3===p?d.windowOptions.setWinLines?80===l?2:132===l?1:0:0:6===p?u(i.origin):7===p?u(i.wraparound):8===p?3:9===p?u("X10"===n):12===p?u(d.cursorBlink):25===p?u(!o.isCursorHidden):45===p?u(i.reverseWraparound):66===p?u(i.applicationKeypad):67===p?4:1e3===p?u("VT200"===n):1002===p?u("DRAG"===n):1003===p?u("ANY"===n):1004===p?u(i.sendFocus):1005===p?4:1006===p?u("SGR"===s):1015===p?4:1016===p?u("SGR_PIXELS"===s):1048===p?1:47===p||1047===p||1049===p?u(c===h):2004===p?u(i.bracketedPasteMode):0,o.triggerDataEvent(`${r.C0.ESC}[${t?"":"?"}${f};${m}$y`),!0;var f,m}_updateAttrColor(e,t,i,n,s){return 2===t?(e|=50331648,e&=-16777216,e|=f.AttributeData.fromColorRGB([i,n,s])):5===t&&(e&=-50331904,e|=33554432|255&i),e}_extractColor(e,t,i){const n=[0,0,-1,0,0,0];let s=0,r=0;do{if(n[r+s]=e.params[t+r],e.hasSubParams(t+r)){const i=e.getSubParams(t+r);let o=0;do{5===n[1]&&(s=1),n[r+o+1+s]=i[o]}while(++o<i.length&&o+r+1+s<n.length);break}if(5===n[1]&&r+s>=2||2===n[1]&&r+s>=5)break;n[1]&&(s=1)}while(++r+t<e.length&&r+s<n.length);for(let e=2;e<n.length;++e)-1===n[e]&&(n[e]=0);switch(n[0]){case 38:i.fg=this._updateAttrColor(i.fg,n[1],n[3],n[4],n[5]);break;case 48:i.bg=this._updateAttrColor(i.bg,n[1],n[3],n[4],n[5]);break;case 58:i.extended=i.extended.clone(),i.extended.underlineColor=this._updateAttrColor(i.extended.underlineColor,n[1],n[3],n[4],n[5])}return r}_processUnderline(e,t){t.extended=t.extended.clone(),(!~e||e>5)&&(e=1),t.extended.underlineStyle=e,t.fg|=268435456,0===e&&(t.fg&=-268435457),t.updateExtended()}_processSGR0(e){e.fg=h.DEFAULT_ATTR_DATA.fg,e.bg=h.DEFAULT_ATTR_DATA.bg,e.extended=e.extended.clone(),e.extended.underlineStyle=0,e.extended.underlineColor&=-67108864,e.updateExtended()}charAttributes(e){if(1===e.length&&0===e.params[0])return this._processSGR0(this._curAttrData),!0;const t=e.length;let i;const n=this._curAttrData;for(let s=0;s<t;s++)i=e.params[s],i>=30&&i<=37?(n.fg&=-50331904,n.fg|=16777216|i-30):i>=40&&i<=47?(n.bg&=-50331904,n.bg|=16777216|i-40):i>=90&&i<=97?(n.fg&=-50331904,n.fg|=16777224|i-90):i>=100&&i<=107?(n.bg&=-50331904,n.bg|=16777224|i-100):0===i?this._processSGR0(n):1===i?n.fg|=134217728:3===i?n.bg|=67108864:4===i?(n.fg|=268435456,this._processUnderline(e.hasSubParams(s)?e.getSubParams(s)[0]:1,n)):5===i?n.fg|=536870912:7===i?n.fg|=67108864:8===i?n.fg|=1073741824:9===i?n.fg|=2147483648:2===i?n.bg|=134217728:21===i?this._processUnderline(2,n):22===i?(n.fg&=-134217729,n.bg&=-134217729):23===i?n.bg&=-67108865:24===i?(n.fg&=-268435457,this._processUnderline(0,n)):25===i?n.fg&=-536870913:27===i?n.fg&=-67108865:28===i?n.fg&=-1073741825:29===i?n.fg&=2147483647:39===i?(n.fg&=-67108864,n.fg|=16777215&h.DEFAULT_ATTR_DATA.fg):49===i?(n.bg&=-67108864,n.bg|=16777215&h.DEFAULT_ATTR_DATA.bg):38===i||48===i||58===i?s+=this._extractColor(e,s,n):53===i?n.bg|=1073741824:55===i?n.bg&=-1073741825:59===i?(n.extended=n.extended.clone(),n.extended.underlineColor=-1,n.updateExtended()):100===i?(n.fg&=-67108864,n.fg|=16777215&h.DEFAULT_ATTR_DATA.fg,n.bg&=-67108864,n.bg|=16777215&h.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",i);return!0}deviceStatus(e){switch(e.params[0]){case 5:this._coreService.triggerDataEvent(`${r.C0.ESC}[0n`);break;case 6:const e=this._activeBuffer.y+1,t=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${r.C0.ESC}[${e};${t}R`)}return!0}deviceStatusPrivate(e){if(6===e.params[0]){const e=this._activeBuffer.y+1,t=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${r.C0.ESC}[?${e};${t}R`)}return!0}softReset(e){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=h.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(e){const t=e.params[0]||1;switch(t){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const i=t%2==1;return this._optionsService.options.cursorBlink=i,!0}setScrollRegion(e){const t=e.params[0]||1;let i;return(e.length<2||(i=e.params[1])>this._bufferService.rows||0===i)&&(i=this._bufferService.rows),i>t&&(this._activeBuffer.scrollTop=t-1,this._activeBuffer.scrollBottom=i-1,this._setCursor(0,0)),!0}windowOptions(e){if(!w(e.params[0],this._optionsService.rawOptions.windowOptions))return!0;const t=e.length>1?e.params[1]:0;switch(e.params[0]){case 14:2!==t&&this._onRequestWindowsOptionsReport.fire(S.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(S.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${r.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:0!==t&&2!==t||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),0!==t&&1!==t||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:0!==t&&2!==t||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),0!==t&&1!==t||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(e){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(e){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(e){return this._windowTitle=e,this._onTitleChange.fire(e),!0}setIconName(e){return this._iconName=e,!0}setOrReportIndexedColor(e){const t=[],i=e.split(";");for(;i.length>1;){const e=i.shift(),n=i.shift();if(/^\d+$/.exec(e)){const i=parseInt(e);if(A(i))if("?"===n)t.push({type:0,index:i});else{const e=(0,b.parseColor)(n);e&&t.push({type:1,index:i,color:e})}}}return t.length&&this._onColor.fire(t),!0}setHyperlink(e){const t=e.split(";");return!(t.length<2)&&(t[1]?this._createHyperlink(t[0],t[1]):!t[0]&&this._finishHyperlink())}_createHyperlink(e,t){this._getCurrentLinkId()&&this._finishHyperlink();const i=e.split(":");let n;const s=i.findIndex((e=>e.startsWith("id=")));return-1!==s&&(n=i[s].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:n,uri:t}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(e,t){const i=e.split(";");for(let e=0;e<i.length&&!(t>=this._specialColors.length);++e,++t)if("?"===i[e])this._onColor.fire([{type:0,index:this._specialColors[t]}]);else{const n=(0,b.parseColor)(i[e]);n&&this._onColor.fire([{type:1,index:this._specialColors[t],color:n}])}return!0}setOrReportFgColor(e){return this._setOrReportSpecialColor(e,0)}setOrReportBgColor(e){return this._setOrReportSpecialColor(e,1)}setOrReportCursorColor(e){return this._setOrReportSpecialColor(e,2)}restoreIndexedColor(e){if(!e)return this._onColor.fire([{type:2}]),!0;const t=[],i=e.split(";");for(let e=0;e<i.length;++e)if(/^\d+$/.exec(i[e])){const n=parseInt(i[e]);A(n)&&t.push({type:2,index:n})}return t.length&&this._onColor.fire(t),!0}restoreFgColor(e){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(e){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(e){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,o.DEFAULT_CHARSET),!0}selectCharset(e){return 2!==e.length?(this.selectDefaultCharset(),!0):("/"===e[0]||this._charsetService.setgCharset(y[e[0]],o.CHARSETS[e[1]]||o.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const e=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,e,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=h.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=h.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(e){return this._charsetService.setgLevel(e),!0}screenAlignmentPattern(){const e=new p.CellData;e.content=1<<22|"E".charCodeAt(0),e.fg=this._curAttrData.fg,e.bg=this._curAttrData.bg,this._setCursor(0,0);for(let t=0;t<this._bufferService.rows;++t){const i=this._activeBuffer.ybase+this._activeBuffer.y+t,n=this._activeBuffer.lines.get(i);n&&(n.fill(e),n.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(e,t){const i=this._bufferService.buffer,n=this._optionsService.rawOptions;return(e=>(this._coreService.triggerDataEvent(`${r.C0.ESC}${e}${r.C0.ESC}\\`),!0))('"q'===e?`P1$r${this._curAttrData.isProtected()?1:0}"q`:'"p'===e?'P1$r61;1"p':"r"===e?`P1$r${i.scrollTop+1};${i.scrollBottom+1}r`:"m"===e?"P1$r0m":" q"===e?`P1$r${{block:2,underline:4,bar:6}[n.cursorStyle]-(n.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(e,t){this._dirtyRowTracker.markRangeDirty(e,t)}}t.InputHandler=x;let T=class{constructor(e){this._bufferService=e,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(e){e<this.start?this.start=e:e>this.end&&(this.end=e)}markRangeDirty(e,t){e>t&&(E=e,e=t,t=E),e<this.start&&(this.start=e),t>this.end&&(this.end=t)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function A(e){return 0<=e&&e<256}T=n([s(0,m.IBufferService)],T)},844:(e,t)=>{function i(e){for(const t of e)t.dispose();e.length=0}Object.defineProperty(t,"__esModule",{value:!0}),t.getDisposeArrayDisposable=t.disposeArray=t.toDisposable=t.MutableDisposable=t.Disposable=void 0,t.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const e of this._disposables)e.dispose();this._disposables.length=0}register(e){return this._disposables.push(e),e}unregister(e){const t=this._disposables.indexOf(e);-1!==t&&this._disposables.splice(t,1)}},t.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(e){this._isDisposed||e===this._value||(this._value?.dispose(),this._value=e)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,this._value?.dispose(),this._value=void 0}},t.toDisposable=function(e){return{dispose:e}},t.disposeArray=i,t.getDisposeArrayDisposable=function(e){return{dispose:()=>i(e)}}},1505:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FourKeyMap=t.TwoKeyMap=void 0;class i{constructor(){this._data={}}set(e,t,i){this._data[e]||(this._data[e]={}),this._data[e][t]=i}get(e,t){return this._data[e]?this._data[e][t]:void 0}clear(){this._data={}}}t.TwoKeyMap=i,t.FourKeyMap=class{constructor(){this._data=new i}set(e,t,n,s,r){this._data.get(e,t)||this._data.set(e,t,new i),this._data.get(e,t).set(n,s,r)}get(e,t,i,n){return this._data.get(e,t)?.get(i,n)}clear(){this._data.clear()}}},6114:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isChromeOS=t.isLinux=t.isWindows=t.isIphone=t.isIpad=t.isMac=t.getSafariVersion=t.isSafari=t.isLegacyEdge=t.isFirefox=t.isNode=void 0,t.isNode="undefined"!=typeof process&&"title"in process;const i=t.isNode?"node":navigator.userAgent,n=t.isNode?"node":navigator.platform;t.isFirefox=i.includes("Firefox"),t.isLegacyEdge=i.includes("Edge"),t.isSafari=/^((?!chrome|android).)*safari/i.test(i),t.getSafariVersion=function(){if(!t.isSafari)return 0;const e=i.match(/Version\/(\d+)/);return null===e||e.length<2?0:parseInt(e[1])},t.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(n),t.isIpad="iPad"===n,t.isIphone="iPhone"===n,t.isWindows=["Windows","Win16","Win32","WinCE"].includes(n),t.isLinux=n.indexOf("Linux")>=0,t.isChromeOS=/\bCrOS\b/.test(i)},6106:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SortedList=void 0;let i=0;t.SortedList=class{constructor(e){this._getKey=e,this._array=[]}clear(){this._array.length=0}insert(e){0!==this._array.length?(i=this._search(this._getKey(e)),this._array.splice(i,0,e)):this._array.push(e)}delete(e){if(0===this._array.length)return!1;const t=this._getKey(e);if(void 0===t)return!1;if(i=this._search(t),-1===i)return!1;if(this._getKey(this._array[i])!==t)return!1;do{if(this._array[i]===e)return this._array.splice(i,1),!0}while(++i<this._array.length&&this._getKey(this._array[i])===t);return!1}*getKeyIterator(e){if(0!==this._array.length&&(i=this._search(e),!(i<0||i>=this._array.length)&&this._getKey(this._array[i])===e))do{yield this._array[i]}while(++i<this._array.length&&this._getKey(this._array[i])===e)}forEachByKey(e,t){if(0!==this._array.length&&(i=this._search(e),!(i<0||i>=this._array.length)&&this._getKey(this._array[i])===e))do{t(this._array[i])}while(++i<this._array.length&&this._getKey(this._array[i])===e)}values(){return[...this._array].values()}_search(e){let t=0,i=this._array.length-1;for(;i>=t;){let n=t+i>>1;const s=this._getKey(this._array[n]);if(s>e)i=n-1;else{if(!(s<e)){for(;n>0&&this._getKey(this._array[n-1])===e;)n--;return n}t=n+1}}return t}}},7226:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DebouncedIdleTask=t.IdleTaskQueue=t.PriorityTaskQueue=void 0;const n=i(6114);class s{constructor(){this._tasks=[],this._i=0}enqueue(e){this._tasks.push(e),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(e){this._idleCallback=void 0;let t=0,i=0,n=e.timeRemaining(),s=0;for(;this._i<this._tasks.length;){if(t=Date.now(),this._tasks[this._i]()||this._i++,t=Math.max(1,Date.now()-t),i=Math.max(t,i),s=e.timeRemaining(),1.5*i>s)return n-t<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(n-t))}ms`),void this._start();n=s}this.clear()}}class r extends s{_requestCallback(e){return setTimeout((()=>e(this._createDeadline(16))))}_cancelCallback(e){clearTimeout(e)}_createDeadline(e){const t=Date.now()+e;return{timeRemaining:()=>Math.max(0,t-Date.now())}}}t.PriorityTaskQueue=r,t.IdleTaskQueue=!n.isNode&&"requestIdleCallback"in window?class extends s{_requestCallback(e){return requestIdleCallback(e)}_cancelCallback(e){cancelIdleCallback(e)}}:r,t.DebouncedIdleTask=class{constructor(){this._queue=new t.IdleTaskQueue}set(e){this._queue.clear(),this._queue.enqueue(e)}flush(){this._queue.flush()}}},9282:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateWindowsModeWrappedState=void 0;const n=i(643);t.updateWindowsModeWrappedState=function(e){const t=e.buffer.lines.get(e.buffer.ybase+e.buffer.y-1),i=t?.get(e.cols-1),s=e.buffer.lines.get(e.buffer.ybase+e.buffer.y);s&&i&&(s.isWrapped=i[n.CHAR_DATA_CODE_INDEX]!==n.NULL_CELL_CODE&&i[n.CHAR_DATA_CODE_INDEX]!==n.WHITESPACE_CELL_CODE)}},3734:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedAttrs=t.AttributeData=void 0;class i{constructor(){this.fg=0,this.bg=0,this.extended=new n}static toColorRGB(e){return[e>>>16&255,e>>>8&255,255&e]}static fromColorRGB(e){return(255&e[0])<<16|(255&e[1])<<8|255&e[2]}clone(){const e=new i;return e.fg=this.fg,e.bg=this.bg,e.extended=this.extended.clone(),e}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&0!==this.extended.underlineStyle?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return!(50331648&~this.fg)}isBgRGB(){return!(50331648&~this.bg)}isFgPalette(){return 16777216==(50331648&this.fg)||33554432==(50331648&this.fg)}isBgPalette(){return 16777216==(50331648&this.bg)||33554432==(50331648&this.bg)}isFgDefault(){return!(50331648&this.fg)}isBgDefault(){return!(50331648&this.bg)}isAttributeDefault(){return 0===this.fg&&0===this.bg}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?!(50331648&~this.extended.underlineColor):this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?16777216==(50331648&this.extended.underlineColor)||33554432==(50331648&this.extended.underlineColor):this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?!(50331648&this.extended.underlineColor):this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}getUnderlineVariantOffset(){return this.extended.underlineVariantOffset}}t.AttributeData=i;class n{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(e){this._ext=e}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(e){this._ext&=-469762049,this._ext|=e<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(e){this._ext&=-67108864,this._ext|=67108863&e}get urlId(){return this._urlId}set urlId(e){this._urlId=e}get underlineVariantOffset(){const e=(3758096384&this._ext)>>29;return e<0?4294967288^e:e}set underlineVariantOffset(e){this._ext&=536870911,this._ext|=e<<29&3758096384}constructor(e=0,t=0){this._ext=0,this._urlId=0,this._ext=e,this._urlId=t}clone(){return new n(this._ext,this._urlId)}isEmpty(){return 0===this.underlineStyle&&0===this._urlId}}t.ExtendedAttrs=n},9092:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Buffer=t.MAX_BUFFER_SIZE=void 0;const n=i(6349),s=i(7226),r=i(3734),o=i(8437),a=i(4634),l=i(511),c=i(643),h=i(4863),d=i(7116);t.MAX_BUFFER_SIZE=4294967295,t.Buffer=class{constructor(e,t,i){this._hasScrollback=e,this._optionsService=t,this._bufferService=i,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=o.DEFAULT_ATTR_DATA.clone(),this.savedCharset=d.DEFAULT_CHARSET,this.markers=[],this._nullCell=l.CellData.fromCharData([0,c.NULL_CELL_CHAR,c.NULL_CELL_WIDTH,c.NULL_CELL_CODE]),this._whitespaceCell=l.CellData.fromCharData([0,c.WHITESPACE_CELL_CHAR,c.WHITESPACE_CELL_WIDTH,c.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new s.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new n.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(e){return e?(this._nullCell.fg=e.fg,this._nullCell.bg=e.bg,this._nullCell.extended=e.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new r.ExtendedAttrs),this._nullCell}getWhitespaceCell(e){return e?(this._whitespaceCell.fg=e.fg,this._whitespaceCell.bg=e.bg,this._whitespaceCell.extended=e.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new r.ExtendedAttrs),this._whitespaceCell}getBlankLine(e,t){return new o.BufferLine(this._bufferService.cols,this.getNullCell(e),t)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const e=this.ybase+this.y-this.ydisp;return e>=0&&e<this._rows}_getCorrectBufferLength(e){if(!this._hasScrollback)return e;const i=e+this._optionsService.rawOptions.scrollback;return i>t.MAX_BUFFER_SIZE?t.MAX_BUFFER_SIZE:i}fillViewportRows(e){if(0===this.lines.length){void 0===e&&(e=o.DEFAULT_ATTR_DATA);let t=this._rows;for(;t--;)this.lines.push(this.getBlankLine(e))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new n.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(e,t){const i=this.getNullCell(o.DEFAULT_ATTR_DATA);let n=0;const s=this._getCorrectBufferLength(t);if(s>this.lines.maxLength&&(this.lines.maxLength=s),this.lines.length>0){if(this._cols<e)for(let t=0;t<this.lines.length;t++)n+=+this.lines.get(t).resize(e,i);let r=0;if(this._rows<t)for(let n=this._rows;n<t;n++)this.lines.length<t+this.ybase&&(this._optionsService.rawOptions.windowsMode||void 0!==this._optionsService.rawOptions.windowsPty.backend||void 0!==this._optionsService.rawOptions.windowsPty.buildNumber?this.lines.push(new o.BufferLine(e,i)):this.ybase>0&&this.lines.length<=this.ybase+this.y+r+1?(this.ybase--,r++,this.ydisp>0&&this.ydisp--):this.lines.push(new o.BufferLine(e,i)));else for(let e=this._rows;e>t;e--)this.lines.length>t+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(s<this.lines.maxLength){const e=this.lines.length-s;e>0&&(this.lines.trimStart(e),this.ybase=Math.max(this.ybase-e,0),this.ydisp=Math.max(this.ydisp-e,0),this.savedY=Math.max(this.savedY-e,0)),this.lines.maxLength=s}this.x=Math.min(this.x,e-1),this.y=Math.min(this.y,t-1),r&&(this.y+=r),this.savedX=Math.min(this.savedX,e-1),this.scrollTop=0}if(this.scrollBottom=t-1,this._isReflowEnabled&&(this._reflow(e,t),this._cols>e))for(let t=0;t<this.lines.length;t++)n+=+this.lines.get(t).resize(e,i);this._cols=e,this._rows=t,this._memoryCleanupQueue.clear(),n>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue((()=>this._batchedMemoryCleanup())))}_batchedMemoryCleanup(){let e=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,e=!1);let t=0;for(;this._memoryCleanupPosition<this.lines.length;)if(t+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),t>100)return!0;return e}get _isReflowEnabled(){const e=this._optionsService.rawOptions.windowsPty;return e&&e.buildNumber?this._hasScrollback&&"conpty"===e.backend&&e.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(e,t){this._cols!==e&&(e>this._cols?this._reflowLarger(e,t):this._reflowSmaller(e,t))}_reflowLarger(e,t){const i=(0,a.reflowLargerGetLinesToRemove)(this.lines,this._cols,e,this.ybase+this.y,this.getNullCell(o.DEFAULT_ATTR_DATA));if(i.length>0){const n=(0,a.reflowLargerCreateNewLayout)(this.lines,i);(0,a.reflowLargerApplyNewLayout)(this.lines,n.layout),this._reflowLargerAdjustViewport(e,t,n.countRemoved)}}_reflowLargerAdjustViewport(e,t,i){const n=this.getNullCell(o.DEFAULT_ATTR_DATA);let s=i;for(;s-- >0;)0===this.ybase?(this.y>0&&this.y--,this.lines.length<t&&this.lines.push(new o.BufferLine(e,n))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-i,0)}_reflowSmaller(e,t){const i=this.getNullCell(o.DEFAULT_ATTR_DATA),n=[];let s=0;for(let r=this.lines.length-1;r>=0;r--){let l=this.lines.get(r);if(!l||!l.isWrapped&&l.getTrimmedLength()<=e)continue;const c=[l];for(;l.isWrapped&&r>0;)l=this.lines.get(--r),c.unshift(l);const h=this.ybase+this.y;if(h>=r&&h<r+c.length)continue;const d=c[c.length-1].getTrimmedLength(),u=(0,a.reflowSmallerGetNewLineLengths)(c,this._cols,e),p=u.length-c.length;let f;f=0===this.ybase&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+p):Math.max(0,this.lines.length-this.lines.maxLength+p);const m=[];for(let e=0;e<p;e++){const e=this.getBlankLine(o.DEFAULT_ATTR_DATA,!0);m.push(e)}m.length>0&&(n.push({start:r+c.length+s,newLines:m}),s+=m.length),c.push(...m);let g=u.length-1,v=u[g];0===v&&(g--,v=u[g]);let _=c.length-p-1,b=d;for(;_>=0;){const e=Math.min(b,v);if(void 0===c[g])break;if(c[g].copyCellsFrom(c[_],b-e,v-e,e,!0),v-=e,0===v&&(g--,v=u[g]),b-=e,0===b){_--;const e=Math.max(_,0);b=(0,a.getWrappedLineTrimmedLength)(c,e,this._cols)}}for(let t=0;t<c.length;t++)u[t]<e&&c[t].setCell(u[t],i);let y=p-f;for(;y-- >0;)0===this.ybase?this.y<t-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+s)-t&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+p,this.ybase+t-1)}if(n.length>0){const e=[],t=[];for(let e=0;e<this.lines.length;e++)t.push(this.lines.get(e));const i=this.lines.length;let r=i-1,o=0,a=n[o];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+s);let l=0;for(let c=Math.min(this.lines.maxLength-1,i+s-1);c>=0;c--)if(a&&a.start>r+l){for(let e=a.newLines.length-1;e>=0;e--)this.lines.set(c--,a.newLines[e]);c++,e.push({index:r+1,amount:a.newLines.length}),l+=a.newLines.length,a=n[++o]}else this.lines.set(c,t[r--]);let c=0;for(let t=e.length-1;t>=0;t--)e[t].index+=c,this.lines.onInsertEmitter.fire(e[t]),c+=e[t].amount;const h=Math.max(0,i+s-this.lines.maxLength);h>0&&this.lines.onTrimEmitter.fire(h)}}translateBufferLineToString(e,t,i=0,n){const s=this.lines.get(e);return s?s.translateToString(t,i,n):""}getWrappedRangeForLine(e){let t=e,i=e;for(;t>0&&this.lines.get(t).isWrapped;)t--;for(;i+1<this.lines.length&&this.lines.get(i+1).isWrapped;)i++;return{first:t,last:i}}setupTabStops(e){for(null!=e?this.tabs[e]||(e=this.prevStop(e)):(this.tabs={},e=0);e<this._cols;e+=this._optionsService.rawOptions.tabStopWidth)this.tabs[e]=!0}prevStop(e){for(null==e&&(e=this.x);!this.tabs[--e]&&e>0;);return e>=this._cols?this._cols-1:e<0?0:e}nextStop(e){for(null==e&&(e=this.x);!this.tabs[++e]&&e<this._cols;);return e>=this._cols?this._cols-1:e<0?0:e}clearMarkers(e){this._isClearing=!0;for(let t=0;t<this.markers.length;t++)this.markers[t].line===e&&(this.markers[t].dispose(),this.markers.splice(t--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let e=0;e<this.markers.length;e++)this.markers[e].dispose(),this.markers.splice(e--,1);this._isClearing=!1}addMarker(e){const t=new h.Marker(e);return this.markers.push(t),t.register(this.lines.onTrim((e=>{t.line-=e,t.line<0&&t.dispose()}))),t.register(this.lines.onInsert((e=>{t.line>=e.index&&(t.line+=e.amount)}))),t.register(this.lines.onDelete((e=>{t.line>=e.index&&t.line<e.index+e.amount&&t.dispose(),t.line>e.index&&(t.line-=e.amount)}))),t.register(t.onDispose((()=>this._removeMarker(t)))),t}_removeMarker(e){this._isClearing||this.markers.splice(this.markers.indexOf(e),1)}}},8437:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferLine=t.DEFAULT_ATTR_DATA=void 0;const n=i(3734),s=i(511),r=i(643),o=i(482);t.DEFAULT_ATTR_DATA=Object.freeze(new n.AttributeData);let a=0;class l{constructor(e,t,i=!1){this.isWrapped=i,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*e);const n=t||s.CellData.fromCharData([0,r.NULL_CELL_CHAR,r.NULL_CELL_WIDTH,r.NULL_CELL_CODE]);for(let t=0;t<e;++t)this.setCell(t,n);this.length=e}get(e){const t=this._data[3*e+0],i=2097151&t;return[this._data[3*e+1],2097152&t?this._combined[e]:i?(0,o.stringFromCodePoint)(i):"",t>>22,2097152&t?this._combined[e].charCodeAt(this._combined[e].length-1):i]}set(e,t){this._data[3*e+1]=t[r.CHAR_DATA_ATTR_INDEX],t[r.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[e]=t[1],this._data[3*e+0]=2097152|e|t[r.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*e+0]=t[r.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|t[r.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(e){return this._data[3*e+0]>>22}hasWidth(e){return 12582912&this._data[3*e+0]}getFg(e){return this._data[3*e+1]}getBg(e){return this._data[3*e+2]}hasContent(e){return 4194303&this._data[3*e+0]}getCodePoint(e){const t=this._data[3*e+0];return 2097152&t?this._combined[e].charCodeAt(this._combined[e].length-1):2097151&t}isCombined(e){return 2097152&this._data[3*e+0]}getString(e){const t=this._data[3*e+0];return 2097152&t?this._combined[e]:2097151&t?(0,o.stringFromCodePoint)(2097151&t):""}isProtected(e){return 536870912&this._data[3*e+2]}loadCell(e,t){return a=3*e,t.content=this._data[a+0],t.fg=this._data[a+1],t.bg=this._data[a+2],2097152&t.content&&(t.combinedData=this._combined[e]),268435456&t.bg&&(t.extended=this._extendedAttrs[e]),t}setCell(e,t){2097152&t.content&&(this._combined[e]=t.combinedData),268435456&t.bg&&(this._extendedAttrs[e]=t.extended),this._data[3*e+0]=t.content,this._data[3*e+1]=t.fg,this._data[3*e+2]=t.bg}setCellFromCodepoint(e,t,i,n){268435456&n.bg&&(this._extendedAttrs[e]=n.extended),this._data[3*e+0]=t|i<<22,this._data[3*e+1]=n.fg,this._data[3*e+2]=n.bg}addCodepointToCell(e,t,i){let n=this._data[3*e+0];2097152&n?this._combined[e]+=(0,o.stringFromCodePoint)(t):2097151&n?(this._combined[e]=(0,o.stringFromCodePoint)(2097151&n)+(0,o.stringFromCodePoint)(t),n&=-2097152,n|=2097152):n=t|1<<22,i&&(n&=-12582913,n|=i<<22),this._data[3*e+0]=n}insertCells(e,t,i){if((e%=this.length)&&2===this.getWidth(e-1)&&this.setCellFromCodepoint(e-1,0,1,i),t<this.length-e){const n=new s.CellData;for(let i=this.length-e-t-1;i>=0;--i)this.setCell(e+t+i,this.loadCell(e+i,n));for(let n=0;n<t;++n)this.setCell(e+n,i)}else for(let t=e;t<this.length;++t)this.setCell(t,i);2===this.getWidth(this.length-1)&&this.setCellFromCodepoint(this.length-1,0,1,i)}deleteCells(e,t,i){if(e%=this.length,t<this.length-e){const n=new s.CellData;for(let i=0;i<this.length-e-t;++i)this.setCell(e+i,this.loadCell(e+t+i,n));for(let e=this.length-t;e<this.length;++e)this.setCell(e,i)}else for(let t=e;t<this.length;++t)this.setCell(t,i);e&&2===this.getWidth(e-1)&&this.setCellFromCodepoint(e-1,0,1,i),0!==this.getWidth(e)||this.hasContent(e)||this.setCellFromCodepoint(e,0,1,i)}replaceCells(e,t,i,n=!1){if(n)for(e&&2===this.getWidth(e-1)&&!this.isProtected(e-1)&&this.setCellFromCodepoint(e-1,0,1,i),t<this.length&&2===this.getWidth(t-1)&&!this.isProtected(t)&&this.setCellFromCodepoint(t,0,1,i);e<t&&e<this.length;)this.isProtected(e)||this.setCell(e,i),e++;else for(e&&2===this.getWidth(e-1)&&this.setCellFromCodepoint(e-1,0,1,i),t<this.length&&2===this.getWidth(t-1)&&this.setCellFromCodepoint(t,0,1,i);e<t&&e<this.length;)this.setCell(e++,i)}resize(e,t){if(e===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const i=3*e;if(e>this.length){if(this._data.buffer.byteLength>=4*i)this._data=new Uint32Array(this._data.buffer,0,i);else{const e=new Uint32Array(i);e.set(this._data),this._data=e}for(let i=this.length;i<e;++i)this.setCell(i,t)}else{this._data=this._data.subarray(0,i);const t=Object.keys(this._combined);for(let i=0;i<t.length;i++){const n=parseInt(t[i],10);n>=e&&delete this._combined[n]}const n=Object.keys(this._extendedAttrs);for(let t=0;t<n.length;t++){const i=parseInt(n[t],10);i>=e&&delete this._extendedAttrs[i]}}return this.length=e,4*i*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const e=new Uint32Array(this._data.length);return e.set(this._data),this._data=e,1}return 0}fill(e,t=!1){if(t)for(let t=0;t<this.length;++t)this.isProtected(t)||this.setCell(t,e);else{this._combined={},this._extendedAttrs={};for(let t=0;t<this.length;++t)this.setCell(t,e)}}copyFrom(e){this.length!==e.length?this._data=new Uint32Array(e._data):this._data.set(e._data),this.length=e.length,this._combined={};for(const t in e._combined)this._combined[t]=e._combined[t];this._extendedAttrs={};for(const t in e._extendedAttrs)this._extendedAttrs[t]=e._extendedAttrs[t];this.isWrapped=e.isWrapped}clone(){const e=new l(0);e._data=new Uint32Array(this._data),e.length=this.length;for(const t in this._combined)e._combined[t]=this._combined[t];for(const t in this._extendedAttrs)e._extendedAttrs[t]=this._extendedAttrs[t];return e.isWrapped=this.isWrapped,e}getTrimmedLength(){for(let e=this.length-1;e>=0;--e)if(4194303&this._data[3*e+0])return e+(this._data[3*e+0]>>22);return 0}getNoBgTrimmedLength(){for(let e=this.length-1;e>=0;--e)if(4194303&this._data[3*e+0]||50331648&this._data[3*e+2])return e+(this._data[3*e+0]>>22);return 0}copyCellsFrom(e,t,i,n,s){const r=e._data;if(s)for(let s=n-1;s>=0;s--){for(let e=0;e<3;e++)this._data[3*(i+s)+e]=r[3*(t+s)+e];268435456&r[3*(t+s)+2]&&(this._extendedAttrs[i+s]=e._extendedAttrs[t+s])}else for(let s=0;s<n;s++){for(let e=0;e<3;e++)this._data[3*(i+s)+e]=r[3*(t+s)+e];268435456&r[3*(t+s)+2]&&(this._extendedAttrs[i+s]=e._extendedAttrs[t+s])}const o=Object.keys(e._combined);for(let n=0;n<o.length;n++){const s=parseInt(o[n],10);s>=t&&(this._combined[s-t+i]=e._combined[s])}}translateToString(e,t,i,n){t=t??0,i=i??this.length,e&&(i=Math.min(i,this.getTrimmedLength())),n&&(n.length=0);let s="";for(;t<i;){const e=this._data[3*t+0],i=2097151&e,a=2097152&e?this._combined[t]:i?(0,o.stringFromCodePoint)(i):r.WHITESPACE_CELL_CHAR;if(s+=a,n)for(let e=0;e<a.length;++e)n.push(t);t+=e>>22||1}return n&&n.push(t),s}}t.BufferLine=l},4841:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRangeLength=void 0,t.getRangeLength=function(e,t){if(e.start.y>e.end.y)throw new Error(`Buffer range end (${e.end.x}, ${e.end.y}) cannot be before start (${e.start.x}, ${e.start.y})`);return t*(e.end.y-e.start.y)+(e.end.x-e.start.x+1)}},4634:(e,t)=>{function i(e,t,i){if(t===e.length-1)return e[t].getTrimmedLength();const n=!e[t].hasContent(i-1)&&1===e[t].getWidth(i-1),s=2===e[t+1].getWidth(0);return n&&s?i-1:i}Object.defineProperty(t,"__esModule",{value:!0}),t.getWrappedLineTrimmedLength=t.reflowSmallerGetNewLineLengths=t.reflowLargerApplyNewLayout=t.reflowLargerCreateNewLayout=t.reflowLargerGetLinesToRemove=void 0,t.reflowLargerGetLinesToRemove=function(e,t,n,s,r){const o=[];for(let a=0;a<e.length-1;a++){let l=a,c=e.get(++l);if(!c.isWrapped)continue;const h=[e.get(a)];for(;l<e.length&&c.isWrapped;)h.push(c),c=e.get(++l);if(s>=a&&s<l){a+=h.length-1;continue}let d=0,u=i(h,d,t),p=1,f=0;for(;p<h.length;){const e=i(h,p,t),s=e-f,o=n-u,a=Math.min(s,o);h[d].copyCellsFrom(h[p],f,u,a,!1),u+=a,u===n&&(d++,u=0),f+=a,f===e&&(p++,f=0),0===u&&0!==d&&2===h[d-1].getWidth(n-1)&&(h[d].copyCellsFrom(h[d-1],n-1,u++,1,!1),h[d-1].setCell(n-1,r))}h[d].replaceCells(u,n,r);let m=0;for(let e=h.length-1;e>0&&(e>d||0===h[e].getTrimmedLength());e--)m++;m>0&&(o.push(a+h.length-m),o.push(m)),a+=h.length-1}return o},t.reflowLargerCreateNewLayout=function(e,t){const i=[];let n=0,s=t[n],r=0;for(let o=0;o<e.length;o++)if(s===o){const i=t[++n];e.onDeleteEmitter.fire({index:o-r,amount:i}),o+=i-1,r+=i,s=t[++n]}else i.push(o);return{layout:i,countRemoved:r}},t.reflowLargerApplyNewLayout=function(e,t){const i=[];for(let n=0;n<t.length;n++)i.push(e.get(t[n]));for(let t=0;t<i.length;t++)e.set(t,i[t]);e.length=t.length},t.reflowSmallerGetNewLineLengths=function(e,t,n){const s=[],r=e.map(((n,s)=>i(e,s,t))).reduce(((e,t)=>e+t));let o=0,a=0,l=0;for(;l<r;){if(r-l<n){s.push(r-l);break}o+=n;const c=i(e,a,t);o>c&&(o-=c,a++);const h=2===e[a].getWidth(o-1);h&&o--;const d=h?n-1:n;s.push(d),l+=d}return s},t.getWrappedLineTrimmedLength=i},5295:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferSet=void 0;const n=i(8460),s=i(844),r=i(9092);class o extends s.Disposable{constructor(e,t){super(),this._optionsService=e,this._bufferService=t,this._onBufferActivate=this.register(new n.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",(()=>this.resize(this._bufferService.cols,this._bufferService.rows)))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",(()=>this.setupTabStops())))}reset(){this._normal=new r.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new r.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(e){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(e),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(e,t){this._normal.resize(e,t),this._alt.resize(e,t),this.setupTabStops(e)}setupTabStops(e){this._normal.setupTabStops(e),this._alt.setupTabStops(e)}}t.BufferSet=o},511:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CellData=void 0;const n=i(482),s=i(643),r=i(3734);class o extends r.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new r.ExtendedAttrs,this.combinedData=""}static fromCharData(e){const t=new o;return t.setFromCharData(e),t}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,n.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(e){this.fg=e[s.CHAR_DATA_ATTR_INDEX],this.bg=0;let t=!1;if(e[s.CHAR_DATA_CHAR_INDEX].length>2)t=!0;else if(2===e[s.CHAR_DATA_CHAR_INDEX].length){const i=e[s.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=i&&i<=56319){const n=e[s.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=n&&n<=57343?this.content=1024*(i-55296)+n-56320+65536|e[s.CHAR_DATA_WIDTH_INDEX]<<22:t=!0}else t=!0}else this.content=e[s.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|e[s.CHAR_DATA_WIDTH_INDEX]<<22;t&&(this.combinedData=e[s.CHAR_DATA_CHAR_INDEX],this.content=2097152|e[s.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}t.CellData=o},643:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WHITESPACE_CELL_CODE=t.WHITESPACE_CELL_WIDTH=t.WHITESPACE_CELL_CHAR=t.NULL_CELL_CODE=t.NULL_CELL_WIDTH=t.NULL_CELL_CHAR=t.CHAR_DATA_CODE_INDEX=t.CHAR_DATA_WIDTH_INDEX=t.CHAR_DATA_CHAR_INDEX=t.CHAR_DATA_ATTR_INDEX=t.DEFAULT_EXT=t.DEFAULT_ATTR=t.DEFAULT_COLOR=void 0,t.DEFAULT_COLOR=0,t.DEFAULT_ATTR=256|t.DEFAULT_COLOR<<9,t.DEFAULT_EXT=0,t.CHAR_DATA_ATTR_INDEX=0,t.CHAR_DATA_CHAR_INDEX=1,t.CHAR_DATA_WIDTH_INDEX=2,t.CHAR_DATA_CODE_INDEX=3,t.NULL_CELL_CHAR="",t.NULL_CELL_WIDTH=1,t.NULL_CELL_CODE=0,t.WHITESPACE_CELL_CHAR=" ",t.WHITESPACE_CELL_WIDTH=1,t.WHITESPACE_CELL_CODE=32},4863:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Marker=void 0;const n=i(8460),s=i(844);class r{get id(){return this._id}constructor(e){this.line=e,this.isDisposed=!1,this._disposables=[],this._id=r._nextId++,this._onDispose=this.register(new n.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,s.disposeArray)(this._disposables),this._disposables.length=0)}register(e){return this._disposables.push(e),e}}t.Marker=r,r._nextId=1},7116:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_CHARSET=t.CHARSETS=void 0,t.CHARSETS={},t.DEFAULT_CHARSET=t.CHARSETS.B,t.CHARSETS[0]={"`":"â",a:"â",b:"â",c:"â",d:"â",e:"â",f:"Â°",g:"Â±",h:"â¤",i:"â",j:"â",k:"â",l:"â",m:"â",n:"â¼",o:"âº",p:"â»",q:"â",r:"â¼",s:"â½",t:"â",u:"â¤",v:"â´",w:"â¬",x:"â",y:"â¤",z:"â¥","{":"Ï","|":"â ","}":"Â£","~":"Â·"},t.CHARSETS.A={"#":"Â£"},t.CHARSETS.B=void 0,t.CHARSETS[4]={"#":"Â£","@":"Â¾","[":"ij","\\":"Â½","]":"|","{":"Â¨","|":"f","}":"Â¼","~":"Â´"},t.CHARSETS.C=t.CHARSETS[5]={"[":"Ã","\\":"Ã","]":"Ã","^":"Ã","`":"Ã©","{":"Ã¤","|":"Ã¶","}":"Ã¥","~":"Ã¼"},t.CHARSETS.R={"#":"Â£","@":"Ã ","[":"Â°","\\":"Ã§","]":"Â§","{":"Ã©","|":"Ã¹","}":"Ã¨","~":"Â¨"},t.CHARSETS.Q={"@":"Ã ","[":"Ã¢","\\":"Ã§","]":"Ãª","^":"Ã®","`":"Ã´","{":"Ã©","|":"Ã¹","}":"Ã¨","~":"Ã»"},t.CHARSETS.K={"@":"Â§","[":"Ã","\\":"Ã","]":"Ã","{":"Ã¤","|":"Ã¶","}":"Ã¼","~":"Ã"},t.CHARSETS.Y={"#":"Â£","@":"Â§","[":"Â°","\\":"Ã§","]":"Ã©","`":"Ã¹","{":"Ã ","|":"Ã²","}":"Ã¨","~":"Ã¬"},t.CHARSETS.E=t.CHARSETS[6]={"@":"Ã","[":"Ã","\\":"Ã","]":"Ã","^":"Ã","`":"Ã¤","{":"Ã¦","|":"Ã¸","}":"Ã¥","~":"Ã¼"},t.CHARSETS.Z={"#":"Â£","@":"Â§","[":"Â¡","\\":"Ã","]":"Â¿","{":"Â°","|":"Ã±","}":"Ã§"},t.CHARSETS.H=t.CHARSETS[7]={"@":"Ã","[":"Ã","\\":"Ã","]":"Ã","^":"Ã","`":"Ã©","{":"Ã¤","|":"Ã¶","}":"Ã¥","~":"Ã¼"},t.CHARSETS["="]={"#":"Ã¹","@":"Ã ","[":"Ã©","\\":"Ã§","]":"Ãª","^":"Ã®",_:"Ã¨","`":"Ã´","{":"Ã¤","|":"Ã¶","}":"Ã¼","~":"Ã»"}},2584:(e,t)=>{var i,n,s;Object.defineProperty(t,"__esModule",{value:!0}),t.C1_ESCAPED=t.C1=t.C0=void 0,function(e){e.NUL="\0",e.SOH="",e.STX="",e.ETX="",e.EOT="",e.ENQ="",e.ACK="",e.BEL="",e.BS="\b",e.HT="\t",e.LF="\n",e.VT="\v",e.FF="\f",e.CR="\r",e.SO="",e.SI="",e.DLE="",e.DC1="",e.DC2="",e.DC3="",e.DC4="",e.NAK="",e.SYN="",e.ETB="",e.CAN="",e.EM="",e.SUB="",e.ESC="",e.FS="",e.GS="",e.RS="",e.US="",e.SP=" ",e.DEL=""}(i||(t.C0=i={})),function(e){e.PAD="Â",e.HOP="Â",e.BPH="Â",e.NBH="Â",e.IND="Â",e.NEL="Â",e.SSA="Â",e.ESA="Â",e.HTS="Â",e.HTJ="Â",e.VTS="Â",e.PLD="Â",e.PLU="Â",e.RI="Â",e.SS2="Â",e.SS3="Â",e.DCS="Â",e.PU1="Â",e.PU2="Â",e.STS="Â",e.CCH="Â",e.MW="Â",e.SPA="Â",e.EPA="Â",e.SOS="Â",e.SGCI="Â",e.SCI="Â",e.CSI="Â",e.ST="Â",e.OSC="Â",e.PM="Â",e.APC="Â"}(n||(t.C1=n={})),function(e){e.ST=`${i.ESC}\\`}(s||(t.C1_ESCAPED=s={}))},7399:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateKeyboardEvent=void 0;const n=i(2584),s={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};t.evaluateKeyboardEvent=function(e,t,i,r){const o={type:0,cancel:!1,key:void 0},a=(e.shiftKey?1:0)|(e.altKey?2:0)|(e.ctrlKey?4:0)|(e.metaKey?8:0);switch(e.keyCode){case 0:"UIKeyInputUpArrow"===e.key?o.key=t?n.C0.ESC+"OA":n.C0.ESC+"[A":"UIKeyInputLeftArrow"===e.key?o.key=t?n.C0.ESC+"OD":n.C0.ESC+"[D":"UIKeyInputRightArrow"===e.key?o.key=t?n.C0.ESC+"OC":n.C0.ESC+"[C":"UIKeyInputDownArrow"===e.key&&(o.key=t?n.C0.ESC+"OB":n.C0.ESC+"[B");break;case 8:o.key=e.ctrlKey?"\b":n.C0.DEL,e.altKey&&(o.key=n.C0.ESC+o.key);break;case 9:if(e.shiftKey){o.key=n.C0.ESC+"[Z";break}o.key=n.C0.HT,o.cancel=!0;break;case 13:o.key=e.altKey?n.C0.ESC+n.C0.CR:n.C0.CR,o.cancel=!0;break;case 27:o.key=n.C0.ESC,e.altKey&&(o.key=n.C0.ESC+n.C0.ESC),o.cancel=!0;break;case 37:if(e.metaKey)break;a?(o.key=n.C0.ESC+"[1;"+(a+1)+"D",o.key===n.C0.ESC+"[1;3D"&&(o.key=n.C0.ESC+(i?"b":"[1;5D"))):o.key=t?n.C0.ESC+"OD":n.C0.ESC+"[D";break;case 39:if(e.metaKey)break;a?(o.key=n.C0.ESC+"[1;"+(a+1)+"C",o.key===n.C0.ESC+"[1;3C"&&(o.key=n.C0.ESC+(i?"f":"[1;5C"))):o.key=t?n.C0.ESC+"OC":n.C0.ESC+"[C";break;case 38:if(e.metaKey)break;a?(o.key=n.C0.ESC+"[1;"+(a+1)+"A",i||o.key!==n.C0.ESC+"[1;3A"||(o.key=n.C0.ESC+"[1;5A")):o.key=t?n.C0.ESC+"OA":n.C0.ESC+"[A";break;case 40:if(e.metaKey)break;a?(o.key=n.C0.ESC+"[1;"+(a+1)+"B",i||o.key!==n.C0.ESC+"[1;3B"||(o.key=n.C0.ESC+"[1;5B")):o.key=t?n.C0.ESC+"OB":n.C0.ESC+"[B";break;case 45:e.shiftKey||e.ctrlKey||(o.key=n.C0.ESC+"[2~");break;case 46:o.key=a?n.C0.ESC+"[3;"+(a+1)+"~":n.C0.ESC+"[3~";break;case 36:o.key=a?n.C0.ESC+"[1;"+(a+1)+"H":t?n.C0.ESC+"OH":n.C0.ESC+"[H";break;case 35:o.key=a?n.C0.ESC+"[1;"+(a+1)+"F":t?n.C0.ESC+"OF":n.C0.ESC+"[F";break;case 33:e.shiftKey?o.type=2:e.ctrlKey?o.key=n.C0.ESC+"[5;"+(a+1)+"~":o.key=n.C0.ESC+"[5~";break;case 34:e.shiftKey?o.type=3:e.ctrlKey?o.key=n.C0.ESC+"[6;"+(a+1)+"~":o.key=n.C0.ESC+"[6~";break;case 112:o.key=a?n.C0.ESC+"[1;"+(a+1)+"P":n.C0.ESC+"OP";break;case 113:o.key=a?n.C0.ESC+"[1;"+(a+1)+"Q":n.C0.ESC+"OQ";break;case 114:o.key=a?n.C0.ESC+"[1;"+(a+1)+"R":n.C0.ESC+"OR";break;case 115:o.key=a?n.C0.ESC+"[1;"+(a+1)+"S":n.C0.ESC+"OS";break;case 116:o.key=a?n.C0.ESC+"[15;"+(a+1)+"~":n.C0.ESC+"[15~";break;case 117:o.key=a?n.C0.ESC+"[17;"+(a+1)+"~":n.C0.ESC+"[17~";break;case 118:o.key=a?n.C0.ESC+"[18;"+(a+1)+"~":n.C0.ESC+"[18~";break;case 119:o.key=a?n.C0.ESC+"[19;"+(a+1)+"~":n.C0.ESC+"[19~";break;case 120:o.key=a?n.C0.ESC+"[20;"+(a+1)+"~":n.C0.ESC+"[20~";break;case 121:o.key=a?n.C0.ESC+"[21;"+(a+1)+"~":n.C0.ESC+"[21~";break;case 122:o.key=a?n.C0.ESC+"[23;"+(a+1)+"~":n.C0.ESC+"[23~";break;case 123:o.key=a?n.C0.ESC+"[24;"+(a+1)+"~":n.C0.ESC+"[24~";break;default:if(!e.ctrlKey||e.shiftKey||e.altKey||e.metaKey)if(i&&!r||!e.altKey||e.metaKey)!i||e.altKey||e.ctrlKey||e.shiftKey||!e.metaKey?e.key&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&e.keyCode>=48&&1===e.key.length?o.key=e.key:e.key&&e.ctrlKey&&("_"===e.key&&(o.key=n.C0.US),"@"===e.key&&(o.key=n.C0.NUL)):65===e.keyCode&&(o.type=1);else{const t=s[e.keyCode],i=t?.[e.shiftKey?1:0];if(i)o.key=n.C0.ESC+i;else if(e.keyCode>=65&&e.keyCode<=90){const t=e.ctrlKey?e.keyCode-64:e.keyCode+32;let i=String.fromCharCode(t);e.shiftKey&&(i=i.toUpperCase()),o.key=n.C0.ESC+i}else if(32===e.keyCode)o.key=n.C0.ESC+(e.ctrlKey?n.C0.NUL:" ");else if("Dead"===e.key&&e.code.startsWith("Key")){let t=e.code.slice(3,4);e.shiftKey||(t=t.toLowerCase()),o.key=n.C0.ESC+t,o.cancel=!0}}else e.keyCode>=65&&e.keyCode<=90?o.key=String.fromCharCode(e.keyCode-64):32===e.keyCode?o.key=n.C0.NUL:e.keyCode>=51&&e.keyCode<=55?o.key=String.fromCharCode(e.keyCode-51+27):56===e.keyCode?o.key=n.C0.DEL:219===e.keyCode?o.key=n.C0.ESC:220===e.keyCode?o.key=n.C0.FS:221===e.keyCode&&(o.key=n.C0.GS)}return o}},482:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Utf8ToUtf32=t.StringToUtf32=t.utf32ToString=t.stringFromCodePoint=void 0,t.stringFromCodePoint=function(e){return e>65535?(e-=65536,String.fromCharCode(55296+(e>>10))+String.fromCharCode(e%1024+56320)):String.fromCharCode(e)},t.utf32ToString=function(e,t=0,i=e.length){let n="";for(let s=t;s<i;++s){let t=e[s];t>65535?(t-=65536,n+=String.fromCharCode(55296+(t>>10))+String.fromCharCode(t%1024+56320)):n+=String.fromCharCode(t)}return n},t.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(e,t){const i=e.length;if(!i)return 0;let n=0,s=0;if(this._interim){const i=e.charCodeAt(s++);56320<=i&&i<=57343?t[n++]=1024*(this._interim-55296)+i-56320+65536:(t[n++]=this._interim,t[n++]=i),this._interim=0}for(let r=s;r<i;++r){const s=e.charCodeAt(r);if(55296<=s&&s<=56319){if(++r>=i)return this._interim=s,n;const o=e.charCodeAt(r);56320<=o&&o<=57343?t[n++]=1024*(s-55296)+o-56320+65536:(t[n++]=s,t[n++]=o)}else 65279!==s&&(t[n++]=s)}return n}},t.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(e,t){const i=e.length;if(!i)return 0;let n,s,r,o,a=0,l=0,c=0;if(this.interim[0]){let n=!1,s=this.interim[0];s&=192==(224&s)?31:224==(240&s)?15:7;let r,o=0;for(;(r=63&this.interim[++o])&&o<4;)s<<=6,s|=r;const l=192==(224&this.interim[0])?2:224==(240&this.interim[0])?3:4,h=l-o;for(;c<h;){if(c>=i)return 0;if(r=e[c++],128!=(192&r)){c--,n=!0;break}this.interim[o++]=r,s<<=6,s|=63&r}n||(2===l?s<128?c--:t[a++]=s:3===l?s<2048||s>=55296&&s<=57343||65279===s||(t[a++]=s):s<65536||s>1114111||(t[a++]=s)),this.interim.fill(0)}const h=i-4;let d=c;for(;d<i;){for(;!(!(d<h)||128&(n=e[d])||128&(s=e[d+1])||128&(r=e[d+2])||128&(o=e[d+3]));)t[a++]=n,t[a++]=s,t[a++]=r,t[a++]=o,d+=4;if(n=e[d++],n<128)t[a++]=n;else if(192==(224&n)){if(d>=i)return this.interim[0]=n,a;if(s=e[d++],128!=(192&s)){d--;continue}if(l=(31&n)<<6|63&s,l<128){d--;continue}t[a++]=l}else if(224==(240&n)){if(d>=i)return this.interim[0]=n,a;if(s=e[d++],128!=(192&s)){d--;continue}if(d>=i)return this.interim[0]=n,this.interim[1]=s,a;if(r=e[d++],128!=(192&r)){d--;continue}if(l=(15&n)<<12|(63&s)<<6|63&r,l<2048||l>=55296&&l<=57343||65279===l)continue;t[a++]=l}else if(240==(248&n)){if(d>=i)return this.interim[0]=n,a;if(s=e[d++],128!=(192&s)){d--;continue}if(d>=i)return this.interim[0]=n,this.interim[1]=s,a;if(r=e[d++],128!=(192&r)){d--;continue}if(d>=i)return this.interim[0]=n,this.interim[1]=s,this.interim[2]=r,a;if(o=e[d++],128!=(192&o)){d--;continue}if(l=(7&n)<<18|(63&s)<<12|(63&r)<<6|63&o,l<65536||l>1114111)continue;t[a++]=l}}return a}}},225:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeV6=void 0;const n=i(1480),s=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],r=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let o;t.UnicodeV6=class{constructor(){if(this.version="6",!o){o=new Uint8Array(65536),o.fill(1),o[0]=0,o.fill(0,1,32),o.fill(0,127,160),o.fill(2,4352,4448),o[9001]=2,o[9002]=2,o.fill(2,11904,42192),o[12351]=1,o.fill(2,44032,55204),o.fill(2,63744,64256),o.fill(2,65040,65050),o.fill(2,65072,65136),o.fill(2,65280,65377),o.fill(2,65504,65511);for(let e=0;e<s.length;++e)o.fill(0,s[e][0],s[e][1]+1)}}wcwidth(e){return e<32?0:e<127?1:e<65536?o[e]:function(e,t){let i,n=0,s=t.length-1;if(e<t[0][0]||e>t[s][1])return!1;for(;s>=n;)if(i=n+s>>1,e>t[i][1])n=i+1;else{if(!(e<t[i][0]))return!0;s=i-1}return!1}(e,r)?0:e>=131072&&e<=196605||e>=196608&&e<=262141?2:1}charProperties(e,t){let i=this.wcwidth(e),s=0===i&&0!==t;if(s){const e=n.UnicodeService.extractWidth(t);0===e?s=!1:e>i&&(i=e)}return n.UnicodeService.createPropertyValue(0,i,s)}}},5981:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WriteBuffer=void 0;const n=i(8460),s=i(844);class r extends s.Disposable{constructor(e){super(),this._action=e,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new n.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(e,t){if(void 0!==t&&this._syncCalls>t)return void(this._syncCalls=0);if(this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let i;for(this._isSyncWriting=!0;i=this._writeBuffer.shift();){this._action(i);const e=this._callbacks.shift();e&&e()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(e,t){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(t),void this._innerWrite();setTimeout((()=>this._innerWrite()))}this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(t)}_innerWrite(e=0,t=!0){const i=e||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const e=this._writeBuffer[this._bufferOffset],n=this._action(e,t);if(n){const e=e=>Date.now()-i>=12?setTimeout((()=>this._innerWrite(0,e))):this._innerWrite(i,e);return void n.catch((e=>(queueMicrotask((()=>{throw e})),Promise.resolve(!1)))).then(e)}const s=this._callbacks[this._bufferOffset];if(s&&s(),this._bufferOffset++,this._pendingData-=e.length,Date.now()-i>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout((()=>this._innerWrite()))):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}t.WriteBuffer=r},5941:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toRgbString=t.parseColor=void 0;const i=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,n=/^[\da-f]+$/;function s(e,t){const i=e.toString(16),n=i.length<2?"0"+i:i;switch(t){case 4:return i[0];case 8:return n;case 12:return(n+n).slice(0,3);default:return n+n}}t.parseColor=function(e){if(!e)return;let t=e.toLowerCase();if(0===t.indexOf("rgb:")){t=t.slice(4);const e=i.exec(t);if(e){const t=e[1]?15:e[4]?255:e[7]?4095:65535;return[Math.round(parseInt(e[1]||e[4]||e[7]||e[10],16)/t*255),Math.round(parseInt(e[2]||e[5]||e[8]||e[11],16)/t*255),Math.round(parseInt(e[3]||e[6]||e[9]||e[12],16)/t*255)]}}else if(0===t.indexOf("#")&&(t=t.slice(1),n.exec(t)&&[3,6,9,12].includes(t.length))){const e=t.length/3,i=[0,0,0];for(let n=0;n<3;++n){const s=parseInt(t.slice(e*n,e*n+e),16);i[n]=1===e?s<<4:2===e?s:3===e?s>>4:s>>8}return i}},t.toRgbString=function(e,t=16){const[i,n,r]=e;return`rgb:${s(i,t)}/${s(n,t)}/${s(r,t)}`}},5770:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PAYLOAD_LIMIT=void 0,t.PAYLOAD_LIMIT=1e7},6351:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DcsHandler=t.DcsParser=void 0;const n=i(482),s=i(8742),r=i(5770),o=[];t.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=o,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=o}registerHandler(e,t){void 0===this._handlers[e]&&(this._handlers[e]=[]);const i=this._handlers[e];return i.push(t),{dispose:()=>{const e=i.indexOf(t);-1!==e&&i.splice(e,1)}}}clearHandler(e){this._handlers[e]&&delete this._handlers[e]}setHandlerFallback(e){this._handlerFb=e}reset(){if(this._active.length)for(let e=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;e>=0;--e)this._active[e].unhook(!1);this._stack.paused=!1,this._active=o,this._ident=0}hook(e,t){if(this.reset(),this._ident=e,this._active=this._handlers[e]||o,this._active.length)for(let e=this._active.length-1;e>=0;e--)this._active[e].hook(t);else this._handlerFb(this._ident,"HOOK",t)}put(e,t,i){if(this._active.length)for(let n=this._active.length-1;n>=0;n--)this._active[n].put(e,t,i);else this._handlerFb(this._ident,"PUT",(0,n.utf32ToString)(e,t,i))}unhook(e,t=!0){if(this._active.length){let i=!1,n=this._active.length-1,s=!1;if(this._stack.paused&&(n=this._stack.loopPosition-1,i=t,s=this._stack.fallThrough,this._stack.paused=!1),!s&&!1===i){for(;n>=0&&(i=this._active[n].unhook(e),!0!==i);n--)if(i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=n,this._stack.fallThrough=!1,i;n--}for(;n>=0;n--)if(i=this._active[n].unhook(!1),i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=n,this._stack.fallThrough=!0,i}else this._handlerFb(this._ident,"UNHOOK",e);this._active=o,this._ident=0}};const a=new s.Params;a.addParam(0),t.DcsHandler=class{constructor(e){this._handler=e,this._data="",this._params=a,this._hitLimit=!1}hook(e){this._params=e.length>1||e.params[0]?e.clone():a,this._data="",this._hitLimit=!1}put(e,t,i){this._hitLimit||(this._data+=(0,n.utf32ToString)(e,t,i),this._data.length>r.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(e){let t=!1;if(this._hitLimit)t=!1;else if(e&&(t=this._handler(this._data,this._params),t instanceof Promise))return t.then((e=>(this._params=a,this._data="",this._hitLimit=!1,e)));return this._params=a,this._data="",this._hitLimit=!1,t}}},2015:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EscapeSequenceParser=t.VT500_TRANSITION_TABLE=t.TransitionTable=void 0;const n=i(844),s=i(8742),r=i(6242),o=i(6351);class a{constructor(e){this.table=new Uint8Array(e)}setDefault(e,t){this.table.fill(e<<4|t)}add(e,t,i,n){this.table[t<<8|e]=i<<4|n}addMany(e,t,i,n){for(let s=0;s<e.length;s++)this.table[t<<8|e[s]]=i<<4|n}}t.TransitionTable=a;const l=160;t.VT500_TRANSITION_TABLE=function(){const e=new a(4095),t=Array.apply(null,Array(256)).map(((e,t)=>t)),i=(e,i)=>t.slice(e,i),n=i(32,127),s=i(0,24);s.push(25),s.push.apply(s,i(28,32));const r=i(0,14);let o;for(o in e.setDefault(1,0),e.addMany(n,0,2,0),r)e.addMany([24,26,153,154],o,3,0),e.addMany(i(128,144),o,3,0),e.addMany(i(144,152),o,3,0),e.add(156,o,0,0),e.add(27,o,11,1),e.add(157,o,4,8),e.addMany([152,158,159],o,0,7),e.add(155,o,11,3),e.add(144,o,11,9);return e.addMany(s,0,3,0),e.addMany(s,1,3,1),e.add(127,1,0,1),e.addMany(s,8,0,8),e.addMany(s,3,3,3),e.add(127,3,0,3),e.addMany(s,4,3,4),e.add(127,4,0,4),e.addMany(s,6,3,6),e.addMany(s,5,3,5),e.add(127,5,0,5),e.addMany(s,2,3,2),e.add(127,2,0,2),e.add(93,1,4,8),e.addMany(n,8,5,8),e.add(127,8,5,8),e.addMany([156,27,24,26,7],8,6,0),e.addMany(i(28,32),8,0,8),e.addMany([88,94,95],1,0,7),e.addMany(n,7,0,7),e.addMany(s,7,0,7),e.add(156,7,0,0),e.add(127,7,0,7),e.add(91,1,11,3),e.addMany(i(64,127),3,7,0),e.addMany(i(48,60),3,8,4),e.addMany([60,61,62,63],3,9,4),e.addMany(i(48,60),4,8,4),e.addMany(i(64,127),4,7,0),e.addMany([60,61,62,63],4,0,6),e.addMany(i(32,64),6,0,6),e.add(127,6,0,6),e.addMany(i(64,127),6,0,0),e.addMany(i(32,48),3,9,5),e.addMany(i(32,48),5,9,5),e.addMany(i(48,64),5,0,6),e.addMany(i(64,127),5,7,0),e.addMany(i(32,48),4,9,5),e.addMany(i(32,48),1,9,2),e.addMany(i(32,48),2,9,2),e.addMany(i(48,127),2,10,0),e.addMany(i(48,80),1,10,0),e.addMany(i(81,88),1,10,0),e.addMany([89,90,92],1,10,0),e.addMany(i(96,127),1,10,0),e.add(80,1,11,9),e.addMany(s,9,0,9),e.add(127,9,0,9),e.addMany(i(28,32),9,0,9),e.addMany(i(32,48),9,9,12),e.addMany(i(48,60),9,8,10),e.addMany([60,61,62,63],9,9,10),e.addMany(s,11,0,11),e.addMany(i(32,128),11,0,11),e.addMany(i(28,32),11,0,11),e.addMany(s,10,0,10),e.add(127,10,0,10),e.addMany(i(28,32),10,0,10),e.addMany(i(48,60),10,8,10),e.addMany([60,61,62,63],10,0,11),e.addMany(i(32,48),10,9,12),e.addMany(s,12,0,12),e.add(127,12,0,12),e.addMany(i(28,32),12,0,12),e.addMany(i(32,48),12,9,12),e.addMany(i(48,64),12,0,11),e.addMany(i(64,127),12,12,13),e.addMany(i(64,127),10,12,13),e.addMany(i(64,127),9,12,13),e.addMany(s,13,13,13),e.addMany(n,13,13,13),e.add(127,13,0,13),e.addMany([27,156,24,26],13,14,0),e.add(l,0,2,0),e.add(l,8,5,8),e.add(l,6,0,6),e.add(l,11,0,11),e.add(l,13,13,13),e}();class c extends n.Disposable{constructor(e=t.VT500_TRANSITION_TABLE){super(),this._transitions=e,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new s.Params,this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._printHandlerFb=(e,t,i)=>{},this._executeHandlerFb=e=>{},this._csiHandlerFb=(e,t)=>{},this._escHandlerFb=e=>{},this._errorHandlerFb=e=>e,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,n.toDisposable)((()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)}))),this._oscParser=this.register(new r.OscParser),this._dcsParser=this.register(new o.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},(()=>!0))}_identifier(e,t=[64,126]){let i=0;if(e.prefix){if(e.prefix.length>1)throw new Error("only one byte as prefix supported");if(i=e.prefix.charCodeAt(0),i&&60>i||i>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(e.intermediates){if(e.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let t=0;t<e.intermediates.length;++t){const n=e.intermediates.charCodeAt(t);if(32>n||n>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");i<<=8,i|=n}}if(1!==e.final.length)throw new Error("final must be a single byte");const n=e.final.charCodeAt(0);if(t[0]>n||n>t[1])throw new Error(`final must be in range ${t[0]} .. ${t[1]}`);return i<<=8,i|=n,i}identToString(e){const t=[];for(;e;)t.push(String.fromCharCode(255&e)),e>>=8;return t.reverse().join("")}setPrintHandler(e){this._printHandler=e}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(e,t){const i=this._identifier(e,[48,126]);void 0===this._escHandlers[i]&&(this._escHandlers[i]=[]);const n=this._escHandlers[i];return n.push(t),{dispose:()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}}clearEscHandler(e){this._escHandlers[this._identifier(e,[48,126])]&&delete this._escHandlers[this._identifier(e,[48,126])]}setEscHandlerFallback(e){this._escHandlerFb=e}setExecuteHandler(e,t){this._executeHandlers[e.charCodeAt(0)]=t}clearExecuteHandler(e){this._executeHandlers[e.charCodeAt(0)]&&delete this._executeHandlers[e.charCodeAt(0)]}setExecuteHandlerFallback(e){this._executeHandlerFb=e}registerCsiHandler(e,t){const i=this._identifier(e);void 0===this._csiHandlers[i]&&(this._csiHandlers[i]=[]);const n=this._csiHandlers[i];return n.push(t),{dispose:()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}}clearCsiHandler(e){this._csiHandlers[this._identifier(e)]&&delete this._csiHandlers[this._identifier(e)]}setCsiHandlerFallback(e){this._csiHandlerFb=e}registerDcsHandler(e,t){return this._dcsParser.registerHandler(this._identifier(e),t)}clearDcsHandler(e){this._dcsParser.clearHandler(this._identifier(e))}setDcsHandlerFallback(e){this._dcsParser.setHandlerFallback(e)}registerOscHandler(e,t){return this._oscParser.registerHandler(e,t)}clearOscHandler(e){this._oscParser.clearHandler(e)}setOscHandlerFallback(e){this._oscParser.setHandlerFallback(e)}setErrorHandler(e){this._errorHandler=e}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0,0!==this._parseStack.state&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(e,t,i,n,s){this._parseStack.state=e,this._parseStack.handlers=t,this._parseStack.handlerPos=i,this._parseStack.transition=n,this._parseStack.chunkPos=s}parse(e,t,i){let n,s=0,r=0,o=0;if(this._parseStack.state)if(2===this._parseStack.state)this._parseStack.state=0,o=this._parseStack.chunkPos+1;else{if(void 0===i||1===this._parseStack.state)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const t=this._parseStack.handlers;let r=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(!1===i&&r>-1)for(;r>=0&&(n=t[r](this._params),!0!==n);r--)if(n instanceof Promise)return this._parseStack.handlerPos=r,n;this._parseStack.handlers=[];break;case 4:if(!1===i&&r>-1)for(;r>=0&&(n=t[r](),!0!==n);r--)if(n instanceof Promise)return this._parseStack.handlerPos=r,n;this._parseStack.handlers=[];break;case 6:if(s=e[this._parseStack.chunkPos],n=this._dcsParser.unhook(24!==s&&26!==s,i),n)return n;27===s&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(s=e[this._parseStack.chunkPos],n=this._oscParser.end(24!==s&&26!==s,i),n)return n;27===s&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,o=this._parseStack.chunkPos+1,this.precedingJoinState=0,this.currentState=15&this._parseStack.transition}for(let i=o;i<t;++i){switch(s=e[i],r=this._transitions.table[this.currentState<<8|(s<160?s:l)],r>>4){case 2:for(let n=i+1;;++n){if(n>=t||(s=e[n])<32||s>126&&s<l){this._printHandler(e,i,n),i=n-1;break}if(++n>=t||(s=e[n])<32||s>126&&s<l){this._printHandler(e,i,n),i=n-1;break}if(++n>=t||(s=e[n])<32||s>126&&s<l){this._printHandler(e,i,n),i=n-1;break}if(++n>=t||(s=e[n])<32||s>126&&s<l){this._printHandler(e,i,n),i=n-1;break}}break;case 3:this._executeHandlers[s]?this._executeHandlers[s]():this._executeHandlerFb(s),this.precedingJoinState=0;break;case 0:break;case 1:if(this._errorHandler({position:i,code:s,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const o=this._csiHandlers[this._collect<<8|s];let a=o?o.length-1:-1;for(;a>=0&&(n=o[a](this._params),!0!==n);a--)if(n instanceof Promise)return this._preserveStack(3,o,a,r,i),n;a<0&&this._csiHandlerFb(this._collect<<8|s,this._params),this.precedingJoinState=0;break;case 8:do{switch(s){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(s-48)}}while(++i<t&&(s=e[i])>47&&s<60);i--;break;case 9:this._collect<<=8,this._collect|=s;break;case 10:const c=this._escHandlers[this._collect<<8|s];let h=c?c.length-1:-1;for(;h>=0&&(n=c[h](),!0!==n);h--)if(n instanceof Promise)return this._preserveStack(4,c,h,r,i),n;h<0&&this._escHandlerFb(this._collect<<8|s),this.precedingJoinState=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|s,this._params);break;case 13:for(let n=i+1;;++n)if(n>=t||24===(s=e[n])||26===s||27===s||s>127&&s<l){this._dcsParser.put(e,i,n),i=n-1;break}break;case 14:if(n=this._dcsParser.unhook(24!==s&&26!==s),n)return this._preserveStack(6,[],0,r,i),n;27===s&&(r|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break;case 4:this._oscParser.start();break;case 5:for(let n=i+1;;n++)if(n>=t||(s=e[n])<32||s>127&&s<l){this._oscParser.put(e,i,n),i=n-1;break}break;case 6:if(n=this._oscParser.end(24!==s&&26!==s),n)return this._preserveStack(5,[],0,r,i),n;27===s&&(r|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0}this.currentState=15&r}}}t.EscapeSequenceParser=c},6242:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OscHandler=t.OscParser=void 0;const n=i(5770),s=i(482),r=[];t.OscParser=class{constructor(){this._state=0,this._active=r,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(e,t){void 0===this._handlers[e]&&(this._handlers[e]=[]);const i=this._handlers[e];return i.push(t),{dispose:()=>{const e=i.indexOf(t);-1!==e&&i.splice(e,1)}}}clearHandler(e){this._handlers[e]&&delete this._handlers[e]}setHandlerFallback(e){this._handlerFb=e}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=r}reset(){if(2===this._state)for(let e=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;e>=0;--e)this._active[e].end(!1);this._stack.paused=!1,this._active=r,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||r,this._active.length)for(let e=this._active.length-1;e>=0;e--)this._active[e].start();else this._handlerFb(this._id,"START")}_put(e,t,i){if(this._active.length)for(let n=this._active.length-1;n>=0;n--)this._active[n].put(e,t,i);else this._handlerFb(this._id,"PUT",(0,s.utf32ToString)(e,t,i))}start(){this.reset(),this._state=1}put(e,t,i){if(3!==this._state){if(1===this._state)for(;t<i;){const i=e[t++];if(59===i){this._state=2,this._start();break}if(i<48||57<i)return void(this._state=3);-1===this._id&&(this._id=0),this._id=10*this._id+i-48}2===this._state&&i-t>0&&this._put(e,t,i)}}end(e,t=!0){if(0!==this._state){if(3!==this._state)if(1===this._state&&this._start(),this._active.length){let i=!1,n=this._active.length-1,s=!1;if(this._stack.paused&&(n=this._stack.loopPosition-1,i=t,s=this._stack.fallThrough,this._stack.paused=!1),!s&&!1===i){for(;n>=0&&(i=this._active[n].end(e),!0!==i);n--)if(i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=n,this._stack.fallThrough=!1,i;n--}for(;n>=0;n--)if(i=this._active[n].end(!1),i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=n,this._stack.fallThrough=!0,i}else this._handlerFb(this._id,"END",e);this._active=r,this._id=-1,this._state=0}}},t.OscHandler=class{constructor(e){this._handler=e,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(e,t,i){this._hitLimit||(this._data+=(0,s.utf32ToString)(e,t,i),this._data.length>n.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(e){let t=!1;if(this._hitLimit)t=!1;else if(e&&(t=this._handler(this._data),t instanceof Promise))return t.then((e=>(this._data="",this._hitLimit=!1,e)));return this._data="",this._hitLimit=!1,t}}},8742:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Params=void 0;const i=2147483647;class n{static fromArray(e){const t=new n;if(!e.length)return t;for(let i=Array.isArray(e[0])?1:0;i<e.length;++i){const n=e[i];if(Array.isArray(n))for(let e=0;e<n.length;++e)t.addSubParam(n[e]);else t.addParam(n)}return t}constructor(e=32,t=32){if(this.maxLength=e,this.maxSubParamsLength=t,t>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(e),this.length=0,this._subParams=new Int32Array(t),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(e),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){const e=new n(this.maxLength,this.maxSubParamsLength);return e.params.set(this.params),e.length=this.length,e._subParams.set(this._subParams),e._subParamsLength=this._subParamsLength,e._subParamsIdx.set(this._subParamsIdx),e._rejectDigits=this._rejectDigits,e._rejectSubDigits=this._rejectSubDigits,e._digitIsSub=this._digitIsSub,e}toArray(){const e=[];for(let t=0;t<this.length;++t){e.push(this.params[t]);const i=this._subParamsIdx[t]>>8,n=255&this._subParamsIdx[t];n-i>0&&e.push(Array.prototype.slice.call(this._subParams,i,n))}return e}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(e){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(e<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=e>i?i:e}}addSubParam(e){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(e<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=e>i?i:e,this._subParamsIdx[this.length-1]++}}hasSubParams(e){return(255&this._subParamsIdx[e])-(this._subParamsIdx[e]>>8)>0}getSubParams(e){const t=this._subParamsIdx[e]>>8,i=255&this._subParamsIdx[e];return i-t>0?this._subParams.subarray(t,i):null}getSubParamsAll(){const e={};for(let t=0;t<this.length;++t){const i=this._subParamsIdx[t]>>8,n=255&this._subParamsIdx[t];n-i>0&&(e[t]=this._subParams.slice(i,n))}return e}addDigit(e){let t;if(this._rejectDigits||!(t=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const n=this._digitIsSub?this._subParams:this.params,s=n[t-1];n[t-1]=~s?Math.min(10*s+e,i):e}}t.Params=n},5741:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AddonManager=void 0,t.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let e=this._addons.length-1;e>=0;e--)this._addons[e].instance.dispose()}loadAddon(e,t){const i={instance:t,dispose:t.dispose,isDisposed:!1};this._addons.push(i),t.dispose=()=>this._wrappedAddonDispose(i),t.activate(e)}_wrappedAddonDispose(e){if(e.isDisposed)return;let t=-1;for(let i=0;i<this._addons.length;i++)if(this._addons[i]===e){t=i;break}if(-1===t)throw new Error("Could not dispose an addon that has not been loaded");e.isDisposed=!0,e.dispose.apply(e.instance),this._addons.splice(t,1)}}},8771:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferApiView=void 0;const n=i(3785),s=i(511);t.BufferApiView=class{constructor(e,t){this._buffer=e,this.type=t}init(e){return this._buffer=e,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(e){const t=this._buffer.lines.get(e);if(t)return new n.BufferLineApiView(t)}getNullCell(){return new s.CellData}}},3785:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferLineApiView=void 0;const n=i(511);t.BufferLineApiView=class{constructor(e){this._line=e}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(e,t){if(!(e<0||e>=this._line.length))return t?(this._line.loadCell(e,t),t):this._line.loadCell(e,new n.CellData)}translateToString(e,t,i){return this._line.translateToString(e,t,i)}}},8285:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferNamespaceApi=void 0;const n=i(8771),s=i(8460),r=i(844);class o extends r.Disposable{constructor(e){super(),this._core=e,this._onBufferChange=this.register(new s.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new n.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new n.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate((()=>this._onBufferChange.fire(this.active)))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}t.BufferNamespaceApi=o},7975:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ParserApi=void 0,t.ParserApi=class{constructor(e){this._core=e}registerCsiHandler(e,t){return this._core.registerCsiHandler(e,(e=>t(e.toArray())))}addCsiHandler(e,t){return this.registerCsiHandler(e,t)}registerDcsHandler(e,t){return this._core.registerDcsHandler(e,((e,i)=>t(e,i.toArray())))}addDcsHandler(e,t){return this.registerDcsHandler(e,t)}registerEscHandler(e,t){return this._core.registerEscHandler(e,t)}addEscHandler(e,t){return this.registerEscHandler(e,t)}registerOscHandler(e,t){return this._core.registerOscHandler(e,t)}addOscHandler(e,t){return this.registerOscHandler(e,t)}}},7090:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeApi=void 0,t.UnicodeApi=class{constructor(e){this._core=e}register(e){this._core.unicodeService.register(e)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(e){this._core.unicodeService.activeVersion=e}}},744:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferService=t.MINIMUM_ROWS=t.MINIMUM_COLS=void 0;const r=i(8460),o=i(844),a=i(5295),l=i(2585);t.MINIMUM_COLS=2,t.MINIMUM_ROWS=1;let c=t.BufferService=class extends o.Disposable{get buffer(){return this.buffers.active}constructor(e){super(),this.isUserScrolling=!1,this._onResize=this.register(new r.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new r.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(e.rawOptions.cols||0,t.MINIMUM_COLS),this.rows=Math.max(e.rawOptions.rows||0,t.MINIMUM_ROWS),this.buffers=this.register(new a.BufferSet(e,this))}resize(e,t){this.cols=e,this.rows=t,this.buffers.resize(e,t),this._onResize.fire({cols:e,rows:t})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(e,t=!1){const i=this.buffer;let n;n=this._cachedBlankLine,n&&n.length===this.cols&&n.getFg(0)===e.fg&&n.getBg(0)===e.bg||(n=i.getBlankLine(e,t),this._cachedBlankLine=n),n.isWrapped=t;const s=i.ybase+i.scrollTop,r=i.ybase+i.scrollBottom;if(0===i.scrollTop){const e=i.lines.isFull;r===i.lines.length-1?e?i.lines.recycle().copyFrom(n):i.lines.push(n.clone()):i.lines.splice(r+1,0,n.clone()),e?this.isUserScrolling&&(i.ydisp=Math.max(i.ydisp-1,0)):(i.ybase++,this.isUserScrolling||i.ydisp++)}else{const e=r-s+1;i.lines.shiftElements(s+1,e-1,-1),i.lines.set(r,n.clone())}this.isUserScrolling||(i.ydisp=i.ybase),this._onScroll.fire(i.ydisp)}scrollLines(e,t,i){const n=this.buffer;if(e<0){if(0===n.ydisp)return;this.isUserScrolling=!0}else e+n.ydisp>=n.ybase&&(this.isUserScrolling=!1);const s=n.ydisp;n.ydisp=Math.max(Math.min(n.ydisp+e,n.ybase),0),s!==n.ydisp&&(t||this._onScroll.fire(n.ydisp))}};t.BufferService=c=n([s(0,l.IOptionsService)],c)},7994:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CharsetService=void 0,t.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(e){this.glevel=e,this.charset=this._charsets[e]}setgCharset(e,t){this._charsets[e]=t,this.glevel===e&&(this.charset=t)}}},1753:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CoreMouseService=void 0;const r=i(2585),o=i(8460),a=i(844),l={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:e=>4!==e.button&&1===e.action&&(e.ctrl=!1,e.alt=!1,e.shift=!1,!0)},VT200:{events:19,restrict:e=>32!==e.action},DRAG:{events:23,restrict:e=>32!==e.action||3!==e.button},ANY:{events:31,restrict:e=>!0}};function c(e,t){let i=(e.ctrl?16:0)|(e.shift?4:0)|(e.alt?8:0);return 4===e.button?(i|=64,i|=e.action):(i|=3&e.button,4&e.button&&(i|=64),8&e.button&&(i|=128),32===e.action?i|=32:0!==e.action||t||(i|=3)),i}const h=String.fromCharCode,d={DEFAULT:e=>{const t=[c(e,!1)+32,e.col+32,e.row+32];return t[0]>255||t[1]>255||t[2]>255?"":`[M${h(t[0])}${h(t[1])}${h(t[2])}`},SGR:e=>{const t=0===e.action&&4!==e.button?"m":"M";return`[<${c(e,!0)};${e.col};${e.row}${t}`},SGR_PIXELS:e=>{const t=0===e.action&&4!==e.button?"m":"M";return`[<${c(e,!0)};${e.x};${e.y}${t}`}};let u=t.CoreMouseService=class extends a.Disposable{constructor(e,t){super(),this._bufferService=e,this._coreService=t,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new o.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const e of Object.keys(l))this.addProtocol(e,l[e]);for(const e of Object.keys(d))this.addEncoding(e,d[e]);this.reset()}addProtocol(e,t){this._protocols[e]=t}addEncoding(e,t){this._encodings[e]=t}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return 0!==this._protocols[this._activeProtocol].events}set activeProtocol(e){if(!this._protocols[e])throw new Error(`unknown protocol "${e}"`);this._activeProtocol=e,this._onProtocolChange.fire(this._protocols[e].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(e){if(!this._encodings[e])throw new Error(`unknown encoding "${e}"`);this._activeEncoding=e}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(e){if(e.col<0||e.col>=this._bufferService.cols||e.row<0||e.row>=this._bufferService.rows)return!1;if(4===e.button&&32===e.action)return!1;if(3===e.button&&32!==e.action)return!1;if(4!==e.button&&(2===e.action||3===e.action))return!1;if(e.col++,e.row++,32===e.action&&this._lastEvent&&this._equalEvents(this._lastEvent,e,"SGR_PIXELS"===this._activeEncoding))return!1;if(!this._protocols[this._activeProtocol].restrict(e))return!1;const t=this._encodings[this._activeEncoding](e);return t&&("DEFAULT"===this._activeEncoding?this._coreService.triggerBinaryEvent(t):this._coreService.triggerDataEvent(t,!0)),this._lastEvent=e,!0}explainEvents(e){return{down:!!(1&e),up:!!(2&e),drag:!!(4&e),move:!!(8&e),wheel:!!(16&e)}}_equalEvents(e,t,i){if(i){if(e.x!==t.x)return!1;if(e.y!==t.y)return!1}else{if(e.col!==t.col)return!1;if(e.row!==t.row)return!1}return e.button===t.button&&e.action===t.action&&e.ctrl===t.ctrl&&e.alt===t.alt&&e.shift===t.shift}};t.CoreMouseService=u=n([s(0,r.IBufferService),s(1,r.ICoreService)],u)},6975:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CoreService=void 0;const r=i(1439),o=i(8460),a=i(844),l=i(2585),c=Object.freeze({insertMode:!1}),h=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let d=t.CoreService=class extends a.Disposable{constructor(e,t,i){super(),this._bufferService=e,this._logService=t,this._optionsService=i,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new o.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new o.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new o.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new o.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,r.clone)(c),this.decPrivateModes=(0,r.clone)(h)}reset(){this.modes=(0,r.clone)(c),this.decPrivateModes=(0,r.clone)(h)}triggerDataEvent(e,t=!1){if(this._optionsService.rawOptions.disableStdin)return;const i=this._bufferService.buffer;t&&this._optionsService.rawOptions.scrollOnUserInput&&i.ybase!==i.ydisp&&this._onRequestScrollToBottom.fire(),t&&this._onUserInput.fire(),this._logService.debug(`sending data "${e}"`,(()=>e.split("").map((e=>e.charCodeAt(0))))),this._onData.fire(e)}triggerBinaryEvent(e){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${e}"`,(()=>e.split("").map((e=>e.charCodeAt(0))))),this._onBinary.fire(e))}};t.CoreService=d=n([s(0,l.IBufferService),s(1,l.ILogService),s(2,l.IOptionsService)],d)},9074:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DecorationService=void 0;const n=i(8055),s=i(8460),r=i(844),o=i(6106);let a=0,l=0;class c extends r.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new o.SortedList((e=>e?.marker.line)),this._onDecorationRegistered=this.register(new s.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new s.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,r.toDisposable)((()=>this.reset())))}registerDecoration(e){if(e.marker.isDisposed)return;const t=new h(e);if(t){const e=t.marker.onDispose((()=>t.dispose()));t.onDispose((()=>{t&&(this._decorations.delete(t)&&this._onDecorationRemoved.fire(t),e.dispose())})),this._decorations.insert(t),this._onDecorationRegistered.fire(t)}return t}reset(){for(const e of this._decorations.values())e.dispose();this._decorations.clear()}*getDecorationsAtCell(e,t,i){let n=0,s=0;for(const r of this._decorations.getKeyIterator(t))n=r.options.x??0,s=n+(r.options.width??1),e>=n&&e<s&&(!i||(r.options.layer??"bottom")===i)&&(yield r)}forEachDecorationAtCell(e,t,i,n){this._decorations.forEachByKey(t,(t=>{a=t.options.x??0,l=a+(t.options.width??1),e>=a&&e<l&&(!i||(t.options.layer??"bottom")===i)&&n(t)}))}}t.DecorationService=c;class h extends r.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return null===this._cachedBg&&(this.options.backgroundColor?this._cachedBg=n.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return null===this._cachedFg&&(this.options.foregroundColor?this._cachedFg=n.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(e){super(),this.options=e,this.onRenderEmitter=this.register(new s.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new s.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=e.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InstantiationService=t.ServiceCollection=void 0;const n=i(2585),s=i(8343);class r{constructor(...e){this._entries=new Map;for(const[t,i]of e)this.set(t,i)}set(e,t){const i=this._entries.get(e);return this._entries.set(e,t),i}forEach(e){for(const[t,i]of this._entries.entries())e(t,i)}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}}t.ServiceCollection=r,t.InstantiationService=class{constructor(){this._services=new r,this._services.set(n.IInstantiationService,this)}setService(e,t){this._services.set(e,t)}getService(e){return this._services.get(e)}createInstance(e,...t){const i=(0,s.getServiceDependencies)(e).sort(((e,t)=>e.index-t.index)),n=[];for(const t of i){const i=this._services.get(t.id);if(!i)throw new Error(`[createInstance] ${e.name} depends on UNKNOWN service ${t.id}.`);n.push(i)}const r=i.length>0?i[0].index:t.length;if(t.length!==r)throw new Error(`[createInstance] First service dependency of ${e.name} at position ${r+1} conflicts with ${t.length} static arguments`);return new e(...[...t,...n])}}},7866:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.traceCall=t.setTraceLogger=t.LogService=void 0;const r=i(844),o=i(2585),a={trace:o.LogLevelEnum.TRACE,debug:o.LogLevelEnum.DEBUG,info:o.LogLevelEnum.INFO,warn:o.LogLevelEnum.WARN,error:o.LogLevelEnum.ERROR,off:o.LogLevelEnum.OFF};let l,c=t.LogService=class extends r.Disposable{get logLevel(){return this._logLevel}constructor(e){super(),this._optionsService=e,this._logLevel=o.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",(()=>this._updateLogLevel()))),l=this}_updateLogLevel(){this._logLevel=a[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(e){for(let t=0;t<e.length;t++)"function"==typeof e[t]&&(e[t]=e[t]())}_log(e,t,i){this._evalLazyOptionalParams(i),e.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+t,...i)}trace(e,...t){this._logLevel<=o.LogLevelEnum.TRACE&&this._log(this._optionsService.options.logger?.trace.bind(this._optionsService.options.logger)??console.log,e,t)}debug(e,...t){this._logLevel<=o.LogLevelEnum.DEBUG&&this._log(this._optionsService.options.logger?.debug.bind(this._optionsService.options.logger)??console.log,e,t)}info(e,...t){this._logLevel<=o.LogLevelEnum.INFO&&this._log(this._optionsService.options.logger?.info.bind(this._optionsService.options.logger)??console.info,e,t)}warn(e,...t){this._logLevel<=o.LogLevelEnum.WARN&&this._log(this._optionsService.options.logger?.warn.bind(this._optionsService.options.logger)??console.warn,e,t)}error(e,...t){this._logLevel<=o.LogLevelEnum.ERROR&&this._log(this._optionsService.options.logger?.error.bind(this._optionsService.options.logger)??console.error,e,t)}};t.LogService=c=n([s(0,o.IOptionsService)],c),t.setTraceLogger=function(e){l=e},t.traceCall=function(e,t,i){if("function"!=typeof i.value)throw new Error("not supported");const n=i.value;i.value=function(...e){if(l.logLevel!==o.LogLevelEnum.TRACE)return n.apply(this,e);l.trace(`GlyphRenderer#${n.name}(${e.map((e=>JSON.stringify(e))).join(", ")})`);const t=n.apply(this,e);return l.trace(`GlyphRenderer#${n.name} return`,t),t}}},7302:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OptionsService=t.DEFAULT_OPTIONS=void 0;const n=i(8460),s=i(844),r=i(6114);t.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,documentOverride:null,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rescaleOverlappingGlyphs:!1,rightClickSelectsWord:r.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const o=["normal","bold","100","200","300","400","500","600","700","800","900"];class a extends s.Disposable{constructor(e){super(),this._onOptionChange=this.register(new n.EventEmitter),this.onOptionChange=this._onOptionChange.event;const i={...t.DEFAULT_OPTIONS};for(const t in e)if(t in i)try{const n=e[t];i[t]=this._sanitizeAndValidateOption(t,n)}catch(e){console.error(e)}this.rawOptions=i,this.options={...i},this._setupOptions(),this.register((0,s.toDisposable)((()=>{this.rawOptions.linkHandler=null,this.rawOptions.documentOverride=null})))}onSpecificOptionChange(e,t){return this.onOptionChange((i=>{i===e&&t(this.rawOptions[e])}))}onMultipleOptionChange(e,t){return this.onOptionChange((i=>{-1!==e.indexOf(i)&&t()}))}_setupOptions(){const e=e=>{if(!(e in t.DEFAULT_OPTIONS))throw new Error(`No option with key "${e}"`);return this.rawOptions[e]},i=(e,i)=>{if(!(e in t.DEFAULT_OPTIONS))throw new Error(`No option with key "${e}"`);i=this._sanitizeAndValidateOption(e,i),this.rawOptions[e]!==i&&(this.rawOptions[e]=i,this._onOptionChange.fire(e))};for(const t in this.rawOptions){const n={get:e.bind(this,t),set:i.bind(this,t)};Object.defineProperty(this.options,t,n)}}_sanitizeAndValidateOption(e,i){switch(e){case"cursorStyle":if(i||(i=t.DEFAULT_OPTIONS[e]),!function(e){return"block"===e||"underline"===e||"bar"===e}(i))throw new Error(`"${i}" is not a valid value for ${e}`);break;case"wordSeparator":i||(i=t.DEFAULT_OPTIONS[e]);break;case"fontWeight":case"fontWeightBold":if("number"==typeof i&&1<=i&&i<=1e3)break;i=o.includes(i)?i:t.DEFAULT_OPTIONS[e];break;case"cursorWidth":i=Math.floor(i);case"lineHeight":case"tabStopWidth":if(i<1)throw new Error(`${e} cannot be less than 1, value: ${i}`);break;case"minimumContrastRatio":i=Math.max(1,Math.min(21,Math.round(10*i)/10));break;case"scrollback":if((i=Math.min(i,4294967295))<0)throw new Error(`${e} cannot be less than 0, value: ${i}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(i<=0)throw new Error(`${e} cannot be less than or equal to 0, value: ${i}`);break;case"rows":case"cols":if(!i&&0!==i)throw new Error(`${e} must be numeric, value: ${i}`);break;case"windowsPty":i=i??{}}return i}}t.OptionsService=a},2660:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OscLinkService=void 0;const r=i(2585);let o=t.OscLinkService=class{constructor(e){this._bufferService=e,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(e){const t=this._bufferService.buffer;if(void 0===e.id){const i=t.addMarker(t.ybase+t.y),n={data:e,id:this._nextId++,lines:[i]};return i.onDispose((()=>this._removeMarkerFromLink(n,i))),this._dataByLinkId.set(n.id,n),n.id}const i=e,n=this._getEntryIdKey(i),s=this._entriesWithId.get(n);if(s)return this.addLineToLink(s.id,t.ybase+t.y),s.id;const r=t.addMarker(t.ybase+t.y),o={id:this._nextId++,key:this._getEntryIdKey(i),data:i,lines:[r]};return r.onDispose((()=>this._removeMarkerFromLink(o,r))),this._entriesWithId.set(o.key,o),this._dataByLinkId.set(o.id,o),o.id}addLineToLink(e,t){const i=this._dataByLinkId.get(e);if(i&&i.lines.every((e=>e.line!==t))){const e=this._bufferService.buffer.addMarker(t);i.lines.push(e),e.onDispose((()=>this._removeMarkerFromLink(i,e)))}}getLinkData(e){return this._dataByLinkId.get(e)?.data}_getEntryIdKey(e){return`${e.id};;${e.uri}`}_removeMarkerFromLink(e,t){const i=e.lines.indexOf(t);-1!==i&&(e.lines.splice(i,1),0===e.lines.length&&(void 0!==e.data.id&&this._entriesWithId.delete(e.key),this._dataByLinkId.delete(e.id)))}};t.OscLinkService=o=n([s(0,r.IBufferService)],o)},8343:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createDecorator=t.getServiceDependencies=t.serviceRegistry=void 0;const i="di$target",n="di$dependencies";t.serviceRegistry=new Map,t.getServiceDependencies=function(e){return e[n]||[]},t.createDecorator=function(e){if(t.serviceRegistry.has(e))return t.serviceRegistry.get(e);const s=function(e,t,r){if(3!==arguments.length)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");!function(e,t,s){t[i]===t?t[n].push({id:e,index:s}):(t[n]=[{id:e,index:s}],t[i]=t)}(s,e,r)};return s.toString=()=>e,t.serviceRegistry.set(e,s),s}},2585:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IDecorationService=t.IUnicodeService=t.IOscLinkService=t.IOptionsService=t.ILogService=t.LogLevelEnum=t.IInstantiationService=t.ICharsetService=t.ICoreService=t.ICoreMouseService=t.IBufferService=void 0;const n=i(8343);var s;t.IBufferService=(0,n.createDecorator)("BufferService"),t.ICoreMouseService=(0,n.createDecorator)("CoreMouseService"),t.ICoreService=(0,n.createDecorator)("CoreService"),t.ICharsetService=(0,n.createDecorator)("CharsetService"),t.IInstantiationService=(0,n.createDecorator)("InstantiationService"),function(e){e[e.TRACE=0]="TRACE",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.OFF=5]="OFF"}(s||(t.LogLevelEnum=s={})),t.ILogService=(0,n.createDecorator)("LogService"),t.IOptionsService=(0,n.createDecorator)("OptionsService"),t.IOscLinkService=(0,n.createDecorator)("OscLinkService"),t.IUnicodeService=(0,n.createDecorator)("UnicodeService"),t.IDecorationService=(0,n.createDecorator)("DecorationService")},1480:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeService=void 0;const n=i(8460),s=i(225);class r{static extractShouldJoin(e){return!!(1&e)}static extractWidth(e){return e>>1&3}static extractCharKind(e){return e>>3}static createPropertyValue(e,t,i=!1){return(16777215&e)<<3|(3&t)<<1|(i?1:0)}constructor(){this._providers=Object.create(null),this._active="",this._onChange=new n.EventEmitter,this.onChange=this._onChange.event;const e=new s.UnicodeV6;this.register(e),this._active=e.version,this._activeProvider=e}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(e){if(!this._providers[e])throw new Error(`unknown Unicode version "${e}"`);this._active=e,this._activeProvider=this._providers[e],this._onChange.fire(e)}register(e){this._providers[e.version]=e}wcwidth(e){return this._activeProvider.wcwidth(e)}getStringCellWidth(e){let t=0,i=0;const n=e.length;for(let s=0;s<n;++s){let o=e.charCodeAt(s);if(55296<=o&&o<=56319){if(++s>=n)return t+this.wcwidth(o);const i=e.charCodeAt(s);56320<=i&&i<=57343?o=1024*(o-55296)+i-56320+65536:t+=this.wcwidth(i)}const a=this.charProperties(o,i);let l=r.extractWidth(a);r.extractShouldJoin(a)&&(l-=r.extractWidth(i)),t+=l,i=a}return t}charProperties(e,t){return this._activeProvider.charProperties(e,t)}}t.UnicodeService=r}},t={};function i(n){var s=t[n];if(void 0!==s)return s.exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,i),r.exports}var n={};return(()=>{var e=n;Object.defineProperty(e,"__esModule",{value:!0}),e.Terminal=void 0;const t=i(9042),s=i(3236),r=i(844),o=i(5741),a=i(8285),l=i(7975),c=i(7090),h=["cols","rows"];class d extends r.Disposable{constructor(e){super(),this._core=this.register(new s.Terminal(e)),this._addonManager=this.register(new o.AddonManager),this._publicOptions={...this._core.options};const t=e=>this._core.options[e],i=(e,t)=>{this._checkReadonlyOptions(e),this._core.options[e]=t};for(const e in this._core.options){const n={get:t.bind(this,e),set:i.bind(this,e)};Object.defineProperty(this._publicOptions,e,n)}}_checkReadonlyOptions(e){if(h.includes(e))throw new Error(`Option "${e}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new l.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new c.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new a.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const e=this._core.coreService.decPrivateModes;let t="none";switch(this._core.coreMouseService.activeProtocol){case"X10":t="x10";break;case"VT200":t="vt200";break;case"DRAG":t="drag";break;case"ANY":t="any"}return{applicationCursorKeysMode:e.applicationCursorKeys,applicationKeypadMode:e.applicationKeypad,bracketedPasteMode:e.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:t,originMode:e.origin,reverseWraparoundMode:e.reverseWraparound,sendFocusMode:e.sendFocus,wraparoundMode:e.wraparound}}get options(){return this._publicOptions}set options(e){for(const t in e)this._publicOptions[t]=e[t]}blur(){this._core.blur()}focus(){this._core.focus()}input(e,t=!0){this._core.input(e,t)}resize(e,t){this._verifyIntegers(e,t),this._core.resize(e,t)}open(e){this._core.open(e)}attachCustomKeyEventHandler(e){this._core.attachCustomKeyEventHandler(e)}attachCustomWheelEventHandler(e){this._core.attachCustomWheelEventHandler(e)}registerLinkProvider(e){return this._core.registerLinkProvider(e)}registerCharacterJoiner(e){return this._checkProposedApi(),this._core.registerCharacterJoiner(e)}deregisterCharacterJoiner(e){this._checkProposedApi(),this._core.deregisterCharacterJoiner(e)}registerMarker(e=0){return this._verifyIntegers(e),this._core.registerMarker(e)}registerDecoration(e){return this._checkProposedApi(),this._verifyPositiveIntegers(e.x??0,e.width??0,e.height??0),this._core.registerDecoration(e)}hasSelection(){return this._core.hasSelection()}select(e,t,i){this._verifyIntegers(e,t,i),this._core.select(e,t,i)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(e,t){this._verifyIntegers(e,t),this._core.selectLines(e,t)}dispose(){super.dispose()}scrollLines(e){this._verifyIntegers(e),this._core.scrollLines(e)}scrollPages(e){this._verifyIntegers(e),this._core.scrollPages(e)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(e){this._verifyIntegers(e),this._core.scrollToLine(e)}clear(){this._core.clear()}write(e,t){this._core.write(e,t)}writeln(e,t){this._core.write(e),this._core.write("\r\n",t)}paste(e){this._core.paste(e)}refresh(e,t){this._verifyIntegers(e,t),this._core.refresh(e,t)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(e){this._addonManager.loadAddon(this,e)}static get strings(){return t}_verifyIntegers(...e){for(const t of e)if(t===1/0||isNaN(t)||t%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...e){for(const t of e)if(t&&(t===1/0||isNaN(t)||t%1!=0||t<0))throw new Error("This API only accepts positive integers")}}e.Terminal=d})(),n})(),e.exports=t()},34:(e,t,i)=>{"use strict";i.r(t),i.d(t,{GoldenLayout:()=>a});var n=i(692),s=i.n(n);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var o={config:{},container:{},controls:{},errors:{},items:{},utils:{}};o.utils.F=function(){},o.utils.extend=function(e,t){e.prototype=o.utils.createObject(t.prototype),e.prototype.contructor=e},o.utils.createObject=function(e){return"function"==typeof Object.create?Object.create(e):(o.utils.F.prototype=e,new o.utils.F)},o.utils.objectKeys=function(e){var t,i;if("function"==typeof Object.keys)return Object.keys(e);for(i in t=[],e)t.push(i);return t},o.utils.getHashValue=function(e){var t=location.hash.match(new RegExp(e+"=([^&]*)"));return t?t[1]:null},o.utils.getQueryStringParam=function(e){if(window.location.hash)return o.utils.getHashValue(e);if(!window.location.search)return null;var t,i,n=window.location.search.substr(1).split("&"),s={};for(i=0;i<n.length;i++)s[(t=n[i].split("="))[0]]=t[1];return s[e]||null},o.utils.copy=function(e,t){for(var i in t)e[i]=t[i];return e},o.utils.animFrame=function(e){return(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)})((function(){e()}))},o.utils.indexOf=function(e,t){if(!(t instanceof Array))throw new Error("Haystack is not an Array");if(t.indexOf)return t.indexOf(e);for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1},"object"!=("undefined"==typeof Int8Array?"undefined":r(Int8Array))?o.utils.isFunction=function(e){return"function"==typeof e||!1}:o.utils.isFunction=function(e){return"[object Function]"===toString.call(e)},o.utils.fnBind=function(e,t,i){if(void 0!==Function.prototype.bind)return Function.prototype.bind.apply(e,[t].concat(i||[]));var n=function(){var s=(i||[]).concat(Array.prototype.slice.call(arguments,0));if(!(this instanceof n))return e.apply(t,s);e.apply(this,s)};return n.prototype=e.prototype,n},o.utils.removeFromArray=function(e,t){var i=o.utils.indexOf(e,t);if(-1===i)throw new Error("Can't remove item from array. Item is not in the array");t.splice(i,1)},o.utils.now=function(){return"function"==typeof Date.now?Date.now():(new Date).getTime()},o.utils.getUniqueId=function(){return(1e15*Math.random()).toString(36).replace(".","")},o.utils.filterXss=function(e,t){var i=e.replace(/javascript/gi,"j&#97;vascript").replace(/expression/gi,"expr&#101;ssion").replace(/onload/gi,"onlo&#97;d").replace(/script/gi,"&#115;cript").replace(/onerror/gi,"on&#101;rror");return!0===t?i:i.replace(/>/g,"&gt;").replace(/</g,"&lt;")},o.utils.stripTags=function(e){return s().trim(e.replace(/(<([^>]+)>)/gi,""))},o.utils.EventEmitter=function(){this._mSubscriptions={},this._mSubscriptions[o.utils.EventEmitter.ALL_EVENT]=[],this.on=function(e,t,i){if(!o.utils.isFunction(t))throw new Error("Tried to listen to event "+e+" with non-function callback "+t);this._mSubscriptions[e]||(this._mSubscriptions[e]=[]),this._mSubscriptions[e].push({fn:t,ctx:i})},this.emit=function(e){var t,i,n;if(n=Array.prototype.slice.call(arguments,1),this._mSubscriptions[e])for(t=0;t<this._mSubscriptions[e].length;t++)i=this._mSubscriptions[e][t].ctx||{},this._mSubscriptions[e][t].fn.apply(i,n);for(n.unshift(e),t=0;t<this._mSubscriptions[o.utils.EventEmitter.ALL_EVENT].length;t++)i=this._mSubscriptions[o.utils.EventEmitter.ALL_EVENT][t].ctx||{},this._mSubscriptions[o.utils.EventEmitter.ALL_EVENT][t].fn.apply(i,n)},this.unbind=function(e,t,i){if(!this._mSubscriptions[e])throw new Error("No subscribtions to unsubscribe for event "+e);var n,s=!1;for(n=0;n<this._mSubscriptions[e].length;n++)t&&this._mSubscriptions[e][n].fn!==t||i&&i!==this._mSubscriptions[e][n].ctx||(this._mSubscriptions[e].splice(n,1),s=!0);if(!1===s)throw new Error("Nothing to unbind for "+e)},this.off=this.unbind,this.trigger=this.emit},o.utils.EventEmitter.ALL_EVENT="__all",o.utils.DragListener=function(e,t){o.utils.EventEmitter.call(this),this._eElement=s()(e),this._oDocument=s()(document),this._eBody=s()(document.body),this._nButtonCode=t||0,this._nDelay=200,this._nDistance=10,this._nX=0,this._nY=0,this._nOriginalX=0,this._nOriginalY=0,this._bDragging=!1,this._fMove=o.utils.fnBind(this.onMouseMove,this),this._fUp=o.utils.fnBind(this.onMouseUp,this),this._fDown=o.utils.fnBind(this.onMouseDown,this),this._eElement.on("mousedown touchstart",this._fDown)},o.utils.DragListener.timeout=null,o.utils.copy(o.utils.DragListener.prototype,{destroy:function(){this._eElement.unbind("mousedown touchstart",this._fDown)},onMouseDown:function(e){if(e.preventDefault(),0==e.button||"touchstart"===e.type){var t=this._getCoordinates(e);this._nOriginalX=t.x,this._nOriginalY=t.y,this._oDocument.on("mousemove touchmove",this._fMove),this._oDocument.one("mouseup touchend",this._fUp),this._timeout=setTimeout(o.utils.fnBind(this._startDrag,this),this._nDelay)}},onMouseMove:function(e){if(null!=this._timeout){e.preventDefault();var t=this._getCoordinates(e);this._nX=t.x-this._nOriginalX,this._nY=t.y-this._nOriginalY,!1===this._bDragging&&(Math.abs(this._nX)>this._nDistance||Math.abs(this._nY)>this._nDistance)&&(clearTimeout(this._timeout),this._startDrag()),this._bDragging&&this.emit("drag",this._nX,this._nY,e)}},onMouseUp:function(e){null!=this._timeout&&(clearTimeout(this._timeout),this._eBody.removeClass("lm_dragging"),this._eElement.removeClass("lm_dragging"),this._oDocument.find("iframe").css("pointer-events",""),this._oDocument.unbind("mousemove touchmove",this._fMove),!0===this._bDragging&&(this._bDragging=!1,this.emit("dragStop",e,this._nOriginalX+this._nX)))},_startDrag:function(){this._bDragging=!0,this._eBody.addClass("lm_dragging"),this._eElement.addClass("lm_dragging"),this._oDocument.find("iframe").css("pointer-events","none"),this.emit("dragStart",this._nOriginalX,this._nOriginalY)},_getCoordinates:function(e){return{x:(e=e.originalEvent&&e.originalEvent.touches?e.originalEvent.touches[0]:e).pageX,y:e.pageY}}}),o.LayoutManager=function(e,t){if(!s()||"function"!=typeof s().noConflict)throw new Error('jQuery is missing as dependency for GoldenLayout. Please either expose $ on GoldenLayout\'s scope (e.g. window) or add "jquery" to your paths when using RequireJS/AMD');o.utils.EventEmitter.call(this),this.isInitialised=!1,this._isFullPage=!1,this._resizeTimeoutId=null,this._components={"lm-react-component":o.utils.ReactComponentHandler},this._itemAreas=[],this._resizeFunction=o.utils.fnBind(this._onResize,this),this._unloadFunction=o.utils.fnBind(this._onUnload,this),this._maximisedItem=null,this._maximisePlaceholder=s()('<div class="lm_maximise_place"></div>'),this._creationTimeoutPassed=!1,this._subWindowsCreated=!1,this._dragSources=[],this._updatingColumnsResponsive=!1,this._firstLoad=!0,this.width=null,this.height=null,this.root=null,this.openPopouts=[],this.selectedItem=null,this.isSubWindow=!1,this.eventHub=new o.utils.EventHub(this),this.config=this._createConfig(e),this.container=t,this.dropTargetIndicator=null,this.transitionIndicator=null,this.tabDropPlaceholder=s()('<div class="lm_drop_tab_placeholder"></div>'),!0===this.isSubWindow&&s()("body").css("visibility","hidden"),this._typeToItem={column:o.utils.fnBind(o.items.RowOrColumn,this,[!0]),row:o.utils.fnBind(o.items.RowOrColumn,this,[!1]),stack:o.items.Stack,component:o.items.Component}},o.LayoutManager.__lm=o,o.LayoutManager.minifyConfig=function(e){return(new o.utils.ConfigMinifier).minifyConfig(e)},o.LayoutManager.unminifyConfig=function(e){return(new o.utils.ConfigMinifier).unminifyConfig(e)},o.utils.copy(o.LayoutManager.prototype,{registerComponent:function(e,t){if("function"!=typeof t)throw new Error("Please register a constructor function");if(void 0!==this._components[e])throw new Error("Component "+e+" is already registered");this._components[e]=t},toConfig:function(e){var t,i,n;if(!1===this.isInitialised)throw new Error("Can't create config, layout not yet initialised");if(e&&!(e instanceof o.items.AbstractContentItem))throw new Error("Root must be a ContentItem");for((t={settings:o.utils.copy({},this.config.settings),dimensions:o.utils.copy({},this.config.dimensions),labels:o.utils.copy({},this.config.labels)}).content=[],i=function(e,t){var n,s;for(n in t.config)"content"!==n&&(e[n]=t.config[n]);if(t.contentItems.length)for(e.content=[],s=0;s<t.contentItems.length;s++)e.content[s]={},i(e.content[s],t.contentItems[s])},i(t,e?{contentItems:[e]}:this.root),this._$reconcilePopoutWindows(),t.openPopouts=[],n=0;n<this.openPopouts.length;n++)t.openPopouts.push(this.openPopouts[n].toConfig());return t.maximisedItemId=this._maximisedItem?"__glMaximised":null,t},getComponent:function(e){if(void 0===this._components[e])throw new o.errors.ConfigurationError('Unknown component "'+e+'"');return this._components[e]},init:function(){if(!1===this._subWindowsCreated&&(this._createSubWindows(),this._subWindowsCreated=!0),"loading"!==document.readyState&&null!==document.body){if(!0===this.isSubWindow&&!1===this._creationTimeoutPassed)return setTimeout(o.utils.fnBind(this.init,this),7),void(this._creationTimeoutPassed=!0);!0===this.isSubWindow&&this._adjustToWindowMode(),this._setContainer(),this.dropTargetIndicator=new o.controls.DropTargetIndicator(this.container),this.transitionIndicator=new o.controls.TransitionIndicator,this.updateSize(),this._create(this.config),this._bindEvents(),this.isInitialised=!0,this._adjustColumnsResponsive(),this.emit("initialised")}else s()(document).ready(o.utils.fnBind(this.init,this))},updateSize:function(e,t){2===arguments.length?(this.width=e,this.height=t):(this.width=this.container.width(),this.height=this.container.height()),!0===this.isInitialised&&(this.root.callDownwards("setSize",[this.width,this.height]),this._maximisedItem&&(this._maximisedItem.element.width(this.container.width()),this._maximisedItem.element.height(this.container.height()),this._maximisedItem.callDownwards("setSize")),this._adjustColumnsResponsive())},destroy:function(){!1!==this.isInitialised&&(this._onUnload(),s()(window).off("resize",this._resizeFunction),s()(window).off("unload beforeunload",this._unloadFunction),this.root.callDownwards("_$destroy",[],!0),this.root.contentItems=[],this.tabDropPlaceholder.remove(),this.dropTargetIndicator.destroy(),this.transitionIndicator.destroy(),this.eventHub.destroy(),this._dragSources.forEach((function(e){e._dragListener.destroy(),e._element=null,e._itemConfig=null,e._dragListener=null})),this._dragSources=[])},createContentItem:function(e,t){var i;if("string"!=typeof e.type)throw new o.errors.ConfigurationError("Missing parameter 'type'",e);if("react-component"===e.type&&(e.type="component",e.componentName="lm-react-component"),!this._typeToItem[e.type])throw i="Unknown type '"+e.type+"'. Valid types are "+o.utils.objectKeys(this._typeToItem).join(","),new o.errors.ConfigurationError(i);return"component"!==e.type||t instanceof o.items.Stack||!t||!0===this.isSubWindow&&t instanceof o.items.Root||(e={type:"stack",width:e.width,height:e.height,content:[e]}),new this._typeToItem[e.type](this,e,t)},createPopout:function(e,t,i,n){var s,r,a,l,c,h,d=e,u=e instanceof o.items.AbstractContentItem,p=this;if(i=i||null,u){for(d=this.toConfig(e).content,i=o.utils.getUniqueId(),l=e.parent,c=e;1===l.contentItems.length&&!l.isRoot;)l=l.parent,c=c.parent;l.addId(i),isNaN(n)&&(n=o.utils.indexOf(c,l.contentItems))}else d instanceof Array||(d=[d]);return!t&&u&&(s=window.screenX||window.screenLeft,r=window.screenY||window.screenTop,t={left:s+(a=e.element.offset()).left,top:r+a.top,width:e.element.width(),height:e.element.height()}),t||u||(t={left:window.screenX||window.screenLeft+20,top:window.screenY||window.screenTop+20,width:500,height:309}),u&&e.remove(),(h=new o.controls.BrowserPopout(d,t,i,n,this)).on("initialised",(function(){p.emit("windowOpened",h)})),h.on("closed",(function(){p._$reconcilePopoutWindows()})),this.openPopouts.push(h),h},createDragSource:function(e,t){this.config.settings.constrainDragToContainer=!1;var i=new o.controls.DragSource(s()(e),t,this);return this._dragSources.push(i),i},selectItem:function(e,t){if(!0!==this.config.settings.selectionEnabled)throw new Error("Please set selectionEnabled to true to use this feature");e!==this.selectedItem&&(null!==this.selectedItem&&this.selectedItem.deselect(),e&&!0!==t&&e.select(),this.selectedItem=e,this.emit("selectionChanged",e))},_$maximiseItem:function(e){null!==this._maximisedItem&&this._$minimiseItem(this._maximisedItem),this._maximisedItem=e,this._maximisedItem.addId("__glMaximised"),e.element.addClass("lm_maximised"),e.element.after(this._maximisePlaceholder),this.root.element.prepend(e.element),e.element.width(this.container.width()),e.element.height(this.container.height()),e.callDownwards("setSize"),this._maximisedItem.emit("maximised"),this.emit("stateChanged")},_$minimiseItem:function(e){e.element.removeClass("lm_maximised"),e.removeId("__glMaximised"),this._maximisePlaceholder.after(e.element),this._maximisePlaceholder.remove(),e.parent.callDownwards("setSize"),this._maximisedItem=null,e.emit("minimised"),this.emit("stateChanged")},_$closeWindow:function(){window.setTimeout((function(){window.close()}),1)},_$getArea:function(e,t){var i,n,s=1/0,r=null;for(i=0;i<this._itemAreas.length;i++)e>(n=this._itemAreas[i]).x1&&e<n.x2&&t>n.y1&&t<n.y2&&s>n.surface&&(s=n.surface,r=n);return r},_$createRootItemAreas:function(){var e={y2:0,x2:0,y1:"y2",x1:"x2"};for(var t in e){var i=this.root._$getArea();i.side=t,i[t]=e[t]?i[e[t]]-50:50,i.surface=(i.x2-i.x1)*(i.y2-i.y1),this._itemAreas.push(i)}},_$calculateItemAreas:function(){var e,t,i=this._getAllContentItems();if(this._itemAreas=[],1!==i.length){for(this._$createRootItemAreas(),e=0;e<i.length;e++)if(i[e].isStack&&null!==(t=i[e]._$getArea()))if(t instanceof Array)this._itemAreas=this._itemAreas.concat(t);else{this._itemAreas.push(t);var n={};o.utils.copy(n,t),o.utils.copy(n,t.contentItem._contentAreaDimensions.header.highlightArea),n.surface=(n.x2-n.x1)*(n.y2-n.y1),this._itemAreas.push(n)}}else this._itemAreas.push(this.root._$getArea())},_$normalizeContentItem:function(e,t){if(!e)throw new Error("No content item defined");if(o.utils.isFunction(e)&&(e=e()),e instanceof o.items.AbstractContentItem)return e;if(s().isPlainObject(e)&&e.type){var i=this.createContentItem(e,t);return i.callDownwards("_$init"),i}throw new Error("Invalid contentItem")},_$reconcilePopoutWindows:function(){var e,t=[];for(e=0;e<this.openPopouts.length;e++)!1===this.openPopouts[e].getWindow().closed?t.push(this.openPopouts[e]):this.emit("windowClosed",this.openPopouts[e]);this.openPopouts.length!==t.length&&(this.emit("stateChanged"),this.openPopouts=t)},_getAllContentItems:function(){var e=[],t=function(i){if(e.push(i),i.contentItems instanceof Array)for(var n=0;n<i.contentItems.length;n++)t(i.contentItems[n])};return t(this.root),e},_bindEvents:function(){this._isFullPage&&s()(window).resize(this._resizeFunction),s()(window).on("unload beforeunload",this._unloadFunction)},_onResize:function(){clearTimeout(this._resizeTimeoutId),this._resizeTimeoutId=setTimeout(o.utils.fnBind(this.updateSize,this),100)},_createConfig:function(e){var t=o.utils.getQueryStringParam("gl-window");t&&(this.isSubWindow=!0,e=localStorage.getItem(t),e=JSON.parse(e),e=(new o.utils.ConfigMinifier).unminifyConfig(e),localStorage.removeItem(t)),e=s().extend(!0,{},o.config.defaultConfig,e);var i=function(e){for(var t in e)"props"!==t&&"object"===r(e[t])?i(e[t]):"type"===t&&"react-component"===e[t]&&(e.type="component",e.componentName="lm-react-component")};return i(e),!1===e.settings.hasHeaders&&(e.dimensions.headerHeight=0),e},_adjustToWindowMode:function(){var e=s()('<div class="lm_popin" title="'+this.config.labels.popin+'"><div class="lm_icon"></div><div class="lm_bg"></div></div>');e.click(o.utils.fnBind((function(){this.emit("popIn")}),this)),document.title=o.utils.stripTags(this.config.content[0].title),s()("head").append(s()("body link, body style, template, .gl_keep")),this.container=s()("body").html("").css("visibility","visible").append(e),document.body.offsetHeight,window.__glInstance=this},_createSubWindows:function(){var e,t;for(e=0;e<this.config.openPopouts.length;e++)t=this.config.openPopouts[e],this.createPopout(t.content,t.dimensions,t.parentId,t.indexInParent)},_setContainer:function(){var e=s()(this.container||"body");if(0===e.length)throw new Error("GoldenLayout container not found");if(e.length>1)throw new Error("GoldenLayout more than one container element specified");e[0]===document.body&&(this._isFullPage=!0,s()("html, body").css({height:"100%",margin:0,padding:0,overflow:"hidden"})),this.container=e},_create:function(e){var t;if(!(e.content instanceof Array))throw t=void 0===e.content?"Missing setting 'content' on top level of configuration":"Configuration parameter 'content' must be an array",new o.errors.ConfigurationError(t,e);if(e.content.length>1)throw t="Top level content can't contain more then one element.",new o.errors.ConfigurationError(t,e);this.root=new o.items.Root(this,{content:e.content},this.container),this.root.callDownwards("_$init"),"__glMaximised"===e.maximisedItemId&&this.root.getItemsById(e.maximisedItemId)[0].toggleMaximise()},_onUnload:function(){if(!0===this.config.settings.closePopoutsOnUnload)for(var e=0;e<this.openPopouts.length;e++)this.openPopouts[e].close()},_adjustColumnsResponsive:function(){if(this._useResponsiveLayout()&&!this._updatingColumnsResponsive&&this.config.dimensions&&this.config.dimensions.minItemWidth&&0!==this.root.contentItems.length&&this.root.contentItems[0].isRow){this._firstLoad=!1;var e=this.root.contentItems[0].contentItems.length;if(!(e<=1)){var t=this.config.dimensions.minItemWidth;if(!(e*t<=this.width)){this._updatingColumnsResponsive=!0;for(var i=e-Math.max(Math.floor(this.width/t),1),n=this.root.contentItems[0],s=this._findAllStackContainers()[0],r=0;r<i;r++){var o=n.contentItems[n.contentItems.length-1];n.removeChild(o),this._addChildContentItemsToContainer(s,o)}this._updatingColumnsResponsive=!1}}}else this._firstLoad=!1},_useResponsiveLayout:function(){return this.config.settings&&("always"==this.config.settings.responsiveMode||"onload"==this.config.settings.responsiveMode&&this._firstLoad)},_addChildContentItemsToContainer:function(e,t){"stack"===t.type?t.contentItems.forEach((function(t){e.addChild(t)})):t.contentItems.forEach(o.utils.fnBind((function(t){this._addChildContentItemsToContainer(e,t)}),this))},_findAllStackContainers:function(){var e=[];return this._findAllStackContainersRecursive(e,this.root),e},_findAllStackContainersRecursive:function(e,t){t.contentItems.forEach(o.utils.fnBind((function(t){"stack"==t.type?e.push(t):t.isComponent||this._findAllStackContainersRecursive(e,t)}),this))}}),o.config.itemDefaultConfig={isClosable:!0,reorderEnabled:!0,title:""},o.config.defaultConfig={openPopouts:[],settings:{hasHeaders:!0,constrainDragToContainer:!0,reorderEnabled:!0,selectionEnabled:!1,popoutWholeStack:!1,blockedPopoutsThrowError:!0,closePopoutsOnUnload:!0,showPopoutIcon:!0,showMaximiseIcon:!0,showCloseIcon:!0,responsiveMode:"onload"},dimensions:{borderWidth:5,minItemHeight:10,minItemWidth:10,headerHeight:20,dragProxyWidth:300,dragProxyHeight:200},labels:{close:"close",maximise:"maximise",minimise:"minimise",popout:"open in new window",popin:"pop in",tabDropdown:"additional tabs"}},o.container.ItemContainer=function(e,t,i){o.utils.EventEmitter.call(this),this.width=null,this.height=null,this.title=e.componentName,this.parent=t,this.layoutManager=i,this.isHidden=!1,this._config=e,this._element=s()(['<div class="lm_item_container">','<div class="lm_content"></div>',"</div>"].join("")),this._contentElement=this._element.find(".lm_content")},o.utils.copy(o.container.ItemContainer.prototype,{getElement:function(){return this._contentElement},hide:function(){this.emit("hide"),this.isHidden=!0,this._element.hide()},show:function(){this.emit("show"),this.isHidden=!1,this._element.show(),0==this.height&&0==this.width||this.emit("shown")},setSize:function(e,t){for(var i,n,s,r,o=this.parent,a=this;!o.isColumn&&!o.isRow;)if(a=o,(o=o.parent).isRoot)return!1;for(i=("height"==(n=o.isColumn?"height":"width")?t:e)/(this[n]*(1/(a.config[n]/100)))*100,s=(a.config[n]-i)/(o.contentItems.length-1),r=0;r<o.contentItems.length;r++)o.contentItems[r]===a?o.contentItems[r].config[n]=i:o.contentItems[r].config[n]+=s;return o.callDownwards("setSize"),!0},close:function(){this._config.isClosable&&(this.emit("close"),this.parent.close())},getState:function(){return this._config.componentState},extendState:function(e){this.setState(s().extend(!0,this.getState(),e))},setState:function(e){this._config.componentState=e,this.parent.emitBubblingEvent("stateChanged")},setTitle:function(e){this.parent.setTitle(e)},_$setSize:function(e,t){e===this.width&&t===this.height||(this.width=e,this.height=t,this._contentElement.width(this.width).height(this.height),this.emit("resize"))}}),o.controls.BrowserPopout=function(e,t,i,n,s){o.utils.EventEmitter.call(this),this.isInitialised=!1,this._config=e,this._dimensions=t,this._parentId=i,this._indexInParent=n,this._layoutManager=s,this._popoutWindow=null,this._id=null,this._createWindow()},o.utils.copy(o.controls.BrowserPopout.prototype,{toConfig:function(){if(!1===this.isInitialised)throw new Error("Can't create config, layout not yet initialised");return{dimensions:{width:this.getGlInstance().width,height:this.getGlInstance().height,left:this._popoutWindow.screenX||this._popoutWindow.screenLeft,top:this._popoutWindow.screenY||this._popoutWindow.screenTop},content:this.getGlInstance().toConfig().content,parentId:this._parentId,indexInParent:this._indexInParent}},getGlInstance:function(){return this._popoutWindow.__glInstance},getWindow:function(){return this._popoutWindow},close:function(){if(this.getGlInstance())this.getGlInstance()._$closeWindow();else try{this.getWindow().close()}catch(e){}},popIn:function(){var e,t;this._indexInParent,this._parentId&&(e=s().extend(!0,{},this.getGlInstance().toConfig()).content[0],(t=this._layoutManager.root.getItemsById(this._parentId)[0])||(t=this._layoutManager.root.contentItems.length>0?this._layoutManager.root.contentItems[0]:this._layoutManager.root)),t.addChild(e,this._indexInParent),this.close()},_createWindow:function(){var e,t=this._createUrl(),i=Math.floor(1e6*Math.random()).toString(36),n=this._serializeWindowOptions({width:this._dimensions.width,height:this._dimensions.height,innerWidth:this._dimensions.width,innerHeight:this._dimensions.height,menubar:"no",toolbar:"no",location:"no",personalbar:"no",resizable:"yes",scrollbars:"no",status:"no"});if(this._popoutWindow=window.open(t,i,n),this._popoutWindow)s()(this._popoutWindow).on("load",o.utils.fnBind(this._positionWindow,this)).on("unload beforeunload",o.utils.fnBind(this._onClose,this)),e=setInterval(o.utils.fnBind((function(){this._popoutWindow.__glInstance&&this._popoutWindow.__glInstance.isInitialised&&(this._onInitialised(),clearInterval(e))}),this),10);else if(!0===this._layoutManager.config.settings.blockedPopoutsThrowError){var r=new Error("Popout blocked");throw r.type="popoutBlocked",r}},_serializeWindowOptions:function(e){var t,i=[];for(t in e)i.push(t+"="+e[t]);return i.join(",")},_createUrl:function(){var e,t={content:this._config},i="gl-window-config-"+o.utils.getUniqueId();t=(new o.utils.ConfigMinifier).minifyConfig(t);try{localStorage.setItem(i,JSON.stringify(t))}catch(e){throw new Error("Error while writing to localStorage "+e.toString())}return 1===(e=document.location.href.split("?")).length?e[0]+"?gl-window="+i:document.location.href+"&gl-window="+i},_positionWindow:function(){this._popoutWindow.moveTo(this._dimensions.left,this._dimensions.top),this._popoutWindow.focus()},_onInitialised:function(){this.isInitialised=!0,this.getGlInstance().on("popIn",this.popIn,this),this.emit("initialised")},_onClose:function(){setTimeout(o.utils.fnBind(this.emit,this,["closed"]),50)}}),o.controls.DragProxy=function(e,t,i,n,r,a){o.utils.EventEmitter.call(this),this._dragListener=i,this._layoutManager=n,this._contentItem=r,this._originalParent=a,this._area=null,this._lastValidArea=null,this._dragListener.on("drag",this._onDrag,this),this._dragListener.on("dragStop",this._onDrop,this),this.element=s()(o.controls.DragProxy._template),a&&a._side&&(this._sided=a._sided,this.element.addClass("lm_"+a._side),["right","bottom"].indexOf(a._side)>=0&&this.element.find(".lm_content").after(this.element.find(".lm_header"))),this.element.css({left:e,top:t}),this.element.find(".lm_tab").attr("title",o.utils.stripTags(this._contentItem.config.title)),this.element.find(".lm_title").html(this._contentItem.config.title),this.childElementContainer=this.element.find(".lm_content"),this.childElementContainer.append(r.element),this._updateTree(),this._layoutManager._$calculateItemAreas(),this._setDimensions(),s()(document.body).append(this.element);var l=this._layoutManager.container.offset();this._minX=l.left,this._minY=l.top,this._maxX=this._layoutManager.container.width()+this._minX,this._maxY=this._layoutManager.container.height()+this._minY,this._width=this.element.width(),this._height=this.element.height(),this._setDropPosition(e,t)},o.controls.DragProxy._template='<div class="lm_dragProxy"><div class="lm_header"><ul class="lm_tabs"><li class="lm_tab lm_active"><i class="lm_left"></i><span class="lm_title"></span><i class="lm_right"></i></li></ul></div><div class="lm_content"></div></div>',o.utils.copy(o.controls.DragProxy.prototype,{_onDrag:function(e,t,i){var n=(i=i.originalEvent&&i.originalEvent.touches?i.originalEvent.touches[0]:i).pageX,s=i.pageY;(n>this._minX&&n<this._maxX&&s>this._minY&&s<this._maxY||!0!==this._layoutManager.config.settings.constrainDragToContainer)&&this._setDropPosition(n,s)},_setDropPosition:function(e,t){this.element.css({left:e,top:t}),this._area=this._layoutManager._$getArea(e,t),null!==this._area&&(this._lastValidArea=this._area,this._area.contentItem._$highlightDropZone(e,t,this._area))},_onDrop:function(){this._layoutManager.dropTargetIndicator.hide(),null!==this._area?this._area.contentItem._$onDrop(this._contentItem,this._area):null!==this._lastValidArea?this._lastValidArea.contentItem._$onDrop(this._contentItem,this._lastValidArea):this._originalParent?this._originalParent.addChild(this._contentItem):this._contentItem._$destroy(),this.element.remove(),this._layoutManager.emit("itemDropped",this._contentItem)},_updateTree:function(){this._contentItem.parent&&this._contentItem.parent.removeChild(this._contentItem,!0),this._contentItem._$setParent(this)},_setDimensions:function(){var e=this._layoutManager.config.dimensions,t=e.dragProxyWidth,i=e.dragProxyHeight;this.element.width(t),this.element.height(i),t-=this._sided?e.headerHeight:0,i-=this._sided?0:e.headerHeight,this.childElementContainer.width(t),this.childElementContainer.height(i),this._contentItem.element.width(t),this._contentItem.element.height(i),this._contentItem.callDownwards("_$show"),this._contentItem.callDownwards("setSize")}}),o.controls.DragSource=function(e,t,i){this._element=e,this._itemConfig=t,this._layoutManager=i,this._dragListener=null,this._createDragListener()},o.utils.copy(o.controls.DragSource.prototype,{_createDragListener:function(){null!==this._dragListener&&this._dragListener.destroy(),this._dragListener=new o.utils.DragListener(this._element),this._dragListener.on("dragStart",this._onDragStart,this),this._dragListener.on("dragStop",this._createDragListener,this)},_onDragStart:function(e,t){var i=this._itemConfig;o.utils.isFunction(i)&&(i=i());var n=this._layoutManager._$normalizeContentItem(s().extend(!0,{},i)),r=new o.controls.DragProxy(e,t,this._dragListener,this._layoutManager,n,null);this._layoutManager.transitionIndicator.transitionElements(this._element,r.element)}}),o.controls.DropTargetIndicator=function(){this.element=s()(o.controls.DropTargetIndicator._template),s()(document.body).append(this.element)},o.controls.DropTargetIndicator._template='<div class="lm_dropTargetIndicator"><div class="lm_inner"></div></div>',o.utils.copy(o.controls.DropTargetIndicator.prototype,{destroy:function(){this.element.remove()},highlight:function(e,t,i,n){this.highlightArea({x1:e,y1:t,x2:i,y2:n})},highlightArea:function(e){this.element.css({left:e.x1,top:e.y1,width:e.x2-e.x1,height:e.y2-e.y1}).show()},hide:function(){this.element.hide()}}),o.controls.Header=function(e,t){o.utils.EventEmitter.call(this),this.layoutManager=e,this.element=s()(o.controls.Header._template),!0===this.layoutManager.config.settings.selectionEnabled&&(this.element.addClass("lm_selectable"),this.element.on("click touchstart",o.utils.fnBind(this._onHeaderClick,this))),this.tabsContainer=this.element.find(".lm_tabs"),this.tabDropdownContainer=this.element.find(".lm_tabdropdown_list"),this.tabDropdownContainer.hide(),this.controlsContainer=this.element.find(".lm_controls"),this.parent=t,this.parent.on("resize",this._updateTabSizes,this),this.tabs=[],this.activeContentItem=null,this.closeButton=null,this.tabDropdownButton=null,s()(document).mouseup(o.utils.fnBind(this._hideAdditionalTabsDropdown,this)),this._lastVisibleTabIndex=-1,this._tabControlOffset=10,this._createControls()},o.controls.Header._template=['<div class="lm_header">','<ul class="lm_tabs"></ul>','<ul class="lm_controls"></ul>','<ul class="lm_tabdropdown_list"></ul>',"</div>"].join(""),o.utils.copy(o.controls.Header.prototype,{createTab:function(e,t){var i,n;for(n=0;n<this.tabs.length;n++)if(this.tabs[n].contentItem===e)return;if(i=new o.controls.Tab(this,e),0===this.tabs.length)return this.tabs.push(i),void this.tabsContainer.append(i.element);void 0===t&&(t=this.tabs.length),t>0?this.tabs[t-1].element.after(i.element):this.tabs[0].element.before(i.element),this.tabs.splice(t,0,i),this._updateTabSizes()},removeTab:function(e){for(var t=0;t<this.tabs.length;t++)if(this.tabs[t].contentItem===e)return this.tabs[t]._$destroy(),void this.tabs.splice(t,1);throw new Error("contentItem is not controlled by this header")},setActiveContentItem:function(e){var t,i,n,s;for(t=0;t<this.tabs.length;t++)n=this.tabs[t].contentItem===e,this.tabs[t].setActive(n),!0===n&&(this.activeContentItem=e,this.parent.config.activeItemIndex=t);if(-1!==this._lastVisibleTabIndex&&this.parent.config.activeItemIndex>this._lastVisibleTabIndex){for(s=this.tabs[this.parent.config.activeItemIndex],i=this.parent.config.activeItemIndex;i>0;i--)this.tabs[i]=this.tabs[i-1];this.tabs[0]=s,this.parent.config.activeItemIndex=0}this._updateTabSizes(),this.parent.emitBubblingEvent("stateChanged")},position:function(e){var t=this.parent._header.show;return t&&!this.parent._side&&(t="top"),void 0!==e&&this.parent._header.show!=e&&(this.parent._header.show=e,this.parent._setupHeaderPosition()),t},_$setClosable:function(e){return!(!this.closeButton||!this._isClosable()||(this.closeButton.element[e?"show":"hide"](),0))},_$destroy:function(){this.emit("destroy",this);for(var e=0;e<this.tabs.length;e++)this.tabs[e]._$destroy();this.element.remove()},_getHeaderSetting:function(e){if(e in this.parent._header)return this.parent._header[e]},_createControls:function(){var e,t,i,n,s,r,a,l,c;c=o.utils.fnBind(this._showAdditionalTabsDropdown,this),l=this.layoutManager.config.labels.tabDropdown,this.tabDropdownButton=new o.controls.HeaderButton(this,l,"lm_tabdropdown",c),this.tabDropdownButton.element.hide(),this._getHeaderSetting("popout")&&(t=o.utils.fnBind(this._onPopoutClick,this),i=this._getHeaderSetting("popout"),new o.controls.HeaderButton(this,i,"lm_popout",t)),this._getHeaderSetting("maximise")&&(r=o.utils.fnBind(this.parent.toggleMaximise,this.parent),n=this._getHeaderSetting("maximise"),s=this._getHeaderSetting("minimise"),a=new o.controls.HeaderButton(this,n,"lm_maximise",r),this.parent.on("maximised",(function(){a.element.attr("title",s)})),this.parent.on("minimised",(function(){a.element.attr("title",n)}))),this._isClosable()&&(e=o.utils.fnBind(this.parent.remove,this.parent),i=this._getHeaderSetting("close"),this.closeButton=new o.controls.HeaderButton(this,i,"lm_close",e))},_showAdditionalTabsDropdown:function(){this.tabDropdownContainer.show()},_hideAdditionalTabsDropdown:function(e){this.tabDropdownContainer.hide()},_isClosable:function(){return this.parent.config.isClosable&&this.layoutManager.config.settings.showCloseIcon},_onPopoutClick:function(){!0===this.layoutManager.config.settings.popoutWholeStack?this.parent.popout():this.activeContentItem.popout()},_onHeaderClick:function(e){e.target===this.element[0]&&this.parent.select()},_updateTabSizes:function(){if(0!==this.tabs.length){var e=function(e){return e?"width":"height"};this.element.css(e(!this.parent._sided),""),this.element[e(this.parent._sided)](this.layoutManager.config.dimensions.headerHeight);var t,i,n,s,r=this.element.outerWidth()-this.controlsContainer.outerWidth()-this._tabControlOffset,o=0,a=!1;for(this.parent._sided&&(r=this.element.outerHeight()-this.controlsContainer.outerHeight()-this._tabControlOffset),this._lastVisibleTabIndex=-1,i=0;i<this.tabs.length;i++)(s=(t=this.tabs[i].element).data("lastTabWidth"))||(s=t.outerWidth()+parseInt(t.css("margin-right"),10)),(o+=s)>r&&a?(t.data("lastTabWidth",s),this.tabDropdownContainer.append(t)):(a=!0,this._lastVisibleTabIndex=i,t.removeData("lastTabWidth"),this.tabsContainer.append(t));n=o>r,this.tabDropdownButton.element[n?"show":"hide"]()}}}),o.controls.HeaderButton=function(e,t,i,n){this._header=e,this.element=s()('<li class="'+i+'" title="'+t+'"></li>'),this._header.on("destroy",this._$destroy,this),this._action=n,this.element.on("click touchstart",this._action),this._header.controlsContainer.append(this.element)},o.utils.copy(o.controls.HeaderButton.prototype,{_$destroy:function(){this.element.off(),this.element.remove()}}),o.controls.Splitter=function(e,t){this._isVertical=e,this._size=t,this.element=this._createElement(),this._dragListener=new o.utils.DragListener(this.element)},o.utils.copy(o.controls.Splitter.prototype,{on:function(e,t,i){this._dragListener.on(e,t,i)},_$destroy:function(){this.element.remove()},_createElement:function(){var e=s()('<div class="lm_splitter"><div class="lm_drag_handle"></div></div>');return e.addClass("lm_"+(this._isVertical?"vertical":"horizontal")),e[this._isVertical?"height":"width"](this._size),e}}),o.controls.Tab=function(e,t){this.header=e,this.contentItem=t,this.element=s()(o.controls.Tab._template),this.titleElement=this.element.find(".lm_title"),this.closeElement=this.element.find(".lm_close_tab"),this.closeElement[t.config.isClosable?"show":"hide"](),this.isActive=!1,this.setTitle(t.config.title),this.contentItem.on("titleChanged",this.setTitle,this),this._layoutManager=this.contentItem.layoutManager,!0===this._layoutManager.config.settings.reorderEnabled&&!0===t.config.reorderEnabled&&(this._dragListener=new o.utils.DragListener(this.element),this._dragListener.on("dragStart",this._onDragStart,this)),this._onTabClickFn=o.utils.fnBind(this._onTabClick,this),this._onCloseClickFn=o.utils.fnBind(this._onCloseClick,this),this.element.on("mousedown touchstart",this._onTabClickFn),this.contentItem.config.isClosable?this.closeElement.on("click touchstart",this._onCloseClickFn):this.closeElement.remove(),this.contentItem.tab=this,this.contentItem.emit("tab",this),this.contentItem.layoutManager.emit("tabCreated",this),this.contentItem.isComponent&&(this.contentItem.container.tab=this,this.contentItem.container.emit("tab",this))},o.controls.Tab._template='<li class="lm_tab"><i class="lm_left"></i><span class="lm_title"></span><div class="lm_close_tab"></div><i class="lm_right"></i></li>',o.utils.copy(o.controls.Tab.prototype,{setTitle:function(e){this.element.attr("title",o.utils.stripTags(e)),this.titleElement.html(e)},setActive:function(e){e!==this.isActive&&(this.isActive=e,e?this.element.addClass("lm_active"):this.element.removeClass("lm_active"))},_$destroy:function(){this.element.off("mousedown touchstart",this._onTabClickFn),this.closeElement.off("click touchstart",this._onCloseClickFn),this._dragListener&&(this._dragListener.off("dragStart",this._onDragStart),this._dragListener=null),this.element.remove()},_onDragStart:function(e,t){!0===this.contentItem.parent.isMaximised&&this.contentItem.parent.toggleMaximise(),new o.controls.DragProxy(e,t,this._dragListener,this._layoutManager,this.contentItem,this.header.parent)},_onTabClick:function(e){if(0===e.button||"touchstart"===e.type){var t=this.header.parent.getActiveContentItem();this.contentItem!==t&&this.header.parent.setActiveContentItem(this.contentItem)}else 1===e.button&&this.contentItem.config.isClosable&&this._onCloseClick(e)},_onCloseClick:function(e){e.stopPropagation(),this.header.parent.removeChild(this.contentItem)}}),o.controls.TransitionIndicator=function(){this._element=s()('<div class="lm_transition_indicator"></div>'),s()(document.body).append(this._element),this._toElement=null,this._fromDimensions=null,this._totalAnimationDuration=200,this._animationStartTime=null},o.utils.copy(o.controls.TransitionIndicator.prototype,{destroy:function(){this._element.remove()},transitionElements:function(e,t){},_nextAnimationFrame:function(){var e,t=this._measure(this._toElement),i=(o.utils.now()-this._animationStartTime)/this._totalAnimationDuration,n={};if(i>=1)this._element.hide();else{for(e in t.opacity=0,this._fromDimensions)n[e]=this._fromDimensions[e]+(t[e]-this._fromDimensions[e])*i;this._element.css(n),o.utils.animFrame(o.utils.fnBind(this._nextAnimationFrame,this))}},_measure:function(e){var t=e.offset();return{left:t.left,top:t.top,width:e.outerWidth(),height:e.outerHeight()}}}),o.errors.ConfigurationError=function(e,t){Error.call(this),this.name="Configuration Error",this.message=e,this.node=t},o.errors.ConfigurationError.prototype=new Error,o.items.AbstractContentItem=function(e,t,i){o.utils.EventEmitter.call(this),this.config=this._extendItemNode(t),this.type=t.type,this.contentItems=[],this.parent=i,this.isInitialised=!1,this.isMaximised=!1,this.isRoot=!1,this.isRow=!1,this.isColumn=!1,this.isStack=!1,this.isComponent=!1,this.layoutManager=e,this._pendingEventPropagations={},this._throttledEvents=["stateChanged"],this.on(o.utils.EventEmitter.ALL_EVENT,this._propagateEvent,this),t.content&&this._createContentItems(t)},o.utils.copy(o.items.AbstractContentItem.prototype,{setSize:function(){throw new Error("Abstract Method")},callDownwards:function(e,t,i,n){var s;for(!0!==i&&!0!==n&&this[e].apply(this,t||[]),s=0;s<this.contentItems.length;s++)this.contentItems[s].callDownwards(e,t,i);!0===i&&!0!==n&&this[e].apply(this,t||[])},removeChild:function(e,t){var i=o.utils.indexOf(e,this.contentItems);if(-1===i)throw new Error("Can't remove child item. Unknown content item");!0!==t&&this.contentItems[i]._$destroy(),this.contentItems.splice(i,1),this.config.content.splice(i,1),this.contentItems.length>0?this.callDownwards("setSize"):this instanceof o.items.Root||!0!==this.config.isClosable||this.parent.removeChild(this)},addChild:function(e,t){void 0===t&&(t=this.contentItems.length),this.contentItems.splice(t,0,e),void 0===this.config.content&&(this.config.content=[]),this.config.content.splice(t,0,e.config),e.parent=this,!0===e.parent.isInitialised&&!1===e.isInitialised&&e._$init()},replaceChild:function(e,t,i){t=this.layoutManager._$normalizeContentItem(t);var n=o.utils.indexOf(e,this.contentItems),s=e.element[0].parentNode;if(-1===n)throw new Error("Can't replace child. oldChild is not child of this");s.replaceChild(t.element[0],e.element[0]),!0===i&&(e.parent=null,e._$destroy()),this.contentItems[n]=t,t.parent=this,this.isStack&&(this.header.tabs[n].contentItem=t),!0===t.parent.isInitialised&&!1===t.isInitialised&&t._$init(),this.callDownwards("setSize")},remove:function(){this.parent.removeChild(this)},popout:function(){var e=this.layoutManager.createPopout(this);return this.emitBubblingEvent("stateChanged"),e},toggleMaximise:function(e){e&&e.preventDefault(),!0===this.isMaximised?this.layoutManager._$minimiseItem(this):this.layoutManager._$maximiseItem(this),this.isMaximised=!this.isMaximised,this.emitBubblingEvent("stateChanged")},select:function(){this.layoutManager.selectedItem!==this&&(this.layoutManager.selectItem(this,!0),this.element.addClass("lm_selected"))},deselect:function(){this.layoutManager.selectedItem===this&&(this.layoutManager.selectedItem=null,this.element.removeClass("lm_selected"))},setTitle:function(e){this.config.title=e,this.emit("titleChanged",e),this.emit("stateChanged")},hasId:function(e){return!!this.config.id&&("string"==typeof this.config.id?this.config.id===e:this.config.id instanceof Array?-1!==o.utils.indexOf(e,this.config.id):void 0)},addId:function(e){this.hasId(e)||(this.config.id?"string"==typeof this.config.id?this.config.id=[this.config.id,e]:this.config.id instanceof Array&&this.config.id.push(e):this.config.id=e)},removeId:function(e){if(!this.hasId(e))throw new Error("Id not found");if("string"==typeof this.config.id)delete this.config.id;else if(this.config.id instanceof Array){var t=o.utils.indexOf(e,this.config.id);this.config.id.splice(t,1)}},getItemsByFilter:function(e){var t=[],i=function(n){for(var s=0;s<n.contentItems.length;s++)!0===e(n.contentItems[s])&&t.push(n.contentItems[s]),i(n.contentItems[s])};return i(this),t},getItemsById:function(e){return this.getItemsByFilter((function(t){return t.config.id instanceof Array?-1!==o.utils.indexOf(e,t.config.id):t.config.id===e}))},getItemsByType:function(e){return this._$getItemsByProperty("type",e)},getComponentsByName:function(e){var t,i=this._$getItemsByProperty("componentName",e),n=[];for(t=0;t<i.length;t++)n.push(i[t].instance);return n},_$getItemsByProperty:function(e,t){return this.getItemsByFilter((function(i){return i[e]===t}))},_$setParent:function(e){this.parent=e},_$highlightDropZone:function(e,t,i){this.layoutManager.dropTargetIndicator.highlightArea(i)},_$onDrop:function(e){this.addChild(e)},_$hide:function(){this._callOnActiveComponents("hide"),this.element.hide(),this.layoutManager.updateSize()},_$show:function(){this._callOnActiveComponents("show"),this.element.show(),this.layoutManager.updateSize()},_callOnActiveComponents:function(e){var t,i,n=this.getItemsByType("stack");for(i=0;i<n.length;i++)(t=n[i].getActiveContentItem())&&t.isComponent&&t.container[e]()},_$destroy:function(){this.emitBubblingEvent("beforeItemDestroyed"),this.callDownwards("_$destroy",[],!0,!0),this.element.remove(),this.emitBubblingEvent("itemDestroyed")},_$getArea:function(e){var t=(e=e||this.element).offset(),i=e.width(),n=e.height();return{x1:t.left,y1:t.top,x2:t.left+i,y2:t.top+n,surface:i*n,contentItem:this}},_$init:function(){var e;for(this.setSize(),e=0;e<this.contentItems.length;e++)this.childElementContainer.append(this.contentItems[e].element);this.isInitialised=!0,this.emitBubblingEvent("itemCreated"),this.emitBubblingEvent(this.type+"Created")},emitBubblingEvent:function(e){var t=new o.utils.BubblingEvent(e,this);this.emit(e,t)},_createContentItems:function(e){var t,i;if(!(e.content instanceof Array))throw new o.errors.ConfigurationError("content must be an Array",e);for(i=0;i<e.content.length;i++)t=this.layoutManager.createContentItem(e.content[i],this),this.contentItems.push(t)},_extendItemNode:function(e){for(var t in o.config.itemDefaultConfig)void 0===e[t]&&(e[t]=o.config.itemDefaultConfig[t]);return e},_propagateEvent:function(e,t){t instanceof o.utils.BubblingEvent&&!1===t.isPropagationStopped&&!0===this.isInitialised&&(!1===this.isRoot&&this.parent?this.parent.emit.apply(this.parent,Array.prototype.slice.call(arguments,0)):this._scheduleEventPropagationToLayoutManager(e,t))},_scheduleEventPropagationToLayoutManager:function(e,t){-1===o.utils.indexOf(e,this._throttledEvents)?this.layoutManager.emit(e,t.origin):!0!==this._pendingEventPropagations[e]&&(this._pendingEventPropagations[e]=!0,o.utils.animFrame(o.utils.fnBind(this._propagateEventToLayoutManager,this,[e,t])))},_propagateEventToLayoutManager:function(e,t){this._pendingEventPropagations[e]=!1,this.layoutManager.emit(e,t)}}),o.items.Component=function(e,t,i){o.items.AbstractContentItem.call(this,e,t,i);var n=e.getComponent(this.config.componentName),r=s().extend(!0,{},this.config.componentState||{});r.componentName=this.config.componentName,this.componentName=this.config.componentName,""===this.config.title&&(this.config.title=this.config.componentName),this.isComponent=!0,this.container=new o.container.ItemContainer(this.config,this,e),this.instance=new n(this.container,r),this.element=this.container._element},o.utils.extend(o.items.Component,o.items.AbstractContentItem),o.utils.copy(o.items.Component.prototype,{close:function(){this.parent.removeChild(this)},setSize:function(){this.element.is(":visible")&&this.container._$setSize(this.element.width(),this.element.height())},_$init:function(){o.items.AbstractContentItem.prototype._$init.call(this),this.container.emit("open")},_$hide:function(){this.container.hide(),o.items.AbstractContentItem.prototype._$hide.call(this)},_$show:function(){this.container.show(),o.items.AbstractContentItem.prototype._$show.call(this)},_$shown:function(){this.container.shown(),o.items.AbstractContentItem.prototype._$shown.call(this)},_$destroy:function(){this.container.emit("destroy",this),o.items.AbstractContentItem.prototype._$destroy.call(this)},_$getArea:function(){return null}}),o.items.Root=function(e,t,i){o.items.AbstractContentItem.call(this,e,t,null),this.isRoot=!0,this.type="root",this.element=s()('<div class="lm_goldenlayout lm_item lm_root"></div>'),this.childElementContainer=this.element,this._containerElement=i,this._containerElement.append(this.element)},o.utils.extend(o.items.Root,o.items.AbstractContentItem),o.utils.copy(o.items.Root.prototype,{addChild:function(e){if(this.contentItems.length>0)throw new Error("Root node can only have a single child");e=this.layoutManager._$normalizeContentItem(e,this),this.childElementContainer.append(e.element),o.items.AbstractContentItem.prototype.addChild.call(this,e),this.callDownwards("setSize"),this.emitBubblingEvent("stateChanged")},setSize:function(e,t){e=void 0===e?this._containerElement.width():e,t=void 0===t?this._containerElement.height():t,this.element.width(e),this.element.height(t),this.contentItems[0]&&(this.contentItems[0].element.width(e),this.contentItems[0].element.height(t))},_$highlightDropZone:function(e,t,i){this.layoutManager.tabDropPlaceholder.remove(),o.items.AbstractContentItem.prototype._$highlightDropZone.apply(this,arguments)},_$onDrop:function(e,t){var i;if(e.isComponent&&((i=this.layoutManager.createContentItem({type:"stack",header:e.config.header||{}},this))._$init(),i.addChild(e),e=i),this.contentItems.length){var n="x"==t.side[0]?"row":"column",s="x"==t.side[0]?"width":"height",r="2"==t.side[1],a=this.contentItems[0];if(!a instanceof o.items.RowOrColumn||a.type!=n){var l=this.layoutManager.createContentItem({type:n},this);this.replaceChild(a,l),l.addChild(e,r?0:void 0,!0),l.addChild(a,r?void 0:0,!0),a.config[s]=50,e.config[s]=50,l.callDownwards("setSize")}else{var c=a.contentItems[r?0:a.contentItems.length-1];a.addChild(e,r?0:void 0,!0),c.config[s]*=.5,e.config[s]=c.config[s],a.callDownwards("setSize")}}else this.addChild(e)}}),o.items.RowOrColumn=function(e,t,i,n){o.items.AbstractContentItem.call(this,t,i,n),this.isRow=!e,this.isColumn=e,this.element=s()('<div class="lm_item lm_'+(e?"column":"row")+'"></div>'),this.childElementContainer=this.element,this._splitterSize=t.config.dimensions.borderWidth,this._isColumn=e,this._dimension=e?"height":"width",this._splitter=[],this._splitterPosition=null,this._splitterMinPosition=null,this._splitterMaxPosition=null},o.utils.extend(o.items.RowOrColumn,o.items.AbstractContentItem),o.utils.copy(o.items.RowOrColumn.prototype,{addChild:function(e,t,i){var n,s,r,a;if(e=this.layoutManager._$normalizeContentItem(e,this),void 0===t&&(t=this.contentItems.length),this.contentItems.length>0?(a=this._createSplitter(Math.max(0,t-1)).element,t>0?(this.contentItems[t-1].element.after(a),a.after(e.element)):(this.contentItems[0].element.before(a),a.before(e.element))):this.childElementContainer.append(e.element),o.items.AbstractContentItem.prototype.addChild.call(this,e,t),n=1/this.contentItems.length*100,!0!==i){for(r=0;r<this.contentItems.length;r++)this.contentItems[r]===e?e.config[this._dimension]=n:(s=this.contentItems[r].config[this._dimension]*=(100-n)/100,this.contentItems[r].config[this._dimension]=s);this.callDownwards("setSize"),this.emitBubblingEvent("stateChanged")}else this.emitBubblingEvent("stateChanged")},removeChild:function(e,t){var i,n,s=e.config[this._dimension],r=o.utils.indexOf(e,this.contentItems),a=Math.max(r-1,0);if(-1===r)throw new Error("Can't remove child. ContentItem is not child of this Row or Column");for(this._splitter[a]&&(this._splitter[a]._$destroy(),this._splitter.splice(a,1)),i=0;i<this.contentItems.length;i++)this.contentItems[i]!==e&&(this.contentItems[i].config[this._dimension]+=s/(this.contentItems.length-1));o.items.AbstractContentItem.prototype.removeChild.call(this,e,t),1===this.contentItems.length&&!0===this.config.isClosable?(n=this.contentItems[0],this.contentItems=[],this.parent.replaceChild(this,n,!0)):(this.callDownwards("setSize"),this.emitBubblingEvent("stateChanged"))},replaceChild:function(e,t){var i=e.config[this._dimension];o.items.AbstractContentItem.prototype.replaceChild.call(this,e,t),t.config[this._dimension]=i,this.callDownwards("setSize"),this.emitBubblingEvent("stateChanged")},setSize:function(){this.contentItems.length>0&&(this._calculateRelativeSizes(),this._setAbsoluteSizes()),this.emitBubblingEvent("stateChanged"),this.emit("resize")},_$init:function(){var e;if(!0!==this.isInitialised)for(o.items.AbstractContentItem.prototype._$init.call(this),e=0;e<this.contentItems.length-1;e++)this.contentItems[e].element.after(this._createSplitter(e).element)},_setAbsoluteSizes:function(){var e=0,t=this._calculateAbsoluteSizes();for(e=0;e<this.contentItems.length;e++)t.additionalPixel-e>0&&t.itemSizes[e]++,this._isColumn?(this.contentItems[e].element.width(t.totalWidth),this.contentItems[e].element.height(t.itemSizes[e])):(this.contentItems[e].element.width(t.itemSizes[e]),this.contentItems[e].element.height(t.totalHeight))},_calculateAbsoluteSizes:function(){var e=null,t=(this.contentItems.length-1)*this._splitterSize,i=this.element.width(),n=this.element.height(),s=0,r=null,o=[];for(this._isColumn?n-=t:i-=t,e=0;e<this.contentItems.length;e++)s+=r=this._isColumn?Math.floor(n*(this.contentItems[e].config.height/100)):Math.floor(i*(this.contentItems[e].config.width/100)),o.push(r);return{itemSizes:o,additionalPixel:Math.floor((this._isColumn?n:i)-s),totalWidth:i,totalHeight:n}},_calculateRelativeSizes:function(){var e,t=0,i=[],n=this._isColumn?"height":"width";for(e=0;e<this.contentItems.length;e++)void 0!==this.contentItems[e].config[n]?t+=this.contentItems[e].config[n]:i.push(this.contentItems[e]);if(100!==Math.round(t))if(Math.round(t)<100&&i.length>0){for(e=0;e<i.length;e++)i[e].config[n]=(100-t)/i.length;this._respectMinItemWidth()}else{if(Math.round(t)>100)for(e=0;e<i.length;e++)i[e].config[n]=50,t+=50;for(e=0;e<this.contentItems.length;e++)this.contentItems[e].config[n]=this.contentItems[e].config[n]/t*100;this._respectMinItemWidth()}else this._respectMinItemWidth()},_respectMinItemWidth:function(){var e,t,i,n,s=this.layoutManager.config.dimensions&&this.layoutManager.config.dimensions.minItemWidth||0,r=[],o=0,a=0,l=0,c=0,h=[];if(!(this._isColumn||!s||this.contentItems.length<=1)){e=this._calculateAbsoluteSizes();for(var d=0;d<this.contentItems.length;d++)this.contentItems[d],(c=e.itemSizes[d])<s?(a+=s-c,n={width:s}):(o+=c-s,n={width:c},r.push(n)),h.push(n);if(!(0===a||a>o)){for(t=a/o,l=a,d=0;d<r.length;d++)n=r[d],l-=i=Math.round((n.width-s)*t),n.width-=i;for(0!==l&&(h[h.length-1].width-=l),d=0;d<this.contentItems.length;d++)this.contentItems[d].config.width=h[d].width/e.totalWidth*100}}},_createSplitter:function(e){var t;return(t=new o.controls.Splitter(this._isColumn,this._splitterSize)).on("drag",o.utils.fnBind(this._onSplitterDrag,this,[t]),this),t.on("dragStop",o.utils.fnBind(this._onSplitterDragStop,this,[t]),this),t.on("dragStart",o.utils.fnBind(this._onSplitterDragStart,this,[t]),this),this._splitter.splice(e,0,t),t},_getItemsForSplitter:function(e){var t=o.utils.indexOf(e,this._splitter);return{before:this.contentItems[t],after:this.contentItems[t+1]}},_getMinimumDimensions:function(e){for(var t=0,i=0,n=0;n<e.length;++n)t=Math.max(e[n].minWidth||0,t),i=Math.max(e[n].minHeight||0,i);return{horizontal:t,vertical:i}},_onSplitterDragStart:function(e){var t=this._getItemsForSplitter(e),i=this.layoutManager.config.dimensions[this._isColumn?"minItemHeight":"minItemWidth"],n=this._getMinimumDimensions(t.before.config.content),s=this._isColumn?n.vertical:n.horizontal,r=this._getMinimumDimensions(t.after.config.content),o=this._isColumn?r.vertical:r.horizontal;this._splitterPosition=0,this._splitterMinPosition=-1*(t.before.element[this._dimension]()-(s||i)),this._splitterMaxPosition=t.after.element[this._dimension]()-(o||i)},_onSplitterDrag:function(e,t,i){var n=this._isColumn?i:t;n>this._splitterMinPosition&&n<this._splitterMaxPosition&&(this._splitterPosition=n,e.element.css(this._isColumn?"top":"left",n))},_onSplitterDragStop:function(e){var t=this._getItemsForSplitter(e),i=t.before.element[this._dimension](),n=t.after.element[this._dimension](),s=(this._splitterPosition+i)/(i+n),r=t.before.config[this._dimension]+t.after.config[this._dimension];t.before.config[this._dimension]=s*r,t.after.config[this._dimension]=(1-s)*r,e.element.css({top:0,left:0}),o.utils.animFrame(o.utils.fnBind(this.callDownwards,this,["setSize"]))}}),o.items.Stack=function(e,t,i){o.items.AbstractContentItem.call(this,e,t,i),this.element=s()('<div class="lm_item lm_stack"></div>'),this._activeContentItem=null;var n=e.config;this._header={show:!0===n.settings.hasHeaders&&!1!==t.hasHeaders,popout:n.settings.showPopoutIcon&&n.labels.popout,maximise:n.settings.showMaximiseIcon&&n.labels.maximise,close:n.settings.showCloseIcon&&n.labels.close,minimise:n.labels.minimise},n.header&&o.utils.copy(this._header,n.header),t.header&&o.utils.copy(this._header,t.header),t.content&&t.content[0]&&t.content[0].header&&o.utils.copy(this._header,t.content[0].header),this._dropZones={},this._dropSegment=null,this._contentAreaDimensions=null,this._dropIndex=null,this.isStack=!0,this.childElementContainer=s()('<div class="lm_items"></div>'),this.header=new o.controls.Header(e,this),this.element.append(this.header.element),this.element.append(this.childElementContainer),this._setupHeaderPosition(),this._$validateClosability()},o.utils.extend(o.items.Stack,o.items.AbstractContentItem),o.utils.copy(o.items.Stack.prototype,{setSize:function(){var e,t=this._header.show?this.layoutManager.config.dimensions.headerHeight:0,i=this.element.width()-(this._sided?t:0),n=this.element.height()-(this._sided?0:t);for(this.childElementContainer.width(i),this.childElementContainer.height(n),e=0;e<this.contentItems.length;e++)this.contentItems[e].element.width(i).height(n);this.emit("resize"),this.emitBubblingEvent("stateChanged")},_$init:function(){var e,t;if(!0!==this.isInitialised){for(o.items.AbstractContentItem.prototype._$init.call(this),e=0;e<this.contentItems.length;e++)this.header.createTab(this.contentItems[e]),this.contentItems[e]._$hide();if(this.contentItems.length>0){if(!(t=this.contentItems[this.config.activeItemIndex||0]))throw new Error("Configured activeItemIndex out of bounds");this.setActiveContentItem(t)}}},setActiveContentItem:function(e){if(-1===o.utils.indexOf(e,this.contentItems))throw new Error("contentItem is not a child of this stack");null!==this._activeContentItem&&this._activeContentItem._$hide(),this._activeContentItem=e,this.header.setActiveContentItem(e),e._$show(),this.emit("activeContentItemChanged",e),this.emitBubblingEvent("stateChanged")},getActiveContentItem:function(){return this.header.activeContentItem},addChild:function(e,t){e=this.layoutManager._$normalizeContentItem(e,this),o.items.AbstractContentItem.prototype.addChild.call(this,e,t),this.childElementContainer.append(e.element),this.header.createTab(e,t),this.setActiveContentItem(e),this.callDownwards("setSize"),this._$validateClosability(),this.emitBubblingEvent("stateChanged")},removeChild:function(e,t){var i=o.utils.indexOf(e,this.contentItems);o.items.AbstractContentItem.prototype.removeChild.call(this,e,t),this.header.removeTab(e),this.contentItems.length>0?this.setActiveContentItem(this.contentItems[Math.max(i-1,0)]):this._activeContentItem=null,this._$validateClosability(),this.emitBubblingEvent("stateChanged")},_$validateClosability:function(){var e,t,i;for(e=this.header._isClosable(),i=0,t=this.contentItems.length;i<t&&e;i++)e=this.contentItems[i].config.isClosable;this.header._$setClosable(e)},_$destroy:function(){o.items.AbstractContentItem.prototype._$destroy.call(this),this.header._$destroy()},_$onDrop:function(e){if("header"===this._dropSegment)return this._resetHeaderDropZone(),void this.addChild(e,this._dropIndex);if("body"!==this._dropSegment){var t,i,n,s="top"===this._dropSegment||"bottom"===this._dropSegment,r="left"===this._dropSegment||"right"===this._dropSegment,a="top"===this._dropSegment||"left"===this._dropSegment,l=s&&this.parent.isColumn||r&&this.parent.isRow,c=s?"column":"row",h=s?"height":"width";e.isComponent&&((i=this.layoutManager.createContentItem({type:"stack",header:e.config.header||{}},this))._$init(),i.addChild(e),e=i),l?(t=o.utils.indexOf(this,this.parent.contentItems),this.parent.addChild(e,a?t:t+1,!0),this.config[h]*=.5,e.config[h]=this.config[h],this.parent.callDownwards("setSize")):(c=s?"column":"row",n=this.layoutManager.createContentItem({type:c},this),this.parent.replaceChild(this,n),n.addChild(e,a?0:void 0,!0),n.addChild(this,a?void 0:0,!0),this.config[h]=50,e.config[h]=50,n.callDownwards("setSize"))}else this.addChild(e)},_$highlightDropZone:function(e,t){var i,n;for(i in this._contentAreaDimensions)if((n=this._contentAreaDimensions[i].hoverArea).x1<e&&n.x2>e&&n.y1<t&&n.y2>t)return void("header"===i?(this._dropSegment="header",this._highlightHeaderDropZone(this._sided?t:e)):(this._resetHeaderDropZone(),this._highlightBodyDropZone(i)))},_$getArea:function(){if(!1===this.element.is(":visible"))return null;var e=o.items.AbstractContentItem.prototype._$getArea,t=e.call(this,this.header.element),i=e.call(this,this.childElementContainer),n=i.x2-i.x1,s=i.y2-i.y1;return this._contentAreaDimensions={header:{hoverArea:{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2},highlightArea:{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2}}},this._activeContentItem&&!1===this._activeContentItem.isComponent?t:0===this.contentItems.length?(this._contentAreaDimensions.body={hoverArea:{x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2},highlightArea:{x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2}},e.call(this,this.element)):(this._contentAreaDimensions.left={hoverArea:{x1:i.x1,y1:i.y1,x2:i.x1+.25*n,y2:i.y2},highlightArea:{x1:i.x1,y1:i.y1,x2:i.x1+.5*n,y2:i.y2}},this._contentAreaDimensions.top={hoverArea:{x1:i.x1+.25*n,y1:i.y1,x2:i.x1+.75*n,y2:i.y1+.5*s},highlightArea:{x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y1+.5*s}},this._contentAreaDimensions.right={hoverArea:{x1:i.x1+.75*n,y1:i.y1,x2:i.x2,y2:i.y2},highlightArea:{x1:i.x1+.5*n,y1:i.y1,x2:i.x2,y2:i.y2}},this._contentAreaDimensions.bottom={hoverArea:{x1:i.x1+.25*n,y1:i.y1+.5*s,x2:i.x1+.75*n,y2:i.y2},highlightArea:{x1:i.x1,y1:i.y1+.5*s,x2:i.x2,y2:i.y2}},e.call(this,this.element))},_highlightHeaderDropZone:function(e){var t,i,n,s,r,o,a,l,c=this.header.tabs.length,h=!1;if(0===c)return a=this.header.element.offset(),void this.layoutManager.dropTargetIndicator.highlightArea({x1:a.left,x2:a.left+100,y1:a.top+this.header.element.height()-20,y2:a.top+this.header.element.height()});for(t=0;t<c;t++)if(r=(i=this.header.tabs[t].element).offset(),this._sided?(s=r.top,n=r.left,l=i.height()):(s=r.left,n=r.top,l=i.width()),e>s&&e<s+l){h=!0;break}if(!(!1===h&&e<s)){if(e<s+l/2?(this._dropIndex=t,i.before(this.layoutManager.tabDropPlaceholder)):(this._dropIndex=Math.min(t+1,c),i.after(this.layoutManager.tabDropPlaceholder)),this._sided)return placeHolderTop=this.layoutManager.tabDropPlaceholder.offset().top,void this.layoutManager.dropTargetIndicator.highlightArea({x1:n,x2:n+i.innerHeight(),y1:placeHolderTop,y2:placeHolderTop+this.layoutManager.tabDropPlaceholder.width()});o=this.layoutManager.tabDropPlaceholder.offset().left,this.layoutManager.dropTargetIndicator.highlightArea({x1:o,x2:o+this.layoutManager.tabDropPlaceholder.width(),y1:n,y2:n+i.innerHeight()})}},_resetHeaderDropZone:function(){this.layoutManager.tabDropPlaceholder.remove()},_setupHeaderPosition:function(){var e=["right","left","bottom"].indexOf(this._header.show)>=0&&this._header.show;if(this.header.element.toggle(!!this._header.show),this._side=e,this._sided=["right","left"].indexOf(this._side)>=0,this.element.removeClass("lm_left lm_right lm_bottom"),this._side&&this.element.addClass("lm_"+this._side),this.element.find(".lm_header").length&&this.childElementContainer){var t=["right","bottom"].indexOf(this._side)>=0?"before":"after";this.header.element[t](this.childElementContainer),this.callDownwards("setSize")}},_highlightBodyDropZone:function(e){var t=this._contentAreaDimensions[e].highlightArea;this.layoutManager.dropTargetIndicator.highlightArea(t),this._dropSegment=e}}),o.utils.BubblingEvent=function(e,t){this.name=e,this.origin=t,this.isPropagationStopped=!1},o.utils.BubblingEvent.prototype.stopPropagation=function(){this.isPropagationStopped=!0},o.utils.ConfigMinifier=function(){this._keys=["settings","hasHeaders","constrainDragToContainer","selectionEnabled","dimensions","borderWidth","minItemHeight","minItemWidth","headerHeight","dragProxyWidth","dragProxyHeight","labels","close","maximise","minimise","popout","content","componentName","componentState","id","width","type","height","isClosable","title","popoutWholeStack","openPopouts","parentId","activeItemIndex","reorderEnabled"],this._values=[!0,!1,"row","column","stack","component","close","maximise","minimise","open in new window"]},o.utils.copy(o.utils.ConfigMinifier.prototype,{minifyConfig:function(e){var t={};return this._nextLevel(e,t,"_min"),t},unminifyConfig:function(e){var t={};return this._nextLevel(e,t,"_max"),t},_nextLevel:function(e,t,i){var n,s;for(n in e)e instanceof Array&&(n=parseInt(n,10)),e.hasOwnProperty(n)&&(s=this[i](n,this._keys),"object"===r(e[n])?(t[s]=e[n]instanceof Array?[]:{},this._nextLevel(e[n],t[s],i)):t[s]=this[i](e[n],this._values))},_min:function(e,t){if("string"==typeof e&&1===e.length)return"___"+e;var i=o.utils.indexOf(e,t);return-1===i?e:i.toString(36)},_max:function(e,t){return"string"==typeof e&&1===e.length?t[parseInt(e,36)]:"string"==typeof e&&"___"===e.substr(0,3)?e[3]:e}}),o.utils.EventHub=function(e){o.utils.EventEmitter.call(this),this._layoutManager=e,this._dontPropagateToParent=null,this._childEventSource=null,this.on(o.utils.EventEmitter.ALL_EVENT,o.utils.fnBind(this._onEventFromThis,this)),this._boundOnEventFromChild=o.utils.fnBind(this._onEventFromChild,this),s()(window).on("gl_child_event",this._boundOnEventFromChild)},o.utils.EventHub.prototype._onEventFromThis=function(){var e=Array.prototype.slice.call(arguments);this._layoutManager.isSubWindow&&e[0]!==this._dontPropagateToParent&&this._propagateToParent(e),this._propagateToChildren(e),this._dontPropagateToParent=null,this._childEventSource=null},o.utils.EventHub.prototype._$onEventFromParent=function(e){this._dontPropagateToParent=e[0],this.emit.apply(this,e)},o.utils.EventHub.prototype._onEventFromChild=function(e){this._childEventSource=e.originalEvent.__gl,this.emit.apply(this,e.originalEvent.__glArgs)},o.utils.EventHub.prototype._propagateToParent=function(e){var t,i="gl_child_event";document.createEvent?(t=window.opener.document.createEvent("HTMLEvents")).initEvent(i,!0,!0):(t=window.opener.document.createEventObject()).eventType=i,t.eventName=i,t.__glArgs=e,t.__gl=this._layoutManager,document.createEvent?window.opener.dispatchEvent(t):window.opener.fireEvent("on"+t.eventType,t)},o.utils.EventHub.prototype._propagateToChildren=function(e){var t,i;for(i=0;i<this._layoutManager.openPopouts.length;i++)(t=this._layoutManager.openPopouts[i].getGlInstance())&&t!==this._childEventSource&&t.eventHub._$onEventFromParent(e)},o.utils.EventHub.prototype.destroy=function(){s()(window).off("gl_child_event",this._boundOnEventFromChild)},o.utils.ReactComponentHandler=function(e,t){this._reactComponent=null,this._originalComponentWillUpdate=null,this._container=e,this._initialState=t,this._reactClass=this._getReactClass(),this._container.on("open",this._render,this),this._container.on("destroy",this._destroy,this)},o.utils.copy(o.utils.ReactComponentHandler.prototype,{_render:function(){this._reactComponent=ReactDOM.render(this._getReactComponent(),this._container.getElement()[0]),this._originalComponentWillUpdate=this._reactComponent.componentWillUpdate||function(){},this._reactComponent.componentWillUpdate=this._onUpdate.bind(this),this._container.getState()&&this._reactComponent.setState(this._container.getState())},_destroy:function(){ReactDOM.unmountComponentAtNode(this._container.getElement()[0]),this._container.off("open",this._render,this),this._container.off("destroy",this._destroy,this)},_onUpdate:function(e,t){this._container.setState(t),this._originalComponentWillUpdate.call(this._reactComponent,e,t)},_getReactClass:function(){var e,t=this._container._config.component;if(!t)throw new Error("No react component name. type: react-component needs a field `component`");if(!(e=this._container.layoutManager.getComponent(t)))throw new Error('React component "'+t+'" not found. Please register all components with GoldenLayout using `registerComponent(name, component)`');return e},_getReactComponent:function(){var e={glEventHub:this._container.layoutManager.eventHub,glContainer:this._container},t=s().extend(e,this._container._config.props);return React.createElement(this._reactClass,t)}});var a=o.LayoutManager},744:function(e,t,i){e.exports=function(){"use strict";var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)},t=function(){return(t=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var s in t=arguments[i])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};function n(e,t,i){if(i||2===arguments.length)for(var n,s=0,r=t.length;s<r;s++)!n&&s in t||((n=n||Array.prototype.slice.call(t,0,s))[s]=t[s]);return e.concat(n||Array.prototype.slice.call(t))}var s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:i.g,r=Object.keys,o=Array.isArray;function a(e,t){return"object"!=typeof t||r(t).forEach((function(i){e[i]=t[i]})),e}"undefined"==typeof Promise||s.Promise||(s.Promise=Promise);var l=Object.getPrototypeOf,c={}.hasOwnProperty;function h(e,t){return c.call(e,t)}function d(e,t){"function"==typeof t&&(t=t(l(e))),("undefined"==typeof Reflect?r:Reflect.ownKeys)(t).forEach((function(i){p(e,i,t[i])}))}var u=Object.defineProperty;function p(e,t,i,n){u(e,t,a(i&&h(i,"get")&&"function"==typeof i.get?{get:i.get,set:i.set,configurable:!0}:{value:i,configurable:!0,writable:!0},n))}function f(e){return{from:function(t){return e.prototype=Object.create(t.prototype),p(e.prototype,"constructor",e),{extend:d.bind(null,e.prototype)}}}}var m=Object.getOwnPropertyDescriptor,g=[].slice;function v(e,t,i){return g.call(e,t,i)}function _(e,t){return t(e)}function b(e){if(!e)throw new Error("Assertion Failed")}function y(e){s.setImmediate?setImmediate(e):setTimeout(e,0)}function C(e,t){if("string"==typeof t&&h(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var i=[],n=0,s=t.length;n<s;++n){var r=C(e,t[n]);i.push(r)}return i}var o=t.indexOf(".");if(-1!==o){var a=e[t.substr(0,o)];return null==a?void 0:C(a,t.substr(o+1))}}function w(e,t,i){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){b("string"!=typeof i&&"length"in i);for(var n=0,s=t.length;n<s;++n)w(e,t[n],i[n])}else{var r,a,l=t.indexOf(".");-1!==l?(r=t.substr(0,l),""===(a=t.substr(l+1))?void 0===i?o(e)&&!isNaN(parseInt(r))?e.splice(r,1):delete e[r]:e[r]=i:w(l=(l=e[r])&&h(e,r)?l:e[r]={},a,i)):void 0===i?o(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=i}}function S(e){var t,i={};for(t in e)h(e,t)&&(i[t]=e[t]);return i}var E=[].concat;function x(e){return E.apply([],e)}var T="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(x([8,16,32,64].map((function(e){return["Int","Uint","Float"].map((function(t){return t+e+"Array"}))})))).filter((function(e){return s[e]})),A=new Set(T.map((function(e){return s[e]}))),O=null;function I(e){return O=new WeakMap,e=function e(t){if(!t||"object"!=typeof t)return t;var i=O.get(t);if(i)return i;if(o(t)){i=[],O.set(t,i);for(var n=0,s=t.length;n<s;++n)i.push(e(t[n]))}else if(A.has(t.constructor))i=t;else{var r,a=l(t);for(r in i=a===Object.prototype?{}:Object.create(a),O.set(t,i),t)h(t,r)&&(i[r]=e(t[r]))}return i}(e),O=null,e}var k={}.toString;function D(e){return k.call(e).slice(8,-1)}var j="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator",R="symbol"==typeof j?function(e){var t;return null!=e&&(t=e[j])&&t.apply(e)}:function(){return null};function L(e,t){return 0<=(t=e.indexOf(t))&&e.splice(t,1),0<=t}var M={};function P(e){var t,i,n,s;if(1===arguments.length){if(o(e))return e.slice();if(this===M&&"string"==typeof e)return[e];if(s=R(e)){for(i=[];!(n=s.next()).done;)i.push(n.value);return i}if(null==e)return[e];if("number"!=typeof(t=e.length))return[e];for(i=new Array(t);t--;)i[t]=e[t];return i}for(t=arguments.length,i=new Array(t);t--;)i[t]=arguments[t];return i}var N="undefined"!=typeof Symbol?function(e){return"AsyncFunction"===e[Symbol.toStringTag]}:function(){return!1},F=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(ae=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"]),H={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function B(e,t){this.name=e,this.message=t}function z(e,t){return e+". Errors: "+Object.keys(t).map((function(e){return t[e].toString()})).filter((function(e,t,i){return i.indexOf(e)===t})).join("\n")}function V(e,t,i,n){this.failures=t,this.failedKeys=n,this.successCount=i,this.message=z(e,t)}function W(e,t){this.name="BulkError",this.failures=Object.keys(t).map((function(e){return t[e]})),this.failuresByPos=t,this.message=z(e,this.failures)}f(B).from(Error).extend({toString:function(){return this.name+": "+this.message}}),f(V).from(B),f(W).from(B);var $=F.reduce((function(e,t){return e[t]=t+"Error",e}),{}),U=B,q=F.reduce((function(e,t){var i=t+"Error";function n(e,n){this.name=i,e?"string"==typeof e?(this.message="".concat(e).concat(n?"\n "+n:""),this.inner=n||null):"object"==typeof e&&(this.message="".concat(e.name," ").concat(e.message),this.inner=e):(this.message=H[t]||i,this.inner=null)}return f(n).from(U),e[t]=n,e}),{});q.Syntax=SyntaxError,q.Type=TypeError,q.Range=RangeError;var G=ae.reduce((function(e,t){return e[t+"Error"]=q[t],e}),{}),K=F.reduce((function(e,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=q[t]),e}),{});function Y(){}function X(e){return e}function Z(e,t){return null==e||e===X?t:function(i){return t(e(i))}}function Q(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function J(e,t){return e===Y?t:function(){var i=e.apply(this,arguments);void 0!==i&&(arguments[0]=i);var n=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var r=t.apply(this,arguments);return n&&(this.onsuccess=this.onsuccess?Q(n,this.onsuccess):n),s&&(this.onerror=this.onerror?Q(s,this.onerror):s),void 0!==r?r:i}}function ee(e,t){return e===Y?t:function(){e.apply(this,arguments);var i=this.onsuccess,n=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),i&&(this.onsuccess=this.onsuccess?Q(i,this.onsuccess):i),n&&(this.onerror=this.onerror?Q(n,this.onerror):n)}}function te(e,t){return e===Y?t:function(i){var n=e.apply(this,arguments);a(i,n);var s=this.onsuccess,r=this.onerror;return this.onsuccess=null,this.onerror=null,i=t.apply(this,arguments),s&&(this.onsuccess=this.onsuccess?Q(s,this.onsuccess):s),r&&(this.onerror=this.onerror?Q(r,this.onerror):r),void 0===n?void 0===i?void 0:i:a(n,i)}}function ie(e,t){return e===Y?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function ne(e,t){return e===Y?t:function(){var i=e.apply(this,arguments);if(i&&"function"==typeof i.then){for(var n=this,s=arguments.length,r=new Array(s);s--;)r[s]=arguments[s];return i.then((function(){return t.apply(n,r)}))}return t.apply(this,arguments)}}K.ModifyError=V,K.DexieError=B,K.BulkError=W;var se="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function re(e){se=e}var oe={},ae=(T="undefined"==typeof Promise?[]:function(){var e=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[e,l(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,l(t),e]}(),T[0]),le=(F=T[1],T=T[2],F=F&&F.then,ae&&ae.constructor),ce=!!T,he=function(e,t){_e.push([e,t]),ue&&(queueMicrotask(Oe),ue=!1)},de=!0,ue=!0,pe=[],fe=[],me=X,ge={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Y,pgp:!1,env:{},finalize:Y},ve=ge,_e=[],be=0,ye=[];function Ce(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=ve;if("function"!=typeof e){if(e!==oe)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&Ee(this,this._value))}this._state=null,this._value=null,++t.ref,function e(t,i){try{i((function(i){if(null===t._state){if(i===t)throw new TypeError("A promise cannot be resolved with itself.");var n=t._lib&&Ie();i&&"function"==typeof i.then?e(t,(function(e,t){i instanceof Ce?i._then(e,t):i.then(e,t)})):(t._state=!0,t._value=i,xe(t)),n&&ke()}}),Ee.bind(null,t))}catch(i){Ee(t,i)}}(this,e)}var we={get:function(){var e=ve,t=Fe;function i(i,n){var s=this,r=!e.global&&(e!==ve||t!==Fe),o=r&&!Ve(),a=new Ce((function(t,a){Te(s,new Se(Ke(i,e,r,o),Ke(n,e,r,o),t,a,e))}));return this._consoleTask&&(a._consoleTask=this._consoleTask),a}return i.prototype=oe,i},set:function(e){p(this,"then",e&&e.prototype===oe?we:{get:function(){return e},set:we.set})}};function Se(e,t,i,n,s){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=i,this.reject=n,this.psd=s}function Ee(e,t){var i,n;fe.push(t),null===e._state&&(i=e._lib&&Ie(),t=me(t),e._state=!1,e._value=t,n=e,pe.some((function(e){return e._value===n._value}))||pe.push(n),xe(e),i&&ke())}function xe(e){var t=e._listeners;e._listeners=[];for(var i=0,n=t.length;i<n;++i)Te(e,t[i]);var s=e._PSD;--s.ref||s.finalize(),0===be&&(++be,he((function(){0==--be&&De()}),[]))}function Te(e,t){if(null!==e._state){var i=e._state?t.onFulfilled:t.onRejected;if(null===i)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++be,he(Ae,[i,e,t])}else e._listeners.push(t)}function Ae(e,t,i){try{var n,s=t._value;!t._state&&fe.length&&(fe=[]),n=se&&t._consoleTask?t._consoleTask.run((function(){return e(s)})):e(s),t._state||-1!==fe.indexOf(s)||function(e){for(var t=pe.length;t;)if(pe[--t]._value===e._value)return pe.splice(t,1)}(t),i.resolve(n)}catch(e){i.reject(e)}finally{0==--be&&De(),--i.psd.ref||i.psd.finalize()}}function Oe(){Ge(ge,(function(){Ie()&&ke()}))}function Ie(){var e=de;return ue=de=!1,e}function ke(){var e,t,i;do{for(;0<_e.length;)for(e=_e,_e=[],i=e.length,t=0;t<i;++t){var n=e[t];n[0].apply(null,n[1])}}while(0<_e.length);ue=de=!0}function De(){var e=pe;pe=[],e.forEach((function(e){e._PSD.onunhandled.call(null,e._value,e)}));for(var t=ye.slice(0),i=t.length;i;)t[--i]()}function je(e){return new Ce(oe,!1,e)}function Re(e,t){var i=ve;return function(){var n=Ie(),s=ve;try{return Ue(i,!0),e.apply(this,arguments)}catch(n){t&&t(n)}finally{Ue(s,!1),n&&ke()}}}d(Ce.prototype,{then:we,_then:function(e,t){Te(this,new Se(null,null,e,t,ve))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=e,i=arguments[1];return"function"==typeof t?this.then(null,(function(e){return(e instanceof t?i:je)(e)})):this.then(null,(function(e){return(e&&e.name===t?i:je)(e)}))},finally:function(e){return this.then((function(t){return Ce.resolve(e()).then((function(){return t}))}),(function(t){return Ce.resolve(e()).then((function(){return je(t)}))}))},timeout:function(e,t){var i=this;return e<1/0?new Ce((function(n,s){var r=setTimeout((function(){return s(new q.Timeout(t))}),e);i.then(n,s).finally(clearTimeout.bind(null,r))})):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&p(Ce.prototype,Symbol.toStringTag,"Dexie.Promise"),ge.env=qe(),d(Ce,{all:function(){var e=P.apply(null,arguments).map(We);return new Ce((function(t,i){0===e.length&&t([]);var n=e.length;e.forEach((function(s,r){return Ce.resolve(s).then((function(i){e[r]=i,--n||t(e)}),i)}))}))},resolve:function(e){return e instanceof Ce?e:e&&"function"==typeof e.then?new Ce((function(t,i){e.then(t,i)})):new Ce(oe,!0,e)},reject:je,race:function(){var e=P.apply(null,arguments).map(We);return new Ce((function(t,i){e.map((function(e){return Ce.resolve(e).then(t,i)}))}))},PSD:{get:function(){return ve},set:function(e){return ve=e}},totalEchoes:{get:function(){return Fe}},newPSD:Be,usePSD:Ge,scheduler:{get:function(){return he},set:function(e){he=e}},rejectionMapper:{get:function(){return me},set:function(e){me=e}},follow:function(e,t){return new Ce((function(i,n){return Be((function(t,i){var n=ve;n.unhandleds=[],n.onunhandled=i,n.finalize=Q((function(){var e,n=this;e=function(){0===n.unhandleds.length?t():i(n.unhandleds[0])},ye.push((function t(){e(),ye.splice(ye.indexOf(t),1)})),++be,he((function(){0==--be&&De()}),[])}),n.finalize),e()}),t,i,n)}))}}),le&&(le.allSettled&&p(Ce,"allSettled",(function(){var e=P.apply(null,arguments).map(We);return new Ce((function(t){0===e.length&&t([]);var i=e.length,n=new Array(i);e.forEach((function(e,s){return Ce.resolve(e).then((function(e){return n[s]={status:"fulfilled",value:e}}),(function(e){return n[s]={status:"rejected",reason:e}})).then((function(){return--i||t(n)}))}))}))})),le.any&&"undefined"!=typeof AggregateError&&p(Ce,"any",(function(){var e=P.apply(null,arguments).map(We);return new Ce((function(t,i){0===e.length&&i(new AggregateError([]));var n=e.length,s=new Array(n);e.forEach((function(e,r){return Ce.resolve(e).then((function(e){return t(e)}),(function(e){s[r]=e,--n||i(new AggregateError(s))}))}))}))})),le.withResolvers&&(Ce.withResolvers=le.withResolvers));var Le={awaits:0,echoes:0,id:0},Me=0,Pe=[],Ne=0,Fe=0,He=0;function Be(e,t,i,n){var s=ve,r=Object.create(s);return r.parent=s,r.ref=0,r.global=!1,r.id=++He,ge.env,r.env=ce?{Promise:Ce,PromiseProp:{value:Ce,configurable:!0,writable:!0},all:Ce.all,race:Ce.race,allSettled:Ce.allSettled,any:Ce.any,resolve:Ce.resolve,reject:Ce.reject}:{},t&&a(r,t),++s.ref,r.finalize=function(){--this.parent.ref||this.parent.finalize()},n=Ge(r,e,i,n),0===r.ref&&r.finalize(),n}function ze(){return Le.id||(Le.id=++Me),++Le.awaits,Le.echoes+=100,Le.id}function Ve(){return!!Le.awaits&&(0==--Le.awaits&&(Le.id=0),Le.echoes=100*Le.awaits,!0)}function We(e){return Le.echoes&&e&&e.constructor===le?(ze(),e.then((function(e){return Ve(),e}),(function(e){return Ve(),Xe(e)}))):e}function $e(){var e=Pe[Pe.length-1];Pe.pop(),Ue(e,!1)}function Ue(e,t){var i,n=ve;(t?!Le.echoes||Ne++&&e===ve:!Ne||--Ne&&e===ve)||queueMicrotask(t?function(e){++Fe,Le.echoes&&0!=--Le.echoes||(Le.echoes=Le.awaits=Le.id=0),Pe.push(ve),Ue(e,!0)}.bind(null,e):$e),e!==ve&&(ve=e,n===ge&&(ge.env=qe()),ce&&(i=ge.env.Promise,t=e.env,(n.global||e.global)&&(Object.defineProperty(s,"Promise",t.PromiseProp),i.all=t.all,i.race=t.race,i.resolve=t.resolve,i.reject=t.reject,t.allSettled&&(i.allSettled=t.allSettled),t.any&&(i.any=t.any))))}function qe(){var e=s.Promise;return ce?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(s,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function Ge(e,t,i,n,s){var r=ve;try{return Ue(e,!0),t(i,n,s)}finally{Ue(r,!1)}}function Ke(e,t,i,n){return"function"!=typeof e?e:function(){var s=ve;i&&ze(),Ue(t,!0);try{return e.apply(this,arguments)}finally{Ue(s,!1),n&&queueMicrotask(Ve)}}}function Ye(e){Promise===le&&0===Le.echoes?0===Ne?e():enqueueNativeMicroTask(e):setTimeout(e,0)}-1===(""+F).indexOf("[native code]")&&(ze=Ve=Y);var Xe=Ce.reject,Ze=String.fromCharCode(65535),Qe="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Je="String expected.",et=[],tt="__dbnames",it="readonly",nt="readwrite";function st(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var rt={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function ot(e){return"string"!=typeof e||/\./.test(e)?function(e){return e}:function(t){return void 0===t[e]&&e in t&&delete(t=I(t))[e],t}}function at(){throw q.Type()}function lt(e,t){try{var i=ct(e),n=ct(t);if(i!==n)return"Array"===i?1:"Array"===n?-1:"binary"===i?1:"binary"===n?-1:"string"===i?1:"string"===n?-1:"Date"===i?1:"Date"!==n?NaN:-1;switch(i){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":return function(e,t){for(var i=e.length,n=t.length,s=i<n?i:n,r=0;r<s;++r)if(e[r]!==t[r])return e[r]<t[r]?-1:1;return i===n?0:i<n?-1:1}(ht(e),ht(t));case"Array":return function(e,t){for(var i=e.length,n=t.length,s=i<n?i:n,r=0;r<s;++r){var o=lt(e[r],t[r]);if(0!==o)return o}return i===n?0:i<n?-1:1}(e,t)}}catch(e){}return NaN}function ct(e){var t=typeof e;return"object"!=t?t:ArrayBuffer.isView(e)||"ArrayBuffer"===(e=D(e))?"binary":e}function ht(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var dt=(ut.prototype._trans=function(e,t,i){var n=this._tx||ve.trans,s=this.name,r=se&&"undefined"!=typeof console&&console.createTask&&console.createTask("Dexie: ".concat("readonly"===e?"read":"write"," ").concat(this.name));function o(e,i,n){if(!n.schema[s])throw new q.NotFound("Table "+s+" not part of transaction");return t(n.idbtrans,n)}var a=Ie();try{var l=n&&n.db._novip===this.db._novip?n===ve.trans?n._promise(e,o,i):Be((function(){return n._promise(e,o,i)}),{trans:n,transless:ve.transless||ve}):function e(t,i,n,s){if(t.idbdb&&(t._state.openComplete||ve.letThrough||t._vip)){var r=t._createTransaction(i,n,t._dbSchema);try{r.create(),t._state.PR1398_maxLoop=3}catch(r){return r.name===$.InvalidState&&t.isOpen()&&0<--t._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),t.close({disableAutoOpen:!1}),t.open().then((function(){return e(t,i,n,s)}))):Xe(r)}return r._promise(i,(function(e,t){return Be((function(){return ve.trans=r,s(e,t,r)}))})).then((function(e){if("readwrite"===i)try{r.idbtrans.commit()}catch(e){}return"readonly"===i?e:r._completion.then((function(){return e}))}))}if(t._state.openComplete)return Xe(new q.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return Xe(new q.DatabaseClosed);t.open().catch(Y)}return t._state.dbReadyPromise.then((function(){return e(t,i,n,s)}))}(this.db,e,[this.name],o);return r&&(l._consoleTask=r,l=l.catch((function(e){return console.trace(e),Xe(e)}))),l}finally{a&&ke()}},ut.prototype.get=function(e,t){var i=this;return e&&e.constructor===Object?this.where(e).first(t):null==e?Xe(new q.Type("Invalid argument to Table.get()")):this._trans("readonly",(function(t){return i.core.get({trans:t,key:e}).then((function(e){return i.hook.reading.fire(e)}))})).then(t)},ut.prototype.where=function(e){if("string"==typeof e)return new this.db.WhereClause(this,e);if(o(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=r(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);var i=this.schema.indexes.concat(this.schema.primKey).filter((function(e){if(e.compound&&t.every((function(t){return 0<=e.keyPath.indexOf(t)}))){for(var i=0;i<t.length;++i)if(-1===t.indexOf(e.keyPath[i]))return!1;return!0}return!1})).sort((function(e,t){return e.keyPath.length-t.keyPath.length}))[0];if(i&&this.db._maxKey!==Ze){var n=i.keyPath.slice(0,t.length);return this.where(n).equals(n.map((function(t){return e[t]})))}!i&&se&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var s=this.schema.idxByName;function a(e,t){return 0===lt(e,t)}var l=t.reduce((function(t,i){var n=t[0],r=t[1],l=(t=s[i],e[i]);return[n||t,n||!t?st(r,t&&t.multi?function(e){return e=C(e,i),o(e)&&e.some((function(e){return a(l,e)}))}:function(e){return a(l,C(e,i))}):r]}),[null,null]);return n=l[0],l=l[1],n?this.where(n.name).equals(e[n.keyPath]).filter(l):i?this.filter(l):this.where(t).equals("")},ut.prototype.filter=function(e){return this.toCollection().and(e)},ut.prototype.count=function(e){return this.toCollection().count(e)},ut.prototype.offset=function(e){return this.toCollection().offset(e)},ut.prototype.limit=function(e){return this.toCollection().limit(e)},ut.prototype.each=function(e){return this.toCollection().each(e)},ut.prototype.toArray=function(e){return this.toCollection().toArray(e)},ut.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},ut.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,o(e)?"[".concat(e.join("+"),"]"):e))},ut.prototype.reverse=function(){return this.toCollection().reverse()},ut.prototype.mapToClass=function(t){var i,n=this.db,s=this.name;function r(){return null!==i&&i.apply(this,arguments)||this}(this.schema.mappedClass=t).prototype instanceof at&&(function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}(r,i=t),Object.defineProperty(r.prototype,"db",{get:function(){return n},enumerable:!1,configurable:!0}),r.prototype.table=function(){return s},t=r);for(var o=new Set,a=t.prototype;a;a=l(a))Object.getOwnPropertyNames(a).forEach((function(e){return o.add(e)}));function c(e){if(!e)return e;var i,n=Object.create(t.prototype);for(i in e)if(!o.has(i))try{n[i]=e[i]}catch(e){}return n}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=c,this.hook("reading",c),t},ut.prototype.defineClass=function(){return this.mapToClass((function(e){a(this,e)}))},ut.prototype.add=function(e,t){var i=this,n=this.schema.primKey,s=n.auto,r=n.keyPath,o=e;return r&&s&&(o=ot(r)(e)),this._trans("readwrite",(function(e){return i.core.mutate({trans:e,type:"add",keys:null!=t?[t]:null,values:[o]})})).then((function(e){return e.numFailures?Ce.reject(e.failures[0]):e.lastResult})).then((function(t){if(r)try{w(e,r,t)}catch(t){}return t}))},ut.prototype.update=function(e,t){return"object"!=typeof e||o(e)?this.where(":id").equals(e).modify(t):void 0===(e=C(e,this.schema.primKey.keyPath))?Xe(new q.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t)},ut.prototype.put=function(e,t){var i=this,n=this.schema.primKey,s=n.auto,r=n.keyPath,o=e;return r&&s&&(o=ot(r)(e)),this._trans("readwrite",(function(e){return i.core.mutate({trans:e,type:"put",values:[o],keys:null!=t?[t]:null})})).then((function(e){return e.numFailures?Ce.reject(e.failures[0]):e.lastResult})).then((function(t){if(r)try{w(e,r,t)}catch(t){}return t}))},ut.prototype.delete=function(e){var t=this;return this._trans("readwrite",(function(i){return t.core.mutate({trans:i,type:"delete",keys:[e]})})).then((function(e){return e.numFailures?Ce.reject(e.failures[0]):void 0}))},ut.prototype.clear=function(){var e=this;return this._trans("readwrite",(function(t){return e.core.mutate({trans:t,type:"deleteRange",range:rt})})).then((function(e){return e.numFailures?Ce.reject(e.failures[0]):void 0}))},ut.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",(function(i){return t.core.getMany({keys:e,trans:i}).then((function(e){return e.map((function(e){return t.hook.reading.fire(e)}))}))}))},ut.prototype.bulkAdd=function(e,t,i){var n=this,s=Array.isArray(t)?t:void 0,r=(i=i||(s?void 0:t))?i.allKeys:void 0;return this._trans("readwrite",(function(t){var i=(a=n.schema.primKey).auto;if((a=a.keyPath)&&s)throw new q.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new q.InvalidArgument("Arguments objects and keys must have the same length");var o=e.length,a=a&&i?e.map(ot(a)):e;return n.core.mutate({trans:t,type:"add",keys:s,values:a,wantResults:r}).then((function(e){var t=e.numFailures,i=e.results,s=e.lastResult;if(e=e.failures,0===t)return r?i:s;throw new W("".concat(n.name,".bulkAdd(): ").concat(t," of ").concat(o," operations failed"),e)}))}))},ut.prototype.bulkPut=function(e,t,i){var n=this,s=Array.isArray(t)?t:void 0,r=(i=i||(s?void 0:t))?i.allKeys:void 0;return this._trans("readwrite",(function(t){var i=(a=n.schema.primKey).auto;if((a=a.keyPath)&&s)throw new q.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new q.InvalidArgument("Arguments objects and keys must have the same length");var o=e.length,a=a&&i?e.map(ot(a)):e;return n.core.mutate({trans:t,type:"put",keys:s,values:a,wantResults:r}).then((function(e){var t=e.numFailures,i=e.results,s=e.lastResult;if(e=e.failures,0===t)return r?i:s;throw new W("".concat(n.name,".bulkPut(): ").concat(t," of ").concat(o," operations failed"),e)}))}))},ut.prototype.bulkUpdate=function(e){var t=this,i=this.core,n=e.map((function(e){return e.key})),s=e.map((function(e){return e.changes})),r=[];return this._trans("readwrite",(function(o){return i.getMany({trans:o,keys:n,cache:"clone"}).then((function(a){var l=[],c=[];e.forEach((function(e,i){var n=e.key,s=e.changes,o=a[i];if(o){for(var h=0,d=Object.keys(s);h<d.length;h++){var u=d[h],p=s[u];if(u===t.schema.primKey.keyPath){if(0!==lt(p,n))throw new q.Constraint("Cannot update primary key in bulkUpdate()")}else w(o,u,p)}r.push(i),l.push(n),c.push(o)}}));var h=l.length;return i.mutate({trans:o,type:"put",keys:l,values:c,updates:{keys:n,changeSpecs:s}}).then((function(e){var i=e.numFailures,n=e.failures;if(0===i)return h;for(var s=0,o=Object.keys(n);s<o.length;s++){var a,l=o[s],c=r[Number(l)];null!=c&&(a=n[l],delete n[l],n[c]=a)}throw new W("".concat(t.name,".bulkUpdate(): ").concat(i," of ").concat(h," operations failed"),n)}))}))}))},ut.prototype.bulkDelete=function(e){var t=this,i=e.length;return this._trans("readwrite",(function(i){return t.core.mutate({trans:i,type:"delete",keys:e})})).then((function(e){var n=e.numFailures,s=e.lastResult;if(e=e.failures,0===n)return s;throw new W("".concat(t.name,".bulkDelete(): ").concat(n," of ").concat(i," operations failed"),e)}))},ut);function ut(){}function pt(e){function t(t,n){if(n){for(var s=arguments.length,r=new Array(s-1);--s;)r[s-1]=arguments[s];return i[t].subscribe.apply(null,r),e}if("string"==typeof t)return i[t]}var i={};t.addEventType=a;for(var n=1,s=arguments.length;n<s;++n)a(arguments[n]);return t;function a(e,n,s){if("object"!=typeof e){var l;n=n||ie;var c={subscribers:[],fire:s=s||Y,subscribe:function(e){-1===c.subscribers.indexOf(e)&&(c.subscribers.push(e),c.fire=n(c.fire,e))},unsubscribe:function(e){c.subscribers=c.subscribers.filter((function(t){return t!==e})),c.fire=c.subscribers.reduce(n,s)}};return i[e]=t[e]=c}r(l=e).forEach((function(e){var t=l[e];if(o(t))a(e,l[e][0],l[e][1]);else{if("asap"!==t)throw new q.InvalidArgument("Invalid event config");var i=a(e,X,(function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];i.subscribers.forEach((function(e){y((function(){e.apply(null,t)}))}))}))}}))}}function ft(e,t){return f(t).from({prototype:e}),t}function mt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function gt(e,t){e.filter=st(e.filter,t)}function vt(e,t,i){var n=e.replayFilter;e.replayFilter=n?function(){return st(n(),t())}:t,e.justLimit=i&&!n}function _t(e,t){if(e.isPrimKey)return t.primaryKey;var i=t.getIndexByKeyPath(e.index);if(!i)throw new q.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return i}function bt(e,t,i){var n=_t(e,t.schema);return t.openCursor({trans:i,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:n,range:e.range}})}function yt(e,t,i,n){var s=e.replayFilter?st(e.filter,e.replayFilter()):e.filter;if(e.or){var r={},o=function(e,i,n){var o,a;s&&!s(i,n,(function(e){return i.stop(e)}),(function(e){return i.fail(e)}))||("[object ArrayBuffer]"==(a=""+(o=i.primaryKey))&&(a=""+new Uint8Array(o)),h(r,a)||(r[a]=!0,t(e,i,n)))};return Promise.all([e.or._iterate(o,i),Ct(bt(e,n,i),e.algorithm,o,!e.keysOnly&&e.valueMapper)])}return Ct(bt(e,n,i),st(e.algorithm,s),t,!e.keysOnly&&e.valueMapper)}function Ct(e,t,i,n){var s=Re(n?function(e,t,s){return i(n(e),t,s)}:i);return e.then((function(e){if(e)return e.start((function(){var i=function(){return e.continue()};t&&!t(e,(function(e){return i=e}),(function(t){e.stop(t),i=Y}),(function(t){e.fail(t),i=Y}))||s(e.value,e,(function(e){return i=e})),i()}))}))}T=Symbol();var wt=(St.prototype.execute=function(e){if(void 0!==this.add){var t=this.add;if(o(t))return n(n([],o(e)?e:[],!0),t,!0).sort();if("number"==typeof t)return(Number(e)||0)+t;if("bigint"==typeof t)try{return BigInt(e)+t}catch(e){return BigInt(0)+t}throw new TypeError("Invalid term ".concat(t))}if(void 0!==this.remove){var i=this.remove;if(o(i))return o(e)?e.filter((function(e){return!i.includes(e)})).sort():[];if("number"==typeof i)return Number(e)-i;if("bigint"==typeof i)try{return BigInt(e)-i}catch(e){return BigInt(0)-i}throw new TypeError("Invalid subtrahend ".concat(i))}return(t=null===(t=this.replacePrefix)||void 0===t?void 0:t[0])&&"string"==typeof e&&e.startsWith(t)?this.replacePrefix[1]+e.substring(t.length):e},St);function St(e){Object.assign(this,e)}var Et=(xt.prototype._read=function(e,t){var i=this._ctx;return i.error?i.table._trans(null,Xe.bind(null,i.error)):i.table._trans("readonly",e).then(t)},xt.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,Xe.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},xt.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=st(t.algorithm,e)},xt.prototype._iterate=function(e,t){return yt(this._ctx,e,t,this._ctx.table.core)},xt.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),i=Object.create(this._ctx);return e&&a(i,e),t._ctx=i,t},xt.prototype.raw=function(){return this._ctx.valueMapper=null,this},xt.prototype.each=function(e){var t=this._ctx;return this._read((function(i){return yt(t,e,i,t.table.core)}))},xt.prototype.count=function(e){var t=this;return this._read((function(e){var i=t._ctx,n=i.table.core;if(mt(i,!0))return n.count({trans:e,query:{index:_t(i,n.schema),range:i.range}}).then((function(e){return Math.min(e,i.limit)}));var s=0;return yt(i,(function(){return++s,!1}),e,n).then((function(){return s}))})).then(e)},xt.prototype.sortBy=function(e,t){var i=e.split(".").reverse(),n=i[0],s=i.length-1;function r(e,t){return t?r(e[i[t]],t-1):e[n]}var o="next"===this._ctx.dir?1:-1;function a(e,t){return lt(r(e,s),r(t,s))*o}return this.toArray((function(e){return e.sort(a)})).then(t)},xt.prototype.toArray=function(e){var t=this;return this._read((function(e){var i=t._ctx;if("next"===i.dir&&mt(i,!0)&&0<i.limit){var n=i.valueMapper,s=_t(i,i.table.core.schema);return i.table.core.query({trans:e,limit:i.limit,values:!0,query:{index:s,range:i.range}}).then((function(e){return e=e.result,n?e.map(n):e}))}var r=[];return yt(i,(function(e){return r.push(e)}),e,i.table.core).then((function(){return r}))}),e)},xt.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,mt(t)?vt(t,(function(){var t=e;return function(e,i){return 0===t||(1===t?--t:i((function(){e.advance(t),t=0})),!1)}})):vt(t,(function(){var t=e;return function(){return--t<0}}))),this},xt.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),vt(this._ctx,(function(){var t=e;return function(e,i,n){return--t<=0&&i(n),0<=t}}),!0),this},xt.prototype.until=function(e,t){return gt(this._ctx,(function(i,n,s){return!e(i.value)||(n(s),t)})),this},xt.prototype.first=function(e){return this.limit(1).toArray((function(e){return e[0]})).then(e)},xt.prototype.last=function(e){return this.reverse().first(e)},xt.prototype.filter=function(e){var t;return gt(this._ctx,(function(t){return e(t.value)})),(t=this._ctx).isMatch=st(t.isMatch,e),this},xt.prototype.and=function(e){return this.filter(e)},xt.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},xt.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},xt.prototype.desc=function(){return this.reverse()},xt.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,i){e(i.key,i)}))},xt.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},xt.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,i){e(i.primaryKey,i)}))},xt.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var i=[];return this.each((function(e,t){i.push(t.key)})).then((function(){return i})).then(e)},xt.prototype.primaryKeys=function(e){var t=this._ctx;if("next"===t.dir&&mt(t,!0)&&0<t.limit)return this._read((function(e){var i=_t(t,t.table.core.schema);return t.table.core.query({trans:e,values:!1,limit:t.limit,query:{index:i,range:t.range}})})).then((function(e){return e.result})).then(e);t.keysOnly=!t.isMatch;var i=[];return this.each((function(e,t){i.push(t.primaryKey)})).then((function(){return i})).then(e)},xt.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},xt.prototype.firstKey=function(e){return this.limit(1).keys((function(e){return e[0]})).then(e)},xt.prototype.lastKey=function(e){return this.reverse().firstKey(e)},xt.prototype.distinct=function(){var e;if(!(e=(e=this._ctx).index&&e.table.schema.idxByName[e.index])||!e.multi)return this;var t={};return gt(this._ctx,(function(e){var i=e.primaryKey.toString();return e=h(t,i),t[i]=!0,!e})),this},xt.prototype.modify=function(e){var t=this,i=this._ctx;return this._write((function(n){var s,o,a;function l(e,t){var i=t.failures;t=t.numFailures,m+=e-t;for(var n=0,s=r(i);n<s.length;n++){var o=s[n];f.push(i[o])}}a="function"==typeof e?e:(s=r(e),o=s.length,function(t){for(var i=!1,n=0;n<o;++n){var r=s[n],a=e[r],l=C(t,r);a instanceof wt?(w(t,r,a.execute(l)),i=!0):l!==a&&(w(t,r,a),i=!0)}return i});var c=i.table.core,h=c.schema.primaryKey,d=h.outbound,u=h.extractKey,p=t.db._options.modifyChunkSize||200,f=[],m=0,g=[];return t.clone().primaryKeys().then((function(t){var s=mt(i)&&i.limit===1/0&&("function"!=typeof e||e===Tt)&&{index:i.index,range:i.range};return function i(r){var o=Math.min(p,t.length-r);return c.getMany({trans:n,keys:t.slice(r,r+o),cache:"immutable"}).then((function(h){for(var f=[],m=[],g=d?[]:null,v=[],_=0;_<o;++_){var b=h[_],y={value:I(b),primKey:t[r+_]};!1!==a.call(y,y.value,y)&&(null==y.value?v.push(t[r+_]):d||0===lt(u(b),u(y.value))?(m.push(y.value),d&&g.push(t[r+_])):(v.push(t[r+_]),f.push(y.value)))}return Promise.resolve(0<f.length&&c.mutate({trans:n,type:"add",values:f}).then((function(e){for(var t in e.failures)v.splice(parseInt(t),1);l(f.length,e)}))).then((function(){return(0<m.length||s&&"object"==typeof e)&&c.mutate({trans:n,type:"put",keys:g,values:m,criteria:s,changeSpec:"function"!=typeof e&&e,isAdditionalChunk:0<r}).then((function(e){return l(m.length,e)}))})).then((function(){return(0<v.length||s&&e===Tt)&&c.mutate({trans:n,type:"delete",keys:v,criteria:s,isAdditionalChunk:0<r}).then((function(e){return l(v.length,e)}))})).then((function(){return t.length>r+o&&i(r+p)}))}))}(0).then((function(){if(0<f.length)throw new V("Error modifying one or more objects",f,m,g);return t.length}))}))}))},xt.prototype.delete=function(){var e=this._ctx,t=e.range;return mt(e)&&(e.isPrimKey||3===t.type)?this._write((function(i){var n=e.table.core.schema.primaryKey,s=t;return e.table.core.count({trans:i,query:{index:n,range:s}}).then((function(t){return e.table.core.mutate({trans:i,type:"deleteRange",range:s}).then((function(e){var i=e.failures;if(e.lastResult,e.results,e=e.numFailures)throw new V("Could not delete some values",Object.keys(i).map((function(e){return i[e]})),t-e);return t-e}))}))})):this.modify(Tt)},xt);function xt(){}var Tt=function(e,t){return t.value=null};function At(e,t){return e<t?-1:e===t?0:1}function Ot(e,t){return t<e?-1:e===t?0:1}function It(e,t,i){return(e=e instanceof Lt?new e.Collection(e):e)._ctx.error=new(i||TypeError)(t),e}function kt(e){return new e.Collection(e,(function(){return Rt("")})).limit(0)}function Dt(e,t,i,n){var s,r,o,a,l,c,h,d=i.length;if(!i.every((function(e){return"string"==typeof e})))return It(e,Je);function u(e){s="next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()},r="next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()},o="next"===e?At:Ot;var t=i.map((function(e){return{lower:r(e),upper:s(e)}})).sort((function(e,t){return o(e.lower,t.lower)}));a=t.map((function(e){return e.upper})),l=t.map((function(e){return e.lower})),h="next"===(c=e)?"":n}u("next"),(e=new e.Collection(e,(function(){return jt(a[0],l[d-1]+n)})))._ondirectionchange=function(e){u(e)};var p=0;return e._addAlgorithm((function(e,i,n){var s=e.key;if("string"!=typeof s)return!1;var u=r(s);if(t(u,l,p))return!0;for(var f=null,m=p;m<d;++m){var g=function(e,t,i,n,s,r){for(var o=Math.min(e.length,n.length),a=-1,l=0;l<o;++l){var c=t[l];if(c!==n[l])return s(e[l],i[l])<0?e.substr(0,l)+i[l]+i.substr(l+1):s(e[l],n[l])<0?e.substr(0,l)+n[l]+i.substr(l+1):0<=a?e.substr(0,a)+t[a]+i.substr(a+1):null;s(e[l],c)<0&&(a=l)}return o<n.length&&"next"===r?e+i.substr(e.length):o<e.length&&"prev"===r?e.substr(0,i.length):a<0?null:e.substr(0,a)+n[a]+i.substr(a+1)}(s,u,a[m],l[m],o,c);null===g&&null===f?p=m+1:(null===f||0<o(f,g))&&(f=g)}return i(null!==f?function(){e.continue(f+h)}:n),!1})),e}function jt(e,t,i,n){return{type:2,lower:e,upper:t,lowerOpen:i,upperOpen:n}}function Rt(e){return{type:1,lower:e,upper:e}}var Lt=(Object.defineProperty(Mt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Mt.prototype.between=function(e,t,i,n){i=!1!==i,n=!0===n;try{return 0<this._cmp(e,t)||0===this._cmp(e,t)&&(i||n)&&(!i||!n)?kt(this):new this.Collection(this,(function(){return jt(e,t,!i,!n)}))}catch(e){return It(this,Qe)}},Mt.prototype.equals=function(e){return null==e?It(this,Qe):new this.Collection(this,(function(){return Rt(e)}))},Mt.prototype.above=function(e){return null==e?It(this,Qe):new this.Collection(this,(function(){return jt(e,void 0,!0)}))},Mt.prototype.aboveOrEqual=function(e){return null==e?It(this,Qe):new this.Collection(this,(function(){return jt(e,void 0,!1)}))},Mt.prototype.below=function(e){return null==e?It(this,Qe):new this.Collection(this,(function(){return jt(void 0,e,!1,!0)}))},Mt.prototype.belowOrEqual=function(e){return null==e?It(this,Qe):new this.Collection(this,(function(){return jt(void 0,e)}))},Mt.prototype.startsWith=function(e){return"string"!=typeof e?It(this,Je):this.between(e,e+Ze,!0,!0)},Mt.prototype.startsWithIgnoreCase=function(e){return""===e?this.startsWith(e):Dt(this,(function(e,t){return 0===e.indexOf(t[0])}),[e],Ze)},Mt.prototype.equalsIgnoreCase=function(e){return Dt(this,(function(e,t){return e===t[0]}),[e],"")},Mt.prototype.anyOfIgnoreCase=function(){var e=P.apply(M,arguments);return 0===e.length?kt(this):Dt(this,(function(e,t){return-1!==t.indexOf(e)}),e,"")},Mt.prototype.startsWithAnyOfIgnoreCase=function(){var e=P.apply(M,arguments);return 0===e.length?kt(this):Dt(this,(function(e,t){return t.some((function(t){return 0===e.indexOf(t)}))}),e,Ze)},Mt.prototype.anyOf=function(){var e=this,t=P.apply(M,arguments),i=this._cmp;try{t.sort(i)}catch(n){return It(this,Qe)}if(0===t.length)return kt(this);var n=new this.Collection(this,(function(){return jt(t[0],t[t.length-1])}));n._ondirectionchange=function(n){i="next"===n?e._ascending:e._descending,t.sort(i)};var s=0;return n._addAlgorithm((function(e,n,r){for(var o=e.key;0<i(o,t[s]);)if(++s===t.length)return n(r),!1;return 0===i(o,t[s])||(n((function(){e.continue(t[s])})),!1)})),n},Mt.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Mt.prototype.noneOf=function(){var e=P.apply(M,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(e){return It(this,Qe)}var t=e.reduce((function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[-1/0,t]]}),null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},Mt.prototype.inAnyRange=function(e,t){var i=this,n=this._cmp,s=this._ascending,r=this._descending,o=this._min,a=this._max;if(0===e.length)return kt(this);if(!e.every((function(e){return void 0!==e[0]&&void 0!==e[1]&&s(e[0],e[1])<=0})))return It(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",q.InvalidArgument);var l,c=!t||!1!==t.includeLowers,h=t&&!0===t.includeUppers,d=s;function u(e,t){return d(e[0],t[0])}try{(l=e.reduce((function(e,t){for(var i=0,s=e.length;i<s;++i){var r=e[i];if(n(t[0],r[1])<0&&0<n(t[1],r[0])){r[0]=o(r[0],t[0]),r[1]=a(r[1],t[1]);break}}return i===s&&e.push(t),e}),[])).sort(u)}catch(e){return It(this,Qe)}var p=0,f=h?function(e){return 0<s(e,l[p][1])}:function(e){return 0<=s(e,l[p][1])},m=c?function(e){return 0<r(e,l[p][0])}:function(e){return 0<=r(e,l[p][0])},g=f;return(e=new this.Collection(this,(function(){return jt(l[0][0],l[l.length-1][1],!c,!h)})))._ondirectionchange=function(e){d="next"===e?(g=f,s):(g=m,r),l.sort(u)},e._addAlgorithm((function(e,t,n){for(var r,o=e.key;g(o);)if(++p===l.length)return t(n),!1;return!f(r=o)&&!m(r)||(0===i._cmp(o,l[p][1])||0===i._cmp(o,l[p][0])||t((function(){d===s?e.continue(l[p][0]):e.continue(l[p][1])})),!1)})),e},Mt.prototype.startsWithAnyOf=function(){var e=P.apply(M,arguments);return e.every((function(e){return"string"==typeof e}))?0===e.length?kt(this):this.inAnyRange(e.map((function(e){return[e,e+Ze]}))):It(this,"startsWithAnyOf() only works with strings")},Mt);function Mt(){}function Pt(e){return Re((function(t){return Nt(t),e(t.target.error),!1}))}function Nt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Ft="storagemutated",Ht="x-storagemutated-1",Bt=pt(null,Ft),zt=(Vt.prototype._lock=function(){return b(!ve.global),++this._reculock,1!==this._reculock||ve.global||(ve.lockOwnerFor=this),this},Vt.prototype._unlock=function(){if(b(!ve.global),0==--this._reculock)for(ve.global||(ve.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{Ge(e[1],e[0])}catch(e){}}return this},Vt.prototype._locked=function(){return this._reculock&&ve.lockOwnerFor!==this},Vt.prototype.create=function(e){var t=this;if(!this.mode)return this;var i=this.db.idbdb,n=this.db._state.dbOpenError;if(b(!this.idbtrans),!e&&!i)switch(n&&n.name){case"DatabaseClosedError":throw new q.DatabaseClosed(n);case"MissingAPIError":throw new q.MissingAPI(n.message,n);default:throw new q.OpenFailed(n)}if(!this.active)throw new q.TransactionInactive;return b(null===this._completion._state),(e=this.idbtrans=e||(this.db.core||i).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Re((function(i){Nt(i),t._reject(e.error)})),e.onabort=Re((function(i){Nt(i),t.active&&t._reject(new q.Abort(e.error)),t.active=!1,t.on("abort").fire(i)})),e.oncomplete=Re((function(){t.active=!1,t._resolve(),"mutatedParts"in e&&Bt.storagemutated.fire(e.mutatedParts)})),this},Vt.prototype._promise=function(e,t,i){var n=this;if("readwrite"===e&&"readwrite"!==this.mode)return Xe(new q.ReadOnly("Transaction is readonly"));if(!this.active)return Xe(new q.TransactionInactive);if(this._locked())return new Ce((function(s,r){n._blockedFuncs.push([function(){n._promise(e,t,i).then(s,r)},ve])}));if(i)return Be((function(){var e=new Ce((function(e,i){n._lock();var s=t(e,i,n);s&&s.then&&s.then(e,i)}));return e.finally((function(){return n._unlock()})),e._lib=!0,e}));var s=new Ce((function(e,i){var s=t(e,i,n);s&&s.then&&s.then(e,i)}));return s._lib=!0,s},Vt.prototype._root=function(){return this.parent?this.parent._root():this},Vt.prototype.waitFor=function(e){var t,i=this._root(),n=Ce.resolve(e);i._waitingFor?i._waitingFor=i._waitingFor.then((function(){return n})):(i._waitingFor=n,i._waitingQueue=[],t=i.idbtrans.objectStore(i.storeNames[0]),function e(){for(++i._spinCount;i._waitingQueue.length;)i._waitingQueue.shift()();i._waitingFor&&(t.get(-1/0).onsuccess=e)}());var s=i._waitingFor;return new Ce((function(e,t){n.then((function(t){return i._waitingQueue.push(Re(e.bind(null,t)))}),(function(e){return i._waitingQueue.push(Re(t.bind(null,e)))})).finally((function(){i._waitingFor===s&&(i._waitingFor=null)}))}))},Vt.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new q.Abort))},Vt.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(h(t,e))return t[e];var i=this.schema[e];if(!i)throw new q.NotFound("Table "+e+" not part of transaction");return(i=new this.db.Table(e,i,this)).core=this.db.core.table(e),t[e]=i},Vt);function Vt(){}function Wt(e,t,i,n,s,r,o){return{name:e,keyPath:t,unique:i,multi:n,auto:s,compound:r,src:(i&&!o?"&":"")+(n?"*":"")+(s?"++":"")+$t(t)}}function $t(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function Ut(e,t,i){return{name:e,primKey:t,indexes:i,mappedClass:null,idxByName:(n=function(e){return[e.name,e]},i.reduce((function(e,t,i){return(i=n(t))&&(e[i[0]]=i[1]),e}),{}))};var n}var qt=function(e){try{return e.only([[]]),qt=function(){return[[]]},[[]]}catch(e){return qt=function(){return Ze},Ze}};function Gt(e){return null==e?function(){}:"string"==typeof e?1===(t=e).split(".").length?function(e){return e[t]}:function(e){return C(e,t)}:function(t){return C(t,e)};var t}function Kt(e){return[].slice.call(e)}var Yt=0;function Xt(e){return null==e?":id":"string"==typeof e?e:"[".concat(e.join("+"),"]")}function Zt(e,t,i){function n(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");var i=e.lower,n=e.upper,s=e.lowerOpen;return e=e.upperOpen,void 0===i?void 0===n?null:t.upperBound(n,!!e):void 0===n?t.lowerBound(i,!!s):t.bound(i,n,!!s,!!e)}var s,r,a,l=(r=i,a=Kt((s=e).objectStoreNames),{schema:{name:s.name,tables:a.map((function(e){return r.objectStore(e)})).map((function(e){var t=e.keyPath,i=e.autoIncrement,n=o(t),s={};return i={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:null==t,compound:n,keyPath:t,autoIncrement:i,unique:!0,extractKey:Gt(t)},indexes:Kt(e.indexNames).map((function(t){return e.index(t)})).map((function(e){var t=e.name,i=e.unique,n=e.multiEntry;return e=e.keyPath,n={name:t,compound:o(e),keyPath:e,unique:i,multiEntry:n,extractKey:Gt(e)},s[Xt(e)]=n})),getIndexByKeyPath:function(e){return s[Xt(e)]}},s[":id"]=i.primaryKey,null!=t&&(s[Xt(t)]=i.primaryKey),i}))},hasGetAll:0<a.length&&"getAll"in r.objectStore(a[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),c=(i=l.schema,l.hasGetAll),h=(l=i.tables.map((function(e){var t,i=e.name;return{name:i,schema:e,mutate:function(e){var t=e.trans,s=e.type,r=e.keys,o=e.values,a=e.range;return new Promise((function(e,l){e=Re(e);var c=t.objectStore(i),h=null==c.keyPath,d="put"===s||"add"===s;if(!d&&"delete"!==s&&"deleteRange"!==s)throw new Error("Invalid operation type: "+s);var u,p=(r||o||{length:1}).length;if(r&&o&&r.length!==o.length)throw new Error("Given keys array must have same length as given values array.");if(0===p)return e({numFailures:0,failures:{},results:[],lastResult:void 0});function f(e){++v,Nt(e)}var m=[],g=[],v=0;if("deleteRange"===s){if(4===a.type)return e({numFailures:v,failures:g,results:[],lastResult:void 0});3===a.type?m.push(u=c.clear()):m.push(u=c.delete(n(a)))}else{var _=(h=d?h?[o,r]:[o,null]:[r,null])[0],b=h[1];if(d)for(var y=0;y<p;++y)m.push(u=b&&void 0!==b[y]?c[s](_[y],b[y]):c[s](_[y])),u.onerror=f;else for(y=0;y<p;++y)m.push(u=c[s](_[y])),u.onerror=f}function C(t){t=t.target.result,m.forEach((function(e,t){return null!=e.error&&(g[t]=e.error)})),e({numFailures:v,failures:g,results:"delete"===s?r:m.map((function(e){return e.result})),lastResult:t})}u.onerror=function(e){f(e),C(e)},u.onsuccess=C}))},getMany:function(e){var t=e.trans,n=e.keys;return new Promise((function(e,s){e=Re(e);for(var r,o=t.objectStore(i),a=n.length,l=new Array(a),c=0,h=0,d=function(t){t=t.target,l[t._pos]=t.result,++h===c&&e(l)},u=Pt(s),p=0;p<a;++p)null!=n[p]&&((r=o.get(n[p]))._pos=p,r.onsuccess=d,r.onerror=u,++c);0===c&&e(l)}))},get:function(e){var t=e.trans,n=e.key;return new Promise((function(e,s){e=Re(e);var r=t.objectStore(i).get(n);r.onsuccess=function(t){return e(t.target.result)},r.onerror=Pt(s)}))},query:(t=c,function(e){return new Promise((function(s,r){s=Re(s);var o,a,l,c=e.trans,h=e.values,d=e.limit,u=e.query,p=d===1/0?void 0:d,f=u.index;if(u=u.range,c=c.objectStore(i),f=f.isPrimaryKey?c:c.index(f.name),u=n(u),0===d)return s({result:[]});t?((p=h?f.getAll(u,p):f.getAllKeys(u,p)).onsuccess=function(e){return s({result:e.target.result})},p.onerror=Pt(r)):(o=0,a=!h&&"openKeyCursor"in f?f.openKeyCursor(u):f.openCursor(u),l=[],a.onsuccess=function(e){var t=a.result;return t?(l.push(h?t.value:t.primaryKey),++o===d?s({result:l}):void t.continue()):s({result:l})},a.onerror=Pt(r))}))}),openCursor:function(e){var t=e.trans,s=e.values,r=e.query,o=e.reverse,a=e.unique;return new Promise((function(e,l){e=Re(e);var c=r.index,h=r.range,d=t.objectStore(i),u=(d=c.isPrimaryKey?d:d.index(c.name),c=o?a?"prevunique":"prev":a?"nextunique":"next",!s&&"openKeyCursor"in d?d.openKeyCursor(n(h),c):d.openCursor(n(h),c));u.onerror=Pt(l),u.onsuccess=Re((function(i){var n,s,r,o,a=u.result;a?(a.___id=++Yt,a.done=!1,n=a.continue.bind(a),s=(s=a.continuePrimaryKey)&&s.bind(a),r=a.advance.bind(a),o=function(){throw new Error("Cursor not stopped")},a.trans=t,a.stop=a.continue=a.continuePrimaryKey=a.advance=function(){throw new Error("Cursor not started")},a.fail=Re(l),a.next=function(){var e=this,t=1;return this.start((function(){return t--?e.continue():e.stop()})).then((function(){return e}))},a.start=function(e){function t(){if(u.result)try{e()}catch(e){a.fail(e)}else a.done=!0,a.start=function(){throw new Error("Cursor behind last entry")},a.stop()}var i=new Promise((function(e,t){e=Re(e),u.onerror=Pt(t),a.fail=t,a.stop=function(t){a.stop=a.continue=a.continuePrimaryKey=a.advance=o,e(t)}}));return u.onsuccess=Re((function(e){u.onsuccess=t,t()})),a.continue=n,a.continuePrimaryKey=s,a.advance=r,t(),i},e(a)):e(null)}),l)}))},count:function(e){var t=e.query,s=e.trans,r=t.index,o=t.range;return new Promise((function(e,t){var a=s.objectStore(i),l=r.isPrimaryKey?a:a.index(r.name);(l=(a=n(o))?l.count(a):l.count()).onsuccess=Re((function(t){return e(t.target.result)})),l.onerror=Pt(t)}))}}})),{});return l.forEach((function(e){return h[e.name]=e})),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(e){if(!h[e])throw new Error("Table '".concat(e,"' not found"));return h[e]},MIN_KEY:-1/0,MAX_KEY:qt(t),schema:i}}function Qt(e,i){var n=i.db;i=function(e,i,n,s){var r=n.IDBKeyRange;return n.indexedDB,{dbcore:(s=Zt(i,r,s),e.dbcore.reduce((function(e,i){return i=i.create,t(t({},e),i(e))}),s))}}(e._middlewares,n,e._deps,i),e.core=i.dbcore,e.tables.forEach((function(t){var i=t.name;e.core.schema.tables.some((function(e){return e.name===i}))&&(t.core=e.core.table(i),e[i]instanceof e.Table&&(e[i].core=t.core))}))}function Jt(e,t,i,n){i.forEach((function(i){var s=n[i];t.forEach((function(t){var n=function e(t,i){return m(t,i)||(t=l(t))&&e(t,i)}(t,i);(!n||"value"in n&&void 0===n.value)&&(t===e.Transaction.prototype||t instanceof e.Transaction?p(t,i,{get:function(){return this.table(i)},set:function(e){u(this,i,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):t[i]=new e.Table(i,s))}))}))}function ei(e,t){t.forEach((function(t){for(var i in t)t[i]instanceof e.Table&&delete t[i]}))}function ti(e,t){return e._cfg.version-t._cfg.version}function ii(e,t){var i,n={del:[],add:[],change:[]};for(i in e)t[i]||n.del.push(i);for(i in t){var s=e[i],r=t[i];if(s){var o={name:i,def:r,recreate:!1,del:[],add:[],change:[]};if(""+(s.primKey.keyPath||"")!=""+(r.primKey.keyPath||"")||s.primKey.auto!==r.primKey.auto)o.recreate=!0,n.change.push(o);else{var a=s.idxByName,l=r.idxByName,c=void 0;for(c in a)l[c]||o.del.push(c);for(c in l){var h=a[c],d=l[c];h?h.src!==d.src&&o.change.push(d):o.add.push(d)}(0<o.del.length||0<o.add.length||0<o.change.length)&&n.change.push(o)}}else n.add.push([i,r])}return n}function ni(e,t,i,n){var s=e.db.createObjectStore(t,i.keyPath?{keyPath:i.keyPath,autoIncrement:i.auto}:{autoIncrement:i.auto});return n.forEach((function(e){return ri(s,e)})),s}function si(e,t){r(e).forEach((function(i){t.db.objectStoreNames.contains(i)||(se&&console.debug("Dexie: Creating missing table",i),ni(t,i,e[i].primKey,e[i].indexes))}))}function ri(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function oi(e,t,i){var n={};return v(t.objectStoreNames,0).forEach((function(e){for(var t=i.objectStore(e),s=Wt($t(a=t.keyPath),a||"",!0,!1,!!t.autoIncrement,a&&"string"!=typeof a,!0),r=[],o=0;o<t.indexNames.length;++o){var a=(l=t.index(t.indexNames[o])).keyPath,l=Wt(l.name,a,!!l.unique,!!l.multiEntry,!1,a&&"string"!=typeof a,!1);r.push(l)}n[e]=Ut(e,s,r)})),n}function ai(e,t,i){for(var n=i.db.objectStoreNames,r=0;r<n.length;++r){var o=n[r],a=i.objectStore(o);e._hasGetAll="getAll"in a;for(var l=0;l<a.indexNames.length;++l){var c=a.indexNames[l],h=a.index(c).keyPath,d="string"==typeof h?h:"["+v(h).join("+")+"]";!t[o]||(h=t[o].idxByName[d])&&(h.name=c,delete t[o].idxByName[d],t[o].idxByName[c]=h)}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&s.WorkerGlobalScope&&s instanceof s.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function li(e){return e.split(",").map((function(e,t){var i=(e=e.trim()).replace(/([&*]|\+\+)/g,""),n=/^\[/.test(i)?i.match(/^\[(.*)\]$/)[1].split("+"):i;return Wt(i,n||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),o(n),0===t)}))}var ci=(hi.prototype._parseStoresSpec=function(e,t){r(e).forEach((function(i){if(null!==e[i]){var n=li(e[i]),s=n.shift();if(s.unique=!0,s.multi)throw new q.Schema("Primary key cannot be multi-valued");n.forEach((function(e){if(e.auto)throw new q.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new q.Schema("Index must have a name and cannot be an empty string")})),t[i]=Ut(i,s,n)}}))},hi.prototype.stores=function(e){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?a(this._cfg.storesSource,e):e,e=t._versions;var i={},n={};return e.forEach((function(e){a(i,e._cfg.storesSource),n=e._cfg.dbschema={},e._parseStoresSpec(i,n)})),t._dbSchema=n,ei(t,[t._allTables,t,t.Transaction.prototype]),Jt(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],r(n),n),t._storeNames=r(n),this},hi.prototype.upgrade=function(e){return this._cfg.contentUpgrade=ne(this._cfg.contentUpgrade||Y,e),this},hi);function hi(){}function di(e,t){var i=e._dbNamesDB;return i||(i=e._dbNamesDB=new Ki(tt,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),i.table("dbnames")}function ui(e){return e&&"function"==typeof e.databases}function pi(e){return Be((function(){return ve.letThrough=!0,e()}))}function fi(e){return!("from"in e)}var mi=function(e,t){if(!this){var i=new mi;return e&&"d"in e&&a(i,e),i}a(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function gi(e,t,i){var n=lt(t,i);if(!isNaN(n)){if(0<n)throw RangeError();if(fi(e))return a(e,{from:t,to:i,d:1});var s=e.l;if(n=e.r,lt(i,e.from)<0)return s?gi(s,t,i):e.l={from:t,to:i,d:1,l:null,r:null},yi(e);if(0<lt(t,e.to))return n?gi(n,t,i):e.r={from:t,to:i,d:1,l:null,r:null},yi(e);lt(t,e.from)<0&&(e.from=t,e.l=null,e.d=n?n.d+1:1),0<lt(i,e.to)&&(e.to=i,e.r=null,e.d=e.l?e.l.d+1:1),i=!e.r,s&&!e.l&&vi(e,s),n&&i&&vi(e,n)}}function vi(e,t){fi(t)||function e(t,i){var n=i.from,s=i.to,r=i.l;i=i.r,gi(t,n,s),r&&e(t,r),i&&e(t,i)}(e,t)}function _i(e,t){var i=bi(t),n=i.next();if(n.done)return!1;for(var s=n.value,r=bi(e),o=r.next(s.from),a=o.value;!n.done&&!o.done;){if(lt(a.from,s.to)<=0&&0<=lt(a.to,s.from))return!0;lt(s.from,a.from)<0?s=(n=i.next(a.from)).value:a=(o=r.next(s.from)).value}return!1}function bi(e){var t=fi(e)?null:{s:0,n:e};return{next:function(e){for(var i=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,i)for(;t.n.l&&lt(e,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!i||lt(e,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function yi(e){var i,n,s=((null===(i=e.r)||void 0===i?void 0:i.d)||0)-((null===(n=e.l)||void 0===n?void 0:n.d)||0),r=1<s?"r":s<-1?"l":"";r&&(i="r"==r?"l":"r",n=t({},e),s=e[r],e.from=s.from,e.to=s.to,e[r]=s[r],n[r]=s[i],(e[i]=n).d=Ci(n)),e.d=Ci(e)}function Ci(e){var t=e.r;return e=e.l,(t?e?Math.max(t.d,e.d):t.d:e?e.d:0)+1}function wi(e,t){return r(t).forEach((function(i){e[i]?vi(e[i],t[i]):e[i]=function e(t){var i,n,s={};for(i in t)h(t,i)&&(n=t[i],s[i]=!n||"object"!=typeof n||A.has(n.constructor)?n:e(n));return s}(t[i])})),e}function Si(e,t){return e.all||t.all||Object.keys(e).some((function(i){return t[i]&&_i(t[i],e[i])}))}d(mi.prototype,((F={add:function(e){return vi(this,e),this},addKey:function(e){return gi(this,e,e),this},addKeys:function(e){var t=this;return e.forEach((function(e){return gi(t,e,e)})),this},hasKey:function(e){var t=bi(this).next(e).value;return t&&lt(t.from,e)<=0&&0<=lt(t.to,e)}})[j]=function(){return bi(this)},F));var Ei={},xi={},Ti=!1;function Ai(e){wi(xi,e),Ti||(Ti=!0,setTimeout((function(){Ti=!1,Oi(xi,!(xi={}))}),0))}function Oi(e,t){void 0===t&&(t=!1);var i=new Set;if(e.all)for(var n=0,s=Object.values(Ei);n<s.length;n++)Ii(o=s[n],e,i,t);else for(var r in e){var o,a=/^idb\:\/\/(.*)\/(.*)\//.exec(r);a&&(r=a[1],a=a[2],(o=Ei["idb://".concat(r,"/").concat(a)])&&Ii(o,e,i,t))}i.forEach((function(e){return e()}))}function Ii(e,t,i,n){for(var s=[],r=0,o=Object.entries(e.queries.query);r<o.length;r++){for(var a=o[r],l=a[0],c=[],h=0,d=a[1];h<d.length;h++){var u=d[h];Si(t,u.obsSet)?u.subscribers.forEach((function(e){return i.add(e)})):n&&c.push(u)}n&&s.push([l,c])}if(n)for(var p=0,f=s;p<f.length;p++){var m=f[p];l=m[0],c=m[1],e.queries.query[l]=c}}function ki(e){var t=e._state,i=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then((function(){return t.dbOpenError?Xe(t.dbOpenError):e}));t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var n=t.openCanceller,s=Math.round(10*e.verno),o=!1;function a(){if(t.openCanceller!==n)throw new q.DatabaseClosed("db.open() was cancelled")}var l,c=t.dbReadyResolve,h=null,d=!1;return Ce.race([n,("undefined"==typeof navigator?Ce.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise((function(e){function t(){return indexedDB.databases().finally(e)}l=setInterval(t,100),t()})).finally((function(){return clearInterval(l)})):Promise.resolve()).then((function n(){return new Ce((function(l,c){if(a(),!i)throw new q.MissingAPI;var u=e.name,p=t.autoSchema||!s?i.open(u):i.open(u,s);if(!p)throw new q.MissingAPI;p.onerror=Pt(c),p.onblocked=Re(e._fireOnBlocked),p.onupgradeneeded=Re((function(n){var s;h=p.transaction,t.autoSchema&&!e._options.allowEmptyDB?(p.onerror=Nt,h.abort(),p.result.close(),(s=i.deleteDatabase(u)).onsuccess=s.onerror=Re((function(){c(new q.NoSuchDatabase("Database ".concat(u," doesnt exist")))}))):(h.onerror=Pt(c),n=n.oldVersion>Math.pow(2,62)?0:n.oldVersion,d=n<1,e.idbdb=p.result,o&&function(e,t){si(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var i=oi(0,e.idbdb,t);ai(e,e._dbSchema,t);for(var n=0,s=ii(i,e._dbSchema).change;n<s.length;n++){var r=function(e){if(e.change.length||e.recreate)return console.warn("Unable to patch indexes of table ".concat(e.name," because it has changes on the type of index or primary key.")),{value:void 0};var i=t.objectStore(e.name);e.add.forEach((function(t){se&&console.debug("Dexie upgrade patch: Creating missing index ".concat(e.name,".").concat(t.src)),ri(i,t)}))}(s[n]);if("object"==typeof r)return r.value}}(e,h),function(e,t,i,n){var s=e._dbSchema;i.objectStoreNames.contains("$meta")&&!s.$meta&&(s.$meta=Ut("$meta",li("")[0],[]),e._storeNames.push("$meta"));var o=e._createTransaction("readwrite",e._storeNames,s);o.create(i),o._completion.catch(n);var a=o._reject.bind(o),l=ve.transless||ve;Be((function(){return ve.trans=o,ve.transless=l,0!==t?(Qt(e,i),c=t,((n=o).storeNames.includes("$meta")?n.table("$meta").get("version").then((function(e){return null!=e?e:c})):Ce.resolve(c)).then((function(t){return s=t,a=o,l=i,c=[],t=(n=e)._versions,h=n._dbSchema=oi(0,n.idbdb,l),0!==(t=t.filter((function(e){return e._cfg.version>=s}))).length?(t.forEach((function(e){c.push((function(){var t=h,i=e._cfg.dbschema;ai(n,t,l),ai(n,i,l),h=n._dbSchema=i;var o=ii(t,i);o.add.forEach((function(e){ni(l,e[0],e[1].primKey,e[1].indexes)})),o.change.forEach((function(e){if(e.recreate)throw new q.Upgrade("Not yet support for changing primary key");var t=l.objectStore(e.name);e.add.forEach((function(e){return ri(t,e)})),e.change.forEach((function(e){t.deleteIndex(e.name),ri(t,e)})),e.del.forEach((function(e){return t.deleteIndex(e)}))}));var c=e._cfg.contentUpgrade;if(c&&e._cfg.version>s){Qt(n,l),a._memoizedTables={};var d=S(i);o.del.forEach((function(e){d[e]=t[e]})),ei(n,[n.Transaction.prototype]),Jt(n,[n.Transaction.prototype],r(d),d),a.schema=d;var u,p=N(c);return p&&ze(),o=Ce.follow((function(){var e;(u=c(a))&&p&&(e=Ve.bind(null,null),u.then(e,e))})),u&&"function"==typeof u.then?Ce.resolve(u):o.then((function(){return u}))}})),c.push((function(t){var i,s,r=e._cfg.dbschema;i=r,s=t,[].slice.call(s.db.objectStoreNames).forEach((function(e){return null==i[e]&&s.db.deleteObjectStore(e)})),ei(n,[n.Transaction.prototype]),Jt(n,[n.Transaction.prototype],n._storeNames,n._dbSchema),a.schema=n._dbSchema})),c.push((function(t){n.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(n.idbdb.version/10)===e._cfg.version?(n.idbdb.deleteObjectStore("$meta"),delete n._dbSchema.$meta,n._storeNames=n._storeNames.filter((function(e){return"$meta"!==e}))):t.objectStore("$meta").put(e._cfg.version,"version"))}))})),function e(){return c.length?Ce.resolve(c.shift()(a.idbtrans)).then(e):Ce.resolve()}().then((function(){si(h,l)}))):Ce.resolve();var n,s,a,l,c,h})).catch(a)):(r(s).forEach((function(e){ni(i,e,s[e].primKey,s[e].indexes)})),Qt(e,i),void Ce.follow((function(){return e.on.populate.fire(o)})).catch(a));var n,c}))}(e,n/10,h,c))}),c),p.onsuccess=Re((function(){h=null;var i,a,c,f,m,g=e.idbdb=p.result,_=v(g.objectStoreNames);if(0<_.length)try{var b=g.transaction(1===(f=_).length?f[0]:f,"readonly");if(t.autoSchema)a=g,c=b,(i=e).verno=a.version/10,c=i._dbSchema=oi(0,a,c),i._storeNames=v(a.objectStoreNames,0),Jt(i,[i._allTables],r(c),c);else if(ai(e,e._dbSchema,b),((m=ii(oi(0,(m=e).idbdb,b),m._dbSchema)).add.length||m.change.some((function(e){return e.add.length||e.change.length})))&&!o)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),g.close(),s=g.version+1,o=!0,l(n());Qt(e,b)}catch(i){}et.push(e),g.onversionchange=Re((function(i){t.vcFired=!0,e.on("versionchange").fire(i)})),g.onclose=Re((function(t){e.on("close").fire(t)})),d&&(m=e._deps,b=u,g=m.indexedDB,m=m.IDBKeyRange,ui(g)||b===tt||di(g,m).put({name:b}).catch(Y)),l()}),c)})).catch((function(e){switch(null==e?void 0:e.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),n();break;case"VersionError":if(0<s)return s=0,n()}return Ce.reject(e)}))}))]).then((function(){return a(),t.onReadyBeingFired=[],Ce.resolve(pi((function(){return e.on.ready.fire(e.vip)}))).then((function i(){if(0<t.onReadyBeingFired.length){var n=t.onReadyBeingFired.reduce(ne,Y);return t.onReadyBeingFired=[],Ce.resolve(pi((function(){return n(e.vip)}))).then(i)}}))})).finally((function(){t.openCanceller===n&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)})).catch((function(i){t.dbOpenError=i;try{h&&h.abort()}catch(i){}return n===t.openCanceller&&e._close(),Xe(i)})).finally((function(){t.openComplete=!0,c()})).then((function(){var t;return d&&(t={},e.tables.forEach((function(i){i.schema.indexes.forEach((function(n){n.name&&(t["idb://".concat(e.name,"/").concat(i.name,"/").concat(n.name)]=new mi(-1/0,[[[]]]))})),t["idb://".concat(e.name,"/").concat(i.name,"/")]=t["idb://".concat(e.name,"/").concat(i.name,"/:dels")]=new mi(-1/0,[[[]]])})),Bt(Ft).fire(t),Oi(t,!0)),e}))}function Di(e){function t(t){return e.next(t)}var i=s(t),n=s((function(t){return e.throw(t)}));function s(e){return function(t){var s=e(t);return t=s.value,s.done?t:t&&"function"==typeof t.then?t.then(i,n):o(t)?Promise.all(t).then(i,n):i(t)}}return s(t)()}function ji(e,t,i){for(var n=o(e)?e.slice():[e],s=0;s<i;++s)n.push(t);return n}var Ri={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return t(t({},e),{table:function(i){var n=e.table(i),s=n.schema,r={},o=[];function a(e,i,n){var s=Xt(e),l=r[s]=r[s]||[],c=null==e?0:"string"==typeof e?1:e.length,h=0<i;return h=t(t({},n),{name:h?"".concat(s,"(virtual-from:").concat(n.name,")"):n.name,lowLevelIndex:n,isVirtual:h,keyTail:i,keyLength:c,extractKey:Gt(e),unique:!h&&n.unique}),l.push(h),h.isPrimaryKey||o.push(h),1<c&&a(2===c?e[0]:e.slice(0,c-1),i+1,n),l.sort((function(e,t){return e.keyTail-t.keyTail})),h}i=a(s.primaryKey.keyPath,0,s.primaryKey),r[":id"]=[i];for(var l=0,c=s.indexes;l<c.length;l++){var h=c[l];a(h.keyPath,0,h)}function d(i){var n,s=i.query.index;return s.isVirtual?t(t({},i),{query:{index:s.lowLevelIndex,range:(n=i.query.range,s=s.keyTail,{type:1===n.type?2:n.type,lower:ji(n.lower,n.lowerOpen?e.MAX_KEY:e.MIN_KEY,s),lowerOpen:!0,upper:ji(n.upper,n.upperOpen?e.MIN_KEY:e.MAX_KEY,s),upperOpen:!0})}}):i}return t(t({},n),{schema:t(t({},s),{primaryKey:i,indexes:o,getIndexByKeyPath:function(e){return(e=r[Xt(e)])&&e[0]}}),count:function(e){return n.count(d(e))},query:function(e){return n.query(d(e))},openCursor:function(t){var i=t.query.index,s=i.keyTail,r=i.isVirtual,o=i.keyLength;return r?n.openCursor(d(t)).then((function(i){return i&&function(i){return Object.create(i,{continue:{value:function(n){null!=n?i.continue(ji(n,t.reverse?e.MAX_KEY:e.MIN_KEY,s)):t.unique?i.continue(i.key.slice(0,o).concat(t.reverse?e.MIN_KEY:e.MAX_KEY,s)):i.continue()}},continuePrimaryKey:{value:function(t,n){i.continuePrimaryKey(ji(t,e.MAX_KEY,s),n)}},primaryKey:{get:function(){return i.primaryKey}},key:{get:function(){var e=i.key;return 1===o?e[0]:e.slice(0,o)}},value:{get:function(){return i.value}}})}(i)})):n.openCursor(t)}})}})}};function Li(e,t,i,n){return i=i||{},n=n||"",r(e).forEach((function(s){var r,o,a;h(t,s)?(r=e[s],o=t[s],"object"==typeof r&&"object"==typeof o&&r&&o?(a=D(r))!==D(o)?i[n+s]=t[s]:"Object"===a?Li(r,o,i,n+s+"."):r!==o&&(i[n+s]=t[s]):r!==o&&(i[n+s]=t[s])):i[n+s]=void 0})),r(t).forEach((function(s){h(e,s)||(i[n+s]=t[s])})),i}function Mi(e,t){return"delete"===t.type?t.keys:t.keys||t.values.map(e.extractKey)}var Pi={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return t(t({},e),{table:function(i){var s=e.table(i),r=s.schema.primaryKey;return t(t({},s),{mutate:function(e){var o=ve.trans,a=o.table(i).hook,l=a.deleting,c=a.creating,d=a.updating;switch(e.type){case"add":if(c.fire===Y)break;return o._promise("readwrite",(function(){return u(e)}),!0);case"put":if(c.fire===Y&&d.fire===Y)break;return o._promise("readwrite",(function(){return u(e)}),!0);case"delete":if(l.fire===Y)break;return o._promise("readwrite",(function(){return u(e)}),!0);case"deleteRange":if(l.fire===Y)break;return o._promise("readwrite",(function(){return function e(i,n,o){return s.query({trans:i,values:!1,query:{index:r,range:n},limit:o}).then((function(s){var r=s.result;return u({type:"delete",keys:r,trans:i}).then((function(s){return 0<s.numFailures?Promise.reject(s.failures[0]):r.length<o?{failures:[],numFailures:0,lastResult:void 0}:e(i,t(t({},n),{lower:r[r.length-1],lowerOpen:!0}),o)}))}))}(e.trans,e.range,1e4)}),!0)}return s.mutate(e);function u(e){var i,o,a,u=ve.trans,p=e.keys||Mi(r,e);if(!p)throw new Error("Keys missing");return"delete"!==(e="add"===e.type||"put"===e.type?t(t({},e),{keys:p}):t({},e)).type&&(e.values=n([],e.values,!0)),e.keys&&(e.keys=n([],e.keys,!0)),i=s,a=p,("add"===(o=e).type?Promise.resolve([]):i.getMany({trans:o.trans,keys:a,cache:"immutable"})).then((function(t){var i=p.map((function(i,n){var s,o,a,p=t[n],f={onerror:null,onsuccess:null};return"delete"===e.type?l.fire.call(f,i,p,u):"add"===e.type||void 0===p?(s=c.fire.call(f,i,e.values[n],u),null==i&&null!=s&&(e.keys[n]=i=s,r.outbound||w(e.values[n],r.keyPath,i))):(s=Li(p,e.values[n]),(o=d.fire.call(f,s,i,p,u))&&(a=e.values[n],Object.keys(o).forEach((function(e){h(a,e)?a[e]=o[e]:w(a,e,o[e])})))),f}));return s.mutate(e).then((function(n){for(var s=n.failures,r=n.results,o=n.numFailures,a=(n=n.lastResult,0);a<p.length;++a){var l=(r||p)[a],c=i[a];null==l?c.onerror&&c.onerror(s[a]):c.onsuccess&&c.onsuccess("put"===e.type&&t[a]?e.values[a]:l)}return{failures:s,results:r,numFailures:o,lastResult:n}})).catch((function(e){return i.forEach((function(t){return t.onerror&&t.onerror(e)})),Promise.reject(e)}))}))}}})}})}};function Ni(e,t,i){try{if(!t)return null;if(t.keys.length<e.length)return null;for(var n=[],s=0,r=0;s<t.keys.length&&r<e.length;++s)0===lt(t.keys[s],e[r])&&(n.push(i?I(t.values[s]):t.values[s]),++r);return n.length===e.length?n:null}catch(e){return null}}var Fi={stack:"dbcore",level:-1,create:function(e){return{table:function(i){var n=e.table(i);return t(t({},n),{getMany:function(e){if(!e.cache)return n.getMany(e);var t=Ni(e.keys,e.trans._cache,"clone"===e.cache);return t?Ce.resolve(t):n.getMany(e).then((function(t){return e.trans._cache={keys:e.keys,values:"clone"===e.cache?I(t):t},t}))},mutate:function(e){return"add"!==e.type&&(e.trans._cache=null),n.mutate(e)}})}}}};function Hi(e,t){return"readonly"===e.trans.mode&&!!e.subscr&&!e.trans.explicit&&"disabled"!==e.trans.db._options.cache&&!t.schema.primaryKey.outbound}function Bi(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var zi={stack:"dbcore",level:0,name:"Observability",create:function(e){var i=e.schema.name,n=new mi(e.MIN_KEY,e.MAX_KEY);return t(t({},e),{transaction:function(t,i,n){if(ve.subscr&&"readonly"!==i)throw new q.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(ve.querier));return e.transaction(t,i,n)},table:function(s){var a=e.table(s),l=a.schema,c=l.primaryKey,h=l.indexes,d=c.extractKey,u=c.outbound,p=c.autoIncrement&&h.filter((function(e){return e.compound&&e.keyPath.includes(c.keyPath)})),f=t(t({},a),{mutate:function(t){function r(e){return e="idb://".concat(i,"/").concat(s,"/").concat(e),m[e]||(m[e]=new mi)}var h,d,u,f=t.trans,m=t.mutatedParts||(t.mutatedParts={}),g=r(""),v=r(":dels"),_=t.type,b="deleteRange"===t.type?[t.range]:"delete"===t.type?[t.keys]:t.values.length<50?[Mi(c,t).filter((function(e){return e})),t.values]:[],y=b[0],C=b[1];return b=t.trans._cache,o(y)?(g.addKeys(y),(b="delete"===_||y.length===C.length?Ni(y,b):null)||v.addKeys(y),(b||C)&&(h=r,d=b,u=C,l.indexes.forEach((function(e){var t=h(e.name||"");function i(t){return null!=t?e.extractKey(t):null}function n(i){return e.multiEntry&&o(i)?i.forEach((function(e){return t.addKey(e)})):t.addKey(i)}(d||u).forEach((function(e,t){var s=d&&i(d[t]);0!==lt(s,t=u&&i(u[t]))&&(null!=s&&n(s),null!=t&&n(t))}))})))):y?(C={from:null!==(C=y.lower)&&void 0!==C?C:e.MIN_KEY,to:null!==(C=y.upper)&&void 0!==C?C:e.MAX_KEY},v.add(C),g.add(C)):(g.add(n),v.add(n),l.indexes.forEach((function(e){return r(e.name).add(n)}))),a.mutate(t).then((function(e){return!y||"add"!==t.type&&"put"!==t.type||(g.addKeys(e.results),p&&p.forEach((function(i){var n=t.values.map((function(e){return i.extractKey(e)})),s=i.keyPath.findIndex((function(e){return e===c.keyPath}));e.results.forEach((function(e){return n[s]=e})),r(i.name).addKeys(n)}))),f.mutatedParts=wi(f.mutatedParts||{},m),e}))}}),m=(h=function(t){t=(i=t.query).index;var i=i.range;return[t,new mi(null!==(t=i.lower)&&void 0!==t?t:e.MIN_KEY,null!==(i=i.upper)&&void 0!==i?i:e.MAX_KEY)]},{get:function(e){return[c,new mi(e.key)]},getMany:function(e){return[c,(new mi).addKeys(e.keys)]},count:h,query:h,openCursor:h});return r(m).forEach((function(e){f[e]=function(r){var o=!!(f=ve.subscr),l=Hi(ve,a)&&Bi(e,r)?r.obsSet={}:f;if(o){var c=function(e){return e="idb://".concat(i,"/").concat(s,"/").concat(e),l[e]||(l[e]=new mi)},h=c(""),p=c(":dels"),f=(o=(f=m[e](r))[0],f[1]);if(("query"===e&&o.isPrimaryKey&&!r.values?p:c(o.name||"")).add(f),!o.isPrimaryKey){if("count"!==e){var g="query"===e&&u&&r.values&&a.query(t(t({},r),{values:!1}));return a[e].apply(this,arguments).then((function(t){if("query"===e){if(u&&r.values)return g.then((function(e){return e=e.result,h.addKeys(e),t}));var i=r.values?t.result.map(d):t.result;(r.values?h:p).addKeys(i)}else if("openCursor"===e){var n=t,s=r.values;return n&&Object.create(n,{key:{get:function(){return p.addKey(n.primaryKey),n.key}},primaryKey:{get:function(){var e=n.primaryKey;return p.addKey(e),e}},value:{get:function(){return s&&h.addKey(n.primaryKey),n.value}}})}return t}))}p.add(n)}}return a[e].apply(this,arguments)}})),f}})}};function Vi(e,i,n){if(0===n.numFailures)return i;if("deleteRange"===i.type)return null;var s=i.keys?i.keys.length:"values"in i&&i.values?i.values.length:1;return n.numFailures===s?null:(i=t({},i),o(i.keys)&&(i.keys=i.keys.filter((function(e,t){return!(t in n.failures)}))),"values"in i&&o(i.values)&&(i.values=i.values.filter((function(e,t){return!(t in n.failures)}))),i)}function Wi(e,t){return i=e,(void 0===(n=t).lower||(n.lowerOpen?0<lt(i,n.lower):0<=lt(i,n.lower)))&&(void 0===t.upper||(t.upperOpen?lt(e,t.upper)<0:lt(e,t.upper)<=0));var i,n}function $i(e,t,i,n,s,r){if(!i||0===i.length)return e;var a=t.query.index,l=a.multiEntry,c=t.query.range,h=n.schema.primaryKey.extractKey,d=a.extractKey,u=(a.lowLevelIndex||a).extractKey;return i=i.reduce((function(e,i){var n=e,s=[];if("add"===i.type||"put"===i.type)for(var r=new mi,a=i.values.length-1;0<=a;--a){var u,p=i.values[a],f=h(p);r.hasKey(f)||(u=d(p),(l&&o(u)?u.some((function(e){return Wi(e,c)})):Wi(u,c))&&(r.addKey(f),s.push(p)))}switch(i.type){case"add":var m=(new mi).addKeys(t.values?e.map((function(e){return h(e)})):e);n=e.concat(t.values?s.filter((function(e){return e=h(e),!m.hasKey(e)&&(m.addKey(e),!0)})):s.map((function(e){return h(e)})).filter((function(e){return!m.hasKey(e)&&(m.addKey(e),!0)})));break;case"put":var g=(new mi).addKeys(i.values.map((function(e){return h(e)})));n=e.filter((function(e){return!g.hasKey(t.values?h(e):e)})).concat(t.values?s:s.map((function(e){return h(e)})));break;case"delete":var v=(new mi).addKeys(i.keys);n=e.filter((function(e){return!v.hasKey(t.values?h(e):e)}));break;case"deleteRange":var _=i.range;n=e.filter((function(e){return!Wi(h(e),_)}))}return n}),e),i===e?e:(i.sort((function(e,t){return lt(u(e),u(t))||lt(h(e),h(t))})),t.limit&&t.limit<1/0&&(i.length>t.limit?i.length=t.limit:e.length===t.limit&&i.length<t.limit&&(s.dirty=!0)),r?Object.freeze(i):i)}function Ui(e,t){return 0===lt(e.lower,t.lower)&&0===lt(e.upper,t.upper)&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}var qi={stack:"dbcore",level:0,name:"Cache",create:function(e){var i=e.schema.name;return t(t({},e),{transaction:function(t,n,s){var r,o,a=e.transaction(t,n,s);return"readwrite"===n&&(o=(r=new AbortController).signal,s=function(s){return function(){if(r.abort(),"readwrite"===n){for(var o=new Set,l=0,c=t;l<c.length;l++){var h=c[l],d=Ei["idb://".concat(i,"/").concat(h)];if(d){var u=e.table(h),p=d.optimisticOps.filter((function(e){return e.trans===a}));if(a._explicit&&s&&a.mutatedParts)for(var f=0,m=Object.values(d.queries.query);f<m.length;f++)for(var g=0,v=(y=m[f]).slice();g<v.length;g++)Si((C=v[g]).obsSet,a.mutatedParts)&&(L(y,C),C.subscribers.forEach((function(e){return o.add(e)})));else if(0<p.length){d.optimisticOps=d.optimisticOps.filter((function(e){return e.trans!==a}));for(var _=0,b=Object.values(d.queries.query);_<b.length;_++)for(var y,C,w,S=0,E=(y=b[_]).slice();S<E.length;S++)null!=(C=E[S]).res&&a.mutatedParts&&(s&&!C.dirty?(w=Object.isFrozen(C.res),w=$i(C.res,C.req,p,u,C,w),C.dirty?(L(y,C),C.subscribers.forEach((function(e){return o.add(e)}))):w!==C.res&&(C.res=w,C.promise=Ce.resolve({result:w}))):(C.dirty&&L(y,C),C.subscribers.forEach((function(e){return o.add(e)}))))}}}o.forEach((function(e){return e()}))}}},a.addEventListener("abort",s(!1),{signal:o}),a.addEventListener("error",s(!1),{signal:o}),a.addEventListener("complete",s(!0),{signal:o})),a},table:function(n){var s=e.table(n),r=s.schema.primaryKey;return t(t({},s),{mutate:function(e){var o=ve.trans;if(r.outbound||"disabled"===o.db._options.cache||o.explicit||"readwrite"!==o.idbtrans.mode)return s.mutate(e);var a=Ei["idb://".concat(i,"/").concat(n)];return a?(o=s.mutate(e),"add"!==e.type&&"put"!==e.type||!(50<=e.values.length||Mi(r,e).some((function(e){return null==e})))?(a.optimisticOps.push(e),e.mutatedParts&&Ai(e.mutatedParts),o.then((function(t){0<t.numFailures&&(L(a.optimisticOps,e),(t=Vi(0,e,t))&&a.optimisticOps.push(t),e.mutatedParts&&Ai(e.mutatedParts))})),o.catch((function(){L(a.optimisticOps,e),e.mutatedParts&&Ai(e.mutatedParts)}))):o.then((function(i){var n=Vi(0,t(t({},e),{values:e.values.map((function(e,n){var s;return i.failures[n]||w(e=null!==(s=r.keyPath)&&void 0!==s&&s.includes(".")?I(e):t({},e),r.keyPath,i.results[n]),e}))}),i);a.optimisticOps.push(n),queueMicrotask((function(){return e.mutatedParts&&Ai(e.mutatedParts)}))})),o):s.mutate(e)},query:function(e){if(!Hi(ve,s)||!Bi("query",e))return s.query(e);var t="immutable"===(null===(a=ve.trans)||void 0===a?void 0:a.db._options.cache),r=(c=ve).requery,o=c.signal,a=function(e,t,i,n){var s=Ei["idb://".concat(e,"/").concat(t)];if(!s)return[];if(!(t=s.queries[i]))return[null,!1,s,null];var r=t[(n.query?n.query.index.name:null)||""];if(!r)return[null,!1,s,null];switch(i){case"query":var o=r.find((function(e){return e.req.limit===n.limit&&e.req.values===n.values&&Ui(e.req.query.range,n.query.range)}));return o?[o,!0,s,r]:[r.find((function(e){return("limit"in e.req?e.req.limit:1/0)>=n.limit&&(!n.values||e.req.values)&&function(e,t){return function(e,t,i,n){if(void 0===e)return void 0!==t?-1:0;if(void 0===t)return 1;if(0===(t=lt(e,t))){if(i&&n)return 0;if(i)return 1;if(n)return-1}return t}(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=function(e,t,i,n){if(void 0===e)return void 0!==t?1:0;if(void 0===t)return-1;if(0===(t=lt(e,t))){if(i&&n)return 0;if(i)return-1;if(n)return 1}return t}(e.upper,t.upper,e.upperOpen,t.upperOpen)}(e.req.query.range,n.query.range)})),!1,s,r];case"count":return o=r.find((function(e){return Ui(e.req.query.range,n.query.range)})),[o,!!o,s,r]}}(i,n,"query",e),l=a[0],c=a[1],h=a[2],d=a[3];return l&&c?l.obsSet=e.obsSet:(c=s.query(e).then((function(e){var i=e.result;if(l&&(l.res=i),t){for(var n=0,s=i.length;n<s;++n)Object.freeze(i[n]);Object.freeze(i)}else e.result=I(i);return e})).catch((function(e){return d&&l&&L(d,l),Promise.reject(e)})),l={obsSet:e.obsSet,promise:c,subscribers:new Set,type:"query",req:e,dirty:!1},d?d.push(l):(d=[l],(h=h||(Ei["idb://".concat(i,"/").concat(n)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[e.query.index.name||""]=d)),function(e,t,i,n){e.subscribers.add(i),n.addEventListener("abort",(function(){var n,s;e.subscribers.delete(i),0===e.subscribers.size&&(n=e,s=t,setTimeout((function(){0===n.subscribers.size&&L(s,n)}),3e3))}))}(l,d,r,o),l.promise.then((function(i){return{result:$i(i.result,e,null==h?void 0:h.optimisticOps,s,l,t)}}))}})}})}};function Gi(e,t){return new Proxy(e,{get:function(e,i,n){return"db"===i?t:Reflect.get(e,i,n)}})}var Ki=(Yi.prototype.version=function(e){if(isNaN(e)||e<.1)throw new q.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new q.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,i=t.filter((function(t){return t._cfg.version===e}))[0];return i||(i=new this.Version(e),t.push(i),t.sort(ti),i.stores({}),this._state.autoSchema=!1,i)},Yi.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||ve.letThrough||this._vip)?e():new Ce((function(e,i){if(t._state.openComplete)return i(new q.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void i(new q.DatabaseClosed);t.open().catch(Y)}t._state.dbReadyPromise.then(e,i)})).then(e)},Yi.prototype.use=function(e){var t=e.stack,i=e.create,n=e.level,s=e.name;return s&&this.unuse({stack:t,name:s}),(e=this._middlewares[t]||(this._middlewares[t]=[])).push({stack:t,create:i,level:null==n?10:n,name:s}),e.sort((function(e,t){return e.level-t.level})),this},Yi.prototype.unuse=function(e){var t=e.stack,i=e.name,n=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter((function(e){return n?e.create!==n:!!i&&e.name!==i}))),this},Yi.prototype.open=function(){var e=this;return Ge(ge,(function(){return ki(e)}))},Yi.prototype._close=function(){var e=this._state,t=et.indexOf(this);if(0<=t&&et.splice(t,1),this.idbdb){try{this.idbdb.close()}catch(t){}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new Ce((function(t){e.dbReadyResolve=t})),e.openCanceller=new Ce((function(t,i){e.cancelOpen=i})))},Yi.prototype.close=function(e){var t=(void 0===e?{disableAutoOpen:!0}:e).disableAutoOpen;e=this._state,t?(e.isBeingOpened&&e.cancelOpen(new q.DatabaseClosed),this._close(),e.autoOpen=!1,e.dbOpenError=new q.DatabaseClosed):(this._close(),e.autoOpen=this._options.autoOpen||e.isBeingOpened,e.openComplete=!1,e.dbOpenError=null)},Yi.prototype.delete=function(e){var t=this;void 0===e&&(e={disableAutoOpen:!0});var i=0<arguments.length&&"object"!=typeof arguments[0],n=this._state;return new Ce((function(s,r){function o(){t.close(e);var i=t._deps.indexedDB.deleteDatabase(t.name);i.onsuccess=Re((function(){var e,i,n;e=t._deps,i=t.name,n=e.indexedDB,e=e.IDBKeyRange,ui(n)||i===tt||di(n,e).delete(i).catch(Y),s()})),i.onerror=Pt(r),i.onblocked=t._fireOnBlocked}if(i)throw new q.InvalidArgument("Invalid closeOptions argument to db.delete()");n.isBeingOpened?n.dbReadyPromise.then(o):o()}))},Yi.prototype.backendDB=function(){return this.idbdb},Yi.prototype.isOpen=function(){return null!==this.idbdb},Yi.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name},Yi.prototype.hasFailed=function(){return null!==this._state.dbOpenError},Yi.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Yi.prototype,"tables",{get:function(){var e=this;return r(this._allTables).map((function(t){return e._allTables[t]}))},enumerable:!1,configurable:!0}),Yi.prototype.transaction=function(){var e=function(e,t,i){var n=arguments.length;if(n<2)throw new q.InvalidArgument("Too few arguments");for(var s=new Array(n-1);--n;)s[n-1]=arguments[n];return i=s.pop(),[e,x(s),i]}.apply(this,arguments);return this._transaction.apply(this,e)},Yi.prototype._transaction=function(e,t,i){var n=this,s=ve.trans;s&&s.db===this&&-1===e.indexOf("!")||(s=null);var r,o,a=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{if(o=t.map((function(e){if("string"!=typeof(e=e instanceof n.Table?e.name:e))throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return e})),"r"==e||e===it)r=it;else{if("rw"!=e&&e!=nt)throw new q.InvalidArgument("Invalid transaction mode: "+e);r=nt}if(s){if(s.mode===it&&r===nt){if(!a)throw new q.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");s=null}s&&o.forEach((function(e){if(s&&-1===s.storeNames.indexOf(e)){if(!a)throw new q.SubTransaction("Table "+e+" not included in parent transaction.");s=null}})),a&&s&&!s.active&&(s=null)}}catch(i){return s?s._promise(null,(function(e,t){t(i)})):Xe(i)}var l=function e(t,i,n,s,r){return Ce.resolve().then((function(){var o=ve.transless||ve,a=t._createTransaction(i,n,t._dbSchema,s);if(a.explicit=!0,o={trans:a,transless:o},s)a.idbtrans=s.idbtrans;else try{a.create(),a.idbtrans._explicit=!0,t._state.PR1398_maxLoop=3}catch(o){return o.name===$.InvalidState&&t.isOpen()&&0<--t._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),t.close({disableAutoOpen:!1}),t.open().then((function(){return e(t,i,n,null,r)}))):Xe(o)}var l,c=N(r);return c&&ze(),o=Ce.follow((function(){var e;(l=r.call(a,a))&&(c?(e=Ve.bind(null,null),l.then(e,e)):"function"==typeof l.next&&"function"==typeof l.throw&&(l=Di(l)))}),o),(l&&"function"==typeof l.then?Ce.resolve(l).then((function(e){return a.active?e:Xe(new q.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))})):o.then((function(){return l}))).then((function(e){return s&&a._resolve(),a._completion.then((function(){return e}))})).catch((function(e){return a._reject(e),Xe(e)}))}))}.bind(null,this,r,o,s,i);return s?s._promise(r,l,"lock"):ve.trans?Ge(ve.transless,(function(){return n._whenReady(l)})):this._whenReady(l)},Yi.prototype.table=function(e){if(!h(this._allTables,e))throw new q.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},Yi);function Yi(e,i){var n=this;this._middlewares={},this.verno=0;var s=Yi.dependencies;this._options=i=t({addons:Yi.addons,autoOpen:!0,indexedDB:s.indexedDB,IDBKeyRange:s.IDBKeyRange,cache:"cloned"},i),this._deps={indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},s=i.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var r,o,a,l,c,h={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Y,dbReadyPromise:null,cancelOpen:Y,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:i.autoOpen};h.dbReadyPromise=new Ce((function(e){h.dbReadyResolve=e})),h.openCanceller=new Ce((function(e,t){h.cancelOpen=t})),this._state=h,this.name=e,this.on=pt(this,"populate","blocked","versionchange","close",{ready:[ne,Y]}),this.on.ready.subscribe=_(this.on.ready.subscribe,(function(e){return function(t,i){Yi.vip((function(){var s,r=n._state;r.openComplete?(r.dbOpenError||Ce.resolve().then(t),i&&e(t)):r.onReadyBeingFired?(r.onReadyBeingFired.push(t),i&&e(t)):(e(t),s=n,i||e((function e(){s.on.ready.unsubscribe(t),s.on.ready.unsubscribe(e)})))}))}})),this.Collection=(r=this,ft(Et.prototype,(function(e,t){this.db=r;var i=rt,n=null;if(t)try{i=t()}catch(e){n=e}var s=e._ctx;e=(t=s.table).hook.reading.fire,this._ctx={table:t,index:s.index,isPrimKey:!s.index||t.schema.primKey.keyPath&&s.index===t.schema.primKey.name,range:i,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:n,or:s.or,valueMapper:e!==X?e:null}}))),this.Table=(o=this,ft(dt.prototype,(function(e,t,i){this.db=o,this._tx=i,this.name=e,this.schema=t,this.hook=o._allTables[e]?o._allTables[e].hook:pt(null,{creating:[J,Y],reading:[Z,X],updating:[te,Y],deleting:[ee,Y]})}))),this.Transaction=(a=this,ft(zt.prototype,(function(e,t,i,n,s){var r=this;this.db=a,this.mode=e,this.storeNames=t,this.schema=i,this.chromeTransactionDurability=n,this.idbtrans=null,this.on=pt(this,"complete","error","abort"),this.parent=s||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Ce((function(e,t){r._resolve=e,r._reject=t})),this._completion.then((function(){r.active=!1,r.on.complete.fire()}),(function(e){var t=r.active;return r.active=!1,r.on.error.fire(e),r.parent?r.parent._reject(e):t&&r.idbtrans&&r.idbtrans.abort(),Xe(e)}))}))),this.Version=(l=this,ft(ci.prototype,(function(e){this.db=l,this._cfg={version:e,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))),this.WhereClause=(c=this,ft(Lt.prototype,(function(e,t,i){if(this.db=c,this._ctx={table:e,index:":id"===t?null:t,or:i},this._cmp=this._ascending=lt,this._descending=function(e,t){return lt(t,e)},this._max=function(e,t){return 0<lt(e,t)?e:t},this._min=function(e,t){return lt(e,t)<0?e:t},this._IDBKeyRange=c._deps.IDBKeyRange,!this._IDBKeyRange)throw new q.MissingAPI}))),this.on("versionchange",(function(e){0<e.newVersion?console.warn("Another connection wants to upgrade database '".concat(n.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(n.name,"'. Closing db now to resume the delete request.")),n.close({disableAutoOpen:!1})})),this.on("blocked",(function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn("Dexie.delete('".concat(n.name,"') was blocked")):console.warn("Upgrade '".concat(n.name,"' blocked by other connection holding version ").concat(e.oldVersion/10))})),this._maxKey=qt(i.IDBKeyRange),this._createTransaction=function(e,t,i,s){return new n.Transaction(e,t,i,n._options.chromeTransactionDurability,s)},this._fireOnBlocked=function(e){n.on("blocked").fire(e),et.filter((function(e){return e.name===n.name&&e!==n&&!e._state.vcFired})).map((function(t){return t.on("versionchange").fire(e)}))},this.use(Fi),this.use(qi),this.use(zi),this.use(Ri),this.use(Pi);var d=new Proxy(this,{get:function(e,t,i){if("_vip"===t)return!0;if("table"===t)return function(e){return Gi(n.table(e),d)};var s=Reflect.get(e,t,i);return s instanceof dt?Gi(s,d):"tables"===t?s.map((function(e){return Gi(e,d)})):"_createTransaction"===t?function(){return Gi(s.apply(this,arguments),d)}:s}});this.vip=d,s.forEach((function(e){return e(n)}))}F="undefined"!=typeof Symbol&&"observable"in Symbol?Symbol.observable:"@@observable";var Xi,Zi=(Qi.prototype.subscribe=function(e,t,i){return this._subscribe(e&&"function"!=typeof e?e:{next:e,error:t,complete:i})},Qi.prototype[F]=function(){return this},Qi);function Qi(e){this._subscribe=e}try{Xi={indexedDB:s.indexedDB||s.mozIndexedDB||s.webkitIndexedDB||s.msIndexedDB,IDBKeyRange:s.IDBKeyRange||s.webkitIDBKeyRange}}catch(T){Xi={indexedDB:null,IDBKeyRange:null}}function Ji(e){var t,i=!1,n=new Zi((function(n){var s,r=N(e),o=!1,a={},l={},c={get closed(){return o},unsubscribe:function(){o||(o=!0,s&&s.abort(),d&&Bt.storagemutated.unsubscribe(p))}};n.start&&n.start(c);var d=!1,u=function(){return Ye(f)},p=function(e){wi(a,e),Si(l,a)&&u()},f=function(){var c,f,m;!o&&Xi.indexedDB&&(a={},c={},s&&s.abort(),s=new AbortController,m=function(t){var i=Ie();try{r&&ze();var n=Be(e,t);return n=r?n.finally(Ve):n}finally{i&&ke()}}(f={subscr:c,signal:s.signal,requery:u,querier:e,trans:null}),Promise.resolve(m).then((function(e){i=!0,t=e,o||f.signal.aborted||(a={},function(e){for(var t in e)if(h(e,t))return;return 1}(l=c)||d||(Bt(Ft,p),d=!0),Ye((function(){return!o&&n.next&&n.next(e)})))}),(function(e){i=!1,["DatabaseClosedError","AbortError"].includes(null==e?void 0:e.name)||o||Ye((function(){o||n.error&&n.error(e)}))})))};return setTimeout(u,0),c}));return n.hasValue=function(){return i},n.getValue=function(){return t},n}var en=Ki;function tn(e){var t=sn;try{sn=!0,Bt.storagemutated.fire(e),Oi(e,!0)}finally{sn=t}}d(en,t(t({},K),{delete:function(e){return new en(e,{addons:[]}).delete()},exists:function(e){return new en(e,{addons:[]}).open().then((function(e){return e.close(),!0})).catch("NoSuchDatabaseError",(function(){return!1}))},getDatabaseNames:function(e){try{return i=(t=en.dependencies).indexedDB,t=t.IDBKeyRange,(ui(i)?Promise.resolve(i.databases()).then((function(e){return e.map((function(e){return e.name})).filter((function(e){return e!==tt}))})):di(i,t).toCollection().primaryKeys()).then(e)}catch(e){return Xe(new q.MissingAPI)}var t,i},defineClass:function(){return function(e){a(this,e)}},ignoreTransaction:function(e){return ve.trans?Ge(ve.transless,e):e()},vip:pi,async:function(e){return function(){try{var t=Di(e.apply(this,arguments));return t&&"function"==typeof t.then?t:Ce.resolve(t)}catch(t){return Xe(t)}}},spawn:function(e,t,i){try{var n=Di(e.apply(i,t||[]));return n&&"function"==typeof n.then?n:Ce.resolve(n)}catch(e){return Xe(e)}},currentTransaction:{get:function(){return ve.trans||null}},waitFor:function(e,t){return t=Ce.resolve("function"==typeof e?en.ignoreTransaction(e):e).timeout(t||6e4),ve.trans?ve.trans.waitFor(t):t},Promise:Ce,debug:{get:function(){return se},set:function(e){re(e)}},derive:f,extend:a,props:d,override:_,Events:pt,on:Bt,liveQuery:Ji,extendObservabilitySet:wi,getByKeyPath:C,setByKeyPath:w,delByKeyPath:function(e,t){"string"==typeof t?w(e,t,void 0):"length"in t&&[].map.call(t,(function(t){w(e,t,void 0)}))},shallowClone:S,deepClone:I,getObjectDiff:Li,cmp:lt,asap:y,minKey:-1/0,addons:[],connections:et,errnames:$,dependencies:Xi,cache:Ei,semVer:"4.0.9",version:"4.0.9".split(".").map((function(e){return parseInt(e)})).reduce((function(e,t,i){return e+t/Math.pow(10,2*i)}))})),en.maxKey=qt(en.dependencies.IDBKeyRange),"undefined"!=typeof dispatchEvent&&"undefined"!=typeof addEventListener&&(Bt(Ft,(function(e){sn||(e=new CustomEvent(Ht,{detail:e}),sn=!0,dispatchEvent(e),sn=!1)})),addEventListener(Ht,(function(e){e=e.detail,sn||tn(e)})));var nn,sn=!1,rn=function(){};return"undefined"!=typeof BroadcastChannel&&((rn=function(){(nn=new BroadcastChannel(Ht)).onmessage=function(e){return e.data&&tn(e.data)}})(),"function"==typeof nn.unref&&nn.unref(),Bt(Ft,(function(e){sn||nn.postMessage(e)}))),"undefined"!=typeof addEventListener&&(addEventListener("pagehide",(function(e){if(!Ki.disableBfCache&&e.persisted){se&&console.debug("Dexie: handling persisted pagehide"),null!=nn&&nn.close();for(var t=0,i=et;t<i.length;t++)i[t].close({disableAutoOpen:!1})}})),addEventListener("pageshow",(function(e){!Ki.disableBfCache&&e.persisted&&(se&&console.debug("Dexie: handling persisted pageshow"),rn(),tn({all:new mi(-1/0,[[]])}))}))),Ce.rejectionMapper=function(e,t){return!e||e instanceof B||e instanceof TypeError||e instanceof SyntaxError||!e.name||!G[e.name]?e:(t=new G[e.name](t||e.message,e),"stack"in e&&p(t,"stack",{get:function(){return this.inner.stack}}),t)},re(se),t(Ki,Object.freeze({__proto__:null,Dexie:Ki,liveQuery:Ji,Entity:at,cmp:lt,PropModSymbol:T,PropModification:wt,replacePrefix:function(e,t){return new wt({replacePrefix:[e,t]})},add:function(e){return new wt({add:e})},remove:function(e){return new wt({remove:e})},default:Ki,RangeSet:mi,mergeRanges:vi,rangesOverlap:_i}),{default:Ki}),Ki}()},189:e=>{var t=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32},i=-1;t.Diff=function(e,t){return[e,t]},t.prototype.diff_main=function(e,i,n,s){void 0===s&&(s=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var r=s;if(null==e||null==i)throw new Error("Null input. (diff_main)");if(e==i)return e?[new t.Diff(0,e)]:[];void 0===n&&(n=!0);var o=n,a=this.diff_commonPrefix(e,i),l=e.substring(0,a);e=e.substring(a),i=i.substring(a),a=this.diff_commonSuffix(e,i);var c=e.substring(e.length-a);e=e.substring(0,e.length-a),i=i.substring(0,i.length-a);var h=this.diff_compute_(e,i,o,r);return l&&h.unshift(new t.Diff(0,l)),c&&h.push(new t.Diff(0,c)),this.diff_cleanupMerge(h),h},t.prototype.diff_compute_=function(e,n,s,r){var o;if(!e)return[new t.Diff(1,n)];if(!n)return[new t.Diff(i,e)];var a=e.length>n.length?e:n,l=e.length>n.length?n:e,c=a.indexOf(l);if(-1!=c)return o=[new t.Diff(1,a.substring(0,c)),new t.Diff(0,l),new t.Diff(1,a.substring(c+l.length))],e.length>n.length&&(o[0][0]=o[2][0]=i),o;if(1==l.length)return[new t.Diff(i,e),new t.Diff(1,n)];var h=this.diff_halfMatch_(e,n);if(h){var d=h[0],u=h[1],p=h[2],f=h[3],m=h[4],g=this.diff_main(d,p,s,r),v=this.diff_main(u,f,s,r);return g.concat([new t.Diff(0,m)],v)}return s&&e.length>100&&n.length>100?this.diff_lineMode_(e,n,r):this.diff_bisect_(e,n,r)},t.prototype.diff_lineMode_=function(e,n,s){var r=this.diff_linesToChars_(e,n);e=r.chars1,n=r.chars2;var o=r.lineArray,a=this.diff_main(e,n,!1,s);this.diff_charsToLines_(a,o),this.diff_cleanupSemantic(a),a.push(new t.Diff(0,""));for(var l=0,c=0,h=0,d="",u="";l<a.length;){switch(a[l][0]){case 1:h++,u+=a[l][1];break;case i:c++,d+=a[l][1];break;case 0:if(c>=1&&h>=1){a.splice(l-c-h,c+h),l=l-c-h;for(var p=this.diff_main(d,u,!1,s),f=p.length-1;f>=0;f--)a.splice(l,0,p[f]);l+=p.length}h=0,c=0,d="",u=""}l++}return a.pop(),a},t.prototype.diff_bisect_=function(e,n,s){for(var r=e.length,o=n.length,a=Math.ceil((r+o)/2),l=a,c=2*a,h=new Array(c),d=new Array(c),u=0;u<c;u++)h[u]=-1,d[u]=-1;h[l+1]=0,d[l+1]=0;for(var p=r-o,f=p%2!=0,m=0,g=0,v=0,_=0,b=0;b<a&&!((new Date).getTime()>s);b++){for(var y=-b+m;y<=b-g;y+=2){for(var C=l+y,w=(A=y==-b||y!=b&&h[C-1]<h[C+1]?h[C+1]:h[C-1]+1)-y;A<r&&w<o&&e.charAt(A)==n.charAt(w);)A++,w++;if(h[C]=A,A>r)g+=2;else if(w>o)m+=2;else if(f&&(x=l+p-y)>=0&&x<c&&-1!=d[x]&&A>=(E=r-d[x]))return this.diff_bisectSplit_(e,n,A,w,s)}for(var S=-b+v;S<=b-_;S+=2){for(var E,x=l+S,T=(E=S==-b||S!=b&&d[x-1]<d[x+1]?d[x+1]:d[x-1]+1)-S;E<r&&T<o&&e.charAt(r-E-1)==n.charAt(o-T-1);)E++,T++;if(d[x]=E,E>r)_+=2;else if(T>o)v+=2;else if(!f){var A;if((C=l+p-S)>=0&&C<c&&-1!=h[C])if(w=l+(A=h[C])-C,A>=(E=r-E))return this.diff_bisectSplit_(e,n,A,w,s)}}}return[new t.Diff(i,e),new t.Diff(1,n)]},t.prototype.diff_bisectSplit_=function(e,t,i,n,s){var r=e.substring(0,i),o=t.substring(0,n),a=e.substring(i),l=t.substring(n),c=this.diff_main(r,o,!1,s),h=this.diff_main(a,l,!1,s);return c.concat(h)},t.prototype.diff_linesToChars_=function(e,t){var i=[],n={};function s(e){for(var t="",s=0,o=-1,a=i.length;o<e.length-1;){-1==(o=e.indexOf("\n",s))&&(o=e.length-1);var l=e.substring(s,o+1);(n.hasOwnProperty?n.hasOwnProperty(l):void 0!==n[l])?t+=String.fromCharCode(n[l]):(a==r&&(l=e.substring(s),o=e.length),t+=String.fromCharCode(a),n[l]=a,i[a++]=l),s=o+1}return t}i[0]="";var r=4e4,o=s(e);return r=65535,{chars1:o,chars2:s(t),lineArray:i}},t.prototype.diff_charsToLines_=function(e,t){for(var i=0;i<e.length;i++){for(var n=e[i][1],s=[],r=0;r<n.length;r++)s[r]=t[n.charCodeAt(r)];e[i][1]=s.join("")}},t.prototype.diff_commonPrefix=function(e,t){if(!e||!t||e.charAt(0)!=t.charAt(0))return 0;for(var i=0,n=Math.min(e.length,t.length),s=n,r=0;i<s;)e.substring(r,s)==t.substring(r,s)?r=i=s:n=s,s=Math.floor((n-i)/2+i);return s},t.prototype.diff_commonSuffix=function(e,t){if(!e||!t||e.charAt(e.length-1)!=t.charAt(t.length-1))return 0;for(var i=0,n=Math.min(e.length,t.length),s=n,r=0;i<s;)e.substring(e.length-s,e.length-r)==t.substring(t.length-s,t.length-r)?r=i=s:n=s,s=Math.floor((n-i)/2+i);return s},t.prototype.diff_commonOverlap_=function(e,t){var i=e.length,n=t.length;if(0==i||0==n)return 0;i>n?e=e.substring(i-n):i<n&&(t=t.substring(0,i));var s=Math.min(i,n);if(e==t)return s;for(var r=0,o=1;;){var a=e.substring(s-o),l=t.indexOf(a);if(-1==l)return r;o+=l,0!=l&&e.substring(s-o)!=t.substring(0,o)||(r=o,o++)}},t.prototype.diff_halfMatch_=function(e,t){if(this.Diff_Timeout<=0)return null;var i=e.length>t.length?e:t,n=e.length>t.length?t:e;if(i.length<4||2*n.length<i.length)return null;var s=this;function r(e,t,i){for(var n,r,o,a,l=e.substring(i,i+Math.floor(e.length/4)),c=-1,h="";-1!=(c=t.indexOf(l,c+1));){var d=s.diff_commonPrefix(e.substring(i),t.substring(c)),u=s.diff_commonSuffix(e.substring(0,i),t.substring(0,c));h.length<u+d&&(h=t.substring(c-u,c)+t.substring(c,c+d),n=e.substring(0,i-u),r=e.substring(i+d),o=t.substring(0,c-u),a=t.substring(c+d))}return 2*h.length>=e.length?[n,r,o,a,h]:null}var o,a,l,c,h,d=r(i,n,Math.ceil(i.length/4)),u=r(i,n,Math.ceil(i.length/2));return d||u?(o=u?d&&d[4].length>u[4].length?d:u:d,e.length>t.length?(a=o[0],l=o[1],c=o[2],h=o[3]):(c=o[0],h=o[1],a=o[2],l=o[3]),[a,l,c,h,o[4]]):null},t.prototype.diff_cleanupSemantic=function(e){for(var n=!1,s=[],r=0,o=null,a=0,l=0,c=0,h=0,d=0;a<e.length;)0==e[a][0]?(s[r++]=a,l=h,c=d,h=0,d=0,o=e[a][1]):(1==e[a][0]?h+=e[a][1].length:d+=e[a][1].length,o&&o.length<=Math.max(l,c)&&o.length<=Math.max(h,d)&&(e.splice(s[r-1],0,new t.Diff(i,o)),e[s[r-1]+1][0]=1,r--,a=--r>0?s[r-1]:-1,l=0,c=0,h=0,d=0,o=null,n=!0)),a++;for(n&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),a=1;a<e.length;){if(e[a-1][0]==i&&1==e[a][0]){var u=e[a-1][1],p=e[a][1],f=this.diff_commonOverlap_(u,p),m=this.diff_commonOverlap_(p,u);f>=m?(f>=u.length/2||f>=p.length/2)&&(e.splice(a,0,new t.Diff(0,p.substring(0,f))),e[a-1][1]=u.substring(0,u.length-f),e[a+1][1]=p.substring(f),a++):(m>=u.length/2||m>=p.length/2)&&(e.splice(a,0,new t.Diff(0,u.substring(0,m))),e[a-1][0]=1,e[a-1][1]=p.substring(0,p.length-m),e[a+1][0]=i,e[a+1][1]=u.substring(m),a++),a++}a++}},t.prototype.diff_cleanupSemanticLossless=function(e){function i(e,i){if(!e||!i)return 6;var n=e.charAt(e.length-1),s=i.charAt(0),r=n.match(t.nonAlphaNumericRegex_),o=s.match(t.nonAlphaNumericRegex_),a=r&&n.match(t.whitespaceRegex_),l=o&&s.match(t.whitespaceRegex_),c=a&&n.match(t.linebreakRegex_),h=l&&s.match(t.linebreakRegex_),d=c&&e.match(t.blanklineEndRegex_),u=h&&i.match(t.blanklineStartRegex_);return d||u?5:c||h?4:r&&!a&&l?3:a||l?2:r||o?1:0}for(var n=1;n<e.length-1;){if(0==e[n-1][0]&&0==e[n+1][0]){var s=e[n-1][1],r=e[n][1],o=e[n+1][1],a=this.diff_commonSuffix(s,r);if(a){var l=r.substring(r.length-a);s=s.substring(0,s.length-a),r=l+r.substring(0,r.length-a),o=l+o}for(var c=s,h=r,d=o,u=i(s,r)+i(r,o);r.charAt(0)===o.charAt(0);){s+=r.charAt(0),r=r.substring(1)+o.charAt(0),o=o.substring(1);var p=i(s,r)+i(r,o);p>=u&&(u=p,c=s,h=r,d=o)}e[n-1][1]!=c&&(c?e[n-1][1]=c:(e.splice(n-1,1),n--),e[n][1]=h,d?e[n+1][1]=d:(e.splice(n+1,1),n--))}n++}},t.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,t.whitespaceRegex_=/\s/,t.linebreakRegex_=/[\r\n]/,t.blanklineEndRegex_=/\n\r?\n$/,t.blanklineStartRegex_=/^\r?\n\r?\n/,t.prototype.diff_cleanupEfficiency=function(e){for(var n=!1,s=[],r=0,o=null,a=0,l=!1,c=!1,h=!1,d=!1;a<e.length;)0==e[a][0]?(e[a][1].length<this.Diff_EditCost&&(h||d)?(s[r++]=a,l=h,c=d,o=e[a][1]):(r=0,o=null),h=d=!1):(e[a][0]==i?d=!0:h=!0,o&&(l&&c&&h&&d||o.length<this.Diff_EditCost/2&&l+c+h+d==3)&&(e.splice(s[r-1],0,new t.Diff(i,o)),e[s[r-1]+1][0]=1,r--,o=null,l&&c?(h=d=!0,r=0):(a=--r>0?s[r-1]:-1,h=d=!1),n=!0)),a++;n&&this.diff_cleanupMerge(e)},t.prototype.diff_cleanupMerge=function(e){e.push(new t.Diff(0,""));for(var n,s=0,r=0,o=0,a="",l="";s<e.length;)switch(e[s][0]){case 1:o++,l+=e[s][1],s++;break;case i:r++,a+=e[s][1],s++;break;case 0:r+o>1?(0!==r&&0!==o&&(0!==(n=this.diff_commonPrefix(l,a))&&(s-r-o>0&&0==e[s-r-o-1][0]?e[s-r-o-1][1]+=l.substring(0,n):(e.splice(0,0,new t.Diff(0,l.substring(0,n))),s++),l=l.substring(n),a=a.substring(n)),0!==(n=this.diff_commonSuffix(l,a))&&(e[s][1]=l.substring(l.length-n)+e[s][1],l=l.substring(0,l.length-n),a=a.substring(0,a.length-n))),s-=r+o,e.splice(s,r+o),a.length&&(e.splice(s,0,new t.Diff(i,a)),s++),l.length&&(e.splice(s,0,new t.Diff(1,l)),s++),s++):0!==s&&0==e[s-1][0]?(e[s-1][1]+=e[s][1],e.splice(s,1)):s++,o=0,r=0,a="",l=""}""===e[e.length-1][1]&&e.pop();var c=!1;for(s=1;s<e.length-1;)0==e[s-1][0]&&0==e[s+1][0]&&(e[s][1].substring(e[s][1].length-e[s-1][1].length)==e[s-1][1]?(e[s][1]=e[s-1][1]+e[s][1].substring(0,e[s][1].length-e[s-1][1].length),e[s+1][1]=e[s-1][1]+e[s+1][1],e.splice(s-1,1),c=!0):e[s][1].substring(0,e[s+1][1].length)==e[s+1][1]&&(e[s-1][1]+=e[s+1][1],e[s][1]=e[s][1].substring(e[s+1][1].length)+e[s+1][1],e.splice(s+1,1),c=!0)),s++;c&&this.diff_cleanupMerge(e)},t.prototype.diff_xIndex=function(e,t){var n,s=0,r=0,o=0,a=0;for(n=0;n<e.length&&(1!==e[n][0]&&(s+=e[n][1].length),e[n][0]!==i&&(r+=e[n][1].length),!(s>t));n++)o=s,a=r;return e.length!=n&&e[n][0]===i?a:a+(t-o)},t.prototype.diff_prettyHtml=function(e){for(var t=[],n=/&/g,s=/</g,r=/>/g,o=/\n/g,a=0;a<e.length;a++){var l=e[a][0],c=e[a][1].replace(n,"&amp;").replace(s,"&lt;").replace(r,"&gt;").replace(o,"&para;<br>");switch(l){case 1:t[a]='<ins style="background:#e6ffe6;">'+c+"</ins>";break;case i:t[a]='<del style="background:#ffe6e6;">'+c+"</del>";break;case 0:t[a]="<span>"+c+"</span>"}}return t.join("")},t.prototype.diff_text1=function(e){for(var t=[],i=0;i<e.length;i++)1!==e[i][0]&&(t[i]=e[i][1]);return t.join("")},t.prototype.diff_text2=function(e){for(var t=[],n=0;n<e.length;n++)e[n][0]!==i&&(t[n]=e[n][1]);return t.join("")},t.prototype.diff_levenshtein=function(e){for(var t=0,n=0,s=0,r=0;r<e.length;r++){var o=e[r][0],a=e[r][1];switch(o){case 1:n+=a.length;break;case i:s+=a.length;break;case 0:t+=Math.max(n,s),n=0,s=0}}return t+Math.max(n,s)},t.prototype.diff_toDelta=function(e){for(var t=[],n=0;n<e.length;n++)switch(e[n][0]){case 1:t[n]="+"+encodeURI(e[n][1]);break;case i:t[n]="-"+e[n][1].length;break;case 0:t[n]="="+e[n][1].length}return t.join("\t").replace(/%20/g," ")},t.prototype.diff_fromDelta=function(e,n){for(var s=[],r=0,o=0,a=n.split(/\t/g),l=0;l<a.length;l++){var c=a[l].substring(1);switch(a[l].charAt(0)){case"+":try{s[r++]=new t.Diff(1,decodeURI(c))}catch(e){throw new Error("Illegal escape in diff_fromDelta: "+c)}break;case"-":case"=":var h=parseInt(c,10);if(isNaN(h)||h<0)throw new Error("Invalid number in diff_fromDelta: "+c);var d=e.substring(o,o+=h);"="==a[l].charAt(0)?s[r++]=new t.Diff(0,d):s[r++]=new t.Diff(i,d);break;default:if(a[l])throw new Error("Invalid diff operation in diff_fromDelta: "+a[l])}}if(o!=e.length)throw new Error("Delta length ("+o+") does not equal source text length ("+e.length+").");return s},t.prototype.match_main=function(e,t,i){if(null==e||null==t||null==i)throw new Error("Null input. (match_main)");return i=Math.max(0,Math.min(i,e.length)),e==t?0:e.length?e.substring(i,i+t.length)==t?i:this.match_bitap_(e,t,i):-1},t.prototype.match_bitap_=function(e,t,i){if(t.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var n=this.match_alphabet_(t),s=this;function r(e,n){var r=e/t.length,o=Math.abs(i-n);return s.Match_Distance?r+o/s.Match_Distance:o?1:r}var o=this.Match_Threshold,a=e.indexOf(t,i);-1!=a&&(o=Math.min(r(0,a),o),-1!=(a=e.lastIndexOf(t,i+t.length))&&(o=Math.min(r(0,a),o)));var l,c,h=1<<t.length-1;a=-1;for(var d,u=t.length+e.length,p=0;p<t.length;p++){for(l=0,c=u;l<c;)r(p,i+c)<=o?l=c:u=c,c=Math.floor((u-l)/2+l);u=c;var f=Math.max(1,i-c+1),m=Math.min(i+c,e.length)+t.length,g=Array(m+2);g[m+1]=(1<<p)-1;for(var v=m;v>=f;v--){var _=n[e.charAt(v-1)];if(g[v]=0===p?(g[v+1]<<1|1)&_:(g[v+1]<<1|1)&_|(d[v+1]|d[v])<<1|1|d[v+1],g[v]&h){var b=r(p,v-1);if(b<=o){if(o=b,!((a=v-1)>i))break;f=Math.max(1,2*i-a)}}}if(r(p+1,i)>o)break;d=g}return a},t.prototype.match_alphabet_=function(e){for(var t={},i=0;i<e.length;i++)t[e.charAt(i)]=0;for(i=0;i<e.length;i++)t[e.charAt(i)]|=1<<e.length-i-1;return t},t.prototype.patch_addContext_=function(e,i){if(0!=i.length){if(null===e.start2)throw Error("patch not initialized");for(var n=i.substring(e.start2,e.start2+e.length1),s=0;i.indexOf(n)!=i.lastIndexOf(n)&&n.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)s+=this.Patch_Margin,n=i.substring(e.start2-s,e.start2+e.length1+s);s+=this.Patch_Margin;var r=i.substring(e.start2-s,e.start2);r&&e.diffs.unshift(new t.Diff(0,r));var o=i.substring(e.start2+e.length1,e.start2+e.length1+s);o&&e.diffs.push(new t.Diff(0,o)),e.start1-=r.length,e.start2-=r.length,e.length1+=r.length+o.length,e.length2+=r.length+o.length}},t.prototype.patch_make=function(e,n,s){var r,o;if("string"==typeof e&&"string"==typeof n&&void 0===s)r=e,(o=this.diff_main(r,n,!0)).length>2&&(this.diff_cleanupSemantic(o),this.diff_cleanupEfficiency(o));else if(e&&"object"==typeof e&&void 0===n&&void 0===s)o=e,r=this.diff_text1(o);else if("string"==typeof e&&n&&"object"==typeof n&&void 0===s)r=e,o=n;else{if("string"!=typeof e||"string"!=typeof n||!s||"object"!=typeof s)throw new Error("Unknown call format to patch_make.");r=e,o=s}if(0===o.length)return[];for(var a=[],l=new t.patch_obj,c=0,h=0,d=0,u=r,p=r,f=0;f<o.length;f++){var m=o[f][0],g=o[f][1];switch(c||0===m||(l.start1=h,l.start2=d),m){case 1:l.diffs[c++]=o[f],l.length2+=g.length,p=p.substring(0,d)+g+p.substring(d);break;case i:l.length1+=g.length,l.diffs[c++]=o[f],p=p.substring(0,d)+p.substring(d+g.length);break;case 0:g.length<=2*this.Patch_Margin&&c&&o.length!=f+1?(l.diffs[c++]=o[f],l.length1+=g.length,l.length2+=g.length):g.length>=2*this.Patch_Margin&&c&&(this.patch_addContext_(l,u),a.push(l),l=new t.patch_obj,c=0,u=p,h=d)}1!==m&&(h+=g.length),m!==i&&(d+=g.length)}return c&&(this.patch_addContext_(l,u),a.push(l)),a},t.prototype.patch_deepCopy=function(e){for(var i=[],n=0;n<e.length;n++){var s=e[n],r=new t.patch_obj;r.diffs=[];for(var o=0;o<s.diffs.length;o++)r.diffs[o]=new t.Diff(s.diffs[o][0],s.diffs[o][1]);r.start1=s.start1,r.start2=s.start2,r.length1=s.length1,r.length2=s.length2,i[n]=r}return i},t.prototype.patch_apply=function(e,t){if(0==e.length)return[t,[]];e=this.patch_deepCopy(e);var n=this.patch_addPadding(e);t=n+t+n,this.patch_splitMax(e);for(var s=0,r=[],o=0;o<e.length;o++){var a,l,c=e[o].start2+s,h=this.diff_text1(e[o].diffs),d=-1;if(h.length>this.Match_MaxBits?-1!=(a=this.match_main(t,h.substring(0,this.Match_MaxBits),c))&&(-1==(d=this.match_main(t,h.substring(h.length-this.Match_MaxBits),c+h.length-this.Match_MaxBits))||a>=d)&&(a=-1):a=this.match_main(t,h,c),-1==a)r[o]=!1,s-=e[o].length2-e[o].length1;else if(r[o]=!0,s=a-c,h==(l=-1==d?t.substring(a,a+h.length):t.substring(a,d+this.Match_MaxBits)))t=t.substring(0,a)+this.diff_text2(e[o].diffs)+t.substring(a+h.length);else{var u=this.diff_main(h,l,!1);if(h.length>this.Match_MaxBits&&this.diff_levenshtein(u)/h.length>this.Patch_DeleteThreshold)r[o]=!1;else{this.diff_cleanupSemanticLossless(u);for(var p,f=0,m=0;m<e[o].diffs.length;m++){var g=e[o].diffs[m];0!==g[0]&&(p=this.diff_xIndex(u,f)),1===g[0]?t=t.substring(0,a+p)+g[1]+t.substring(a+p):g[0]===i&&(t=t.substring(0,a+p)+t.substring(a+this.diff_xIndex(u,f+g[1].length))),g[0]!==i&&(f+=g[1].length)}}}}return[t=t.substring(n.length,t.length-n.length),r]},t.prototype.patch_addPadding=function(e){for(var i=this.Patch_Margin,n="",s=1;s<=i;s++)n+=String.fromCharCode(s);for(s=0;s<e.length;s++)e[s].start1+=i,e[s].start2+=i;var r=e[0],o=r.diffs;if(0==o.length||0!=o[0][0])o.unshift(new t.Diff(0,n)),r.start1-=i,r.start2-=i,r.length1+=i,r.length2+=i;else if(i>o[0][1].length){var a=i-o[0][1].length;o[0][1]=n.substring(o[0][1].length)+o[0][1],r.start1-=a,r.start2-=a,r.length1+=a,r.length2+=a}return 0==(o=(r=e[e.length-1]).diffs).length||0!=o[o.length-1][0]?(o.push(new t.Diff(0,n)),r.length1+=i,r.length2+=i):i>o[o.length-1][1].length&&(a=i-o[o.length-1][1].length,o[o.length-1][1]+=n.substring(0,a),r.length1+=a,r.length2+=a),n},t.prototype.patch_splitMax=function(e){for(var n=this.Match_MaxBits,s=0;s<e.length;s++)if(!(e[s].length1<=n)){var r=e[s];e.splice(s--,1);for(var o=r.start1,a=r.start2,l="";0!==r.diffs.length;){var c=new t.patch_obj,h=!0;for(c.start1=o-l.length,c.start2=a-l.length,""!==l&&(c.length1=c.length2=l.length,c.diffs.push(new t.Diff(0,l)));0!==r.diffs.length&&c.length1<n-this.Patch_Margin;){var d=r.diffs[0][0],u=r.diffs[0][1];1===d?(c.length2+=u.length,a+=u.length,c.diffs.push(r.diffs.shift()),h=!1):d===i&&1==c.diffs.length&&0==c.diffs[0][0]&&u.length>2*n?(c.length1+=u.length,o+=u.length,h=!1,c.diffs.push(new t.Diff(d,u)),r.diffs.shift()):(u=u.substring(0,n-c.length1-this.Patch_Margin),c.length1+=u.length,o+=u.length,0===d?(c.length2+=u.length,a+=u.length):h=!1,c.diffs.push(new t.Diff(d,u)),u==r.diffs[0][1]?r.diffs.shift():r.diffs[0][1]=r.diffs[0][1].substring(u.length))}l=(l=this.diff_text2(c.diffs)).substring(l.length-this.Patch_Margin);var p=this.diff_text1(r.diffs).substring(0,this.Patch_Margin);""!==p&&(c.length1+=p.length,c.length2+=p.length,0!==c.diffs.length&&0===c.diffs[c.diffs.length-1][0]?c.diffs[c.diffs.length-1][1]+=p:c.diffs.push(new t.Diff(0,p))),h||e.splice(++s,0,c)}}},t.prototype.patch_toText=function(e){for(var t=[],i=0;i<e.length;i++)t[i]=e[i];return t.join("")},t.prototype.patch_fromText=function(e){var n=[];if(!e)return n;for(var s=e.split("\n"),r=0,o=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;r<s.length;){var a=s[r].match(o);if(!a)throw new Error("Invalid patch string: "+s[r]);var l=new t.patch_obj;for(n.push(l),l.start1=parseInt(a[1],10),""===a[2]?(l.start1--,l.length1=1):"0"==a[2]?l.length1=0:(l.start1--,l.length1=parseInt(a[2],10)),l.start2=parseInt(a[3],10),""===a[4]?(l.start2--,l.length2=1):"0"==a[4]?l.length2=0:(l.start2--,l.length2=parseInt(a[4],10)),r++;r<s.length;){var c=s[r].charAt(0);try{var h=decodeURI(s[r].substring(1))}catch(e){throw new Error("Illegal escape in patch_fromText: "+h)}if("-"==c)l.diffs.push(new t.Diff(i,h));else if("+"==c)l.diffs.push(new t.Diff(1,h));else if(" "==c)l.diffs.push(new t.Diff(0,h));else{if("@"==c)break;if(""!==c)throw new Error('Invalid patch mode "'+c+'" in: '+h)}r++}}return n},(t.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0}).prototype.toString=function(){for(var e,t=["@@ -"+(0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1)+" +"+(0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2)+" @@\n"],n=0;n<this.diffs.length;n++){switch(this.diffs[n][0]){case 1:e="+";break;case i:e="-";break;case 0:e=" "}t[n+1]=e+encodeURI(this.diffs[n][1])+"\n"}return t.join("").replace(/%20/g," ")},e.exports=t,e.exports.diff_match_patch=t,e.exports.DIFF_DELETE=i,e.exports.DIFF_INSERT=1,e.exports.DIFF_EQUAL=0},140:function(e,t){var i,n;void 0===(n="function"==typeof(i=function(){return function e(t,i,n){var s,r,o=window,a="application/octet-stream",l=n||a,c=t,h=!i&&!n&&c,d=document.createElement("a"),u=function(e){return String(e)},p=o.Blob||o.MozBlob||o.WebKitBlob||u,f=i||"download";if(p=p.call?p.bind(o):Blob,"true"===String(this)&&(l=(c=[c,l])[0],c=c[1]),h&&h.length<2048&&(f=h.split("/").pop().split("?")[0],d.href=h,-1!==d.href.indexOf(h))){var m=new XMLHttpRequest;return m.open("GET",h,!0),m.responseType="blob",m.onload=function(t){e(t.target.response,f,a)},setTimeout((function(){m.send()}),0),m}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(c)){if(!(c.length>2096103.424&&p!==u))return navigator.msSaveBlob?navigator.msSaveBlob(b(c),f):y(c);l=(c=b(c)).type||a}else if(/([\x80-\xff])/.test(c)){for(var g=0,v=new Uint8Array(c.length),_=v.length;g<_;++g)v[g]=c.charCodeAt(g);c=new p([v],{type:l})}function b(e){for(var t=e.split(/[:;,]/),i=t[1],n=("base64"==t[2]?atob:decodeURIComponent)(t.pop()),s=n.length,r=0,o=new Uint8Array(s);r<s;++r)o[r]=n.charCodeAt(r);return new p([o],{type:i})}function y(e,t){if("download"in d)return d.href=e,d.setAttribute("download",f),d.className="download-js-link",d.innerHTML="downloading...",d.style.display="none",document.body.appendChild(d),setTimeout((function(){d.click(),document.body.removeChild(d),!0===t&&setTimeout((function(){o.URL.revokeObjectURL(d.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,a)),window.open(e)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=e),!0;var i=document.createElement("iframe");document.body.appendChild(i),!t&&/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,a)),i.src=e,setTimeout((function(){document.body.removeChild(i)}),333)}if(s=c instanceof p?c:new p([c],{type:l}),navigator.msSaveBlob)return navigator.msSaveBlob(s,f);if(o.URL)y(o.URL.createObjectURL(s),!0);else{if("string"==typeof s||s.constructor===u)try{return y("data:"+l+";base64,"+o.btoa(s))}catch(e){return y("data:"+l+","+encodeURIComponent(s))}(r=new FileReader).onload=function(e){y(this.result)},r.readAsDataURL(s)}return!0}})?i.apply(t,[]):i)||(e.exports=n)},692:function(e,t){var i;!function(t,i){"use strict";"object"==typeof e.exports?e.exports=t.document?i(t,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return i(e)}:i(t)}("undefined"!=typeof window?window:this,(function(n,s){"use strict";var r=[],o=Object.getPrototypeOf,a=r.slice,l=r.flat?function(e){return r.flat.call(e)}:function(e){return r.concat.apply([],e)},c=r.push,h=r.indexOf,d={},u=d.toString,p=d.hasOwnProperty,f=p.toString,m=f.call(Object),g={},v=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},_=function(e){return null!=e&&e===e.window},b=n.document,y={type:!0,src:!0,nonce:!0,noModule:!0};function C(e,t,i){var n,s,r=(i=i||b).createElement("script");if(r.text=e,t)for(n in y)(s=t[n]||t.getAttribute&&t.getAttribute(n))&&r.setAttribute(n,s);i.head.appendChild(r).parentNode.removeChild(r)}function w(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?d[u.call(e)]||"object":typeof e}var S="3.7.1",E=/HTML$/i,x=function(e,t){return new x.fn.init(e,t)};function T(e){var t=!!e&&"length"in e&&e.length,i=w(e);return!v(e)&&!_(e)&&("array"===i||0===t||"number"==typeof t&&t>0&&t-1 in e)}function A(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}x.fn=x.prototype={jquery:S,constructor:x,length:0,toArray:function(){return a.call(this)},get:function(e){return null==e?a.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=x.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return x.each(this,e)},map:function(e){return this.pushStack(x.map(this,(function(t,i){return e.call(t,i,t)})))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(x.grep(this,(function(e,t){return(t+1)%2})))},odd:function(){return this.pushStack(x.grep(this,(function(e,t){return t%2})))},eq:function(e){var t=this.length,i=+e+(e<0?t:0);return this.pushStack(i>=0&&i<t?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:c,sort:r.sort,splice:r.splice},x.extend=x.fn.extend=function(){var e,t,i,n,s,r,o=arguments[0]||{},a=1,l=arguments.length,c=!1;for("boolean"==typeof o&&(c=o,o=arguments[a]||{},a++),"object"==typeof o||v(o)||(o={}),a===l&&(o=this,a--);a<l;a++)if(null!=(e=arguments[a]))for(t in e)n=e[t],"__proto__"!==t&&o!==n&&(c&&n&&(x.isPlainObject(n)||(s=Array.isArray(n)))?(i=o[t],r=s&&!Array.isArray(i)?[]:s||x.isPlainObject(i)?i:{},s=!1,o[t]=x.extend(c,r,n)):void 0!==n&&(o[t]=n));return o},x.extend({expando:"jQuery"+(S+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,i;return!(!e||"[object Object]"!==u.call(e)||(t=o(e))&&("function"!=typeof(i=p.call(t,"constructor")&&t.constructor)||f.call(i)!==m))},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,i){C(e,{nonce:t&&t.nonce},i)},each:function(e,t){var i,n=0;if(T(e))for(i=e.length;n<i&&!1!==t.call(e[n],n,e[n]);n++);else for(n in e)if(!1===t.call(e[n],n,e[n]))break;return e},text:function(e){var t,i="",n=0,s=e.nodeType;if(!s)for(;t=e[n++];)i+=x.text(t);return 1===s||11===s?e.textContent:9===s?e.documentElement.textContent:3===s||4===s?e.nodeValue:i},makeArray:function(e,t){var i=t||[];return null!=e&&(T(Object(e))?x.merge(i,"string"==typeof e?[e]:e):c.call(i,e)),i},inArray:function(e,t,i){return null==t?-1:h.call(t,e,i)},isXMLDoc:function(e){var t=e&&e.namespaceURI,i=e&&(e.ownerDocument||e).documentElement;return!E.test(t||i&&i.nodeName||"HTML")},merge:function(e,t){for(var i=+t.length,n=0,s=e.length;n<i;n++)e[s++]=t[n];return e.length=s,e},grep:function(e,t,i){for(var n=[],s=0,r=e.length,o=!i;s<r;s++)!t(e[s],s)!==o&&n.push(e[s]);return n},map:function(e,t,i){var n,s,r=0,o=[];if(T(e))for(n=e.length;r<n;r++)null!=(s=t(e[r],r,i))&&o.push(s);else for(r in e)null!=(s=t(e[r],r,i))&&o.push(s);return l(o)},guid:1,support:g}),"function"==typeof Symbol&&(x.fn[Symbol.iterator]=r[Symbol.iterator]),x.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(e,t){d["[object "+t+"]"]=t.toLowerCase()}));var O=r.pop,I=r.sort,k=r.splice,D="[\\x20\\t\\r\\n\\f]",j=new RegExp("^"+D+"+|((?:^|[^\\\\])(?:\\\\.)*)"+D+"+$","g");x.contains=function(e,t){var i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(e.contains?e.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))};var R=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function L(e,t){return t?"\0"===e?"ï¿½":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e}x.escapeSelector=function(e){return(e+"").replace(R,L)};var M=b,P=c;!function(){var e,t,i,s,o,l,c,d,u,f,m=P,v=x.expando,_=0,b=0,y=ee(),C=ee(),w=ee(),S=ee(),E=function(e,t){return e===t&&(o=!0),0},T="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",R="(?:\\\\[\\da-fA-F]{1,6}"+D+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",L="\\["+D+"*("+R+")(?:"+D+"*([*^$|!~]?=)"+D+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+R+"))|)"+D+"*\\]",N=":("+R+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+L+")*)|.*)\\)|)",F=new RegExp(D+"+","g"),H=new RegExp("^"+D+"*,"+D+"*"),B=new RegExp("^"+D+"*([>+~]|"+D+")"+D+"*"),z=new RegExp(D+"|>"),V=new RegExp(N),W=new RegExp("^"+R+"$"),$={ID:new RegExp("^#("+R+")"),CLASS:new RegExp("^\\.("+R+")"),TAG:new RegExp("^("+R+"|[*])"),ATTR:new RegExp("^"+L),PSEUDO:new RegExp("^"+N),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+D+"*(even|odd|(([+-]|)(\\d*)n|)"+D+"*(?:([+-]|)"+D+"*(\\d+)|))"+D+"*\\)|)","i"),bool:new RegExp("^(?:"+T+")$","i"),needsContext:new RegExp("^"+D+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+D+"*((?:-\\d)?\\d*)"+D+"*\\)|)(?=[^-]|$)","i")},U=/^(?:input|select|textarea|button)$/i,q=/^h\d$/i,G=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,K=/[+~]/,Y=new RegExp("\\\\[\\da-fA-F]{1,6}"+D+"?|\\\\([^\\r\\n\\f])","g"),X=function(e,t){var i="0x"+e.slice(1)-65536;return t||(i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320))},Z=function(){le()},Q=ue((function(e){return!0===e.disabled&&A(e,"fieldset")}),{dir:"parentNode",next:"legend"});try{m.apply(r=a.call(M.childNodes),M.childNodes),r[M.childNodes.length].nodeType}catch(e){m={apply:function(e,t){P.apply(e,a.call(t))},call:function(e){P.apply(e,a.call(arguments,1))}}}function J(e,t,i,n){var s,r,o,a,c,h,p,f=t&&t.ownerDocument,_=t?t.nodeType:9;if(i=i||[],"string"!=typeof e||!e||1!==_&&9!==_&&11!==_)return i;if(!n&&(le(t),t=t||l,d)){if(11!==_&&(c=G.exec(e)))if(s=c[1]){if(9===_){if(!(o=t.getElementById(s)))return i;if(o.id===s)return m.call(i,o),i}else if(f&&(o=f.getElementById(s))&&J.contains(t,o)&&o.id===s)return m.call(i,o),i}else{if(c[2])return m.apply(i,t.getElementsByTagName(e)),i;if((s=c[3])&&t.getElementsByClassName)return m.apply(i,t.getElementsByClassName(s)),i}if(!(S[e+" "]||u&&u.test(e))){if(p=e,f=t,1===_&&(z.test(e)||B.test(e))){for((f=K.test(e)&&ae(t.parentNode)||t)==t&&g.scope||((a=t.getAttribute("id"))?a=x.escapeSelector(a):t.setAttribute("id",a=v)),r=(h=he(e)).length;r--;)h[r]=(a?"#"+a:":scope")+" "+de(h[r]);p=h.join(",")}try{return m.apply(i,f.querySelectorAll(p)),i}catch(t){S(e,!0)}finally{a===v&&t.removeAttribute("id")}}}return _e(e.replace(j,"$1"),t,i,n)}function ee(){var e=[];return function i(n,s){return e.push(n+" ")>t.cacheLength&&delete i[e.shift()],i[n+" "]=s}}function te(e){return e[v]=!0,e}function ie(e){var t=l.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function ne(e){return function(t){return A(t,"input")&&t.type===e}}function se(e){return function(t){return(A(t,"input")||A(t,"button"))&&t.type===e}}function re(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&Q(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function oe(e){return te((function(t){return t=+t,te((function(i,n){for(var s,r=e([],i.length,t),o=r.length;o--;)i[s=r[o]]&&(i[s]=!(n[s]=i[s]))}))}))}function ae(e){return e&&void 0!==e.getElementsByTagName&&e}function le(e){var i,n=e?e.ownerDocument||e:M;return n!=l&&9===n.nodeType&&n.documentElement?(c=(l=n).documentElement,d=!x.isXMLDoc(l),f=c.matches||c.webkitMatchesSelector||c.msMatchesSelector,c.msMatchesSelector&&M!=l&&(i=l.defaultView)&&i.top!==i&&i.addEventListener("unload",Z),g.getById=ie((function(e){return c.appendChild(e).id=x.expando,!l.getElementsByName||!l.getElementsByName(x.expando).length})),g.disconnectedMatch=ie((function(e){return f.call(e,"*")})),g.scope=ie((function(){return l.querySelectorAll(":scope")})),g.cssHas=ie((function(){try{return l.querySelector(":has(*,:jqfake)"),!1}catch(e){return!0}})),g.getById?(t.filter.ID=function(e){var t=e.replace(Y,X);return function(e){return e.getAttribute("id")===t}},t.find.ID=function(e,t){if(void 0!==t.getElementById&&d){var i=t.getElementById(e);return i?[i]:[]}}):(t.filter.ID=function(e){var t=e.replace(Y,X);return function(e){var i=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return i&&i.value===t}},t.find.ID=function(e,t){if(void 0!==t.getElementById&&d){var i,n,s,r=t.getElementById(e);if(r){if((i=r.getAttributeNode("id"))&&i.value===e)return[r];for(s=t.getElementsByName(e),n=0;r=s[n++];)if((i=r.getAttributeNode("id"))&&i.value===e)return[r]}return[]}}),t.find.TAG=function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):t.querySelectorAll(e)},t.find.CLASS=function(e,t){if(void 0!==t.getElementsByClassName&&d)return t.getElementsByClassName(e)},u=[],ie((function(e){var t;c.appendChild(e).innerHTML="<a id='"+v+"' href='' disabled='disabled'></a><select id='"+v+"-\r\\' disabled='disabled'><option selected=''></option></select>",e.querySelectorAll("[selected]").length||u.push("\\["+D+"*(?:value|"+T+")"),e.querySelectorAll("[id~="+v+"-]").length||u.push("~="),e.querySelectorAll("a#"+v+"+*").length||u.push(".#.+[+~]"),e.querySelectorAll(":checked").length||u.push(":checked"),(t=l.createElement("input")).setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),c.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&u.push(":enabled",":disabled"),(t=l.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||u.push("\\["+D+"*name"+D+"*="+D+"*(?:''|\"\")")})),g.cssHas||u.push(":has"),u=u.length&&new RegExp(u.join("|")),E=function(e,t){if(e===t)return o=!0,0;var i=!e.compareDocumentPosition-!t.compareDocumentPosition;return i||(1&(i=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!g.sortDetached&&t.compareDocumentPosition(e)===i?e===l||e.ownerDocument==M&&J.contains(M,e)?-1:t===l||t.ownerDocument==M&&J.contains(M,t)?1:s?h.call(s,e)-h.call(s,t):0:4&i?-1:1)},l):l}for(e in J.matches=function(e,t){return J(e,null,null,t)},J.matchesSelector=function(e,t){if(le(e),d&&!S[t+" "]&&(!u||!u.test(t)))try{var i=f.call(e,t);if(i||g.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(e){S(t,!0)}return J(t,l,null,[e]).length>0},J.contains=function(e,t){return(e.ownerDocument||e)!=l&&le(e),x.contains(e,t)},J.attr=function(e,i){(e.ownerDocument||e)!=l&&le(e);var n=t.attrHandle[i.toLowerCase()],s=n&&p.call(t.attrHandle,i.toLowerCase())?n(e,i,!d):void 0;return void 0!==s?s:e.getAttribute(i)},J.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},x.uniqueSort=function(e){var t,i=[],n=0,r=0;if(o=!g.sortStable,s=!g.sortStable&&a.call(e,0),I.call(e,E),o){for(;t=e[r++];)t===e[r]&&(n=i.push(r));for(;n--;)k.call(e,i[n],1)}return s=null,e},x.fn.uniqueSort=function(){return this.pushStack(x.uniqueSort(a.apply(this)))},t=x.expr={cacheLength:50,createPseudo:te,match:$,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(Y,X),e[3]=(e[3]||e[4]||e[5]||"").replace(Y,X),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||J.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&J.error(e[0]),e},PSEUDO:function(e){var t,i=!e[6]&&e[2];return $.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":i&&V.test(i)&&(t=he(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(Y,X).toLowerCase();return"*"===e?function(){return!0}:function(e){return A(e,t)}},CLASS:function(e){var t=y[e+" "];return t||(t=new RegExp("(^|"+D+")"+e+"("+D+"|$)"))&&y(e,(function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}))},ATTR:function(e,t,i){return function(n){var s=J.attr(n,e);return null==s?"!="===t:!t||(s+="","="===t?s===i:"!="===t?s!==i:"^="===t?i&&0===s.indexOf(i):"*="===t?i&&s.indexOf(i)>-1:"$="===t?i&&s.slice(-i.length)===i:"~="===t?(" "+s.replace(F," ")+" ").indexOf(i)>-1:"|="===t&&(s===i||s.slice(0,i.length+1)===i+"-"))}},CHILD:function(e,t,i,n,s){var r="nth"!==e.slice(0,3),o="last"!==e.slice(-4),a="of-type"===t;return 1===n&&0===s?function(e){return!!e.parentNode}:function(t,i,l){var c,h,d,u,p,f=r!==o?"nextSibling":"previousSibling",m=t.parentNode,g=a&&t.nodeName.toLowerCase(),b=!l&&!a,y=!1;if(m){if(r){for(;f;){for(d=t;d=d[f];)if(a?A(d,g):1===d.nodeType)return!1;p=f="only"===e&&!p&&"nextSibling"}return!0}if(p=[o?m.firstChild:m.lastChild],o&&b){for(y=(u=(c=(h=m[v]||(m[v]={}))[e]||[])[0]===_&&c[1])&&c[2],d=u&&m.childNodes[u];d=++u&&d&&d[f]||(y=u=0)||p.pop();)if(1===d.nodeType&&++y&&d===t){h[e]=[_,u,y];break}}else if(b&&(y=u=(c=(h=t[v]||(t[v]={}))[e]||[])[0]===_&&c[1]),!1===y)for(;(d=++u&&d&&d[f]||(y=u=0)||p.pop())&&(!(a?A(d,g):1===d.nodeType)||!++y||(b&&((h=d[v]||(d[v]={}))[e]=[_,y]),d!==t)););return(y-=s)===n||y%n==0&&y/n>=0}}},PSEUDO:function(e,i){var n,s=t.pseudos[e]||t.setFilters[e.toLowerCase()]||J.error("unsupported pseudo: "+e);return s[v]?s(i):s.length>1?(n=[e,e,"",i],t.setFilters.hasOwnProperty(e.toLowerCase())?te((function(e,t){for(var n,r=s(e,i),o=r.length;o--;)e[n=h.call(e,r[o])]=!(t[n]=r[o])})):function(e){return s(e,0,n)}):s}},pseudos:{not:te((function(e){var t=[],i=[],n=ve(e.replace(j,"$1"));return n[v]?te((function(e,t,i,s){for(var r,o=n(e,null,s,[]),a=e.length;a--;)(r=o[a])&&(e[a]=!(t[a]=r))})):function(e,s,r){return t[0]=e,n(t,null,r,i),t[0]=null,!i.pop()}})),has:te((function(e){return function(t){return J(e,t).length>0}})),contains:te((function(e){return e=e.replace(Y,X),function(t){return(t.textContent||x.text(t)).indexOf(e)>-1}})),lang:te((function(e){return W.test(e||"")||J.error("unsupported lang: "+e),e=e.replace(Y,X).toLowerCase(),function(t){var i;do{if(i=d?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(i=i.toLowerCase())===e||0===i.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(e){var t=n.location&&n.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===c},focus:function(e){return e===function(){try{return l.activeElement}catch(e){}}()&&l.hasFocus()&&!!(e.type||e.href||~e.tabIndex)},enabled:re(!1),disabled:re(!0),checked:function(e){return A(e,"input")&&!!e.checked||A(e,"option")&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!t.pseudos.empty(e)},header:function(e){return q.test(e.nodeName)},input:function(e){return U.test(e.nodeName)},button:function(e){return A(e,"input")&&"button"===e.type||A(e,"button")},text:function(e){var t;return A(e,"input")&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:oe((function(){return[0]})),last:oe((function(e,t){return[t-1]})),eq:oe((function(e,t,i){return[i<0?i+t:i]})),even:oe((function(e,t){for(var i=0;i<t;i+=2)e.push(i);return e})),odd:oe((function(e,t){for(var i=1;i<t;i+=2)e.push(i);return e})),lt:oe((function(e,t,i){var n;for(n=i<0?i+t:i>t?t:i;--n>=0;)e.push(n);return e})),gt:oe((function(e,t,i){for(var n=i<0?i+t:i;++n<t;)e.push(n);return e}))}},t.pseudos.nth=t.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})t.pseudos[e]=ne(e);for(e in{submit:!0,reset:!0})t.pseudos[e]=se(e);function ce(){}function he(e,i){var n,s,r,o,a,l,c,h=C[e+" "];if(h)return i?0:h.slice(0);for(a=e,l=[],c=t.preFilter;a;){for(o in n&&!(s=H.exec(a))||(s&&(a=a.slice(s[0].length)||a),l.push(r=[])),n=!1,(s=B.exec(a))&&(n=s.shift(),r.push({value:n,type:s[0].replace(j," ")}),a=a.slice(n.length)),t.filter)!(s=$[o].exec(a))||c[o]&&!(s=c[o](s))||(n=s.shift(),r.push({value:n,type:o,matches:s}),a=a.slice(n.length));if(!n)break}return i?a.length:a?J.error(e):C(e,l).slice(0)}function de(e){for(var t=0,i=e.length,n="";t<i;t++)n+=e[t].value;return n}function ue(e,t,i){var n=t.dir,s=t.next,r=s||n,o=i&&"parentNode"===r,a=b++;return t.first?function(t,i,s){for(;t=t[n];)if(1===t.nodeType||o)return e(t,i,s);return!1}:function(t,i,l){var c,h,d=[_,a];if(l){for(;t=t[n];)if((1===t.nodeType||o)&&e(t,i,l))return!0}else for(;t=t[n];)if(1===t.nodeType||o)if(h=t[v]||(t[v]={}),s&&A(t,s))t=t[n]||t;else{if((c=h[r])&&c[0]===_&&c[1]===a)return d[2]=c[2];if(h[r]=d,d[2]=e(t,i,l))return!0}return!1}}function pe(e){return e.length>1?function(t,i,n){for(var s=e.length;s--;)if(!e[s](t,i,n))return!1;return!0}:e[0]}function fe(e,t,i,n,s){for(var r,o=[],a=0,l=e.length,c=null!=t;a<l;a++)(r=e[a])&&(i&&!i(r,n,s)||(o.push(r),c&&t.push(a)));return o}function me(e,t,i,n,s,r){return n&&!n[v]&&(n=me(n)),s&&!s[v]&&(s=me(s,r)),te((function(r,o,a,l){var c,d,u,p,f=[],g=[],v=o.length,_=r||function(e,t,i){for(var n=0,s=t.length;n<s;n++)J(e,t[n],i);return i}(t||"*",a.nodeType?[a]:a,[]),b=!e||!r&&t?_:fe(_,f,e,a,l);if(i?i(b,p=s||(r?e:v||n)?[]:o,a,l):p=b,n)for(c=fe(p,g),n(c,[],a,l),d=c.length;d--;)(u=c[d])&&(p[g[d]]=!(b[g[d]]=u));if(r){if(s||e){if(s){for(c=[],d=p.length;d--;)(u=p[d])&&c.push(b[d]=u);s(null,p=[],c,l)}for(d=p.length;d--;)(u=p[d])&&(c=s?h.call(r,u):f[d])>-1&&(r[c]=!(o[c]=u))}}else p=fe(p===o?p.splice(v,p.length):p),s?s(null,o,p,l):m.apply(o,p)}))}function ge(e){for(var n,s,r,o=e.length,a=t.relative[e[0].type],l=a||t.relative[" "],c=a?1:0,d=ue((function(e){return e===n}),l,!0),u=ue((function(e){return h.call(n,e)>-1}),l,!0),p=[function(e,t,s){var r=!a&&(s||t!=i)||((n=t).nodeType?d(e,t,s):u(e,t,s));return n=null,r}];c<o;c++)if(s=t.relative[e[c].type])p=[ue(pe(p),s)];else{if((s=t.filter[e[c].type].apply(null,e[c].matches))[v]){for(r=++c;r<o&&!t.relative[e[r].type];r++);return me(c>1&&pe(p),c>1&&de(e.slice(0,c-1).concat({value:" "===e[c-2].type?"*":""})).replace(j,"$1"),s,c<r&&ge(e.slice(c,r)),r<o&&ge(e=e.slice(r)),r<o&&de(e))}p.push(s)}return pe(p)}function ve(e,n){var s,r=[],o=[],a=w[e+" "];if(!a){for(n||(n=he(e)),s=n.length;s--;)(a=ge(n[s]))[v]?r.push(a):o.push(a);a=w(e,function(e,n){var s=n.length>0,r=e.length>0,o=function(o,a,c,h,u){var p,f,g,v=0,b="0",y=o&&[],C=[],w=i,S=o||r&&t.find.TAG("*",u),E=_+=null==w?1:Math.random()||.1,T=S.length;for(u&&(i=a==l||a||u);b!==T&&null!=(p=S[b]);b++){if(r&&p){for(f=0,a||p.ownerDocument==l||(le(p),c=!d);g=e[f++];)if(g(p,a||l,c)){m.call(h,p);break}u&&(_=E)}s&&((p=!g&&p)&&v--,o&&y.push(p))}if(v+=b,s&&b!==v){for(f=0;g=n[f++];)g(y,C,a,c);if(o){if(v>0)for(;b--;)y[b]||C[b]||(C[b]=O.call(h));C=fe(C)}m.apply(h,C),u&&!o&&C.length>0&&v+n.length>1&&x.uniqueSort(h)}return u&&(_=E,i=w),y};return s?te(o):o}(o,r)),a.selector=e}return a}function _e(e,i,n,s){var r,o,a,l,c,h="function"==typeof e&&e,u=!s&&he(e=h.selector||e);if(n=n||[],1===u.length){if((o=u[0]=u[0].slice(0)).length>2&&"ID"===(a=o[0]).type&&9===i.nodeType&&d&&t.relative[o[1].type]){if(!(i=(t.find.ID(a.matches[0].replace(Y,X),i)||[])[0]))return n;h&&(i=i.parentNode),e=e.slice(o.shift().value.length)}for(r=$.needsContext.test(e)?0:o.length;r--&&(a=o[r],!t.relative[l=a.type]);)if((c=t.find[l])&&(s=c(a.matches[0].replace(Y,X),K.test(o[0].type)&&ae(i.parentNode)||i))){if(o.splice(r,1),!(e=s.length&&de(o)))return m.apply(n,s),n;break}}return(h||ve(e,u))(s,i,!d,n,!i||K.test(e)&&ae(i.parentNode)||i),n}ce.prototype=t.filters=t.pseudos,t.setFilters=new ce,g.sortStable=v.split("").sort(E).join("")===v,le(),g.sortDetached=ie((function(e){return 1&e.compareDocumentPosition(l.createElement("fieldset"))})),x.find=J,x.expr[":"]=x.expr.pseudos,x.unique=x.uniqueSort,J.compile=ve,J.select=_e,J.setDocument=le,J.tokenize=he,J.escape=x.escapeSelector,J.getText=x.text,J.isXML=x.isXMLDoc,J.selectors=x.expr,J.support=x.support,J.uniqueSort=x.uniqueSort}();var N=function(e,t,i){for(var n=[],s=void 0!==i;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(s&&x(e).is(i))break;n.push(e)}return n},F=function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i},H=x.expr.match.needsContext,B=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function z(e,t,i){return v(t)?x.grep(e,(function(e,n){return!!t.call(e,n,e)!==i})):t.nodeType?x.grep(e,(function(e){return e===t!==i})):"string"!=typeof t?x.grep(e,(function(e){return h.call(t,e)>-1!==i})):x.filter(t,e,i)}x.filter=function(e,t,i){var n=t[0];return i&&(e=":not("+e+")"),1===t.length&&1===n.nodeType?x.find.matchesSelector(n,e)?[n]:[]:x.find.matches(e,x.grep(t,(function(e){return 1===e.nodeType})))},x.fn.extend({find:function(e){var t,i,n=this.length,s=this;if("string"!=typeof e)return this.pushStack(x(e).filter((function(){for(t=0;t<n;t++)if(x.contains(s[t],this))return!0})));for(i=this.pushStack([]),t=0;t<n;t++)x.find(e,s[t],i);return n>1?x.uniqueSort(i):i},filter:function(e){return this.pushStack(z(this,e||[],!1))},not:function(e){return this.pushStack(z(this,e||[],!0))},is:function(e){return!!z(this,"string"==typeof e&&H.test(e)?x(e):e||[],!1).length}});var V,W=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(x.fn.init=function(e,t,i){var n,s;if(!e)return this;if(i=i||V,"string"==typeof e){if(!(n="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:W.exec(e))||!n[1]&&t)return!t||t.jquery?(t||i).find(e):this.constructor(t).find(e);if(n[1]){if(t=t instanceof x?t[0]:t,x.merge(this,x.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:b,!0)),B.test(n[1])&&x.isPlainObject(t))for(n in t)v(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}return(s=b.getElementById(n[2]))&&(this[0]=s,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):v(e)?void 0!==i.ready?i.ready(e):e(x):x.makeArray(e,this)}).prototype=x.fn,V=x(b);var $=/^(?:parents|prev(?:Until|All))/,U={children:!0,contents:!0,next:!0,prev:!0};function q(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}x.fn.extend({has:function(e){var t=x(e,this),i=t.length;return this.filter((function(){for(var e=0;e<i;e++)if(x.contains(this,t[e]))return!0}))},closest:function(e,t){var i,n=0,s=this.length,r=[],o="string"!=typeof e&&x(e);if(!H.test(e))for(;n<s;n++)for(i=this[n];i&&i!==t;i=i.parentNode)if(i.nodeType<11&&(o?o.index(i)>-1:1===i.nodeType&&x.find.matchesSelector(i,e))){r.push(i);break}return this.pushStack(r.length>1?x.uniqueSort(r):r)},index:function(e){return e?"string"==typeof e?h.call(x(e),this[0]):h.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(x.uniqueSort(x.merge(this.get(),x(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),x.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return N(e,"parentNode")},parentsUntil:function(e,t,i){return N(e,"parentNode",i)},next:function(e){return q(e,"nextSibling")},prev:function(e){return q(e,"previousSibling")},nextAll:function(e){return N(e,"nextSibling")},prevAll:function(e){return N(e,"previousSibling")},nextUntil:function(e,t,i){return N(e,"nextSibling",i)},prevUntil:function(e,t,i){return N(e,"previousSibling",i)},siblings:function(e){return F((e.parentNode||{}).firstChild,e)},children:function(e){return F(e.firstChild)},contents:function(e){return null!=e.contentDocument&&o(e.contentDocument)?e.contentDocument:(A(e,"template")&&(e=e.content||e),x.merge([],e.childNodes))}},(function(e,t){x.fn[e]=function(i,n){var s=x.map(this,t,i);return"Until"!==e.slice(-5)&&(n=i),n&&"string"==typeof n&&(s=x.filter(n,s)),this.length>1&&(U[e]||x.uniqueSort(s),$.test(e)&&s.reverse()),this.pushStack(s)}}));var G=/[^\x20\t\r\n\f]+/g;function K(e){return e}function Y(e){throw e}function X(e,t,i,n){var s;try{e&&v(s=e.promise)?s.call(e).done(t).fail(i):e&&v(s=e.then)?s.call(e,t,i):t.apply(void 0,[e].slice(n))}catch(e){i.apply(void 0,[e])}}x.Callbacks=function(e){e="string"==typeof e?function(e){var t={};return x.each(e.match(G)||[],(function(e,i){t[i]=!0})),t}(e):x.extend({},e);var t,i,n,s,r=[],o=[],a=-1,l=function(){for(s=s||e.once,n=t=!0;o.length;a=-1)for(i=o.shift();++a<r.length;)!1===r[a].apply(i[0],i[1])&&e.stopOnFalse&&(a=r.length,i=!1);e.memory||(i=!1),t=!1,s&&(r=i?[]:"")},c={add:function(){return r&&(i&&!t&&(a=r.length-1,o.push(i)),function t(i){x.each(i,(function(i,n){v(n)?e.unique&&c.has(n)||r.push(n):n&&n.length&&"string"!==w(n)&&t(n)}))}(arguments),i&&!t&&l()),this},remove:function(){return x.each(arguments,(function(e,t){for(var i;(i=x.inArray(t,r,i))>-1;)r.splice(i,1),i<=a&&a--})),this},has:function(e){return e?x.inArray(e,r)>-1:r.length>0},empty:function(){return r&&(r=[]),this},disable:function(){return s=o=[],r=i="",this},disabled:function(){return!r},lock:function(){return s=o=[],i||t||(r=i=""),this},locked:function(){return!!s},fireWith:function(e,i){return s||(i=[e,(i=i||[]).slice?i.slice():i],o.push(i),t||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!n}};return c},x.extend({Deferred:function(e){var t=[["notify","progress",x.Callbacks("memory"),x.Callbacks("memory"),2],["resolve","done",x.Callbacks("once memory"),x.Callbacks("once memory"),0,"resolved"],["reject","fail",x.Callbacks("once memory"),x.Callbacks("once memory"),1,"rejected"]],i="pending",s={state:function(){return i},always:function(){return r.done(arguments).fail(arguments),this},catch:function(e){return s.then(null,e)},pipe:function(){var e=arguments;return x.Deferred((function(i){x.each(t,(function(t,n){var s=v(e[n[4]])&&e[n[4]];r[n[1]]((function(){var e=s&&s.apply(this,arguments);e&&v(e.promise)?e.promise().progress(i.notify).done(i.resolve).fail(i.reject):i[n[0]+"With"](this,s?[e]:arguments)}))})),e=null})).promise()},then:function(e,i,s){var r=0;function o(e,t,i,s){return function(){var a=this,l=arguments,c=function(){var n,c;if(!(e<r)){if((n=i.apply(a,l))===t.promise())throw new TypeError("Thenable self-resolution");c=n&&("object"==typeof n||"function"==typeof n)&&n.then,v(c)?s?c.call(n,o(r,t,K,s),o(r,t,Y,s)):(r++,c.call(n,o(r,t,K,s),o(r,t,Y,s),o(r,t,K,t.notifyWith))):(i!==K&&(a=void 0,l=[n]),(s||t.resolveWith)(a,l))}},h=s?c:function(){try{c()}catch(n){x.Deferred.exceptionHook&&x.Deferred.exceptionHook(n,h.error),e+1>=r&&(i!==Y&&(a=void 0,l=[n]),t.rejectWith(a,l))}};e?h():(x.Deferred.getErrorHook?h.error=x.Deferred.getErrorHook():x.Deferred.getStackHook&&(h.error=x.Deferred.getStackHook()),n.setTimeout(h))}}return x.Deferred((function(n){t[0][3].add(o(0,n,v(s)?s:K,n.notifyWith)),t[1][3].add(o(0,n,v(e)?e:K)),t[2][3].add(o(0,n,v(i)?i:Y))})).promise()},promise:function(e){return null!=e?x.extend(e,s):s}},r={};return x.each(t,(function(e,n){var o=n[2],a=n[5];s[n[1]]=o.add,a&&o.add((function(){i=a}),t[3-e][2].disable,t[3-e][3].disable,t[0][2].lock,t[0][3].lock),o.add(n[3].fire),r[n[0]]=function(){return r[n[0]+"With"](this===r?void 0:this,arguments),this},r[n[0]+"With"]=o.fireWith})),s.promise(r),e&&e.call(r,r),r},when:function(e){var t=arguments.length,i=t,n=Array(i),s=a.call(arguments),r=x.Deferred(),o=function(e){return function(i){n[e]=this,s[e]=arguments.length>1?a.call(arguments):i,--t||r.resolveWith(n,s)}};if(t<=1&&(X(e,r.done(o(i)).resolve,r.reject,!t),"pending"===r.state()||v(s[i]&&s[i].then)))return r.then();for(;i--;)X(s[i],o(i),r.reject);return r.promise()}});var Z=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;x.Deferred.exceptionHook=function(e,t){n.console&&n.console.warn&&e&&Z.test(e.name)&&n.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},x.readyException=function(e){n.setTimeout((function(){throw e}))};var Q=x.Deferred();function J(){b.removeEventListener("DOMContentLoaded",J),n.removeEventListener("load",J),x.ready()}x.fn.ready=function(e){return Q.then(e).catch((function(e){x.readyException(e)})),this},x.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--x.readyWait:x.isReady)||(x.isReady=!0,!0!==e&&--x.readyWait>0||Q.resolveWith(b,[x]))}}),x.ready.then=Q.then,"complete"===b.readyState||"loading"!==b.readyState&&!b.documentElement.doScroll?n.setTimeout(x.ready):(b.addEventListener("DOMContentLoaded",J),n.addEventListener("load",J));var ee=function(e,t,i,n,s,r,o){var a=0,l=e.length,c=null==i;if("object"===w(i))for(a in s=!0,i)ee(e,t,a,i[a],!0,r,o);else if(void 0!==n&&(s=!0,v(n)||(o=!0),c&&(o?(t.call(e,n),t=null):(c=t,t=function(e,t,i){return c.call(x(e),i)})),t))for(;a<l;a++)t(e[a],i,o?n:n.call(e[a],a,t(e[a],i)));return s?e:c?t.call(e):l?t(e[0],i):r},te=/^-ms-/,ie=/-([a-z])/g;function ne(e,t){return t.toUpperCase()}function se(e){return e.replace(te,"ms-").replace(ie,ne)}var re=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function oe(){this.expando=x.expando+oe.uid++}oe.uid=1,oe.prototype={cache:function(e){var t=e[this.expando];return t||(t={},re(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,i){var n,s=this.cache(e);if("string"==typeof t)s[se(t)]=i;else for(n in t)s[se(n)]=t[n];return s},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][se(t)]},access:function(e,t,i){return void 0===t||t&&"string"==typeof t&&void 0===i?this.get(e,t):(this.set(e,t,i),void 0!==i?i:t)},remove:function(e,t){var i,n=e[this.expando];if(void 0!==n){if(void 0!==t){i=(t=Array.isArray(t)?t.map(se):(t=se(t))in n?[t]:t.match(G)||[]).length;for(;i--;)delete n[t[i]]}(void 0===t||x.isEmptyObject(n))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!x.isEmptyObject(t)}};var ae=new oe,le=new oe,ce=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,he=/[A-Z]/g;function de(e,t,i){var n;if(void 0===i&&1===e.nodeType)if(n="data-"+t.replace(he,"-$&").toLowerCase(),"string"==typeof(i=e.getAttribute(n))){try{i=function(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:ce.test(e)?JSON.parse(e):e)}(i)}catch(e){}le.set(e,t,i)}else i=void 0;return i}x.extend({hasData:function(e){return le.hasData(e)||ae.hasData(e)},data:function(e,t,i){return le.access(e,t,i)},removeData:function(e,t){le.remove(e,t)},_data:function(e,t,i){return ae.access(e,t,i)},_removeData:function(e,t){ae.remove(e,t)}}),x.fn.extend({data:function(e,t){var i,n,s,r=this[0],o=r&&r.attributes;if(void 0===e){if(this.length&&(s=le.get(r),1===r.nodeType&&!ae.get(r,"hasDataAttrs"))){for(i=o.length;i--;)o[i]&&0===(n=o[i].name).indexOf("data-")&&(n=se(n.slice(5)),de(r,n,s[n]));ae.set(r,"hasDataAttrs",!0)}return s}return"object"==typeof e?this.each((function(){le.set(this,e)})):ee(this,(function(t){var i;if(r&&void 0===t)return void 0!==(i=le.get(r,e))||void 0!==(i=de(r,e))?i:void 0;this.each((function(){le.set(this,e,t)}))}),null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each((function(){le.remove(this,e)}))}}),x.extend({queue:function(e,t,i){var n;if(e)return t=(t||"fx")+"queue",n=ae.get(e,t),i&&(!n||Array.isArray(i)?n=ae.access(e,t,x.makeArray(i)):n.push(i)),n||[]},dequeue:function(e,t){t=t||"fx";var i=x.queue(e,t),n=i.length,s=i.shift(),r=x._queueHooks(e,t);"inprogress"===s&&(s=i.shift(),n--),s&&("fx"===t&&i.unshift("inprogress"),delete r.stop,s.call(e,(function(){x.dequeue(e,t)}),r)),!n&&r&&r.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return ae.get(e,i)||ae.access(e,i,{empty:x.Callbacks("once memory").add((function(){ae.remove(e,[t+"queue",i])}))})}}),x.fn.extend({queue:function(e,t){var i=2;return"string"!=typeof e&&(t=e,e="fx",i--),arguments.length<i?x.queue(this[0],e):void 0===t?this:this.each((function(){var i=x.queue(this,e,t);x._queueHooks(this,e),"fx"===e&&"inprogress"!==i[0]&&x.dequeue(this,e)}))},dequeue:function(e){return this.each((function(){x.dequeue(this,e)}))},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var i,n=1,s=x.Deferred(),r=this,o=this.length,a=function(){--n||s.resolveWith(r,[r])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";o--;)(i=ae.get(r[o],e+"queueHooks"))&&i.empty&&(n++,i.empty.add(a));return a(),s.promise(t)}});var ue=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,pe=new RegExp("^(?:([+-])=|)("+ue+")([a-z%]*)$","i"),fe=["Top","Right","Bottom","Left"],me=b.documentElement,ge=function(e){return x.contains(e.ownerDocument,e)},ve={composed:!0};me.getRootNode&&(ge=function(e){return x.contains(e.ownerDocument,e)||e.getRootNode(ve)===e.ownerDocument});var _e=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&ge(e)&&"none"===x.css(e,"display")};function be(e,t,i,n){var s,r,o=20,a=n?function(){return n.cur()}:function(){return x.css(e,t,"")},l=a(),c=i&&i[3]||(x.cssNumber[t]?"":"px"),h=e.nodeType&&(x.cssNumber[t]||"px"!==c&&+l)&&pe.exec(x.css(e,t));if(h&&h[3]!==c){for(l/=2,c=c||h[3],h=+l||1;o--;)x.style(e,t,h+c),(1-r)*(1-(r=a()/l||.5))<=0&&(o=0),h/=r;h*=2,x.style(e,t,h+c),i=i||[]}return i&&(h=+h||+l||0,s=i[1]?h+(i[1]+1)*i[2]:+i[2],n&&(n.unit=c,n.start=h,n.end=s)),s}var ye={};function Ce(e){var t,i=e.ownerDocument,n=e.nodeName,s=ye[n];return s||(t=i.body.appendChild(i.createElement(n)),s=x.css(t,"display"),t.parentNode.removeChild(t),"none"===s&&(s="block"),ye[n]=s,s)}function we(e,t){for(var i,n,s=[],r=0,o=e.length;r<o;r++)(n=e[r]).style&&(i=n.style.display,t?("none"===i&&(s[r]=ae.get(n,"display")||null,s[r]||(n.style.display="")),""===n.style.display&&_e(n)&&(s[r]=Ce(n))):"none"!==i&&(s[r]="none",ae.set(n,"display",i)));for(r=0;r<o;r++)null!=s[r]&&(e[r].style.display=s[r]);return e}x.fn.extend({show:function(){return we(this,!0)},hide:function(){return we(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each((function(){_e(this)?x(this).show():x(this).hide()}))}});var Se,Ee,xe=/^(?:checkbox|radio)$/i,Te=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Ae=/^$|^module$|\/(?:java|ecma)script/i;Se=b.createDocumentFragment().appendChild(b.createElement("div")),(Ee=b.createElement("input")).setAttribute("type","radio"),Ee.setAttribute("checked","checked"),Ee.setAttribute("name","t"),Se.appendChild(Ee),g.checkClone=Se.cloneNode(!0).cloneNode(!0).lastChild.checked,Se.innerHTML="<textarea>x</textarea>",g.noCloneChecked=!!Se.cloneNode(!0).lastChild.defaultValue,Se.innerHTML="<option></option>",g.option=!!Se.lastChild;var Oe={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function Ie(e,t){var i;return i=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&A(e,t)?x.merge([e],i):i}function ke(e,t){for(var i=0,n=e.length;i<n;i++)ae.set(e[i],"globalEval",!t||ae.get(t[i],"globalEval"))}Oe.tbody=Oe.tfoot=Oe.colgroup=Oe.caption=Oe.thead,Oe.th=Oe.td,g.option||(Oe.optgroup=Oe.option=[1,"<select multiple='multiple'>","</select>"]);var De=/<|&#?\w+;/;function je(e,t,i,n,s){for(var r,o,a,l,c,h,d=t.createDocumentFragment(),u=[],p=0,f=e.length;p<f;p++)if((r=e[p])||0===r)if("object"===w(r))x.merge(u,r.nodeType?[r]:r);else if(De.test(r)){for(o=o||d.appendChild(t.createElement("div")),a=(Te.exec(r)||["",""])[1].toLowerCase(),l=Oe[a]||Oe._default,o.innerHTML=l[1]+x.htmlPrefilter(r)+l[2],h=l[0];h--;)o=o.lastChild;x.merge(u,o.childNodes),(o=d.firstChild).textContent=""}else u.push(t.createTextNode(r));for(d.textContent="",p=0;r=u[p++];)if(n&&x.inArray(r,n)>-1)s&&s.push(r);else if(c=ge(r),o=Ie(d.appendChild(r),"script"),c&&ke(o),i)for(h=0;r=o[h++];)Ae.test(r.type||"")&&i.push(r);return d}var Re=/^([^.]*)(?:\.(.+)|)/;function Le(){return!0}function Me(){return!1}function Pe(e,t,i,n,s,r){var o,a;if("object"==typeof t){for(a in"string"!=typeof i&&(n=n||i,i=void 0),t)Pe(e,a,i,n,t[a],r);return e}if(null==n&&null==s?(s=i,n=i=void 0):null==s&&("string"==typeof i?(s=n,n=void 0):(s=n,n=i,i=void 0)),!1===s)s=Me;else if(!s)return e;return 1===r&&(o=s,s=function(e){return x().off(e),o.apply(this,arguments)},s.guid=o.guid||(o.guid=x.guid++)),e.each((function(){x.event.add(this,t,s,n,i)}))}function Ne(e,t,i){i?(ae.set(e,t,!1),x.event.add(e,t,{namespace:!1,handler:function(e){var i,n=ae.get(this,t);if(1&e.isTrigger&&this[t]){if(n)(x.event.special[t]||{}).delegateType&&e.stopPropagation();else if(n=a.call(arguments),ae.set(this,t,n),this[t](),i=ae.get(this,t),ae.set(this,t,!1),n!==i)return e.stopImmediatePropagation(),e.preventDefault(),i}else n&&(ae.set(this,t,x.event.trigger(n[0],n.slice(1),this)),e.stopPropagation(),e.isImmediatePropagationStopped=Le)}})):void 0===ae.get(e,t)&&x.event.add(e,t,Le)}x.event={global:{},add:function(e,t,i,n,s){var r,o,a,l,c,h,d,u,p,f,m,g=ae.get(e);if(re(e))for(i.handler&&(i=(r=i).handler,s=r.selector),s&&x.find.matchesSelector(me,s),i.guid||(i.guid=x.guid++),(l=g.events)||(l=g.events=Object.create(null)),(o=g.handle)||(o=g.handle=function(t){return void 0!==x&&x.event.triggered!==t.type?x.event.dispatch.apply(e,arguments):void 0}),c=(t=(t||"").match(G)||[""]).length;c--;)p=m=(a=Re.exec(t[c])||[])[1],f=(a[2]||"").split(".").sort(),p&&(d=x.event.special[p]||{},p=(s?d.delegateType:d.bindType)||p,d=x.event.special[p]||{},h=x.extend({type:p,origType:m,data:n,handler:i,guid:i.guid,selector:s,needsContext:s&&x.expr.match.needsContext.test(s),namespace:f.join(".")},r),(u=l[p])||((u=l[p]=[]).delegateCount=0,d.setup&&!1!==d.setup.call(e,n,f,o)||e.addEventListener&&e.addEventListener(p,o)),d.add&&(d.add.call(e,h),h.handler.guid||(h.handler.guid=i.guid)),s?u.splice(u.delegateCount++,0,h):u.push(h),x.event.global[p]=!0)},remove:function(e,t,i,n,s){var r,o,a,l,c,h,d,u,p,f,m,g=ae.hasData(e)&&ae.get(e);if(g&&(l=g.events)){for(c=(t=(t||"").match(G)||[""]).length;c--;)if(p=m=(a=Re.exec(t[c])||[])[1],f=(a[2]||"").split(".").sort(),p){for(d=x.event.special[p]||{},u=l[p=(n?d.delegateType:d.bindType)||p]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=r=u.length;r--;)h=u[r],!s&&m!==h.origType||i&&i.guid!==h.guid||a&&!a.test(h.namespace)||n&&n!==h.selector&&("**"!==n||!h.selector)||(u.splice(r,1),h.selector&&u.delegateCount--,d.remove&&d.remove.call(e,h));o&&!u.length&&(d.teardown&&!1!==d.teardown.call(e,f,g.handle)||x.removeEvent(e,p,g.handle),delete l[p])}else for(p in l)x.event.remove(e,p+t[c],i,n,!0);x.isEmptyObject(l)&&ae.remove(e,"handle events")}},dispatch:function(e){var t,i,n,s,r,o,a=new Array(arguments.length),l=x.event.fix(e),c=(ae.get(this,"events")||Object.create(null))[l.type]||[],h=x.event.special[l.type]||{};for(a[0]=l,t=1;t<arguments.length;t++)a[t]=arguments[t];if(l.delegateTarget=this,!h.preDispatch||!1!==h.preDispatch.call(this,l)){for(o=x.event.handlers.call(this,l,c),t=0;(s=o[t++])&&!l.isPropagationStopped();)for(l.currentTarget=s.elem,i=0;(r=s.handlers[i++])&&!l.isImmediatePropagationStopped();)l.rnamespace&&!1!==r.namespace&&!l.rnamespace.test(r.namespace)||(l.handleObj=r,l.data=r.data,void 0!==(n=((x.event.special[r.origType]||{}).handle||r.handler).apply(s.elem,a))&&!1===(l.result=n)&&(l.preventDefault(),l.stopPropagation()));return h.postDispatch&&h.postDispatch.call(this,l),l.result}},handlers:function(e,t){var i,n,s,r,o,a=[],l=t.delegateCount,c=e.target;if(l&&c.nodeType&&!("click"===e.type&&e.button>=1))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==e.type||!0!==c.disabled)){for(r=[],o={},i=0;i<l;i++)void 0===o[s=(n=t[i]).selector+" "]&&(o[s]=n.needsContext?x(s,this).index(c)>-1:x.find(s,this,null,[c]).length),o[s]&&r.push(n);r.length&&a.push({elem:c,handlers:r})}return c=this,l<t.length&&a.push({elem:c,handlers:t.slice(l)}),a},addProp:function(e,t){Object.defineProperty(x.Event.prototype,e,{enumerable:!0,configurable:!0,get:v(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[x.expando]?e:new x.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return xe.test(t.type)&&t.click&&A(t,"input")&&Ne(t,"click",!0),!1},trigger:function(e){var t=this||e;return xe.test(t.type)&&t.click&&A(t,"input")&&Ne(t,"click"),!0},_default:function(e){var t=e.target;return xe.test(t.type)&&t.click&&A(t,"input")&&ae.get(t,"click")||A(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},x.removeEvent=function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i)},x.Event=function(e,t){if(!(this instanceof x.Event))return new x.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Le:Me,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&x.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[x.expando]=!0},x.Event.prototype={constructor:x.Event,isDefaultPrevented:Me,isPropagationStopped:Me,isImmediatePropagationStopped:Me,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Le,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Le,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Le,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},x.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},x.event.addProp),x.each({focus:"focusin",blur:"focusout"},(function(e,t){function i(e){if(b.documentMode){var i=ae.get(this,"handle"),n=x.event.fix(e);n.type="focusin"===e.type?"focus":"blur",n.isSimulated=!0,i(e),n.target===n.currentTarget&&i(n)}else x.event.simulate(t,e.target,x.event.fix(e))}x.event.special[e]={setup:function(){var n;if(Ne(this,e,!0),!b.documentMode)return!1;(n=ae.get(this,t))||this.addEventListener(t,i),ae.set(this,t,(n||0)+1)},trigger:function(){return Ne(this,e),!0},teardown:function(){var e;if(!b.documentMode)return!1;(e=ae.get(this,t)-1)?ae.set(this,t,e):(this.removeEventListener(t,i),ae.remove(this,t))},_default:function(t){return ae.get(t.target,e)},delegateType:t},x.event.special[t]={setup:function(){var n=this.ownerDocument||this.document||this,s=b.documentMode?this:n,r=ae.get(s,t);r||(b.documentMode?this.addEventListener(t,i):n.addEventListener(e,i,!0)),ae.set(s,t,(r||0)+1)},teardown:function(){var n=this.ownerDocument||this.document||this,s=b.documentMode?this:n,r=ae.get(s,t)-1;r?ae.set(s,t,r):(b.documentMode?this.removeEventListener(t,i):n.removeEventListener(e,i,!0),ae.remove(s,t))}}})),x.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(e,t){x.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,n=e.relatedTarget,s=e.handleObj;return n&&(n===this||x.contains(this,n))||(e.type=s.origType,i=s.handler.apply(this,arguments),e.type=t),i}}})),x.fn.extend({on:function(e,t,i,n){return Pe(this,e,t,i,n)},one:function(e,t,i,n){return Pe(this,e,t,i,n,1)},off:function(e,t,i){var n,s;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,x(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof e){for(s in e)this.off(s,t,e[s]);return this}return!1!==t&&"function"!=typeof t||(i=t,t=void 0),!1===i&&(i=Me),this.each((function(){x.event.remove(this,e,i,t)}))}});var Fe=/<script|<style|<link/i,He=/checked\s*(?:[^=]|=\s*.checked.)/i,Be=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function ze(e,t){return A(e,"table")&&A(11!==t.nodeType?t:t.firstChild,"tr")&&x(e).children("tbody")[0]||e}function Ve(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function We(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function $e(e,t){var i,n,s,r,o,a;if(1===t.nodeType){if(ae.hasData(e)&&(a=ae.get(e).events))for(s in ae.remove(t,"handle events"),a)for(i=0,n=a[s].length;i<n;i++)x.event.add(t,s,a[s][i]);le.hasData(e)&&(r=le.access(e),o=x.extend({},r),le.set(t,o))}}function Ue(e,t){var i=t.nodeName.toLowerCase();"input"===i&&xe.test(e.type)?t.checked=e.checked:"input"!==i&&"textarea"!==i||(t.defaultValue=e.defaultValue)}function qe(e,t,i,n){t=l(t);var s,r,o,a,c,h,d=0,u=e.length,p=u-1,f=t[0],m=v(f);if(m||u>1&&"string"==typeof f&&!g.checkClone&&He.test(f))return e.each((function(s){var r=e.eq(s);m&&(t[0]=f.call(this,s,r.html())),qe(r,t,i,n)}));if(u&&(r=(s=je(t,e[0].ownerDocument,!1,e,n)).firstChild,1===s.childNodes.length&&(s=r),r||n)){for(a=(o=x.map(Ie(s,"script"),Ve)).length;d<u;d++)c=s,d!==p&&(c=x.clone(c,!0,!0),a&&x.merge(o,Ie(c,"script"))),i.call(e[d],c,d);if(a)for(h=o[o.length-1].ownerDocument,x.map(o,We),d=0;d<a;d++)c=o[d],Ae.test(c.type||"")&&!ae.access(c,"globalEval")&&x.contains(h,c)&&(c.src&&"module"!==(c.type||"").toLowerCase()?x._evalUrl&&!c.noModule&&x._evalUrl(c.src,{nonce:c.nonce||c.getAttribute("nonce")},h):C(c.textContent.replace(Be,""),c,h))}return e}function Ge(e,t,i){for(var n,s=t?x.filter(t,e):e,r=0;null!=(n=s[r]);r++)i||1!==n.nodeType||x.cleanData(Ie(n)),n.parentNode&&(i&&ge(n)&&ke(Ie(n,"script")),n.parentNode.removeChild(n));return e}x.extend({htmlPrefilter:function(e){return e},clone:function(e,t,i){var n,s,r,o,a=e.cloneNode(!0),l=ge(e);if(!(g.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||x.isXMLDoc(e)))for(o=Ie(a),n=0,s=(r=Ie(e)).length;n<s;n++)Ue(r[n],o[n]);if(t)if(i)for(r=r||Ie(e),o=o||Ie(a),n=0,s=r.length;n<s;n++)$e(r[n],o[n]);else $e(e,a);return(o=Ie(a,"script")).length>0&&ke(o,!l&&Ie(e,"script")),a},cleanData:function(e){for(var t,i,n,s=x.event.special,r=0;void 0!==(i=e[r]);r++)if(re(i)){if(t=i[ae.expando]){if(t.events)for(n in t.events)s[n]?x.event.remove(i,n):x.removeEvent(i,n,t.handle);i[ae.expando]=void 0}i[le.expando]&&(i[le.expando]=void 0)}}}),x.fn.extend({detach:function(e){return Ge(this,e,!0)},remove:function(e){return Ge(this,e)},text:function(e){return ee(this,(function(e){return void 0===e?x.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)}))}),null,e,arguments.length)},append:function(){return qe(this,arguments,(function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||ze(this,e).appendChild(e)}))},prepend:function(){return qe(this,arguments,(function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=ze(this,e);t.insertBefore(e,t.firstChild)}}))},before:function(){return qe(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this)}))},after:function(){return qe(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)}))},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(x.cleanData(Ie(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map((function(){return x.clone(this,e,t)}))},html:function(e){return ee(this,(function(e){var t=this[0]||{},i=0,n=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Fe.test(e)&&!Oe[(Te.exec(e)||["",""])[1].toLowerCase()]){e=x.htmlPrefilter(e);try{for(;i<n;i++)1===(t=this[i]||{}).nodeType&&(x.cleanData(Ie(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)}),null,e,arguments.length)},replaceWith:function(){var e=[];return qe(this,arguments,(function(t){var i=this.parentNode;x.inArray(this,e)<0&&(x.cleanData(Ie(this)),i&&i.replaceChild(t,this))}),e)}}),x.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(e,t){x.fn[e]=function(e){for(var i,n=[],s=x(e),r=s.length-1,o=0;o<=r;o++)i=o===r?this:this.clone(!0),x(s[o])[t](i),c.apply(n,i.get());return this.pushStack(n)}}));var Ke=new RegExp("^("+ue+")(?!px)[a-z%]+$","i"),Ye=/^--/,Xe=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=n),t.getComputedStyle(e)},Ze=function(e,t,i){var n,s,r={};for(s in t)r[s]=e.style[s],e.style[s]=t[s];for(s in n=i.call(e),t)e.style[s]=r[s];return n},Qe=new RegExp(fe.join("|"),"i");function Je(e,t,i){var n,s,r,o,a=Ye.test(t),l=e.style;return(i=i||Xe(e))&&(o=i.getPropertyValue(t)||i[t],a&&o&&(o=o.replace(j,"$1")||void 0),""!==o||ge(e)||(o=x.style(e,t)),!g.pixelBoxStyles()&&Ke.test(o)&&Qe.test(t)&&(n=l.width,s=l.minWidth,r=l.maxWidth,l.minWidth=l.maxWidth=l.width=o,o=i.width,l.width=n,l.minWidth=s,l.maxWidth=r)),void 0!==o?o+"":o}function et(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(h){c.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",h.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",me.appendChild(c).appendChild(h);var e=n.getComputedStyle(h);i="1%"!==e.top,l=12===t(e.marginLeft),h.style.right="60%",o=36===t(e.right),s=36===t(e.width),h.style.position="absolute",r=12===t(h.offsetWidth/3),me.removeChild(c),h=null}}function t(e){return Math.round(parseFloat(e))}var i,s,r,o,a,l,c=b.createElement("div"),h=b.createElement("div");h.style&&(h.style.backgroundClip="content-box",h.cloneNode(!0).style.backgroundClip="",g.clearCloneStyle="content-box"===h.style.backgroundClip,x.extend(g,{boxSizingReliable:function(){return e(),s},pixelBoxStyles:function(){return e(),o},pixelPosition:function(){return e(),i},reliableMarginLeft:function(){return e(),l},scrollboxSize:function(){return e(),r},reliableTrDimensions:function(){var e,t,i,s;return null==a&&(e=b.createElement("table"),t=b.createElement("tr"),i=b.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",t.style.cssText="box-sizing:content-box;border:1px solid",t.style.height="1px",i.style.height="9px",i.style.display="block",me.appendChild(e).appendChild(t).appendChild(i),s=n.getComputedStyle(t),a=parseInt(s.height,10)+parseInt(s.borderTopWidth,10)+parseInt(s.borderBottomWidth,10)===t.offsetHeight,me.removeChild(e)),a}}))}();var tt=["Webkit","Moz","ms"],it=b.createElement("div").style,nt={};function st(e){return x.cssProps[e]||nt[e]||(e in it?e:nt[e]=function(e){for(var t=e[0].toUpperCase()+e.slice(1),i=tt.length;i--;)if((e=tt[i]+t)in it)return e}(e)||e)}var rt=/^(none|table(?!-c[ea]).+)/,ot={position:"absolute",visibility:"hidden",display:"block"},at={letterSpacing:"0",fontWeight:"400"};function lt(e,t,i){var n=pe.exec(t);return n?Math.max(0,n[2]-(i||0))+(n[3]||"px"):t}function ct(e,t,i,n,s,r){var o="width"===t?1:0,a=0,l=0,c=0;if(i===(n?"border":"content"))return 0;for(;o<4;o+=2)"margin"===i&&(c+=x.css(e,i+fe[o],!0,s)),n?("content"===i&&(l-=x.css(e,"padding"+fe[o],!0,s)),"margin"!==i&&(l-=x.css(e,"border"+fe[o]+"Width",!0,s))):(l+=x.css(e,"padding"+fe[o],!0,s),"padding"!==i?l+=x.css(e,"border"+fe[o]+"Width",!0,s):a+=x.css(e,"border"+fe[o]+"Width",!0,s));return!n&&r>=0&&(l+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-r-l-a-.5))||0),l+c}function ht(e,t,i){var n=Xe(e),s=(!g.boxSizingReliable()||i)&&"border-box"===x.css(e,"boxSizing",!1,n),r=s,o=Je(e,t,n),a="offset"+t[0].toUpperCase()+t.slice(1);if(Ke.test(o)){if(!i)return o;o="auto"}return(!g.boxSizingReliable()&&s||!g.reliableTrDimensions()&&A(e,"tr")||"auto"===o||!parseFloat(o)&&"inline"===x.css(e,"display",!1,n))&&e.getClientRects().length&&(s="border-box"===x.css(e,"boxSizing",!1,n),(r=a in e)&&(o=e[a])),(o=parseFloat(o)||0)+ct(e,t,i||(s?"border":"content"),r,n,o)+"px"}function dt(e,t,i,n,s){return new dt.prototype.init(e,t,i,n,s)}x.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=Je(e,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(e,t,i,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var s,r,o,a=se(t),l=Ye.test(t),c=e.style;if(l||(t=st(a)),o=x.cssHooks[t]||x.cssHooks[a],void 0===i)return o&&"get"in o&&void 0!==(s=o.get(e,!1,n))?s:c[t];"string"==(r=typeof i)&&(s=pe.exec(i))&&s[1]&&(i=be(e,t,s),r="number"),null!=i&&i==i&&("number"!==r||l||(i+=s&&s[3]||(x.cssNumber[a]?"":"px")),g.clearCloneStyle||""!==i||0!==t.indexOf("background")||(c[t]="inherit"),o&&"set"in o&&void 0===(i=o.set(e,i,n))||(l?c.setProperty(t,i):c[t]=i))}},css:function(e,t,i,n){var s,r,o,a=se(t);return Ye.test(t)||(t=st(a)),(o=x.cssHooks[t]||x.cssHooks[a])&&"get"in o&&(s=o.get(e,!0,i)),void 0===s&&(s=Je(e,t,n)),"normal"===s&&t in at&&(s=at[t]),""===i||i?(r=parseFloat(s),!0===i||isFinite(r)?r||0:s):s}}),x.each(["height","width"],(function(e,t){x.cssHooks[t]={get:function(e,i,n){if(i)return!rt.test(x.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?ht(e,t,n):Ze(e,ot,(function(){return ht(e,t,n)}))},set:function(e,i,n){var s,r=Xe(e),o=!g.scrollboxSize()&&"absolute"===r.position,a=(o||n)&&"border-box"===x.css(e,"boxSizing",!1,r),l=n?ct(e,t,n,a,r):0;return a&&o&&(l-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(r[t])-ct(e,t,"border",!1,r)-.5)),l&&(s=pe.exec(i))&&"px"!==(s[3]||"px")&&(e.style[t]=i,i=x.css(e,t)),lt(0,i,l)}}})),x.cssHooks.marginLeft=et(g.reliableMarginLeft,(function(e,t){if(t)return(parseFloat(Je(e,"marginLeft"))||e.getBoundingClientRect().left-Ze(e,{marginLeft:0},(function(){return e.getBoundingClientRect().left})))+"px"})),x.each({margin:"",padding:"",border:"Width"},(function(e,t){x.cssHooks[e+t]={expand:function(i){for(var n=0,s={},r="string"==typeof i?i.split(" "):[i];n<4;n++)s[e+fe[n]+t]=r[n]||r[n-2]||r[0];return s}},"margin"!==e&&(x.cssHooks[e+t].set=lt)})),x.fn.extend({css:function(e,t){return ee(this,(function(e,t,i){var n,s,r={},o=0;if(Array.isArray(t)){for(n=Xe(e),s=t.length;o<s;o++)r[t[o]]=x.css(e,t[o],!1,n);return r}return void 0!==i?x.style(e,t,i):x.css(e,t)}),e,t,arguments.length>1)}}),x.Tween=dt,dt.prototype={constructor:dt,init:function(e,t,i,n,s,r){this.elem=e,this.prop=i,this.easing=s||x.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=r||(x.cssNumber[i]?"":"px")},cur:function(){var e=dt.propHooks[this.prop];return e&&e.get?e.get(this):dt.propHooks._default.get(this)},run:function(e){var t,i=dt.propHooks[this.prop];return this.options.duration?this.pos=t=x.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):dt.propHooks._default.set(this),this}},dt.prototype.init.prototype=dt.prototype,dt.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=x.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){x.fx.step[e.prop]?x.fx.step[e.prop](e):1!==e.elem.nodeType||!x.cssHooks[e.prop]&&null==e.elem.style[st(e.prop)]?e.elem[e.prop]=e.now:x.style(e.elem,e.prop,e.now+e.unit)}}},dt.propHooks.scrollTop=dt.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},x.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},x.fx=dt.prototype.init,x.fx.step={};var ut,pt,ft=/^(?:toggle|show|hide)$/,mt=/queueHooks$/;function gt(){pt&&(!1===b.hidden&&n.requestAnimationFrame?n.requestAnimationFrame(gt):n.setTimeout(gt,x.fx.interval),x.fx.tick())}function vt(){return n.setTimeout((function(){ut=void 0})),ut=Date.now()}function _t(e,t){var i,n=0,s={height:e};for(t=t?1:0;n<4;n+=2-t)s["margin"+(i=fe[n])]=s["padding"+i]=e;return t&&(s.opacity=s.width=e),s}function bt(e,t,i){for(var n,s=(yt.tweeners[t]||[]).concat(yt.tweeners["*"]),r=0,o=s.length;r<o;r++)if(n=s[r].call(i,t,e))return n}function yt(e,t,i){var n,s,r=0,o=yt.prefilters.length,a=x.Deferred().always((function(){delete l.elem})),l=function(){if(s)return!1;for(var t=ut||vt(),i=Math.max(0,c.startTime+c.duration-t),n=1-(i/c.duration||0),r=0,o=c.tweens.length;r<o;r++)c.tweens[r].run(n);return a.notifyWith(e,[c,n,i]),n<1&&o?i:(o||a.notifyWith(e,[c,1,0]),a.resolveWith(e,[c]),!1)},c=a.promise({elem:e,props:x.extend({},t),opts:x.extend(!0,{specialEasing:{},easing:x.easing._default},i),originalProperties:t,originalOptions:i,startTime:ut||vt(),duration:i.duration,tweens:[],createTween:function(t,i){var n=x.Tween(e,c.opts,t,i,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(n),n},stop:function(t){var i=0,n=t?c.tweens.length:0;if(s)return this;for(s=!0;i<n;i++)c.tweens[i].run(1);return t?(a.notifyWith(e,[c,1,0]),a.resolveWith(e,[c,t])):a.rejectWith(e,[c,t]),this}}),h=c.props;for(function(e,t){var i,n,s,r,o;for(i in e)if(s=t[n=se(i)],r=e[i],Array.isArray(r)&&(s=r[1],r=e[i]=r[0]),i!==n&&(e[n]=r,delete e[i]),(o=x.cssHooks[n])&&"expand"in o)for(i in r=o.expand(r),delete e[n],r)i in e||(e[i]=r[i],t[i]=s);else t[n]=s}(h,c.opts.specialEasing);r<o;r++)if(n=yt.prefilters[r].call(c,e,h,c.opts))return v(n.stop)&&(x._queueHooks(c.elem,c.opts.queue).stop=n.stop.bind(n)),n;return x.map(h,bt,c),v(c.opts.start)&&c.opts.start.call(e,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),x.fx.timer(x.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c}x.Animation=x.extend(yt,{tweeners:{"*":[function(e,t){var i=this.createTween(e,t);return be(i.elem,e,pe.exec(t),i),i}]},tweener:function(e,t){v(e)?(t=e,e=["*"]):e=e.match(G);for(var i,n=0,s=e.length;n<s;n++)i=e[n],yt.tweeners[i]=yt.tweeners[i]||[],yt.tweeners[i].unshift(t)},prefilters:[function(e,t,i){var n,s,r,o,a,l,c,h,d="width"in t||"height"in t,u=this,p={},f=e.style,m=e.nodeType&&_e(e),g=ae.get(e,"fxshow");for(n in i.queue||(null==(o=x._queueHooks(e,"fx")).unqueued&&(o.unqueued=0,a=o.empty.fire,o.empty.fire=function(){o.unqueued||a()}),o.unqueued++,u.always((function(){u.always((function(){o.unqueued--,x.queue(e,"fx").length||o.empty.fire()}))}))),t)if(s=t[n],ft.test(s)){if(delete t[n],r=r||"toggle"===s,s===(m?"hide":"show")){if("show"!==s||!g||void 0===g[n])continue;m=!0}p[n]=g&&g[n]||x.style(e,n)}if((l=!x.isEmptyObject(t))||!x.isEmptyObject(p))for(n in d&&1===e.nodeType&&(i.overflow=[f.overflow,f.overflowX,f.overflowY],null==(c=g&&g.display)&&(c=ae.get(e,"display")),"none"===(h=x.css(e,"display"))&&(c?h=c:(we([e],!0),c=e.style.display||c,h=x.css(e,"display"),we([e]))),("inline"===h||"inline-block"===h&&null!=c)&&"none"===x.css(e,"float")&&(l||(u.done((function(){f.display=c})),null==c&&(h=f.display,c="none"===h?"":h)),f.display="inline-block")),i.overflow&&(f.overflow="hidden",u.always((function(){f.overflow=i.overflow[0],f.overflowX=i.overflow[1],f.overflowY=i.overflow[2]}))),l=!1,p)l||(g?"hidden"in g&&(m=g.hidden):g=ae.access(e,"fxshow",{display:c}),r&&(g.hidden=!m),m&&we([e],!0),u.done((function(){for(n in m||we([e]),ae.remove(e,"fxshow"),p)x.style(e,n,p[n])}))),l=bt(m?g[n]:0,n,u),n in g||(g[n]=l.start,m&&(l.end=l.start,l.start=0))}],prefilter:function(e,t){t?yt.prefilters.unshift(e):yt.prefilters.push(e)}}),x.speed=function(e,t,i){var n=e&&"object"==typeof e?x.extend({},e):{complete:i||!i&&t||v(e)&&e,duration:e,easing:i&&t||t&&!v(t)&&t};return x.fx.off?n.duration=0:"number"!=typeof n.duration&&(n.duration in x.fx.speeds?n.duration=x.fx.speeds[n.duration]:n.duration=x.fx.speeds._default),null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){v(n.old)&&n.old.call(this),n.queue&&x.dequeue(this,n.queue)},n},x.fn.extend({fadeTo:function(e,t,i,n){return this.filter(_e).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(e,t,i,n){var s=x.isEmptyObject(e),r=x.speed(t,i,n),o=function(){var t=yt(this,x.extend({},e),r);(s||ae.get(this,"finish"))&&t.stop(!0)};return o.finish=o,s||!1===r.queue?this.each(o):this.queue(r.queue,o)},stop:function(e,t,i){var n=function(e){var t=e.stop;delete e.stop,t(i)};return"string"!=typeof e&&(i=t,t=e,e=void 0),t&&this.queue(e||"fx",[]),this.each((function(){var t=!0,s=null!=e&&e+"queueHooks",r=x.timers,o=ae.get(this);if(s)o[s]&&o[s].stop&&n(o[s]);else for(s in o)o[s]&&o[s].stop&&mt.test(s)&&n(o[s]);for(s=r.length;s--;)r[s].elem!==this||null!=e&&r[s].queue!==e||(r[s].anim.stop(i),t=!1,r.splice(s,1));!t&&i||x.dequeue(this,e)}))},finish:function(e){return!1!==e&&(e=e||"fx"),this.each((function(){var t,i=ae.get(this),n=i[e+"queue"],s=i[e+"queueHooks"],r=x.timers,o=n?n.length:0;for(i.finish=!0,x.queue(this,e,[]),s&&s.stop&&s.stop.call(this,!0),t=r.length;t--;)r[t].elem===this&&r[t].queue===e&&(r[t].anim.stop(!0),r.splice(t,1));for(t=0;t<o;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete i.finish}))}}),x.each(["toggle","show","hide"],(function(e,t){var i=x.fn[t];x.fn[t]=function(e,n,s){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(_t(t,!0),e,n,s)}})),x.each({slideDown:_t("show"),slideUp:_t("hide"),slideToggle:_t("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(e,t){x.fn[e]=function(e,i,n){return this.animate(t,e,i,n)}})),x.timers=[],x.fx.tick=function(){var e,t=0,i=x.timers;for(ut=Date.now();t<i.length;t++)(e=i[t])()||i[t]!==e||i.splice(t--,1);i.length||x.fx.stop(),ut=void 0},x.fx.timer=function(e){x.timers.push(e),x.fx.start()},x.fx.interval=13,x.fx.start=function(){pt||(pt=!0,gt())},x.fx.stop=function(){pt=null},x.fx.speeds={slow:600,fast:200,_default:400},x.fn.delay=function(e,t){return e=x.fx&&x.fx.speeds[e]||e,t=t||"fx",this.queue(t,(function(t,i){var s=n.setTimeout(t,e);i.stop=function(){n.clearTimeout(s)}}))},function(){var e=b.createElement("input"),t=b.createElement("select").appendChild(b.createElement("option"));e.type="checkbox",g.checkOn=""!==e.value,g.optSelected=t.selected,(e=b.createElement("input")).value="t",e.type="radio",g.radioValue="t"===e.value}();var Ct,wt=x.expr.attrHandle;x.fn.extend({attr:function(e,t){return ee(this,x.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each((function(){x.removeAttr(this,e)}))}}),x.extend({attr:function(e,t,i){var n,s,r=e.nodeType;if(3!==r&&8!==r&&2!==r)return void 0===e.getAttribute?x.prop(e,t,i):(1===r&&x.isXMLDoc(e)||(s=x.attrHooks[t.toLowerCase()]||(x.expr.match.bool.test(t)?Ct:void 0)),void 0!==i?null===i?void x.removeAttr(e,t):s&&"set"in s&&void 0!==(n=s.set(e,i,t))?n:(e.setAttribute(t,i+""),i):s&&"get"in s&&null!==(n=s.get(e,t))?n:null==(n=x.find.attr(e,t))?void 0:n)},attrHooks:{type:{set:function(e,t){if(!g.radioValue&&"radio"===t&&A(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}},removeAttr:function(e,t){var i,n=0,s=t&&t.match(G);if(s&&1===e.nodeType)for(;i=s[n++];)e.removeAttribute(i)}}),Ct={set:function(e,t,i){return!1===t?x.removeAttr(e,i):e.setAttribute(i,i),i}},x.each(x.expr.match.bool.source.match(/\w+/g),(function(e,t){var i=wt[t]||x.find.attr;wt[t]=function(e,t,n){var s,r,o=t.toLowerCase();return n||(r=wt[o],wt[o]=s,s=null!=i(e,t,n)?o:null,wt[o]=r),s}}));var St=/^(?:input|select|textarea|button)$/i,Et=/^(?:a|area)$/i;function xt(e){return(e.match(G)||[]).join(" ")}function Tt(e){return e.getAttribute&&e.getAttribute("class")||""}function At(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(G)||[]}x.fn.extend({prop:function(e,t){return ee(this,x.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each((function(){delete this[x.propFix[e]||e]}))}}),x.extend({prop:function(e,t,i){var n,s,r=e.nodeType;if(3!==r&&8!==r&&2!==r)return 1===r&&x.isXMLDoc(e)||(t=x.propFix[t]||t,s=x.propHooks[t]),void 0!==i?s&&"set"in s&&void 0!==(n=s.set(e,i,t))?n:e[t]=i:s&&"get"in s&&null!==(n=s.get(e,t))?n:e[t]},propHooks:{tabIndex:{get:function(e){var t=x.find.attr(e,"tabindex");return t?parseInt(t,10):St.test(e.nodeName)||Et.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),g.optSelected||(x.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),x.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){x.propFix[this.toLowerCase()]=this})),x.fn.extend({addClass:function(e){var t,i,n,s,r,o;return v(e)?this.each((function(t){x(this).addClass(e.call(this,t,Tt(this)))})):(t=At(e)).length?this.each((function(){if(n=Tt(this),i=1===this.nodeType&&" "+xt(n)+" "){for(r=0;r<t.length;r++)s=t[r],i.indexOf(" "+s+" ")<0&&(i+=s+" ");o=xt(i),n!==o&&this.setAttribute("class",o)}})):this},removeClass:function(e){var t,i,n,s,r,o;return v(e)?this.each((function(t){x(this).removeClass(e.call(this,t,Tt(this)))})):arguments.length?(t=At(e)).length?this.each((function(){if(n=Tt(this),i=1===this.nodeType&&" "+xt(n)+" "){for(r=0;r<t.length;r++)for(s=t[r];i.indexOf(" "+s+" ")>-1;)i=i.replace(" "+s+" "," ");o=xt(i),n!==o&&this.setAttribute("class",o)}})):this:this.attr("class","")},toggleClass:function(e,t){var i,n,s,r,o=typeof e,a="string"===o||Array.isArray(e);return v(e)?this.each((function(i){x(this).toggleClass(e.call(this,i,Tt(this),t),t)})):"boolean"==typeof t&&a?t?this.addClass(e):this.removeClass(e):(i=At(e),this.each((function(){if(a)for(r=x(this),s=0;s<i.length;s++)n=i[s],r.hasClass(n)?r.removeClass(n):r.addClass(n);else void 0!==e&&"boolean"!==o||((n=Tt(this))&&ae.set(this,"__className__",n),this.setAttribute&&this.setAttribute("class",n||!1===e?"":ae.get(this,"__className__")||""))})))},hasClass:function(e){var t,i,n=0;for(t=" "+e+" ";i=this[n++];)if(1===i.nodeType&&(" "+xt(Tt(i))+" ").indexOf(t)>-1)return!0;return!1}});var Ot=/\r/g;x.fn.extend({val:function(e){var t,i,n,s=this[0];return arguments.length?(n=v(e),this.each((function(i){var s;1===this.nodeType&&(null==(s=n?e.call(this,i,x(this).val()):e)?s="":"number"==typeof s?s+="":Array.isArray(s)&&(s=x.map(s,(function(e){return null==e?"":e+""}))),(t=x.valHooks[this.type]||x.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,s,"value")||(this.value=s))}))):s?(t=x.valHooks[s.type]||x.valHooks[s.nodeName.toLowerCase()])&&"get"in t&&void 0!==(i=t.get(s,"value"))?i:"string"==typeof(i=s.value)?i.replace(Ot,""):null==i?"":i:void 0}}),x.extend({valHooks:{option:{get:function(e){var t=x.find.attr(e,"value");return null!=t?t:xt(x.text(e))}},select:{get:function(e){var t,i,n,s=e.options,r=e.selectedIndex,o="select-one"===e.type,a=o?null:[],l=o?r+1:s.length;for(n=r<0?l:o?r:0;n<l;n++)if(((i=s[n]).selected||n===r)&&!i.disabled&&(!i.parentNode.disabled||!A(i.parentNode,"optgroup"))){if(t=x(i).val(),o)return t;a.push(t)}return a},set:function(e,t){for(var i,n,s=e.options,r=x.makeArray(t),o=s.length;o--;)((n=s[o]).selected=x.inArray(x.valHooks.option.get(n),r)>-1)&&(i=!0);return i||(e.selectedIndex=-1),r}}}}),x.each(["radio","checkbox"],(function(){x.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=x.inArray(x(e).val(),t)>-1}},g.checkOn||(x.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}));var It=n.location,kt={guid:Date.now()},Dt=/\?/;x.parseXML=function(e){var t,i;if(!e||"string"!=typeof e)return null;try{t=(new n.DOMParser).parseFromString(e,"text/xml")}catch(e){}return i=t&&t.getElementsByTagName("parsererror")[0],t&&!i||x.error("Invalid XML: "+(i?x.map(i.childNodes,(function(e){return e.textContent})).join("\n"):e)),t};var jt=/^(?:focusinfocus|focusoutblur)$/,Rt=function(e){e.stopPropagation()};x.extend(x.event,{trigger:function(e,t,i,s){var r,o,a,l,c,h,d,u,f=[i||b],m=p.call(e,"type")?e.type:e,g=p.call(e,"namespace")?e.namespace.split("."):[];if(o=u=a=i=i||b,3!==i.nodeType&&8!==i.nodeType&&!jt.test(m+x.event.triggered)&&(m.indexOf(".")>-1&&(g=m.split("."),m=g.shift(),g.sort()),c=m.indexOf(":")<0&&"on"+m,(e=e[x.expando]?e:new x.Event(m,"object"==typeof e&&e)).isTrigger=s?2:3,e.namespace=g.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=i),t=null==t?[e]:x.makeArray(t,[e]),d=x.event.special[m]||{},s||!d.trigger||!1!==d.trigger.apply(i,t))){if(!s&&!d.noBubble&&!_(i)){for(l=d.delegateType||m,jt.test(l+m)||(o=o.parentNode);o;o=o.parentNode)f.push(o),a=o;a===(i.ownerDocument||b)&&f.push(a.defaultView||a.parentWindow||n)}for(r=0;(o=f[r++])&&!e.isPropagationStopped();)u=o,e.type=r>1?l:d.bindType||m,(h=(ae.get(o,"events")||Object.create(null))[e.type]&&ae.get(o,"handle"))&&h.apply(o,t),(h=c&&o[c])&&h.apply&&re(o)&&(e.result=h.apply(o,t),!1===e.result&&e.preventDefault());return e.type=m,s||e.isDefaultPrevented()||d._default&&!1!==d._default.apply(f.pop(),t)||!re(i)||c&&v(i[m])&&!_(i)&&((a=i[c])&&(i[c]=null),x.event.triggered=m,e.isPropagationStopped()&&u.addEventListener(m,Rt),i[m](),e.isPropagationStopped()&&u.removeEventListener(m,Rt),x.event.triggered=void 0,a&&(i[c]=a)),e.result}},simulate:function(e,t,i){var n=x.extend(new x.Event,i,{type:e,isSimulated:!0});x.event.trigger(n,null,t)}}),x.fn.extend({trigger:function(e,t){return this.each((function(){x.event.trigger(e,t,this)}))},triggerHandler:function(e,t){var i=this[0];if(i)return x.event.trigger(e,t,i,!0)}});var Lt=/\[\]$/,Mt=/\r?\n/g,Pt=/^(?:submit|button|image|reset|file)$/i,Nt=/^(?:input|select|textarea|keygen)/i;function Ft(e,t,i,n){var s;if(Array.isArray(t))x.each(t,(function(t,s){i||Lt.test(e)?n(e,s):Ft(e+"["+("object"==typeof s&&null!=s?t:"")+"]",s,i,n)}));else if(i||"object"!==w(t))n(e,t);else for(s in t)Ft(e+"["+s+"]",t[s],i,n)}x.param=function(e,t){var i,n=[],s=function(e,t){var i=v(t)?t():t;n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==i?"":i)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!x.isPlainObject(e))x.each(e,(function(){s(this.name,this.value)}));else for(i in e)Ft(i,e[i],t,s);return n.join("&")},x.fn.extend({serialize:function(){return x.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var e=x.prop(this,"elements");return e?x.makeArray(e):this})).filter((function(){var e=this.type;return this.name&&!x(this).is(":disabled")&&Nt.test(this.nodeName)&&!Pt.test(e)&&(this.checked||!xe.test(e))})).map((function(e,t){var i=x(this).val();return null==i?null:Array.isArray(i)?x.map(i,(function(e){return{name:t.name,value:e.replace(Mt,"\r\n")}})):{name:t.name,value:i.replace(Mt,"\r\n")}})).get()}});var Ht=/%20/g,Bt=/#.*$/,zt=/([?&])_=[^&]*/,Vt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Wt=/^(?:GET|HEAD)$/,$t=/^\/\//,Ut={},qt={},Gt="*/".concat("*"),Kt=b.createElement("a");function Yt(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var n,s=0,r=t.toLowerCase().match(G)||[];if(v(i))for(;n=r[s++];)"+"===n[0]?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(i)):(e[n]=e[n]||[]).push(i)}}function Xt(e,t,i,n){var s={},r=e===qt;function o(a){var l;return s[a]=!0,x.each(e[a]||[],(function(e,a){var c=a(t,i,n);return"string"!=typeof c||r||s[c]?r?!(l=c):void 0:(t.dataTypes.unshift(c),o(c),!1)})),l}return o(t.dataTypes[0])||!s["*"]&&o("*")}function Zt(e,t){var i,n,s=x.ajaxSettings.flatOptions||{};for(i in t)void 0!==t[i]&&((s[i]?e:n||(n={}))[i]=t[i]);return n&&x.extend(!0,e,n),e}Kt.href=It.href,x.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:It.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(It.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Gt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":x.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Zt(Zt(e,x.ajaxSettings),t):Zt(x.ajaxSettings,e)},ajaxPrefilter:Yt(Ut),ajaxTransport:Yt(qt),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var i,s,r,o,a,l,c,h,d,u,p=x.ajaxSetup({},t),f=p.context||p,m=p.context&&(f.nodeType||f.jquery)?x(f):x.event,g=x.Deferred(),v=x.Callbacks("once memory"),_=p.statusCode||{},y={},C={},w="canceled",S={readyState:0,getResponseHeader:function(e){var t;if(c){if(!o)for(o={};t=Vt.exec(r);)o[t[1].toLowerCase()+" "]=(o[t[1].toLowerCase()+" "]||[]).concat(t[2]);t=o[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return c?r:null},setRequestHeader:function(e,t){return null==c&&(e=C[e.toLowerCase()]=C[e.toLowerCase()]||e,y[e]=t),this},overrideMimeType:function(e){return null==c&&(p.mimeType=e),this},statusCode:function(e){var t;if(e)if(c)S.always(e[S.status]);else for(t in e)_[t]=[_[t],e[t]];return this},abort:function(e){var t=e||w;return i&&i.abort(t),E(0,t),this}};if(g.promise(S),p.url=((e||p.url||It.href)+"").replace($t,It.protocol+"//"),p.type=t.method||t.type||p.method||p.type,p.dataTypes=(p.dataType||"*").toLowerCase().match(G)||[""],null==p.crossDomain){l=b.createElement("a");try{l.href=p.url,l.href=l.href,p.crossDomain=Kt.protocol+"//"+Kt.host!=l.protocol+"//"+l.host}catch(e){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!=typeof p.data&&(p.data=x.param(p.data,p.traditional)),Xt(Ut,p,t,S),c)return S;for(d in(h=x.event&&p.global)&&0==x.active++&&x.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Wt.test(p.type),s=p.url.replace(Bt,""),p.hasContent?p.data&&p.processData&&0===(p.contentType||"").indexOf("application/x-www-form-urlencoded")&&(p.data=p.data.replace(Ht,"+")):(u=p.url.slice(s.length),p.data&&(p.processData||"string"==typeof p.data)&&(s+=(Dt.test(s)?"&":"?")+p.data,delete p.data),!1===p.cache&&(s=s.replace(zt,"$1"),u=(Dt.test(s)?"&":"?")+"_="+kt.guid+++u),p.url=s+u),p.ifModified&&(x.lastModified[s]&&S.setRequestHeader("If-Modified-Since",x.lastModified[s]),x.etag[s]&&S.setRequestHeader("If-None-Match",x.etag[s])),(p.data&&p.hasContent&&!1!==p.contentType||t.contentType)&&S.setRequestHeader("Content-Type",p.contentType),S.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Gt+"; q=0.01":""):p.accepts["*"]),p.headers)S.setRequestHeader(d,p.headers[d]);if(p.beforeSend&&(!1===p.beforeSend.call(f,S,p)||c))return S.abort();if(w="abort",v.add(p.complete),S.done(p.success),S.fail(p.error),i=Xt(qt,p,t,S)){if(S.readyState=1,h&&m.trigger("ajaxSend",[S,p]),c)return S;p.async&&p.timeout>0&&(a=n.setTimeout((function(){S.abort("timeout")}),p.timeout));try{c=!1,i.send(y,E)}catch(e){if(c)throw e;E(-1,e)}}else E(-1,"No Transport");function E(e,t,o,l){var d,u,b,y,C,w=t;c||(c=!0,a&&n.clearTimeout(a),i=void 0,r=l||"",S.readyState=e>0?4:0,d=e>=200&&e<300||304===e,o&&(y=function(e,t,i){for(var n,s,r,o,a=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===n&&(n=e.mimeType||t.getResponseHeader("Content-Type"));if(n)for(s in a)if(a[s]&&a[s].test(n)){l.unshift(s);break}if(l[0]in i)r=l[0];else{for(s in i){if(!l[0]||e.converters[s+" "+l[0]]){r=s;break}o||(o=s)}r=r||o}if(r)return r!==l[0]&&l.unshift(r),i[r]}(p,S,o)),!d&&x.inArray("script",p.dataTypes)>-1&&x.inArray("json",p.dataTypes)<0&&(p.converters["text script"]=function(){}),y=function(e,t,i,n){var s,r,o,a,l,c={},h=e.dataTypes.slice();if(h[1])for(o in e.converters)c[o.toLowerCase()]=e.converters[o];for(r=h.shift();r;)if(e.responseFields[r]&&(i[e.responseFields[r]]=t),!l&&n&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=r,r=h.shift())if("*"===r)r=l;else if("*"!==l&&l!==r){if(!(o=c[l+" "+r]||c["* "+r]))for(s in c)if((a=s.split(" "))[1]===r&&(o=c[l+" "+a[0]]||c["* "+a[0]])){!0===o?o=c[s]:!0!==c[s]&&(r=a[0],h.unshift(a[1]));break}if(!0!==o)if(o&&e.throws)t=o(t);else try{t=o(t)}catch(e){return{state:"parsererror",error:o?e:"No conversion from "+l+" to "+r}}}return{state:"success",data:t}}(p,y,S,d),d?(p.ifModified&&((C=S.getResponseHeader("Last-Modified"))&&(x.lastModified[s]=C),(C=S.getResponseHeader("etag"))&&(x.etag[s]=C)),204===e||"HEAD"===p.type?w="nocontent":304===e?w="notmodified":(w=y.state,u=y.data,d=!(b=y.error))):(b=w,!e&&w||(w="error",e<0&&(e=0))),S.status=e,S.statusText=(t||w)+"",d?g.resolveWith(f,[u,w,S]):g.rejectWith(f,[S,w,b]),S.statusCode(_),_=void 0,h&&m.trigger(d?"ajaxSuccess":"ajaxError",[S,p,d?u:b]),v.fireWith(f,[S,w]),h&&(m.trigger("ajaxComplete",[S,p]),--x.active||x.event.trigger("ajaxStop")))}return S},getJSON:function(e,t,i){return x.get(e,t,i,"json")},getScript:function(e,t){return x.get(e,void 0,t,"script")}}),x.each(["get","post"],(function(e,t){x[t]=function(e,i,n,s){return v(i)&&(s=s||n,n=i,i=void 0),x.ajax(x.extend({url:e,type:t,dataType:s,data:i,success:n},x.isPlainObject(e)&&e))}})),x.ajaxPrefilter((function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")})),x._evalUrl=function(e,t,i){return x.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){x.globalEval(e,t,i)}})},x.fn.extend({wrapAll:function(e){var t;return this[0]&&(v(e)&&(e=e.call(this[0])),t=x(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map((function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e})).append(this)),this},wrapInner:function(e){return v(e)?this.each((function(t){x(this).wrapInner(e.call(this,t))})):this.each((function(){var t=x(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)}))},wrap:function(e){var t=v(e);return this.each((function(i){x(this).wrapAll(t?e.call(this,i):e)}))},unwrap:function(e){return this.parent(e).not("body").each((function(){x(this).replaceWith(this.childNodes)})),this}}),x.expr.pseudos.hidden=function(e){return!x.expr.pseudos.visible(e)},x.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},x.ajaxSettings.xhr=function(){try{return new n.XMLHttpRequest}catch(e){}};var Qt={0:200,1223:204},Jt=x.ajaxSettings.xhr();g.cors=!!Jt&&"withCredentials"in Jt,g.ajax=Jt=!!Jt,x.ajaxTransport((function(e){var t,i;if(g.cors||Jt&&!e.crossDomain)return{send:function(s,r){var o,a=e.xhr();if(a.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(o in e.xhrFields)a[o]=e.xhrFields[o];for(o in e.mimeType&&a.overrideMimeType&&a.overrideMimeType(e.mimeType),e.crossDomain||s["X-Requested-With"]||(s["X-Requested-With"]="XMLHttpRequest"),s)a.setRequestHeader(o,s[o]);t=function(e){return function(){t&&(t=i=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===e?a.abort():"error"===e?"number"!=typeof a.status?r(0,"error"):r(a.status,a.statusText):r(Qt[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=t(),i=a.onerror=a.ontimeout=t("error"),void 0!==a.onabort?a.onabort=i:a.onreadystatechange=function(){4===a.readyState&&n.setTimeout((function(){t&&i()}))},t=t("abort");try{a.send(e.hasContent&&e.data||null)}catch(e){if(t)throw e}},abort:function(){t&&t()}}})),x.ajaxPrefilter((function(e){e.crossDomain&&(e.contents.script=!1)})),x.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return x.globalEval(e),e}}}),x.ajaxPrefilter("script",(function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")})),x.ajaxTransport("script",(function(e){var t,i;if(e.crossDomain||e.scriptAttrs)return{send:function(n,s){t=x("<script>").attr(e.scriptAttrs||{}).prop({charset:e.scriptCharset,src:e.url}).on("load error",i=function(e){t.remove(),i=null,e&&s("error"===e.type?404:200,e.type)}),b.head.appendChild(t[0])},abort:function(){i&&i()}}}));var ei,ti=[],ii=/(=)\?(?=&|$)|\?\?/;x.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=ti.pop()||x.expando+"_"+kt.guid++;return this[e]=!0,e}}),x.ajaxPrefilter("json jsonp",(function(e,t,i){var s,r,o,a=!1!==e.jsonp&&(ii.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&ii.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return s=e.jsonpCallback=v(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(ii,"$1"+s):!1!==e.jsonp&&(e.url+=(Dt.test(e.url)?"&":"?")+e.jsonp+"="+s),e.converters["script json"]=function(){return o||x.error(s+" was not called"),o[0]},e.dataTypes[0]="json",r=n[s],n[s]=function(){o=arguments},i.always((function(){void 0===r?x(n).removeProp(s):n[s]=r,e[s]&&(e.jsonpCallback=t.jsonpCallback,ti.push(s)),o&&v(r)&&r(o[0]),o=r=void 0})),"script"})),g.createHTMLDocument=((ei=b.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===ei.childNodes.length),x.parseHTML=function(e,t,i){return"string"!=typeof e?[]:("boolean"==typeof t&&(i=t,t=!1),t||(g.createHTMLDocument?((n=(t=b.implementation.createHTMLDocument("")).createElement("base")).href=b.location.href,t.head.appendChild(n)):t=b),r=!i&&[],(s=B.exec(e))?[t.createElement(s[1])]:(s=je([e],t,r),r&&r.length&&x(r).remove(),x.merge([],s.childNodes)));var n,s,r},x.fn.load=function(e,t,i){var n,s,r,o=this,a=e.indexOf(" ");return a>-1&&(n=xt(e.slice(a)),e=e.slice(0,a)),v(t)?(i=t,t=void 0):t&&"object"==typeof t&&(s="POST"),o.length>0&&x.ajax({url:e,type:s||"GET",dataType:"html",data:t}).done((function(e){r=arguments,o.html(n?x("<div>").append(x.parseHTML(e)).find(n):e)})).always(i&&function(e,t){o.each((function(){i.apply(this,r||[e.responseText,t,e])}))}),this},x.expr.pseudos.animated=function(e){return x.grep(x.timers,(function(t){return e===t.elem})).length},x.offset={setOffset:function(e,t,i){var n,s,r,o,a,l,c=x.css(e,"position"),h=x(e),d={};"static"===c&&(e.style.position="relative"),a=h.offset(),r=x.css(e,"top"),l=x.css(e,"left"),("absolute"===c||"fixed"===c)&&(r+l).indexOf("auto")>-1?(o=(n=h.position()).top,s=n.left):(o=parseFloat(r)||0,s=parseFloat(l)||0),v(t)&&(t=t.call(e,i,x.extend({},a))),null!=t.top&&(d.top=t.top-a.top+o),null!=t.left&&(d.left=t.left-a.left+s),"using"in t?t.using.call(e,d):h.css(d)}},x.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each((function(t){x.offset.setOffset(this,e,t)}));var t,i,n=this[0];return n?n.getClientRects().length?(t=n.getBoundingClientRect(),i=n.ownerDocument.defaultView,{top:t.top+i.pageYOffset,left:t.left+i.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,i,n=this[0],s={top:0,left:0};if("fixed"===x.css(n,"position"))t=n.getBoundingClientRect();else{for(t=this.offset(),i=n.ownerDocument,e=n.offsetParent||i.documentElement;e&&(e===i.body||e===i.documentElement)&&"static"===x.css(e,"position");)e=e.parentNode;e&&e!==n&&1===e.nodeType&&((s=x(e).offset()).top+=x.css(e,"borderTopWidth",!0),s.left+=x.css(e,"borderLeftWidth",!0))}return{top:t.top-s.top-x.css(n,"marginTop",!0),left:t.left-s.left-x.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var e=this.offsetParent;e&&"static"===x.css(e,"position");)e=e.offsetParent;return e||me}))}}),x.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(e,t){var i="pageYOffset"===t;x.fn[e]=function(n){return ee(this,(function(e,n,s){var r;if(_(e)?r=e:9===e.nodeType&&(r=e.defaultView),void 0===s)return r?r[t]:e[n];r?r.scrollTo(i?r.pageXOffset:s,i?s:r.pageYOffset):e[n]=s}),e,n,arguments.length)}})),x.each(["top","left"],(function(e,t){x.cssHooks[t]=et(g.pixelPosition,(function(e,i){if(i)return i=Je(e,t),Ke.test(i)?x(e).position()[t]+"px":i}))})),x.each({Height:"height",Width:"width"},(function(e,t){x.each({padding:"inner"+e,content:t,"":"outer"+e},(function(i,n){x.fn[n]=function(s,r){var o=arguments.length&&(i||"boolean"!=typeof s),a=i||(!0===s||!0===r?"margin":"border");return ee(this,(function(t,i,s){var r;return _(t)?0===n.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(r=t.documentElement,Math.max(t.body["scroll"+e],r["scroll"+e],t.body["offset"+e],r["offset"+e],r["client"+e])):void 0===s?x.css(t,i,a):x.style(t,i,s,a)}),t,o?s:void 0,o)}}))})),x.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(e,t){x.fn[t]=function(e){return this.on(t,e)}})),x.fn.extend({bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)},hover:function(e,t){return this.on("mouseenter",e).on("mouseleave",t||e)}}),x.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(e,t){x.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}}));var ni=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;x.proxy=function(e,t){var i,n,s;if("string"==typeof t&&(i=e[t],t=e,e=i),v(e))return n=a.call(arguments,2),s=function(){return e.apply(t||this,n.concat(a.call(arguments)))},s.guid=e.guid=e.guid||x.guid++,s},x.holdReady=function(e){e?x.readyWait++:x.ready(!0)},x.isArray=Array.isArray,x.parseJSON=JSON.parse,x.nodeName=A,x.isFunction=v,x.isWindow=_,x.camelCase=se,x.type=w,x.now=Date.now,x.isNumeric=function(e){var t=x.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},x.trim=function(e){return null==e?"":(e+"").replace(ni,"$1")},void 0===(i=function(){return x}.apply(t,[]))||(e.exports=i);var si=n.jQuery,ri=n.$;return x.noConflict=function(e){return n.$===x&&(n.$=ri),e&&n.jQuery===x&&(n.jQuery=si),x},void 0===s&&(n.jQuery=n.$=x),x}))},561:function(module,__unused_webpack_exports,__webpack_require__){if(!jSuites)var jSuites=__webpack_require__(610);var factory;factory=function(){var jspreadsheet;return function(){var __webpack_modules__={463:function(e){var t;e.exports=(function(){var e={765:function(e,t){var i;i=function(e){e.version="1.0.2";var t=Math;function i(e,t){for(var i=0,n=0;i<e.length;++i)n=t*n+e[i];return n}function n(e,t,i,n,s){if(0===t)return i;if(1===t)return n;for(var r=2/e,o=n,a=1;a<t;++a)o=n*a*r+s*i,i=n,n=o;return o}function s(e,t,i,s,r){return function(i,o){if(s){if(0===i)return 1==s?-1/0:1/0;if(i<0)return NaN}return 0===o?e(i):1===o?t(i):o<0?NaN:n(i,o|=0,e(i),t(i),r)}}var r,o,a,l,c,h,d,u,p,f,m,g,v,_=function(){var e=.636619772,s=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),r=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),o=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),a=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse();function l(n){var l=0,c=0,h=0,d=n*n;if(n<8)l=(c=i(s,d))/(h=i(r,d));else{var u=n-.785398164;c=i(o,d=64/d),h=i(a,d),l=t.sqrt(e/n)*(t.cos(u)*c-t.sin(u)*h*8/n)}return l}var c=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),h=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),d=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),u=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();function p(n){var s=0,r=0,o=0,a=n*n,l=t.abs(n)-2.356194491;return Math.abs(n)<8?s=(r=n*i(c,a))/(o=i(h,a)):(r=i(d,a=64/a),o=i(u,a),s=t.sqrt(e/t.abs(n))*(t.cos(l)*r-t.sin(l)*o*8/t.abs(n)),n<0&&(s=-s)),s}return function e(i,s){if(s=Math.round(s),!isFinite(i))return isNaN(i)?i:0;if(s<0)return(s%2?-1:1)*e(i,-s);if(i<0)return(s%2?-1:1)*e(-i,s);if(0===s)return l(i);if(1===s)return p(i);if(0===i)return 0;var r=0;if(i>s)r=n(i,s,l(i),p(i),-1);else{for(var o=!1,a=0,c=0,h=1,d=0,u=2/i,f=2*t.floor((s+t.floor(t.sqrt(40*s)))/2);f>0;f--)d=f*u*h-a,a=h,h=d,t.abs(h)>1e10&&(h*=1e-10,a*=1e-10,r*=1e-10,c*=1e-10),o&&(c+=h),o=!o,f==s&&(r=a);r/=c=2*c-h}return r}}(),b=(r=.636619772,o=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),a=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),l=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),c=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),h=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),d=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),u=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),p=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse(),s((function(e){var n=0,s=0,h=0,d=e*e,u=e-.785398164;return e<8?n=(s=i(o,d))/(h=i(a,d))+r*_(e,0)*t.log(e):(s=i(l,d=64/d),h=i(c,d),n=t.sqrt(r/e)*(t.sin(u)*s+t.cos(u)*h*8/e)),n}),(function(e){var n=0,s=0,o=0,a=e*e,l=e-2.356194491;return e<8?n=(s=e*i(h,a))/(o=i(d,a))+r*(_(e,1)*t.log(e)-1/e):(s=i(u,a=64/a),o=i(p,a),n=t.sqrt(r/e)*(t.sin(l)*s+t.cos(l)*o*8/e)),n}),0,1,-1)),y=(f=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),m=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),g=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),v=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function e(n,s){if(0===(s=Math.round(s)))return function(e){return e<=3.75?i(f,e*e/14.0625):t.exp(t.abs(e))/t.sqrt(t.abs(e))*i(m,3.75/t.abs(e))}(n);if(1===s)return function(e){return e<3.75?e*i(g,e*e/14.0625):(e<0?-1:1)*t.exp(t.abs(e))/t.sqrt(t.abs(e))*i(v,3.75/t.abs(e))}(n);if(s<0)return NaN;if(0===t.abs(n))return 0;if(n==1/0)return 1/0;var r,o=0,a=2/t.abs(n),l=0,c=1,h=0;for(r=2*t.round((s+t.round(t.sqrt(40*s)))/2);r>0;r--)h=r*a*c+l,l=c,c=h,t.abs(c)>1e10&&(c*=1e-10,l*=1e-10,o*=1e-10),r==s&&(o=l);return o*=e(n,0)/c,n<0&&s%2?-o:o}),C=function(){var e=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),n=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),r=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),o=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return s((function(s){return s<=2?-t.log(s/2)*y(s,0)+i(e,s*s/4):t.exp(-s)/t.sqrt(s)*i(n,2/s)}),(function(e){return e<=2?t.log(e/2)*y(e,1)+1/e*i(r,e*e/4):t.exp(-e)/t.sqrt(e)*i(o,2/e)}),0,2,1)}();e.besselj=_,e.bessely=b,e.besseli=y,e.besselk=C},"undefined"==typeof DO_NOT_EXPORT_BESSEL?i(t):i({})},162:function(e){var t;e.exports=(t=function(e,t){var i=Array.prototype.concat,n=Array.prototype.slice,s=Object.prototype.toString;function r(t,i){var n=t>i?t:i;return e.pow(10,17-~~(e.log(n>0?n:-n)*e.LOG10E))}var o=Array.isArray||function(e){return"[object Array]"===s.call(e)};function a(e){return"[object Function]"===s.call(e)}function l(e){return"number"==typeof e&&e-e==0}function c(){return new c._init(arguments)}function h(){return 0}function d(){return 1}function u(e,t){return e===t?1:0}c.fn=c.prototype,c._init=function(e){if(o(e[0]))if(o(e[0][0])){a(e[1])&&(e[0]=c.map(e[0],e[1]));for(var t=0;t<e[0].length;t++)this[t]=e[0][t];this.length=e[0].length}else this[0]=a(e[1])?c.map(e[0],e[1]):e[0],this.length=1;else if(l(e[0]))this[0]=c.seq.apply(null,e),this.length=1;else{if(e[0]instanceof c)return c(e[0].toArray());this[0]=[],this.length=1}return this},c._init.prototype=c.prototype,c._init.constructor=c,c.utils={calcRdx:r,isArray:o,isFunction:a,isNumber:l,toVector:function(e){return i.apply([],e)}},c._random_fn=e.random,c.setRandom=function(e){if("function"!=typeof e)throw new TypeError("fn is not a function");c._random_fn=e},c.extend=function(e){var t,i;if(1===arguments.length){for(i in e)c[i]=e[i];return this}for(t=1;t<arguments.length;t++)for(i in arguments[t])e[i]=arguments[t][i];return e},c.rows=function(e){return e.length||1},c.cols=function(e){return e[0].length||1},c.dimensions=function(e){return{rows:c.rows(e),cols:c.cols(e)}},c.row=function(e,t){return o(t)?t.map((function(t){return c.row(e,t)})):e[t]},c.rowa=function(e,t){return c.row(e,t)},c.col=function(e,t){if(o(t)){var i=c.arange(e.length).map((function(){return new Array(t.length)}));return t.forEach((function(t,n){c.arange(e.length).forEach((function(s){i[s][n]=e[s][t]}))})),i}for(var n=new Array(e.length),s=0;s<e.length;s++)n[s]=[e[s][t]];return n},c.cola=function(e,t){return c.col(e,t).map((function(e){return e[0]}))},c.diag=function(e){for(var t=c.rows(e),i=new Array(t),n=0;n<t;n++)i[n]=[e[n][n]];return i},c.antidiag=function(e){for(var t=c.rows(e)-1,i=new Array(t),n=0;t>=0;t--,n++)i[n]=[e[n][t]];return i},c.transpose=function(e){var t,i,n,s,r,a=[];for(o(e[0])||(e=[e]),i=e.length,n=e[0].length,r=0;r<n;r++){for(t=new Array(i),s=0;s<i;s++)t[s]=e[s][r];a.push(t)}return 1===a.length?a[0]:a},c.map=function(e,t,i){var n,s,r,a,l;for(o(e[0])||(e=[e]),s=e.length,r=e[0].length,a=i?e:new Array(s),n=0;n<s;n++)for(a[n]||(a[n]=new Array(r)),l=0;l<r;l++)a[n][l]=t(e[n][l],n,l);return 1===a.length?a[0]:a},c.cumreduce=function(e,t,i){var n,s,r,a,l;for(o(e[0])||(e=[e]),s=e.length,r=e[0].length,a=i?e:new Array(s),n=0;n<s;n++)for(a[n]||(a[n]=new Array(r)),r>0&&(a[n][0]=e[n][0]),l=1;l<r;l++)a[n][l]=t(a[n][l-1],e[n][l]);return 1===a.length?a[0]:a},c.alter=function(e,t){return c.map(e,t,!0)},c.create=function(e,t,i){var n,s,r=new Array(e);for(a(t)&&(i=t,t=e),n=0;n<e;n++)for(r[n]=new Array(t),s=0;s<t;s++)r[n][s]=i(n,s);return r},c.zeros=function(e,t){return l(t)||(t=e),c.create(e,t,h)},c.ones=function(e,t){return l(t)||(t=e),c.create(e,t,d)},c.rand=function(e,t){return l(t)||(t=e),c.create(e,t,c._random_fn)},c.identity=function(e,t){return l(t)||(t=e),c.create(e,t,u)},c.symmetric=function(e){var t,i,n=e.length;if(e.length!==e[0].length)return!1;for(t=0;t<n;t++)for(i=0;i<n;i++)if(e[i][t]!==e[t][i])return!1;return!0},c.clear=function(e){return c.alter(e,h)},c.seq=function(e,t,i,n){a(n)||(n=!1);var s,o=[],l=r(e,t),c=(t*l-e*l)/((i-1)*l),h=e;for(s=0;h<=t&&s<i;h=(e*l+c*l*++s)/l)o.push(n?n(h,s):h);return o},c.arange=function(e,i,n){var s,r=[];if(n=n||1,i===t&&(i=e,e=0),e===i||0===n)return[];if(e<i&&n<0)return[];if(e>i&&n>0)return[];if(n>0)for(s=e;s<i;s+=n)r.push(s);else for(s=e;s>i;s+=n)r.push(s);return r},c.slice=function(){function e(e,i,n,s){var r,o=[],a=e.length;if(i===t&&n===t&&s===t)return c.copy(e);if(s=s||1,(i=(i=i||0)>=0?i:a+i)===(n=(n=n||e.length)>=0?n:a+n)||0===s)return[];if(i<n&&s<0)return[];if(i>n&&s>0)return[];if(s>0)for(r=i;r<n;r+=s)o.push(e[r]);else for(r=i;r>n;r+=s)o.push(e[r]);return o}return function(t,i){var n,s;return l((i=i||{}).row)?l(i.col)?t[i.row][i.col]:e(c.rowa(t,i.row),(n=i.col||{}).start,n.end,n.step):l(i.col)?e(c.cola(t,i.col),(s=i.row||{}).start,s.end,s.step):(s=i.row||{},n=i.col||{},e(t,s.start,s.end,s.step).map((function(t){return e(t,n.start,n.end,n.step)})))}}(),c.sliceAssign=function(i,n,s){var r,o;if(l(n.row)){if(l(n.col))return i[n.row][n.col]=s;n.col=n.col||{},n.col.start=n.col.start||0,n.col.end=n.col.end||i[0].length,n.col.step=n.col.step||1,r=c.arange(n.col.start,e.min(i.length,n.col.end),n.col.step);var a=n.row;return r.forEach((function(e,t){i[a][e]=s[t]})),i}if(l(n.col)){n.row=n.row||{},n.row.start=n.row.start||0,n.row.end=n.row.end||i.length,n.row.step=n.row.step||1,o=c.arange(n.row.start,e.min(i[0].length,n.row.end),n.row.step);var h=n.col;return o.forEach((function(e,t){i[e][h]=s[t]})),i}return s[0].length===t&&(s=[s]),n.row.start=n.row.start||0,n.row.end=n.row.end||i.length,n.row.step=n.row.step||1,n.col.start=n.col.start||0,n.col.end=n.col.end||i[0].length,n.col.step=n.col.step||1,o=c.arange(n.row.start,e.min(i.length,n.row.end),n.row.step),r=c.arange(n.col.start,e.min(i[0].length,n.col.end),n.col.step),o.forEach((function(e,t){r.forEach((function(n,r){i[e][n]=s[t][r]}))})),i},c.diagonal=function(e){var t=c.zeros(e.length,e.length);return e.forEach((function(e,i){t[i][i]=e})),t},c.copy=function(e){return e.map((function(e){return l(e)?e:e.map((function(e){return e}))}))};var p=c.prototype;return p.length=0,p.push=Array.prototype.push,p.sort=Array.prototype.sort,p.splice=Array.prototype.splice,p.slice=Array.prototype.slice,p.toArray=function(){return this.length>1?n.call(this):n.call(this)[0]},p.map=function(e,t){return c(c.map(this,e,t))},p.cumreduce=function(e,t){return c(c.cumreduce(this,e,t))},p.alter=function(e){return c.alter(this,e),this},function(e){for(var t=0;t<e.length;t++)!function(e){p[e]=function(t){var i,n=this;return t?(setTimeout((function(){t.call(n,p[e].call(n))})),this):(i=c[e](this),o(i)?c(i):i)}}(e[t])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(e){for(var t=0;t<e.length;t++)!function(e){p[e]=function(t,i){var n=this;return i?(setTimeout((function(){i.call(n,p[e].call(n,t))})),this):c(c[e](this,t))}}(e[t])}("row col".split(" ")),function(e){for(var t=0;t<e.length;t++)!function(e){p[e]=function(){return c(c[e].apply(null,arguments))}}(e[t])}("create zeros ones rand identity".split(" ")),c}(Math),function(e,t){var i=e.utils.isFunction;function n(e,t){return e-t}function s(e,i,n){return t.max(i,t.min(e,n))}e.sum=function(e){for(var t=0,i=e.length;--i>=0;)t+=e[i];return t},e.sumsqrd=function(e){for(var t=0,i=e.length;--i>=0;)t+=e[i]*e[i];return t},e.sumsqerr=function(t){for(var i,n=e.mean(t),s=0,r=t.length;--r>=0;)s+=(i=t[r]-n)*i;return s},e.sumrow=function(e){for(var t=0,i=e.length;--i>=0;)t+=e[i];return t},e.product=function(e){for(var t=1,i=e.length;--i>=0;)t*=e[i];return t},e.min=function(e){for(var t=e[0],i=0;++i<e.length;)e[i]<t&&(t=e[i]);return t},e.max=function(e){for(var t=e[0],i=0;++i<e.length;)e[i]>t&&(t=e[i]);return t},e.unique=function(e){for(var t={},i=[],n=0;n<e.length;n++)t[e[n]]||(t[e[n]]=!0,i.push(e[n]));return i},e.mean=function(t){return e.sum(t)/t.length},e.meansqerr=function(t){return e.sumsqerr(t)/t.length},e.geomean=function(i){var n=i.map(t.log),s=e.mean(n);return t.exp(s)},e.median=function(e){var t=e.length,i=e.slice().sort(n);return 1&t?i[t/2|0]:(i[t/2-1]+i[t/2])/2},e.cumsum=function(t){return e.cumreduce(t,(function(e,t){return e+t}))},e.cumprod=function(t){return e.cumreduce(t,(function(e,t){return e*t}))},e.diff=function(e){var t,i=[],n=e.length;for(t=1;t<n;t++)i.push(e[t]-e[t-1]);return i},e.rank=function(e){var t,i=[],s={};for(t=0;t<e.length;t++)s[l=e[t]]?s[l]++:(s[l]=1,i.push(l));var r=i.sort(n),o={},a=1;for(t=0;t<r.length;t++){var l,c=s[l=r[t]],h=(a+(a+c-1))/2;o[l]=h,a+=c}return e.map((function(e){return o[e]}))},e.mode=function(e){var t,i=e.length,s=e.slice().sort(n),r=1,o=0,a=0,l=[];for(t=0;t<i;t++)s[t]===s[t+1]?r++:(r>o?(l=[s[t]],o=r,a=0):r===o&&(l.push(s[t]),a++),r=1);return 0===a?l[0]:l},e.range=function(t){return e.max(t)-e.min(t)},e.variance=function(t,i){return e.sumsqerr(t)/(t.length-(i?1:0))},e.pooledvariance=function(t){return t.reduce((function(t,i){return t+e.sumsqerr(i)}),0)/(t.reduce((function(e,t){return e+t.length}),0)-t.length)},e.deviation=function(t){for(var i=e.mean(t),n=t.length,s=new Array(n),r=0;r<n;r++)s[r]=t[r]-i;return s},e.stdev=function(i,n){return t.sqrt(e.variance(i,n))},e.pooledstdev=function(i){return t.sqrt(e.pooledvariance(i))},e.meandev=function(i){for(var n=e.mean(i),s=[],r=i.length-1;r>=0;r--)s.push(t.abs(i[r]-n));return e.mean(s)},e.meddev=function(i){for(var n=e.median(i),s=[],r=i.length-1;r>=0;r--)s.push(t.abs(i[r]-n));return e.median(s)},e.coeffvar=function(t){return e.stdev(t)/e.mean(t)},e.quartiles=function(e){var i=e.length,s=e.slice().sort(n);return[s[t.round(i/4)-1],s[t.round(i/2)-1],s[t.round(3*i/4)-1]]},e.quantiles=function(e,i,r,o){var a,l,c,h,d,u=e.slice().sort(n),p=[i.length],f=e.length;for(void 0===r&&(r=3/8),void 0===o&&(o=3/8),a=0;a<i.length;a++)c=f*(l=i[a])+(r+l*(1-r-o)),h=t.floor(s(c,1,f-1)),d=s(c-h,0,1),p[a]=(1-d)*u[h-1]+d*u[h];return p},e.percentile=function(e,t,i){var s=e.slice().sort(n),r=t*(s.length+(i?1:-1))+(i?0:1),o=parseInt(r),a=r-o;return o+1<s.length?s[o-1]+a*(s[o]-s[o-1]):s[o-1]},e.percentileOfScore=function(e,t,i){var n,s,r=0,o=e.length,a=!1;for("strict"===i&&(a=!0),s=0;s<o;s++)n=e[s],(a&&n<t||!a&&n<=t)&&r++;return r/o},e.histogram=function(i,n){n=n||4;var s,r=e.min(i),o=(e.max(i)-r)/n,a=i.length,l=[];for(s=0;s<n;s++)l[s]=0;for(s=0;s<a;s++)l[t.min(t.floor((i[s]-r)/o),n-1)]+=1;return l},e.covariance=function(t,i){var n,s=e.mean(t),r=e.mean(i),o=t.length,a=new Array(o);for(n=0;n<o;n++)a[n]=(t[n]-s)*(i[n]-r);return e.sum(a)/(o-1)},e.corrcoeff=function(t,i){return e.covariance(t,i)/e.stdev(t,1)/e.stdev(i,1)},e.spearmancoeff=function(t,i){return t=e.rank(t),i=e.rank(i),e.corrcoeff(t,i)},e.stanMoment=function(i,n){for(var s=e.mean(i),r=e.stdev(i),o=i.length,a=0,l=0;l<o;l++)a+=t.pow((i[l]-s)/r,n);return a/i.length},e.skewness=function(t){return e.stanMoment(t,3)},e.kurtosis=function(t){return e.stanMoment(t,4)-3};var r=e.prototype;!function(t){for(var n=0;n<t.length;n++)!function(t){r[t]=function(n,s){var o=[],a=0,l=this;if(i(n)&&(s=n,n=!1),s)return setTimeout((function(){s.call(l,r[t].call(l,n))})),this;if(this.length>1){for(l=!0===n?this:this.transpose();a<l.length;a++)o[a]=e[t](l[a]);return o}return e[t](this[0],n)}}(t[n])}("cumsum cumprod".split(" ")),function(t){for(var n=0;n<t.length;n++)!function(t){r[t]=function(n,s){var o=[],a=0,l=this;if(i(n)&&(s=n,n=!1),s)return setTimeout((function(){s.call(l,r[t].call(l,n))})),this;if(this.length>1){for("sumrow"!==t&&(l=!0===n?this:this.transpose());a<l.length;a++)o[a]=e[t](l[a]);return!0===n?e[t](e.utils.toVector(o)):o}return e[t](this[0],n)}}(t[n])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(t){for(var n=0;n<t.length;n++)!function(t){r[t]=function(){var n,s=[],o=0,a=this,l=Array.prototype.slice.call(arguments);if(i(l[l.length-1])){n=l[l.length-1];var c=l.slice(0,l.length-1);return setTimeout((function(){n.call(a,r[t].apply(a,c))})),this}n=void 0;var h=function(i){return e[t].apply(a,[i].concat(l))};if(this.length>1){for(a=a.transpose();o<a.length;o++)s[o]=h(a[o]);return s}return h(this[0])}}(t[n])}("quantiles percentileOfScore".split(" "))}(t,Math),function(e,t){e.gammaln=function(e){var i,n,s,r=0,o=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],a=1.000000000190015;for(s=(n=i=e)+5.5,s-=(i+.5)*t.log(s);r<6;r++)a+=o[r]/++n;return t.log(2.5066282746310007*a/i)-s},e.loggam=function(e){var i,n,s,r,o,a,l,c=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(i=e,l=0,1==e||2==e)return 0;for(e<=7&&(i=e+(l=t.floor(7-e))),n=1/(i*i),s=2*t.PI,o=c[9],a=8;a>=0;a--)o*=n,o+=c[a];if(r=o/i+.5*t.log(s)+(i-.5)*t.log(i)-i,e<=7)for(a=1;a<=l;a++)r-=t.log(i-1),i-=1;return r},e.gammafn=function(e){var i,n,s,r,o=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],a=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],l=!1,c=0,h=0,d=0,u=e;if(e>171.6243769536076)return 1/0;if(u<=0){if(!(r=u%1+36e-17))return 1/0;l=(1&u?-1:1)*t.PI/t.sin(t.PI*r),u=1-u}for(s=u,n=u<1?u++:(u-=c=(0|u)-1)-1,i=0;i<8;++i)d=(d+o[i])*n,h=h*n+a[i];if(r=d/h+1,s<u)r/=s;else if(s>u)for(i=0;i<c;++i)r*=u,u++;return l&&(r=l/r),r},e.gammap=function(t,i){return e.lowRegGamma(t,i)*e.gammafn(t)},e.lowRegGamma=function(i,n){var s,r=e.gammaln(i),o=i,a=1/i,l=a,c=n+1-i,h=1/1e-30,d=1/c,u=d,p=1,f=-~(8.5*t.log(i>=1?i:1/i)+.4*i+17);if(n<0||i<=0)return NaN;if(n<i+1){for(;p<=f;p++)a+=l*=n/++o;return a*t.exp(-n+i*t.log(n)-r)}for(;p<=f;p++)u*=(d=1/(d=(s=-p*(p-i))*d+(c+=2)))*(h=c+s/h);return 1-u*t.exp(-n+i*t.log(n)-r)},e.factorialln=function(t){return t<0?NaN:e.gammaln(t+1)},e.factorial=function(t){return t<0?NaN:e.gammafn(t+1)},e.combination=function(i,n){return i>170||n>170?t.exp(e.combinationln(i,n)):e.factorial(i)/e.factorial(n)/e.factorial(i-n)},e.combinationln=function(t,i){return e.factorialln(t)-e.factorialln(i)-e.factorialln(t-i)},e.permutation=function(t,i){return e.factorial(t)/e.factorial(t-i)},e.betafn=function(i,n){if(!(i<=0||n<=0))return i+n>170?t.exp(e.betaln(i,n)):e.gammafn(i)*e.gammafn(n)/e.gammafn(i+n)},e.betaln=function(t,i){return e.gammaln(t)+e.gammaln(i)-e.gammaln(t+i)},e.betacf=function(e,i,n){var s,r,o,a,l=1e-30,c=1,h=i+n,d=i+1,u=i-1,p=1,f=1-h*e/d;for(t.abs(f)<l&&(f=l),a=f=1/f;c<=100&&(f=1+(r=c*(n-c)*e/((u+(s=2*c))*(i+s)))*f,t.abs(f)<l&&(f=l),p=1+r/p,t.abs(p)<l&&(p=l),a*=(f=1/f)*p,f=1+(r=-(i+c)*(h+c)*e/((i+s)*(d+s)))*f,t.abs(f)<l&&(f=l),p=1+r/p,t.abs(p)<l&&(p=l),a*=o=(f=1/f)*p,!(t.abs(o-1)<3e-7));c++);return a},e.gammapinv=function(i,n){var s,r,o,a,l,c,h=0,d=n-1,u=e.gammaln(n);if(i>=1)return t.max(100,n+100*t.sqrt(n));if(i<=0)return 0;for(n>1?(l=t.log(d),c=t.exp(d*(l-1)-u),a=i<.5?i:1-i,s=(2.30753+.27061*(r=t.sqrt(-2*t.log(a))))/(1+r*(.99229+.04481*r))-r,i<.5&&(s=-s),s=t.max(.001,n*t.pow(1-1/(9*n)-s/(3*t.sqrt(n)),3))):s=i<(r=1-n*(.253+.12*n))?t.pow(i/r,1/n):1-t.log(1-(i-r)/(1-r));h<12;h++){if(s<=0)return 0;if((s-=r=(o=(e.lowRegGamma(n,s)-i)/(r=n>1?c*t.exp(-(s-d)+d*(t.log(s)-l)):t.exp(-s+d*t.log(s)-u)))/(1-.5*t.min(1,o*((n-1)/s-1))))<=0&&(s=.5*(s+r)),t.abs(r)<1e-8*s)break}return s},e.erf=function(e){var i,n,s,r,o=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],a=o.length-1,l=!1,c=0,h=0;for(e<0&&(e=-e,l=!0),n=4*(i=2/(2+e))-2;a>0;a--)s=c,c=n*c-h+o[a],h=s;return r=i*t.exp(-e*e+.5*(o[0]+n*c)-h),l?r-1:1-r},e.erfc=function(t){return 1-e.erf(t)},e.erfcinv=function(i){var n,s,r,o,a=0;if(i>=2)return-100;if(i<=0)return 100;for(o=i<1?i:2-i,n=-.70711*((2.30753+.27061*(r=t.sqrt(-2*t.log(o/2))))/(1+r*(.99229+.04481*r))-r);a<2;a++)n+=(s=e.erfc(n)-o)/(1.1283791670955126*t.exp(-n*n)-n*s);return i<1?n:-n},e.ibetainv=function(i,n,s){var r,o,a,l,c,h,d,u,p,f,m=n-1,g=s-1,v=0;if(i<=0)return 0;if(i>=1)return 1;for(n>=1&&s>=1?(a=i<.5?i:1-i,h=(2.30753+.27061*(l=t.sqrt(-2*t.log(a))))/(1+l*(.99229+.04481*l))-l,i<.5&&(h=-h),d=(h*h-3)/6,u=2/(1/(2*n-1)+1/(2*s-1)),p=h*t.sqrt(d+u)/u-(1/(2*s-1)-1/(2*n-1))*(d+5/6-2/(3*u)),h=n/(n+s*t.exp(2*p))):(r=t.log(n/(n+s)),o=t.log(s/(n+s)),h=i<(l=t.exp(n*r)/n)/(p=l+(c=t.exp(s*o)/s))?t.pow(n*p*i,1/n):1-t.pow(s*p*(1-i),1/s)),f=-e.gammaln(n)-e.gammaln(s)+e.gammaln(n+s);v<10;v++){if(0===h||1===h)return h;if((h-=l=(c=(e.ibeta(h,n,s)-i)/(l=t.exp(m*t.log(h)+g*t.log(1-h)+f)))/(1-.5*t.min(1,c*(m/h-g/(1-h)))))<=0&&(h=.5*(h+l)),h>=1&&(h=.5*(h+l+1)),t.abs(l)<1e-8*h&&v>0)break}return h},e.ibeta=function(i,n,s){var r=0===i||1===i?0:t.exp(e.gammaln(n+s)-e.gammaln(n)-e.gammaln(s)+n*t.log(i)+s*t.log(1-i));return!(i<0||i>1)&&(i<(n+1)/(n+s+2)?r*e.betacf(i,n,s)/n:1-r*e.betacf(1-i,s,n)/s)},e.randn=function(i,n){var s,r,o,a,l;if(n||(n=i),i)return e.create(i,n,(function(){return e.randn()}));do{s=e._random_fn(),r=1.7156*(e._random_fn()-.5),l=(o=s-.449871)*o+(a=t.abs(r)+.386595)*(.196*a-.25472*o)}while(l>.27597&&(l>.27846||r*r>-4*t.log(s)*s*s));return r/s},e.randg=function(i,n,s){var r,o,a,l,c,h,d=i;if(s||(s=n),i||(i=1),n)return(h=e.zeros(n,s)).alter((function(){return e.randg(i)})),h;i<1&&(i+=1),r=i-1/3,o=1/t.sqrt(9*r);do{do{l=1+o*(c=e.randn())}while(l<=0);l*=l*l,a=e._random_fn()}while(a>1-.331*t.pow(c,4)&&t.log(a)>.5*c*c+r*(1-l+t.log(l)));if(i==d)return r*l;do{a=e._random_fn()}while(0===a);return t.pow(a,1/d)*r*l},function(t){for(var i=0;i<t.length;i++)!function(t){e.fn[t]=function(){return e(e.map(this,(function(i){return e[t](i)})))}}(t[i])}("gammaln gammafn factorial factorialln".split(" ")),function(t){for(var i=0;i<t.length;i++)!function(t){e.fn[t]=function(){return e(e[t].apply(null,arguments))}}(t[i])}("randn".split(" "))}(t,Math),function(e,t){function i(e,i,n,s){for(var r,o=0,a=1,l=1,c=1,h=0,d=0;t.abs((l-d)/l)>s;)d=l,a=c+(r=-(i+h)*(i+n+h)*e/(i+2*h)/(i+2*h+1))*a,l=(o=l+r*o)+(r=(h+=1)*(n-h)*e/(i+2*h-1)/(i+2*h))*l,o/=c=a+r*c,a/=c,l/=c,c=1;return l/i}function n(i,n,s){var r=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],o=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],a=.5*i;if(a>=8)return 1;var l,c=2*e.normal.cdf(a,0,1,1,0)-1;c=c>=t.exp(-50/s)?t.pow(c,s):0;for(var h=a,d=(8-a)/(l=i>3?2:3),u=h+d,p=0,f=s-1,m=1;m<=l;m++){for(var g=0,v=.5*(u+h),_=.5*(u-h),b=1;b<=12;b++){var y,C=v+_*(6<b?r[(y=12-b+1)-1]:-r[(y=b)-1]),w=C*C;if(w>60)break;var S=2*e.normal.cdf(C,0,1,1,0)*.5-2*e.normal.cdf(C,i,1,1,0)*.5;S>=t.exp(-30/f)&&(g+=S=o[y-1]*t.exp(-.5*w)*t.pow(S,f))}p+=g*=2*_*s/t.sqrt(2*t.PI),h=u,u+=d}return(c+=p)<=t.exp(-30/n)?0:(c=t.pow(c,n))>=1?1:c}!function(t){for(var i=0;i<t.length;i++)!function(t){e[t]=function e(t,i,n){return this instanceof e?(this._a=t,this._b=i,this._c=n,this):new e(t,i,n)},e.fn[t]=function(i,n,s){var r=e[t](i,n,s);return r.data=this,r},e[t].prototype.sample=function(i){var n=this._a,s=this._b,r=this._c;return i?e.alter(i,(function(){return e[t].sample(n,s,r)})):e[t].sample(n,s,r)},function(i){for(var n=0;n<i.length;n++)!function(i){e[t].prototype[i]=function(n){var s=this._a,r=this._b,o=this._c;return n||0===n||(n=this.data),"number"!=typeof n?e.fn.map.call(n,(function(n){return e[t][i](n,s,r,o)})):e[t][i](n,s,r,o)}}(i[n])}("pdf cdf inv".split(" ")),function(i){for(var n=0;n<i.length;n++)!function(i){e[t].prototype[i]=function(){return e[t][i](this._a,this._b,this._c)}}(i[n])}("mean median mode variance".split(" "))}(t[i])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),e.extend(e.beta,{pdf:function(i,n,s){return i>1||i<0?0:1==n&&1==s?1:n<512&&s<512?t.pow(i,n-1)*t.pow(1-i,s-1)/e.betafn(n,s):t.exp((n-1)*t.log(i)+(s-1)*t.log(1-i)-e.betaln(n,s))},cdf:function(t,i,n){return t>1||t<0?1*(t>1):e.ibeta(t,i,n)},inv:function(t,i,n){return e.ibetainv(t,i,n)},mean:function(e,t){return e/(e+t)},median:function(t,i){return e.ibetainv(.5,t,i)},mode:function(e,t){return(e-1)/(e+t-2)},sample:function(t,i){var n=e.randg(t);return n/(n+e.randg(i))},variance:function(e,i){return e*i/(t.pow(e+i,2)*(e+i+1))}}),e.extend(e.centralF,{pdf:function(i,n,s){var r;return i<0?0:n<=2?0===i&&n<2?1/0:0===i&&2===n?1:1/e.betafn(n/2,s/2)*t.pow(n/s,n/2)*t.pow(i,n/2-1)*t.pow(1+n/s*i,-(n+s)/2):(r=n*i/(s+i*n),n*(s/(s+i*n))/2*e.binomial.pdf((n-2)/2,(n+s-2)/2,r))},cdf:function(t,i,n){return t<0?0:e.ibeta(i*t/(i*t+n),i/2,n/2)},inv:function(t,i,n){return n/(i*(1/e.ibetainv(t,i/2,n/2)-1))},mean:function(e,t){return t>2?t/(t-2):void 0},mode:function(e,t){return e>2?t*(e-2)/(e*(t+2)):void 0},sample:function(t,i){return 2*e.randg(t/2)/t/(2*e.randg(i/2)/i)},variance:function(e,t){if(!(t<=4))return 2*t*t*(e+t-2)/(e*(t-2)*(t-2)*(t-4))}}),e.extend(e.cauchy,{pdf:function(e,i,n){return n<0?0:n/(t.pow(e-i,2)+t.pow(n,2))/t.PI},cdf:function(e,i,n){return t.atan((e-i)/n)/t.PI+.5},inv:function(e,i,n){return i+n*t.tan(t.PI*(e-.5))},median:function(e){return e},mode:function(e){return e},sample:function(i,n){return e.randn()*t.sqrt(1/(2*e.randg(.5)))*n+i}}),e.extend(e.chisquare,{pdf:function(i,n){return i<0?0:0===i&&2===n?.5:t.exp((n/2-1)*t.log(i)-i/2-n/2*t.log(2)-e.gammaln(n/2))},cdf:function(t,i){return t<0?0:e.lowRegGamma(i/2,t/2)},inv:function(t,i){return 2*e.gammapinv(t,.5*i)},mean:function(e){return e},median:function(e){return e*t.pow(1-2/(9*e),3)},mode:function(e){return e-2>0?e-2:0},sample:function(t){return 2*e.randg(t/2)},variance:function(e){return 2*e}}),e.extend(e.exponential,{pdf:function(e,i){return e<0?0:i*t.exp(-i*e)},cdf:function(e,i){return e<0?0:1-t.exp(-i*e)},inv:function(e,i){return-t.log(1-e)/i},mean:function(e){return 1/e},median:function(e){return 1/e*t.log(2)},mode:function(){return 0},sample:function(i){return-1/i*t.log(e._random_fn())},variance:function(e){return t.pow(e,-2)}}),e.extend(e.gamma,{pdf:function(i,n,s){return i<0?0:0===i&&1===n?1/s:t.exp((n-1)*t.log(i)-i/s-e.gammaln(n)-n*t.log(s))},cdf:function(t,i,n){return t<0?0:e.lowRegGamma(i,t/n)},inv:function(t,i,n){return e.gammapinv(t,i)*n},mean:function(e,t){return e*t},mode:function(e,t){if(e>1)return(e-1)*t},sample:function(t,i){return e.randg(t)*i},variance:function(e,t){return e*t*t}}),e.extend(e.invgamma,{pdf:function(i,n,s){return i<=0?0:t.exp(-(n+1)*t.log(i)-s/i-e.gammaln(n)+n*t.log(s))},cdf:function(t,i,n){return t<=0?0:1-e.lowRegGamma(i,n/t)},inv:function(t,i,n){return n/e.gammapinv(1-t,i)},mean:function(e,t){return e>1?t/(e-1):void 0},mode:function(e,t){return t/(e+1)},sample:function(t,i){return i/e.randg(t)},variance:function(e,t){if(!(e<=2))return t*t/((e-1)*(e-1)*(e-2))}}),e.extend(e.kumaraswamy,{pdf:function(e,i,n){return 0===e&&1===i?n:1===e&&1===n?i:t.exp(t.log(i)+t.log(n)+(i-1)*t.log(e)+(n-1)*t.log(1-t.pow(e,i)))},cdf:function(e,i,n){return e<0?0:e>1?1:1-t.pow(1-t.pow(e,i),n)},inv:function(e,i,n){return t.pow(1-t.pow(1-e,1/n),1/i)},mean:function(t,i){return i*e.gammafn(1+1/t)*e.gammafn(i)/e.gammafn(1+1/t+i)},median:function(e,i){return t.pow(1-t.pow(2,-1/i),1/e)},mode:function(e,i){if(e>=1&&i>=1&&1!==e&&1!==i)return t.pow((e-1)/(e*i-1),1/e)},variance:function(){throw new Error("variance not yet implemented")}}),e.extend(e.lognormal,{pdf:function(e,i,n){return e<=0?0:t.exp(-t.log(e)-.5*t.log(2*t.PI)-t.log(n)-t.pow(t.log(e)-i,2)/(2*n*n))},cdf:function(i,n,s){return i<0?0:.5+.5*e.erf((t.log(i)-n)/t.sqrt(2*s*s))},inv:function(i,n,s){return t.exp(-1.4142135623730951*s*e.erfcinv(2*i)+n)},mean:function(e,i){return t.exp(e+i*i/2)},median:function(e){return t.exp(e)},mode:function(e,i){return t.exp(e-i*i)},sample:function(i,n){return t.exp(e.randn()*n+i)},variance:function(e,i){return(t.exp(i*i)-1)*t.exp(2*e+i*i)}}),e.extend(e.noncentralt,{pdf:function(i,n,s){return t.abs(s)<1e-14?e.studentt.pdf(i,n):t.abs(i)<1e-14?t.exp(e.gammaln((n+1)/2)-s*s/2-.5*t.log(t.PI*n)-e.gammaln(n/2)):n/i*(e.noncentralt.cdf(i*t.sqrt(1+2/n),n+2,s)-e.noncentralt.cdf(i,n,s))},cdf:function(i,n,s){var r=1e-14;if(t.abs(s)<r)return e.studentt.cdf(i,n);var o=!1;i<0&&(o=!0,s=-s);for(var a=e.normal.cdf(-s,0,1),l=r+1,c=l,h=i*i/(i*i+n),d=0,u=t.exp(-s*s/2),p=t.exp(-s*s/2-.5*t.log(2)-e.gammaln(1.5))*s;d<200||c>r||l>r;)c=l,d>0&&(u*=s*s/(2*d),p*=s*s/(2*(d+.5))),a+=.5*(l=u*e.beta.cdf(h,d+.5,n/2)+p*e.beta.cdf(h,d+1,n/2)),d++;return o?1-a:a}}),e.extend(e.normal,{pdf:function(e,i,n){return t.exp(-.5*t.log(2*t.PI)-t.log(n)-t.pow(e-i,2)/(2*n*n))},cdf:function(i,n,s){return.5*(1+e.erf((i-n)/t.sqrt(2*s*s)))},inv:function(t,i,n){return-1.4142135623730951*n*e.erfcinv(2*t)+i},mean:function(e){return e},median:function(e){return e},mode:function(e){return e},sample:function(t,i){return e.randn()*i+t},variance:function(e,t){return t*t}}),e.extend(e.pareto,{pdf:function(e,i,n){return e<i?0:n*t.pow(i,n)/t.pow(e,n+1)},cdf:function(e,i,n){return e<i?0:1-t.pow(i/e,n)},inv:function(e,i,n){return i/t.pow(1-e,1/n)},mean:function(e,i){if(!(i<=1))return i*t.pow(e,i)/(i-1)},median:function(e,i){return e*(i*t.SQRT2)},mode:function(e){return e},variance:function(e,i){if(!(i<=2))return e*e*i/(t.pow(i-1,2)*(i-2))}}),e.extend(e.studentt,{pdf:function(i,n){return n=n>1e100?1e100:n,1/(t.sqrt(n)*e.betafn(.5,n/2))*t.pow(1+i*i/n,-(n+1)/2)},cdf:function(i,n){var s=n/2;return e.ibeta((i+t.sqrt(i*i+n))/(2*t.sqrt(i*i+n)),s,s)},inv:function(i,n){var s=e.ibetainv(2*t.min(i,1-i),.5*n,.5);return s=t.sqrt(n*(1-s)/s),i>.5?s:-s},mean:function(e){return e>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(i){return e.randn()*t.sqrt(i/(2*e.randg(i/2)))},variance:function(e){return e>2?e/(e-2):e>1?1/0:void 0}}),e.extend(e.weibull,{pdf:function(e,i,n){return e<0||i<0||n<0?0:n/i*t.pow(e/i,n-1)*t.exp(-t.pow(e/i,n))},cdf:function(e,i,n){return e<0?0:1-t.exp(-t.pow(e/i,n))},inv:function(e,i,n){return i*t.pow(-t.log(1-e),1/n)},mean:function(t,i){return t*e.gammafn(1+1/i)},median:function(e,i){return e*t.pow(t.log(2),1/i)},mode:function(e,i){return i<=1?0:e*t.pow((i-1)/i,1/i)},sample:function(i,n){return i*t.pow(-t.log(e._random_fn()),1/n)},variance:function(i,n){return i*i*e.gammafn(1+2/n)-t.pow(e.weibull.mean(i,n),2)}}),e.extend(e.uniform,{pdf:function(e,t,i){return e<t||e>i?0:1/(i-t)},cdf:function(e,t,i){return e<t?0:e<i?(e-t)/(i-t):1},inv:function(e,t,i){return t+e*(i-t)},mean:function(e,t){return.5*(e+t)},median:function(t,i){return e.mean(t,i)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(t,i){return t/2+i/2+(i/2-t/2)*(2*e._random_fn()-1)},variance:function(e,i){return t.pow(i-e,2)/12}}),e.extend(e.binomial,{pdf:function(i,n,s){return 0===s||1===s?n*s===i?1:0:e.combination(n,i)*t.pow(s,i)*t.pow(1-s,n-i)},cdf:function(n,s,r){var o,a=1e-10;if(n<0)return 0;if(n>=s)return 1;if(r<0||r>1||s<=0)return NaN;var l=r,c=(n=t.floor(n))+1,h=s-n,d=c+h,u=t.exp(e.gammaln(d)-e.gammaln(h)-e.gammaln(c)+c*t.log(l)+h*t.log(1-l));return o=l<(c+1)/(d+2)?u*i(l,c,h,a):1-u*i(1-l,h,c,a),t.round(1/a*(1-o))/(1/a)}}),e.extend(e.negbin,{pdf:function(i,n,s){return i===i>>>0&&(i<0?0:e.combination(i+n-1,n-1)*t.pow(1-s,i)*t.pow(s,n))},cdf:function(t,i,n){var s=0,r=0;if(t<0)return 0;for(;r<=t;r++)s+=e.negbin.pdf(r,i,n);return s}}),e.extend(e.hypgeom,{pdf:function(i,n,s,r){if(i!=i|0)return!1;if(i<0||i<s-(n-r))return 0;if(i>r||i>s)return 0;if(2*s>n)return 2*r>n?e.hypgeom.pdf(n-s-r+i,n,n-s,n-r):e.hypgeom.pdf(r-i,n,n-s,r);if(2*r>n)return e.hypgeom.pdf(s-i,n,s,n-r);if(s<r)return e.hypgeom.pdf(i,n,r,s);for(var o=1,a=0,l=0;l<i;l++){for(;o>1&&a<r;)o*=1-s/(n-a),a++;o*=(r-l)*(s-l)/((l+1)*(n-s-r+l+1))}for(;a<r;a++)o*=1-s/(n-a);return t.min(1,t.max(0,o))},cdf:function(i,n,s,r){if(i<0||i<s-(n-r))return 0;if(i>=r||i>=s)return 1;if(2*s>n)return 2*r>n?e.hypgeom.cdf(n-s-r+i,n,n-s,n-r):1-e.hypgeom.cdf(r-i-1,n,n-s,r);if(2*r>n)return 1-e.hypgeom.cdf(s-i-1,n,s,n-r);if(s<r)return e.hypgeom.cdf(i,n,r,s);for(var o=1,a=1,l=0,c=0;c<i;c++){for(;o>1&&l<r;){var h=1-s/(n-l);a*=h,o*=h,l++}o+=a*=(r-c)*(s-c)/((c+1)*(n-s-r+c+1))}for(;l<r;l++)o*=1-s/(n-l);return t.min(1,t.max(0,o))}}),e.extend(e.poisson,{pdf:function(i,n){return n<0||i%1!=0||i<0?0:t.pow(n,i)*t.exp(-n)/e.factorial(i)},cdf:function(t,i){var n=[],s=0;if(t<0)return 0;for(;s<=t;s++)n.push(e.poisson.pdf(s,i));return e.sum(n)},mean:function(e){return e},variance:function(e){return e},sampleSmall:function(i){var n=1,s=0,r=t.exp(-i);do{s++,n*=e._random_fn()}while(n>r);return s-1},sampleLarge:function(i){var n,s,r,o,a,l,c,h,d,u,p=i;for(o=t.sqrt(p),a=t.log(p),l=.02483*(c=.931+2.53*o)-.059,h=1.1239+1.1328/(c-3.4),d=.9277-3.6224/(c-2);;){if(s=t.random()-.5,r=t.random(),u=.5-t.abs(s),n=t.floor((2*l/u+c)*s+p+.43),u>=.07&&r<=d)return n;if(!(n<0||u<.013&&r>u)&&t.log(r)+t.log(h)-t.log(l/(u*u)+c)<=n*a-p-e.loggam(n+1))return n}},sample:function(e){return e<10?this.sampleSmall(e):this.sampleLarge(e)}}),e.extend(e.triangular,{pdf:function(e,t,i,n){return i<=t||n<t||n>i?NaN:e<t||e>i?0:e<n?2*(e-t)/((i-t)*(n-t)):e===n?2/(i-t):2*(i-e)/((i-t)*(i-n))},cdf:function(e,i,n,s){return n<=i||s<i||s>n?NaN:e<=i?0:e>=n?1:e<=s?t.pow(e-i,2)/((n-i)*(s-i)):1-t.pow(n-e,2)/((n-i)*(n-s))},inv:function(e,i,n,s){return n<=i||s<i||s>n?NaN:e<=(s-i)/(n-i)?i+(n-i)*t.sqrt(e*((s-i)/(n-i))):i+(n-i)*(1-t.sqrt((1-e)*(1-(s-i)/(n-i))))},mean:function(e,t,i){return(e+t+i)/3},median:function(e,i,n){return n<=(e+i)/2?i-t.sqrt((i-e)*(i-n))/t.sqrt(2):n>(e+i)/2?e+t.sqrt((i-e)*(n-e))/t.sqrt(2):void 0},mode:function(e,t,i){return i},sample:function(i,n,s){var r=e._random_fn();return r<(s-i)/(n-i)?i+t.sqrt(r*(n-i)*(s-i)):n-t.sqrt((1-r)*(n-i)*(n-s))},variance:function(e,t,i){return(e*e+t*t+i*i-e*t-e*i-t*i)/18}}),e.extend(e.arcsine,{pdf:function(e,i,n){return n<=i?NaN:e<=i||e>=n?0:2/t.PI*t.pow(t.pow(n-i,2)-t.pow(2*e-i-n,2),-.5)},cdf:function(e,i,n){return e<i?0:e<n?2/t.PI*t.asin(t.sqrt((e-i)/(n-i))):1},inv:function(e,i,n){return i+(.5-.5*t.cos(t.PI*e))*(n-i)},mean:function(e,t){return t<=e?NaN:(e+t)/2},median:function(e,t){return t<=e?NaN:(e+t)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(i,n){return(i+n)/2+(n-i)/2*t.sin(2*t.PI*e.uniform.sample(0,1))},variance:function(e,i){return i<=e?NaN:t.pow(i-e,2)/8}}),e.extend(e.laplace,{pdf:function(e,i,n){return n<=0?0:t.exp(-t.abs(e-i)/n)/(2*n)},cdf:function(e,i,n){return n<=0?0:e<i?.5*t.exp((e-i)/n):1-.5*t.exp(-(e-i)/n)},mean:function(e){return e},median:function(e){return e},mode:function(e){return e},variance:function(e,t){return 2*t*t},sample:function(i,n){var s,r=e._random_fn()-.5;return i-n*((s=r)/t.abs(s))*t.log(1-2*t.abs(r))}}),e.extend(e.tukey,{cdf:function(i,s,r){var o=s,a=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],l=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(i<=0)return 0;if(r<2||o<2)return NaN;if(!Number.isFinite(i))return 1;if(r>25e3)return n(i,1,o);var c,h=.5*r,d=h*t.log(r)-r*t.log(2)-e.gammaln(h),u=h-1,p=.25*r;c=r<=100?1:r<=800?.5:r<=5e3?.25:.125,d+=t.log(c);for(var f=0,m=1;m<=50;m++){for(var g=0,v=(2*m-1)*c,_=1;_<=16;_++){var b,y;8<_?(b=_-8-1,y=d+u*t.log(v+a[b]*c)-(a[b]*c+v)*p):(b=_-1,y=d+u*t.log(v-a[b]*c)+(a[b]*c-v)*p),y>=-30&&(g+=n(8<_?i*t.sqrt(.5*(a[b]*c+v)):i*t.sqrt(.5*(-a[b]*c+v)),1,o)*l[b]*t.exp(y))}if(m*c>=1&&g<=1e-14)break;f+=g}if(g>1e-14)throw new Error("tukey.cdf failed to converge");return f>1&&(f=1),f},inv:function(i,n,s){if(s<2||n<2)return NaN;if(i<0||i>1)return NaN;if(0===i)return 0;if(1===i)return 1/0;var r,o=function(e,i,n){var s=.5-.5*e,r=t.sqrt(t.log(1/(s*s))),o=r+((((-453642210148e-16*r-.204231210125)*r-.342242088547)*r-1)*r+.322232421088)/((((.0038560700634*r+.10353775285)*r+.531103462366)*r+.588581570495)*r+.099348462606);n<120&&(o+=(o*o*o+o)/n/4);var a=.8832-.2368*o;return n<120&&(a+=-1.214/n+1.208*o/n),o*(a*t.log(i-1)+1.4142)}(i,n,s),a=e.tukey.cdf(o,n,s)-i;r=a>0?t.max(0,o-1):o+1;for(var l,c=e.tukey.cdf(r,n,s)-i,h=1;h<50;h++)if(l=r-c*(r-o)/(c-a),a=c,o=r,l<0&&(l=0,c=-i),c=e.tukey.cdf(l,n,s)-i,r=l,t.abs(r-o)<1e-4)return l;throw new Error("tukey.inv failed to converge")}})}(t,Math),function(e,t){var i,n,s=Array.prototype.push,r=e.utils.isArray;function o(t){return r(t)||t instanceof e}e.extend({add:function(t,i){return o(i)?(o(i[0])||(i=[i]),e.map(t,(function(e,t,n){return e+i[t][n]}))):e.map(t,(function(e){return e+i}))},subtract:function(t,i){return o(i)?(o(i[0])||(i=[i]),e.map(t,(function(e,t,n){return e-i[t][n]||0}))):e.map(t,(function(e){return e-i}))},divide:function(t,i){return o(i)?(o(i[0])||(i=[i]),e.multiply(t,e.inv(i))):e.map(t,(function(e){return e/i}))},multiply:function(t,i){var n,s,r,a,l,c,h,d;if(void 0===t.length&&void 0===i.length)return t*i;if(l=t.length,c=t[0].length,h=e.zeros(l,r=o(i)?i[0].length:c),d=0,o(i)){for(;d<r;d++)for(n=0;n<l;n++){for(a=0,s=0;s<c;s++)a+=t[n][s]*i[s][d];h[n][d]=a}return 1===l&&1===d?h[0][0]:h}return e.map(t,(function(e){return e*i}))},outer:function(t,i){return e.multiply(t.map((function(e){return[e]})),[i])},dot:function(t,i){o(t[0])||(t=[t]),o(i[0])||(i=[i]);for(var n,s,r=1===t[0].length&&1!==t.length?e.transpose(t):t,a=1===i[0].length&&1!==i.length?e.transpose(i):i,l=[],c=0,h=r.length,d=r[0].length;c<h;c++){for(l[c]=[],n=0,s=0;s<d;s++)n+=r[c][s]*a[c][s];l[c]=n}return 1===l.length?l[0]:l},pow:function(i,n){return e.map(i,(function(e){return t.pow(e,n)}))},exp:function(i){return e.map(i,(function(e){return t.exp(e)}))},log:function(i){return e.map(i,(function(e){return t.log(e)}))},abs:function(i){return e.map(i,(function(e){return t.abs(e)}))},norm:function(e,i){var n=0,s=0;for(isNaN(i)&&(i=2),o(e[0])&&(e=e[0]);s<e.length;s++)n+=t.pow(t.abs(e[s]),i);return t.pow(n,1/i)},angle:function(i,n){return t.acos(e.dot(i,n)/(e.norm(i)*e.norm(n)))},aug:function(e,t){var i,n=[];for(i=0;i<e.length;i++)n.push(e[i].slice());for(i=0;i<n.length;i++)s.apply(n[i],t[i]);return n},inv:function(t){for(var i,n=t.length,s=t[0].length,r=e.identity(n,s),o=e.gauss_jordan(t,r),a=[],l=0;l<n;l++)for(a[l]=[],i=s;i<o[0].length;i++)a[l][i-s]=o[l][i];return a},det:function e(t){if(2===t.length)return t[0][0]*t[1][1]-t[0][1]*t[1][0];for(var i=0,n=0;n<t.length;n++){for(var s=[],r=1;r<t.length;r++){s[r-1]=[];for(var o=0;o<t.length;o++)o<n?s[r-1][o]=t[r][o]:o>n&&(s[r-1][o-1]=t[r][o])}var a=n%2?-1:1;i+=e(s)*t[0][n]*a}return i},gauss_elimination:function(i,n){var s,r,o,a,l=0,c=0,h=i.length,d=i[0].length,u=1,p=0,f=[];for(s=(i=e.aug(i,n))[0].length,l=0;l<h;l++){for(r=i[l][l],c=l,a=l+1;a<d;a++)r<t.abs(i[a][l])&&(r=i[a][l],c=a);if(c!=l)for(a=0;a<s;a++)o=i[l][a],i[l][a]=i[c][a],i[c][a]=o;for(c=l+1;c<h;c++)for(u=i[c][l]/i[l][l],a=l;a<s;a++)i[c][a]=i[c][a]-u*i[l][a]}for(l=h-1;l>=0;l--){for(p=0,c=l+1;c<=h-1;c++)p+=f[c]*i[l][c];f[l]=(i[l][s-1]-p)/i[l][l]}return f},gauss_jordan:function(i,n){var s,r,o,a=e.aug(i,n),l=a.length,c=a[0].length,h=0;for(r=0;r<l;r++){var d=r;for(o=r+1;o<l;o++)t.abs(a[o][r])>t.abs(a[d][r])&&(d=o);var u=a[r];for(a[r]=a[d],a[d]=u,o=r+1;o<l;o++)for(h=a[o][r]/a[r][r],s=r;s<c;s++)a[o][s]-=a[r][s]*h}for(r=l-1;r>=0;r--){for(h=a[r][r],o=0;o<r;o++)for(s=c-1;s>r-1;s--)a[o][s]-=a[r][s]*a[o][r]/h;for(a[r][r]/=h,s=l;s<c;s++)a[r][s]/=h}return a},triaUpSolve:function(t,i){var n,s=t[0].length,r=e.zeros(1,s)[0],o=!1;return null!=i[0].length&&(i=i.map((function(e){return e[0]})),o=!0),e.arange(s-1,-1,-1).forEach((function(o){n=e.arange(o+1,s).map((function(e){return r[e]*t[o][e]})),r[o]=(i[o]-e.sum(n))/t[o][o]})),o?r.map((function(e){return[e]})):r},triaLowSolve:function(t,i){var n,s=t[0].length,r=e.zeros(1,s)[0],o=!1;return null!=i[0].length&&(i=i.map((function(e){return e[0]})),o=!0),e.arange(s).forEach((function(s){n=e.arange(s).map((function(e){return t[s][e]*r[e]})),r[s]=(i[s]-e.sum(n))/t[s][s]})),o?r.map((function(e){return[e]})):r},lu:function(t){var i,n=t.length,s=e.identity(n),r=e.zeros(t.length,t[0].length);return e.arange(n).forEach((function(e){r[0][e]=t[0][e]})),e.arange(1,n).forEach((function(o){e.arange(o).forEach((function(n){i=e.arange(n).map((function(e){return s[o][e]*r[e][n]})),s[o][n]=(t[o][n]-e.sum(i))/r[n][n]})),e.arange(o,n).forEach((function(n){i=e.arange(o).map((function(e){return s[o][e]*r[e][n]})),r[o][n]=t[i.length][n]-e.sum(i)}))})),[s,r]},cholesky:function(i){var n,s=i.length,r=e.zeros(i.length,i[0].length);return e.arange(s).forEach((function(o){n=e.arange(o).map((function(e){return t.pow(r[o][e],2)})),r[o][o]=t.sqrt(i[o][o]-e.sum(n)),e.arange(o+1,s).forEach((function(t){n=e.arange(o).map((function(e){return r[o][e]*r[t][e]})),r[t][o]=(i[o][t]-e.sum(n))/r[o][o]}))})),r},gauss_jacobi:function(i,n,s,r){for(var o,a,l,c,h=0,d=0,u=i.length,p=[],f=[],m=[];h<u;h++)for(p[h]=[],f[h]=[],m[h]=[],d=0;d<u;d++)h>d?(p[h][d]=i[h][d],f[h][d]=m[h][d]=0):h<d?(f[h][d]=i[h][d],p[h][d]=m[h][d]=0):(m[h][d]=i[h][d],p[h][d]=f[h][d]=0);for(l=e.multiply(e.multiply(e.inv(m),e.add(p,f)),-1),a=e.multiply(e.inv(m),n),o=s,c=e.add(e.multiply(l,s),a),h=2;t.abs(e.norm(e.subtract(c,o)))>r;)o=c,c=e.add(e.multiply(l,o),a),h++;return c},gauss_seidel:function(i,n,s,r){for(var o,a,l,c,h,d=0,u=i.length,p=[],f=[],m=[];d<u;d++)for(p[d]=[],f[d]=[],m[d]=[],o=0;o<u;o++)d>o?(p[d][o]=i[d][o],f[d][o]=m[d][o]=0):d<o?(f[d][o]=i[d][o],p[d][o]=m[d][o]=0):(m[d][o]=i[d][o],p[d][o]=f[d][o]=0);for(c=e.multiply(e.multiply(e.inv(e.add(m,p)),f),-1),l=e.multiply(e.inv(e.add(m,p)),n),a=s,h=e.add(e.multiply(c,s),l),d=2;t.abs(e.norm(e.subtract(h,a)))>r;)a=h,h=e.add(e.multiply(c,a),l),d+=1;return h},SOR:function(i,n,s,r,o){for(var a,l,c,h,d,u=0,p=i.length,f=[],m=[],g=[];u<p;u++)for(f[u]=[],m[u]=[],g[u]=[],a=0;a<p;a++)u>a?(f[u][a]=i[u][a],m[u][a]=g[u][a]=0):u<a?(m[u][a]=i[u][a],f[u][a]=g[u][a]=0):(g[u][a]=i[u][a],f[u][a]=m[u][a]=0);for(h=e.multiply(e.inv(e.add(g,e.multiply(f,o))),e.subtract(e.multiply(g,1-o),e.multiply(m,o))),c=e.multiply(e.multiply(e.inv(e.add(g,e.multiply(f,o))),n),o),l=s,d=e.add(e.multiply(h,s),c),u=2;t.abs(e.norm(e.subtract(d,l)))>r;)l=d,d=e.add(e.multiply(h,l),c),u++;return d},householder:function(i){for(var n,s,r,o,a=i.length,l=i[0].length,c=0,h=[],d=[];c<a-1;c++){for(n=0,o=c+1;o<l;o++)n+=i[o][c]*i[o][c];for(n=(i[c+1][c]>0?-1:1)*t.sqrt(n),s=t.sqrt((n*n-i[c+1][c]*n)/2),(h=e.zeros(a,1))[c+1][0]=(i[c+1][c]-n)/(2*s),r=c+2;r<a;r++)h[r][0]=i[r][c]/(2*s);d=e.subtract(e.identity(a,l),e.multiply(e.multiply(h,e.transpose(h)),2)),i=e.multiply(d,e.multiply(i,d))}return i},QR:(i=e.sum,n=e.arange,function(s){var r,o,a,l=s.length,c=s[0].length,h=e.zeros(c,c);for(s=e.copy(s),o=0;o<c;o++){for(h[o][o]=t.sqrt(i(n(l).map((function(e){return s[e][o]*s[e][o]})))),r=0;r<l;r++)s[r][o]=s[r][o]/h[o][o];for(a=o+1;a<c;a++)for(h[o][a]=i(n(l).map((function(e){return s[e][o]*s[e][a]}))),r=0;r<l;r++)s[r][a]=s[r][a]-s[r][o]*h[o][a]}return[s,h]}),lstsq:function(t,i){var n=!1;void 0===i[0].length&&(i=i.map((function(e){return[e]})),n=!0);var s=e.QR(t),r=s[0],o=s[1],a=t[0].length,l=e.slice(r,{col:{end:a}}),c=function(t){var i=(t=e.copy(t)).length,n=e.identity(i);return e.arange(i-1,-1,-1).forEach((function(i){e.sliceAssign(n,{row:i},e.divide(e.slice(n,{row:i}),t[i][i])),e.sliceAssign(t,{row:i},e.divide(e.slice(t,{row:i}),t[i][i])),e.arange(i).forEach((function(s){var r=e.multiply(t[s][i],-1),o=e.slice(t,{row:s}),a=e.multiply(e.slice(t,{row:i}),r);e.sliceAssign(t,{row:s},e.add(o,a));var l=e.slice(n,{row:s}),c=e.multiply(e.slice(n,{row:i}),r);e.sliceAssign(n,{row:s},e.add(l,c))}))})),n}(e.slice(o,{row:{end:a}})),h=e.transpose(l);void 0===h[0].length&&(h=[h]);var d=e.multiply(e.multiply(c,h),i);return void 0===d.length&&(d=[[d]]),n?d.map((function(e){return e[0]})):d},jacobi:function(i){for(var n,s,r,o,a,l,c,h=1,d=i.length,u=e.identity(d,d),p=[];1===h;){for(a=i[0][1],r=0,o=1,n=0;n<d;n++)for(s=0;s<d;s++)n!=s&&a<t.abs(i[n][s])&&(a=t.abs(i[n][s]),r=n,o=s);for(l=i[r][r]===i[o][o]?i[r][o]>0?t.PI/4:-t.PI/4:t.atan(2*i[r][o]/(i[r][r]-i[o][o]))/2,(c=e.identity(d,d))[r][r]=t.cos(l),c[r][o]=-t.sin(l),c[o][r]=t.sin(l),c[o][o]=t.cos(l),u=e.multiply(u,c),i=e.multiply(e.multiply(e.inv(c),i),c),h=0,n=1;n<d;n++)for(s=1;s<d;s++)n!=s&&t.abs(i[n][s])>.001&&(h=1)}for(n=0;n<d;n++)p.push(i[n][n]);return[u,p]},rungekutta:function(e,t,i,n,s,r){var o,a,l;if(2===r)for(;n<=i;)s+=((o=t*e(n,s))+(a=t*e(n+t,s+o)))/2,n+=t;if(4===r)for(;n<=i;)s+=((o=t*e(n,s))+2*(a=t*e(n+t/2,s+o/2))+2*(l=t*e(n+t/2,s+a/2))+t*e(n+t,s+l))/6,n+=t;return s},romberg:function(e,i,n,s){for(var r,o,a,l,c,h=0,d=(n-i)/2,u=[],p=[],f=[];h<s/2;){for(c=e(i),a=i,l=0;a<=n;a+=d,l++)u[l]=a;for(r=u.length,a=1;a<r-1;a++)c+=(a%2!=0?4:2)*e(u[a]);c=d/3*(c+e(n)),f[h]=c,d/=2,h++}for(o=f.length,r=1;1!==o;){for(a=0;a<o-1;a++)p[a]=(t.pow(4,r)*f[a+1]-f[a])/(t.pow(4,r)-1);o=p.length,f=p,p=[],r++}return f},richardson:function(e,i,n,s){function r(e,t){for(var i,n=0,s=e.length;n<s;n++)e[n]===t&&(i=n);return i}for(var o,a,l,c,h,d=t.abs(n-e[r(e,n)+1]),u=0,p=[],f=[];s>=d;)o=r(e,n+s),a=r(e,n),p[u]=(i[o]-2*i[a]+i[2*a-o])/(s*s),s/=2,u++;for(c=p.length,l=1;1!=c;){for(h=0;h<c-1;h++)f[h]=(t.pow(4,l)*p[h+1]-p[h])/(t.pow(4,l)-1);c=f.length,p=f,f=[],l++}return p},simpson:function(e,t,i,n){for(var s,r=(i-t)/n,o=e(t),a=[],l=t,c=0,h=1;l<=i;l+=r,c++)a[c]=l;for(s=a.length;h<s-1;h++)o+=(h%2!=0?4:2)*e(a[h]);return r/3*(o+e(i))},hermite:function(e,t,i,n){for(var s,r=e.length,o=0,a=0,l=[],c=[],h=[],d=[];a<r;a++){for(l[a]=1,s=0;s<r;s++)a!=s&&(l[a]*=(n-e[s])/(e[a]-e[s]));for(c[a]=0,s=0;s<r;s++)a!=s&&(c[a]+=1/(e[a]-e[s]));h[a]=(1-2*(n-e[a])*c[a])*(l[a]*l[a]),d[a]=(n-e[a])*(l[a]*l[a]),o+=h[a]*t[a]+d[a]*i[a]}return o},lagrange:function(e,t,i){for(var n,s,r=0,o=0,a=e.length;o<a;o++){for(s=t[o],n=0;n<a;n++)o!=n&&(s*=(i-e[n])/(e[o]-e[n]));r+=s}return r},cubic_spline:function(t,i,n){for(var s,r,o=t.length,a=0,l=[],c=[],h=[],d=[],u=[],p=[];a<o-1;a++)d[a]=t[a+1]-t[a];for(h[0]=0,a=1;a<o-1;a++)h[a]=3/d[a]*(i[a+1]-i[a])-3/d[a-1]*(i[a]-i[a-1]);for(a=1;a<o-1;a++)l[a]=[],c[a]=[],l[a][a-1]=d[a-1],l[a][a]=2*(d[a-1]+d[a]),l[a][a+1]=d[a],c[a][0]=h[a];for(r=e.multiply(e.inv(l),c),s=0;s<o-1;s++)u[s]=(i[s+1]-i[s])/d[s]-d[s]*(r[s+1][0]+2*r[s][0])/3,p[s]=(r[s+1][0]-r[s][0])/(3*d[s]);for(s=0;s<o&&!(t[s]>n);s++);return i[s-=1]+(n-t[s])*u[s]+e.sq(n-t[s])*r[s]+(n-t[s])*e.sq(n-t[s])*p[s]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(t){var i,n,s,r,o,a=t.length,l=t[0].length,c=0,h=[],d=[],u=[],p=[],f=[],m=[],g=[];for(c=0;c<a;c++)h[c]=e.sum(t[c])/l;for(c=0;c<l;c++)for(f[c]=[],i=0;i<a;i++)f[c][i]=t[i][c]-h[i];for(f=e.transpose(f),c=0;c<a;c++)for(m[c]=[],i=0;i<a;i++)m[c][i]=e.dot([f[c]],[f[i]])/(l-1);for(o=(s=e.jacobi(m))[0],d=s[1],g=e.transpose(o),c=0;c<d.length;c++)for(i=c;i<d.length;i++)d[c]<d[i]&&(n=d[c],d[c]=d[i],d[i]=n,u=g[c],g[c]=g[i],g[i]=u);for(r=e.transpose(f),c=0;c<a;c++)for(p[c]=[],i=0;i<r.length;i++)p[c][i]=e.dot([g[c]],[r[i]]);return[t,d,g,p]}}),function(t){for(var i=0;i<t.length;i++)!function(t){e.fn[t]=function(i,n){var s=this;return n?(setTimeout((function(){n.call(s,e.fn[t].call(s,i))}),15),this):"number"==typeof e[t](this,i)?e[t](this,i):e(e[t](this,i))}}(t[i])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(t,Math),function(e,t){var i=[].slice,n=e.utils.isNumber,s=e.utils.isArray;function r(e,i,n,s){if(e>1||n>1||e<=0||n<=0)throw new Error("Proportions should be greater than 0 and less than 1");var r=(e*i+n*s)/(i+s);return(e-n)/t.sqrt(r*(1-r)*(1/i+1/s))}e.extend({zscore:function(){var t=i.call(arguments);return n(t[1])?(t[0]-t[1])/t[2]:(t[0]-e.mean(t[1]))/e.stdev(t[1],t[2])},ztest:function(){var n,r=i.call(arguments);return s(r[1])?(n=e.zscore(r[0],r[1],r[3]),1===r[2]?e.normal.cdf(-t.abs(n),0,1):2*e.normal.cdf(-t.abs(n),0,1)):r.length>2?(n=e.zscore(r[0],r[1],r[2]),1===r[3]?e.normal.cdf(-t.abs(n),0,1):2*e.normal.cdf(-t.abs(n),0,1)):(n=r[0],1===r[1]?e.normal.cdf(-t.abs(n),0,1):2*e.normal.cdf(-t.abs(n),0,1))}}),e.extend(e.fn,{zscore:function(e,t){return(e-this.mean())/this.stdev(t)},ztest:function(i,n,s){var r=t.abs(this.zscore(i,s));return 1===n?e.normal.cdf(-r,0,1):2*e.normal.cdf(-r,0,1)}}),e.extend({tscore:function(){var n=i.call(arguments);return 4===n.length?(n[0]-n[1])/(n[2]/t.sqrt(n[3])):(n[0]-e.mean(n[1]))/(e.stdev(n[1],!0)/t.sqrt(n[1].length))},ttest:function(){var s,r=i.call(arguments);return 5===r.length?(s=t.abs(e.tscore(r[0],r[1],r[2],r[3])),1===r[4]?e.studentt.cdf(-s,r[3]-1):2*e.studentt.cdf(-s,r[3]-1)):n(r[1])?(s=t.abs(r[0]),1==r[2]?e.studentt.cdf(-s,r[1]-1):2*e.studentt.cdf(-s,r[1]-1)):(s=t.abs(e.tscore(r[0],r[1])),1==r[2]?e.studentt.cdf(-s,r[1].length-1):2*e.studentt.cdf(-s,r[1].length-1))}}),e.extend(e.fn,{tscore:function(e){return(e-this.mean())/(this.stdev(!0)/t.sqrt(this.cols()))},ttest:function(i,n){return 1===n?1-e.studentt.cdf(t.abs(this.tscore(i)),this.cols()-1):2*e.studentt.cdf(-t.abs(this.tscore(i)),this.cols()-1)}}),e.extend({anovafscore:function(){var n,s,r,o,a,l,c,h,d=i.call(arguments);if(1===d.length){for(a=new Array(d[0].length),c=0;c<d[0].length;c++)a[c]=d[0][c];d=a}for(s=new Array,c=0;c<d.length;c++)s=s.concat(d[c]);for(r=e.mean(s),n=0,c=0;c<d.length;c++)n+=d[c].length*t.pow(e.mean(d[c])-r,2);for(n/=d.length-1,l=0,c=0;c<d.length;c++)for(o=e.mean(d[c]),h=0;h<d[c].length;h++)l+=t.pow(d[c][h]-o,2);return n/(l/(s.length-d.length))},anovaftest:function(){var t,s,r,o,a=i.call(arguments);if(n(a[0]))return 1-e.centralF.cdf(a[0],a[1],a[2]);var l=e.anovafscore(a);for(t=a.length-1,r=0,o=0;o<a.length;o++)r+=a[o].length;return s=r-t-1,1-e.centralF.cdf(l,t,s)},ftest:function(t,i,n){return 1-e.centralF.cdf(t,i,n)}}),e.extend(e.fn,{anovafscore:function(){return e.anovafscore(this.toArray())},anovaftes:function(){var t,i=0;for(t=0;t<this.length;t++)i+=this[t].length;return e.ftest(this.anovafscore(),this.length-1,i-this.length)}}),e.extend({qscore:function(){var s,r,o,a,l,c=i.call(arguments);return n(c[0])?(s=c[0],r=c[1],o=c[2],a=c[3],l=c[4]):(s=e.mean(c[0]),r=e.mean(c[1]),o=c[0].length,a=c[1].length,l=c[2]),t.abs(s-r)/(l*t.sqrt((1/o+1/a)/2))},qtest:function(){var t,n=i.call(arguments);3===n.length?(t=n[0],n=n.slice(1)):7===n.length?(t=e.qscore(n[0],n[1],n[2],n[3],n[4]),n=n.slice(5)):(t=e.qscore(n[0],n[1],n[2]),n=n.slice(3));var s=n[0],r=n[1];return 1-e.tukey.cdf(t,r,s-r)},tukeyhsd:function(t){for(var i=e.pooledstdev(t),n=t.map((function(t){return e.mean(t)})),s=t.reduce((function(e,t){return e+t.length}),0),r=[],o=0;o<t.length;++o)for(var a=o+1;a<t.length;++a){var l=e.qtest(n[o],n[a],t[o].length,t[a].length,i,s,t.length);r.push([[o,a],l])}return r}}),e.extend({normalci:function(){var n,s=i.call(arguments),r=new Array(2);return n=4===s.length?t.abs(e.normal.inv(s[1]/2,0,1)*s[2]/t.sqrt(s[3])):t.abs(e.normal.inv(s[1]/2,0,1)*e.stdev(s[2])/t.sqrt(s[2].length)),r[0]=s[0]-n,r[1]=s[0]+n,r},tci:function(){var n,s=i.call(arguments),r=new Array(2);return n=4===s.length?t.abs(e.studentt.inv(s[1]/2,s[3]-1)*s[2]/t.sqrt(s[3])):t.abs(e.studentt.inv(s[1]/2,s[2].length-1)*e.stdev(s[2],!0)/t.sqrt(s[2].length)),r[0]=s[0]-n,r[1]=s[0]+n,r},significant:function(e,t){return e<t}}),e.extend(e.fn,{normalci:function(t,i){return e.normalci(t,i,this.toArray())},tci:function(t,i){return e.tci(t,i,this.toArray())}}),e.extend(e.fn,{oneSidedDifferenceOfProportions:function(t,i,n,s){var o=r(t,i,n,s);return e.ztest(o,1)},twoSidedDifferenceOfProportions:function(t,i,n,s){var o=r(t,i,n,s);return e.ztest(o,2)}})}(t,Math),t.models=function(){function e(e,i){var n=e.length,s=i[0].length-1,r=n-s-1,o=t.lstsq(i,e),a=t.multiply(i,o.map((function(e){return[e]}))).map((function(e){return e[0]})),l=t.subtract(e,a),c=t.mean(e),h=t.sum(a.map((function(e){return Math.pow(e-c,2)}))),d=t.sum(e.map((function(e,t){return Math.pow(e-a[t],2)}))),u=h+d;return{exog:i,endog:e,nobs:n,df_model:s,df_resid:r,coef:o,predict:a,resid:l,ybar:c,SST:u,SSE:h,SSR:d,R2:h/u}}return{ols:function(i,n){var s=e(i,n),r=function(i){var n,s,r=(n=i.exog,s=n[0].length,t.arange(s).map((function(i){var r=t.arange(s).filter((function(e){return e!==i}));return e(t.col(n,i).map((function(e){return e[0]})),t.col(n,r))}))),o=Math.sqrt(i.SSR/i.df_resid),a=r.map((function(e){var t=e.SST,i=e.R2;return o/Math.sqrt(t*(1-i))})),l=i.coef.map((function(e,t){return(e-0)/a[t]})),c=l.map((function(e){var n=t.studentt.cdf(e,i.df_resid);return 2*(n>.5?1-n:n)})),h=t.studentt.inv(.975,i.df_resid),d=i.coef.map((function(e,t){var i=h*a[t];return[e-i,e+i]}));return{se:a,t:l,p:c,sigmaHat:o,interval95:d}}(s),o=function(e){var i,n,s,r=e.R2/e.df_model/((1-e.R2)/e.df_resid);return{F_statistic:r,pvalue:1-(i=r,n=e.df_model,s=e.df_resid,t.beta.cdf(i/(s/n+i),n/2,s/2))}}(s),a=1-(1-s.R2)*((s.nobs-1)/s.df_resid);return s.t=r,s.f=o,s.adjust_R2=a,s}}}(),t.extend({buildxmatrix:function(){for(var e=new Array(arguments.length),i=0;i<arguments.length;i++)e[i]=[1].concat(arguments[i]);return t(e)},builddxmatrix:function(){for(var e=new Array(arguments[0].length),i=0;i<arguments[0].length;i++)e[i]=[1].concat(arguments[0][i]);return t(e)},buildjxmatrix:function(e){for(var i=new Array(e.length),n=0;n<e.length;n++)i[n]=e[n];return t.builddxmatrix(i)},buildymatrix:function(e){return t(e).transpose()},buildjymatrix:function(e){return e.transpose()},matrixmult:function(e,i){var n,s,r,o,a;if(e.cols()==i.rows()){if(i.rows()>1){for(o=[],n=0;n<e.rows();n++)for(o[n]=[],s=0;s<i.cols();s++){for(a=0,r=0;r<e.cols();r++)a+=e.toArray()[n][r]*i.toArray()[r][s];o[n][s]=a}return t(o)}for(o=[],n=0;n<e.rows();n++)for(o[n]=[],s=0;s<i.cols();s++){for(a=0,r=0;r<e.cols();r++)a+=e.toArray()[n][r]*i.toArray()[s];o[n][s]=a}return t(o)}},regress:function(e,i){var n=t.xtranspxinv(e),s=e.transpose(),r=t.matrixmult(t(n),s);return t.matrixmult(r,i)},regresst:function(e,i,n){var s=t.regress(e,i),r={anova:{}},o=t.jMatYBar(e,s);r.yBar=o;var a=i.mean();r.anova.residuals=t.residuals(i,o),r.anova.ssr=t.ssr(o,a),r.anova.msr=r.anova.ssr/(e[0].length-1),r.anova.sse=t.sse(i,o),r.anova.mse=r.anova.sse/(i.length-(e[0].length-1)-1),r.anova.sst=t.sst(i,a),r.anova.mst=r.anova.sst/(i.length-1),r.anova.r2=1-r.anova.sse/r.anova.sst,r.anova.r2<0&&(r.anova.r2=0),r.anova.fratio=r.anova.msr/r.anova.mse,r.anova.pvalue=t.anovaftest(r.anova.fratio,e[0].length-1,i.length-(e[0].length-1)-1),r.anova.rmse=Math.sqrt(r.anova.mse),r.anova.r2adj=1-r.anova.mse/r.anova.mst,r.anova.r2adj<0&&(r.anova.r2adj=0),r.stats=new Array(e[0].length);for(var l,c,h,d=t.xtranspxinv(e),u=0;u<s.length;u++)l=Math.sqrt(r.anova.mse*Math.abs(d[u][u])),c=Math.abs(s[u]/l),h=t.ttest(c,i.length-e[0].length-1,n),r.stats[u]=[s[u],l,c,h];return r.regress=s,r},xtranspx:function(e){return t.matrixmult(e.transpose(),e)},xtranspxinv:function(e){var i=t.matrixmult(e.transpose(),e);return t.inv(i)},jMatYBar:function(e,i){var n=t.matrixmult(e,i);return new t(n)},residuals:function(e,i){return t.matrixsubtract(e,i)},ssr:function(e,t){for(var i=0,n=0;n<e.length;n++)i+=Math.pow(e[n]-t,2);return i},sse:function(e,t){for(var i=0,n=0;n<e.length;n++)i+=Math.pow(e[n]-t[n],2);return i},sst:function(e,t){for(var i=0,n=0;n<e.length;n++)i+=Math.pow(e[n]-t,2);return i},matrixsubtract:function(e,i){for(var n=new Array(e.length),s=0;s<e.length;s++){n[s]=new Array(e[s].length);for(var r=0;r<e[s].length;r++)n[s][r]=e[s][r]-i[s][r]}return t(n)}}),t.jStat=t,t)},960:function(e,t,i){const n=i(592);e.exports=function(e){function t(e,t){const i=t.split(".");let n=e;for(const e of i){if(null==n)return;n=n[e]}return n}for(let i=0;i<Object.keys(n).length;i++){let s,r=Object.keys(n)[i],o=[];if("object"==typeof n[r]){o=Object.keys(n[r]),s=Object.values(n[r]);for(let e=0;e<s.length;e++)if("object"==typeof s[e]){let t=o[e];n[r][t]&&(o=[...o,...Object.keys(n[r][t]).map((e=>t+"."+e))],o.splice(o.indexOf(t),1))}}if(o.length<1)e[r]=n[r];else for(let i=0;i<o.length;i++)"function"==typeof t(n[r],o[i])&&(e[r]=t(n[r],o[i]))}let i=function(e){return"number"==typeof e&&(e=parseInt(e)),e},s=null,r=null,o=null;e.TABLE=function(){return o},e.COLUMN=e.COL=function(){return o.tracking&&o.tracking.push(c.getColumnNameFromCoords(i(s),i(r))),i(s)+1},e.ROW=function(){return o.tracking&&o.tracking.push(c.getColumnNameFromCoords(i(s),i(r))),i(r)+1},e.CELL=function(){return c.getColumnNameFromCoords(s,r)},e.VALUE=function(e,t,n){return o.getValueFromCoords(i(e)-1,i(t)-1,n)},e.THISROWCELL=function(e){return o.getValueFromCoords(i(e)-1,i(r))};const a=function(e,t){for(let i=0;i<e.length;i++){let n=c.getTokensFromRange(e[i]);t=t.replace(e[i],"["+n.join(",")+"]")}return t},l=function(e){return"string"==typeof e&&(e=e.trim()),!isNaN(e)&&null!==e&&""!==e},c=function(e,t,i,n,c){o=c,s=i,r=n;let h="",d={};if(t)if(t.size){let e,i=null;t.forEach((function(t,i){e=i.replace(/!/g,"."),-1!==e.indexOf(".")&&(e=e.split("."),d[e[0]]=!0)})),e=Object.keys(d);for(let t=0;t<e.length;t++)h+="var "+e[t]+" = {};";t.forEach((function(n,s){e=s.replace(/!/g,"."),null===n||l(n)||(i=n.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g),i&&i.length&&(n=updateRanges(i,n))),e.indexOf(".")>0?h+=e+" = "+t.get(s)+";\n":h+="var "+e+" = "+n+";\n"}))}else{let e=Object.keys(t);if(e.length){let i,n={};for(let t=0;t<e.length;t++)if(i=e[t].replace(/\!/g,"."),i.indexOf(".")>0){let e=e.split(".");n[e[0]]={}}i=Object.keys(n);for(let e=0;e<i.length;e++)h+="var "+i[e]+" = {};";for(let n=0;n<e.length;n++){if(i=e[n].replace(/!/g,"."),null!==t[e[n]]&&!l(t[e[n]])){let i=t[e[n]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);i&&i.length&&(t[e[n]]=a(i,t[e[n]]))}i.indexOf(".")>0?h+=i+" = "+t[e[n]]+";\n":h+="var "+i+" = "+t[e[n]]+";\n"}}}let u=(e=function(e){let t="",i=0,n=["=","!",">","<"];for(let s=0;s<e.length;s++)'"'===e[s]&&(i=0===i?1:0),1===i?t+=e[s]:(t+=e[s].toUpperCase(),s>0&&"="===e[s]&&-1===n.indexOf(e[s-1])&&-1===n.indexOf(e[s+1])&&(t+="="));return t=t.replace(/\^/g,"**"),t=t.replace(/<>/g,"!="),t=t.replace(/&/g,"+"),t=t.replace(/\$/g,""),t}(e=(e=e.replace(/\$/g,"")).replace(/!/g,"."))).match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);u&&u.length&&(e=a(u,e));let p=new Function(h+"; return "+e)();return null===p&&(p=0),p};return c.getColumnNameFromCoords=function(e,t){return n="",(i=parseInt(e))>701?(n+=String.fromCharCode(64+parseInt(i/676)),n+=String.fromCharCode(64+parseInt(i%676/26))):i>25&&(n+=String.fromCharCode(64+parseInt(i/26))),n+String.fromCharCode(65+i%26)+(parseInt(t)+1);var i,n},c.getCoordsFromColumnName=function(e){var t=/^[a-zA-Z]+/.exec(e);if(t){for(var i=0,n=0;n<t[0].length;n++)i+=parseInt(t[0].charCodeAt(n)-64)*Math.pow(26,t[0].length-1-n);--i<0&&(i=0);var s=parseInt(/[0-9]+$/.exec(e))||null;return s>0&&s--,[i,s]}},c.getRangeFromTokens=function(e){e=e.filter((function(e){return"#REF!"!=e}));for(var t="",i="",n=0;n<e.length;n++)e[n].indexOf(".")>=0?t=".":e[n].indexOf("!")>=0&&(t="!"),t&&(i=e[n].split(t),e[n]=i[1],i=i[0]+t);return e.sort((function(e,t){var i=Helpers.getCoordsFromColumnName(e),n=Helpers.getCoordsFromColumnName(t);return i[1]>n[1]?1:i[1]<n[1]?-1:i[0]>n[0]?1:i[0]<n[0]?-1:0})),e.length?i+(e[0]+":")+e[e.length-1]:"#REF!"},c.getTokensFromRange=function(e){if(e.indexOf(".")>0){var t=e.split(".");e=t[1],t=t[0]+"."}else e.indexOf("!")>0?(t=e.split("!"),e=t[1],t=t[0]+"!"):t="";e=e.split(":");var i=c.getCoordsFromColumnName(e[0]),n=c.getCoordsFromColumnName(e[1]);if(i[0]<=n[0])var s=i[0],r=n[0];else s=n[0],r=i[0];if(null===i[1]&&null==n[1])for(var o=null,a=null,l=Object.keys(vars),h=0;h<l.length;h++){var d=c.getCoordsFromColumnName(l[h]);d[0]===i[0]&&(null===o||d[1]<o)&&(o=d[1]),d[0]===n[0]&&(null===a||d[1]>a)&&(a=d[1])}else i[1]<=n[1]?(o=i[1],a=n[1]):(o=n[1],a=i[1]);for(var u=[],p=o;p<=a;p++){var f=[];for(h=s;h<=r;h++)f.push(t+c.getColumnNameFromCoords(h,p));u.push(f)}return u},c.setFormula=function(t){let i=Object.keys(t);for(let n=0;n<i.length;n++)"function"==typeof t[i[n]]&&(e[i[n]]=t[i[n]])},c.basic=!0,c}("undefined"==typeof window?i.g:window)},592:function(e,t,i){"use strict";var n=i(162),s=i(765);const r=new Error("#NULL!"),o=new Error("#DIV/0!"),a=new Error("#VALUE!"),l=new Error("#REF!"),c=new Error("#NAME?"),h=new Error("#NUM!"),d=new Error("#N/A"),u=new Error("#ERROR!"),p=new Error("#GETTING_DATA");var f=Object.freeze({__proto__:null,data:p,div0:o,error:u,na:d,name:c,nil:r,num:h,ref:l,value:a});function m(e){const t=[];return g(e,(e=>{t.push(e)})),t}function g(e,t){let i=-1;const n=e.length;for(;++i<n&&!1!==t(e[i],i,e););return e}function v(e){let t,i=e.length;for(;i--;)if(t=e[i],"number"!=typeof t)if(!0!==t)if(!1!==t){if("string"==typeof t){const n=j(t);e[i]=n instanceof Error?0:n}}else e[i]=0;else e[i]=1;return e}function _(e,t){if(!e)return a;e.every((e=>Array.isArray(e)))&&0!==e.length||(e=[[...e]]),e.map(((t,i)=>{t.map(((t,n)=>{t||(e[i][n]=0)}))}));const i=e.reduce(((t,i,n)=>i.length>e[t].length?n:t),0),n=e[i].length;return e.map((e=>[...e,...Array(n-e.length).fill(t||0)]))}function b(){let e;if(1===arguments.length){const i=arguments[0];e=null!=(t=i)&&"number"==typeof t.length&&"string"!=typeof t?m.apply(null,arguments):[i]}else e=Array.from(arguments);for(var t;!C(e);)e=y(e);return e}function y(e){return e&&e.reduce?e.reduce(((e,t)=>{const i=Array.isArray(e),n=Array.isArray(t);return i&&n?e.concat(t):i?(e.push(t),e):n?[e].concat(t):[e,t]})):[e]}function C(e){if(!e)return!1;for(let t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0}function w(e,t){return t=t||1,e&&"function"==typeof e.slice?e.slice(t):e}function S(e){return e?e[0].map(((t,i)=>e.map((e=>e[i])))):a}function E(e,t){let i=null;return g(e,((e,n)=>{if(e[0]===t)return i=n,!1})),null==i?a:i}function x(){for(let e=0;e<arguments.length;e++)if(arguments[e]instanceof Error)return arguments[e]}function T(){let e=arguments.length;for(;e--;)if(arguments[e]instanceof Error)return!0;return!1}function A(e){const t=1e14;return Math.round(e*t)/t}function O(){return b.apply(null,arguments).filter((e=>"number"==typeof e))}function I(e){if("boolean"==typeof e)return e;if(e instanceof Error)return e;if("number"==typeof e)return 0!==e;if("string"==typeof e){const t=e.toUpperCase();if("TRUE"===t)return!0;if("FALSE"===t)return!1}return e instanceof Date&&!isNaN(e)||a}function k(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);const t=parseFloat(e);return t<0||t>=2958466?h:function(e){e<60&&(e+=1);const t=Math.floor(e-25569),i=new Date(86400*t*1e3),n=e-Math.floor(e)+1e-7;let s=Math.floor(86400*n);const r=s%60;s-=r;const o=Math.floor(s/3600),a=Math.floor(s/60)%60;let l=i.getUTCDate(),c=i.getUTCMonth();return e>=60&&e<61&&(l=29,c=1),new Date(i.getUTCFullYear(),c,l,o,a,r)}(t)}return"string"!=typeof e||(e=/(\d{4})-(\d\d?)-(\d\d?)$/.test(e)?new Date(e+"T00:00:00.000"):new Date(e),isNaN(e))?a:e}function D(e){let t,i=e.length;for(;i--;){if(t=k(e[i]),t===a)return t;e[i]=t}return e}function j(e){return e instanceof Error?e:null==e?0:("boolean"==typeof e&&(e=+e),isNaN(e)||""===e?a:parseFloat(e))}function R(e){let t,i;if(!e||0===(t=e.length))return a;for(;t--;){if(e[t]instanceof Error)return e[t];if(i=j(e[t]),i instanceof Error)return i;e[t]=i}return e}function L(e){return e instanceof Error?e:null==e?"":e.toString()}function M(){let e=arguments.length;for(;e--;)if("string"==typeof arguments[e])return!0;return!1}function P(e){return null!=e}const N=[">",">=","<","<=","=","<>"],F="operator",H="literal",B=[F,H],z=F,V=H;function W(e,t){if(-1===B.indexOf(t))throw new Error("Unsupported token type: "+t);return{value:e,type:t}}function $(e){return function(e){let t="";const i=[];for(let n=0;n<e.length;n++){const s=e[n];0===n&&N.indexOf(s)>=0?i.push(W(s,z)):t+=s}return t.length>0&&i.push(W(function(e){return"string"!=typeof e||/^\d+(\.\d+)?$/.test(e)&&(e=-1===e.indexOf(".")?parseInt(e,10):parseFloat(e)),e}(t),V)),i.length>0&&i[0].type!==z&&i.unshift(W("=",z)),i}(function(e){const t=e.length,i=[];let n=0,s="",r="";for(;n<t;){const t=e.charAt(n);switch(t){case">":case"<":case"=":r+=t,s.length>0&&(i.push(s),s="");break;default:r.length>0&&(i.push(r),r=""),s+=t}n++}return s.length>0&&i.push(s),r.length>0&&i.push(r),i}(e))}const U=function(e){const t=[];let i;for(let n=0;n<e.length;n++){const s=e[n];switch(s.type){case z:i=s.value;break;case V:t.push(s.value)}}return function(e,t){let i=!1;switch(t){case">":i=e[0]>e[1];break;case">=":i=e[0]>=e[1];break;case"<":i=e[0]<e[1];break;case"<=":i=e[0]<=e[1];break;case"=":i=e[0]==e[1];break;case"<>":i=e[0]!=e[1]}return i}(t,i)},q={};function G(e){return[a,l,o,h,c,r].indexOf(e)>=0||"number"==typeof e&&(isNaN(e)||!isFinite(e))}function K(e){return G(e)||e===d}function Y(e){return!0===e||!1===e}function X(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)}function Z(e){return"string"==typeof e}function Q(){const e=[];for(let t=0;t<arguments.length;++t){let i=!1;const n=arguments[t];for(let t=0;t<e.length&&(i=e[t]===n,!i);++t);i||e.push(n)}return e}function J(e,t,i,n){if(!t||!i)return d;n=!(0===n||!1===n);let s=d;const r="number"==typeof e;let o=!1;for(let a=0;a<t.length;a++){const c=t[a];if(c[0]===e){s=i<c.length+1?c[i-1]:l;break}!o&&(r&&n&&c[0]<=e||n&&"string"==typeof c[0]&&c[0].localeCompare(e)<0)&&(s=i<c.length+1?c[i-1]:l),r&&c[0]>e&&(o=!0)}return s}function ee(){const e=b(arguments).filter(P);if(0===e.length)return o;const t=x.apply(void 0,e);if(t)return t;const i=O(e),n=i.length;let s,r=0,a=0;for(let e=0;e<n;e++)r+=i[e],a+=1;return s=r/a,isNaN(s)&&(s=h),s}function te(){const e=b(arguments).filter(P);if(0===e.length)return o;const t=x.apply(void 0,e);if(t)return t;const i=e,n=i.length;let s,r=0,a=0;for(let e=0;e<n;e++){const t=i[e];"number"==typeof t&&(r+=t),!0===t&&r++,null!==t&&a++}return s=r/a,isNaN(s)&&(s=h),s}q.TYPE=e=>{switch(e){case r:return 1;case o:return 2;case a:return 3;case l:return 4;case c:return 5;case h:return 6;case d:return 7;case p:return 8}return d};const ie={DIST:function(e,t,i,s,r,o){return arguments.length<4?a:(r=void 0===r?0:r,o=void 0===o?1:o,T(e=j(e),t=j(t),i=j(i),r=j(r),o=j(o))?a:(e=(e-r)/(o-r),s?n.beta.cdf(e,t,i):n.beta.pdf(e,t,i)))},INV:(e,t,i,s,r)=>(s=void 0===s?0:s,r=void 0===r?1:r,T(e=j(e),t=j(t),i=j(i),s=j(s),r=j(r))?a:n.beta.inv(e,t,i)*(r-s)+s)},ne={DIST:(e,t,i,s)=>T(e=j(e),t=j(t),i=j(i),s=j(s))?a:s?n.binomial.cdf(e,t,i):n.binomial.pdf(e,t,i)};ne.DIST.RANGE=(e,t,i,n)=>{if(n=void 0===n?i:n,T(e=j(e),t=j(t),i=j(i),n=j(n)))return a;let s=0;for(let r=i;r<=n;r++)s+=ze(e,r)*Math.pow(t,r)*Math.pow(1-t,e-r);return s},ne.INV=(e,t,i)=>{if(T(e=j(e),t=j(t),i=j(i)))return a;let s=0;for(;s<=e;){if(n.binomial.cdf(s,e,t)>=i)return s;s++}};const se={DIST:(e,t,i)=>T(e=j(e),t=j(t))?a:i?n.chisquare.cdf(e,t):n.chisquare.pdf(e,t)};se.DIST.RT=(e,t)=>!e|!t?d:e<1||t>Math.pow(10,10)?h:"number"!=typeof e||"number"!=typeof t?a:1-n.chisquare.cdf(e,t),se.INV=(e,t)=>T(e=j(e),t=j(t))?a:n.chisquare.inv(e,t),se.INV.RT=(e,t)=>!e|!t?d:e<0||e>1||t<1||t>Math.pow(10,10)?h:"number"!=typeof e||"number"!=typeof t?a:n.chisquare.inv(1-e,t),se.TEST=function(e,t){if(2!==arguments.length)return d;if(!(e instanceof Array&&t instanceof Array))return a;if(e.length!==t.length)return a;if(e[0]&&t[0]&&e[0].length!==t[0].length)return a;const i=e.length;let n,s,r;for(s=0;s<i;s++)e[s]instanceof Array||(n=e[s],e[s]=[],e[s].push(n)),t[s]instanceof Array||(n=t[s],t[s]=[],t[s].push(n));const o=e[0].length,l=1===o?i-1:(i-1)*(o-1);let c=0;const h=Math.PI;for(s=0;s<i;s++)for(r=0;r<o;r++)c+=Math.pow(e[s][r]-t[s][r],2)/t[s][r];return Math.round(1e6*function(e,t){let i=Math.exp(-.5*e);t%2==1&&(i*=Math.sqrt(2*e/h));let n=t;for(;n>=2;)i=i*e/n,n-=2;let s=i,r=t;for(;s>1e-10*i;)r+=2,s=s*e/r,i+=s;return 1-i}(c,l))/1e6};const re={};function oe(){return O(b(arguments)).length}function ae(){const e=b(arguments);return e.length-le(e)}function le(){const e=b(arguments);let t,i=0;for(let n=0;n<e.length;n++)t=e[n],null!=t&&""!==t||i++;return i}re.NORM=(e,t,i)=>T(e=j(e),t=j(t),i=j(i))?a:n.normalci(1,e,t,i)[1]-1,re.T=(e,t,i)=>T(e=j(e),t=j(t),i=j(i))?a:n.tci(1,e,t,i)[1]-1;const ce={P:(e,t)=>{if(T(e=R(b(e)),t=R(b(t))))return a;const i=n.mean(e),s=n.mean(t);let r=0;const o=e.length;for(let n=0;n<o;n++)r+=(e[n]-i)*(t[n]-s);return r/o},S:(e,t)=>T(e=R(b(e)),t=R(b(t)))?a:n.covariance(e,t)},he={DIST:(e,t,i)=>T(e=j(e),t=j(t))?a:i?n.exponential.cdf(e,t):n.exponential.pdf(e,t)},de={};function ue(e,t,i){if(T(e=j(e),t=R(b(t)),i=R(b(i))))return a;const s=n.mean(i),r=n.mean(t),o=i.length;let l=0,c=0;for(let e=0;e<o;e++)l+=(i[e]-s)*(t[e]-r),c+=Math.pow(i[e]-s,2);const h=l/c;return r-h*s+h*e}function pe(e){return(e=j(e))instanceof Error?e:0===e||parseInt(e,10)===e&&e<0?h:n.gammafn(e)}function fe(e){return(e=j(e))instanceof Error?e:n.gammaln(e)}de.DIST=(e,t,i,s)=>T(e=j(e),t=j(t),i=j(i))?a:s?n.centralF.cdf(e,t,i):n.centralF.pdf(e,t,i),de.DIST.RT=function(e,t,i){return 3!==arguments.length?d:e<0||t<1||i<1?h:"number"!=typeof e||"number"!=typeof t||"number"!=typeof i?a:1-n.centralF.cdf(e,t,i)},de.INV=(e,t,i)=>T(e=j(e),t=j(t),i=j(i))?a:e<=0||e>1?h:n.centralF.inv(e,t,i),de.INV.RT=function(e,t,i){return 3!==arguments.length?d:e<0||e>1||t<1||t>Math.pow(10,10)||i<1||i>Math.pow(10,10)?h:"number"!=typeof e||"number"!=typeof t||"number"!=typeof i?a:n.centralF.inv(1-e,t,i)},de.TEST=(e,t)=>{if(!e||!t)return d;if(!(e instanceof Array&&t instanceof Array))return d;if(e.length<2||t.length<2)return o;const i=(e,t)=>{let i=0;for(let n=0;n<e.length;n++)i+=Math.pow(e[n]-t,2);return i},n=Ye(e)/e.length,s=Ye(t)/t.length;return i(e,n)/(e.length-1)/(i(t,s)/(t.length-1))},pe.DIST=function(e,t,i,s){return 4!==arguments.length?d:e<0||t<=0||i<=0||"number"!=typeof e||"number"!=typeof t||"number"!=typeof i?a:s?n.gamma.cdf(e,t,i,!0):n.gamma.pdf(e,t,i,!1)},pe.INV=function(e,t,i){return 3!==arguments.length?d:e<0||e>1||t<=0||i<=0?h:"number"!=typeof e||"number"!=typeof t||"number"!=typeof i?a:n.gamma.inv(e,t,i)},fe.PRECISE=function(e){return 1!==arguments.length?d:e<=0?h:"number"!=typeof e?a:n.gammaln(e)};const me={};function ge(e,t){return T(e=R(b(e)),t=j(t))?e:t<0||e.length<t?a:e.sort(((e,t)=>t-e))[t-1]}function ve(e,t){if(T(e=R(b(e)),t=R(b(t))))return a;const i=n.mean(e),s=n.mean(t),r=t.length;let o=0,l=0;for(let n=0;n<r;n++)o+=(t[n]-s)*(e[n]-i),l+=Math.pow(t[n]-s,2);const c=o/l;return[c,i-c*s]}me.DIST=(e,t,i,n,s)=>{if(T(e=j(e),t=j(t),i=j(i),n=j(n)))return a;function r(e,t,i,n){return ze(i,e)*ze(n-i,t-e)/ze(n,t)}return s?function(e,t,i,n){let s=0;for(let o=0;o<=e;o++)s+=r(o,t,i,n);return s}(e,t,i,n):r(e,t,i,n)};const _e={};function be(){const e=b(arguments),t=x.apply(void 0,e);if(t)return t;const i=O(e);return 0===i.length?0:Math.max.apply(Math,i)}function ye(){const e=b(arguments),t=x.apply(void 0,e);if(t)return t;const i=v(e);let s=n.median(i);return isNaN(s)&&(s=h),s}function Ce(){const e=b(arguments),t=x.apply(void 0,e);if(t)return t;const i=O(e);return 0===i.length?0:Math.min.apply(Math,i)}_e.DIST=(e,t,i,s)=>T(e=j(e),t=j(t),i=j(i))?a:s?n.lognormal.cdf(e,t,i):n.lognormal.pdf(e,t,i),_e.INV=(e,t,i)=>T(e=j(e),t=j(t),i=j(i))?a:n.lognormal.inv(e,t,i);const we={MULT:function(){const e=R(b(arguments));if(e instanceof Error)return e;const t=e.length,i={};let n,s=[],r=0;for(let o=0;o<t;o++)n=e[o],i[n]=i[n]?i[n]+1:1,i[n]>r&&(r=i[n],s=[]),i[n]===r&&(s[s.length]=n);return s},SNGL:function(){const e=R(b(arguments));return e instanceof Error?e:we.MULT(e).sort(((e,t)=>e-t))[0]}},Se={DIST:(e,t,i,s)=>T(e=j(e),t=j(t),i=j(i))?a:s?n.negbin.cdf(e,t,i):n.negbin.pdf(e,t,i)},Ee={};function xe(e,t){if(T(t=R(b(t)),e=R(b(e))))return a;const i=n.mean(e),s=n.mean(t),r=e.length;let o=0,l=0,c=0;for(let n=0;n<r;n++)o+=(e[n]-i)*(t[n]-s),l+=Math.pow(e[n]-i,2),c+=Math.pow(t[n]-s,2);return o/Math.sqrt(l*c)}Ee.DIST=(e,t,i,s)=>T(e=j(e),t=j(t),i=j(i))?a:i<=0?h:s?n.normal.cdf(e,t,i):n.normal.pdf(e,t,i),Ee.INV=(e,t,i)=>T(e=j(e),t=j(t),i=j(i))?a:n.normal.inv(e,t,i),Ee.S={},Ee.S.DIST=(e,t)=>(e=j(e))instanceof Error?a:t?n.normal.cdf(e,0,1):n.normal.pdf(e,0,1),Ee.S.INV=e=>(e=j(e))instanceof Error?a:n.normal.inv(e,0,1);const Te={EXC:(e,t)=>{if(T(e=R(b(e)),t=j(t)))return a;const i=(e=e.sort(((e,t)=>e-t))).length;if(t<1/(i+1)||t>1-1/(i+1))return h;const n=t*(i+1)-1,s=Math.floor(n);return A(n===s?e[n]:e[s]+(n-s)*(e[s+1]-e[s]))},INC:(e,t)=>{if(T(e=R(b(e)),t=j(t)))return a;const i=t*((e=e.sort(((e,t)=>e-t))).length-1),n=Math.floor(i);return A(i===n?e[i]:e[n]+(i-n)*(e[n+1]-e[n]))}},Ae={EXC:(e,t,i)=>{if(i=void 0===i?3:i,T(e=R(b(e)),t=j(t),i=j(i)))return a;e=e.sort(((e,t)=>e-t));const n=Q.apply(null,e),s=e.length,r=n.length,o=Math.pow(10,i);let l=0,c=!1,h=0;for(;!c&&h<r;)t===n[h]?(l=(e.indexOf(n[h])+1)/(s+1),c=!0):t>=n[h]&&(t<n[h+1]||h===r-1)&&(l=(e.indexOf(n[h])+1+(t-n[h])/(n[h+1]-n[h]))/(s+1),c=!0),h++;return Math.floor(l*o)/o},INC:(e,t,i)=>{if(i=void 0===i?3:i,T(e=R(b(e)),t=j(t),i=j(i)))return a;e=e.sort(((e,t)=>e-t));const n=Q.apply(null,e),s=e.length,r=n.length,o=Math.pow(10,i);let l=0,c=!1,h=0;for(;!c&&h<r;)t===n[h]?(l=e.indexOf(n[h])/(s-1),c=!0):t>=n[h]&&(t<n[h+1]||h===r-1)&&(l=(e.indexOf(n[h])+(t-n[h])/(n[h+1]-n[h]))/(s-1),c=!0),h++;return Math.floor(l*o)/o}},Oe={DIST:(e,t,i)=>T(e=j(e),t=j(t))?a:i?n.poisson.cdf(e,t):n.poisson.pdf(e,t)},Ie={EXC:(e,t)=>{if(T(e=R(b(e)),t=j(t)))return a;switch(t){case 1:return Te.EXC(e,.25);case 2:return Te.EXC(e,.5);case 3:return Te.EXC(e,.75);default:return h}},INC:(e,t)=>{if(T(e=R(b(e)),t=j(t)))return a;switch(t){case 1:return Te.INC(e,.25);case 2:return Te.INC(e,.5);case 3:return Te.INC(e,.75);default:return h}}},ke={};function De(){const e=R(b(arguments));if(e instanceof Error)return e;const t=n.mean(e),i=e.length;let s=0;for(let n=0;n<i;n++)s+=Math.pow(e[n]-t,3);return i*s/((i-1)*(i-2)*Math.pow(n.stdev(e,!0),3))}function je(e,t){return T(e=R(b(e)),t=j(t))?e:e.sort(((e,t)=>e-t))[t-1]}ke.AVG=(e,t,i)=>{if(T(e=j(e),t=R(b(t))))return a;const n=(i=i||!1)?(e,t)=>e-t:(e,t)=>t-e,s=(t=(t=b(t)).sort(n)).length;let r=0;for(let i=0;i<s;i++)t[i]===e&&r++;return r>1?(2*t.indexOf(e)+r+1)/2:t.indexOf(e)+1},ke.EQ=(e,t,i)=>{if(T(e=j(e),t=R(b(t))))return a;const n=(i=i||!1)?(e,t)=>e-t:(e,t)=>t-e;return(t=t.sort(n)).indexOf(e)+1},De.P=function(){const e=R(b(arguments));if(e instanceof Error)return e;const t=n.mean(e),i=e.length;let s=0,r=0;for(let n=0;n<i;n++)r+=Math.pow(e[n]-t,3),s+=Math.pow(e[n]-t,2);return r/=i,s/=i,r/Math.pow(s,1.5)};const Re={P:function(){const e=Me.P.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=h),t},S:function(){const e=Me.S.apply(this,arguments);return Math.sqrt(e)}},Le={DIST:(e,t,i)=>1!==i&&2!==i?h:1===i?Le.DIST.RT(e,t):Le.DIST["2T"](e,t)};Le.DIST["2T"]=function(e,t){return 2!==arguments.length?d:e<0||t<1?h:"number"!=typeof e||"number"!=typeof t?a:2*(1-n.studentt.cdf(e,t))},Le.DIST.RT=function(e,t){return 2!==arguments.length?d:e<0||t<1?h:"number"!=typeof e||"number"!=typeof t?a:1-n.studentt.cdf(e,t)},Le.INV=(e,t)=>T(e=j(e),t=j(t))?a:n.studentt.inv(e,t),Le.INV["2T"]=(e,t)=>(e=j(e),t=j(t),e<=0||e>1||t<1?h:T(e,t)?a:Math.abs(n.studentt.inv(e/2,t))),Le.TEST=(e,t)=>{if(T(e=R(b(e)),t=R(b(t))))return a;const i=n.mean(e),s=n.mean(t);let r,o=0,l=0;for(r=0;r<e.length;r++)o+=Math.pow(e[r]-i,2);for(r=0;r<t.length;r++)l+=Math.pow(t[r]-s,2);o/=e.length-1,l/=t.length-1;const c=Math.abs(i-s)/Math.sqrt(o/e.length+l/t.length);return Le.DIST["2T"](c,e.length+t.length-2)};const Me={};function Pe(){const e=b(arguments),t=e.length;let i=0,n=0;const s=te(e);for(let r=0;r<t;r++){const t=e[r];i+="number"==typeof t?Math.pow(t-s,2):!0===t?Math.pow(1-s,2):Math.pow(0-s,2),null!==t&&n++}return i/(n-1)}function Ne(){const e=b(arguments),t=e.length;let i=0,n=0;const s=te(e);let r;for(let r=0;r<t;r++){const t=e[r];i+="number"==typeof t?Math.pow(t-s,2):!0===t?Math.pow(1-s,2):Math.pow(0-s,2),null!==t&&n++}return r=i/n,isNaN(r)&&(r=h),r}Me.P=function(){const e=O(b(arguments)),t=e.length;let i=0;const n=ee(e);let s;for(let s=0;s<t;s++)i+=Math.pow(e[s]-n,2);return s=i/t,isNaN(s)&&(s=h),s},Me.S=function(){const e=O(b(arguments)),t=e.length;let i=0;const n=ee(e);for(let s=0;s<t;s++)i+=Math.pow(e[s]-n,2);return i/(t-1)};const Fe={DIST:(e,t,i,n)=>T(e=j(e),t=j(t),i=j(i))?a:n?1-Math.exp(-Math.pow(e/i,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/i,t))*t/Math.pow(i,t)},He={};function Be(e,t,i){const n=x(e=j(e),t=j(t),i=j(i));if(n)return n;if(0===t)return 0;t=Math.abs(t);const s=-Math.floor(Math.log(t)/Math.log(10));return e>=0?Ke(Math.ceil(e/t)*t,s):0===i?-Ke(Math.floor(Math.abs(e)/t)*t,s):-Ke(Math.ceil(Math.abs(e)/t)*t,s)}function ze(e,t){return x(e=j(e),t=j(t))||(e<t?h:We(e)/(We(t)*We(e-t)))}He.TEST=(e,t,i)=>{if(T(e=R(b(e)),t=j(t)))return a;i=i||Re.S(e);const n=e.length;return 1-Ee.S.DIST((ee(e)-t)/(i/Math.sqrt(n)),!0)},Be.MATH=Be,Be.PRECISE=Be;const Ve=[];function We(e){if((e=j(e))instanceof Error)return e;const t=Math.floor(e);return 0===t||1===t?1:(Ve[t]>0||(Ve[t]=We(t-1)*t),Ve[t])}function $e(e,t){const i=x(e=j(e),t=j(t));if(i)return i;if(0===t)return 0;if(!(e>=0&&t>0||e<=0&&t<0))return h;t=Math.abs(t);const n=-Math.floor(Math.log(t)/Math.log(10));return e>=0?Ke(Math.floor(e/t)*t,n):-Ke(Math.ceil(Math.abs(e)/t),n)}$e.MATH=(e,t,i)=>{if(t instanceof Error)return t;t=void 0===t?0:t;const n=x(e=j(e),t=j(t),i=j(i));if(n)return n;if(0===t)return 0;t=t?Math.abs(t):1;const s=-Math.floor(Math.log(t)/Math.log(10));return e>=0?Ke(Math.floor(e/t)*t,s):0===i||void 0===i?-Ke(Math.ceil(Math.abs(e)/t)*t,s):-Ke(Math.floor(Math.abs(e)/t)*t,s)},$e.PRECISE=$e.MATH;const Ue={CEILING:Be};function qe(e,t){const i=x(e=j(e),t=j(t));if(i)return i;if(0===e&&0===t)return h;const n=Math.pow(e,t);return isNaN(n)?h:n}function Ge(){const e=b(arguments).filter((e=>null!=e));if(0===e.length)return 0;const t=R(e);if(t instanceof Error)return t;let i=1;for(let e=0;e<t.length;e++)i*=t[e];return i}function Ke(e,t){return x(e=j(e),t=j(t))||Number(Math.round(Number(e+"e"+t))+"e"+-1*t)}function Ye(){let e=0;return g(m(arguments),(t=>{if(e instanceof Error)return!1;if(t instanceof Error)e=t;else if("number"==typeof t)e+=t;else if("string"==typeof t){const i=parseFloat(t);!isNaN(i)&&(e+=i)}else if(Array.isArray(t)){const i=Ye.apply(null,t);i instanceof Error?e=i:e+=i}})),e}var Xe=Object.freeze({__proto__:null,ADD:function(e,t){return 2!==arguments.length?d:x(e=j(e),t=j(t))||e+t},DIVIDE:function(e,t){return 2!==arguments.length?d:x(e=j(e),t=j(t))||(0===t?o:e/t)},EQ:function(e,t){return 2!==arguments.length?d:e instanceof Error?e:t instanceof Error?t:(null===e&&(e=void 0),null===t&&(t=void 0),e===t)},GT:function(e,t){return 2!==arguments.length?d:e instanceof Error?e:t instanceof Error?t:(M(e,t)?(e=L(e),t=L(t)):(e=j(e),t=j(t)),x(e,t)||e>t)},GTE:function(e,t){return 2!==arguments.length?d:(M(e,t)?(e=L(e),t=L(t)):(e=j(e),t=j(t)),x(e,t)||e>=t)},LT:function(e,t){return 2!==arguments.length?d:(M(e,t)?(e=L(e),t=L(t)):(e=j(e),t=j(t)),x(e,t)||e<t)},LTE:function(e,t){return 2!==arguments.length?d:(M(e,t)?(e=L(e),t=L(t)):(e=j(e),t=j(t)),x(e,t)||e<=t)},MINUS:function(e,t){return 2!==arguments.length?d:x(e=j(e),t=j(t))||e-t},MULTIPLY:function(e,t){return 2!==arguments.length?d:x(e=j(e),t=j(t))||e*t},NE:function(e,t){return 2!==arguments.length?d:e instanceof Error?e:t instanceof Error?t:(null===e&&(e=void 0),null===t&&(t=void 0),e!==t)},POW:function(e,t){return 2!==arguments.length?d:qe(e,t)}});const Ze=new Date(Date.UTC(1900,0,1)),Qe=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],Je=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],et=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function tt(e,t,i){i=i.toUpperCase(),e=k(e),t=k(t);const n=e.getFullYear(),s=e.getMonth(),r=e.getDate(),o=t.getFullYear(),a=t.getMonth(),l=t.getDate();let c;switch(i){case"Y":c=Math.floor(ht(e,t));break;case"D":c=nt(t,e);break;case"M":c=a-s+12*(o-n),l<r&&c--;break;case"MD":r<=l?c=l-r:(0===a?(e.setFullYear(o-1),e.setMonth(12)):(e.setFullYear(o),e.setMonth(a-1)),c=nt(t,e));break;case"YM":c=a-s+12*(o-n),l<r&&c--,c%=12;break;case"YD":a>s||a===s&&l<r?e.setFullYear(o):e.setFullYear(o-1),c=nt(t,e)}return c}function it(e){const t=new Date(e);return t.setHours(0,0,0,0),t}function nt(e,t){return e=k(e),t=k(t),e instanceof Error?e:t instanceof Error?t:dt(it(e))-dt(it(t))}function st(e,t,i){if(i=I(i||"false"),e=k(e),t=k(t),e instanceof Error)return e;if(t instanceof Error)return t;if(i instanceof Error)return i;const n=e.getMonth();let s,r,o=t.getMonth();if(i)s=31===e.getDate()?30:e.getDate(),r=31===t.getDate()?30:t.getDate();else{const i=new Date(e.getFullYear(),n+1,0).getDate(),a=new Date(t.getFullYear(),o+1,0).getDate();s=e.getDate()===i?30:e.getDate(),t.getDate()===a?s<30?(o++,r=1):r=30:r=t.getDate()}return 360*(t.getFullYear()-e.getFullYear())+30*(o-n)+(r-s)}function rt(e){if((e=k(e))instanceof Error)return e;(e=it(e)).setDate(e.getDate()+4-(e.getDay()||7));const t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)}function ot(e,t,i){return ot.INTL(e,t,1,i)}function at(e,t,i){return at.INTL(e,t,1,i)}function lt(e){return 1===new Date(e,1,29).getMonth()}function ct(e,t){return Math.ceil((t-e)/1e3/60/60/24)}function ht(e,t,i){if((e=k(e))instanceof Error)return e;if((t=k(t))instanceof Error)return t;i=i||0;let n=e.getDate();const s=e.getMonth()+1,r=e.getFullYear();let o=t.getDate();const a=t.getMonth()+1,l=t.getFullYear();switch(i){case 0:return 31===n&&31===o?(n=30,o=30):31===n?n=30:30===n&&31===o&&(o=30),(o+30*a+360*l-(n+30*s+360*r))/360;case 1:{const i=(e,t)=>{const i=e.getFullYear(),n=new Date(i,2,1);if(lt(i)&&e<n&&t>=n)return!0;const s=t.getFullYear(),r=new Date(s,2,1);return lt(s)&&t>=r&&e<r};let c=365;if(r===l||r+1===l&&(s>a||s===a&&n>=o))return(r===l&&lt(r)||i(e,t)||1===a&&29===o)&&(c=366),ct(e,t)/c;const h=l-r+1,d=(new Date(l+1,0,1)-new Date(r,0,1))/1e3/60/60/24/h;return ct(e,t)/d}case 2:return ct(e,t)/360;case 3:return ct(e,t)/365;case 4:return(o+30*a+360*l-(n+30*s+360*r))/360}}function dt(e){const t=e>-22038912e5?2:1;return Math.ceil((e-Ze)/864e5)+t}function ut(e){return 0===(e=j(e))?a:e instanceof Error?e:String.fromCharCode(e)}function pt(e){if(T(e))return e;let t=(e=e||"").charCodeAt(0);return isNaN(t)&&(t=a),t}function ft(){const e=b(arguments),t=x.apply(void 0,e);if(t)return t;let i=0;for(;(i=e.indexOf(!0))>-1;)e[i]="TRUE";let n=0;for(;(n=e.indexOf(!1))>-1;)e[n]="FALSE";return e.join("")}ot.INTL=(e,t,i,n)=>{if((e=k(e))instanceof Error)return e;if((t=k(t))instanceof Error)return t;let s=!1;const r=[],o=[1,2,3,4,5,6,0],l=new RegExp("^[0|1]{7}$");if(void 0===i)i=et[1];else if("string"==typeof i&&l.test(i)){s=!0,i=i.split("");for(let e=0;e<i.length;e++)"1"===i[e]&&r.push(o[e])}else i=et[i];if(!(i instanceof Array))return a;void 0===n?n=[]:n instanceof Array||(n=[n]);for(let e=0;e<n.length;e++){const t=k(n[e]);if(t instanceof Error)return t;n[e]=t}const c=Math.round((t-e)/864e5)+1;let h=c;const d=e;for(let e=0;e<c;e++){const e=(new Date).getTimezoneOffset()>0?d.getUTCDay():d.getDay();let t=s?r.includes(e):e===i[0]||e===i[1];for(let e=0;e<n.length;e++){const i=n[e];if(i.getDate()===d.getDate()&&i.getMonth()===d.getMonth()&&i.getFullYear()===d.getFullYear()){t=!0;break}}t&&h--,d.setDate(d.getDate()+1)}return h},at.INTL=(e,t,i,n)=>{if((e=k(e))instanceof Error)return e;if((t=j(t))instanceof Error)return t;if(t<0)return h;if(!((i=void 0===i?et[1]:et[i])instanceof Array))return a;void 0===n?n=[]:n instanceof Array||(n=[n]);for(let e=0;e<n.length;e++){const t=k(n[e]);if(t instanceof Error)return t;n[e]=t}let s=0;for(;s<t;){e.setDate(e.getDate()+1);const t=e.getDay();if(t!==i[0]&&t!==i[1]){for(let t=0;t<n.length;t++){const i=n[t];if(i.getDate()===e.getDate()&&i.getMonth()===e.getMonth()&&i.getFullYear()===e.getFullYear()){s--;break}}s++}}return e};const mt=ft;function gt(e,t=2,i=!1){if(e=j(e),isNaN(e))return a;if(t=j(t),isNaN(t))return a;if(t<0){const i=Math.pow(10,-t);e=Math.round(e/i)*i}else e=e.toFixed(t);if(i)e=e.toString().replace(/,/g,"");else{const t=e.toString().split(".");t[0]=t[0].replace(/\B(?=(\d{3})+$)/g,","),e=t.join(".")}return e}function vt(e,t){return x(e,t)||(e=L(e),(t=j(t))instanceof Error?t:new Array(t+1).join(e))}const _t=ut,bt=pt;function yt(e){return/^[01]{1,10}$/.test(e)}function Ct(e,t,i){if(T(e=j(e),t=j(t)))return e;if("i"!==(i=void 0===i?"i":i)&&"j"!==i)return a;if(0===e&&0===t)return 0;if(0===e)return 1===t?i:t.toString()+i;if(0===t)return e.toString();{const n=t>0?"+":"";return e.toString()+n+(1===t?i:t.toString()+i)}}function wt(e,t){return t=void 0===t?0:t,T(e=j(e),t=j(t))?a:n.erf(e)}function St(e){return isNaN(e)?a:n.erfc(e)}function Et(e){const t=kt(e),i=xt(e);return T(t,i)?a:Math.sqrt(Math.pow(t,2)+Math.pow(i,2))}function xt(e){if(void 0===e||!0===e||!1===e)return a;if(0===e||"0"===e)return 0;if(["i","j"].indexOf(e)>=0)return 1;let t=(e=(e+="").replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),i=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===i&&(i=e.indexOf("-",1));const n=e.substring(e.length-1,e.length),s="i"===n||"j"===n;return t>=0||i>=0?s?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?h:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,i))||isNaN(e.substring(i+1,e.length-1))?h:-Number(e.substring(i+1,e.length-1)):h:s?isNaN(e.substring(0,e.length-1))?h:e.substring(0,e.length-1):isNaN(e)?h:0}function Tt(e){const t=kt(e),i=xt(e);return T(t,i)?a:0===t&&0===i?o:0===t&&i>0?Math.PI/2:0===t&&i<0?-Math.PI/2:0===i&&t>0?0:0===i&&t<0?-Math.PI:t>0?Math.atan(i/t):t<0&&i>=0?Math.atan(i/t)+Math.PI:Math.atan(i/t)-Math.PI}function At(e){const t=kt(e),i=xt(e);if(T(t,i))return a;let n=e.substring(e.length-1);return n="i"===n||"j"===n?n:"i",Ct(Math.cos(t)*(Math.exp(i)+Math.exp(-i))/2,-Math.sin(t)*(Math.exp(i)-Math.exp(-i))/2,n)}function Ot(e){const t=kt(e),i=xt(e);if(T(t,i))return a;let n=e.substring(e.length-1);return n="i"===n||"j"===n?n:"i",Ct(Math.cos(i)*(Math.exp(t)+Math.exp(-t))/2,Math.sin(i)*(Math.exp(t)-Math.exp(-t))/2,n)}function It(e,t){const i=kt(e),n=xt(e),s=kt(t),r=xt(t);if(T(i,n,s,r))return a;const o=e.substring(e.length-1),l=t.substring(t.length-1);let c="i";if(("j"===o||"j"===l)&&(c="j"),0===s&&0===r)return h;const d=s*s+r*r;return Ct((i*s+n*r)/d,(n*s-i*r)/d,c)}function kt(e){if(void 0===e||!0===e||!1===e)return a;if(0===e||"0"===e)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;let t=(e+="").indexOf("+"),i=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===i&&(i=e.indexOf("-",1));const n=e.substring(e.length-1,e.length),s="i"===n||"j"===n;return t>=0||i>=0?s?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?h:Number(e.substring(0,t)):isNaN(e.substring(0,i))||isNaN(e.substring(i+1,e.length-1))?h:Number(e.substring(0,i)):h:s?isNaN(e.substring(0,e.length-1))?h:0:isNaN(e)?h:e}function Dt(e){const t=kt(e),i=xt(e);if(T(t,i))return a;let n=e.substring(e.length-1);return n="i"===n||"j"===n?n:"i",Ct(Math.sin(t)*(Math.exp(i)+Math.exp(-i))/2,Math.cos(t)*(Math.exp(i)-Math.exp(-i))/2,n)}function jt(e){const t=kt(e),i=xt(e);if(T(t,i))return a;let n=e.substring(e.length-1);return n="i"===n||"j"===n?n:"i",Ct(Math.cos(i)*(Math.exp(t)-Math.exp(-t))/2,Math.sin(i)*(Math.exp(t)+Math.exp(-t))/2,n)}wt.PRECISE=()=>{throw new Error("ERF.PRECISE is not implemented")},St.PRECISE=()=>{throw new Error("ERFC.PRECISE is not implemented")};const Rt=ie.DIST,Lt=ie.INV,Mt=ne.DIST,Pt=Be.MATH,Nt=Be.PRECISE,Ft=se.DIST,Ht=se.DIST.RT,Bt=se.INV,zt=se.INV.RT,Vt=se.TEST,Wt=ce.P,$t=ce.P,Ut=ce.S,qt=ne.INV,Gt=St.PRECISE,Kt=wt.PRECISE,Yt=he.DIST,Xt=de.DIST,Zt=de.DIST.RT,Qt=de.INV,Jt=de.INV.RT,ei=$e.MATH,ti=$e.PRECISE,ii=de.TEST,ni=pe.DIST,si=pe.INV,ri=fe.PRECISE,oi=me.DIST,ai=_e.INV,li=_e.DIST,ci=_e.INV,hi=we.MULT,di=we.SNGL,ui=Se.DIST,pi=ot.INTL,fi=Ee.DIST,mi=Ee.INV,gi=Ee.S.DIST,vi=Ee.S.INV,_i=Te.EXC,bi=Te.INC,yi=Ae.EXC,Ci=Ae.INC,wi=Oe.DIST,Si=Ie.EXC,Ei=Ie.INC,xi=ke.AVG,Ti=ke.EQ,Ai=De.P,Oi=Re.P,Ii=Re.S,ki=Le.DIST,Di=Le.DIST.RT,ji=Le.INV,Ri=Le.TEST,Li=Me.P,Mi=Me.S,Pi=Fe.DIST,Ni=at.INTL,Fi=He.TEST;function Hi(e){const t=[];return g(e,(e=>{e&&t.push(e)})),t}function Bi(e,t){const i={};for(let t=1;t<e[0].length;++t)i[t]=!0;let n=t[0].length;for(let e=1;e<t.length;++e)t[e].length>n&&(n=t[e].length);for(let s=1;s<e.length;++s)for(let r=1;r<e[s].length;++r){let o=!1,a=!1;for(let i=0;i<t.length;++i){const l=t[i];if(l.length<n)continue;const c=l[0];if(e[s][0]===c){a=!0;for(let t=1;t<l.length;++t)if(!o)if(void 0===l[t]||"*"===l[t])o=!0;else{const i=$(l[t]+""),n=[W(e[s][r],V)].concat(i);o=U(n)}}}a&&(i[r]=i[r]&&o)}const s=[];for(let t=0;t<e[0].length;++t)i[t]&&s.push(t-1);return s}function zi(e){return e&&e.getTime&&!isNaN(e.getTime())}function Vi(e){return e instanceof Date?e:new Date(e)}function Wi(e,t,i,n,s){if(n=n||0,s=s||0,T(e=j(e),t=j(t),i=j(i),n=j(n),s=j(s)))return a;let r;if(0===e)r=n+i*t;else{const o=Math.pow(1+e,t);r=1===s?n*o+i*(1+e)*(o-1)/e:n*o+i*(o-1)/e}return-r}function $i(e,t,i,n,s,r){if(s=s||0,r=r||0,T(e=j(e),t=j(t),i=j(i),n=j(n),s=j(s),r=j(r)))return a;const o=qi(e,i,n,s,r);return(1===t?1===r?0:-n:1===r?Wi(e,t-2,o,n,1)-o:Wi(e,t-1,o,n,0))*e}function Ui(){const e=R(b(arguments));if(e instanceof Error)return e;const t=e[0];let i=0;for(let n=1;n<e.length;n++)i+=e[n]/Math.pow(1+t,n);return i}function qi(e,t,i,n,s){if(n=n||0,s=s||0,T(e=j(e),t=j(t),i=j(i),n=j(n),s=j(s)))return a;let r;if(0===e)r=(i+n)/t;else{const o=Math.pow(1+e,t);r=1===s?(n*e/(o-1)+i*e/(1-1/o))/(1+e):n*e/(o-1)+i*e/(1-1/o)}return-r}const Gi={errors:f,symbols:Xe};t.ABS=function(e){return(e=j(e))instanceof Error?e:Math.abs(e)},t.ACCRINT=function(e,t,i,n,s,r,o){return e=Vi(e),t=Vi(t),i=Vi(i),zi(e)&&zi(t)&&zi(i)?n<=0||s<=0||-1===[1,2,4].indexOf(r)||-1===[0,1,2,3,4].indexOf(o)||i<=e?h:(s=s||0)*n*ht(e,i,o=o||0):a},t.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},t.ACOS=function(e){if((e=j(e))instanceof Error)return e;let t=Math.acos(e);return isNaN(t)&&(t=h),t},t.ACOSH=function(e){if((e=j(e))instanceof Error)return e;let t=Math.log(e+Math.sqrt(e*e-1));return isNaN(t)&&(t=h),t},t.ACOT=function(e){return(e=j(e))instanceof Error?e:Math.atan(1/e)},t.ACOTH=function(e){if((e=j(e))instanceof Error)return e;let t=.5*Math.log((e+1)/(e-1));return isNaN(t)&&(t=h),t},t.AGGREGATE=function(e,t,i,n){if(T(e=j(e),j(e)))return a;switch(e){case 1:return ee(i);case 2:return oe(i);case 3:return ae(i);case 4:return be(i);case 5:return Ce(i);case 6:return Ge(i);case 7:return Re.S(i);case 8:return Re.P(i);case 9:return Ye(i);case 10:return Me.S(i);case 11:return Me.P(i);case 12:return ye(i);case 13:return we.SNGL(i);case 14:return ge(i,n);case 15:return je(i,n);case 16:return Te.INC(i,n);case 17:return Ie.INC(i,n);case 18:return Te.EXC(i,n);case 19:return Ie.EXC(i,n)}},t.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},t.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},t.AND=function(){const e=b(arguments);let t=a;for(let i=0;i<e.length;i++){if(e[i]instanceof Error)return e[i];void 0!==e[i]&&null!==e[i]&&"string"!=typeof e[i]&&(t===a&&(t=!0),e[i]||(t=!1))}return t},t.ARABIC=function(e){if(null==e)return 0;if(e instanceof Error)return e;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return a;let t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,(e=>{t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[e]})),t},t.ASC=function(){throw new Error("ASC is not implemented")},t.ASIN=function(e){if((e=j(e))instanceof Error)return e;let t=Math.asin(e);return isNaN(t)&&(t=h),t},t.ASINH=function(e){return(e=j(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},t.ATAN=function(e){return(e=j(e))instanceof Error?e:Math.atan(e)},t.ATAN2=function(e,t){return x(e=j(e),t=j(t))||Math.atan2(e,t)},t.ATANH=function(e){if((e=j(e))instanceof Error)return e;let t=Math.log((1+e)/(1-e))/2;return isNaN(t)&&(t=h),t},t.AVEDEV=function(){const e=b(arguments).filter(P);if(0===e.length)return h;const t=R(e);return t instanceof Error?t:n.sum(n(t).subtract(n.mean(t)).abs()[0])/t.length},t.AVERAGE=ee,t.AVERAGEA=te,t.AVERAGEIF=function(e,t,i){if(arguments.length<=1)return d;if(i=R(b(i=i||e).filter(P)),e=b(e),i instanceof Error)return i;let n=0,s=0;const r=void 0===t||"*"===t,o=r?null:$(t+"");for(let t=0;t<e.length;t++){const a=e[t];if(r)s+=i[t],n++;else{const e=[W(a,V)].concat(o);U(e)&&(s+=i[t],n++)}}return s/n},t.AVERAGEIFS=function(){const e=m(arguments),t=(e.length-1)/2,i=b(e[0]);let n=0,s=0;for(let r=0;r<i.length;r++){let o=!1;for(let i=0;i<t;i++){const t=e[2*i+1][r],n=e[2*i+2];let s=!1;if(void 0===n||"*"===n)s=!0;else{const e=$(n+""),i=[W(t,V)].concat(e);s=U(i)}if(!s){o=!1;break}o=!0}o&&(s+=i[r],n++)}const r=s/n;return isNaN(r)?0:r},t.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},t.BASE=function(e,t,i){const n=x(e=j(e),t=j(t),i=j(i));if(n)return n;if(0===t)return h;const s=e.toString(t);return new Array(Math.max(i+1-s.length,0)).join("0")+s},t.BESSELI=function(e,t){return T(e=j(e),t=j(t))?a:s.besseli(e,t)},t.BESSELJ=function(e,t){return T(e=j(e),t=j(t))?a:s.besselj(e,t)},t.BESSELK=function(e,t){return T(e=j(e),t=j(t))?a:s.besselk(e,t)},t.BESSELY=function(e,t){return T(e=j(e),t=j(t))?a:s.bessely(e,t)},t.BETA=ie,t.BETADIST=Rt,t.BETAINV=Lt,t.BIN2DEC=function(e){if(!yt(e))return h;const t=parseInt(e,2),i=e.toString();return 10===i.length&&"1"===i.substring(0,1)?parseInt(i.substring(1),2)-512:t},t.BIN2HEX=function(e,t){if(!yt(e))return h;const i=e.toString();if(10===i.length&&"1"===i.substring(0,1))return(0xfffffffe00+parseInt(i.substring(1),2)).toString(16);const n=parseInt(e,2).toString(16);return void 0===t?n:isNaN(t)?a:t<0?h:(t=Math.floor(t))>=n.length?vt("0",t-n.length)+n:h},t.BIN2OCT=function(e,t){if(!yt(e))return h;const i=e.toString();if(10===i.length&&"1"===i.substring(0,1))return(1073741312+parseInt(i.substring(1),2)).toString(8);const n=parseInt(e,2).toString(8);return void 0===t?n:isNaN(t)?a:t<0?h:(t=Math.floor(t))>=n.length?vt("0",t-n.length)+n:h},t.BINOM=ne,t.BINOMDIST=Mt,t.BITAND=function(e,t){return T(e=j(e),t=j(t))?a:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?h:e&t},t.BITLSHIFT=function(e,t){return T(e=j(e),t=j(t))?a:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?h:t>=0?e<<t:e>>-t},t.BITOR=function(e,t){return T(e=j(e),t=j(t))?a:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?h:e|t},t.BITRSHIFT=function(e,t){return T(e=j(e),t=j(t))?a:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?h:t>=0?e>>t:e<<-t},t.BITXOR=function(e,t){return T(e=j(e),t=j(t))?a:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?h:e^t},t.CEILING=Be,t.CEILINGMATH=Pt,t.CEILINGPRECISE=Nt,t.CELL=function(){throw new Error("CELL is not implemented")},t.CHAR=ut,t.CHIDIST=Ft,t.CHIDISTRT=Ht,t.CHIINV=Bt,t.CHIINVRT=zt,t.CHISQ=se,t.CHITEST=Vt,t.CHOOSE=function(){if(arguments.length<2)return d;const e=arguments[0];return e<1||e>254||arguments.length<e+1?a:arguments[e]},t.CLEAN=function(e){return T(e)?e:(e=e||"").replace(/[\0-\x1F]/g,"")},t.CODE=pt,t.COLUMN=function(e,t){return 2!==arguments.length?d:t<0?h:e instanceof Array&&"number"==typeof t?0!==e.length?n.col(e,t):void 0:a},t.COLUMNS=function(e){return 1!==arguments.length?d:e instanceof Array?0===e.length?0:n.cols(e):a},t.COMBIN=ze,t.COMBINA=function(e,t){return x(e=j(e),t=j(t))||(e<t?h:0===e&&0===t?1:ze(e+t-1,e-1))},t.COMPLEX=Ct,t.CONCAT=mt,t.CONCATENATE=ft,t.CONFIDENCE=re,t.CONVERT=function(e,t,i){if((e=j(e))instanceof Error)return e;const n=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["Ã¥ngstrÃ¶m","Ã",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic Ã¥ngstrÃ¶m","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","Â°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["Årsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Î©",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestÃ¤rke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square Ã¥ngstrÃ¶m","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],s={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},r={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};let o,a=null,l=null,c=t,h=i,u=1,p=1;for(let e=0;e<n.length;e++)o=null===n[e][2]?[]:n[e][2],(n[e][1]===c||o.indexOf(c)>=0)&&(a=n[e]),(n[e][1]===h||o.indexOf(h)>=0)&&(l=n[e]);if(null===a){const e=s[t.substring(0,2)];let i=r[t.substring(0,1)];"da"===t.substring(0,2)&&(i=["dekao",10,"da"]),e?(u=e[2],c=t.substring(2)):i&&(u=i[1],c=t.substring(i[2].length));for(let e=0;e<n.length;e++)o=null===n[e][2]?[]:n[e][2],(n[e][1]===c||o.indexOf(c)>=0)&&(a=n[e])}if(null===l){const e=s[i.substring(0,2)];let t=r[i.substring(0,1)];"da"===i.substring(0,2)&&(t=["dekao",10,"da"]),e?(p=e[2],h=i.substring(2)):t&&(p=t[1],h=i.substring(t[2].length));for(let e=0;e<n.length;e++)o=null===n[e][2]?[]:n[e][2],(n[e][1]===h||o.indexOf(h)>=0)&&(l=n[e])}return null===a||null===l||a[3]!==l[3]?d:e*a[6]*u/(l[6]*p)},t.CORREL=function(e,t){return T(e=R(b(e)),t=R(b(t)))?a:n.corrcoeff(e,t)},t.COS=function(e){return(e=j(e))instanceof Error?e:Math.cos(e)},t.COSH=function(e){return(e=j(e))instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},t.COT=function(e){return(e=j(e))instanceof Error?e:0===e?o:1/Math.tan(e)},t.COTH=function(e){if((e=j(e))instanceof Error)return e;if(0===e)return o;const t=Math.exp(2*e);return(t+1)/(t-1)},t.COUNT=oe,t.COUNTA=ae,t.COUNTBLANK=le,t.COUNTIF=function(e,t){if(e=b(e),void 0===t||"*"===t)return e.length;let i=0;const n=$(t+"");for(let t=0;t<e.length;t++){const s=[W(e[t],V)].concat(n);U(s)&&i++}return i},t.COUNTIFS=function(){const e=m(arguments),t=new Array(b(e[0]).length);for(let e=0;e<t.length;e++)t[e]=!0;for(let i=0;i<e.length;i+=2){const n=b(e[i]),s=e[i+1];if(void 0!==s&&"*"!==s){const e=$(s+"");for(let i=0;i<n.length;i++){const s=[W(n[i],V)].concat(e);t[i]=t[i]&&U(s)}}}let i=0;for(let e=0;e<t.length;e++)t[e]&&i++;return i},t.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},t.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},t.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},t.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},t.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},t.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},t.COVAR=Wt,t.COVARIANCE=ce,t.COVARIANCEP=$t,t.COVARIANCES=Ut,t.CRITBINOM=qt,t.CSC=function(e){return(e=j(e))instanceof Error?e:0===e?o:1/Math.sin(e)},t.CSCH=function(e){return(e=j(e))instanceof Error?e:0===e?o:2/(Math.exp(e)-Math.exp(-e))},t.CUMIPMT=function(e,t,i,n,s,r){if(T(e=j(e),t=j(t),i=j(i)))return a;if(e<=0||t<=0||i<=0)return h;if(n<1||s<1||n>s)return h;if(0!==r&&1!==r)return h;const o=qi(e,t,i,0,r);let l=0;1===n&&(0===r&&(l=-i),n++);for(let t=n;t<=s;t++)l+=1===r?Wi(e,t-2,o,i,1)-o:Wi(e,t-1,o,i,0);return l*=e,l},t.CUMPRINC=function(e,t,i,n,s,r){if(T(e=j(e),t=j(t),i=j(i)))return a;if(e<=0||t<=0||i<=0)return h;if(n<1||s<1||n>s)return h;if(0!==r&&1!==r)return h;const o=qi(e,t,i,0,r);let l=0;1===n&&(l=0===r?o+i*e:o,n++);for(let t=n;t<=s;t++)l+=r>0?o-(Wi(e,t-2,o,i,1)-o)*e:o-Wi(e,t-1,o,i,0)*e;return l},t.DATE=function(e,t,i){let n;return T(e=j(e),t=j(t),i=j(i))?n=a:(n=new Date(e,t-1,i),n.getFullYear()<0&&(n=h)),n},t.DATEDIF=tt,t.DATEVALUE=function(e){if("string"!=typeof e)return a;const t=Date.parse(e);return isNaN(t)?a:new Date(e)},t.DAVERAGE=function(e,t,i){if(isNaN(t)&&"string"!=typeof t)return a;const n=Bi(e,i);let s=[];if("string"==typeof t){const i=E(e,t);s=w(e[i])}else s=w(e[t]);let r=0;return g(n,(e=>{r+=s[e]})),0===n.length?o:r/n.length},t.DAY=function(e){const t=k(e);return t instanceof Error?t:t.getDate()},t.DAYS=nt,t.DAYS360=st,t.DB=function(e,t,i,n,s){if(s=void 0===s?12:s,T(e=j(e),t=j(t),i=j(i),n=j(n),s=j(s)))return a;if(e<0||t<0||i<0||n<0)return h;if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(s))return h;if(n>i)return h;if(t>=e)return 0;const r=(1-Math.pow(t/e,1/i)).toFixed(3),o=e*r*s/12;let l=o,c=0;const d=n===i?i-1:n;for(let t=2;t<=d;t++)c=(e-l)*r,l+=c;return 1===n?o:n===i?(e-l)*r:c},t.DBCS=function(){throw new Error("DBCS is not implemented")},t.DCOUNT=function(e,t,i){if(isNaN(t)&&"string"!=typeof t)return a;const n=Bi(e,i);let s=[];if("string"==typeof t){const i=E(e,t);s=w(e[i])}else s=w(e[t]);const r=[];return g(n,(e=>{r.push(s[e])})),oe(r)},t.DCOUNTA=function(e,t,i){if(isNaN(t)&&"string"!=typeof t)return a;const n=Bi(e,i);let s=[];if("string"==typeof t){const i=E(e,t);s=w(e[i])}else s=w(e[t]);const r=[];return g(n,(e=>{r.push(s[e])})),ae(r)},t.DDB=function(e,t,i,n,s){if(s=void 0===s?2:s,T(e=j(e),t=j(t),i=j(i),n=j(n),s=j(s)))return a;if(e<0||t<0||i<0||n<0||s<=0)return h;if(n>i)return h;if(t>=e)return 0;let r=0,o=0;for(let a=1;a<=n;a++)o=Math.min(s/i*(e-r),e-t-r),r+=o;return o},t.DEC2BIN=function(e,t){if((e=j(e))instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return h;if(e<0)return"1"+vt("0",9-(512+e).toString(2).length)+(512+e).toString(2);const i=parseInt(e,10).toString(2);return void 0===t?i:isNaN(t)?a:t<0?h:(t=Math.floor(t))>=i.length?vt("0",t-i.length)+i:h},t.DEC2HEX=function(e,t){if((e=j(e))instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return h;if(e<0)return(1099511627776+e).toString(16);const i=parseInt(e,10).toString(16);return void 0===t?i:isNaN(t)?a:t<0?h:(t=Math.floor(t))>=i.length?vt("0",t-i.length)+i:h},t.DEC2OCT=function(e,t){if((e=j(e))instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return h;if(e<0)return(1073741824+e).toString(8);const i=parseInt(e,10).toString(8);return void 0===t?i:isNaN(t)?a:t<0?h:(t=Math.floor(t))>=i.length?vt("0",t-i.length)+i:h},t.DECIMAL=function(e,t){return arguments.length<1?a:x(e=j(e),t=j(t))||(0===t?h:parseInt(e,t))},t.DEGREES=function(e){return(e=j(e))instanceof Error?e:180*e/Math.PI},t.DELTA=function(e,t){return t=void 0===t?0:t,T(e=j(e),t=j(t))?a:e===t?1:0},t.DEVSQ=function(){const e=R(b(arguments));if(e instanceof Error)return e;const t=n.mean(e);let i=0;for(let n=0;n<e.length;n++)i+=Math.pow(e[n]-t,2);return i},t.DGET=function(e,t,i){if(isNaN(t)&&"string"!=typeof t)return a;const n=Bi(e,i);let s=[];return s=w("string"==typeof t?e[E(e,t)]:e[t]),0===n.length?a:n.length>1?h:s[n[0]]},t.DISC=function(e,t,i,n,s){if(T(e=k(e),t=k(t),i=j(i),n=j(n),s=(s=j(s))||0))return a;if(i<=0||n<=0)return h;if(e>=t)return a;let r,o;switch(s){case 0:r=360,o=st(e,t,!1);break;case 1:case 3:r=365,o=tt(e,t,"D");break;case 2:r=360,o=tt(e,t,"D");break;case 4:r=360,o=st(e,t,!0);break;default:return h}return(n-i)/n*r/o},t.DMAX=function(e,t,i){if(isNaN(t)&&"string"!=typeof t)return a;const n=Bi(e,i);let s=[];if("string"==typeof t){const i=E(e,t);s=w(e[i])}else s=w(e[t]);let r=s[n[0]];return g(n,(e=>{r<s[e]&&(r=s[e])})),r},t.DMIN=function(e,t,i){if(isNaN(t)&&"string"!=typeof t)return a;const n=Bi(e,i);let s=[];if("string"==typeof t){const i=E(e,t);s=w(e[i])}else s=w(e[t]);let r=s[n[0]];return g(n,(e=>{r>s[e]&&(r=s[e])})),r},t.DOLLAR=function(e,t=2){if(e=j(e),isNaN(e))return a;const i={style:"currency",currency:"USD",minimumFractionDigits:t>=0?t:0,maximumFractionDigits:t>=0?t:0},n=(e=Ke(e,t)).toLocaleString("en-US",i);return e<0?"$("+n.slice(2)+")":n},t.DOLLARDE=function(e,t){if(T(e=j(e),t=j(t)))return a;if(t<0)return h;if(t>=0&&t<1)return o;t=parseInt(t,10);let i=parseInt(e,10);i+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;const n=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return i=Math.round(i*n)/n,i},t.DOLLARFR=function(e,t){if(T(e=j(e),t=j(t)))return a;if(t<0)return h;if(t>=0&&t<1)return o;t=parseInt(t,10);let i=parseInt(e,10);return i+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t,i},t.DPRODUCT=function(e,t,i){if(isNaN(t)&&"string"!=typeof t)return a;const n=Bi(e,i);let s=[];if("string"==typeof t){const i=E(e,t);s=w(e[i])}else s=w(e[t]);let r=[];g(n,(e=>{r.push(s[e])})),r=Hi(r);let o=1;return g(r,(e=>{o*=e})),o},t.DSTDEV=function(e,t,i){if(isNaN(t)&&"string"!=typeof t)return a;const n=Bi(e,i);let s=[];if("string"==typeof t){const i=E(e,t);s=w(e[i])}else s=w(e[t]);let r=[];return g(n,(e=>{r.push(s[e])})),r=Hi(r),Re.S(r)},t.DSTDEVP=function(e,t,i){if(isNaN(t)&&"string"!=typeof t)return a;const n=Bi(e,i);let s=[];if("string"==typeof t){const i=E(e,t);s=w(e[i])}else s=w(e[t]);let r=[];return g(n,(e=>{r.push(s[e])})),r=Hi(r),Re.P(r)},t.DSUM=function(e,t,i){if(isNaN(t)&&"string"!=typeof t)return a;const n=Bi(e,i);let s=[];if("string"==typeof t){const i=E(e,t);s=w(e[i])}else s=w(e[t]);const r=[];return g(n,(e=>{r.push(s[e])})),Ye(r)},t.DURATION=function(){throw new Error("DURATION is not implemented")},t.DVAR=function(e,t,i){if(isNaN(t)&&"string"!=typeof t)return a;const n=Bi(e,i);let s=[];if("string"==typeof t){const i=E(e,t);s=w(e[i])}else s=w(e[t]);const r=[];return g(n,(e=>{r.push(s[e])})),Me.S(r)},t.DVARP=function(e,t,i){if(isNaN(t)&&"string"!=typeof t)return a;const n=Bi(e,i);let s=[];if("string"==typeof t){const i=E(e,t);s=w(e[i])}else s=w(e[t]);const r=[];return g(n,(e=>{r.push(s[e])})),Me.P(r)},t.EDATE=function(e,t){return(e=k(e))instanceof Error?e:isNaN(t)?a:(t=parseInt(t,10),e.setMonth(e.getMonth()+t),e)},t.EFFECT=function(e,t){return T(e=j(e),t=j(t))?a:e<=0||t<1?h:(t=parseInt(t,10),Math.pow(1+e/t,t)-1)},t.EOMONTH=function(e,t){return(e=k(e))instanceof Error?e:isNaN(t)?a:(t=parseInt(t,10),new Date(e.getFullYear(),e.getMonth()+t+1,0))},t.ERF=wt,t.ERFC=St,t.ERFCPRECISE=Gt,t.ERFPRECISE=Kt,t.ERROR=q,t.EVEN=function(e){return(e=j(e))instanceof Error?e:Be(e,-2,-1)},t.EXACT=function(e,t){return 2!==arguments.length?d:x(e,t)||(e=L(e))===L(t)},t.EXP=function(e){return arguments.length<1?d:arguments.length>1?u:(e=j(e))instanceof Error?e:e=Math.exp(e)},t.EXPON=he,t.EXPONDIST=Yt,t.F=de,t.FACT=We,t.FACTDOUBLE=function e(t){if((t=j(t))instanceof Error)return t;const i=Math.floor(t);return i<=0?1:i*e(i-2)},t.FALSE=function(){return!1},t.FDIST=Xt,t.FDISTRT=Zt,t.FIND=function(e,t,i){if(arguments.length<2)return d;e=L(e),i=void 0===i?0:i;const n=(t=L(t)).indexOf(e,i-1);return-1===n?a:n+1},t.FINV=Qt,t.FINVRT=Jt,t.FISHER=function(e){return(e=j(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},t.FISHERINV=function(e){if((e=j(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},t.FIXED=gt,t.FLOOR=$e,t.FLOORMATH=ei,t.FLOORPRECISE=ti,t.FORECAST=ue,t.FREQUENCY=function(e,t){if(T(e=R(b(e)),t=R(b(t))))return a;const i=e.length,n=t.length,s=[];for(let r=0;r<=n;r++){s[r]=0;for(let o=0;o<i;o++)0===r?e[o]<=t[0]&&(s[0]+=1):r<n?e[o]>t[r-1]&&e[o]<=t[r]&&(s[r]+=1):r===n&&e[o]>t[n-1]&&(s[n]+=1)}return s},t.FTEST=ii,t.FV=Wi,t.FVSCHEDULE=function(e,t){if(T(e=j(e),t=R(b(t))))return a;const i=t.length;let n=e;for(let e=0;e<i;e++)n*=1+t[e];return n},t.GAMMA=pe,t.GAMMADIST=ni,t.GAMMAINV=si,t.GAMMALN=fe,t.GAMMALNPRECISE=ri,t.GAUSS=function(e){return(e=j(e))instanceof Error?e:n.normal.cdf(e,0,1)-.5},t.GCD=function(){const e=R(b(arguments));if(e instanceof Error)return e;const t=e.length,i=e[0];let n=i<0?-i:i;for(let i=1;i<t;i++){const t=e[i];let s=t<0?-t:t;for(;n&&s;)n>s?n%=s:s%=n;n+=s}return n},t.GEOMEAN=function(){const e=R(b(arguments));return e instanceof Error?e:n.geomean(e)},t.GESTEP=function(e,t){return T(t=t||0,e=j(e))?e:e>=t?1:0},t.GROWTH=function(e,t,i,n){if((e=R(e))instanceof Error)return e;let s;if(void 0===t)for(t=[],s=1;s<=e.length;s++)t.push(s);if(void 0===i)for(i=[],s=1;s<=e.length;s++)i.push(s);if(T(t=R(t),i=R(i)))return a;void 0===n&&(n=!0);const r=e.length;let o,l,c=0,h=0,d=0,u=0;for(s=0;s<r;s++){const i=t[s],n=Math.log(e[s]);c+=i,h+=n,d+=i*n,u+=i*i}c/=r,h/=r,d/=r,u/=r,n?(o=(d-c*h)/(u-c*c),l=h-o*c):(o=d/u,l=0);const p=[];for(s=0;s<i.length;s++)p.push(Math.exp(l+o*i[s]));return p},t.HARMEAN=function(){const e=R(b(arguments));if(e instanceof Error)return e;const t=e.length;let i=0;for(let n=0;n<t;n++)i+=1/e[n];return t/i},t.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return h;const i=!(10!==e.length||"f"!==e.substring(0,1).toLowerCase()),n=i?parseInt(e,16)-1099511627776:parseInt(e,16);if(n<-512||n>511)return h;if(i)return"1"+vt("0",9-(512+n).toString(2).length)+(512+n).toString(2);const s=n.toString(2);return void 0===t?s:isNaN(t)?a:t<0?h:(t=Math.floor(t))>=s.length?vt("0",t-s.length)+s:h},t.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return h;const t=parseInt(e,16);return t>=549755813888?t-1099511627776:t},t.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return h;const i=parseInt(e,16);if(i>536870911&&i<0xffe0000000)return h;if(i>=0xffe0000000)return(i-0xffc0000000).toString(8);const n=i.toString(8);return void 0===t?n:isNaN(t)?a:t<0?h:(t=Math.floor(t))>=n.length?vt("0",t-n.length)+n:h},t.HLOOKUP=function(e,t,i,n){return J(e,S(t),i,n)},t.HOUR=function(e){return(e=k(e))instanceof Error?e:e.getHours()},t.HYPGEOM=me,t.HYPGEOMDIST=oi,t.IF=function(e,t,i){return e instanceof Error?e:(null==(t=!(arguments.length>=2)||t)&&(t=0),null==(i=3===arguments.length&&i)&&(i=0),e?t:i)},t.IFERROR=function(e,t){return K(e)?t:e},t.IFNA=function(e,t){return e===d?t:e},t.IFS=function(){for(let e=0;e<arguments.length/2;e++)if(arguments[2*e])return arguments[2*e+1];return d},t.IMABS=Et,t.IMAGINARY=xt,t.IMARGUMENT=Tt,t.IMCONJUGATE=function(e){const t=kt(e),i=xt(e);if(T(t,i))return a;let n=e.substring(e.length-1);return n="i"===n||"j"===n?n:"i",0!==i?Ct(t,-i,n):e},t.IMCOS=At,t.IMCOSH=Ot,t.IMCOT=function(e){return T(kt(e),xt(e))?a:It(At(e),Dt(e))},t.IMCSC=function(e){return!0===e||!1===e?a:T(kt(e),xt(e))?h:It("1",Dt(e))},t.IMCSCH=function(e){return!0===e||!1===e?a:T(kt(e),xt(e))?h:It("1",jt(e))},t.IMDIV=It,t.IMEXP=function(e){const t=kt(e),i=xt(e);if(T(t,i))return a;let n=e.substring(e.length-1);n="i"===n||"j"===n?n:"i";const s=Math.exp(t);return Ct(s*Math.cos(i),s*Math.sin(i),n)},t.IMLN=function(e){const t=kt(e),i=xt(e);if(T(t,i))return a;let n=e.substring(e.length-1);return n="i"===n||"j"===n?n:"i",Ct(Math.log(Math.sqrt(t*t+i*i)),Math.atan(i/t),n)},t.IMLOG10=function(e){const t=kt(e),i=xt(e);if(T(t,i))return a;let n=e.substring(e.length-1);return n="i"===n||"j"===n?n:"i",Ct(Math.log(Math.sqrt(t*t+i*i))/Math.log(10),Math.atan(i/t)/Math.log(10),n)},t.IMLOG2=function(e){const t=kt(e),i=xt(e);if(T(t,i))return a;let n=e.substring(e.length-1);return n="i"===n||"j"===n?n:"i",Ct(Math.log(Math.sqrt(t*t+i*i))/Math.log(2),Math.atan(i/t)/Math.log(2),n)},t.IMPOWER=function(e,t){if(T(t=j(t),kt(e),xt(e)))return a;let i=e.substring(e.length-1);i="i"===i||"j"===i?i:"i";const n=Math.pow(Et(e),t),s=Tt(e);return Ct(n*Math.cos(t*s),n*Math.sin(t*s),i)},t.IMPRODUCT=function(){let e=arguments[0];if(!arguments.length)return a;for(let t=1;t<arguments.length;t++){const i=kt(e),n=xt(e),s=kt(arguments[t]),r=xt(arguments[t]);if(T(i,n,s,r))return a;e=Ct(i*s-n*r,i*r+n*s)}return e},t.IMREAL=kt,t.IMSEC=function(e){return!0===e||!1===e||T(kt(e),xt(e))?a:It("1",At(e))},t.IMSECH=function(e){return T(kt(e),xt(e))?a:It("1",Ot(e))},t.IMSIN=Dt,t.IMSINH=jt,t.IMSQRT=function(e){if(T(kt(e),xt(e)))return a;let t=e.substring(e.length-1);t="i"===t||"j"===t?t:"i";const i=Math.sqrt(Et(e)),n=Tt(e);return Ct(i*Math.cos(n/2),i*Math.sin(n/2),t)},t.IMSUB=function(e,t){const i=kt(e),n=xt(e),s=kt(t),r=xt(t);if(T(i,n,s,r))return a;const o=e.substring(e.length-1),l=t.substring(t.length-1);let c="i";return("j"===o||"j"===l)&&(c="j"),Ct(i-s,n-r,c)},t.IMSUM=function(){if(!arguments.length)return a;const e=b(arguments);let t=e[0];for(let i=1;i<e.length;i++){const n=kt(t),s=xt(t),r=kt(e[i]),o=xt(e[i]);if(T(n,s,r,o))return a;t=Ct(n+r,s+o)}return t},t.IMTAN=function(e){return!0===e||!1===e||T(kt(e),xt(e))?a:It(Dt(e),At(e))},t.INDEX=function(e,t,i){const n=x(e,t,i);if(n)return n;if(!Array.isArray(e))return a;const s=e.length>0&&!Array.isArray(e[0]);return s&&!i?(i=t,t=1):(i=i||1,t=t||1),i<0||t<0?a:s&&1===t&&i<=e.length?e[i-1]:t<=e.length&&i<=e[t-1].length?e[t-1][i-1]:l},t.INFO=function(){throw new Error("INFO is not implemented")},t.INT=function(e){return(e=j(e))instanceof Error?e:Math.floor(e)},t.INTERCEPT=function(e,t){return T(e=R(e),t=R(t))?a:e.length!==t.length?d:ue(0,e,t)},t.INTRATE=function(){throw new Error("INTRATE is not implemented")},t.IPMT=$i,t.IRR=function(e,t){if(t=t||0,T(e=R(b(e)),t=j(t)))return a;const i=(e,t,i)=>{const n=i+1;let s=e[0];for(let i=1;i<e.length;i++)s+=e[i]/Math.pow(n,(t[i]-t[0])/365);return s},n=(e,t,i)=>{const n=i+1;let s=0;for(let i=1;i<e.length;i++){const r=(t[i]-t[0])/365;s-=r*e[i]/Math.pow(n,r+1)}return s},s=[];let r=!1,o=!1;for(let t=0;t<e.length;t++)s[t]=0===t?0:s[t-1]+365,e[t]>0&&(r=!0),e[t]<0&&(o=!0);if(!r||!o)return h;let l,c,d,u=t=void 0===t?.1:t,p=!0;do{d=i(e,s,u),l=u-d/n(e,s,u),c=Math.abs(l-u),u=l,p=c>1e-10&&Math.abs(d)>1e-10}while(p);return u},t.ISBLANK=function(e){return null===e},t.ISERR=G,t.ISERROR=K,t.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},t.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},t.ISLOGICAL=Y,t.ISNA=function(e){return e===d},t.ISNONTEXT=function(e){return"string"!=typeof e},t.ISNUMBER=X,t.ISO=Ue,t.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},t.ISOWEEKNUM=rt,t.ISPMT=function(e,t,i,n){return T(e=j(e),t=j(t),i=j(i),n=j(n))?a:n*e*(t/i-1)},t.ISREF=function(){throw new Error("ISREF is not implemented")},t.ISTEXT=Z,t.KURT=function(){const e=R(b(arguments));if(e instanceof Error)return e;const t=n.mean(e),i=e.length;let s=0;for(let n=0;n<i;n++)s+=Math.pow(e[n]-t,4);return s/=Math.pow(n.stdev(e,!0),4),i*(i+1)/((i-1)*(i-2)*(i-3))*s-3*(i-1)*(i-1)/((i-2)*(i-3))},t.LARGE=ge,t.LCM=function(){const e=R(b(arguments));if(e instanceof Error)return e;for(var t,i,n,s,r=1;void 0!==(n=e.pop());){if(0===n)return 0;for(;n>1;){if(n%2){for(t=3,i=Math.floor(Math.sqrt(n));t<=i&&n%t;t+=2);s=t<=i?t:n}else s=2;for(n/=s,r*=s,t=e.length;t;e[--t]%s==0&&1==(e[t]/=s)&&e.splice(t,1));}}return r},t.LEFT=function(e,t){return x(e,t)||(e=L(e),(t=j(t=void 0===t?1:t))instanceof Error||"string"!=typeof e?a:e.substring(0,t))},t.LEN=function(e){return 0===arguments.length?u:e instanceof Error?e:Array.isArray(e)?a:L(e).length},t.LINEST=ve,t.LN=function(e){return(e=j(e))instanceof Error?e:0===e?h:Math.log(e)},t.LOG=function(e,t){return x(e=j(e),t=j(t))||(0===e||0===t?h:Math.log(e)/Math.log(t))},t.LOG10=function(e){return(e=j(e))instanceof Error?e:0===e?h:Math.log(e)/Math.log(10)},t.LOGEST=function(e,t){if(T(e=R(b(e)),t=R(b(t))))return a;if(e.length!==t.length)return a;for(let t=0;t<e.length;t++)e[t]=Math.log(e[t]);const i=ve(e,t);return i[0]=Math.round(1e6*Math.exp(i[0]))/1e6,i[1]=Math.round(1e6*Math.exp(i[1]))/1e6,i},t.LOGINV=ai,t.LOGNORM=_e,t.LOGNORMDIST=li,t.LOGNORMINV=ci,t.LOOKUP=function(e,t,i){t=b(t),i=i?b(i):t;const n="number"==typeof e;let s=d;for(let r=0;r<t.length;r++){if(t[r]===e)return i[r];if(n&&t[r]<=e||"string"==typeof t[r]&&t[r].localeCompare(e)<0)s=i[r];else if(n&&t[r]>e)return s}return s},t.LOWER=function(e){return 1!==arguments.length?a:T(e=L(e))?e:e.toLowerCase()},t.MATCH=function(e,t,i){if(!e||!t)return d;if(2===arguments.length&&(i=1),!((t=b(t))instanceof Array))return d;if(-1!==i&&0!==i&&1!==i)return d;let n,s;for(let r=0;r<t.length;r++)if(1===i){if(t[r]===e)return r+1;t[r]<e&&(s?t[r]>s&&(n=r+1,s=t[r]):(n=r+1,s=t[r]))}else if(0===i){if("string"==typeof e&&"string"==typeof t[r]){const i=e.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\");if(new RegExp("^"+i+"$").test(t[r].toLowerCase()))return r+1}else if(t[r]===e)return r+1}else if(-1===i){if(t[r]===e)return r+1;t[r]>e&&(s?t[r]<s&&(n=r+1,s=t[r]):(n=r+1,s=t[r]))}return n||d},t.MAX=be,t.MAXA=function(){const e=b(arguments),t=x.apply(void 0,e);if(t)return t;let i=v(e);return i=i.map((e=>null==e?0:e)),0===i.length?0:Math.max.apply(Math,i)},t.MDURATION=function(){throw new Error("MDURATION is not implemented")},t.MEDIAN=ye,t.MID=function(e,t,i){if(null==t)return a;if(T(t=j(t),i=j(i))||"string"!=typeof e)return i;const n=t-1,s=n+i;return e.substring(n,s)},t.MIN=Ce,t.MINA=function(){const e=b(arguments),t=x.apply(void 0,e);if(t)return t;let i=v(e);return i=i.map((e=>null==e?0:e)),0===i.length?0:Math.min.apply(Math,i)},t.MINUTE=function(e){return(e=k(e))instanceof Error?e:e.getMinutes()},t.MIRR=function(e,t,i){if(T(e=R(b(e)),t=j(t),i=j(i)))return a;const n=e.length,s=[],r=[];for(let t=0;t<n;t++)e[t]<0?s.push(e[t]):r.push(e[t]);const o=-Ui(i,r)*Math.pow(1+i,n-1),l=Ui(t,s)*(1+t);return Math.pow(o/l,1/(n-1))-1},t.MMULT=function(e,t){return!Array.isArray(e)||!Array.isArray(t)||e.some((e=>!e.length))||t.some((e=>!e.length))||y(e).some((e=>"number"!=typeof e))||y(t).some((e=>"number"!=typeof e))||e[0].length!==t.length?a:Array(e.length).fill(0).map((()=>Array(t[0].length).fill(0))).map(((i,n)=>i.map(((i,s)=>e[n].reduce(((e,i,n)=>e+i*t[n][s]),0)))))},t.MOD=function(e,t){const i=x(e=j(e),t=j(t));if(i)return i;if(0===t)return o;let n=Math.abs(e%t);return n=e<0?t-n:n,t>0?n:-n},t.MODE=we,t.MODEMULT=hi,t.MODESNGL=di,t.MONTH=function(e){return(e=k(e))instanceof Error?e:e.getMonth()+1},t.MROUND=function(e,t){return x(e=j(e),t=j(t))||(e*t==0?0:e*t<0?h:Math.round(e/t)*t)},t.MULTINOMIAL=function(){const e=R(b(arguments));if(e instanceof Error)return e;let t=0,i=1;for(let n=0;n<e.length;n++)t+=e[n],i*=We(e[n]);return We(t)/i},t.MUNIT=function(e){return arguments.length>1?d:!(e=parseInt(e))||e<=0?a:Array(e).fill(0).map((()=>Array(e).fill(0))).map(((e,t)=>(e[t]=1,e)))},t.N=function(e){return X(e)?e:e instanceof Date?e.getTime():!0===e?1:!1===e?0:K(e)?e:0},t.NA=function(){return d},t.NEGBINOM=Se,t.NEGBINOMDIST=ui,t.NETWORKDAYS=ot,t.NETWORKDAYSINTL=pi,t.NOMINAL=function(e,t){return T(e=j(e),t=j(t))?a:e<=0||t<1?h:(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)},t.NORM=Ee,t.NORMDIST=fi,t.NORMINV=mi,t.NORMSDIST=gi,t.NORMSINV=vi,t.NOT=function(e){return"string"==typeof e?a:e instanceof Error?e:!e},t.NOW=function(){return new Date},t.NPER=function(e,t,i,n,s){if(s=void 0===s?0:s,n=void 0===n?0:n,T(e=j(e),t=j(t),i=j(i),n=j(n),s=j(s)))return a;if(0===e)return-(i+n)/t;{const r=t*(1+e*s)-n*e,o=i*e+t*(1+e*s);return Math.log(r/o)/Math.log(1+e)}},t.NPV=Ui,t.NUMBERVALUE=function(e,t,i){return"number"==typeof(e=P(e)?e:"")?e:"string"!=typeof e?d:(t=void 0===t?".":t,i=void 0===i?",":i,Number(e.replace(t,".").replace(i,"")))},t.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return h;const i=!(10!==e.length||"7"!==e.substring(0,1)),n=i?parseInt(e,8)-1073741824:parseInt(e,8);if(n<-512||n>511)return h;if(i)return"1"+vt("0",9-(512+n).toString(2).length)+(512+n).toString(2);const s=n.toString(2);return void 0===t?s:isNaN(t)?a:t<0?h:(t=Math.floor(t))>=s.length?vt("0",t-s.length)+s:h},t.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return h;const t=parseInt(e,8);return t>=536870912?t-1073741824:t},t.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return h;const i=parseInt(e,8);if(i>=536870912)return"ff"+(i+3221225472).toString(16);const n=i.toString(16);return void 0===t?n:isNaN(t)?a:t<0?h:(t=Math.floor(t))>=n.length?vt("0",t-n.length)+n:h},t.ODD=function(e){if((e=j(e))instanceof Error)return e;let t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,e>=0?t:-t},t.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},t.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},t.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},t.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},t.OR=function(){const e=b(arguments);let t=a;for(let i=0;i<e.length;i++){if(e[i]instanceof Error)return e[i];void 0!==e[i]&&null!==e[i]&&"string"!=typeof e[i]&&(t===a&&(t=!1),e[i]&&(t=!0))}return t},t.PDURATION=function(e,t,i){return T(e=j(e),t=j(t),i=j(i))?a:e<=0?h:(Math.log(i)-Math.log(t))/Math.log(1+e)},t.PEARSON=xe,t.PERCENTILE=Te,t.PERCENTILEEXC=_i,t.PERCENTILEINC=bi,t.PERCENTRANK=Ae,t.PERCENTRANKEXC=yi,t.PERCENTRANKINC=Ci,t.PERMUT=function(e,t){return T(e=j(e),t=j(t))?a:We(e)/We(e-t)},t.PERMUTATIONA=function(e,t){return T(e=j(e),t=j(t))?a:Math.pow(e,t)},t.PHI=function(e){return(e=j(e))instanceof Error?a:Math.exp(-.5*e*e)/2.5066282746310002},t.PI=function(){return Math.PI},t.PMT=qi,t.POISSON=Oe,t.POISSONDIST=wi,t.POWER=qe,t.PPMT=function(e,t,i,n,s,r){return s=s||0,r=r||0,T(e=j(e),i=j(i),n=j(n),s=j(s),r=j(r))?a:qi(e,i,n,s,r)-$i(e,t,i,n,s,r)},t.PRICE=function(){throw new Error("PRICE is not implemented")},t.PRICEDISC=function(e,t,i,n,s){if(T(e=k(e),t=k(t),i=j(i),n=j(n),s=(s=j(s))||0))return a;if(i<=0||n<=0)return h;if(e>=t)return a;let r,o;switch(s){case 0:r=360,o=st(e,t,!1);break;case 1:case 3:r=365,o=tt(e,t,"D");break;case 2:r=360,o=tt(e,t,"D");break;case 4:r=360,o=st(e,t,!0);break;default:return h}return n-i*n*o/r},t.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},t.PROB=function(e,t,i,n){if(void 0===i)return 0;if(n=void 0===n?i:n,T(e=R(b(e)),t=R(b(t)),i=j(i),n=j(n)))return a;if(i===n)return e.indexOf(i)>=0?t[e.indexOf(i)]:0;const s=e.sort(((e,t)=>e-t)),r=s.length;let o=0;for(let a=0;a<r;a++)s[a]>=i&&s[a]<=n&&(o+=t[e.indexOf(s[a])]);return o},t.PRODUCT=Ge,t.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},t.PROPER=function(e){return T(e)?e:isNaN(e)&&"number"==typeof e?a:(e=L(e)).replace(/\w\S*/g,(e=>e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()))},t.PV=function(e,t,i,n,s){return n=n||0,s=s||0,T(e=j(e),t=j(t),i=j(i),n=j(n),s=j(s))?a:0===e?-i*t-n:((1-Math.pow(1+e,t))/e*i*(1+e*s)-n)/Math.pow(1+e,t)},t.QUARTILE=Ie,t.QUARTILEEXC=Si,t.QUARTILEINC=Ei,t.QUOTIENT=function(e,t){return x(e=j(e),t=j(t))||parseInt(e/t,10)},t.RADIANS=function(e){return(e=j(e))instanceof Error?e:e*Math.PI/180},t.RAND=function(){return Math.random()},t.RANDBETWEEN=function(e,t){return x(e=j(e),t=j(t))||e+Math.ceil((t-e+1)*Math.random())-1},t.RANK=ke,t.RANKAVG=xi,t.RANKEQ=Ti,t.RATE=function(e,t,i,n,s,r){if(r=void 0===r?.01:r,n=void 0===n?0:n,s=void 0===s?0:s,T(e=j(e),t=j(t),i=j(i),n=j(n),s=j(s),r=j(r)))return a;const o=1e-10;let l=r;s=s?1:0;for(let r=0;r<20;r++){if(l<=-1)return h;let r,a,c;if(Math.abs(l)<o?r=i*(1+e*l)+t*(1+l*s)*e+n:(a=Math.pow(1+l,e),r=i*a+t*(1/l+s)*(a-1)+n),Math.abs(r)<o)return l;if(Math.abs(l)<o)c=i*e+t*s*e;else{a=Math.pow(1+l,e);const n=e*Math.pow(1+l,e-1);c=i*n+t*(1/l+s)*n+t*(-1/(l*l))*(a-1)}l-=r/c}return l},t.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},t.REPLACE=function(e,t,i,n){return T(t=j(t),i=j(i))||"string"!=typeof e||"string"!=typeof n?a:e.substr(0,t-1)+n+e.substr(t-1+i)},t.REPT=vt,t.RIGHT=function(e,t){return x(e,t)||(e=L(e),(t=j(t=void 0===t?1:t))instanceof Error?t:e.substring(e.length-t))},t.ROMAN=function(e){if((e=j(e))instanceof Error)return e;const t=String(e).split(""),i=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let n="",s=3;for(;s--;)n=(i[+t.pop()+10*s]||"")+n;return new Array(+t.join("")+1).join("M")+n},t.ROUND=Ke,t.ROUNDDOWN=function(e,t){return x(e=j(e),t=j(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},t.ROUNDUP=function(e,t){return x(e=j(e),t=j(t))||(e>0?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},t.ROW=function(e,t){return 2!==arguments.length?d:t<0?h:e instanceof Array&&"number"==typeof t?0!==e.length?n.row(e,t):void 0:a},t.ROWS=function(e){return 1!==arguments.length?d:e instanceof Array?0===e.length?0:n.rows(e):a},t.RRI=function(e,t,i){return T(e=j(e),t=j(t),i=j(i))?a:0===e||0===t?h:Math.pow(i/t,1/e)-1},t.RSQ=function(e,t){return T(e=R(b(e)),t=R(b(t)))?a:Math.pow(xe(e,t),2)},t.SEARCH=function(e,t,i){let n;return"string"!=typeof e||"string"!=typeof t?a:(i=void 0===i?0:i,n=t.toLowerCase().indexOf(e.toLowerCase(),i-1)+1,0===n?a:n)},t.SEC=function(e){return(e=j(e))instanceof Error?e:1/Math.cos(e)},t.SECH=function(e){return(e=j(e))instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},t.SECOND=function(e){return(e=k(e))instanceof Error?e:e.getSeconds()},t.SERIESSUM=function(e,t,i,n){if(T(e=j(e),t=j(t),i=j(i),n=R(n)))return a;let s=n[0]*Math.pow(e,t);for(let r=1;r<n.length;r++)s+=n[r]*Math.pow(e,t+r*i);return s},t.SHEET=function(){throw new Error("SHEET is not implemented")},t.SHEETS=function(){throw new Error("SHEETS is not implemented")},t.SIGN=function(e){return(e=j(e))instanceof Error?e:e<0?-1:0===e?0:1},t.SIN=function(e){return(e=j(e))instanceof Error?e:Math.sin(e)},t.SINH=function(e){return(e=j(e))instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},t.SKEW=De,t.SKEWP=Ai,t.SLN=function(e,t,i){return T(e=j(e),t=j(t),i=j(i))?a:0===i?h:(e-t)/i},t.SLOPE=function(e,t){if(T(e=R(b(e)),t=R(b(t))))return a;const i=n.mean(t),s=n.mean(e),r=t.length;let o=0,l=0;for(let n=0;n<r;n++)o+=(t[n]-i)*(e[n]-s),l+=Math.pow(t[n]-i,2);return o/l},t.SMALL=je,t.SORT=function(e,t=1,i=1,n=!1){if(!e||!Array.isArray(e))return d;if(0===e.length)return 0;if(!(t=j(t))||t<1)return a;if(1!==(i=j(i))&&-1!==i)return a;if("boolean"!=typeof(n=I(n)))return c;const s=e=>e.sort(((e,n)=>(e=L(e[t-1]),n=L(n[t-1]),1===i?e<n?-1*i:i:e>n?i:-1*i))),r=_(e),o=n?S(r):r;return t>=1&&t<=o[0].length?n?S(s(o)):s(o):a},t.SQRT=function(e){return(e=j(e))instanceof Error?e:e<0?h:Math.sqrt(e)},t.SQRTPI=function(e){return(e=j(e))instanceof Error?e:Math.sqrt(e*Math.PI)},t.STANDARDIZE=function(e,t,i){return T(e=j(e),t=j(t),i=j(i))?a:(e-t)/i},t.STDEV=Re,t.STDEVA=function(){const e=Pe.apply(this,arguments);return Math.sqrt(e)},t.STDEVP=Oi,t.STDEVPA=function(){const e=Ne.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=h),t},t.STDEVS=Ii,t.STEYX=function(e,t){if(T(e=R(b(e)),t=R(b(t))))return a;const i=n.mean(t),s=n.mean(e),r=t.length;let o=0,l=0,c=0;for(let n=0;n<r;n++)o+=Math.pow(e[n]-s,2),l+=(t[n]-i)*(e[n]-s),c+=Math.pow(t[n]-i,2);return Math.sqrt((o-l*l/c)/(r-2))},t.SUBSTITUTE=function(e,t,i,n){if(arguments.length<3)return d;if(e&&t){if(void 0===n)return e.split(t).join(i);{if(n=Math.floor(Number(n)),Number.isNaN(n)||n<=0)return a;let s=0,r=0;for(;s>-1&&e.indexOf(t,s)>-1;)if(s=e.indexOf(t,s+1),r++,s>-1&&r===n)return e.substring(0,s)+i+e.substring(s+t.length);return e}}return e},t.SUBTOTAL=function(e,t){if((e=j(e))instanceof Error)return e;switch(e){case 1:case 101:return ee(t);case 2:case 102:return oe(t);case 3:case 103:return ae(t);case 4:case 104:return be(t);case 5:case 105:return Ce(t);case 6:case 106:return Ge(t);case 7:case 107:return Re.S(t);case 8:case 108:return Re.P(t);case 9:case 109:return Ye(t);case 10:case 110:return Me.S(t);case 11:case 111:return Me.P(t)}},t.SUM=Ye,t.SUMIF=function(e,t,i){if(e=b(e),i=i?b(i):e,e instanceof Error)return e;if(null==t||t instanceof Error)return 0;let n=0;const s="*"===t,r=s?null:$(t+"");for(let t=0;t<e.length;t++){const o=e[t],a=i[t];if(s)n+=o;else{const e=[W(o,V)].concat(r);n+=U(e)?a:0}}return n},t.SUMIFS=function(){const e=m(arguments),t=R(b(e.shift()));if(t instanceof Error)return t;const i=e,n=i.length/2;for(let e=0;e<n;e++)i[2*e]=b(i[2*e]);let s=0;for(let e=0;e<t.length;e++){let r=!1;for(let t=0;t<n;t++){const n=i[2*t][e],s=i[2*t+1];let o=!1;if(void 0===s||"*"===s)o=!0;else{const e=$(s+""),t=[W(n,V)].concat(e);o=U(t)}if(!o){r=!1;break}r=!0}r&&(s+=t[e])}return s},t.SUMPRODUCT=function(){if(!arguments||0===arguments.length)return a;const e=arguments.length+1;let t,i,n,s,r=0;for(let o=0;o<arguments[0].length;o++)if(arguments[0][o]instanceof Array)for(let n=0;n<arguments[0][o].length;n++){for(t=1,i=1;i<e;i++){const e=arguments[i-1][o][n];if(e instanceof Error)return e;if(s=j(e),s instanceof Error)return s;t*=s}r+=t}else{for(t=1,i=1;i<e;i++){const e=arguments[i-1][o];if(e instanceof Error)return e;if(n=j(e),n instanceof Error)return n;t*=n}r+=t}return r},t.SUMSQ=function(){const e=R(b(arguments));if(e instanceof Error)return e;let t=0;const i=e.length;for(let n=0;n<i;n++)t+=X(e[n])?e[n]*e[n]:0;return t},t.SUMX2MY2=function(e,t){if(T(e=R(b(e)),t=R(b(t))))return a;let i=0;for(let n=0;n<e.length;n++)i+=e[n]*e[n]-t[n]*t[n];return i},t.SUMX2PY2=function(e,t){if(T(e=R(b(e)),t=R(b(t))))return a;let i=0;e=R(b(e)),t=R(b(t));for(let n=0;n<e.length;n++)i+=e[n]*e[n]+t[n]*t[n];return i},t.SUMXMY2=function(e,t){if(T(e=R(b(e)),t=R(b(t))))return a;let i=0;e=b(e),t=b(t);for(let n=0;n<e.length;n++)i+=Math.pow(e[n]-t[n],2);return i},t.SWITCH=function(){let e;if(arguments.length>0){const t=arguments[0],i=arguments.length-1,n=Math.floor(i/2);let s=!1;const r=i%2!=0,o=i%2==0?null:arguments[arguments.length-1];if(n)for(let i=0;i<n;i++)if(t===arguments[2*i+1]){e=arguments[2*i+2],s=!0;break}s||(e=r?o:d)}else e=a;return e},t.SYD=function(e,t,i,n){return T(e=j(e),t=j(t),i=j(i),n=j(n))?a:0===i||n<1||n>i?h:(e-t)*(i-(n=parseInt(n,10))+1)*2/(i*(i+1))},t.T=function(e){return e instanceof Error||"string"==typeof e?e:""},t.TAN=function(e){return(e=j(e))instanceof Error?e:Math.tan(e)},t.TANH=function(e){if((e=j(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},t.TBILLEQ=function(e,t,i){return T(e=k(e),t=k(t),i=j(i))?a:i<=0||e>t||t-e>31536e6?h:365*i/(360-i*st(e,t,!1))},t.TBILLPRICE=function(e,t,i){return T(e=k(e),t=k(t),i=j(i))?a:i<=0||e>t||t-e>31536e6?h:100*(1-i*st(e,t,!1)/360)},t.TBILLYIELD=function(e,t,i){return T(e=k(e),t=k(t),i=j(i))?a:i<=0||e>t||t-e>31536e6?h:360*(100-i)/(i*st(e,t,!1))},t.TDIST=ki,t.TDISTRT=Di,t.TEXT=function(e,t){if(void 0===e||e instanceof Error||t instanceof Error)return d;if(null==t)return"";if("number"==typeof t)return String(t);if("string"!=typeof t)return a;const i=t.startsWith("$")?"$":"",n=t.endsWith("%");return n&&(e*=100),e=(e=gt(e,(t=t.replace(/%/g,"").replace(/\$/g,"")).split(".")[1].match(/0/g).length,!t.includes(","))).startsWith("-")?"-"+i+(e=e.replace("-","")):i+e,n&&(e+="%"),e},t.TEXTJOIN=function(e,t,...i){if("boolean"!=typeof t&&(t=I(t)),arguments.length<3)return d;e=null!=e?e:"";let n=b(i),s=t?n.filter((e=>e)):n;if(Array.isArray(e)){e=b(e);let t=s.map((e=>[e])),i=0;for(let n=0;n<t.length-1;n++)t[n].push(e[i]),i++,i===e.length&&(i=0);return s=b(t),s.join("")}return s.join(e)},t.TIME=function(e,t,i){return T(e=j(e),t=j(t),i=j(i))?a:e<0||t<0||i<0?h:(3600*e+60*t+i)/86400},t.TIMEVALUE=function(e){return(e=k(e))instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},t.TINV=ji,t.TODAY=function(){return it(new Date)},t.TRANSPOSE=function(e){return e?S(_(e)):d},t.TREND=function(e,t,i){if(T(e=R(b(e)),t=R(b(t)),i=R(b(i))))return a;const n=ve(e,t),s=n[0],r=n[1],o=[];return i.forEach((e=>{o.push(s*e+r)})),o},t.TRIM=function(e){return(e=L(e))instanceof Error?e:e.replace(/\s+/g," ").trim()},t.TRIMMEAN=function(e,t){if(T(e=R(b(e)),t=j(t)))return a;const i=$e(e.length*t,2)/2;return n.mean((r=(r=i)||1,(s=w(e.sort(((e,t)=>e-t)),i))&&"function"==typeof s.slice?s.slice(0,s.length-r):s));var s,r},t.TRUE=function(){return!0},t.TRUNC=function(e,t){return x(e=j(e),t=j(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},t.TTEST=Ri,t.TYPE=function(e){return X(e)?1:Z(e)?2:Y(e)?4:K(e)?16:Array.isArray(e)?64:void 0},t.UNICHAR=_t,t.UNICODE=bt,t.UNIQUE=Q,t.UPPER=function(e){return(e=L(e))instanceof Error?e:e.toUpperCase()},t.VALUE=function(e){const t=x(e);if(t)return t;if("number"==typeof e)return e;if(P(e)||(e=""),"string"!=typeof e)return a;const i=/(%)$/.test(e)||/^(%)/.test(e);if(""===(e=(e=(e=e.replace(/^[^0-9-]{0,3}/,"")).replace(/[^0-9]{0,3}$/,"")).replace(/[ ,]/g,"")))return 0;let n=Number(e);return isNaN(n)?a:(n=n||0,i&&(n*=.01),n)},t.VAR=Me,t.VARA=Pe,t.VARP=Li,t.VARPA=Ne,t.VARS=Mi,t.VDB=function(){throw new Error("VDB is not implemented")},t.VLOOKUP=J,t.WEEKDAY=function(e,t){if((e=k(e))instanceof Error)return e;void 0===t&&(t=1);const i=e.getDay();return Je[t][i]},t.WEEKNUM=function(e,t){if((e=k(e))instanceof Error)return e;if(void 0===t&&(t=1),21===t)return rt(e);const i=Qe[t];let n=new Date(e.getFullYear(),0,1);const s=n.getDay()<i?1:0;return n-=24*Math.abs(n.getDay()-i)*60*60*1e3,Math.floor((e-n)/864e5/7+1)+s},t.WEIBULL=Fe,t.WEIBULLDIST=Pi,t.WORKDAY=at,t.WORKDAYINTL=Ni,t.XIRR=function(e,t,i){if(T(e=R(b(e)),t=D(b(t)),i=j(i)))return a;const n=(e,t,i)=>{const n=i+1;let s=e[0];for(let i=1;i<e.length;i++)s+=e[i]/Math.pow(n,nt(t[i],t[0])/365);return s},s=(e,t,i)=>{const n=i+1;let s=0;for(let i=1;i<e.length;i++){const r=nt(t[i],t[0])/365;s-=r*e[i]/Math.pow(n,r+1)}return s};let r=!1,o=!1;for(let t=0;t<e.length;t++)e[t]>0&&(r=!0),e[t]<0&&(o=!0);if(!r||!o)return h;let l,c,d,u=i=i||.1,p=!0;do{d=n(e,t,u),l=u-d/s(e,t,u),c=Math.abs(l-u),u=l,p=c>1e-10&&Math.abs(d)>1e-10}while(p);return u},t.XNPV=function(e,t,i){if(T(e=j(e),t=R(b(t)),i=D(b(i))))return a;let n=0;for(let s=0;s<t.length;s++)n+=t[s]/Math.pow(1+e,nt(i[s],i[0])/365);return n},t.XOR=function(){const e=b(arguments);let t=a;for(let i=0;i<e.length;i++){if(e[i]instanceof Error)return e[i];void 0!==e[i]&&null!==e[i]&&"string"!=typeof e[i]&&(t===a&&(t=0),e[i]&&t++)}return t===a?t:!!(1&Math.floor(Math.abs(t)))},t.YEAR=function(e){return(e=k(e))instanceof Error?e:e.getFullYear()},t.YEARFRAC=ht,t.YIELD=function(){throw new Error("YIELD is not implemented")},t.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},t.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")},t.Z=He,t.ZTEST=Fi,t.utils=Gi}},i={};function n(t){var s=i[t];if(void 0!==s)return s.exports;var r=i[t]={exports:{}};return e[t].call(r.exports,r,r.exports,n),r.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();var s=n(960);t=s}(),t)},44:function(module,__unused_webpack_exports,__nested_webpack_require_141145__){if(!formula)var formula=__nested_webpack_require_141145__(463);var factory;factory=function(){"use strict";var Version=(info={title:"Jspreadsheet",version:"4.15.0",type:"CE",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[this.title+" "+this.type+" "+this.version,this.host,this.license].join("\r\n")}},function(){return info}),info,isFormula=function(e){var t=(""+e)[0];return"="==t||"#"==t},getMask=function(e){if(e.format||e.mask||e.locale){var t={};return e.mask?t.mask=e.mask:e.format?t.mask=e.format:(t.locale=e.locale,t.options=e.options),e.decimal&&(t.options||(t.options={}),t.options={decimal:e.decimal}),t}return null},jexcel=function(el,options){var obj={options:{}};if(!(el instanceof Element||el instanceof HTMLDocument))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;if("TABLE"==el.tagName){if(!(options=jexcel.createFromTable(el,options)))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;var div=document.createElement("div");el.parentNode.insertBefore(div,el),el.remove(),el=div}var defaults={url:null,method:"GET",requestVariables:null,data:null,sorting:null,copyCompatibility:!1,root:null,rows:[],columns:[],colHeaders:[],colWidths:[],colAlignments:[],nestedHeaders:null,defaultColWidth:50,defaultColAlign:"center",defaultRowHeight:null,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],allowExport:!0,includeHeadersOnDownload:!1,includeHeadersOnCopy:!1,columnSorting:!0,columnDrag:!1,columnResize:!0,rowResize:!1,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!1,wordWrap:!1,imageOptions:null,csv:null,csvFileName:"jspreadsheet",csvHeaders:!0,csvDelimiter:",",parseTableFirstRowAsHeader:!1,parseTableAutoCellType:!1,selectionCopy:!0,mergeCells:{},toolbar:null,search:!1,pagination:!1,paginationOptions:null,fullscreen:!1,lazyLoading:!1,loadingSpin:!1,tableOverflow:!1,tableHeight:"300px",tableWidth:null,textOverflow:!1,meta:null,style:null,classes:null,parseFormulas:!0,autoIncrement:!0,autoCasting:!0,secureFormulas:!0,stripHTML:!0,stripHTMLOnCopy:!1,filters:!1,footers:null,onundo:null,onredo:null,onload:null,onchange:null,oncomments:null,onbeforechange:null,onafterchanges:null,onbeforeinsertrow:null,oninsertrow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeleterow:null,ondeleterow:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresizerow:null,onresizecolumn:null,onsort:null,onselection:null,oncopy:null,onpaste:null,onbeforepaste:null,onmerge:null,onfocus:null,onblur:null,onchangeheader:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onchangepage:null,onbeforesave:null,onsave:null,onevent:null,persistance:!1,updateTable:null,detachForUpdates:!1,freezeColumns:null,text:{noRecordsFound:"No records found",showingPage:"Showing page {0} of {1} entries",show:"Show ",search:"Search",entries:" entries",columnName:"Column name",insertANewColumnBefore:"Insert a new column before",insertANewColumnAfter:"Insert a new column after",deleteSelectedColumns:"Delete selected columns",renameThisColumn:"Rename this column",orderAscending:"Order ascending",orderDescending:"Order descending",insertANewRowBefore:"Insert a new row before",insertANewRowAfter:"Insert a new row after",deleteSelectedRows:"Delete selected rows",editComments:"Edit comments",addComments:"Add comments",comments:"Comments",clearComments:"Clear comments",copy:"Copy...",paste:"Paste...",saveAs:"Save as...",about:"About",areYouSureToDeleteTheSelectedRows:"Are you sure to delete the selected rows?",areYouSureToDeleteTheSelectedColumns:"Are you sure to delete the selected columns?",thisActionWillDestroyAnyExistingMergedCellsAreYouSure:"This action will destroy any existing merged cells. Are you sure?",thisActionWillClearYourSearchResultsAreYouSure:"This action will clear your search results. Are you sure?",thereIsAConflictWithAnotherMergedCell:"There is a conflict with another merged cell",invalidMergeProperties:"Invalid merged properties",cellAlreadyMerged:"Cell already merged",noCellsSelected:"No cells selected"},about:!0};for(var property in defaults)if(options&&options.hasOwnProperty(property))if("text"===property)for(var textKey in obj.options[property]=defaults[property],options[property])options[property].hasOwnProperty(textKey)&&(obj.options[property][textKey]=options[property][textKey]);else obj.options[property]=options[property];else obj.options[property]=defaults[property];obj.el=el,obj.corner=null,obj.contextMenu=null,obj.textarea=null,obj.ads=null,obj.content=null,obj.table=null,obj.thead=null,obj.tbody=null,obj.rows=[],obj.results=null,obj.searchInput=null,obj.toolbar=null,obj.pagination=null,obj.pageNumber=null,obj.headerContainer=null,obj.colgroupContainer=null,obj.headers=[],obj.records=[],obj.history=[],obj.formula=[],obj.colgroup=[],obj.selection=[],obj.highlighted=[],obj.selectedCell=null,obj.selectedContainer=null,obj.style=[],obj.data=null,obj.filter=null,obj.filters=[],obj.cursor=null,obj.historyIndex=-1,obj.ignoreEvents=!1,obj.ignoreHistory=!1,obj.edition=null,obj.hashString=null,obj.resizing=null,obj.dragging=null,1==obj.options.lazyLoading&&0==obj.options.tableOverflow&&0==obj.options.fullscreen&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),obj.options.lazyLoading=!1),obj.fullscreen=function(e){null==e&&(e=!obj.options.fullscreen),obj.options.fullscreen!=e&&(obj.options.fullscreen=e,1==e?el.classList.add("fullscreen"):el.classList.remove("fullscreen"))},obj.dispatch=function(e){if(!obj.ignoreEvents){if("function"==typeof obj.options.onevent)var t=obj.options.onevent.apply(this,arguments);"function"==typeof obj.options[e]&&(t=obj.options[e].apply(this,Array.prototype.slice.call(arguments,1)))}if("onafterchanges"==e&&obj.options.persistance){var i=1==obj.options.persistance?obj.options.url:obj.options.persistance,n=obj.prepareJson(arguments[2]);obj.save(i,n)}return t},obj.prepareTable=function(){var e=obj.options.columns.length;if(obj.options.data&&void 0!==obj.options.data[0]){var t=Object.keys(obj.options.data[0]);t.length>e&&(e=t.length)}obj.options.minDimensions[0]>e&&(e=obj.options.minDimensions[0]);for(var i=[],n=0;n<e;n++)obj.options.colHeaders[n]||(obj.options.colHeaders[n]=""),obj.options.colWidths[n]||(obj.options.colWidths[n]=obj.options.defaultColWidth),obj.options.colAlignments[n]||(obj.options.colAlignments[n]=obj.options.defaultColAlign),obj.options.columns[n]?obj.options.columns[n].type||(obj.options.columns[n].type="text"):obj.options.columns[n]={type:"text"},obj.options.columns[n].name||(obj.options.columns[n].name=t&&t[n]?t[n]:n),obj.options.columns[n].source||(obj.options.columns[n].source=[]),obj.options.columns[n].options||(obj.options.columns[n].options=[]),obj.options.columns[n].editor||(obj.options.columns[n].editor=null),obj.options.columns[n].allowEmpty||(obj.options.columns[n].allowEmpty=!1),obj.options.columns[n].title||(obj.options.columns[n].title=obj.options.colHeaders[n]?obj.options.colHeaders[n]:""),obj.options.columns[n].width||(obj.options.columns[n].width=obj.options.colWidths[n]?obj.options.colWidths[n]:obj.options.defaultColWidth),obj.options.columns[n].align||(obj.options.columns[n].align=obj.options.colAlignments[n]?obj.options.colAlignments[n]:"center"),"autocomplete"==obj.options.columns[n].type||"dropdown"==obj.options.columns[n].type?obj.options.columns[n].url&&i.push({url:obj.options.columns[n].url,index:n,method:"GET",dataType:"json",success:function(e){for(var t=0;t<e.length;t++)obj.options.columns[this.index].source.push(e[t])}}):"calendar"==obj.options.columns[n].type&&(obj.options.columns[n].options.format||(obj.options.columns[n].options.format="DD/MM/YYYY"));i.length?jSuites.ajax(i,(function(){obj.createTable()})):obj.createTable()},obj.createTable=function(){obj.table=document.createElement("table"),obj.thead=document.createElement("thead"),obj.tbody=document.createElement("tbody"),obj.headers=[],obj.colgroup=[],obj.content=document.createElement("div"),obj.content.classList.add("jexcel_content"),obj.content.onscroll=function(e){obj.scrollControls(e)},obj.content.onwheel=function(e){obj.wheelControls(e)},obj.toolbar=document.createElement("div"),obj.toolbar.classList.add("jexcel_toolbar");var e=document.createElement("div"),t=document.createTextNode(obj.options.text.search+": ");obj.searchInput=document.createElement("input"),obj.searchInput.classList.add("jexcel_search"),e.appendChild(t),e.appendChild(obj.searchInput),obj.searchInput.onfocus=function(){obj.resetSelection()};var i=document.createElement("div");if(obj.options.pagination>0&&obj.options.paginationOptions&&obj.options.paginationOptions.length>0){obj.paginationDropdown=document.createElement("select"),obj.paginationDropdown.classList.add("jexcel_pagination_dropdown"),obj.paginationDropdown.onchange=function(){obj.options.pagination=parseInt(this.value),obj.page(0)};for(var n=0;n<obj.options.paginationOptions.length;n++){var s=document.createElement("option");s.value=obj.options.paginationOptions[n],s.innerHTML=obj.options.paginationOptions[n],obj.paginationDropdown.appendChild(s)}obj.paginationDropdown.value=obj.options.pagination,i.appendChild(document.createTextNode(obj.options.text.show)),i.appendChild(obj.paginationDropdown),i.appendChild(document.createTextNode(obj.options.text.entries))}var r,o=document.createElement("div");if(o.classList.add("jexcel_filter"),o.appendChild(i),o.appendChild(e),obj.colgroupContainer=document.createElement("colgroup"),(r=document.createElement("col")).setAttribute("width","50"),obj.colgroupContainer.appendChild(r),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var a=0;a<obj.options.nestedHeaders.length;a++)obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[a]));else obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));for(obj.headerContainer=document.createElement("tr"),(r=document.createElement("td")).classList.add("jexcel_selectall"),obj.headerContainer.appendChild(r),n=0;n<obj.options.columns.length;n++)obj.createCellHeader(n),obj.headerContainer.appendChild(obj.headers[n]),obj.colgroupContainer.appendChild(obj.colgroup[n]);if(obj.thead.appendChild(obj.headerContainer),1==obj.options.filters){obj.filter=document.createElement("tr");var l=document.createElement("td");for(obj.filter.appendChild(l),n=0;n<obj.options.columns.length;n++)(l=document.createElement("td")).innerHTML="&nbsp;",l.setAttribute("data-x",n),l.className="jexcel_column_filter","hidden"==obj.options.columns[n].type&&(l.style.display="none"),obj.filter.appendChild(l);obj.thead.appendChild(obj.filter)}obj.table=document.createElement("table"),obj.table.classList.add("jexcel"),obj.table.setAttribute("cellpadding","0"),obj.table.setAttribute("cellspacing","0"),obj.table.setAttribute("unselectable","yes"),obj.table.appendChild(obj.colgroupContainer),obj.table.appendChild(obj.thead),obj.table.appendChild(obj.tbody),obj.options.textOverflow||obj.table.classList.add("jexcel_overflow"),obj.corner=document.createElement("div"),obj.corner.className="jexcel_corner",obj.corner.setAttribute("unselectable","on"),obj.corner.setAttribute("onselectstart","return false"),0==obj.options.selectionCopy&&(obj.corner.style.display="none"),obj.textarea=document.createElement("textarea"),obj.textarea.className="jexcel_textarea",obj.textarea.id="jexcel_textarea",obj.textarea.tabIndex="-1",obj.contextMenu=document.createElement("div"),obj.contextMenu.className="jexcel_contextmenu",jSuites.contextmenu(obj.contextMenu,{onclick:function(){obj.contextMenu.contextmenu.close(!1)}});var c=document.createElement("a");c.setAttribute("href","https://bossanova.uk/jspreadsheet/"),obj.ads=document.createElement("div"),obj.ads.className="jexcel_about";var h=document.createElement("span");h.innerHTML="Jspreadsheet CE",c.appendChild(h),obj.ads.appendChild(c),document.createElement("div").classList.add("jexcel_table"),obj.pagination=document.createElement("div"),obj.pagination.classList.add("jexcel_pagination");var d=document.createElement("div"),u=document.createElement("div");if(obj.pagination.appendChild(d),obj.pagination.appendChild(u),obj.options.pagination||(obj.pagination.style.display="none"),1==obj.options.search&&el.appendChild(o),obj.content.appendChild(obj.table),obj.content.appendChild(obj.corner),obj.content.appendChild(obj.textarea),el.appendChild(obj.toolbar),el.appendChild(obj.content),el.appendChild(obj.pagination),el.appendChild(obj.contextMenu),el.appendChild(obj.ads),el.classList.add("jexcel_container"),obj.options.toolbar&&obj.options.toolbar.length&&obj.createToolbar(),1==obj.options.fullscreen?el.classList.add("fullscreen"):1==obj.options.tableOverflow&&(obj.options.tableHeight&&(obj.content.style["overflow-y"]="auto",obj.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",obj.content.style.maxHeight=obj.options.tableHeight),obj.options.tableWidth&&(obj.content.style["overflow-x"]="auto",obj.content.style.width=obj.options.tableWidth)),1!=obj.options.tableOverflow&&obj.options.toolbar&&el.classList.add("with-toolbar"),1==obj.options.columnDrag&&obj.thead.classList.add("draggable"),1==obj.options.columnResize&&obj.thead.classList.add("resizable"),1==obj.options.rowDrag&&obj.tbody.classList.add("draggable"),1==obj.options.rowResize&&obj.tbody.classList.add("resizable"),obj.setData(),obj.options.style&&obj.setStyle(obj.options.style,null,null,1,1),obj.options.classes){var p=Object.keys(obj.options.classes);for(n=0;n<p.length;n++){var f=jexcel.getIdFromColumnName(p[n],!0);obj.records[f[1]][f[0]].classList.add(obj.options.classes[p[n]])}}},obj.refresh=function(){obj.options.url?(1==obj.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(e){obj.options.data=e.data?e.data:e,obj.setData(),1==obj.options.loadingSpin&&jSuites.loading.hide()}})):obj.setData()},obj.setData=function(e){if(e&&("string"==typeof e&&(e=JSON.parse(e)),obj.options.data=e),obj.options.data||(obj.options.data=[]),obj.options.data&&obj.options.data[0]&&!Array.isArray(obj.options.data[0])){e=[];for(var t=0;t<obj.options.data.length;t++){for(var i=[],n=0;n<obj.options.columns.length;n++)i[n]=obj.options.data[t][obj.options.columns[n].name];e.push(i)}obj.options.data=e}t=0,n=0;var s=obj.options.columns.length,r=obj.options.data.length,o=obj.options.minDimensions[0],a=obj.options.minDimensions[1],l=o>s?o:s,c=a>r?a:r;for(t=0;t<c;t++)for(n=0;n<l;n++)null==obj.options.data[t]&&(obj.options.data[t]=[]),null==obj.options.data[t][n]&&(obj.options.data[t][n]="");if(obj.rows=[],obj.results=null,obj.records=[],obj.history=[],obj.historyIndex=-1,obj.tbody.innerHTML="",1==obj.options.lazyLoading){var h=0,d=obj.options.data.length<100?obj.options.data.length:100;obj.options.pagination&&(obj.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))}else obj.options.pagination?(obj.pageNumber||(obj.pageNumber=0),obj.options.pagination,h=obj.options.pagination*obj.pageNumber,d=obj.options.pagination*obj.pageNumber+obj.options.pagination,obj.options.data.length<d&&(d=obj.options.data.length)):(h=0,d=obj.options.data.length);for(t=0;t<obj.options.data.length;t++){var u=obj.createRow(t,obj.options.data[t]);t>=h&&t<d&&obj.tbody.appendChild(u)}if(1==obj.options.lazyLoading||obj.options.pagination&&obj.updatePagination(),obj.options.mergeCells){var p=Object.keys(obj.options.mergeCells);for(n=0;n<p.length;n++){var f=obj.options.mergeCells[p[n]];obj.setMerge(p[n],f[0],f[1],1)}}obj.updateTable(),obj.dispatch("onload",el,obj)},obj.getData=function(e,t){for(var i=[],n=0,s=0,r=1==t||0==obj.options.copyCompatibility,o=obj.options.columns.length,a=obj.options.data.length,l=0;l<a;l++){n=0;for(var c=0;c<o;c++)e&&!obj.records[l][c].classList.contains("highlight")||(i[s]||(i[s]=[]),i[s][n]=r?obj.options.data[l][c]:obj.records[l][c].innerHTML,n++);n>0&&s++}return i},obj.getJsonRow=function(e){for(var t=obj.options.data[e],i=obj.options.columns.length,n={},s=0;s<i;s++)obj.options.columns[s].name||(obj.options.columns[s].name=s),n[obj.options.columns[s].name]=t[s];return n},obj.getJson=function(e){for(var t=[],i=obj.options.columns.length,n=obj.options.data.length,s=0;s<n;s++){for(var r=null,o=0;o<i;o++)e&&!obj.records[s][o].classList.contains("highlight")||(null==r&&(r={}),obj.options.columns[o].name||(obj.options.columns[o].name=o),r[obj.options.columns[o].name]=obj.options.data[s][o]);null!=r&&t.push(r)}return t},obj.prepareJson=function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i].x,s=e[i].y,r=obj.options.columns[n].name?obj.options.columns[n].name:n;t[s]||(t[s]={row:s,data:{}}),t[s].data[r]=e[i].newValue}return t.filter((function(e){return null!=e}))},obj.save=function(e,t){var i=obj.dispatch("onbeforesave",el,obj,t);if(i)t=i;else if(!1===i)return!1;jSuites.ajax({url:e,method:"POST",dataType:"json",data:{data:JSON.stringify(t)},success:function(e){obj.dispatch("onsave",el,obj,t)}})},obj.getRowData=function(e){return obj.options.data[e]},obj.setRowData=function(e,t){for(var i=0;i<obj.headers.length;i++){var n=jexcel.getColumnNameFromId([i,e]);null!=t[i]&&obj.setValue(n,t[i])}},obj.getColumnData=function(e){for(var t=[],i=0;i<obj.options.data.length;i++)t.push(obj.options.data[i][e]);return t},obj.setColumnData=function(e,t){for(var i=0;i<obj.rows.length;i++){var n=jexcel.getColumnNameFromId([e,i]);null!=t[i]&&obj.setValue(n,t[i])}},obj.createRow=function(e,t){obj.records[e]||(obj.records[e]=[]),t||(t=obj.options.data[e]),obj.rows[e]=document.createElement("tr"),obj.rows[e].setAttribute("data-y",e);var i=null;obj.options.defaultRowHeight&&(obj.rows[e].style.height=obj.options.defaultRowHeight+"px"),obj.options.rows[e]&&(obj.options.rows[e].height&&(obj.rows[e].style.height=obj.options.rows[e].height),obj.options.rows[e].title&&(i=obj.options.rows[e].title)),i||(i=parseInt(e+1));var n=document.createElement("td");n.innerHTML=i,n.setAttribute("data-y",e),n.className="jexcel_row",obj.rows[e].appendChild(n);for(var s=0;s<obj.options.columns.length;s++)obj.records[e][s]=obj.createCell(s,e,t[s]),obj.rows[e].appendChild(obj.records[e][s]);return obj.rows[e]},obj.parseValue=function(e,t,i,n){"="==(""+i).substr(0,1)&&1==obj.options.parseFormulas&&(i=obj.executeFormula(i,e,t));var s=obj.options.columns[e];if(s&&!isFormula(i)){var r=null;if(r=getMask(s)){i&&i==Number(i)&&(i=Number(i));var o=jSuites.mask.render(i,r,!0);if(n&&r.mask){var a=r.mask.split(";");a[1]&&(a[1].match(new RegExp("\\[Red\\]","gi"))&&(i<0?n.classList.add("red"):n.classList.remove("red")),a[1].match(new RegExp("\\(","gi"))&&i<0&&(o="("+o+")"))}o&&(i=o)}}return i};var validDate=function(e){return"-"==(e=""+e).substr(4,1)&&"-"==e.substr(7,1)||4==(e=e.split("-"))[0].length&&e[0]==Number(e[0])&&2==e[1].length&&e[1]==Number(e[1])};obj.createCell=function(e,t,i){var n=document.createElement("td");if(n.setAttribute("data-x",e),n.setAttribute("data-y",t),"="==(""+i).substr(0,1)&&1==obj.options.secureFormulas){var s=secureFormula(i);s!=i&&(i=s)}if(obj.options.columns[e].editor)!1===obj.options.stripHTML||!1===obj.options.columns[e].stripHTML?n.innerHTML=i:n.textContent=i,"function"==typeof obj.options.columns[e].editor.createCell&&(n=obj.options.columns[e].editor.createCell(n));else if("hidden"==obj.options.columns[e].type)n.style.display="none",n.textContent=i;else if("checkbox"==obj.options.columns[e].type||"radio"==obj.options.columns[e].type){var r=document.createElement("input");r.type=obj.options.columns[e].type,r.name="c"+e,r.checked=1==i||1==i||"true"==i,r.onclick=function(){obj.setValue(n,this.checked)},1!=obj.options.columns[e].readOnly&&0!=obj.options.editable||r.setAttribute("disabled","disabled"),n.appendChild(r),obj.options.data[t][e]=r.checked}else if("calendar"==obj.options.columns[e].type){var o=null;if(!validDate(i)){var a=jSuites.calendar.extractDateFromString(i,obj.options.columns[e].options.format);a&&(o=a)}n.textContent=jSuites.calendar.getDateString(o||i,obj.options.columns[e].options.format)}else if("dropdown"==obj.options.columns[e].type||"autocomplete"==obj.options.columns[e].type)n.classList.add("jexcel_dropdown"),n.textContent=obj.getDropDownValue(e,i);else if("color"==obj.options.columns[e].type)if("square"==obj.options.columns[e].render){var l=document.createElement("div");l.className="color",l.style.backgroundColor=i,n.appendChild(l)}else n.style.color=i,n.textContent=i;else if("image"==obj.options.columns[e].type){if(i&&"data:image"==i.substr(0,10)){var c=document.createElement("img");c.src=i,n.appendChild(c)}}else"html"==obj.options.columns[e].type||!1===obj.options.stripHTML||!1===obj.options.columns[e].stripHTML?n.innerHTML=stripScript(obj.parseValue(e,t,i,n)):n.textContent=obj.parseValue(e,t,i,n);1==obj.options.columns[e].readOnly&&(n.className="readonly");var h=obj.options.columns[e].align?obj.options.columns[e].align:"center";return n.style.textAlign=h,0!=obj.options.columns[e].wordWrap&&(1==obj.options.wordWrap||1==obj.options.columns[e].wordWrap||n.innerHTML.length>200)&&(n.style.whiteSpace="pre-wrap"),e>0&&1==this.options.textOverflow&&(i||n.innerHTML?obj.records[t][e-1].style.overflow="hidden":e==obj.options.columns.length-1&&(n.style.overflow="hidden")),n},obj.createCellHeader=function(e){var t=obj.options.columns[e].width?obj.options.columns[e].width:obj.options.defaultColWidth,i=obj.options.columns[e].align?obj.options.columns[e].align:obj.options.defaultColAlign;obj.headers[e]=document.createElement("td"),obj.options.stripHTML?obj.headers[e].textContent=obj.options.columns[e].title?obj.options.columns[e].title:jexcel.getColumnName(e):obj.headers[e].innerHTML=obj.options.columns[e].title?obj.options.columns[e].title:jexcel.getColumnName(e),obj.headers[e].setAttribute("data-x",e),obj.headers[e].style.textAlign=i,obj.options.columns[e].title&&obj.headers[e].setAttribute("title",obj.headers[e].innerText),obj.options.columns[e].id&&obj.headers[e].setAttribute("id",obj.options.columns[e].id),obj.colgroup[e]=document.createElement("col"),obj.colgroup[e].setAttribute("width",t),"hidden"==obj.options.columns[e].type&&(obj.headers[e].style.display="none",obj.colgroup[e].style.display="none")},obj.updateNestedHeader=function(e,t,i){obj.options.nestedHeaders[t][e].title&&(obj.options.nestedHeaders[t][e].title=i,obj.options.nestedHeaders[t].element.children[e+1].textContent=i)},obj.createNestedHeader=function(e){var t=document.createElement("tr");t.classList.add("jexcel_nested");var i=document.createElement("td");t.appendChild(i),e.element=t;for(var n=0,s=0;s<e.length;s++){e[s].colspan||(e[s].colspan=1),e[s].align||(e[s].align="center"),e[s].title||(e[s].title=""),e[s].id||(e[s].id="");for(var r=e[s].colspan,o=[],a=0;a<r;a++)obj.options.columns[n]&&"hidden"==obj.options.columns[n].type&&r++,o.push(n),n++;(i=document.createElement("td")).setAttribute("data-column",o.join(",")),i.setAttribute("colspan",e[s].colspan),i.setAttribute("align",e[s].align),i.setAttribute("id",e[s].id),i.textContent=e[s].title,t.appendChild(i)}return t},obj.createToolbar=function(e){e?obj.options.toolbar=e:e=obj.options.toolbar;for(var t=0;t<e.length;t++)if("i"==e[t].type)(r=document.createElement("i")).classList.add("jexcel_toolbar_item"),r.classList.add("material-icons"),r.setAttribute("data-k",e[t].k),r.setAttribute("data-v",e[t].v),r.setAttribute("id",e[t].id),e[t].tooltip&&r.setAttribute("title",e[t].tooltip),e[t].onclick&&(e[t].onclick,1)?r.onclick=function(t){var i=t;return function(){e[i].onclick(el,obj,this)}}(t):r.onclick=function(){var e=this.getAttribute("data-k"),t=this.getAttribute("data-v");obj.setStyle(obj.highlighted,e,t)},r.textContent=e[t].content,obj.toolbar.appendChild(r);else if("select"==e[t].type){var i=!1;(r=document.createElement("select")).classList.add("jexcel_toolbar_item"),r.setAttribute("data-k",e[t].k),e[t].tooltip&&r.setAttribute("title",e[t].tooltip),e[t].onchange&&(e[t].onchange,1)?(r.onchange=e[t].onchange,i=!0):r.onchange=function(){var e=this.getAttribute("data-k");obj.setStyle(obj.highlighted,e,this.value)};for(var n=0;n<e[t].v.length;n++){var s=document.createElement("option");s.value=e[t].v[n],s.textContent=e[t].v[n],e[t].selectedValue&&s.value===e[t].selectedValue&&(s.selected=!0),r.appendChild(s)}i&&r.dispatchEvent(new Event("change")),obj.toolbar.appendChild(r)}else if("color"==e[t].type){var r;(r=document.createElement("i")).classList.add("jexcel_toolbar_item"),r.classList.add("material-icons"),r.setAttribute("data-k",e[t].k),r.setAttribute("data-v",""),e[t].tooltip&&r.setAttribute("title",e[t].tooltip),obj.toolbar.appendChild(r),r.textContent=e[t].content,jSuites.color(r,{onchange:function(e,t){var i=e.getAttribute("data-k");obj.setStyle(obj.highlighted,i,t)}})}},obj.setMerge=function(e,t,i,n){var s=!1;if(!e){if(!obj.highlighted.length)return alert(obj.options.text.noCellsSelected),null;var r=parseInt(obj.highlighted[0].getAttribute("data-x")),o=parseInt(obj.highlighted[0].getAttribute("data-y")),a=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-x")),l=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-y"));e=jexcel.getColumnNameFromId([r,o]),t=a-r+1,i=l-o+1}var c=jexcel.getIdFromColumnName(e,!0);if(obj.options.mergeCells[e])obj.records[c[1]][c[0]].getAttribute("data-merged")&&(s=obj.options.text.cellAlreadyMerged);else if((!t||t<2)&&(!i||i<2))s=obj.options.text.invalidMergeProperties;else for(var h=c[1];h<c[1]+i;h++)for(var d=c[0];d<c[0]+t;d++)jexcel.getColumnNameFromId([d,h]),obj.records[h][d].getAttribute("data-merged")&&(s=obj.options.text.thereIsAConflictWithAnotherMergedCell);if(s)alert(s);else{t>1?obj.records[c[1]][c[0]].setAttribute("colspan",t):t=1,i>1?obj.records[c[1]][c[0]].setAttribute("rowspan",i):i=1,obj.options.mergeCells[e]=[t,i,[]],obj.records[c[1]][c[0]].setAttribute("data-merged","true"),obj.records[c[1]][c[0]].style.overflow="hidden";for(var u=[],p=c[1];p<c[1]+i;p++)for(var f=c[0];f<c[0]+t;f++)c[0]==f&&c[1]==p||(u.push(obj.options.data[p][f]),obj.updateCell(f,p,"",!0),obj.options.mergeCells[e][2].push(obj.records[p][f]),obj.records[p][f].style.display="none",obj.records[p][f]=obj.records[c[1]][c[0]]);obj.updateSelection(obj.records[c[1]][c[0]]),n||(obj.setHistory({action:"setMerge",column:e,colspan:t,rowspan:i,data:u}),obj.dispatch("onmerge",el,e,t,i))}},obj.getMerge=function(e){var t={};if(e)t=obj.options.mergeCells[e]?[obj.options.mergeCells[e][0],obj.options.mergeCells[e][1]]:null;else if(obj.options.mergeCells){obj.options.mergeCells;for(var i=Object.keys(obj.options.mergeCells),n=0;n<i.length;n++)t[i[n]]=[obj.options.mergeCells[i[n]][0],obj.options.mergeCells[i[n]][1]]}return t},obj.removeMerge=function(e,t,i){if(obj.options.mergeCells[e]){var n=jexcel.getIdFromColumnName(e,!0);obj.records[n[1]][n[0]].removeAttribute("colspan"),obj.records[n[1]][n[0]].removeAttribute("rowspan"),obj.records[n[1]][n[0]].removeAttribute("data-merged");for(var s=obj.options.mergeCells[e],r=0,o=0;o<s[1];o++)for(var a=0;a<s[0];a++)(o>0||a>0)&&(obj.records[n[1]+o][n[0]+a]=s[2][r],obj.records[n[1]+o][n[0]+a].style.display="",t&&t[r]&&obj.updateCell(n[0]+a,n[1]+o,t[r]),r++);obj.updateSelection(obj.records[n[1]][n[0]],obj.records[n[1]+o-1][n[0]+a-1]),i||delete obj.options.mergeCells[e]}},obj.destroyMerged=function(e){if(obj.options.mergeCells){obj.options.mergeCells;for(var t=Object.keys(obj.options.mergeCells),i=0;i<t.length;i++)obj.removeMerge(t[i],null,e)}},obj.isColMerged=function(e,t){var i=[];if(obj.options.mergeCells)for(var n=Object.keys(obj.options.mergeCells),s=0;s<n.length;s++){var r=jexcel.getIdFromColumnName(n[s],!0),o=obj.options.mergeCells[n[s]][0],a=r[0],l=r[0]+(o>1?o-1:0);null==t?a<=e&&l>=e&&i.push(n[s]):t?a<e&&l>=e&&i.push(n[s]):a<=e&&l>e&&i.push(n[s])}return i},obj.isRowMerged=function(e,t){var i=[];if(obj.options.mergeCells)for(var n=Object.keys(obj.options.mergeCells),s=0;s<n.length;s++){var r=jexcel.getIdFromColumnName(n[s],!0),o=obj.options.mergeCells[n[s]][1],a=r[1],l=r[1]+(o>1?o-1:0);null==t?a<=e&&l>=e&&i.push(n[s]):t?a<e&&l>=e&&i.push(n[s]):a<=e&&l>e&&i.push(n[s])}return i},obj.openFilter=function(e){if(obj.options.filters){e=parseInt(e),obj.resetSelection();var t=[];if("checkbox"==obj.options.columns[e].type)t.push({id:"true",name:"True"}),t.push({id:"false",name:"False"});else{for(var i=[],n=!1,s=0;s<obj.options.data.length;s++){var r=obj.options.data[s][e],o=obj.records[s][e].innerHTML;r&&o?i[r]=o:n=!0}var a=Object.keys(i);for(t=[],s=0;s<a.length;s++)t.push({id:a[s],name:i[a[s]]});n&&t.push({value:"",id:"",name:"(Blanks)"})}var l=document.createElement("div");obj.filter.children[e+1].innerHTML="",obj.filter.children[e+1].appendChild(l),obj.filter.children[e+1].style.paddingLeft="0px",obj.filter.children[e+1].style.paddingRight="0px",obj.filter.children[e+1].style.overflow="initial";var c={data:t,multiple:!0,autocomplete:!0,opened:!0,value:void 0!==obj.filters[e]?obj.filters[e]:null,width:"100%",position:1==obj.options.tableOverflow||1==obj.options.fullscreen,onclose:function(t){obj.resetFilters(),obj.filters[e]=t.dropdown.getValue(!0),obj.filter.children[e+1].innerHTML=t.dropdown.getText(),obj.filter.children[e+1].style.paddingLeft="",obj.filter.children[e+1].style.paddingRight="",obj.filter.children[e+1].style.overflow="",obj.closeFilter(e),obj.refreshSelection()}};jSuites.dropdown(l,c)}else console.log("Jspreadsheet: filters not enabled.")},obj.resetFilters=function(){if(obj.options.filters)for(var e=0;e<obj.filter.children.length;e++)obj.filter.children[e].innerHTML="&nbsp;",obj.filters[e]=null;obj.results=null,obj.updateResult()},obj.closeFilter=function(e){if(!e)for(var t=0;t<obj.filter.children.length;t++)obj.filters[t]&&(e=t);var i=function(e,t,i){for(var n=0;n<e.length;n++){var s=""+obj.options.data[i][t],r=""+obj.records[i][t].innerHTML;if(e[n]==s||e[n]==r)return!0}return!1},n=obj.filters[e];obj.results=[];for(var s=0;s<obj.options.data.length;s++)i(n,e,s)&&obj.results.push(s);obj.results.length||(obj.results=null),obj.updateResult()},obj.openEditor=function(e,t,i){var n=e.getAttribute("data-y"),s=e.getAttribute("data-x");obj.dispatch("oneditionstart",el,e,s,n),s>0&&(obj.records[n][s-1].style.overflow="hidden");var r=function(t){var i=e.getBoundingClientRect(),r=document.createElement(t);return r.style.width=i.width+"px",r.style.height=i.height-2+"px",r.style.minHeight=i.height-2+"px",e.classList.add("editor"),e.innerHTML="",e.appendChild(r),obj.dispatch("oncreateeditor",el,e,s,n,r),r};if(1==e.classList.contains("readonly"));else if(obj.edition=[obj.records[n][s],obj.records[n][s].innerHTML,s,n],obj.options.columns[s].editor)obj.options.columns[s].editor.openEditor(e,el,t,i);else if("hidden"==obj.options.columns[s].type);else if("checkbox"==obj.options.columns[s].type||"radio"==obj.options.columns[s].type){var o=!e.children[0].checked;obj.setValue(e,o),obj.edition=null}else if("dropdown"==obj.options.columns[s].type||"autocomplete"==obj.options.columns[s].type){if(o=obj.options.data[n][s],obj.options.columns[s].multiple&&!Array.isArray(o)&&(o=o.split(";")),"function"==typeof obj.options.columns[s].filter)var a=obj.options.columns[s].filter(el,e,s,n,obj.options.columns[s].source);else a=obj.options.columns[s].source;for(var l=[],c=0;c<a.length;c++)l.push(a[c]);var h=r("div"),d={data:l,multiple:!!obj.options.columns[s].multiple,autocomplete:!(!obj.options.columns[s].autocomplete&&"autocomplete"!=obj.options.columns[s].type),opened:!0,value:o,width:"100%",height:h.style.minHeight,position:1==obj.options.tableOverflow||1==obj.options.fullscreen,onclose:function(){obj.closeEditor(e,!0)}};obj.options.columns[s].options&&obj.options.columns[s].options.type&&(d.type=obj.options.columns[s].options.type),jSuites.dropdown(h,d)}else if("calendar"==obj.options.columns[s].type||"color"==obj.options.columns[s].type)o=obj.options.data[n][s],(h=r("input")).value=o,1!=obj.options.tableOverflow&&1!=obj.options.fullscreen||(obj.options.columns[s].options.position=!0),obj.options.columns[s].options.value=obj.options.data[n][s],obj.options.columns[s].options.opened=!0,obj.options.columns[s].options.onclose=function(t,i){obj.closeEditor(e,!0)},"color"==obj.options.columns[s].type?jSuites.color(h,obj.options.columns[s].options):jSuites.calendar(h,obj.options.columns[s].options),h.focus();else if("html"==obj.options.columns[s].type){o=obj.options.data[n][s],(h=r("div")).style.position="relative",(f=document.createElement("div")).classList.add("jexcel_richtext"),h.appendChild(f),jSuites.editor(f,{focus:!0,value:o});var u=e.getBoundingClientRect(),p=f.getBoundingClientRect();window.innerHeight<u.bottom+p.height?f.style.top=u.top-(p.height+2)+"px":f.style.top=u.top+"px"}else if("image"==obj.options.columns[s].type){var f,m=e.children[0];(h=r("div")).style.position="relative",(f=document.createElement("div")).classList.add("jclose"),m&&m.src&&f.appendChild(m),h.appendChild(f),jSuites.image(f,obj.options.imageOptions),u=e.getBoundingClientRect(),p=f.getBoundingClientRect(),window.innerHeight<u.bottom+p.height?f.style.top=u.top-(p.height+2)+"px":f.style.top=u.top+"px"}else{o=1==t?"":obj.options.data[n][s],(h=0==obj.options.columns[s].wordWrap||1!=obj.options.wordWrap&&1!=obj.options.columns[s].wordWrap?r("input"):r("textarea")).focus(),h.value=o,d=obj.options.columns[s];var g=null;if(!isFormula(o)&&(g=getMask(d))){if(!d.disabledMaskOnEdition)if(d.mask){var v=d.mask.split(";");h.setAttribute("data-mask",v[0])}else d.locale&&h.setAttribute("data-locale",d.locale);g.input=h,h.mask=g,jSuites.mask.render(o,g,!1)}h.onblur=function(){obj.closeEditor(e,!0)},h.scrollLeft=h.scrollWidth}},obj.closeEditor=function(e,t){var i=parseInt(e.getAttribute("data-x")),n=parseInt(e.getAttribute("data-y"));if(1==t){if(obj.options.columns[i].editor)var s=obj.options.columns[i].editor.closeEditor(e,t);else if("checkbox"==obj.options.columns[i].type||"radio"==obj.options.columns[i].type||"hidden"==obj.options.columns[i].type);else if("dropdown"==obj.options.columns[i].type||"autocomplete"==obj.options.columns[i].type)s=e.children[0].dropdown.close(!0);else if("calendar"==obj.options.columns[i].type)s=e.children[0].calendar.close(!0);else if("color"==obj.options.columns[i].type)s=e.children[0].color.close(!0);else if("html"==obj.options.columns[i].type)s=e.children[0].children[0].editor.getData();else if("image"==obj.options.columns[i].type){var r=e.children[0].children[0].children[0];s=r&&"IMG"==r.tagName?r.src:""}else if("numeric"==obj.options.columns[i].type)"="!=(""+(s=e.children[0].value)).substr(0,1)&&""==s&&(s=obj.options.columns[i].allowEmpty?"":0),e.children[0].onblur=null;else{s=e.children[0].value,e.children[0].onblur=null;var o,a=obj.options.columns[i];if((o=getMask(a))&&""!==s&&!isFormula(s)&&"number"!=typeof s){var l=jSuites.mask.extract(s,o,!0);l&&""!==l.value&&(s=l.value)}}obj.options.data[n][i]==s?e.innerHTML=obj.edition[1]:obj.setValue(e,s)}else obj.options.columns[i].editor?obj.options.columns[i].editor.closeEditor(e,t):"dropdown"==obj.options.columns[i].type||"autocomplete"==obj.options.columns[i].type?e.children[0].dropdown.close(!0):"calendar"==obj.options.columns[i].type?e.children[0].calendar.close(!0):"color"==obj.options.columns[i].type?e.children[0].color.close(!0):e.children[0].onblur=null,e.innerHTML=obj.edition&&obj.edition[1]?obj.edition[1]:"";obj.dispatch("oneditionend",el,e,i,n,s,t),e.classList.remove("editor"),obj.edition=null},obj.getCell=function(e){var t=(e=jexcel.getIdFromColumnName(e,!0))[0],i=e[1];return obj.records[i][t]},obj.getColumnOptions=function(e,t){var i=obj.options.columns[e];return i||(i={type:"text"}),i},obj.getCellFromCoords=function(e,t){return obj.records[t][e]},obj.getLabel=function(e){var t=(e=jexcel.getIdFromColumnName(e,!0))[0],i=e[1];return obj.records[i][t].innerHTML},obj.getLabelFromCoords=function(e,t){return obj.records[t][e].innerHTML},obj.getValue=function(e,t){if("object"==typeof e)var i=e.getAttribute("data-x"),n=e.getAttribute("data-y");else i=(e=jexcel.getIdFromColumnName(e,!0))[0],n=e[1];var s=null;return null!=i&&null!=n&&(obj.records[n]&&obj.records[n][i]&&(t||1==obj.options.copyCompatibility)?s=obj.records[n][i].innerHTML:obj.options.data[n]&&"undefined"!=obj.options.data[n][i]&&(s=obj.options.data[n][i])),s},obj.getValueFromCoords=function(e,t,i){var n=null;return null!=e&&null!=t&&(obj.records[t]&&obj.records[t][e]&&i||1==obj.options.copyCompatibility?n=obj.records[t][e].innerHTML:obj.options.data[t]&&"undefined"!=obj.options.data[t][e]&&(n=obj.options.data[t][e])),n},obj.setValue=function(e,t,i){var n=[];if("string"==typeof e){var s=(l=jexcel.getIdFromColumnName(e,!0))[0],r=l[1];n.push(obj.updateCell(s,r,t,i)),obj.updateFormulaChain(s,r,n)}else if(s=null,r=null,e&&e.getAttribute&&(s=e.getAttribute("data-x"),r=e.getAttribute("data-y")),null!=s&&null!=r)n.push(obj.updateCell(s,r,t,i)),obj.updateFormulaChain(s,r,n);else{var o=Object.keys(e);if(o.length>0)for(var a=0;a<o.length;a++){var l;"string"==typeof e[a]?(s=(l=jexcel.getIdFromColumnName(e[a],!0))[0],r=l[1]):null!=e[a].x&&null!=e[a].y?(s=e[a].x,r=e[a].y,null!=e[a].newValue?t=e[a].newValue:null!=e[a].value&&(t=e[a].value)):(s=e[a].getAttribute("data-x"),r=e[a].getAttribute("data-y")),null!=s&&null!=r&&(n.push(obj.updateCell(s,r,t,i)),obj.updateFormulaChain(s,r,n))}}obj.setHistory({action:"setValue",records:n,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,n)},obj.setValueFromCoords=function(e,t,i,n){var s=[];s.push(obj.updateCell(e,t,i,n)),obj.updateFormulaChain(e,t,s),obj.setHistory({action:"setValue",records:s,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,s)},obj.setCheckRadioValue=function(){for(var e=[],t=Object.keys(obj.highlighted),i=0;i<t.length;i++){var n=obj.highlighted[i].getAttribute("data-x"),s=obj.highlighted[i].getAttribute("data-y");"checkbox"!=obj.options.columns[n].type&&"radio"!=obj.options.columns[n].type||e.push(obj.updateCell(n,s,!obj.options.data[s][n]))}e.length&&(obj.setHistory({action:"setValue",records:e,selection:obj.selectedCell}),obj.onafterchanges(el,e))};var stripScript=function(e){var t=new Option;t.innerHTML=e;var i=null;for(e=t.getElementsByTagName("script");i=e[0];)i.parentNode.removeChild(i);return t.innerHTML};obj.updateCell=function(e,t,i,n){if(1!=obj.records[t][e].classList.contains("readonly")||n){var s;"="==(""+i).substr(0,1)&&1==obj.options.secureFormulas&&(s=secureFormula(i))!=i&&(i=s),null!=(s=obj.dispatch("onbeforechange",el,obj.records[t][e],e,t,i))&&(i=s),obj.options.columns[e].editor&&"function"==typeof obj.options.columns[e].editor.updateCell&&(i=obj.options.columns[e].editor.updateCell(obj.records[t][e],i,n)),h={x:e,y:t,col:e,row:t,newValue:i,oldValue:obj.options.data[t][e]};let d=obj.options.columns[e].editor;if(d)obj.options.data[t][e]=i,"function"==typeof d.setValue&&d.setValue(obj.records[t][e],i);else if("checkbox"==obj.options.columns[e].type||"radio"==obj.options.columns[e].type){if("radio"==obj.options.columns[e].type)for(var r=0;r<obj.options.data.length;r++)obj.options.data[r][e]=!1;obj.records[t][e].children[0].checked=1==i||1==i||"true"==i||"TRUE"==i,obj.options.data[t][e]=obj.records[t][e].children[0].checked}else if("dropdown"==obj.options.columns[e].type||"autocomplete"==obj.options.columns[e].type)obj.options.data[t][e]=i,obj.records[t][e].textContent=obj.getDropDownValue(e,i);else if("calendar"==obj.options.columns[e].type){var o=null;if(!validDate(i)){var a=jSuites.calendar.extractDateFromString(i,obj.options.columns[e].options.format);a&&(o=a)}obj.options.data[t][e]=i,obj.records[t][e].textContent=jSuites.calendar.getDateString(o||i,obj.options.columns[e].options.format)}else if("color"==obj.options.columns[e].type)if(obj.options.data[t][e]=i,"square"==obj.options.columns[e].render){var l=document.createElement("div");l.className="color",l.style.backgroundColor=i,obj.records[t][e].textContent="",obj.records[t][e].appendChild(l)}else obj.records[t][e].style.color=i,obj.records[t][e].textContent=i;else if("image"==obj.options.columns[e].type){if(i=""+i,obj.options.data[t][e]=i,obj.records[t][e].innerHTML="",i&&"data:image"==i.substr(0,10)){var c=document.createElement("img");c.src=i,obj.records[t][e].appendChild(c)}}else obj.options.data[t][e]=i,"html"==obj.options.columns[e].type?obj.records[t][e].innerHTML=stripScript(obj.parseValue(e,t,i)):!1===obj.options.stripHTML||!1===obj.options.columns[e].stripHTML?obj.records[t][e].innerHTML=stripScript(obj.parseValue(e,t,i,obj.records[t][e])):obj.records[t][e].textContent=obj.parseValue(e,t,i,obj.records[t][e]),0!=obj.options.columns[e].wordWrap&&(1==obj.options.wordWrap||1==obj.options.columns[e].wordWrap||obj.records[t][e].innerHTML.length>200)?obj.records[t][e].style.whiteSpace="pre-wrap":obj.records[t][e].style.whiteSpace="";e>0&&(obj.records[t][e-1].style.overflow=i?"hidden":""),obj.dispatch("onchange",el,obj.records[t]&&obj.records[t][e]?obj.records[t][e]:null,e,t,i,h.oldValue)}else var h={x:e,y:t,col:e,row:t};return h},obj.copyData=function(e,t){var i=obj.getData(!0,!0),n=obj.selectedContainer,s=parseInt(e.getAttribute("data-x")),r=parseInt(e.getAttribute("data-y")),o=parseInt(t.getAttribute("data-x")),a=parseInt(t.getAttribute("data-y")),l=[],c=!1;if(n[0]==s){if(r<n[1])var h=r-n[1];else h=1;var d=0}else d=s<n[0]?s-n[0]:1,h=0;for(var u=0,p=0,f=r;f<=a;f++)if(!obj.rows[f]||"none"!=obj.rows[f].style.display){null==i[p]&&(p=0),u=0,n[0]!=s&&(d=s<n[0]?s-n[0]:1);for(var m=s;m<=o;m++){if(obj.records[f][m]&&!obj.records[f][m].classList.contains("readonly")&&"none"!=obj.records[f][m].style.display&&0==c){if(!obj.selection.length&&""!=obj.options.data[f][m]){c=!0;continue}(null==i[p]||null==i[p][u])&&(u=0);var g=i[p][u];if(g&&!i[1]&&1==obj.options.autoIncrement)if("text"==obj.options.columns[m].type||"number"==obj.options.columns[m].type)if("="==(""+g).substr(0,1)){var v=g.match(/([A-Z]+[0-9]+)/g);if(v){for(var _=[],b=0;b<v.length;b++){var y=jexcel.getIdFromColumnName(v[b],1);y[0]+=d,y[1]+=h,y[1]<0&&(y[1]=0);var C=jexcel.getColumnNameFromId([y[0],y[1]]);C!=v[b]&&(_[v[b]]=C)}_&&(g=obj.updateFormula(g,_))}}else g==Number(g)&&(g=Number(g)+h);else if("calendar"==obj.options.columns[m].type){var w=new Date(g);w.setDate(w.getDate()+h),g=w.getFullYear()+"-"+jexcel.doubleDigitFormat(parseInt(w.getMonth()+1))+"-"+jexcel.doubleDigitFormat(w.getDate())+" 00:00:00"}l.push(obj.updateCell(m,f,g)),obj.updateFormulaChain(m,f,l)}u++,n[0]!=s&&d++}p++,h++}obj.setHistory({action:"setValue",records:l,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,l)},obj.refreshSelection=function(){obj.selectedCell&&obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.conditionalSelectionUpdate=function(e,t,i){if(1==e){if(obj.selectedCell&&(t>=obj.selectedCell[1]&&t<=obj.selectedCell[3]||i>=obj.selectedCell[1]&&i<=obj.selectedCell[3]))return void obj.resetSelection()}else if(obj.selectedCell&&(t>=obj.selectedCell[0]&&t<=obj.selectedCell[2]||i>=obj.selectedCell[0]&&i<=obj.selectedCell[2]))return void obj.resetSelection()},obj.resetSelection=function(e){if(obj.highlighted.length){c=1;for(var t=0;t<obj.highlighted.length;t++){obj.highlighted[t].classList.remove("highlight"),obj.highlighted[t].classList.remove("highlight-left"),obj.highlighted[t].classList.remove("highlight-right"),obj.highlighted[t].classList.remove("highlight-top"),obj.highlighted[t].classList.remove("highlight-bottom"),obj.highlighted[t].classList.remove("highlight-selected");var i=parseInt(obj.highlighted[t].getAttribute("data-x")),n=parseInt(obj.highlighted[t].getAttribute("data-y"));if(obj.highlighted[t].getAttribute("data-merged"))var s=parseInt(obj.highlighted[t].getAttribute("colspan")),r=parseInt(obj.highlighted[t].getAttribute("rowspan")),o=s>0?i+(s-1):i,a=r>0?n+(r-1):n;else o=i,a=n;for(var l=i;l<=o;l++)obj.headers[l]&&obj.headers[l].classList.remove("selected");for(l=n;l<=a;l++)obj.rows[l]&&obj.rows[l].classList.remove("selected")}}else var c=0;return obj.highlighted=[],obj.selectedCell=null,obj.corner.style.top="-2000px",obj.corner.style.left="-2000px",1==e&&1==c&&obj.dispatch("onblur",el),c},obj.updateSelection=function(e,t,i){var n=e.getAttribute("data-x"),s=e.getAttribute("data-y");if(t)var r=t.getAttribute("data-x"),o=t.getAttribute("data-y");else r=n,o=s;obj.updateSelectionFromCoords(n,s,r,o,i)},obj.updateSelectionFromCoords=function(e,t,i,n,s){var r=obj.resetSelection();if(null==t&&(t=0,n=obj.rows.length-1),null==i&&(i=e),null==n&&(n=t),e>=obj.headers.length&&(e=obj.headers.length-1),t>=obj.rows.length&&(t=obj.rows.length-1),i>=obj.headers.length&&(i=obj.headers.length-1),n>=obj.rows.length&&(n=obj.rows.length-1),obj.selectedCell=[e,t,i,n],null!=e){if(obj.records[t][e]&&obj.records[t][e].classList.add("highlight-selected"),parseInt(e)<parseInt(i))var o=parseInt(e),a=parseInt(i);else o=parseInt(i),a=parseInt(e);if(parseInt(t)<parseInt(n))var l=parseInt(t),c=parseInt(n);else l=parseInt(n),c=parseInt(t);for(var h=o;h<=a;h++)for(var d=l;d<=c;d++)if(obj.records[d][h]&&obj.records[d][h].getAttribute("data-merged")){var u=parseInt(obj.records[d][h].getAttribute("data-x")),p=parseInt(obj.records[d][h].getAttribute("data-y")),f=parseInt(obj.records[d][h].getAttribute("colspan")),m=parseInt(obj.records[d][h].getAttribute("rowspan"));f>1&&(u<o&&(o=u),u+f>a&&(a=u+f-1)),m&&(p<l&&(l=p),p+m>c&&(c=p+m-1))}var g=null,v=null,_=null,b=null;for(d=l;d<=c;d++)"none"!=obj.rows[d].style.display&&(null==_&&(_=d),b=d);for(h=o;h<=a;h++){for(d=l;d<=c;d++)"none"!=obj.rows[d].style.display&&"none"!=obj.records[d][h].style.display&&(obj.records[d][h].classList.add("highlight"),obj.highlighted.push(obj.records[d][h]));"hidden"!=obj.options.columns[h].type&&(null==g&&(g=h),v=h)}for(g||(g=0),v||(v=0),h=g;h<=v;h++)"hidden"!=obj.options.columns[h].type&&obj.colgroup[h].style&&"none"!=obj.colgroup[h].style.display&&(obj.records[_]&&obj.records[_][h]&&obj.records[_][h].classList.add("highlight-top"),obj.records[b]&&obj.records[b][h]&&obj.records[b][h].classList.add("highlight-bottom"),obj.headers[h].classList.add("selected"));for(d=_;d<=b;d++)obj.rows[d]&&"none"!=obj.rows[d].style.display&&(obj.records[d][g].classList.add("highlight-left"),obj.records[d][v].classList.add("highlight-right"),obj.rows[d].classList.add("selected"));obj.selectedContainer=[g,_,v,b]}0==r&&(obj.dispatch("onfocus",el),obj.removeCopyingSelection()),obj.dispatch("onselection",el,g,_,v,b,s),obj.updateCornerPosition()},obj.removeCopySelection=function(){for(var e=0;e<obj.selection.length;e++)obj.selection[e].classList.remove("selection"),obj.selection[e].classList.remove("selection-left"),obj.selection[e].classList.remove("selection-right"),obj.selection[e].classList.remove("selection-top"),obj.selection[e].classList.remove("selection-bottom");obj.selection=[]},obj.updateCopySelection=function(e,t){obj.removeCopySelection();var i=obj.selectedContainer[0],n=obj.selectedContainer[1],s=obj.selectedContainer[2],r=obj.selectedContainer[3];if(null!=e&&null!=t){if(e-s>0)var o=parseInt(s)+1,a=parseInt(e);else o=parseInt(e),a=parseInt(i)-1;if(t-r>0)var l=parseInt(r)+1,c=parseInt(t);else l=parseInt(t),c=parseInt(n)-1;a-o<=c-l?(o=parseInt(i),a=parseInt(s)):(l=parseInt(n),c=parseInt(r));for(var h=l;h<=c;h++)for(var d=o;d<=a;d++)obj.records[h][d]&&"none"!=obj.rows[h].style.display&&"none"!=obj.records[h][d].style.display&&(obj.records[h][d].classList.add("selection"),obj.records[l][d].classList.add("selection-top"),obj.records[c][d].classList.add("selection-bottom"),obj.records[h][o].classList.add("selection-left"),obj.records[h][a].classList.add("selection-right"),obj.selection.push(obj.records[h][d]))}},obj.updateCornerPosition=function(){if(obj.highlighted.length){var e=obj.highlighted[obj.highlighted.length-1],t=e.getAttribute("data-x"),i=obj.content.getBoundingClientRect(),n=i.left,s=i.top,r=e.getBoundingClientRect(),o=r.left,a=r.top,l=r.width,c=r.height,h=o-n+obj.content.scrollLeft+l-4,d=a-s+obj.content.scrollTop+c-4;if(obj.corner.style.top=d+"px",obj.corner.style.left=h+"px",obj.options.freezeColumns){var u=obj.getFreezeWidth();t>obj.options.freezeColumns-1&&o-n+l<u?obj.corner.style.display="none":1==obj.options.selectionCopy&&(obj.corner.style.display="")}else 1==obj.options.selectionCopy&&(obj.corner.style.display="")}else obj.corner.style.top="-2000px",obj.corner.style.left="-2000px"},obj.updateScroll=function(e){var t=obj.content.getBoundingClientRect(),i=t.left,n=t.top,s=t.width,r=t.height,o=obj.records[obj.selectedCell[3]][obj.selectedCell[2]].getBoundingClientRect(),a=o.left,l=o.top,c=o.width,h=o.height;if(0==e||1==e)var d=a-i+obj.content.scrollLeft,u=l-n+obj.content.scrollTop-2;else d=a-i+obj.content.scrollLeft+c,u=l-n+obj.content.scrollTop+h;u>obj.content.scrollTop+30&&u<obj.content.scrollTop+r||(u<obj.content.scrollTop+30?obj.content.scrollTop=u-h:obj.content.scrollTop=u-(r-2));var p=obj.getFreezeWidth();d>obj.content.scrollLeft+p&&d<obj.content.scrollLeft+s||(d<obj.content.scrollLeft+30?(obj.content.scrollLeft=d,obj.content.scrollLeft<50&&(obj.content.scrollLeft=0)):d<obj.content.scrollLeft+p?obj.content.scrollLeft=d-p-1:obj.content.scrollLeft=d-(s-20))},obj.getWidth=function(e){if(void 0===e)for(var t=[],i=0;i<obj.headers.length;i++)t.push(obj.options.columns[i].width);else"object"==typeof e&&(e=e.getAttribute("data-x")),t=obj.colgroup[e].getAttribute("width");return t},obj.setWidth=function(e,t,i){if(t){if(Array.isArray(e)){i||(i=[]);for(var n=0;n<e.length;n++){i[n]||(i[n]=obj.colgroup[e[n]].getAttribute("width"));var s=Array.isArray(t)&&t[n]?t[n]:t;obj.colgroup[e[n]].setAttribute("width",s),obj.options.columns[e[n]].width=s}}else i||(i=obj.colgroup[e].getAttribute("width")),obj.colgroup[e].setAttribute("width",t),obj.options.columns[e].width=t;obj.setHistory({action:"setWidth",column:e,oldValue:i,newValue:t}),obj.dispatch("onresizecolumn",el,e,t,i),obj.updateCornerPosition()}},obj.setHeight=function(e,t,i){t>0&&("object"==typeof e&&(e=e.getAttribute("data-y")),i||(i=obj.rows[e].getAttribute("height"))||(i=obj.rows[e].getBoundingClientRect().height),t=parseInt(t),obj.rows[e].style.height=t+"px",obj.options.rows[e]||(obj.options.rows[e]={}),obj.options.rows[e].height=t,obj.setHistory({action:"setHeight",row:e,oldValue:i,newValue:t}),obj.dispatch("onresizerow",el,e,t,i),obj.updateCornerPosition())},obj.getHeight=function(e){if(void 0===e)for(var t=[],i=0;i<obj.rows.length;i++){var n=obj.rows[i].style.height;n&&(t[i]=n)}else"object"==typeof e&&(e=$(e).getAttribute("data-y")),t=obj.rows[e].style.height;return t},obj.setFooter=function(e){if(e&&(obj.options.footers=e),obj.options.footers){obj.tfoot||(obj.tfoot=document.createElement("tfoot"),obj.table.appendChild(obj.tfoot));for(var t=0;t<obj.options.footers.length;t++){if(obj.tfoot.children[t])var i=obj.tfoot.children[t];else{i=document.createElement("tr");var n=document.createElement("td");i.appendChild(n),obj.tfoot.appendChild(i)}for(var s=0;s<obj.headers.length;s++){if(obj.options.footers[t][s]||(obj.options.footers[t][s]=""),obj.tfoot.children[t].children[s+1])n=obj.tfoot.children[t].children[s+1];else{n=document.createElement("td"),i.appendChild(n);var r=obj.options.columns[s].align?obj.options.columns[s].align:"center";n.style.textAlign=r}n.textContent=obj.parseValue(+obj.records.length+s,t,obj.options.footers[t][s]),n.style.display=obj.colgroup[s].style.display}}}},obj.getHeader=function(e){return obj.headers[e].textContent},obj.setHeader=function(e,t){if(obj.headers[e]){var i=obj.headers[e].textContent;t||(t=prompt(obj.options.text.columnName,i)),t&&(obj.headers[e].textContent=t,obj.headers[e].setAttribute("title",t),obj.options.columns[e].title=t),obj.setHistory({action:"setHeader",column:e,oldValue:i,newValue:t}),obj.dispatch("onchangeheader",el,e,i,t)}},obj.getHeaders=function(e){for(var t=[],i=0;i<obj.headers.length;i++)t.push(obj.getHeader(i));return e?t:t.join(obj.options.csvDelimiter)},obj.getMeta=function(e,t){return e?t?obj.options.meta[e]&&obj.options.meta[e][t]?obj.options.meta[e][t]:null:obj.options.meta[e]?obj.options.meta[e]:null:obj.options.meta},obj.setMeta=function(e,t,i){if(obj.options.meta||(obj.options.meta={}),t&&i)obj.options.meta[e]||(obj.options.meta[e]={}),obj.options.meta[e][t]=i;else for(var n=Object.keys(e),s=0;s<n.length;s++){obj.options.meta[n[s]]||(obj.options.meta[n[s]]={});for(var r=Object.keys(e[n[s]]),o=0;o<r.length;o++)obj.options.meta[n[s]][r[o]]=e[n[s]][r[o]]}obj.dispatch("onchangemeta",el,e,t,i)},obj.updateMeta=function(e){if(obj.options.meta){for(var t={},i=Object.keys(obj.options.meta),n=0;n<i.length;n++)e[i[n]]?t[e[i[n]]]=obj.options.meta[i[n]]:t[i[n]]=obj.options.meta[i[n]];obj.options.meta=t}},obj.getStyle=function(e,t){if(e)return e=jexcel.getIdFromColumnName(e,!0),t?obj.records[e[1]][e[0]].style[t]:obj.records[e[1]][e[0]].getAttribute("style");for(var i={},n=obj.options.data[0].length,s=obj.options.data.length,r=0;r<s;r++)for(var o=0;o<n;o++){var a=t?obj.records[r][o].style[t]:obj.records[r][o].getAttribute("style");a&&(i[jexcel.getColumnNameFromId([o,r])]=a)}return i},obj.resetStyle=function(e,t){for(var i=Object.keys(e),n=0;n<i.length;n++){var s=jexcel.getIdFromColumnName(i[n],!0);obj.records[s[1]]&&obj.records[s[1]][s[0]]&&obj.records[s[1]][s[0]].setAttribute("style","")}obj.setStyle(e,null,null,null,t)},obj.setStyle=function(e,t,i,n,s){var r={},o={},a=function(e,t,i){var s=jexcel.getIdFromColumnName(e,!0);if(obj.records[s[1]]&&obj.records[s[1]][s[0]]&&(0==obj.records[s[1]][s[0]].classList.contains("readonly")||n)){var a=obj.records[s[1]][s[0]].style[t];a!=i||n?obj.records[s[1]][s[0]].style[t]=i:(i="",obj.records[s[1]][s[0]].style[t]=""),o[e]||(o[e]=[]),r[e]||(r[e]=[]),o[e].push([t+":"+a]),r[e].push([t+":"+i])}};if(t&&i)if("string"==typeof e)a(e,t,i);else for(var l=[],c=0;c<e.length;c++){var h=e[c].getAttribute("data-x"),d=e[c].getAttribute("data-y"),u=jexcel.getColumnNameFromId([h,d]);l[u]||(a(u,t,i),l[u]=!0)}else{var p=Object.keys(e);for(c=0;c<p.length;c++){var f=e[p[c]];"string"==typeof f&&(f=f.split(";"));for(var m=0;m<f.length;m++)"string"==typeof f[m]&&(f[m]=f[m].split(":")),f[m][0].trim()&&a(p[c],f[m][0].trim(),f[m][1])}}for(p=Object.keys(o),c=0;c<p.length;c++)o[p[c]]=o[p[c]].join(";");for(p=Object.keys(r),c=0;c<p.length;c++)r[p[c]]=r[p[c]].join(";");s||obj.setHistory({action:"setStyle",oldValue:o,newValue:r}),obj.dispatch("onchangestyle",el,e,t,i)},obj.getComments=function(e,t){if(e)return"string"==typeof e&&(e=jexcel.getIdFromColumnName(e,!0)),t?[obj.records[e[1]][e[0]].getAttribute("title"),obj.records[e[1]][e[0]].getAttribute("author")]:obj.records[e[1]][e[0]].getAttribute("title")||"";for(var i={},n=0;n<obj.options.data.length;n++)for(var s=0;s<obj.options.columns.length;s++){var r=obj.records[n][s].getAttribute("title");r&&(i[e=jexcel.getColumnNameFromId([s,n])]=r)}return i},obj.setComments=function(e,t,i){if("string"==typeof e)var n=jexcel.getIdFromColumnName(e,!0);else n=e;var s=obj.records[n[1]][n[0]].getAttribute("title"),r=[s,i=obj.records[n[1]][n[0]].getAttribute("data-author")];obj.records[n[1]][n[0]].setAttribute("title",t||""),obj.records[n[1]][n[0]].setAttribute("data-author",i||""),t?obj.records[n[1]][n[0]].classList.add("jexcel_comments"):obj.records[n[1]][n[0]].classList.remove("jexcel_comments"),obj.setHistory({action:"setComments",column:e,newValue:[t,i],oldValue:r}),obj.dispatch("oncomments",el,t,s,n,n[0],n[1])},obj.getConfig=function(){var e=obj.options;return e.style=obj.getStyle(),e.mergeCells=obj.getMerge(),e.comments=obj.getComments(),e},obj.orderBy=function(e,t){if(e>=0){if(Object.keys(obj.options.mergeCells).length>0){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}t=null==t?obj.headers[e].classList.contains("arrow-down")?1:0:t?1:0;var i=[];if("number"==obj.options.columns[e].type||"numeric"==obj.options.columns[e].type||"percentage"==obj.options.columns[e].type||"autonumber"==obj.options.columns[e].type||"color"==obj.options.columns[e].type)for(var n=0;n<obj.options.data.length;n++)i[n]=[n,Number(obj.options.data[n][e])];else if("calendar"==obj.options.columns[e].type||"checkbox"==obj.options.columns[e].type||"radio"==obj.options.columns[e].type)for(n=0;n<obj.options.data.length;n++)i[n]=[n,obj.options.data[n][e]];else for(n=0;n<obj.options.data.length;n++)i[n]=[n,obj.records[n][e].textContent.toLowerCase()];"function"!=typeof obj.options.sorting&&(obj.options.sorting=function(e){return function(t,i){var n=t[1],s=i[1];return e?""===n&&""!==s?1:""!==n&&""===s||n>s?-1:n<s?1:0:""===n&&""!==s?1:""!==n&&""===s?-1:n>s?1:n<s?-1:0}}),i=i.sort(obj.options.sorting(t));var s=[];for(n=0;n<i.length;n++)s[n]=i[n][0];return obj.setHistory({action:"orderBy",rows:s,column:e,order:t}),obj.updateOrderArrow(e,t),obj.updateOrder(s),obj.dispatch("onsort",el,e,t),!0}},obj.updateOrderArrow=function(e,t){for(var i=0;i<obj.headers.length;i++)obj.headers[i].classList.remove("arrow-up"),obj.headers[i].classList.remove("arrow-down");t?obj.headers[e].classList.add("arrow-up"):obj.headers[e].classList.add("arrow-down")},obj.updateOrder=function(e){for(var t=[],i=0;i<e.length;i++)t[i]=obj.options.data[e[i]];for(obj.options.data=t,t=[],i=0;i<e.length;i++)t[i]=obj.records[e[i]];for(obj.records=t,t=[],i=0;i<e.length;i++)t[i]=obj.rows[e[i]];if(obj.rows=t,obj.updateTableReferences(),obj.results&&obj.results.length)obj.searchInput.value?obj.search(obj.searchInput.value):obj.closeFilter();else if(obj.results=null,obj.pageNumber=0,obj.options.pagination>0)obj.page(0);else if(1==obj.options.lazyLoading)obj.loadPage(0);else for(i=0;i<obj.rows.length;i++)obj.tbody.appendChild(obj.rows[i])},obj.moveRow=function(e,t,i){if(Object.keys(obj.options.mergeCells).length>0){if(e>t)var n=1;else n=0;if(obj.isRowMerged(e).length||obj.isRowMerged(t,n).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if(1==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}i||(Array.prototype.indexOf.call(obj.tbody.children,obj.rows[t])>=0?e>t?obj.tbody.insertBefore(obj.rows[e],obj.rows[t]):obj.tbody.insertBefore(obj.rows[e],obj.rows[t].nextSibling):obj.tbody.removeChild(obj.rows[e])),obj.rows.splice(t,0,obj.rows.splice(e,1)[0]),obj.records.splice(t,0,obj.records.splice(e,1)[0]),obj.options.data.splice(t,0,obj.options.data.splice(e,1)[0]),obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.setHistory({action:"moveRow",oldValue:e,newValue:t}),obj.updateTableReferences(),obj.dispatch("onmoverow",el,e,t)},obj.insertRow=function(e,t,i){if(1==obj.options.allowInsertRow){var n=[];if(e>0)var s=e;else s=1,e&&(n=e);i=!!i;var r=obj.options.data.length-1;if((null==t||t>=parseInt(r)||t<0)&&(t=r),!1===obj.dispatch("onbeforeinsertrow",el,t,s,i))return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isRowMerged(t,i).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(1==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(var o=i?t:t+1,a=obj.records.splice(o),l=obj.options.data.splice(o),c=obj.rows.splice(o),h=[],d=[],u=[],p=o;p<s+o;p++){obj.options.data[p]=[];for(var f=0;f<obj.options.columns.length;f++)obj.options.data[p][f]=n[f]?n[f]:"";var m=obj.createRow(p,obj.options.data[p]);c[0]?Array.prototype.indexOf.call(obj.tbody.children,c[0])>=0&&obj.tbody.insertBefore(m,c[0]):Array.prototype.indexOf.call(obj.tbody.children,obj.rows[t])>=0&&obj.tbody.appendChild(m),h.push(obj.records[p]),d.push(obj.options.data[p]),u.push(m)}Array.prototype.push.apply(obj.records,a),Array.prototype.push.apply(obj.options.data,l),Array.prototype.push.apply(obj.rows,c),obj.options.pagination>0&&obj.page(obj.pageNumber),obj.setHistory({action:"insertRow",rowNumber:t,numOfRows:s,insertBefore:i,rowRecords:h,rowData:d,rowNode:u}),obj.updateTableReferences(),obj.dispatch("oninsertrow",el,t,s,h,i)}},obj.deleteRow=function(e,t){if(1==obj.options.allowDeleteRow)if(1==obj.options.allowDeletingAllRows||obj.options.data.length>1){if(null==e){var i=obj.getSelectedRows();i[0]?(e=parseInt(i[0].getAttribute("data-y")),t=i.length):(e=obj.options.data.length-1,t=1)}var n=obj.options.data.length-1;if((null==e||e>n||e<0)&&(e=n),t||(t=1),e+t>=obj.options.data.length&&(t=obj.options.data.length-e),!1===obj.dispatch("onbeforedeleterow",el,e,t))return!1;if(parseInt(e)>-1){var s=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var r=e;r<e+t;r++)obj.isRowMerged(r,!1).length&&(s=!0);if(s){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(1==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(0==obj.options.allowDeletingAllRows&&n+1===t&&(t--,console.error("Jspreadsheet: It is not possible to delete the last row")),r=e;r<e+t;r++)Array.prototype.indexOf.call(obj.tbody.children,obj.rows[r])>=0&&(obj.rows[r].className="",obj.rows[r].parentNode.removeChild(obj.rows[r]));var o=obj.records.splice(e,t),a=obj.options.data.splice(e,t),l=obj.rows.splice(e,t);obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.conditionalSelectionUpdate(1,e,e+t-1),obj.setHistory({action:"deleteRow",rowNumber:e,numOfRows:t,insertBefore:1,rowRecords:o,rowData:a,rowNode:l}),obj.updateTableReferences(),obj.dispatch("ondeleterow",el,e,t,o)}}else console.error("Jspreadsheet: It is not possible to delete the last row")},obj.moveColumn=function(e,t){if(Object.keys(obj.options.mergeCells).length>0){if(e>t)var i=1;else i=0;if(obj.isColMerged(e).length||obj.isColMerged(t,i).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if((e=parseInt(e))>(t=parseInt(t))){obj.headerContainer.insertBefore(obj.headers[e],obj.headers[t]),obj.colgroupContainer.insertBefore(obj.colgroup[e],obj.colgroup[t]);for(var n=0;n<obj.rows.length;n++)obj.rows[n].insertBefore(obj.records[n][e],obj.records[n][t])}else for(obj.headerContainer.insertBefore(obj.headers[e],obj.headers[t].nextSibling),obj.colgroupContainer.insertBefore(obj.colgroup[e],obj.colgroup[t].nextSibling),n=0;n<obj.rows.length;n++)obj.rows[n].insertBefore(obj.records[n][e],obj.records[n][t].nextSibling);for(obj.options.columns.splice(t,0,obj.options.columns.splice(e,1)[0]),obj.headers.splice(t,0,obj.headers.splice(e,1)[0]),obj.colgroup.splice(t,0,obj.colgroup.splice(e,1)[0]),n=0;n<obj.rows.length;n++)obj.options.data[n].splice(t,0,obj.options.data[n].splice(e,1)[0]),obj.records[n].splice(t,0,obj.records[n].splice(e,1)[0]);if(obj.options.footers)for(n=0;n<obj.options.footers.length;n++)obj.options.footers[n].splice(t,0,obj.options.footers[n].splice(e,1)[0]);obj.setHistory({action:"moveColumn",oldValue:e,newValue:t}),obj.updateTableReferences(),obj.dispatch("onmovecolumn",el,e,t)},obj.insertColumn=function(e,t,i,n){if(1==obj.options.allowInsertColumn){var s=[];if(e>0)var r=e;else r=1,e&&(s=e);i=!!i;var o=obj.options.columns.length-1;if((null==t||t>=parseInt(o)||t<0)&&(t=o),!1===obj.dispatch("onbeforeinsertcolumn",el,t,r,i))return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isColMerged(t,i).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}n||(n=[]);for(var a=0;a<r;a++)n[a]||(n[a]={type:"text",source:[],options:[],width:obj.options.defaultColWidth,align:obj.options.defaultColAlign});var l=i?t:t+1;obj.options.columns=jexcel.injectArray(obj.options.columns,l,n);for(var c=obj.headers.splice(l),h=obj.colgroup.splice(l),d=[],u=[],p=[],f=[],m=[],g=l;g<r+l;g++)obj.createCellHeader(g),obj.headerContainer.insertBefore(obj.headers[g],obj.headerContainer.children[g+1]),obj.colgroupContainer.insertBefore(obj.colgroup[g],obj.colgroupContainer.children[g+1]),d.push(obj.headers[g]),u.push(obj.colgroup[g]);if(obj.options.footers)for(var v=0;v<obj.options.footers.length;v++){for(m[v]=[],a=0;a<r;a++)m[v].push("");obj.options.footers[v].splice(l,0,m[v])}for(var _=0;_<obj.options.data.length;_++){var b=obj.options.data[_].splice(l),y=obj.records[_].splice(l);for(f[_]=[],p[_]=[],g=l;g<r+l;g++){var C=s[_]?s[_]:"";obj.options.data[_][g]=C;var w=obj.createCell(g,_,obj.options.data[_][g]);obj.records[_][g]=w,obj.rows[_]&&obj.rows[_].insertBefore(w,obj.rows[_].children[g+1]),f[_].push(C),p[_].push(w)}Array.prototype.push.apply(obj.options.data[_],b),Array.prototype.push.apply(obj.records[_],y)}if(Array.prototype.push.apply(obj.headers,c),Array.prototype.push.apply(obj.colgroup,h),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(v=0;v<obj.options.nestedHeaders.length;v++){var S=parseInt(obj.options.nestedHeaders[v][obj.options.nestedHeaders[v].length-1].colspan)+r;obj.options.nestedHeaders[v][obj.options.nestedHeaders[v].length-1].colspan=S,obj.thead.children[v].children[obj.thead.children[v].children.length-1].setAttribute("colspan",S);var E=obj.thead.children[v].children[obj.thead.children[v].children.length-1].getAttribute("data-column");for(E=E.split(","),g=l;g<r+l;g++)E.push(g);obj.thead.children[v].children[obj.thead.children[v].children.length-1].setAttribute("data-column",E)}else S=parseInt(obj.options.nestedHeaders[0].colspan)+r,obj.options.nestedHeaders[0].colspan=S,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",S);obj.setHistory({action:"insertColumn",columnNumber:t,numOfColumns:r,insertBefore:i,columns:n,headers:d,colgroup:u,records:p,footers:m,data:f}),obj.updateTableReferences(),obj.dispatch("oninsertcolumn",el,t,r,p,i)}},obj.deleteColumn=function(e,t){if(1==obj.options.allowDeleteColumn)if(obj.headers.length>1){if(null==e){var i=obj.getSelectedColumns(!0);i.length?(e=parseInt(i[0]),t=parseInt(i.length)):(e=obj.headers.length-1,t=1)}var n=obj.options.data[0].length-1;if((null==e||e>n||e<0)&&(e=n),t||(t=1),t>obj.options.data[0].length-e&&(t=obj.options.data[0].length-e),!1===obj.dispatch("onbeforedeletecolumn",el,e,t))return!1;if(parseInt(e)>-1){var s=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var r=e;r<e+t;r++)obj.isColMerged(r,!1).length&&(s=!0);if(s){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}var o=obj.options.columns.splice(e,t);for(r=e;r<e+t;r++)obj.colgroup[r].className="",obj.headers[r].className="",obj.colgroup[r].parentNode.removeChild(obj.colgroup[r]),obj.headers[r].parentNode.removeChild(obj.headers[r]);for(var a=obj.headers.splice(e,t),l=obj.colgroup.splice(e,t),c=[],h=[],d=[],u=0;u<obj.options.data.length;u++)for(r=e;r<e+t;r++)obj.records[u][r].className="",obj.records[u][r].parentNode.removeChild(obj.records[u][r]);for(u=0;u<obj.options.data.length;u++)h[u]=obj.options.data[u].splice(e,t),c[u]=obj.records[u].splice(e,t);if(obj.options.footers)for(u=0;u<obj.options.footers.length;u++)d[u]=obj.options.footers[u].splice(e,t);if(obj.conditionalSelectionUpdate(0,e,e+t-1),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var p=0;p<obj.options.nestedHeaders.length;p++){var f=parseInt(obj.options.nestedHeaders[p][obj.options.nestedHeaders[p].length-1].colspan)-t;obj.options.nestedHeaders[p][obj.options.nestedHeaders[p].length-1].colspan=f,obj.thead.children[p].children[obj.thead.children[p].children.length-1].setAttribute("colspan",f)}else f=parseInt(obj.options.nestedHeaders[0].colspan)-t,obj.options.nestedHeaders[0].colspan=f,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",f);obj.setHistory({action:"deleteColumn",columnNumber:e,numOfColumns:t,insertBefore:1,columns:o,headers:a,colgroup:l,records:c,footers:d,data:h}),obj.updateTableReferences(),obj.dispatch("ondeletecolumn",el,e,t,c)}}else console.error("Jspreadsheet: It is not possible to delete the last column")},obj.getSelectedRows=function(e){for(var t=[],i=0;i<obj.rows.length;i++)obj.rows[i].classList.contains("selected")&&(e?t.push(i):t.push(obj.rows[i]));return t},obj.getSelectedColumns=function(){for(var e=[],t=0;t<obj.headers.length;t++)obj.headers[t].classList.contains("selected")&&e.push(t);return e},obj.getHighlighted=function(){return obj.highlighted},obj.updateTableReferences=function(){for(var e=0;e<obj.headers.length;e++)(r=obj.headers[e].getAttribute("data-x"))!=e&&(obj.headers[e].setAttribute("data-x",e),obj.headers[e].getAttribute("title")||(obj.headers[e].innerHTML=jexcel.getColumnName(e)));for(var t=0;t<obj.rows.length;t++)obj.rows[t]&&(o=obj.rows[t].getAttribute("data-y"))!=t&&(obj.rows[t].setAttribute("data-y",t),obj.rows[t].children[0].setAttribute("data-y",t),obj.rows[t].children[0].innerHTML=t+1);var i=[],n=[],s=function(e,t,n,s){if(e!=n&&obj.records[s][n].setAttribute("data-x",n),t!=s&&obj.records[s][n].setAttribute("data-y",s),e!=n||t!=s){var r=jexcel.getColumnNameFromId([e,t]),o=jexcel.getColumnNameFromId([n,s]);i[r]=o}};for(t=0;t<obj.records.length;t++)for(e=0;e<obj.records[0].length;e++)if(obj.records[t][e]){var r=obj.records[t][e].getAttribute("data-x"),o=obj.records[t][e].getAttribute("data-y");if(obj.records[t][e].getAttribute("data-merged")){var a=jexcel.getColumnNameFromId([r,o]),l=jexcel.getColumnNameFromId([e,t]);if(null==n[a])if(a==l)n[a]=!1;else{var c=parseInt(e-r),h=parseInt(t-o);n[a]=[l,c,h]}}else s(r,o,e,t)}var d=Object.keys(n);if(d.length)for(e=0;e<d.length;e++)if(n[d[e]]){var u=jexcel.getIdFromColumnName(d[e],!0);for(s(r=u[0],o=u[1],r+n[d[e]][1],o+n[d[e]][2]),a=d[e],l=n[d[e]][0],t=0;t<obj.options.mergeCells[a][2].length;t++)r=parseInt(obj.options.mergeCells[a][2][t].getAttribute("data-x")),o=parseInt(obj.options.mergeCells[a][2][t].getAttribute("data-y")),obj.options.mergeCells[a][2][t].setAttribute("data-x",r+n[d[e]][1]),obj.options.mergeCells[a][2][t].setAttribute("data-y",o+n[d[e]][2]);obj.options.mergeCells[l]=obj.options.mergeCells[a],delete obj.options.mergeCells[a]}obj.updateFormulas(i),obj.updateMeta(i),obj.refreshSelection(),obj.updateTable()},obj.updateTable=function(){if(obj.options.minSpareRows>0){for(var e=0,t=obj.rows.length-1;t>=0;t--){for(var i=!1,n=0;n<obj.headers.length;n++)obj.options.data[t][n]&&(i=!0);if(i)break;e++}obj.options.minSpareRows-e>0&&obj.insertRow(obj.options.minSpareRows-e)}if(obj.options.minSpareCols>0){var s=0;for(n=obj.headers.length-1;n>=0;n--){for(i=!1,t=0;t<obj.rows.length;t++)obj.options.data[t][n]&&(i=!0);if(i)break;s++}obj.options.minSpareCols-s>0&&obj.insertColumn(obj.options.minSpareCols-s)}if("function"==typeof obj.options.updateTable){for(obj.options.detachForUpdates&&el.removeChild(obj.content),t=0;t<obj.rows.length;t++)for(n=0;n<obj.headers.length;n++)obj.options.updateTable(el,obj.records[t][n],n,t,obj.options.data[t][n],obj.records[t][n].textContent,jexcel.getColumnNameFromId([n,t]));obj.options.detachForUpdates&&el.insertBefore(obj.content,obj.pagination)}obj.options.footers&&obj.setFooter(),setTimeout((function(){obj.updateCornerPosition()}),0)},obj.isReadOnly=function(e){if(e=obj.getCell(e))return!!e.classList.contains("readonly")},obj.setReadOnly=function(e,t){(e=obj.getCell(e))&&(t?e.classList.add("readonly"):e.classList.remove("readonly"))},obj.showRow=function(e){obj.rows[e].style.display=""},obj.hideRow=function(e){obj.rows[e].style.display="none"},obj.showColumn=function(e){obj.headers[e].style.display="",obj.colgroup[e].style.display="",obj.filter&&obj.filter.children.length>e+1&&(obj.filter.children[e+1].style.display="");for(var t=0;t<obj.options.data.length;t++)obj.records[t][e].style.display="";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.hideColumn=function(e){obj.headers[e].style.display="none",obj.colgroup[e].style.display="none",obj.filter&&obj.filter.children.length>e+1&&(obj.filter.children[e+1].style.display="none");for(var t=0;t<obj.options.data.length;t++)obj.records[t][e].style.display="none";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.showIndex=function(){obj.table.classList.remove("jexcel_hidden_index")},obj.hideIndex=function(){obj.table.classList.add("jexcel_hidden_index")};var chainLoopProtection=[];obj.updateFormulaChain=function(e,t,i){var n=jexcel.getColumnNameFromId([e,t]);if(obj.formula[n]&&obj.formula[n].length>0)if(chainLoopProtection[n])obj.records[t][e].innerHTML="#ERROR",obj.formula[n]="";else{chainLoopProtection[n]=!0;for(var s=0;s<obj.formula[n].length;s++){var r=jexcel.getIdFromColumnName(obj.formula[n][s],!0),o=""+obj.options.data[r[1]][r[0]];"="==o.substr(0,1)?i.push(obj.updateCell(r[0],r[1],o,!0)):Object.keys(obj.formula)[s]=null,obj.updateFormulaChain(r[0],r[1],i)}}chainLoopProtection=[]},obj.updateFormulas=function(e){for(var t=0;t<obj.options.data.length;t++)for(var i=0;i<obj.options.data[0].length;i++)if("="==(a=""+obj.options.data[t][i]).substr(0,1)){var n=obj.updateFormula(a,e);n!=a&&(obj.options.data[t][i]=n)}var s=[],r=Object.keys(obj.formula);for(t=0;t<r.length;t++){var o=r[t],a=obj.formula[o];for(e[o]&&(o=e[o]),s[o]=[],i=0;i<a.length;i++){var l=a[i];e[l]&&(l=e[l]),s[o].push(l)}}obj.formula=s},obj.updateFormula=function(e,t){for(var i=/[A-Z]/,n=/[0-9]/,s="",r=null,o=null,a="",l=0;l<e.length;l++)i.exec(e[l])?(r=1,o=0,a+=e[l]):n.exec(e[l])?(o=r?1:0,a+=e[l]):(r&&o&&(a=t[a]?t[a]:a),s+=a,s+=e[l],r=0,o=0,a="");return a&&(r&&o&&(a=t[a]?t[a]:a),s+=a),s};var secureFormula=function(e){for(var t="",i=0,n=0;n<e.length;n++)'"'==e[n]&&(i=0==i?1:0),t+=1==i?e[n]:e[n].toUpperCase();return t};obj.executeFormula=function(expression,x,y){var formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){var parentId=jexcel.getColumnNameFromId([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;var tokensUpdate=function(e){for(var t=0;t<e.length;t++){var i=[],n=e[t].split(":"),s=jexcel.getIdFromColumnName(n[0],!0),r=jexcel.getIdFromColumnName(n[1],!0);if(s[0]<=r[0])var o=s[0],a=r[0];else o=r[0],a=s[0];if(s[1]<=r[1])var l=s[1],c=r[1];else l=r[1],c=s[1];for(var h=l;h<=c;h++)for(var d=o;d<=a;d++)i.push(jexcel.getColumnNameFromId([d,h]));expression=expression.replace(e[t],i.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");var tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);tokens&&tokens.length&&tokensUpdate(tokens);var tokens=expression.match(/([A-Z]+[0-9]+)/g);if(tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";var formulaExpressions={};if(tokens)for(var i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){var position=jexcel.getIdFromColumnName(tokens[i],1);if(void 0!==obj.options.data[position[1]]&&void 0!==obj.options.data[position[1]][position[0]])var value=obj.options.data[position[1]][position[0]];else var value="";if("="==(""+value).substr(0,1)&&(void 0!==formulaResults[tokens[i]]?value=formulaResults[tokens[i]]:(value=execute(value,position[0],position[1]),formulaResults[tokens[i]]=value)),""==(""+value).trim())formulaExpressions[tokens[i]]=null;else if(value==Number(value)&&1==obj.options.autoCasting)formulaExpressions[tokens[i]]=Number(value);else{var number=obj.parseNumber(value,position[0]);1==obj.options.autoCasting&&number?formulaExpressions[tokens[i]]=number:formulaExpressions[tokens[i]]='"'+value+'"'}}try{var res=jexcel.formula(expression.substr(1),formulaExpressions,x,y,obj)}catch(e){var res="#ERROR";console.log(e)}return res};return execute(expression,x,y)},obj.parseNumber=function(e,t){var i=t&&obj.options.columns[t].decimal?obj.options.columns[t].decimal:".",n=""+e;return(n=n.split(i))[0]=n[0].match(/[+-]?[0-9]/g),n[0]&&(n[0]=n[0].join("")),n[1]&&(n[1]=n[1].match(/[0-9]*/g).join("")),n[0]&&Number.isInteger(Number(n[0]))?n[1]?Number(n[0]+"."+n[1]):Number(n[0]+".00"):null},obj.row=function(e){},obj.col=function(e){},obj.up=function(e,t){if(e?obj.selectedCell[3]>0&&obj.up.visible(1,t?0:1):(obj.selectedCell[1]>0&&obj.up.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),1==obj.options.lazyLoading)if(0==obj.selectedCell[1]||0==obj.selectedCell[3])obj.loadPage(0),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else if(obj.loadValidation())obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else{var i=parseInt(obj.tbody.firstChild.getAttribute("data-y"));obj.selectedCell[1]-i<30&&(obj.loadUp(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]))}else if(obj.options.pagination>0){var n=obj.whichPage(obj.selectedCell[3]);n!=obj.pageNumber&&obj.page(n)}obj.updateScroll(1)},obj.up.visible=function(e,t){if(0==e)var i=parseInt(obj.selectedCell[0]),n=parseInt(obj.selectedCell[1]);else i=parseInt(obj.selectedCell[2]),n=parseInt(obj.selectedCell[3]);if(0==t){for(var s=0;s<n;s++)if("none"!=obj.records[s][i].style.display&&"none"!=obj.rows[s].style.display){n=s;break}}else n=obj.up.get(i,n);0==e?(obj.selectedCell[0]=i,obj.selectedCell[1]=n):(obj.selectedCell[2]=i,obj.selectedCell[3]=n)},obj.up.get=function(e,t){e=parseInt(e);for(var i=(t=parseInt(t))-1;i>=0;i--)if("none"!=obj.records[i][e].style.display&&"none"!=obj.rows[i].style.display){if(obj.records[i][e].getAttribute("data-merged")&&obj.records[i][e]==obj.records[t][e])continue;t=i;break}return t},obj.down=function(e,t){if(e?obj.selectedCell[3]<obj.records.length-1&&obj.down.visible(1,t?0:1):(obj.selectedCell[1]<obj.records.length-1&&obj.down.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),1==obj.options.lazyLoading)obj.selectedCell[1]==obj.records.length-1||obj.selectedCell[3]==obj.records.length-1?(obj.loadPage(-1),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])):obj.loadValidation()?obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]):parseInt(obj.tbody.lastChild.getAttribute("data-y"))-obj.selectedCell[3]<30&&(obj.loadDown(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]));else if(obj.options.pagination>0){var i=obj.whichPage(obj.selectedCell[3]);i!=obj.pageNumber&&obj.page(i)}obj.updateScroll(3)},obj.down.visible=function(e,t){if(0==e)var i=parseInt(obj.selectedCell[0]),n=parseInt(obj.selectedCell[1]);else i=parseInt(obj.selectedCell[2]),n=parseInt(obj.selectedCell[3]);if(0==t){for(var s=obj.rows.length-1;s>n;s--)if("none"!=obj.records[s][i].style.display&&"none"!=obj.rows[s].style.display){n=s;break}}else n=obj.down.get(i,n);0==e?(obj.selectedCell[0]=i,obj.selectedCell[1]=n):(obj.selectedCell[2]=i,obj.selectedCell[3]=n)},obj.down.get=function(e,t){e=parseInt(e);for(var i=(t=parseInt(t))+1;i<obj.rows.length;i++)if("none"!=obj.records[i][e].style.display&&"none"!=obj.rows[i].style.display){if(obj.records[i][e].getAttribute("data-merged")&&obj.records[i][e]==obj.records[t][e])continue;t=i;break}return t},obj.right=function(e,t){e?obj.selectedCell[2]<obj.headers.length-1&&obj.right.visible(1,t?0:1):(obj.selectedCell[0]<obj.headers.length-1&&obj.right.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(2)},obj.right.visible=function(e,t){if(0==e)var i=parseInt(obj.selectedCell[0]),n=parseInt(obj.selectedCell[1]);else i=parseInt(obj.selectedCell[2]),n=parseInt(obj.selectedCell[3]);if(0==t){for(var s=obj.headers.length-1;s>i;s--)if("none"!=obj.records[n][s].style.display){i=s;break}}else i=obj.right.get(i,n);0==e?(obj.selectedCell[0]=i,obj.selectedCell[1]=n):(obj.selectedCell[2]=i,obj.selectedCell[3]=n)},obj.right.get=function(e,t){e=parseInt(e),t=parseInt(t);for(var i=e+1;i<obj.headers.length;i++)if("none"!=obj.records[t][i].style.display){if(obj.records[t][i].getAttribute("data-merged")&&obj.records[t][i]==obj.records[t][e])continue;e=i;break}return e},obj.left=function(e,t){e?obj.selectedCell[2]>0&&obj.left.visible(1,t?0:1):(obj.selectedCell[0]>0&&obj.left.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(0)},obj.left.visible=function(e,t){if(0==e)var i=parseInt(obj.selectedCell[0]),n=parseInt(obj.selectedCell[1]);else i=parseInt(obj.selectedCell[2]),n=parseInt(obj.selectedCell[3]);if(0==t){for(var s=0;s<i;s++)if("none"!=obj.records[n][s].style.display){i=s;break}}else i=obj.left.get(i,n);0==e?(obj.selectedCell[0]=i,obj.selectedCell[1]=n):(obj.selectedCell[2]=i,obj.selectedCell[3]=n)},obj.left.get=function(e,t){e=parseInt(e),t=parseInt(t);for(var i=e-1;i>=0;i--)if("none"!=obj.records[t][i].style.display){if(obj.records[t][i].getAttribute("data-merged")&&obj.records[t][i]==obj.records[t][e])continue;e=i;break}return e},obj.first=function(e,t){if(e?t?obj.selectedCell[3]=0:obj.left.visible(1,0):(t?obj.selectedCell[1]=0:obj.left.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),1!=obj.options.lazyLoading||0!=obj.selectedCell[1]&&0!=obj.selectedCell[3]){if(obj.options.pagination>0){var i=obj.whichPage(obj.selectedCell[3]);i!=obj.pageNumber&&obj.page(i)}}else obj.loadPage(0);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(1)},obj.last=function(e,t){if(e?t?obj.selectedCell[3]=obj.records.length-1:obj.right.visible(1,0):(t?obj.selectedCell[1]=obj.records.length-1:obj.right.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),1!=obj.options.lazyLoading||obj.selectedCell[1]!=obj.records.length-1&&obj.selectedCell[3]!=obj.records.length-1){if(obj.options.pagination>0){var i=obj.whichPage(obj.selectedCell[3]);i!=obj.pageNumber&&obj.page(i)}}else obj.loadPage(-1);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(3)},obj.selectAll=function(){obj.selectedCell||(obj.selectedCell=[]),obj.selectedCell[0]=0,obj.selectedCell[1]=0,obj.selectedCell[2]=obj.headers.length-1,obj.selectedCell[3]=obj.records.length-1,obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.loadPage=function(e){if(1!=obj.options.search&&1!=obj.options.filters||!obj.results)t=obj.rows;else var t=obj.results;var i=100;null!=e&&-1!=e||(e=Math.ceil(t.length/i)-1);var n=e*i,s=e*i+i;s>t.length&&(s=t.length),(n=s-100)<0&&(n=0);for(var r=n;r<s;r++)1!=obj.options.search&&1!=obj.options.filters||!obj.results?obj.tbody.appendChild(obj.rows[r]):obj.tbody.appendChild(obj.rows[t[r]]),obj.tbody.children.length>i&&obj.tbody.removeChild(obj.tbody.firstChild)},obj.loadUp=function(){if(1!=obj.options.search&&1!=obj.options.filters||!obj.results)e=obj.rows;else var e=obj.results;var t=0;if(e.length>100){var i=parseInt(obj.tbody.firstChild.getAttribute("data-y"));if(1!=obj.options.search&&1!=obj.options.filters||!obj.results||(i=e.indexOf(i)),i>0)for(var n=0;n<30;n++)(i-=1)>-1&&(1!=obj.options.search&&1!=obj.options.filters||!obj.results?obj.tbody.insertBefore(obj.rows[i],obj.tbody.firstChild):obj.tbody.insertBefore(obj.rows[e[i]],obj.tbody.firstChild),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.lastChild),t=1))}return t},obj.loadDown=function(){if(1!=obj.options.search&&1!=obj.options.filters||!obj.results)e=obj.rows;else var e=obj.results;var t=0;if(e.length>100){var i=parseInt(obj.tbody.lastChild.getAttribute("data-y"));if(1!=obj.options.search&&1!=obj.options.filters||!obj.results||(i=e.indexOf(i)),i<obj.rows.length-1)for(var n=0;n<=30;n++)i<e.length&&(1!=obj.options.search&&1!=obj.options.filters||!obj.results?obj.tbody.appendChild(obj.rows[i]):obj.tbody.appendChild(obj.rows[e[i]]),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.firstChild),t=1)),i+=1}return t},obj.loadValidation=function(){if(obj.selectedCell){var e=parseInt(obj.tbody.firstChild.getAttribute("data-y"))/100,t=parseInt(obj.selectedCell[3]/100),i=parseInt(obj.rows.length/100);if(e!=t&&t<=i&&!Array.prototype.indexOf.call(obj.tbody.children,obj.rows[obj.selectedCell[3]]))return obj.loadPage(t),!0}return!1},obj.resetSearch=function(){obj.searchInput.value="",obj.search(""),obj.results=null},obj.search=function(e){if(obj.options.filters&&obj.resetFilters(),obj.resetSelection(),obj.pageNumber=0,obj.results=[],e){var t=function(e){-1==obj.results.indexOf(e)&&obj.results.push(e)},i=e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");i=new RegExp(i,"i"),obj.options.data.forEach((function(e,n){if(function(e,t,i){for(var n=0;n<e.length;n++)if((""+e[n]).toLowerCase().search(t)>=0||(""+obj.records[i][n].innerHTML).toLowerCase().search(t)>=0)return!0;return!1}(e,i,n)){var s=obj.isRowMerged(n);if(s.length)for(var r=0;r<s.length;r++)for(var o=jexcel.getIdFromColumnName(s[r],!0),a=0;a<obj.options.mergeCells[s[r]][1];a++)t(o[1]+a);else t(n)}}))}else obj.results=null;return obj.updateResult()},obj.updateResult=function(){var e,t=0;for(e=1==obj.options.lazyLoading?100:obj.options.pagination>0?obj.options.pagination:obj.results?obj.results.length:obj.rows.length;obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var i=0;i<obj.rows.length;i++)!obj.results||obj.results.indexOf(i)>-1?(t<e&&(obj.tbody.appendChild(obj.rows[i]),t++),obj.rows[i].style.display=""):obj.rows[i].style.display="none";return obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),e},obj.whichPage=function(e){return 1!=obj.options.search&&1!=obj.options.filters||!obj.results||(e=obj.results.indexOf(e)),Math.ceil((parseInt(e)+1)/parseInt(obj.options.pagination))-1},obj.page=function(e){var t=obj.pageNumber;if(1!=obj.options.search&&1!=obj.options.filters||!obj.results)i=obj.rows;else var i=obj.results;var n=parseInt(obj.options.pagination);null!=e&&-1!=e||(e=Math.ceil(i.length/n)-1),obj.pageNumber=e;var s=e*n,r=e*n+n;for(r>i.length&&(r=i.length),s<0&&(s=0);obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var o=s;o<r;o++)1!=obj.options.search&&1!=obj.options.filters||!obj.results?obj.tbody.appendChild(obj.rows[o]):obj.tbody.appendChild(obj.rows[i[o]]);obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),obj.dispatch("onchangepage",el,e,t)},obj.updatePagination=function(){if(obj.pagination.children[0].innerHTML="",obj.pagination.children[1].innerHTML="",obj.options.pagination){if(1!=obj.options.search&&1!=obj.options.filters||!obj.results)e=obj.rows.length;else var e=obj.results.length;if(e){var t=Math.ceil(e/obj.options.pagination);if(obj.pageNumber<6)var i=1,n=t<10?t:10;else t-obj.pageNumber<5?(n=t,(i=t-9)<1&&(i=1)):(i=obj.pageNumber-4,n=obj.pageNumber+5);i>1&&((r=document.createElement("div")).className="jexcel_page",r.innerHTML="<",r.title=1,obj.pagination.children[1].appendChild(r));for(var s=i;s<=n;s++){var r;(r=document.createElement("div")).className="jexcel_page",r.innerHTML=s,obj.pagination.children[1].appendChild(r),obj.pageNumber==s-1&&r.classList.add("jexcel_page_selected")}n<t&&((r=document.createElement("div")).className="jexcel_page",r.innerHTML=">",r.title=t,obj.pagination.children[1].appendChild(r)),obj.pagination.children[0].innerHTML=function(e){var t=Array.prototype.slice.call(arguments,1);return e.replace(/{(\d+)}/g,(function(e,i){return void 0!==t[i]?t[i]:e}))}(obj.options.text.showingPage,obj.pageNumber+1,t)}else obj.pagination.children[0].innerHTML=obj.options.text.noRecordsFound}},obj.download=function(e){if(0==obj.options.allowExport)console.error("Export not allowed");else{var t="";t+=obj.copy(!1,obj.options.csvDelimiter,!0,e,!0);var i=new Blob(["\ufeff"+t],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(i,obj.options.csvFileName+".csv");else{var n=document.createElement("a"),s=URL.createObjectURL(i);n.href=s,n.setAttribute("download",obj.options.csvFileName+".csv"),document.body.appendChild(n),n.click(),n.parentNode.removeChild(n)}}},obj.setHistory=function(e){if(1!=obj.ignoreHistory){var t=++obj.historyIndex;obj.history=obj.history=obj.history.slice(0,t+1),obj.history[t]=e}},obj.copy=function(e,t,i,n,s){t||(t="\t");for(var r=new RegExp(t,"ig"),o=[],a=[],l=[],c=[],h=[],d=obj.options.data[0].length,u=obj.options.data.length,p="",f=!1,m="",g="",v=0,_=0,b=0,y=0,C=!0,w=0;w<u;w++)for(var S=0;S<d;S++)e&&!obj.records[w][S].classList.contains("highlight")||(b<=S&&(b=S),y<=w&&(y=w));if(d===b+1&&u===y+1&&(C=!1),s&&1==obj.options.includeHeadersOnDownload||!s&&1==obj.options.includeHeadersOnCopy&&!C||n){if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)for(p=obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0]?obj.options.nestedHeaders:[obj.options.nestedHeaders],w=0;w<p.length;w++){var E=[];for(S=0;S<p[w].length;S++){var x=parseInt(p[w][S].colspan);E.push(p[w][S].title);for(var T=0;T<x-1;T++)E.push("")}g+=E.join(t)+"\r\n"}f=!0}for(obj.style=[],w=0;w<u;w++){for(a=[],l=[],S=0;S<d;S++)if(!e||obj.records[w][S].classList.contains("highlight")){1==f&&o.push(obj.headers[S].textContent);var A=obj.options.data[w][S];if(A.match&&(A.match(r)||A.match(/,/g)||A.match(/\n/)||A.match(/\"/))&&(A='"'+(A=A.replace(new RegExp('"',"g"),'""'))+'"'),a.push(A),"checkbox"==obj.options.columns[S].type||"radio"==obj.options.columns[S].type)var O=A;else(O=1==obj.options.stripHTMLOnCopy?obj.records[w][S].textContent:obj.records[w][S].innerHTML).match&&(O.match(r)||O.match(/,/g)||O.match(/\n/)||O.match(/\"/))&&(O='"'+(O=O.replace(new RegExp('"',"g"),'""'))+'"');l.push(O),p=(p=obj.records[w][S].getAttribute("style")).replace("display: none;",""),obj.style.push(p||"")}a.length&&(f&&(v=a.length,c.push(o.join(t))),c.push(a.join(t))),l.length&&(_++,f&&(h.push(o.join(t)),f=!1),h.push(l.join(t)))}d==v&&u==_&&(m=g);var I=m+c.join("\r\n"),k=m+h.join("\r\n");if(i||(1==obj.options.copyCompatibility?obj.textarea.value=k:obj.textarea.value=I,obj.textarea.select(),document.execCommand("copy")),1==obj.options.copyCompatibility?obj.data=k:obj.data=I,obj.hashString=obj.hash(obj.data),!i){if(obj.removeCopyingSelection(),obj.highlighted)for(S=0;S<obj.highlighted.length;S++)obj.highlighted[S].classList.add("copying"),obj.highlighted[S].classList.contains("highlight-left")&&obj.highlighted[S].classList.add("copying-left"),obj.highlighted[S].classList.contains("highlight-right")&&obj.highlighted[S].classList.add("copying-right"),obj.highlighted[S].classList.contains("highlight-top")&&obj.highlighted[S].classList.add("copying-top"),obj.highlighted[S].classList.contains("highlight-bottom")&&obj.highlighted[S].classList.add("copying-bottom");obj.dispatch("oncopy",el,1==obj.options.copyCompatibility?h:c,obj.hashString)}return obj.data},obj.paste=function(e,t,i){var n=parseInt(e),s=parseInt(t),r=parseInt(obj.selectedCell[2]),o=parseInt(obj.selectedCell[3]),a=r-n+1,l=o-s+1;r<n&&(e=r.toString(),a=n-r+1),o<s&&(t=o.toString(),l=s-o+1);var c=obj.dispatch("onbeforepaste",el,i,e,t);if(!1===c)return!1;c&&(i=c);var h=obj.hash(i),d=h==obj.hashString?obj.style:null;if(1==obj.options.copyCompatibility&&h==obj.hashString&&(i=obj.data),i=obj.parseCSV(i,"\t"),a>1&Number.isInteger(a/i[0].length)){d=null,p=a/i[0].length;var u=i.map((function(e,t){return Array.apply(null,{length:p*e.length}).map((function(t,i){return e[i%e.length]}))}));i=u}if(l>1&Number.isInteger(l/i.length)){d=null;var p=l/i.length;u=Array.apply(null,{length:p*i.length}).map((function(e,t){return i[t%i.length]})),i=u}if(null!=e&&null!=t&&i){for(var f=0,m=0,g=[],v={},_={},b=0,y=parseInt(e),C=parseInt(t),w=null;w=i[m];){for(f=0,y=parseInt(e);null!=w[f];){var S=obj.updateCell(y,C,w[f]);if(g.push(S),obj.updateFormulaChain(y,C,g),d&&d[b]){var E=jexcel.getColumnNameFromId([y,C]);v[E]=d[b],_[E]=obj.getStyle(E),obj.records[C][y].setAttribute("style",d[b]),b++}if(null!=w[++f]){if(y>=obj.headers.length-1){if(1!=obj.options.allowInsertColumn)break;obj.insertColumn()}y=obj.right.get(y,C)}}if(m++,i[m]){if(C>=obj.rows.length-1){if(1!=obj.options.allowInsertRow)break;obj.insertRow()}C=obj.down.get(e,C)}}obj.updateSelectionFromCoords(e,t,y,C),obj.setHistory({action:"setValue",records:g,selection:obj.selectedCell,newStyle:v,oldStyle:_}),obj.updateTable(),obj.dispatch("onpaste",el,i),obj.onafterchanges(el,g)}obj.removeCopyingSelection()},obj.removeCopyingSelection=function(){for(var e=document.querySelectorAll(".jexcel .copying"),t=0;t<e.length;t++)e[t].classList.remove("copying"),e[t].classList.remove("copying-left"),e[t].classList.remove("copying-right"),e[t].classList.remove("copying-top"),e[t].classList.remove("copying-bottom")},obj.historyProcessRow=function(e,t){var i=t.insertBefore?+t.rowNumber:t.rowNumber+1;if(1==obj.options.search&&obj.results&&obj.results.length!=obj.rows.length&&obj.resetSearch(),1==e){for(var n=t.numOfRows,s=i;s<n+i;s++)obj.rows[s].parentNode.removeChild(obj.rows[s]);obj.records.splice(i,n),obj.options.data.splice(i,n),obj.rows.splice(i,n),obj.conditionalSelectionUpdate(1,i,n+i-1)}else{obj.records=jexcel.injectArray(obj.records,i,t.rowRecords),obj.options.data=jexcel.injectArray(obj.options.data,i,t.rowData),obj.rows=jexcel.injectArray(obj.rows,i,t.rowNode);var r=0;for(s=i;s<t.numOfRows+i;s++)obj.tbody.insertBefore(t.rowNode[r],obj.tbody.children[s]),r++}obj.options.pagination>0&&obj.page(obj.pageNumber),obj.updateTableReferences()},obj.historyProcessColumn=function(e,t){var i=t.insertBefore?t.columnNumber:t.columnNumber+1;if(1==e){var n=t.numOfColumns;obj.options.columns.splice(i,n);for(var s=i;s<n+i;s++)obj.headers[s].parentNode.removeChild(obj.headers[s]),obj.colgroup[s].parentNode.removeChild(obj.colgroup[s]);obj.headers.splice(i,n),obj.colgroup.splice(i,n);for(var r=0;r<t.data.length;r++){for(s=i;s<n+i;s++)obj.records[r][s].parentNode.removeChild(obj.records[r][s]);obj.records[r].splice(i,n),obj.options.data[r].splice(i,n)}if(obj.options.footers)for(r=0;r<obj.options.footers.length;r++)obj.options.footers[r].splice(i,n)}else{obj.options.columns=jexcel.injectArray(obj.options.columns,i,t.columns),obj.headers=jexcel.injectArray(obj.headers,i,t.headers),obj.colgroup=jexcel.injectArray(obj.colgroup,i,t.colgroup);var o=0;for(s=i;s<t.numOfColumns+i;s++)obj.headerContainer.insertBefore(t.headers[o],obj.headerContainer.children[s+1]),obj.colgroupContainer.insertBefore(t.colgroup[o],obj.colgroupContainer.children[s+1]),o++;for(r=0;r<t.data.length;r++)for(obj.options.data[r]=jexcel.injectArray(obj.options.data[r],i,t.data[r]),obj.records[r]=jexcel.injectArray(obj.records[r],i,t.records[r]),o=0,s=i;s<t.numOfColumns+i;s++)obj.rows[r].insertBefore(t.records[r][o],obj.rows[r].children[s+1]),o++;if(obj.options.footers)for(r=0;r<obj.options.footers.length;r++)obj.options.footers[r]=jexcel.injectArray(obj.options.footers[r],i,t.footers[r])}if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(r=0;r<obj.options.nestedHeaders.length;r++){if(1==e)var a=parseInt(obj.options.nestedHeaders[r][obj.options.nestedHeaders[r].length-1].colspan)-t.numOfColumns;else a=parseInt(obj.options.nestedHeaders[r][obj.options.nestedHeaders[r].length-1].colspan)+t.numOfColumns;obj.options.nestedHeaders[r][obj.options.nestedHeaders[r].length-1].colspan=a,obj.thead.children[r].children[obj.thead.children[r].children.length-1].setAttribute("colspan",a)}else a=1==e?parseInt(obj.options.nestedHeaders[0].colspan)-t.numOfColumns:parseInt(obj.options.nestedHeaders[0].colspan)+t.numOfColumns,obj.options.nestedHeaders[0].colspan=a,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",a);obj.updateTableReferences()},obj.undo=function(){var e=!!obj.ignoreEvents,t=!!obj.ignoreHistory;obj.ignoreEvents=!0,obj.ignoreHistory=!0;var i=[];if(obj.historyIndex>=0){var n=obj.history[obj.historyIndex--];if("insertRow"==n.action)obj.historyProcessRow(1,n);else if("deleteRow"==n.action)obj.historyProcessRow(0,n);else if("insertColumn"==n.action)obj.historyProcessColumn(1,n);else if("deleteColumn"==n.action)obj.historyProcessColumn(0,n);else if("moveRow"==n.action)obj.moveRow(n.newValue,n.oldValue);else if("moveColumn"==n.action)obj.moveColumn(n.newValue,n.oldValue);else if("setMerge"==n.action)obj.removeMerge(n.column,n.data);else if("setStyle"==n.action)obj.setStyle(n.oldValue,null,null,1);else if("setWidth"==n.action)obj.setWidth(n.column,n.oldValue);else if("setHeight"==n.action)obj.setHeight(n.row,n.oldValue);else if("setHeader"==n.action)obj.setHeader(n.column,n.oldValue);else if("setComments"==n.action)obj.setComments(n.column,n.oldValue[0],n.oldValue[1]);else if("orderBy"==n.action){for(var s=[],r=0;r<n.rows.length;r++)s[n.rows[r]]=r;obj.updateOrderArrow(n.column,n.order?0:1),obj.updateOrder(s)}else if("setValue"==n.action){for(var o=0;o<n.records.length;o++)i.push({x:n.records[o].x,y:n.records[o].y,newValue:n.records[o].oldValue}),n.oldStyle&&obj.resetStyle(n.oldStyle);obj.setValue(i),n.selection&&obj.updateSelectionFromCoords(n.selection[0],n.selection[1],n.selection[2],n.selection[3])}}obj.ignoreEvents=e,obj.ignoreHistory=t,obj.dispatch("onundo",el,n)},obj.redo=function(){var e=!!obj.ignoreEvents,t=!!obj.ignoreHistory;if(obj.ignoreEvents=!0,obj.ignoreHistory=!0,obj.historyIndex<obj.history.length-1){var i=obj.history[++obj.historyIndex];if("insertRow"==i.action)obj.historyProcessRow(0,i);else if("deleteRow"==i.action)obj.historyProcessRow(1,i);else if("insertColumn"==i.action)obj.historyProcessColumn(0,i);else if("deleteColumn"==i.action)obj.historyProcessColumn(1,i);else if("moveRow"==i.action)obj.moveRow(i.oldValue,i.newValue);else if("moveColumn"==i.action)obj.moveColumn(i.oldValue,i.newValue);else if("setMerge"==i.action)obj.setMerge(i.column,i.colspan,i.rowspan,1);else if("setStyle"==i.action)obj.setStyle(i.newValue,null,null,1);else if("setWidth"==i.action)obj.setWidth(i.column,i.newValue);else if("setHeight"==i.action)obj.setHeight(i.row,i.newValue);else if("setHeader"==i.action)obj.setHeader(i.column,i.newValue);else if("setComments"==i.action)obj.setComments(i.column,i.newValue[0],i.newValue[1]);else if("orderBy"==i.action)obj.updateOrderArrow(i.column,i.order),obj.updateOrder(i.rows);else if("setValue"==i.action){obj.setValue(i.records);for(var n=0;n<i.records.length;n++)i.oldStyle&&obj.resetStyle(i.newStyle);i.selection&&obj.updateSelectionFromCoords(i.selection[0],i.selection[1],i.selection[2],i.selection[3])}}obj.ignoreEvents=e,obj.ignoreHistory=t,obj.dispatch("onredo",el,i)},obj.getDropDownValue=function(e,t){var i=[];if(obj.options.columns[e]&&obj.options.columns[e].source){for(var n=[],s=obj.options.columns[e].source,r=0;r<s.length;r++)"object"==typeof s[r]?n[s[r].id]=s[r].name:n[s[r]]=s[r];var o=Array.isArray(t)?t:(""+t).split(";");for(r=0;r<o.length;r++)"object"==typeof o[r]?i.push(n[o[r].id]):n[o[r]]&&i.push(n[o[r]])}else console.error("Invalid column");return i.length>0?i.join("; "):""},obj.parseCSV=function(e,t){9==(e=e.replace(/\r?\n$|\r$|\n$/g,"")).charCodeAt(e.length-1)&&(e+="\0"),t=t||",";for(var i=[],n=!1,s=0,r=0,o=0;o<e.length;o++){var a=e[o],l=e[o+1];i[s]=i[s]||[],i[s][r]=i[s][r]||"",'"'==a&&n&&'"'==l?(i[s][r]+=a,++o):'"'!=a?a!=t||n?"\r"!=a||"\n"!=l||n?"\n"==a&&!n||"\r"==a&&!n?(++s,r=0):i[s][r]+=a:(++s,r=0,++o):++r:n=!n}return i},obj.hash=function(e){var t,i=0;if(0===e.length)return i;for(t=0;t<e.length;t++)i=(i<<5)-i+e.charCodeAt(t),i|=0;return i},obj.onafterchanges=function(e,t){obj.dispatch("onafterchanges",e,t)},obj.destroy=function(){jexcel.destroy(el)},obj.init=function(){jexcel.current=obj,"function"==typeof jexcel.build&&(obj.options.root?jexcel.build(obj.options.root):(jexcel.build(document),jexcel.build=null)),el.setAttribute("tabindex",1),el.addEventListener("focus",(function(e){jexcel.current&&!obj.selectedCell&&(obj.updateSelectionFromCoords(0,0,0,0),obj.left())})),obj.options.csv?(1==obj.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:obj.options.csv,method:obj.options.method,data:obj.options.requestVariables,dataType:"text",success:function(e){var t=obj.parseCSV(e,obj.options.csvDelimiter);if(1==obj.options.csvHeaders&&t.length>0)for(var i=t.shift(),n=0;n<i.length;n++)obj.options.columns[n]||(obj.options.columns[n]={type:"text",align:obj.options.defaultColAlign,width:obj.options.defaultColWidth}),void 0===obj.options.columns[n].title&&(obj.options.columns[n].title=i[n]);obj.options.data=t,obj.prepareTable(),1==obj.options.loadingSpin&&jSuites.loading.hide()}})):obj.options.url?(1==obj.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(e){obj.options.data=e.data?e.data:e,obj.prepareTable(),1==obj.options.loadingSpin&&jSuites.loading.hide()}})):obj.prepareTable()},options&&null!=options.contextMenu?obj.options.contextMenu=options.contextMenu:obj.options.contextMenu=function(e,t,i,n){var s=[];if(null==i)1==obj.options.allowInsertColumn&&s.push({title:obj.options.text.insertANewColumnBefore,onclick:function(){obj.insertColumn(1,parseInt(t),1)}}),1==obj.options.allowInsertColumn&&s.push({title:obj.options.text.insertANewColumnAfter,onclick:function(){obj.insertColumn(1,parseInt(t),0)}}),1==obj.options.allowDeleteColumn&&s.push({title:obj.options.text.deleteSelectedColumns,onclick:function(){obj.deleteColumn(obj.getSelectedColumns().length?void 0:parseInt(t))}}),1==obj.options.allowRenameColumn&&s.push({title:obj.options.text.renameThisColumn,onclick:function(){obj.setHeader(t)}}),1==obj.options.columnSorting&&(s.push({type:"line"}),s.push({title:obj.options.text.orderAscending,onclick:function(){obj.orderBy(t,0)}}),s.push({title:obj.options.text.orderDescending,onclick:function(){obj.orderBy(t,1)}}));else if(1==obj.options.allowInsertRow&&(s.push({title:obj.options.text.insertANewRowBefore,onclick:function(){obj.insertRow(1,parseInt(i),1)}}),s.push({title:obj.options.text.insertANewRowAfter,onclick:function(){obj.insertRow(1,parseInt(i))}})),1==obj.options.allowDeleteRow&&s.push({title:obj.options.text.deleteSelectedRows,onclick:function(){obj.deleteRow(obj.getSelectedRows().length?void 0:parseInt(i))}}),t&&1==obj.options.allowComments){s.push({type:"line"});var r=obj.records[i][t].getAttribute("title")||"";s.push({title:r?obj.options.text.editComments:obj.options.text.addComments,onclick:function(){var e=prompt(obj.options.text.comments,r);e&&obj.setComments([t,i],e)}}),r&&s.push({title:obj.options.text.clearComments,onclick:function(){obj.setComments([t,i],"")}})}return s.push({type:"line"}),s.push({title:obj.options.text.copy,shortcut:"Ctrl + C",onclick:function(){obj.copy(!0)}}),navigator&&navigator.clipboard&&s.push({title:obj.options.text.paste,shortcut:"Ctrl + V",onclick:function(){obj.selectedCell&&navigator.clipboard.readText().then((function(e){e&&jexcel.current.paste(obj.selectedCell[0],obj.selectedCell[1],e)}))}}),obj.options.allowExport&&s.push({title:obj.options.text.saveAs,shortcut:"Ctrl + S",onclick:function(){obj.download()}}),obj.options.about&&s.push({title:obj.options.text.about,onclick:function(){!0===obj.options.about?alert(Version().print()):alert(obj.options.about)}}),s},obj.scrollControls=function(e){obj.wheelControls(),obj.options.freezeColumns>0&&obj.content.scrollLeft!=scrollLeft&&obj.updateFreezePosition(),1!=obj.options.lazyLoading&&1!=obj.options.tableOverflow||obj.edition&&"jdropdown"!=e.target.className.substr(0,9)&&obj.closeEditor(obj.edition[0],!0)},obj.wheelControls=function(e){1==obj.options.lazyLoading&&null==jexcel.timeControlLoading&&(jexcel.timeControlLoading=setTimeout((function(){obj.content.scrollTop+obj.content.clientHeight>=obj.content.scrollHeight-10?obj.loadDown()&&(obj.content.scrollTop+obj.content.clientHeight>obj.content.scrollHeight-10&&(obj.content.scrollTop=obj.content.scrollTop-obj.content.clientHeight),obj.updateCornerPosition()):obj.content.scrollTop<=obj.content.clientHeight&&obj.loadUp()&&(obj.content.scrollTop<10&&(obj.content.scrollTop=obj.content.scrollTop+obj.content.clientHeight),obj.updateCornerPosition()),jexcel.timeControlLoading=null}),100))},obj.getFreezeWidth=function(){var e=0;if(obj.options.freezeColumns>0)for(var t=0;t<obj.options.freezeColumns;t++)e+=parseInt(obj.options.columns[t].width);return e};var scrollLeft=0;return obj.updateFreezePosition=function(){var e=0;if((scrollLeft=obj.content.scrollLeft)>50)for(var t=0;t<obj.options.freezeColumns;t++){t>0&&"hidden"!==obj.options.columns[t-1].type&&(e+=parseInt(obj.options.columns[t-1].width)),obj.headers[t].classList.add("jexcel_freezed"),obj.headers[t].style.left=e+"px";for(var i=0;i<obj.rows.length;i++)if(obj.rows[i]&&obj.records[i][t]){var n=scrollLeft+(t>0?obj.records[i][t-1].style.width:0)-51+"px";obj.records[i][t].classList.add("jexcel_freezed"),obj.records[i][t].style.left=n}}else for(t=0;t<obj.options.freezeColumns;t++)for(obj.headers[t].classList.remove("jexcel_freezed"),obj.headers[t].style.left="",i=0;i<obj.rows.length;i++)obj.records[i][t]&&(obj.records[i][t].classList.remove("jexcel_freezed"),obj.records[i][t].style.left="");obj.updateCornerPosition()},el.addEventListener("DOMMouseScroll",obj.wheelControls),el.addEventListener("mousewheel",obj.wheelControls),el.jexcel=obj,el.jspreadsheet=obj,obj.init(),obj};jexcel.setDictionary=function(e){jSuites.setDictionary(e)},jexcel.setExtensions=function(e){for(var t=Object.keys(e),i=0;i<t.length;i++)"function"==typeof e[t[i]]&&(jexcel[t[i]]=e[t[i]],jexcel.license&&"function"==typeof e[t[i]].license&&e[t[i]].license(jexcel.license))},void 0!==formula&&(jexcel.formula=formula),jexcel.version=Version,jexcel.current=null,jexcel.timeControl=null,jexcel.timeControlLoading=null;const destroyEvents=function(e){e.removeEventListener("mouseup",jexcel.mouseUpControls),e.removeEventListener("mousedown",jexcel.mouseDownControls),e.removeEventListener("mousemove",jexcel.mouseMoveControls),e.removeEventListener("mouseover",jexcel.mouseOverControls),e.removeEventListener("dblclick",jexcel.doubleClickControls),e.removeEventListener("paste",jexcel.pasteControls),e.removeEventListener("contextmenu",jexcel.contextMenuControls),e.removeEventListener("touchstart",jexcel.touchStartControls),e.removeEventListener("touchend",jexcel.touchEndControls),e.removeEventListener("touchcancel",jexcel.touchEndControls),document.removeEventListener("keydown",jexcel.keyDownControls)};var component,e;return jexcel.destroy=function(e,t){if(e.jexcel){var i=e.jexcel.options.root?e.jexcel.options.root:document;e.removeEventListener("DOMMouseScroll",e.jexcel.scrollControls),e.removeEventListener("mousewheel",e.jexcel.scrollControls),e.jexcel=null,e.innerHTML="",t&&(destroyEvents(i),jexcel=null)}},jexcel.build=function(e){destroyEvents(e),e.addEventListener("mouseup",jexcel.mouseUpControls),e.addEventListener("mousedown",jexcel.mouseDownControls),e.addEventListener("mousemove",jexcel.mouseMoveControls),e.addEventListener("mouseover",jexcel.mouseOverControls),e.addEventListener("dblclick",jexcel.doubleClickControls),e.addEventListener("paste",jexcel.pasteControls),e.addEventListener("contextmenu",jexcel.contextMenuControls),e.addEventListener("touchstart",jexcel.touchStartControls),e.addEventListener("touchend",jexcel.touchEndControls),e.addEventListener("touchcancel",jexcel.touchEndControls),e.addEventListener("touchmove",jexcel.touchEndControls),document.addEventListener("keydown",jexcel.keyDownControls)},jexcel.keyDownControls=function(e){if(jexcel.current){if(jexcel.current.edition)if(27==e.which)jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!1),e.preventDefault();else if(13==e.which)if("calendar"==jexcel.current.options.columns[jexcel.current.edition[2]].type)jexcel.current.closeEditor(jexcel.current.edition[0],!0);else if("dropdown"==jexcel.current.options.columns[jexcel.current.edition[2]].type||"autocomplete"==jexcel.current.options.columns[jexcel.current.edition[2]].type);else if((1==jexcel.current.options.wordWrap||1==jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap||jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length>200)&&e.altKey){var t=jexcel.current.edition[0].children[0],i=jexcel.current.edition[0].children[0].value,n=t.selectionStart;i=i.slice(0,n)+"\n"+i.slice(n),t.value=i,t.focus(),t.selectionStart=n+1,t.selectionEnd=n+1}else jexcel.current.edition[0].children[0].blur();else 9==e.which&&(["calendar","html"].includes(jexcel.current.options.columns[jexcel.current.edition[2]].type)?jexcel.current.closeEditor(jexcel.current.edition[0],!0):jexcel.current.edition[0].children[0].blur());if(!jexcel.current.edition&&jexcel.current.selectedCell)if(37==e.which)jexcel.current.left(e.shiftKey,e.ctrlKey),e.preventDefault();else if(39==e.which)jexcel.current.right(e.shiftKey,e.ctrlKey),e.preventDefault();else if(38==e.which)jexcel.current.up(e.shiftKey,e.ctrlKey),e.preventDefault();else if(40==e.which)jexcel.current.down(e.shiftKey,e.ctrlKey),e.preventDefault();else if(36==e.which)jexcel.current.first(e.shiftKey,e.ctrlKey),e.preventDefault();else if(35==e.which)jexcel.current.last(e.shiftKey,e.ctrlKey),e.preventDefault();else if(46==e.which||8==e.which)1==jexcel.current.options.editable&&(jexcel.current.selectedRow?1==jexcel.current.options.allowDeleteRow&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)&&jexcel.current.deleteRow():jexcel.current.selectedHeader?1==jexcel.current.options.allowDeleteColumn&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)&&jexcel.current.deleteColumn():jexcel.current.setValue(jexcel.current.highlighted,""));else if(13==e.which)e.shiftKey?jexcel.current.up():(1==jexcel.current.options.allowInsertRow&&1==jexcel.current.options.allowManualInsertRow&&jexcel.current.selectedCell[1]==jexcel.current.options.data.length-1&&jexcel.current.insertRow(),jexcel.current.down()),e.preventDefault();else if(9==e.which)e.shiftKey?jexcel.current.left():(1==jexcel.current.options.allowInsertColumn&&1==jexcel.current.options.allowManualInsertColumn&&jexcel.current.selectedCell[0]==jexcel.current.options.data[0].length-1&&jexcel.current.insertColumn(),jexcel.current.right()),e.preventDefault();else if(!e.ctrlKey&&!e.metaKey||e.shiftKey){if(jexcel.current.selectedCell&&1==jexcel.current.options.editable){var s=jexcel.current.selectedCell[1],r=jexcel.current.selectedCell[0];"readonly"!=jexcel.current.options.columns[r].type&&(32==e.keyCode?(e.preventDefault(),"checkbox"==jexcel.current.options.columns[r].type||"radio"==jexcel.current.options.columns[r].type?jexcel.current.setCheckRadioValue():jexcel.current.openEditor(jexcel.current.records[s][r],!0)):113==e.keyCode?jexcel.current.openEditor(jexcel.current.records[s][r],!1):(8==e.keyCode||e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=111||e.keyCode>=187&&e.keyCode<=190||(String.fromCharCode(e.keyCode)==e.key||String.fromCharCode(e.keyCode).toLowerCase()==e.key.toLowerCase())&&jexcel.validLetter(String.fromCharCode(e.keyCode)))&&(jexcel.current.openEditor(jexcel.current.records[s][r],!0),"calendar"==jexcel.current.options.columns[r].type&&e.preventDefault()))}}else 65==e.which?(jexcel.current.selectAll(),e.preventDefault()):83==e.which?(jexcel.current.download(),e.preventDefault()):89==e.which?(jexcel.current.redo(),e.preventDefault()):90==e.which?(jexcel.current.undo(),e.preventDefault()):67==e.which?(jexcel.current.copy(!0),e.preventDefault()):88==e.which?(1==jexcel.current.options.editable?jexcel.cutControls():jexcel.copyControls(),e.preventDefault()):86==e.which&&jexcel.pasteControls();else e.target.classList.contains("jexcel_search")&&(jexcel.timeControl&&clearTimeout(jexcel.timeControl),jexcel.timeControl=setTimeout((function(){jexcel.current.search(e.target.value)}),200))}},jexcel.isMouseAction=!1,jexcel.mouseDownControls=function(e){if((e=e||window.event).buttons)var t=e.buttons;else t=e.button?e.button:e.which;var i=jexcel.getElement(e.target);if(i[0]?jexcel.current!=i[0].jexcel&&(jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection()),jexcel.current=i[0].jexcel):jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection(!0),jexcel.current=null),jexcel.current&&1==t){if(e.target.classList.contains("jexcel_selectall"))jexcel.current&&jexcel.current.selectAll();else if(e.target.classList.contains("jexcel_corner"))1==jexcel.current.options.editable&&(jexcel.current.selectedCorner=!0);else{if(1==i[1]){if(p=e.target.getAttribute("data-x")){var n=e.target.getBoundingClientRect();if(1==jexcel.current.options.columnResize&&n.width-e.offsetX<6){jexcel.current.resizing={mousePosition:e.pageX,column:p,width:n.width},jexcel.current.headers[p].classList.add("resizing");for(var s=0;s<jexcel.current.records.length;s++)jexcel.current.records[s][p]&&jexcel.current.records[s][p].classList.add("resizing")}else if(1==jexcel.current.options.columnDrag&&n.height-e.offsetY<6)if(jexcel.current.isColMerged(p).length)console.error("Jspreadsheet: This column is part of a merged cell.");else for(jexcel.current.resetSelection(),jexcel.current.dragging={element:e.target,column:p,destination:p},jexcel.current.headers[p].classList.add("dragging"),s=0;s<jexcel.current.records.length;s++)jexcel.current.records[s][p]&&jexcel.current.records[s][p].classList.add("dragging");else{if(jexcel.current.selectedHeader&&(e.shiftKey||e.ctrlKey))var r=jexcel.current.selectedHeader,o=p;else jexcel.current.selectedHeader==p&&1==jexcel.current.options.allowRenameColumn&&(jexcel.timeControl=setTimeout((function(){jexcel.current.setHeader(p)}),800)),jexcel.current.selectedHeader=p,r=p,o=p;jexcel.current.updateSelectionFromCoords(r,0,o,jexcel.current.options.data.length-1)}}else if(e.target.parentNode.classList.contains("jexcel_nested")){if(e.target.getAttribute("data-column"))var a=e.target.getAttribute("data-column").split(","),l=parseInt(a[0]),c=parseInt(a[a.length-1]);else l=0,c=jexcel.current.options.columns.length-1;jexcel.current.updateSelectionFromCoords(l,0,c,jexcel.current.options.data.length-1)}}else jexcel.current.selectedHeader=!1;if(2==i[1]){var h=e.target.getAttribute("data-y");if(e.target.classList.contains("jexcel_row"))n=e.target.getBoundingClientRect(),1==jexcel.current.options.rowResize&&n.height-e.offsetY<6?(jexcel.current.resizing={element:e.target.parentNode,mousePosition:e.pageY,row:h,height:n.height},e.target.parentNode.classList.add("resizing")):1==jexcel.current.options.rowDrag&&n.width-e.offsetX<6?jexcel.current.isRowMerged(h).length?console.error("Jspreadsheet: This row is part of a merged cell"):1==jexcel.current.options.search&&jexcel.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(jexcel.current.resetSelection(),jexcel.current.dragging={element:e.target.parentNode,row:h,destination:h},e.target.parentNode.classList.add("dragging")):(jexcel.current.selectedRow&&(e.shiftKey||e.ctrlKey)?(r=jexcel.current.selectedRow,o=h):(jexcel.current.selectedRow=h,r=h,o=h),jexcel.current.updateSelectionFromCoords(0,r,jexcel.current.options.data[0].length-1,o));else if(e.target.classList.contains("jclose")&&e.target.clientWidth-e.offsetX<50&&e.offsetY<50)jexcel.current.closeEditor(jexcel.current.edition[0],!0);else{var d=function(e){var t=e.getAttribute("data-x"),i=e.getAttribute("data-y");return t&&i?[t,i]:e.parentNode?d(e.parentNode):void 0},u=d(e.target);if(u){var p=u[0];h=u[1],jexcel.current.edition&&(jexcel.current.edition[2]==p&&jexcel.current.edition[3]==h||jexcel.current.closeEditor(jexcel.current.edition[0],!0)),jexcel.current.edition||(e.shiftKey?jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],p,h):jexcel.current.updateSelectionFromCoords(p,h)),jexcel.current.selectedHeader=null,jexcel.current.selectedRow=null}}}else jexcel.current.selectedRow=!1;e.target.classList.contains("jexcel_page")&&("<"==e.target.textContent?jexcel.current.page(0):">"==e.target.textContent?jexcel.current.page(e.target.getAttribute("title")-1):jexcel.current.page(e.target.textContent-1))}jexcel.current.edition?jexcel.isMouseAction=!1:jexcel.isMouseAction=!0}else jexcel.isMouseAction=!1},jexcel.mouseUpControls=function(e){if(jexcel.current)if(jexcel.current.resizing){if(jexcel.current.resizing.column){var t=jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute("width"),i=jexcel.current.getSelectedColumns();if(i.length>1){for(var n=[],s=0;s<i.length;s++)n.push(parseInt(jexcel.current.colgroup[i[s]].getAttribute("width")));n[i.indexOf(parseInt(jexcel.current.resizing.column))]=jexcel.current.resizing.width,jexcel.current.setWidth(i,t,n)}else jexcel.current.setWidth(jexcel.current.resizing.column,t,jexcel.current.resizing.width);jexcel.current.headers[jexcel.current.resizing.column].classList.remove("resizing");for(var r=0;r<jexcel.current.records.length;r++)jexcel.current.records[r][jexcel.current.resizing.column]&&jexcel.current.records[r][jexcel.current.resizing.column].classList.remove("resizing")}else{jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove("resizing");var o=jexcel.current.rows[jexcel.current.resizing.row].getAttribute("height");jexcel.current.setHeight(jexcel.current.resizing.row,o,jexcel.current.resizing.height),jexcel.current.resizing.element.classList.remove("resizing")}jexcel.current.resizing=null}else if(jexcel.current.dragging){if(jexcel.current.dragging){if(jexcel.current.dragging.column){var a=e.target.getAttribute("data-x");for(jexcel.current.headers[jexcel.current.dragging.column].classList.remove("dragging"),r=0;r<jexcel.current.rows.length;r++)jexcel.current.records[r][jexcel.current.dragging.column]&&jexcel.current.records[r][jexcel.current.dragging.column].classList.remove("dragging");for(s=0;s<jexcel.current.headers.length;s++)jexcel.current.headers[s].classList.remove("dragging-left"),jexcel.current.headers[s].classList.remove("dragging-right");a&&jexcel.current.dragging.column!=jexcel.current.dragging.destination&&jexcel.current.moveColumn(jexcel.current.dragging.column,jexcel.current.dragging.destination)}else{if(jexcel.current.dragging.element.nextSibling){var l=parseInt(jexcel.current.dragging.element.nextSibling.getAttribute("data-y"));jexcel.current.dragging.row<l&&(l-=1)}else l=parseInt(jexcel.current.dragging.element.previousSibling.getAttribute("data-y"));jexcel.current.dragging.row!=jexcel.current.dragging.destination&&jexcel.current.moveRow(jexcel.current.dragging.row,l,!0),jexcel.current.dragging.element.classList.remove("dragging")}jexcel.current.dragging=null}}else jexcel.current.selectedCorner&&(jexcel.current.selectedCorner=!1,jexcel.current.selection.length>0&&(jexcel.current.copyData(jexcel.current.selection[0],jexcel.current.selection[jexcel.current.selection.length-1]),jexcel.current.removeCopySelection()));jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null),jexcel.isMouseAction=!1},jexcel.mouseMoveControls=function(e){if((e=e||window.event).buttons)var t=e.buttons;else t=e.button?e.button:e.which;if(t||(jexcel.isMouseAction=!1),jexcel.current)if(1==jexcel.isMouseAction){if(jexcel.current.resizing)if(jexcel.current.resizing.column){var i=e.pageX-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.width+i>0){var n=jexcel.current.resizing.width+i;jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute("width",n),jexcel.current.updateCornerPosition()}}else{var s=e.pageY-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.height+s>0){var r=jexcel.current.resizing.height+s;jexcel.current.rows[jexcel.current.resizing.row].setAttribute("height",r),jexcel.current.updateCornerPosition()}}else if(jexcel.current.dragging)if(jexcel.current.dragging.column){var o=e.target.getAttribute("data-x");if(o)if(jexcel.current.isColMerged(o).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(var a=0;a<jexcel.current.headers.length;a++)jexcel.current.headers[a].classList.remove("dragging-left"),jexcel.current.headers[a].classList.remove("dragging-right");jexcel.current.dragging.column==o?jexcel.current.dragging.destination=parseInt(o):e.target.clientWidth/2>e.offsetX?(jexcel.current.dragging.column<o?jexcel.current.dragging.destination=parseInt(o)-1:jexcel.current.dragging.destination=parseInt(o),jexcel.current.headers[o].classList.add("dragging-left")):(jexcel.current.dragging.column<o?jexcel.current.dragging.destination=parseInt(o):jexcel.current.dragging.destination=parseInt(o)+1,jexcel.current.headers[o].classList.add("dragging-right"))}}else{var l=e.target.getAttribute("data-y");if(l)if(jexcel.current.isRowMerged(l).length)console.error("Jspreadsheet: This row is part of a merged cell.");else{var c=e.target.clientHeight/2>e.offsetY?e.target.parentNode.nextSibling:e.target.parentNode;jexcel.current.dragging.element!=c&&(e.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element,c),jexcel.current.dragging.destination=Array.prototype.indexOf.call(jexcel.current.dragging.element.parentNode.children,jexcel.current.dragging.element))}}}else{var h=e.target.getAttribute("data-x"),d=e.target.getAttribute("data-y"),u=e.target.getBoundingClientRect();jexcel.current.cursor&&(jexcel.current.cursor.style.cursor="",jexcel.current.cursor=null),e.target.parentNode.parentNode&&e.target.parentNode.parentNode.className&&(e.target.parentNode.parentNode.classList.contains("resizable")&&(e.target&&h&&!d&&u.width-(e.clientX-u.left)<6?(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="col-resize"):e.target&&!h&&d&&u.height-(e.clientY-u.top)<6&&(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="row-resize")),e.target.parentNode.parentNode.classList.contains("draggable")&&(e.target&&!h&&d&&u.width-(e.clientX-u.left)<6||e.target&&h&&!d&&u.height-(e.clientY-u.top)<6)&&(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="move"))}},jexcel.mouseOverControls=function(e){if((e=e||window.event).buttons)var t=e.buttons;else t=e.button?e.button:e.which;if(t||(jexcel.isMouseAction=!1),jexcel.current&&1==jexcel.isMouseAction){var i=jexcel.getElement(e.target);if(i[0]){if(jexcel.current!=i[0].jexcel&&jexcel.current)return!1;var n=e.target.getAttribute("data-x"),s=e.target.getAttribute("data-y");if(jexcel.current.resizing||jexcel.current.dragging);else{if(1==i[1]&&jexcel.current.selectedHeader){n=e.target.getAttribute("data-x");var r=jexcel.current.selectedHeader,o=n;jexcel.current.updateSelectionFromCoords(r,0,o,jexcel.current.options.data.length-1)}2==i[1]&&(e.target.classList.contains("jexcel_row")?jexcel.current.selectedRow&&(r=jexcel.current.selectedRow,o=s,jexcel.current.updateSelectionFromCoords(0,r,jexcel.current.options.data[0].length-1,o)):jexcel.current.edition||n&&s&&(jexcel.current.selectedCorner?jexcel.current.updateCopySelection(n,s):jexcel.current.selectedCell&&jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],n,s)))}}}jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null)},jexcel.doubleClickControls=function(e){if(jexcel.current)if(e.target.classList.contains("jexcel_corner")){if(jexcel.current.highlighted.length>0){var t=jexcel.current.highlighted[0].getAttribute("data-x"),i=parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-y"))+1,n=jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-x"),s=jexcel.current.records.length-1;jexcel.current.copyData(jexcel.current.records[i][t],jexcel.current.records[s][n])}}else if(e.target.classList.contains("jexcel_column_filter")){var r=e.target.getAttribute("data-x");jexcel.current.openFilter(r)}else{var o=jexcel.getElement(e.target);if(1==o[1]&&1==jexcel.current.options.columnSorting&&(r=e.target.getAttribute("data-x"))&&jexcel.current.orderBy(r),2==o[1]&&1==jexcel.current.options.editable&&!jexcel.current.edition){var a=function(e){if(e.parentNode){var t=e.getAttribute("data-x"),i=e.getAttribute("data-y");return t&&i?e:a(e.parentNode)}},l=a(e.target);l&&l.classList.contains("highlight")&&jexcel.current.openEditor(l)}}},jexcel.copyControls=function(e){jexcel.current&&jexcel.copyControls.enabled&&(jexcel.current.edition||jexcel.current.copy(!0))},jexcel.cutControls=function(e){jexcel.current&&(jexcel.current.edition||(jexcel.current.copy(!0),1==jexcel.current.options.editable&&jexcel.current.setValue(jexcel.current.highlighted,"")))},jexcel.pasteControls=function(e){jexcel.current&&jexcel.current.selectedCell&&(jexcel.current.edition||1==jexcel.current.options.editable&&(e&&e.clipboardData?(jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],e.clipboardData.getData("text")),e.preventDefault()):window.clipboardData&&jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],window.clipboardData.getData("text"))))},jexcel.contextMenuControls=function(e){if("buttons"in(e=e||window.event)?e.buttons:e.which||e.button,jexcel.current)if(jexcel.current.edition)e.preventDefault();else if(jexcel.current.options.contextMenu&&(jexcel.current.contextMenu.contextmenu.close(),jexcel.current)){var t=e.target.getAttribute("data-x"),i=e.target.getAttribute("data-y");if(t||i){(t<parseInt(jexcel.current.selectedCell[0])||t>parseInt(jexcel.current.selectedCell[2])||i<parseInt(jexcel.current.selectedCell[1])||i>parseInt(jexcel.current.selectedCell[3]))&&jexcel.current.updateSelectionFromCoords(t,i,t,i);var n=jexcel.current.options.contextMenu(jexcel.current,t,i,e);jexcel.current.contextMenu.contextmenu.open(e,n),e.preventDefault()}}},jexcel.touchStartControls=function(e){var t=jexcel.getElement(e.target);if(t[0]?jexcel.current!=t[0].jexcel&&(jexcel.current&&jexcel.current.resetSelection(),jexcel.current=t[0].jexcel):jexcel.current&&(jexcel.current.resetSelection(),jexcel.current=null),jexcel.current&&!jexcel.current.edition){var i=e.target.getAttribute("data-x"),n=e.target.getAttribute("data-y");i&&n&&(jexcel.current.updateSelectionFromCoords(i,n),jexcel.timeControl=setTimeout((function(){"color"==jexcel.current.options.columns[i].type?jexcel.tmpElement=null:jexcel.tmpElement=e.target,jexcel.current.openEditor(e.target,!1,e)}),500))}},jexcel.touchEndControls=function(e){jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null,jexcel.tmpElement&&"INPUT"==jexcel.tmpElement.children[0].tagName&&jexcel.tmpElement.children[0].focus(),jexcel.tmpElement=null)},jexcel.tabs=function(e,t){var i=[];if(e.classList.contains("jexcel_tabs"))s=e.children[0],r=e.children[1];else{e.innerHTML="",e.classList.add("jexcel_tabs"),e.jexcel=[];var n=document.createElement("div"),s=e.appendChild(n),r=(n=document.createElement("div"),e.appendChild(n))}for(var o=[],a=[],l=0;l<t.length;l++){o[l]=document.createElement("div"),o[l].classList.add("jexcel_tab");var c=jexcel(o[l],t[l]);r.appendChild(o[l]),i[l]=e.jexcel.push(c),a[l]=document.createElement("div"),a[l].classList.add("jexcel_tab_link"),a[l].setAttribute("data-spreadsheet",e.jexcel.length-1),a[l].innerHTML=t[l].sheetName,a[l].onclick=function(){for(var e=0;e<s.children.length;e++)s.children[e].classList.remove("selected"),r.children[e].style.display="none";var t=this.getAttribute("data-spreadsheet");r.children[t].style.display="block",s.children[t].classList.add("selected")},s.appendChild(a[l])}for(var h=0;h<s.children.length;h++)s.children[h].classList.remove("selected"),r.children[h].style.display="none";return s.children[s.children.length-1].classList.add("selected"),r.children[s.children.length-1].style.display="block",i},jexcel.createTabs=jexcel.tabs,jexcel.fromSpreadsheet=function(e,t){var i,n=function(e){var t=[];return e.SheetNames.forEach((function(i){var n={rows:[],columns:[],data:[],style:{}};if(n.sheetName=i,(u=e.Sheets[i]["!cols"])&&u.length)for(var s=0;s<u.length;s++)n.columns[s]={},u[s]&&u[s].wpx&&(n.columns[s].width=u[s].wpx+"px");if((u=e.Sheets[i]["!rows"])&&u.length)for(s=0;s<u.length;s++)u[s]&&u[s].hpx&&(n.rows[s]={},n.rows[s].height=u[s].hpx+"px");if((u=e.Sheets[i]["!merges"])&&u.length>0)for(n.mergeCells=[],s=0;s<u.length;s++){var r=u[s].s.c,o=u[s].s.r,a=u[s].e.c,l=u[s].e.r,c=jexcel.getColumnNameFromId([r,o]);n.mergeCells[c]=[a-r+1,l-o+1]}var h=0,d=0,u=Object.keys(e.Sheets[i]);for(s=0;s<u.length;s++)if("!"!=u[s].substr(0,1)){var p=e.Sheets[i][u[s]],f=jexcel.getIdFromColumnName(u[s],!0);n.data[f[1]]||(n.data[f[1]]=[]),n.data[f[1]][f[0]]=p.f?"="+p.f:p.w,h<f[0]&&(h=f[0]),d<f[1]&&(d=f[1]),p.style&&Object.keys(p.style).length>0&&(n.style[u[s]]=p.style),p.s&&p.s.fgColor&&(n.style[u[s]]&&(n.style[u[s]]+=";"),n.style[u[s]]+="background-color:#"+p.s.fgColor.rgb)}for(var m=n.columns,g=0;g<=d;g++)for(s=0;s<=h;s++)n.data[g]||(n.data[g]=[]),n.data[g][s]||m<s&&(n.data[g][s]="");t.push(n)})),t};(i=new XMLHttpRequest).open("GET",e,!0),"undefined"!=typeof Uint8Array?(i.responseType="arraybuffer",i.onload=function(e){var s=i.response,r=new Uint8Array(s),o=XLSX.read(r,{type:"array",cellFormula:!0,cellStyles:!0});t(n(o))}):(i.setRequestHeader("Accept-Charset","x-user-defined"),i.onreadystatechange=function(){if(4==i.readyState&&200==i.status){var e=convertResponseBodyToText(i.responseBody),s=XLSX.read(e,{type:"binary",cellFormula:!0,cellStyles:!0});t(n(s))}}),i.send()},jexcel.validLetter=function(e){return e.match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g)?1:0},jexcel.injectArray=function(e,t,i){return e.slice(0,t).concat(i).concat(e.slice(t))},jexcel.getColumnName=function(e){return jexcel.helpers.getColumnName(e)},jexcel.getIdFromColumnName=function(e,t){var i=/^[a-zA-Z]+/.exec(e);if(i){for(var n=0,s=0;s<i[0].length;s++)n+=parseInt(i[0].charCodeAt(s)-64)*Math.pow(26,i[0].length-1-s);--n<0&&(n=0);var r=parseInt(/[0-9]+$/.exec(e));r>0&&r--,e=1==t?[n,r]:n+"-"+r}return e},jexcel.getColumnNameFromId=function(e){return Array.isArray(e)||(e=e.split("-")),jexcel.getColumnName(parseInt(e[0]))+(parseInt(e[1])+1)},jexcel.getElement=function(e){var t=0,i=0;return function e(n){n.className&&n.classList.contains("jexcel_container")&&(i=n),"THEAD"==n.tagName?t=1:"TBODY"==n.tagName&&(t=2),n.parentNode&&(i||e(n.parentNode))}(e),[i,t]},jexcel.doubleDigitFormat=function(e){return 1==(e=""+e).length&&(e="0"+e),e},jexcel.createFromTable=function(e,t){if("TABLE"==e.tagName){t||(t={}),t.columns=[],t.data=[];var i=e.querySelectorAll("colgroup > col");if(i.length)for(var n=0;n<i.length;n++){if(!(s=i[n].style.width))var s=i[n].getAttribute("width");s&&(t.columns[n]||(t.columns[n]={}),t.columns[n].width=s)}var r=function(e){var i=e.getBoundingClientRect(),s=i.width>50?i.width:50;t.columns[n]||(t.columns[n]={}),e.getAttribute("data-celltype")?t.columns[n].type=e.getAttribute("data-celltype"):t.columns[n].type="text",t.columns[n].width=s+"px",t.columns[n].title=e.innerHTML,t.columns[n].align=e.style.textAlign||"center",(i=e.getAttribute("name"))&&(t.columns[n].name=i),(i=e.getAttribute("id"))&&(t.columns[n].id=i),(i=e.getAttribute("data-mask"))&&(t.columns[n].mask=i)},o=[],a=e.querySelectorAll(":scope > thead > tr");if(a.length){for(var l=0;l<a.length-1;l++){var c=[];for(n=0;n<a[l].children.length;n++){var h={title:a[l].children[n].textContent,colspan:a[l].children[n].getAttribute("colspan")||1};c.push(h)}o.push(c)}for(a=a[a.length-1].children,n=0;n<a.length;n++)r(a[n])}var d=0,u={},p={},f={},m={},g=e.querySelectorAll(":scope > tr, :scope > tbody > tr");for(l=0;l<g.length;l++)if(t.data[d]=[],1!=t.parseTableFirstRowAsHeader||a.length||0!=l){for(n=0;n<g[l].children.length;n++){if(v=g[l].children[n].getAttribute("data-formula"))"="!=v.substr(0,1)&&(v="="+v);else var v=g[l].children[n].innerHTML;t.data[d].push(v);var _=jexcel.getColumnNameFromId([n,l]),b=g[l].children[n].getAttribute("class");b&&(m[_]=b);var y=parseInt(g[l].children[n].getAttribute("colspan"))||0,C=parseInt(g[l].children[n].getAttribute("rowspan"))||0;(y||C)&&(u[_]=[y||1,C||1]),g[l].children[n].style&&"none"==g[l].children[n].style.display&&(g[l].children[n].style.display="");var w=g[l].children[n].getAttribute("style");w&&(f[_]=w),g[l].children[n].classList.contains("styleBold")&&(f[_]?f[_]+="; font-weight:bold;":f[_]="font-weight:bold;")}g[l].style&&g[l].style.height&&(p[l]={height:g[l].style.height}),d++}else for(n=0;n<g[l].children.length;n++)r(g[l].children[n]);if(Object.keys(o).length>0&&(t.nestedHeaders=o),Object.keys(f).length>0&&(t.style=f),Object.keys(u).length>0&&(t.mergeCells=u),Object.keys(p).length>0&&(t.rows=p),Object.keys(m).length>0&&(t.classes=m),(g=e.querySelectorAll("tfoot tr")).length){var S=[];for(l=0;l<g.length;l++){var E=[];for(n=0;n<g[l].children.length;n++)E.push(g[l].children[n].textContent);S.push(E)}Object.keys(S).length>0&&(t.footers=S)}if(1==t.parseTableAutoCellType){var x=[];for(n=0;n<t.columns.length;n++){var T=!0,A=!0;for(x[n]=[],l=0;l<t.data.length;l++)v=t.data[l][n],x[n][v]||(x[n][v]=0),x[n][v]++,v.length>25&&(T=!1),10==v.length&&"-"==v.substr(4,1)&&"-"==v.substr(7,1)||(A=!1);var O=Object.keys(x[n]).length;A?t.columns[n].type="calendar":1==T&&O>1&&O<=parseInt(.1*t.data.length)&&(t.columns[n].type="dropdown",t.columns[n].source=Object.keys(x[n]))}}return t}console.log("Element is not a table")},jexcel.helpers=(component={getCaretIndex:function(e){if(this.config.root)var t=this.config.root;else t=window;var i=0,n=t.getSelection();if(n&&0!==n.rangeCount){var s=n.getRangeAt(0),r=s.cloneRange();r.selectNodeContents(e),r.setEnd(s.endContainer,s.endOffset),i=r.toString().length}return i},invert:function(e){for(var t=[],i=Object.keys(e),n=0;n<i.length;n++)t[e[i[n]]]=i[n];return t},getColumnName:function(e){let t,i=e+1,n="";for(;i>0;)t=(i-1)%26,n=String.fromCharCode(65+t).toString()+n,i=parseInt((i-t)/26);return n},getColumnNameFromCoords:function(e,t){return component.getColumnName(parseInt(e))+(parseInt(t)+1)},getCoordsFromColumnName:function(e){var t=/^[a-zA-Z]+/.exec(e);if(t){for(var i=0,n=0;n<t[0].length;n++)i+=parseInt(t[0].charCodeAt(n)-64)*Math.pow(26,t[0].length-1-n);--i<0&&(i=0);var s=parseInt(/[0-9]+$/.exec(e))||null;return s>0&&s--,[i,s]}},createFromTable:function(){},injectArray:function(e,t,i){return e.slice(0,t).concat(i).concat(e.slice(t))},parseCSV:function(e,t){t=t||",";for(var i=0,n=0,s=[[]],r=0,o=null,a=!1,l=!1,c=0;c<e.length;c++)if(s[n]||(s[n]=[]),s[n][i]||(s[n][i]=""),"\r"!=e[c])if("\n"!=e[c]&&e[c]!=t||0!=a&&1!=l&&o){if('"'==e[c]&&(a=!a),null===o){if(1==(o=a))continue}else if(!0===o&&!l&&'"'==e[c]){'"'==e[c+1]?(a=!0,s[n][i]+=e[c],c++):l=!0;continue}s[n][i]+=e[c]}else{if(o=null,a=!1,l=!1,'"'==s[n][i][0]){var h=s[n][i].trim();'"'==h[h.length-1]&&(s[n][i]=h.substr(1,h.length-2))}"\n"==e[c]?(i=0,n++):++i>r&&(r=i)}for(var d=0;d<s.length;d++)for(c=0;c<=r;c++)void 0===s[d][c]&&(s[d][c]="");return s}},component),"undefined"!=typeof jQuery&&(e=jQuery,e.fn.jspreadsheet=e.fn.jexcel=function(t){var i=e(this).get(0);return i.jexcel?Array.isArray(i.jexcel)?i.jexcel[t][arguments[1]].apply(this,Array.prototype.slice.call(arguments,2)):i.jexcel[t].apply(this,Array.prototype.slice.call(arguments,1)):jexcel(e(this).get(0),arguments[0])}),jexcel},module.exports=factory()}},__webpack_module_cache__={};function __nested_webpack_require_281790__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var i=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(i.exports,i,i.exports,__nested_webpack_require_281790__),i.exports}var __nested_webpack_exports__=__nested_webpack_require_281790__(44);jspreadsheet=__nested_webpack_exports__}(),jspreadsheet},module.exports=factory()},610:function(e){var t;e.exports=(function(){var e={195:function(e){e.exports=function(e){function t(e,t){this.highOrder=e,this.lowOrder=t}var i,n,s,r,o,a,l,c,h,d,u=[new t(1779033703,4089235720),new t(3144134277,2227873595),new t(1013904242,4271175723),new t(2773480762,1595750129),new t(1359893119,2917565137),new t(2600822924,725511199),new t(528734635,4215389547),new t(1541459225,327033209)],p=[new t(1116352408,3609767458),new t(1899447441,602891725),new t(3049323471,3964484399),new t(3921009573,2173295548),new t(961987163,4081628472),new t(1508970993,3053834265),new t(2453635748,2937671579),new t(2870763221,3664609560),new t(3624381080,2734883394),new t(310598401,1164996542),new t(607225278,1323610764),new t(1426881987,3590304994),new t(1925078388,4068182383),new t(2162078206,991336113),new t(2614888103,633803317),new t(3248222580,3479774868),new t(3835390401,2666613458),new t(4022224774,944711139),new t(264347078,2341262773),new t(604807628,2007800933),new t(770255983,1495990901),new t(1249150122,1856431235),new t(1555081692,3175218132),new t(1996064986,2198950837),new t(2554220882,3999719339),new t(2821834349,766784016),new t(2952996808,2566594879),new t(3210313671,3203337956),new t(3336571891,1034457026),new t(3584528711,2466948901),new t(113926993,3758326383),new t(338241895,168717936),new t(666307205,1188179964),new t(773529912,1546045734),new t(1294757372,1522805485),new t(1396182291,2643833823),new t(1695183700,2343527390),new t(1986661051,1014477480),new t(2177026350,1206759142),new t(2456956037,344077627),new t(2730485921,1290863460),new t(2820302411,3158454273),new t(3259730800,3505952657),new t(3345764771,106217008),new t(3516065817,3606008344),new t(3600352804,1432725776),new t(4094571909,1467031594),new t(275423344,851169720),new t(430227734,3100823752),new t(506948616,1363258195),new t(659060556,3750685593),new t(883997877,3785050280),new t(958139571,3318307427),new t(1322822218,3812723403),new t(1537002063,2003034995),new t(1747873779,3602036899),new t(1955562222,1575990012),new t(2024104815,1125592928),new t(2227730452,2716904306),new t(2361852424,442776044),new t(2428436474,593698344),new t(2756734187,3733110249),new t(3204031479,2999351573),new t(3329325298,3815920427),new t(3391569614,3928383900),new t(3515267271,566280711),new t(3940187606,3454069534),new t(4118630271,4000239992),new t(116418474,1914138554),new t(174292421,2731055270),new t(289380356,3203993006),new t(460393269,320620315),new t(685471733,587496836),new t(852142971,1086792851),new t(1017036298,365543100),new t(1126000580,2618297676),new t(1288033470,3409855158),new t(1501505948,4234509866),new t(1607167915,987167468),new t(1816402316,1246189591)],f=new Array(64),m=8;function g(e){return unescape(encodeURIComponent(e))}function v(e){for(var t=[],i=(1<<m)-1,n=e.length*m,s=0;s<n;s+=m)t[s>>5]|=(e.charCodeAt(s/m)&i)<<32-m-s%32;return t}function _(e){for(var t,i="0123456789abcdef",n="",s=4*e.length,r=0;r<s;r+=1)t=e[r>>2]>>8*(3-r%4),n+=i.charAt(t>>4&15)+i.charAt(15&t);return n}function b(e,i){var n,s,r;return n=(65535&e.lowOrder)+(65535&i.lowOrder),r=(65535&(s=(e.lowOrder>>>16)+(i.lowOrder>>>16)+(n>>>16)))<<16|65535&n,n=(65535&e.highOrder)+(65535&i.highOrder)+(s>>>16),new t((65535&(s=(e.highOrder>>>16)+(i.highOrder>>>16)+(n>>>16)))<<16|65535&n,r)}function y(e,i,n,s){var r,o,a;return r=(65535&e.lowOrder)+(65535&i.lowOrder)+(65535&n.lowOrder)+(65535&s.lowOrder),a=(65535&(o=(e.lowOrder>>>16)+(i.lowOrder>>>16)+(n.lowOrder>>>16)+(s.lowOrder>>>16)+(r>>>16)))<<16|65535&r,r=(65535&e.highOrder)+(65535&i.highOrder)+(65535&n.highOrder)+(65535&s.highOrder)+(o>>>16),new t((65535&(o=(e.highOrder>>>16)+(i.highOrder>>>16)+(n.highOrder>>>16)+(s.highOrder>>>16)+(r>>>16)))<<16|65535&r,a)}function C(e,i,n,s,r){var o,a,l;return o=(65535&e.lowOrder)+(65535&i.lowOrder)+(65535&n.lowOrder)+(65535&s.lowOrder)+(65535&r.lowOrder),l=(65535&(a=(e.lowOrder>>>16)+(i.lowOrder>>>16)+(n.lowOrder>>>16)+(s.lowOrder>>>16)+(r.lowOrder>>>16)+(o>>>16)))<<16|65535&o,o=(65535&e.highOrder)+(65535&i.highOrder)+(65535&n.highOrder)+(65535&s.highOrder)+(65535&r.highOrder)+(a>>>16),new t((65535&(a=(e.highOrder>>>16)+(i.highOrder>>>16)+(n.highOrder>>>16)+(s.highOrder>>>16)+(r.highOrder>>>16)+(o>>>16)))<<16|65535&o,l)}function w(e,i,n){return new t(e.highOrder&i.highOrder^e.highOrder&n.highOrder^i.highOrder&n.highOrder,e.lowOrder&i.lowOrder^e.lowOrder&n.lowOrder^i.lowOrder&n.lowOrder)}function S(e,i,n){return new t(e.highOrder&i.highOrder^~e.highOrder&n.highOrder,e.lowOrder&i.lowOrder^~e.lowOrder&n.lowOrder)}function E(e,i){return i<=32?new t(e.highOrder>>>i|e.lowOrder<<32-i,e.lowOrder>>>i|e.highOrder<<32-i):new t(e.lowOrder>>>i|e.highOrder<<32-i,e.highOrder>>>i|e.lowOrder<<32-i)}function x(e){var i=E(e,28),n=E(e,34),s=E(e,39);return new t(i.highOrder^n.highOrder^s.highOrder,i.lowOrder^n.lowOrder^s.lowOrder)}function T(e){var i=E(e,14),n=E(e,18),s=E(e,41);return new t(i.highOrder^n.highOrder^s.highOrder,i.lowOrder^n.lowOrder^s.lowOrder)}function A(e){var i=E(e,1),n=E(e,8),s=I(e,7);return new t(i.highOrder^n.highOrder^s.highOrder,i.lowOrder^n.lowOrder^s.lowOrder)}function O(e){var i=E(e,19),n=E(e,61),s=I(e,6);return new t(i.highOrder^n.highOrder^s.highOrder,i.lowOrder^n.lowOrder^s.lowOrder)}function I(e,i){return i<=32?new t(e.highOrder>>>i,e.lowOrder>>>i|e.highOrder<<32-i):new t(0,e.highOrder<<32-i)}var k=(e=g(e)).length*m;(e=v(e))[k>>5]|=128<<24-k%32,e[31+(k+128>>10<<5)]=k;for(var D=0;D<e.length;D+=32){i=u[0],n=u[1],s=u[2],r=u[3],o=u[4],a=u[5],l=u[6],c=u[7];for(var j=0;j<80;j++)f[j]=j<16?new t(e[2*j+D],e[2*j+D+1]):y(O(f[j-2]),f[j-7],A(f[j-15]),f[j-16]),h=C(c,T(o),S(o,a,l),p[j],f[j]),d=b(x(i),w(i,n,s)),c=l,l=a,a=o,o=b(r,h),r=s,s=n,n=i,i=b(h,d);u[0]=b(i,u[0]),u[1]=b(n,u[1]),u[2]=b(s,u[2]),u[3]=b(r,u[3]),u[4]=b(o,u[4]),u[5]=b(a,u[5]),u[6]=b(l,u[6]),u[7]=b(c,u[7])}var R=[];for(D=0;D<u.length;D++)R.push(u[D].highOrder),R.push(u[D].lowOrder);return _(R)}}},i={};function n(t){var s=i[t];if(void 0!==s)return s.exports;var r=i[t]={exports:{}};return e[t].call(r.exports,r,r.exports,n),r.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};var s={};!function(){"use strict";n.d(s,{default:function(){return P}});var e={setDictionary:function(e){document.dictionary||(document.dictionary={});var t=null,i=Object.keys(e);for(t=0;t<i.length;t++)document.dictionary[i[t]]=e[i[t]]},translate:function(e){return"undefined"!=typeof document&&document.dictionary&&document.dictionary[e]||e}},i=function(e,t){if(!0===t)window.jSuitesStateControl=window.jSuitesStateControl.filter((function(e){return null!==e})),setTimeout((function(){window.jSuitesStateControl.push(e)}),0);else{var i=window.jSuitesStateControl.indexOf(e);i>=0&&window.jSuitesStateControl.splice(i,1)}},r={two:function(e){return 1==(e=""+e).length&&(e="0"+e),e},focus:function(e){if(e.innerText.length){var t=document.createRange(),i=window.getSelection(),n=e.childNodes[e.childNodes.length-1];t.setStart(n,n.length),t.collapse(!0),i.removeAllRanges(),i.addRange(t),e.scrollLeft=e.scrollWidth}},isNumeric:function(e){return"string"==typeof e&&(e=e.trim()),!isNaN(e)&&null!==e&&""!==e},guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},getNode:function(){var e=document.getSelection().anchorNode;return e?3==e.nodeType?e.parentNode:e:null},hash:function(e){var t,i,n=0;if(0===e.length)return n;for(t=0;t<e.length;t++)(i=e.charCodeAt(t))>32&&(n=(n<<5)-n+i,n|=0);return n},randomColor:function(e){var t=String("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");t.length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]);var i,n,s=[];for(n=0;n<3;n++)i=parseInt(t.substr(2*n,2),16),i=Math.round(Math.min(Math.max(0,i+-.25*i),255)).toString(16),s.push(("00"+i).substr(i.length));return 1==e?"#"+r.two(s[0].toString(16))+r.two(s[1].toString(16))+r.two(s[2].toString(16)):s},getWindowWidth:function(){var e=window,t=document,i=t.documentElement,n=t.getElementsByTagName("body")[0];return e.innerWidth||i.clientWidth||n.clientWidth},getWindowHeight:function(){var e=window,t=document,i=t.documentElement,n=t.getElementsByTagName("body")[0];return e.innerHeight||i.clientHeight||n.clientHeight},getPosition:function(e){if(e.changedTouches&&e.changedTouches[0])var t=e.changedTouches[0].pageX,i=e.changedTouches[0].pageY;else t=window.Event?e.pageX:e.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),i=window.Event?e.pageY:e.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[t,i]},click:function(e){if(e.click)e.click();else{var t=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});e.dispatchEvent(t)}},findElement:function(e,t){var i=!1;return function e(n){n&&!i&&("function"==typeof t?i=t(n):"string"==typeof t&&n.classList&&n.classList.contains(t)&&(i=n)),n.parentNode&&!i&&e(n.parentNode)}(e),i}},o=r;function a(e,t,i){if((e=e.split(".")).length){let n=this,s=null;for(;e.length>1;)if(s=e.shift(),n.hasOwnProperty(s))n=n[s];else{if(void 0===t)return;n[s]={},n=n[s]}if(s=e.shift(),void 0!==t)return!0===i?delete n[s]:n[s]=t,!0;if(n)return n[s]}return!1}function l(e,t){var i={options:{}},n={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},s=null;for(var r in n)t&&t.hasOwnProperty(r)?i.options[r]=t[r]:i.options[r]=n[r];e.classList.add("jsorting"),e.addEventListener("dragstart",(function(t){let n=t.target;if(3===n.nodeType){if("true"!==n.parentNode.getAttribute("draggable"))return t.preventDefault(),void t.stopPropagation();n=n.parentNode}if("true"===n.getAttribute("draggable")){let r=Array.prototype.indexOf.call(n.parentNode.children,n);s={element:n,o:r,d:r},n.style.opacity="0.25","function"==typeof i.options.ondragstart&&i.options.ondragstart(e,n,t),t.dataTransfer.setDragImage(n,0,0)}})),e.addEventListener("dragover",(function(e){if(e.preventDefault(),s&&o(e.target)&&"true"==e.target.getAttribute("draggable")&&s.element!=e.target){if(i.options.direction)t=e.target.clientWidth/2>e.offsetX;else var t=e.target.clientHeight/2>e.offsetY;t?e.target.parentNode.insertBefore(s.element,e.target):e.target.parentNode.insertBefore(s.element,e.target.nextSibling),s.d=Array.prototype.indexOf.call(e.target.parentNode.children,s.element)}})),e.addEventListener("dragleave",(function(e){e.preventDefault()})),e.addEventListener("dragend",(function(t){t.preventDefault(),s&&("function"==typeof i.options.ondragend&&i.options.ondragend(e,s.element,t),s.o<s.d?t.target.parentNode.insertBefore(s.element,t.target.parentNode.children[s.o]):t.target.parentNode.insertBefore(s.element,t.target.parentNode.children[s.o].nextSibling),s.element.style.opacity="",s=null)})),e.addEventListener("drop",(function(t){t.preventDefault(),s&&(s.o!==s.d&&"function"==typeof i.options.ondrop&&i.options.ondrop(e,s.o,s.d,s.element,t.target,t),s.element.style.opacity="",s=null)}));for(var o=function(e){var t=!1;return function e(i){i.className&&i.classList.contains("jsorting")&&(t=!0),t||e(i.parentNode)}(e),t},a=0;a<e.children.length;a++)e.children[a].hasAttribute("draggable")||e.children[a].setAttribute("draggable","true");return e.val=function(){for(var t=null,i=[],n=0;n<e.children.length;n++)(t=e.children[n].getAttribute("data-id"))&&i.push(t);return i},e}function c(e,t){t.loadUp&&"function"==typeof t.loadUp||(t.loadUp=function(){return!1}),t.loadDown&&"function"==typeof t.loadDown||(t.loadDown=function(){return!1}),t.timer||(t.timer=100);var i=null,n=function(n){if(null==i){var s=!1,r=e.scrollTop;e.scrollTop+2*e.clientHeight>=e.scrollHeight?t.loadDown()&&(r==e.scrollTop&&(e.scrollTop=e.scrollTop-e.clientHeight),s=!0):e.scrollTop<=e.clientHeight&&t.loadUp()&&(r==e.scrollTop&&(e.scrollTop=e.scrollTop+e.clientHeight),s=!0),i=setTimeout((function(){i=null}),t.timer),s&&"function"==typeof t.onupdate&&t.onupdate()}};return e.onscroll=function(e){n()},e.onwheel=function(e){n()},{}}var h,d=((h=function(e,t){if(Array.isArray(e)){var i={instance:[],complete:t};if(e.length>0)for(var n=0;n<e.length;n++)e[n].multiple=i,i.instance.push(h(e[n]));return i}if(e.data||(e.data={}),e.type&&(e.method=e.type),e.method||(e.method="GET"),e.dataType||(e.dataType="json"),e.data){var s=function(e,t){var i=[];if(e){var n=Object.keys(e);if(n.length)for(var r=0;r<n.length;r++){if(t)var o=t+"["+n[r]+"]";else o=n[r];if(e[o]instanceof FileList)i[o]=e[n[r]];else if(null===e[n[r]]||void 0===e[n[r]])i[o]="";else if("object"==typeof e[n[r]])for(var a=s(e[n[r]],o),l=Object.keys(a),c=0;c<l.length;c++)i[l[c]]=a[l[c]];else i[o]=e[n[r]]}}return i},r=s(e.data),o=Object.keys(r);if("GET"==e.method){if(o.length){var a=[];for(n=0;n<o.length;n++)a.push(o[n]+"="+encodeURIComponent(r[o[n]]));e.url.indexOf("?")<0&&(e.url+="?"),e.url+=a.join("&")}}else for(a=new FormData,n=0;n<o.length;n++)if(r[o[n]]instanceof FileList){if(r[o[n]].length)for(var l=0;l<r[o[n]].length;l++)a.append(o[n],r[o[n]][l],r[o[n]][l].name)}else a.append(o[n],r[o[n]])}var c=new XMLHttpRequest;return c.open(e.method,e.url,!0),e.requestedWith?c.setRequestHeader("X-Requested-With",e.requestedWith):!1!==e.requestedWith&&c.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.contentType&&c.setRequestHeader("Content-Type",e.contentType),"POST"===e.method?c.setRequestHeader("Accept","application/json"):"blob"===e.dataType?c.responseType="blob":e.contentType||("json"===e.dataType?c.setRequestHeader("Content-Type","text/json"):"html"===e.dataType&&c.setRequestHeader("Content-Type","text/html")),!0!==e.cache&&(c.setRequestHeader("pragma","no-cache"),c.setRequestHeader("cache-control","no-cache")),!0===e.withCredentials&&(c.withCredentials=!0),"function"==typeof e.beforeSend&&e.beforeSend(c),"function"==typeof h.beforeSend&&h.beforeSend(c),document.ajax&&"function"==typeof document.ajax.beforeSend&&document.ajax.beforeSend(c),c.onerror=function(){e.error&&"function"==typeof e.error&&e.error({message:"Network error: Unable to reach the server.",status:0})},c.ontimeout=function(){e.error&&"function"==typeof e.error&&e.error({message:"Request timed out after "+c.timeout+"ms.",status:0})},c.onload=function(){if(c.status>=200&&c.status<300)if("json"===e.dataType)try{var t=JSON.parse(c.responseText);e.success&&"function"==typeof e.success&&e.success(t)}catch(i){e.error&&"function"==typeof e.error&&e.error(i,t)}else t="blob"===e.dataType?c.response:c.responseText,e.success&&"function"==typeof e.success&&e.success(t);else e.error&&"function"==typeof e.error&&e.error(c.responseText,c.status);if(h.queue&&h.queue.length>0&&h.send(h.queue.shift()),h.requests&&h.requests.length){var i=h.requests.indexOf(c);h.requests.splice(i,1),h.requests.length||e.complete&&"function"==typeof e.complete&&e.complete(t),e.group&&h.oncomplete&&"function"==typeof h.oncomplete[e.group]&&(h.pending(e.group)||(h.oncomplete[e.group](),h.oncomplete[e.group]=null)),e.multiple&&e.multiple.instance&&(i=e.multiple.instance.indexOf(c),e.multiple.instance.splice(i,1),e.multiple.instance.length||e.multiple.complete&&"function"==typeof e.multiple.complete&&e.multiple.complete(t))}},c.options=e,c.data=a,!0===e.queue&&h.requests.length>0?h.queue.push(c):h.send(c),c}).send=function(e){e.data?Array.isArray(e.data)?e.send(e.data.join("&")):e.send(e.data):e.send(),h.requests.push(e)},h.exists=function(e,t){var i=new XMLHttpRequest;i.open("HEAD",e,!1),i.send(),i.status&&t(i.status)},h.pending=function(e){var t=0,i=h.requests;if(i&&i.length)for(var n=0;n<i.length;n++)e&&e!=i[n].options.group||t++;return t},h.oncomplete={},h.requests=[],h.queue=[],h);var u=function(){const e={loading:{}};return e.loading.show=function(t){e.loading.element||(e.loading.element=document.createElement("div"),e.loading.element.className="jloading"),document.body.appendChild(e.loading.element),t>0&&setTimeout((function(){e.loading.hide()}),1e3*t)},e.loading.hide=function(){e.loading.element&&e.loading.element.parentNode&&document.body.removeChild(e.loading.element)},e.slideLeft=function(e,t,i){1==t?(e.classList.add("jslide-left-in"),setTimeout((function(){e.classList.remove("jslide-left-in"),"function"==typeof i&&i()}),400)):(e.classList.add("jslide-left-out"),setTimeout((function(){e.classList.remove("jslide-left-out"),"function"==typeof i&&i()}),400))},e.slideRight=function(e,t,i){!0===t?(e.classList.add("jslide-right-in"),setTimeout((function(){e.classList.remove("jslide-right-in"),"function"==typeof i&&i()}),400)):(e.classList.add("jslide-right-out"),setTimeout((function(){e.classList.remove("jslide-right-out"),"function"==typeof i&&i()}),400))},e.slideTop=function(e,t,i){!0===t?(e.classList.add("jslide-top-in"),setTimeout((function(){e.classList.remove("jslide-top-in"),"function"==typeof i&&i()}),400)):(e.classList.add("jslide-top-out"),setTimeout((function(){e.classList.remove("jslide-top-out"),"function"==typeof i&&i()}),400))},e.slideBottom=function(e,t,i){!0===t?(e.classList.add("jslide-bottom-in"),setTimeout((function(){e.classList.remove("jslide-bottom-in"),"function"==typeof i&&i()}),400)):(e.classList.add("jslide-bottom-out"),setTimeout((function(){e.classList.remove("jslide-bottom-out"),"function"==typeof i&&i()}),100))},e.fadeIn=function(e,t){e.style.display="",e.classList.add("jfade-in"),setTimeout((function(){e.classList.remove("jfade-in"),"function"==typeof t&&t()}),2e3)},e.fadeOut=function(e,t){e.classList.add("jfade-out"),setTimeout((function(){e.style.display="none",e.classList.remove("jfade-out"),"function"==typeof t&&t()}),1e3)},e}();var p=function(){var t={now:function(e,t){var i=null,n=null,s=null,r=null,a=null,l=null;return Array.isArray(e)?(i=e[0],n=e[1],s=e[2],r=e[3],a=e[4],l=e[5]):(e||(e=new Date),i=e.getFullYear(),n=e.getMonth()+1,s=e.getDate(),r=e.getHours(),a=e.getMinutes(),l=e.getSeconds()),1==t?o.two(i)+"-"+o.two(n)+"-"+o.two(s):o.two(i)+"-"+o.two(n)+"-"+o.two(s)+" "+o.two(r)+":"+o.two(a)+":"+o.two(l)},toArray:function(e){var t=(i=e.split(-1!==e.indexOf("T")?"T":" "))[1],i=i[0].split("-"),n=parseInt(i[0]),s=parseInt(i[1]),r=parseInt(i[2]),o=0,a=0;return t&&(t=t.split(":"),o=parseInt(t[0]),a=parseInt(t[1])),[n,s,r,o,a,0]}},i=Date.UTC(1900,0,0),n=Date.UTC(1900,1,29),s=864e5;t.dateToNum=function(e){"string"==typeof e&&(e=new Date(e+"  GMT+0"));var t=e.getTime();return t>=n&&(t+=s),(t-=i)/s},t.numToDate=function(e){var r=i+e*s;r>=n&&(r-=s);const o=new Date(r);var a=[o.getUTCFullYear(),o.getUTCMonth()+1,o.getUTCDate(),o.getUTCHours(),o.getUTCMinutes(),o.getUTCSeconds()];return t.now(a)};let r=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],a=["January","February","March","April","May","June","July","August","September","October","November","December"];return Object.defineProperty(t,"weekdays",{get:function(){return r.map((function(t){return e.translate(t)}))}}),Object.defineProperty(t,"weekdaysShort",{get:function(){return r.map((function(t){return e.translate(t).substring(0,3)}))}}),Object.defineProperty(t,"months",{get:function(){return a.map((function(t){return e.translate(t)}))}}),Object.defineProperty(t,"monthsShort",{get:function(){return a.map((function(t){return e.translate(t).substring(0,3)}))}}),t}();var f=function(){var e={text:["@"],currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],scientific:["0{1}(.{1}0+)?E{1}\\+0+"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:["YYYY","YYY","YY","MMMMM","MMMM","MMM","MM","DDDDD","DDDD","DDD","DD","DY","DAY","WD","D","Q","MONTH","MON","HH24","HH12","HH","\\[H\\]","H","AM/PM","MI","SS","MS","Y","M"],general:["A","0","[0-9a-zA-Z$]+","."]},i=function(){if(-1!==this.mask.toLowerCase().indexOf("[h]")){var e=0;this.date[4]&&(e=parseFloat(this.date[4]/60));var t=parseInt(this.date[3])+e;t/=24}else this.date[0]&&this.date[1]&&this.date[2]||!this.date[3]&&!this.date[4]?(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),t=o.two(this.date[0])+"-"+o.two(this.date[1])+"-"+o.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(t+=" "+o.two(this.date[3])+":"+o.two(this.date[4])+":"+o.two(this.date[5]))):t=o.two(this.date[3])+":"+o.two(this.date[4])+":"+o.two(this.date[5]);return t},n=function(){var e="";if(this.date[0]&&this.date[1]&&this.date[2]||!this.date[3]&&!this.date[4]){if(this.date[0]||this.date[1]||this.date[2]||this.date[3]||this.date[4]||this.date[5]){this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1);var t=p.now(this.date);e=p.dateToNum(t),this.date[4]&&(e+=parseFloat(this.date[4]/60))}}else{if(-1!==this.mask.toLowerCase().indexOf("[h]"))e=parseInt(this.date[3]);else{let t=parseInt(this.date[3]);e=t<13&&-1!==this.values.indexOf("PM")?(t+12)%24:t%24}this.date[4]&&(e+=parseFloat(this.date[4]/60)),this.date[5]&&(e+=parseFloat(this.date[5]/3600)),e/=24}return isNaN(e)&&(e=""),e},s=function(e){return null===e||""===e||void 0===e},r=function(e){return"currency"===e||"percentage"===e||"scientific"===e||"numeric"===e},a=function(e){if(e&&Number(e)==e)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var t=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=t[1]}return e||(e=this.mask),(t=new RegExp("0{1}(.{1})0+","ig").exec(e))&&t[1]&&1==t[1].length?(this.options.decimal=t[1],t[1]):((t=new RegExp("#{1}(.{1})#+","ig").exec(e))&&t[1]&&1==t[1].length?","===t[1]?this.options.decimal=".":this.options.decimal=",":this.options.decimal="1.1".toLocaleString().substring(1,2),this.options.decimal?this.options.decimal:null)},l=function(e,t){if(""==e)return"";t||(t=a.call(this));var i=(e=(""+e).split(t))[0].match(/[-]+/g);return i=!(!i||!i.length),e[0]=e[0].match(/[0-9]+/g),e[0]?(i&&e[0].unshift("-"),e[0]=e[0].join("")):i&&(e[0]="-"),e[0]||e[1]?(void 0!==e[1]&&(e[1]=e[1].match(/[0-9]+/g),e[1]?e[1]=e[1].join(""):e[1]=""),e):""},c=function(e,t){if(""===e)return"";var i=a.call(this),n=this.options;if(""===(e=l.call(this,e)))return"";var s=null;if(e[0]&&(s="percent"===n.style?parseFloat(e[0])/100:parseFloat(e[0]+".1")),("-"===e[0]||"-00"===e[0])&&!e[1]&&t&&"deleteContentBackward"==t.inputType)return"";var r=new Intl.NumberFormat(this.locale,n).format(s);if(r=r.split(i),"percent"===n.style&&-1!==r[0].indexOf("%")&&(r[0]=r[0].replace("%",""),r[2]="%"),void 0!==r[1]){var o=r[1].replace(/[0-9]*/g,"");o&&(r[2]=o)}return void 0!==e[1]?r[1]=i+e[1]:r[1]="",r.join("")},h=function(e,t){var i=f.call(e);if(i){var n=c.call(this,i,t),s=n.length-i.length,r=u.call(e)+s;f.call(e,n,r,!0)}},d=function(e){var t=l.call(this,e);return t?("-"===t[0]&&(t[0]="-0"),parseFloat(t.join("."))):null},u=function(e,t){if(void 0===e){if("DIV"==this.tagName){var i=0;return(o=window.getSelection())&&0!==o.rangeCount&&((s=(a=o.getRangeAt(0)).cloneRange()).selectNodeContents(this),s.setEnd(a.endContainer,a.endOffset),i=s.toString().length),i}return this.selectionStart}var n=f.call(this);if(t){for(var s=null,r=0;r<n.length;r++)(n[r].match(/[\-0-9]/g)||"."===n[r]||","===n[r])&&(s=r);null===s&&(s=n.indexOf(" ")),e>=s&&(e=s+1)}if(e>n.length&&(e=n.length),e)if("DIV"==this.tagName){var o=window.getSelection(),a=document.createRange();this.childNodes[0]&&(a.setStart(this.childNodes[0],e),o.removeAllRanges(),o.addRange(a))}else this.selectionStart=e,this.selectionEnd=e},f=function(e,t,i){if("DIV"==this.tagName){if(void 0===e)return e=this.innerText,this.value&&this.value.length>e.length&&(e=this.value),e;this.innerText!==e&&(this.innerText=e,t&&u.call(this,t,i))}else{if(void 0===e)return this.value;this.value!==e&&(this.value=e,t&&u.call(this,t,i))}},m=p.weekdays,g=p.weekdaysShort,v=p.months,_=p.monthsShort,b={YEAR:function(e,t){var i=""+(new Date).getFullYear();void 0===this.values[this.index]&&(this.values[this.index]=""),parseInt(e)>=0&&parseInt(e)<=10&&this.values[this.index].length<t&&(this.values[this.index]+=e),this.values[this.index].length==t&&(2==t?i=i.substr(0,2)+this.values[this.index]:3==t?i=i.substr(0,1)+this.values[this.index]:4==t&&(i=this.values[this.index]),this.date[0]=i,this.index++)},YYYY:function(e){b.YEAR.call(this,e,4)},YYY:function(e){b.YEAR.call(this,e,3)},YY:function(e){b.YEAR.call(this,e,2)},FIND:function(e,t){if(s(this.values[this.index])&&(this.values[this.index]=""),this.event&&this.event.inputType&&this.event.inputType.indexOf("delete")>-1)this.values[this.index]+=e;else{for(var i=0,n=0,r=(this.values[this.index]+e).toLowerCase(),o=0;o<t.length;o++)0==t[o].toLowerCase().indexOf(r)&&(i=o,n++);if(n>1)this.values[this.index]+=e;else if(1==n){var a=t[i].length-this.values[this.index].length-1;return this.position+=a,this.values[this.index]=t[i],this.index++,i}}},MMM:function(e){var t=b.FIND.call(this,e,_);void 0!==t&&(this.date[1]=t+1)},MON:function(e){b.MMM.call(this,e)},MMMM:function(e){var t=b.FIND.call(this,e,v);void 0!==t&&(this.date[1]=t+1)},MONTH:function(e){b.MMMM.call(this,e)},MMMMM:function(e){s(this.values[this.index])&&(this.values[this.index]="");for(var t=(this.values[this.index]+e).toLowerCase(),i=0;i<v.length;i++)if(0==v[i][0].toLowerCase().indexOf(t)){this.values[this.index]=v[i][0],this.date[1]=i+1,this.index++;break}},MM:function(e){s(this.values[this.index])?parseInt(e)>1&&parseInt(e)<10?(this.date[1]=this.values[this.index]="0"+e,this.index++):parseInt(e)<2&&(this.values[this.index]=e):(1==this.values[this.index]&&parseInt(e)<3||0==this.values[this.index]&&parseInt(e)>0&&parseInt(e)<10)&&(this.date[1]=this.values[this.index]+=e,this.index++)},M:function(e){var t=!1;if(parseInt(e)>=0&&parseInt(e)<10?s(this.values[this.index])?(this.values[this.index]=e,e>1&&(this.date[1]=this.values[this.index],this.index++)):1==this.values[this.index]&&parseInt(e)<3||0==this.values[this.index]&&parseInt(e)>0?(this.date[1]=this.values[this.index]+=e,this.index++):t=!0:t=!0,1==t){var i=parseInt(this.values[this.index]);i>0&&i<12&&(this.date[1]=this.values[this.index],this.index++,this.position--)}},D:function(e){var t=!1;if(parseInt(e)>=0&&parseInt(e)<10?s(this.values[this.index])?(this.values[this.index]=e,parseInt(e)>3&&(this.date[2]=this.values[this.index],this.index++)):3==this.values[this.index]&&parseInt(e)<2||1==this.values[this.index]||2==this.values[this.index]||0==this.values[this.index]&&parseInt(e)>0?(this.date[2]=this.values[this.index]+=e,this.index++):t=!0:t=!0,1==t){var i=parseInt(this.values[this.index]);i>0&&i<32&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},DD:function(e){s(this.values[this.index])?parseInt(e)>3&&parseInt(e)<10?(this.date[2]=this.values[this.index]="0"+e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):(3==this.values[this.index]&&parseInt(e)<2||(1==this.values[this.index]||2==this.values[this.index])&&parseInt(e)<10||0==this.values[this.index]&&parseInt(e)>0&&parseInt(e)<10)&&(this.date[2]=this.values[this.index]+=e,this.index++)},DDD:function(e){b.FIND.call(this,e,g)},DY:function(e){b.DDD.call(this,e)},DDDD:function(e){b.FIND.call(this,e,m)},DAY:function(e){b.DDDD.call(this,e)},HH12:function(e,t){s(this.values[this.index])?parseInt(e)>1&&parseInt(e)<10?(t&&(e=0+e),this.date[3]=this.values[this.index]=e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):(1==this.values[this.index]&&parseInt(e)<3||this.values[this.index]<1&&parseInt(e)<10)&&(this.date[3]=this.values[this.index]+=e,this.index++)},HH24:function(e,t){parseInt(e)>=0&&parseInt(e)<10&&(null==this.values[this.index]||""==this.values[this.index]?parseInt(e)>2&&parseInt(e)<10?(t&&(e=0+e),this.date[3]=this.values[this.index]=e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):(2==this.values[this.index]&&parseInt(e)<4||this.values[this.index]<2&&parseInt(e)<10)&&(t||"0"!==this.values[this.index]||(this.values[this.index]=""),this.date[3]=this.values[this.index]+=e,this.index++))},HH:function(e){b.HH24.call(this,e,1)},H:function(e){b.HH24.call(this,e,0)},"\\[H\\]":function(e){null==this.values[this.index]&&(this.values[this.index]=""),e.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=e:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(e,t){null==this.values[this.index]||""==this.values[this.index]?parseInt(e)>5&&parseInt(e)<10?(this.date[t]=this.values[this.index]="0"+e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):parseInt(e)<10&&(this.date[t]=this.values[this.index]+=e,this.index++)},MI:function(e){b.N60.call(this,e,4)},SS:function(e){b.N60.call(this,e,5)},"AM/PM":function(e){void 0===this.values[this.index]&&(this.values[this.index]=""),""===this.values[this.index]?e.match(/a/i)&&this.date[3]<13?this.values[this.index]+="A":e.match(/p/i)&&(this.values[this.index]+="P"):"A"!==this.values[this.index]&&"P"!==this.values[this.index]||(this.values[this.index]+="M",this.index++)},WD:function(e){void 0===this.values[this.index]&&(this.values[this.index]=""),parseInt(e)>=0&&parseInt(e)<7&&(this.values[this.index]=e),1==this.values[this.index].length&&this.index++},"0{1}(.{1}0+)?":function(e){var t=a.call(this),i=!1;s(this.values[this.index])?this.values[this.index]="":"-"==this.values[this.index]&&(i=!0);var n=l.call(this,this.values[this.index],t);n&&(this.values[this.index]=n.join(t)),parseInt(e)>=0&&parseInt(e)<10?("0"==this.values[this.index]&&e>0?this.values[this.index]="":"-0"==this.values[this.index]&&e>0&&(this.values[this.index]="-"),("0"!=this.values[this.index]&&"-0"!=this.values[this.index]||e==t)&&(this.values[this.index]+=e)):t&&e==t?-1==this.values[this.index].indexOf(t)&&(this.values[this.index]||(this.values[this.index]="0"),this.values[this.index]+=e):"-"==e&&(i=!0),!0===i&&"-"!==this.values[this.index][0]&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?E{1}\\+0+":function(e){b["0{1}(.{1}0+)?"].call(this,e)},"0{1}(.{1}0+)?%":function(e){b["0{1}(.{1}0+)?"].call(this,e),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&-1==this.values[this.index].indexOf("%")&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(e){b["0{1}(.{1}0+)?"].call(this,e);var t=a.call(this),i=this.tokens[this.index].substr(1,1),n="-"===this.values[this.index][0],s=l.call(this,this.values[this.index],t);if(""!==s){var r=s[0].match(/[0-9]/g);if(r){for(var o=[],c=0,h=(r=r.join("")).length-1;h>=0;h--)o.push(r[h]),++c%3||o.push(i);o=o.reverse(),s[0]=o.join(""),s[0].substr(0,1)==i&&(s[0]=s[0].substr(1))}else s[0]="";this.values[this.index]=s.join(t),n&&(this.values[this.index]="-"+this.values[this.index])}},0:function(e){e.match(/[0-9]/g)&&(this.values[this.index]=e,this.index++)},"[0-9a-zA-Z$]+":function(e){s(this.values[this.index])&&(this.values[this.index]="");var t=this.tokens[this.index];t[this.values[this.index].length]==e?(this.values[this.index]+=e,this.values[this.index]==t&&this.index++):(this.values[this.index]=t,this.index++,e.match(/[\-0-9]/g)&&this.position--)},A:function(e){e.match(/[a-zA-Z]/gi)&&(this.values[this.index]=e,this.index++)},".":function(e){b["[0-9a-zA-Z$]+"].call(this,e)},"@":function(e){s(this.values[this.index])&&(this.values[this.index]=""),this.values[this.index]+=e}},y=function(t){if("general"==this.type)var i=[].concat(e.general);else i=[].concat(e.currency,e.datetime,e.percentage,e.scientific,e.numeric,e.text,e.general);var n=new RegExp(i.join("|"),"gi");return t.match(n)},C=function(t){if(this.type)i="text"==this.type?["text"]:"general"==this.type?["general"]:"datetime"==this.type?["numeric","datetime","general"]:["currency","percentage","scientific","numeric","general"];else var i=Object.keys(e);for(var n=0;n<i.length;n++)for(var s=i[n],r=0;r<e[s].length;r++){var o=new RegExp(e[s][r],"gi");if(t.match(o))return{type:s,method:e[s][r]}}},w=function(e){for(var t=[],i=0;i<e.length;i++){var n=C.call(this,e[i]);n?t.push(n.method):t.push(null)}for(i=0;i<t.length;i++)"MM"==t[i]&&(t[i-1]&&t[i-1].indexOf("H")>=0||t[i-2]&&t[i-2].indexOf("H")>=0||t[i+1]&&t[i+1].indexOf("S")>=0||t[i+2]&&t[i+2].indexOf("S")>=0)&&(t[i]="MI");return t},S=function(e){var t=C.call(this,e);if(t)var i=t.type;if(i){for(var n=0,s=y.call(this,e),o=0;o<s.length;o++)(t=C.call(this,s[o]))&&r(t.type)&&n++;n>1&&(i="general")}return i},E=function(){"function"==typeof b[this.methods[this.index]]?(b[this.methods[this.index]].call(this,this.value[this.position]),this.position++):(this.values[this.index]=this.tokens[this.index],this.index++)},x=function(e){return(""+ +e).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,(function(e,t,i,n,s){return s<0?t+"0."+Array(1-s-i.length).join(0)+i+n:t+i+n+Array(s-n.length+1).join(0)}))},T=function(e,t,n){var s=null,l={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if("object"==typeof e){if(l.input=e.target,l.value=f.call(e.target),l.caret=u.call(e.target),(s=e.target.getAttribute("data-mask"))&&(l.mask=s),(s=e.target.getAttribute("data-type"))&&(l.type=s),e.target.mask?(e.target.mask.options&&(l.options=e.target.mask.options),e.target.mask.locale&&(l.locale=e.target.mask.locale)):(s=e.target.getAttribute("data-locale"))&&(l.locale=s,l.mask&&(l.options.style=l.mask)),e.target.attributes&&e.target.attributes.length)for(var p=0;p<e.target.attributes.length;p++){var m=e.target.attributes[p].name,g=e.target.attributes[p].value;"data"==m.substr(0,4)&&(l.options[m.substr(5)]=g)}}else{if("string"==typeof t)l.mask=t;else for(m=Object.keys(t),p=0;p<m.length;p++)l[m[p]]=t[m[p]];"number"==typeof e&&(a.call(l,l.mask),e=(""+e).replace(".",l.options.decimal)),l.value=e,l.input&&(f.call(l.input,e),o.focus(l.input),l.caret=u.call(l.input))}if("="!=(""+l.value)[0]&&(l.mask||l.locale)){var v;if(l.mask&&(l.mask=l.mask.replace(new RegExp(/\[h]/),"|h|"),l.mask=l.mask.replace(new RegExp(/\[.*?\]/),""),l.mask=l.mask.replace(new RegExp(/\|h\|/),"[h]"),-1!==l.mask.indexOf(";")&&(s=l.mask.split(";"),l.mask=s[0]),-1!==l.mask.indexOf("##")&&((v=l.mask.split(";"))[0]&&("object"==typeof e&&(v[0]=v[0].replace(new RegExp(/_\)/g),""),v[0]=v[0].replace(new RegExp(/_\(/g),"")),v[0]=v[0].replace("*","\t"),v[0]=v[0].replace(new RegExp(/_-/g),""),v[0]=v[0].replace(new RegExp(/_/g),""),v[0]=v[0].replace(new RegExp(/"/g),""),v[0]=v[0].replace("##0.###","##0.000"),v[0]=v[0].replace("##0.##","##0.00"),v[0]=v[0].replace("##0.#","##0.0"),v[0]=v[0].replace("##0,###","##0,000"),v[0]=v[0].replace("##0,##","##0,00"),v[0]=v[0].replace("##0,#","##0,0")),l.mask=v[0]),-1!==l.mask.indexOf("\\")&&((v=l.mask.split(";"))[0]=v[0].replace(new RegExp(/\\/g),""),l.mask=v[0]),l.type||(l.type=S.call(l,l.mask)),l.tokens=y.call(l,l.mask)),"object"!=typeof e||!e.inputType||!e.inputType.indexOf("insert")||!e.inputType.indexOf("delete"))if(l.locale)if(l.input)h.call(l,l.input,e);else var _=c.call(l,l.value);else{for(l.methods=w.call(l,l.tokens),l.event=e;l.position<l.value.length&&void 0!==l.tokens[l.index];)E.call(l);if(_=l.values.join(""),r(l.type)&&""!==_){for(;void 0!==l.tokens[l.index];)(s=C.call(l,l.tokens[l.index]))&&"general"==s.type&&(l.values[l.index]=l.tokens[l.index]),l.index++;var b=!0}else b=!1;if(_=l.values.join(""),l.input){if((s=_.length-l.value.length)>0)var x=l.caret+s;else x=l.caret;f.call(l.input,_,x,b)}}if(l.input){var A=null;if(r(l.type)){let e=f.call(l.input);l.number=d.call(l,e),A="percentage"==l.type&&-1!==(""+e).indexOf("%")?T.adjustPrecision(l.number/100):l.number}else"datetime"==l.type&&(A=i.call(l),l.date[0]&&l.date[1]&&l.date[2]&&l.input.setAttribute("data-completed",!0));A&&l.input.setAttribute("data-value",A)}if(void 0!==_)return n?l:_}};return T.adjustPrecision=function(e){if("number"==typeof e&&!Number.isInteger(e)){const t=e.toString().split(".");if(t[1]&&t[1].length>10){let i=0;const n=t[1][t[1].length-2];if(0==n||9==n){for(let e=t[1].length-2;e>0;e--){if(!(i>=0&&t[1][e]==n)){i=0;break}if(i++,i>6)break}if(i)return parseFloat(parseFloat(e).toFixed(t[1].length-1))}}}return e},T.getType=S,T.prepare=function(e,t){return t||(t={}),y.call(t,e)},T.apply=function(e){var t=f.call(e.target);1==e.key.length&&(t+=e.key),f.call(e.target,T(t,e.target.getAttribute("data-mask")))},T.run=function(e,t,i){return T(e,{mask:t,decimal:i})},T.extract=function(e,t,i){if(s(e))return e;if("object"!=typeof t)return e;if((t=Object.assign({},t)).options||(t.options={}),!t.mask&&t.format&&(t.mask=t.format),t.mask){if(-1!==t.mask.indexOf(";")){var r=t.mask.split(";");t.mask=r[0]}t.mask=t.mask.replace(new RegExp(/\[h]/),"|h|"),t.mask=t.mask.replace(new RegExp(/\[.*?\]/),""),t.mask=t.mask.replace(new RegExp(/\|h\|/),"[h]")}a.call(t,t.mask);var l=null,c=null;if("percent"==t.type||"percent"==t.options.style?l="percentage":t.mask&&(l=S.call(t,t.mask)),"text"===l){var h={};c=e}else"general"===l?(h=T(e,t,!0),c=e):"datetime"===l?(e instanceof Date&&(e=T.getDateString(e,t.mask)),h=T(e,t,!0),c=o.isNumeric(e)?e:n.call(h)):"scientific"===l?(c=e,"string"==typeof e&&(c=Number(c)),h=t):(c=d.call(t,e),"percentage"===l&&-1!==(""+e).indexOf("%")&&(c/=100),h=t);return h.value=c,!h.type&&l&&(h.type=l),i?h:c},T.render=function(e,i,n,r){if(s(e))return e;if("object"!=typeof i)return e;if((i=Object.assign({},i)).options||(i.options={}),!i.mask&&i.format&&(i.mask=i.format),i.mask){if(-1!==i.mask.indexOf(";")){var o=i.mask.split(";");n||(o[0]=o[0].replace(new RegExp(/_\)/g),""),o[0]=o[0].replace(new RegExp(/_\(/g),"")),i.mask=o[0]}i.mask=i.mask.replace(new RegExp(/\[h]/),"|h|"),i.mask=i.mask.replace(new RegExp(/\[.*?\]/),""),i.mask=i.mask.replace(new RegExp(/\|h\|/),"[h]")}var l=null;"percent"==i.type||"percent"==i.options.style?l="percentage":i.mask?l=S.call(i,i.mask):e instanceof Date&&(l="datetime");var c=!1;if("datetime"==l||"calendar"==i.type)(o=T.getDateString(e,i.mask))&&(e=o),i.mask&&n&&(c=!0);else if("text"===l);else if("string"==typeof e&&t.isNumeric(e)&&(e=Number(e)),"percentage"===l&&(e=T.adjustPrecision(100*e)),"number"==typeof e){if(o=null,i.mask&&n){var h=a.call(i,i.mask);if("scientific"===l)if(-1!==i.mask.indexOf(h)){let t=i.mask.split("E");t=t[0].split(h),t=""+t[1].match(/[0-9]+/g),t=t.length,o=e.toExponential(t)}else o=e.toExponential(0);else{if(-1!==i.mask.indexOf(h)){h=(h=""+(h=i.mask.split(h))[1].match(/[0-9]+/g)).length,o=e.toFixed(h);let t=e.toString().split("."),n=t[1];n&&n.length>h&&"5"===n[n.length-1]&&(o=parseFloat(t[0]+"."+n+"1").toFixed(h))}else-1!==e.toString().indexOf(h)&&(o=e.toFixed(0));-1!==(""+o).indexOf("e")&&(o=x(o))}}else if(i.locale&&n){if(h=(""+e).split("."),i.options){void 0===h[1]&&(h[1]="");var d=h[1].length;if(i.options.minimumFractionDigits>d)for(var u=0;u<i.options.minimumFractionDigits-d;u++)h[1]+="0"}o=h[1].length?h.join("."):h[0],d=h[1].length,i.options&&i.options.maximumFractionDigits<d&&(o=parseFloat(o).toFixed(i.options.maximumFractionDigits))}else o=x(e);null!==o&&(e=o,a.call(i,i.mask),i.options.decimal&&(e=e.replace(".",i.options.decimal)))}else i.mask&&n&&(c=!0);if(c){var p=i.mask.length-e.length;if(p>0)for(u=0;u<p;u++)e+=" "}if("scientific"===l){if(n)return e;e=x(e)}if("numeric"===l&&!1===r&&"string"==typeof e)return e;if(e=T(e,i),n&&"numeric"===l){var f=i.mask.match(new RegExp(/^[0]+$/gm));if(f&&1===f.length){var m=f[0].length;if(m>3)for(e=""+e;e.length<m;)e="0"+e}}return e},T.set=function(e,t){if(t){e.setAttribute("data-mask",t);var i=new Event("input",{bubbles:!0,cancelable:!0});e.dispatchEvent(i)}},T.extractDateFromString=function(e,t){var i=T(e,{mask:t},!0);if(e>0&&Number(e)==e&&(i.values.join("")!==i.value||"numeric"==i.type)){var n=new Date(Math.round(86400*(e-25569)*1e3));return n.getFullYear()+"-"+o.two(n.getMonth())+"-"+o.two(n.getDate())+" 00:00:00"}var s=!1;return i.values&&i.values.length===i.tokens.length&&i.values[i.values.length-1].length>=i.tokens[i.tokens.length-1].length&&(s=!0),i.date[0]&&i.date[1]&&(i.date[2]||s)?(i.date[2]||(i.date[2]=1),i.date[0]+"-"+o.two(i.date[1])+"-"+o.two(i.date[2])+" "+o.two(i.date[3])+":"+o.two(i.date[4])+":"+o.two(i.date[5])):""},T.getDateString=function(e,t){if(t||(t={}),t&&"object"==typeof t)if(t.format)var i=t.format;else t.mask&&(i=t.mask);else i=t;if(i||(i="YYYY-MM-DD"),i.indexOf("[h]")>=0){var n=0;if(e&&o.isNumeric(e)&&(n=parseFloat(24*Number(e)),i.indexOf("mm")>=0)){if((d=(""+n).split("."))[1]){var s=60*parseFloat("0."+d[1]);s=parseFloat(s.toFixed(2))}else s=0;n=parseInt(d[0])+":"+o.two(s)}return n}e instanceof Date?e=p.now(e):e&&o.isNumeric(e)&&(e=p.numToDate(e));for(var r=new RegExp(["DAY","WD","DDDD","DDD","DD","D","Q","HH24","HH12","HH","H","AM/PM","MI","SS","MS","YYYY","YYY","YY","Y","MONTH","MON","MMMMM","MMMM","MMM","MM","M","."].join("|"),"gi"),a=i.match(r),l=0;l<a.length;l++)"MM"==a[l].toUpperCase()&&(a[l-1]&&a[l-1].toUpperCase().indexOf("H")>=0||a[l-2]&&a[l-2].toUpperCase().indexOf("H")>=0||a[l+1]&&a[l+1].toUpperCase().indexOf("S")>=0||a[l+2]&&a[l+2].toUpperCase().indexOf("S")>=0)&&(a[l]="mi");var c={tokens:a};if(e){var h=-1!==(s=""+e).indexOf("T")?"T":" ",d=0,u=0,f=0;(s=s.split(h))[1]&&(u=(d=s[1].split(":"))[1]?d[1]:0,f=d[2]?d[2]:0,d=d[0]?d[0]:0),s=s[0].split("-");let t=new Date(s[0],s[1],0).getDate();if(s[0]&&s[1]&&s[2]&&s[0]>0&&s[1]>0&&s[1]<13&&s[2]>0&&s[2]<=t){c.data=[s[0],s[1],s[2],d,u,f],c.value=[];var m=new Date(c.data[0],c.data[1]-1,c.data[2],c.data[3],c.data[4],c.data[5]),g=function(e){var t=this.tokens[e],i=t.toUpperCase(),n=null;"YYYY"===i?n=this.data[0]:"YYY"===i?n=this.data[0].substring(1,4):"YY"===i?n=this.data[0].substring(2,4):"Y"===i?n=this.data[0].substring(3,4):"MON"===t?n=p.months[m.getMonth()].substr(0,3).toUpperCase():"mon"===t?n=p.months[m.getMonth()].substr(0,3).toLowerCase():"MONTH"===t?n=p.months[m.getMonth()].toUpperCase():"month"===t?n=p.months[m.getMonth()].toLowerCase():"MMMMM"===i?n=p.months[m.getMonth()].substr(0,1):"MMMM"===i||"Month"===t?n=p.months[m.getMonth()]:"MMM"===i||"Mon"==t?n=p.months[m.getMonth()].substr(0,3):"MM"===i?n=o.two(this.data[1]):"M"===i?n=m.getMonth()+1:"DAY"===t?n=p.weekdays[m.getDay()].toUpperCase():"day"===t?n=p.weekdays[m.getDay()].toLowerCase():"DDDD"===i||"Day"==t?n=p.weekdays[m.getDay()]:"DDD"===i?n=p.weekdays[m.getDay()].substr(0,3):"DD"===i?n=o.two(this.data[2]):"D"===i?n=parseInt(this.data[2]):"Q"===i?n=Math.floor((m.getMonth()+3)/3):"HH24"===i||"HH"===i?((n=this.data[3])>12&&-1!==this.tokens.indexOf("am/pm")&&(n-=12),n=o.two(n)):"HH12"===i?n=this.data[3]>12?o.two(this.data[3]-12):o.two(this.data[3]):"H"===i?(n=this.data[3])>12&&-1!==this.tokens.indexOf("am/pm")&&(n-=12,n=o.two(n)):"MI"===i?n=o.two(this.data[4]):"SS"===i?n=o.two(this.data[5]):"MS"===i?n=m.getMilliseconds():"AM/PM"===i?n=this.data[3]>=12?"PM":"AM":"WD"===i&&(n=p.weekdays[m.getDay()]),this.value[e]=null===n?this.tokens[e]:n};for(l=0;l<c.tokens.length;l++)g.call(c,l);e=c.value.join("")}else e=""}return e},T}();var m=function(){var t=function(n,s){if(n.calendar)return n.calendar.setOptions(s,!0);var r={type:"calendar",options:{},date:null,setOptions:function(i,s){var a={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:p.monthsShort,monthsFull:p.months,weekdays:p.weekdays,textDone:e.translate("Done"),textReset:e.translate("Reset"),textUpdate:e.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null,controls:!0,autoSelect:!0};for(var l in a)i&&i.hasOwnProperty(l)?r.options[l]=i[l]:void 0!==r.options[l]&&!0!==s||(r.options[l]=a[l]);if(0==r.options.resetButton?d.style.display="none":d.style.display="",r.options.readonly?n.setAttribute("readonly","readonly"):n.removeAttribute("readonly"),r.options.placeholder?n.setAttribute("placeholder",r.options.placeholder):n.removeAttribute("placeholder"),o.isNumeric(r.options.value)&&r.options.value>0&&(r.options.value=t.numToDate(r.options.value),r.options.dataType="numeric"),d.innerHTML=r.options.textReset,f.innerHTML=r.options.textDone,E.innerHTML=r.options.textUpdate,r.options.format&&n.setAttribute("data-mask",r.options.format.toLowerCase()),!r.options.value&&r.options.today)var c=t.now();else c=r.options.value;return c&&(r.options.value=null,r.setValue(c)),r},open:function(e){if(!h.classList.contains("jcalendar-focus")&&!h.classList.contains("jcalendar-inline")){if(t.current=r,i(r,!0),r.getDays(),"year-month-picker"==r.options.type&&r.getMonths(),r.options.time&&(x.value=r.date[3],T.value=r.date[4]),h.classList.add("jcalendar-focus"),o.getWindowWidth()<800||r.options.fullscreen)h.classList.add("jcalendar-fullsize"),u.slideBottom(g,1);else{h.classList.remove("jcalendar-fullsize");var s=n.getBoundingClientRect(),a=g.getBoundingClientRect();if(r.options.position)m.style.position="fixed",window.innerHeight<s.bottom+a.height?m.style.top=s.top-(a.height+2)+"px":m.style.top=s.top+s.height+2+"px",m.style.left=s.left+"px";else if(window.innerHeight<s.bottom+a.height?((l=-1*(s.height+a.height+2))+s.top<0&&(l=-1*(s.top+s.height)),m.style.top=l+"px"):m.style.top="2px",window.innerWidth<s.left+a.width){var l=window.innerWidth-(s.left+a.width+20);m.style.left=l+"px"}else m.style.left="0px"}"function"==typeof r.options.onopen&&r.options.onopen(n)}},close:function(e,s){if(!0!==r.options.autoSelect&&void 0===s&&(s=!1),h.classList.contains("jcalendar-focus")){if(!1!==s){var o=h.querySelector(".jcalendar-selected");if("string"==typeof s)var a=s;else a=!o||o.classList.contains("jcalendar-disabled")?r.options.value:r.getValue();r.setValue(a)}else{let e=r.options.value||"";r.options.value=null,r.setValue(e)}e||"function"!=typeof r.options.onclose||r.options.onclose(n),h.classList.remove("jcalendar-focus"),i(r,!1),t.current=null}return r.options.value},prev:function(){"years"==r.options.mode?(r.date[0]=r.date[0]-12,r.getYears()):"months"==r.options.mode?(r.date[0]=parseInt(r.date[0])-1,r.getMonths()):(r.date[1]<2?(r.date[0]=r.date[0]-1,r.date[1]=12):r.date[1]=r.date[1]-1,r.getDays())},next:function(){"years"==r.options.mode?(r.date[0]=parseInt(r.date[0])+12,r.getYears()):"months"==r.options.mode?(r.date[0]=parseInt(r.date[0])+1,r.getMonths()):(r.date[1]>11?(r.date[0]=parseInt(r.date[0])+1,r.date[1]=1):r.date[1]=parseInt(r.date[1])+1,r.getDays())},setToday:function(){var e=(new Date).toISOString().substr(0,10);return r.setValue(e),e},setValue:function(i){i||(i=""+i);var s=i,o=r.options.value;if(o!=s){if(s){r.setLabel(s,r.options),(l=s.split(" "))[1]||(l[1]="00:00:00");var a=l[1].split(":"),l=l[0].split("-"),c=parseInt(l[0]),h=parseInt(l[1]),d=parseInt(l[2]),u=parseInt(a[0]),p=parseInt(a[1]);r.date=[c,h,d,u,p,0],i=r.setLabel(s,r.options);var f=t.now(new Date(c,h-1,d),!0);if(r.options.validRange){if(!r.options.validRange[0]||f>=r.options.validRange[0])var m=!0;else m=!1;if(!r.options.validRange[1]||f<=r.options.validRange[1])var g=!0;else g=!1;m&&g?(n.classList.remove("jcalendar_warning"),n.title=""):(n.classList.add("jcalendar_warning"),n.title=e.translate("Date outside the valid range"))}else n.classList.remove("jcalendar_warning"),n.title=""}else{r.date=null;i="";n.classList.remove("jcalendar_warning"),n.title=""}r.options.value=s,"function"==typeof r.options.onchange&&r.options.onchange(n,s,o),n.value!=i&&(n.value=i,"function"==typeof n.oninput&&n.oninput({type:"input",target:n,value:n.value}))}r.date&&(r.getDays(),"year-month-picker"==r.options.type&&r.getMonths())},getValue:function(){return r.date?r.options.time?o.two(r.date[0])+"-"+o.two(r.date[1])+"-"+o.two(r.date[2])+" "+o.two(r.date[3])+":"+o.two(r.date[4])+":"+o.two(0):o.two(r.date[0])+"-"+o.two(r.date[1])+"-"+o.two(r.date[2])+" "+o.two(0)+":"+o.two(0)+":"+o.two(0):""},update:function(e,t){if(e.classList.contains("jcalendar-disabled"));else{var i=h.querySelector(".jcalendar-selected");i&&i.classList.remove("jcalendar-selected"),e.classList.add("jcalendar-selected"),e.classList.contains("jcalendar-set-month")?(r.date[1]=t,r.date[2]=1):r.date[2]=e.innerText,r.options.time?(r.date[3]=x.value,r.date[4]=T.value):r.close(null,!0)}c()},reset:function(){r.setValue(""),r.date=null,r.close(!1,!1)},getDays:function(){r.options.mode="days";var e=new Date,i=r.date&&o.isNumeric(r.date[0])?r.date[0]:parseInt(e.getFullYear()),n=r.date&&o.isNumeric(r.date[1])?r.date[1]:parseInt(e.getMonth())+1,s=r.date&&o.isNumeric(r.date[2])?r.date[2]:parseInt(e.getDate()),a=r.date&&o.isNumeric(r.date[3])?r.date[3]:parseInt(e.getHours()),l=r.date&&o.isNumeric(r.date[4])?r.date[4]:parseInt(e.getMinutes());r.date=[i,n,s,a,l,0],v.innerHTML=i,_.innerHTML=r.options.months[n-1];var h=e.getMonth()==n-1&&e.getFullYear()==i,d=e.getDate(),u=(e=new Date(i,n,0,0,0)).getDate(),p=(e=new Date(i,n-1,0,0,0)).getDay()+1;p-=m=r.options.startingDay||0,y.innerHTML="",(C=document.createElement("tr")).setAttribute("align","center"),y.appendChild(C);for(var f=0;f<7;f++)(S=document.createElement("td")).classList.add("jcalendar-weekday"),S.innerHTML=r.options.weekdays[m].substr(0,1),C.appendChild(S),++m>6&&(m=0);for(var m=0,g=0,b=0;b<6;b++){var C;for((C=document.createElement("tr")).setAttribute("align","center"),C.style.height="34px",f=0;f<7;f++){var S;if((S=document.createElement("td")).classList.add("jcalendar-set-day"),m>=p&&m<p+u){g++,S.innerHTML=g,g==s&&S.classList.add("jcalendar-selected"),h&&d==g&&(S.style.fontWeight="bold");var E=t.now(new Date(i,n-1,g),!0);if(r.options.validRange){if(!r.options.validRange[0]||E>=r.options.validRange[0])var x=!0;else x=!1;if(!r.options.validRange[1]||E<=r.options.validRange[1])var T=!0;else T=!1;x&&T||S.classList.add("jcalendar-disabled")}}C.appendChild(S),m++}y.appendChild(C)}r.options.time?w.style.display="":w.style.display="none",c()},getMonths:function(){r.options.mode="months";var e=r.options.months,t=(r.options.value,new Date),i=parseInt(t.getFullYear()),n=parseInt(t.getMonth())+1,s=r.date&&o.isNumeric(r.date[0])?r.date[0]:i,a=r.date&&o.isNumeric(r.date[1])?r.date[1]:n;v.innerHTML=r.date[0],_.innerHTML=e[a-1];var l=document.createElement("table");l.setAttribute("width","100%");for(var h=null,d=0;d<12;d++){d%4||((h=document.createElement("tr")).setAttribute("align","center"),l.appendChild(h));var u=document.createElement("td");if(u.classList.add("jcalendar-set-month"),u.setAttribute("data-value",d+1),u.innerText=e[d],r.options.validRange){var p=s+"-"+o.two(d+1);if(!r.options.validRange[0]||p>=r.options.validRange[0].substr(0,7))var f=!0;else f=!1;if(!r.options.validRange[1]||p<=r.options.validRange[1].substr(0,7))var m=!0;else m=!1;f&&m||u.classList.add("jcalendar-disabled")}d+1==a&&u.classList.add("jcalendar-selected"),i==s&&d+1==n&&(u.style.fontWeight="bold"),h.appendChild(u)}y.innerHTML='<tr><td colspan="7"></td></tr>',y.children[0].children[0].appendChild(l),c()},getYears:function(){r.options.mode="years";for(var e=new Date,t=e.getFullYear(),i=r.date&&o.isNumeric(r.date[0])?r.date[0]:parseInt(e.getFullYear()),n=[],s=0;s<25;s++)n[s]=parseInt(r.date[0])+(s-12);var a=document.createElement("table");for(a.setAttribute("width","100%"),s=0;s<25;s++){if(!(s%5)){var l=document.createElement("tr");l.setAttribute("align","center"),a.appendChild(l)}var h=document.createElement("td");h.classList.add("jcalendar-set-year"),h.innerText=n[s],i==n[s]&&h.classList.add("jcalendar-selected"),t==n[s]&&(h.style.fontWeight="bold"),l.appendChild(h)}y.innerHTML='<tr><td colspan="7"></td></tr>',y.firstChild.firstChild.appendChild(a),c()},setLabel:function(e,i){return t.getDateString(e,i)},fromFormatted:function(e,i){return t.extractDateFromString(e,i)}},a=function(e){if(o.findElement(e.target,"jcalendar-container")){var t=e.target.className;if("jcalendar-prev"==t)r.prev();else if("jcalendar-next"==t)r.next();else if("jcalendar-month"==t)r.getMonths();else if("jcalendar-year"==t)r.getYears();else if("jcalendar-set-year"==t)r.date[0]=e.target.innerText,"year-month-picker"==r.options.type?r.getMonths():r.getDays();else if(e.target.classList.contains("jcalendar-set-month")){var i=parseInt(e.target.getAttribute("data-value"));"year-month-picker"==r.options.type?r.update(e.target,i):(r.date[1]=i,r.getDays())}else"jcalendar-confirm"==t||"jcalendar-update"==t||"jcalendar-close"==t?r.close(null,!0):"jcalendar-backdrop"==t?r.close(!1,!1):"jcalendar-reset"==t?r.reset():e.target.classList.contains("jcalendar-set-day")&&e.target.innerText&&r.update(e.target)}else r.close(!1,!1)},l=function(e){if(e.target.value&&e.target.value.length>3){var i=t.extractDateFromString(e.target.value,r.options.format);i&&r.setValue(i)}},c=function(){var e=h.querySelector(".jcalendar-selected");e&&e.classList.contains("jcalendar-disabled")?(E.setAttribute("disabled","disabled"),x.setAttribute("disabled","disabled"),T.setAttribute("disabled","disabled")):(E.removeAttribute("disabled"),x.removeAttribute("disabled"),T.removeAttribute("disabled")),"function"==typeof r.options.onupdate&&r.options.onupdate(n,r.getValue())},h=null,d=null,f=null,m=null,g=null,v=null,_=null,b=null,y=null,C=null,w=null,S=null,E=null,x=null,T=null;return function(){"INPUT"==n.tagName&&n.value&&(s.value=n.value),(d=document.createElement("div")).className="jcalendar-reset",(f=document.createElement("div")).className="jcalendar-confirm",(C=document.createElement("div")).className="jcalendar-controls",C.style.borderBottom="1px solid #ddd",C.appendChild(d),C.appendChild(f),(m=document.createElement("div")).className="jcalendar-container",(g=document.createElement("div")).className="jcalendar-content",m.appendChild(g),"DIV"==n.tagName?(h=n).classList.add("jcalendar-inline"):(g.appendChild(C),(h=document.createElement("div")).className="jcalendar"),h.classList.add("jcalendar-container"),h.appendChild(m);var e=document.createElement("div");e.className="jcalendar-table",g.appendChild(e);var i=document.createElement("td");i.setAttribute("colspan","2"),i.className="jcalendar-prev",(v=document.createElement("span")).className="jcalendar-year",(_=document.createElement("span")).className="jcalendar-month";var c=document.createElement("td");c.className="jcalendar-header",c.setAttribute("colspan","3"),c.appendChild(_),c.appendChild(v);var p=document.createElement("td");p.setAttribute("colspan","2"),p.className="jcalendar-next";var A=document.createElement("thead"),O=document.createElement("tr");O.appendChild(i),O.appendChild(c),O.appendChild(p),A.appendChild(O),b=document.createElement("table"),y=document.createElement("tbody"),b.setAttribute("cellpadding","0"),b.setAttribute("cellspacing","0"),b.appendChild(A),b.appendChild(y),e.appendChild(b),(x=document.createElement("select")).className="jcalendar-select",x.onchange=function(){r.date[3]=this.value,"function"==typeof r.options.onupdate&&r.options.onupdate(n,r.getValue())};for(var I=0;I<24;I++)(k=document.createElement("option")).value=I,k.innerHTML=o.two(I),x.appendChild(k);for((T=document.createElement("select")).className="jcalendar-select",T.onchange=function(){r.date[4]=this.value,"function"==typeof r.options.onupdate&&r.options.onupdate(n,r.getValue())},I=0;I<60;I++){var k;(k=document.createElement("option")).value=I,k.innerHTML=o.two(I),T.appendChild(k)}var D=document.createElement("div");D.className="jcalendar-controls",(w=document.createElement("div")).className="jcalendar-time",w.style.maxWidth="140px",w.appendChild(x),w.appendChild(T),(E=document.createElement("button")).setAttribute("type","button"),E.className="jcalendar-update",(S=document.createElement("div")).style.flexGrow="10",S.appendChild(E),D.appendChild(w),"INPUT"==n.tagName&&D.appendChild(S),g.appendChild(D);var j=document.createElement("div");j.className="jcalendar-backdrop",h.appendChild(j),n.addEventListener("keyup",l),h.addEventListener("swipeleft",(function(e){u.slideLeft(b,0,(function(){r.next(),u.slideRight(b,1)})),e.preventDefault(),e.stopPropagation()})),h.addEventListener("swiperight",(function(e){u.slideRight(b,0,(function(){r.prev(),u.slideLeft(b,1)})),e.preventDefault(),e.stopPropagation()})),"ontouchend"in document.documentElement==1?(h.addEventListener("touchend",a),n.addEventListener("touchend",r.open)):(h.addEventListener("mouseup",a),n.addEventListener("mouseup",r.open)),t.hasEvents||(t.hasEvents=!0,document.addEventListener("keydown",t.keydown)),r.setOptions(s),"INPUT"==n.tagName?(n.parentNode.insertBefore(h,n.nextSibling),n.setAttribute("autocomplete","off"),n.classList.add("jcalendar-input"),n.value=r.setLabel(r.getValue(),r.options)):(r.getDays(),r.options.time&&(x.value=r.date[3],T.value=r.date[4])),1==r.options.opened&&r.open(),0==r.options.controls&&m.classList.add("jcalendar-hide-controls"),n.change=r.setValue,n.val=function(e){if(void 0===e)return r.getValue();r.setValue(e)},n.calendar=h.calendar=r}(),r};return t.keydown=function(e){var i=null;(i=t.current)&&(13==e.which?i.close(!1,!0):27==e.which&&i.close(!1,!1))},t.prettify=function(e,t){t||(t={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"}),-1===e.indexOf("GMT")&&-1===e.indexOf("Z")&&(e+=" GMT");var i=new Date,n=new Date(e),s=parseInt((i-n)/1e3/60);if(String.prototype.format=function(e){return this.replace("{0}",e)},0==s)var r=t.justNow;else r=s<90?t.xMinutesAgo.format(s):s<1440?t.xHoursAgo.format(Math.round(s/60)):s<20160?t.xDaysAgo.format(Math.round(s/1440)):s<43200?t.xWeeksAgo.format(Math.round(s/10080)):s<1036800?t.xMonthsAgo.format(Math.round(s/43200)):t.xYearsAgo.format(Math.round(s/525600));return r},t.prettifyAll=function(){for(var e=document.querySelectorAll(".prettydate"),i=0;i<e.length;i++)e[i].getAttribute("data-date")?e[i].innerHTML=t.prettify(e[i].getAttribute("data-date")):e[i].innerHTML&&(e[i].setAttribute("title",e[i].innerHTML),e[i].setAttribute("data-date",e[i].innerHTML),e[i].innerHTML=t.prettify(e[i].innerHTML))},t.now=p.now,t.toArray=p.toArray,t.dateToNum=p.dateToNum,t.numToDate=p.numToDate,t.weekdays=p.weekdays,t.months=p.months,t.weekdaysShort=p.weekdaysShort,t.monthsShort=p.monthsShort,t.extractDateFromString=f.extractDateFromString,t.getDateString=f.getDateString,t}();var g=function(){var e={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]],chart:[["#C1D37F","#4C5454","#FFD275","#66586F","#D05D5B","#C96480","#95BF8F","#6EA240","#0F0F0E","#EB8258","#95A3B3","#995D81"]]},t=function(t){return e[t]?e[t]:e.material};return t.get=function(t){return e[t]?e[t]:e},t.set=function(t,i){e[t]=i},t}();function v(e,t){var i={options:{}},n={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null,maxWidth:null};for(var s in n)t&&t.hasOwnProperty(s)?i.options[s]=t[s]:i.options[s]=n[s];e.classList.add("jtabs");var r=null,o=null,a=null;const c=function(e){i.options.animation&&setTimeout((function(){let t=i.headers.children[e].getBoundingClientRect();"modern"===i.options.palette?(a.style.width=t.width-4+"px",a.style.left=i.headers.children[e].offsetLeft+2+"px"):(a.style.width=t.width+"px",a.style.left=i.headers.children[e].offsetLeft+"px"),"bottom"===i.options.position?a.style.top="0px":a.style.bottom="0px"}),50)};var h=function(e){"function"==typeof i.headers.scrollTo?i.headers.scrollTo({left:e,behavior:"smooth"}):i.headers.scrollLeft=e,e<=1?r.classList.add("disabled"):r.classList.remove("disabled"),e>=i.headers.scrollWidth-i.headers.offsetWidth?o.classList.add("disabled"):o.classList.remove("disabled"),i.headers.scrollWidth<=i.headers.offsetWidth?(r.style.display="none",o.style.display="none"):(r.style.display="",o.style.display="")};if(i.setBorder=c,i.open=function(t){if(Array.from(i.content.children),i.content.children[t]){for(var n=null,s=0;s<i.headers.children.length;s++)i.headers.children[s].classList.contains("jtabs-selected")&&(n=s),i.headers.children[s].classList.remove("jtabs-selected"),i.content.children[s]&&i.content.children[s].classList.remove("jtabs-selected");if(i.headers.children[t].classList.add("jtabs-selected"),i.content.children[t]&&i.content.children[t].classList.add("jtabs-selected"),n!=t&&"function"==typeof i.options.onchange&&i.content.children[t]&&i.options.onchange(e,i,t,i.headers.children[t],i.content.children[t]),1==i.options.hideHeaders&&i.headers.children.length<3&&0==i.options.allowCreate)i.headers.parentNode.style.display="none";else{i.headers.parentNode.style.display="";var r=i.headers.children[t].offsetLeft,o=r+i.headers.children[t].offsetWidth,a=i.headers.scrollLeft,l=a+i.headers.offsetWidth;a<=r&&l>=o||h(r-1),c(t)}}},i.selectIndex=function(e){var t=Array.prototype.indexOf.call(i.headers.children,e);return t>=0&&i.open(t),t},i.rename=function(e,t){t||(t=prompt("New title",i.headers.children[e].innerText)),i.headers.children[e].innerText=t,c(i.getActive())},i.create=function(t,n){if("function"==typeof i.options.onbeforecreate){var s=i.options.onbeforecreate(e,t);if(!1===s)return!1;t=s}var r=i.appendElement(t);return"function"==typeof i.options.oncreate&&i.options.oncreate(e,r),c(i.getActive()),r},i.remove=function(e){return i.deleteElement(e)},i.nextNumber=function(){for(var e=0,t=0;t<i.headers.children.length;t++){var n=i.headers.children[t].innerText.match(/[0-9].*/);n>e&&(e=parseInt(n))}return e?e++:e=1,e},i.deleteElement=function(t){let n=i.getActive();if(!i.headers.children[t])return!1;if(i.headers.removeChild(i.headers.children[t]),i.content.removeChild(i.content.children[t]),n===t)i.open(0);else{let e=i.getActive()||0;c(e)}"function"==typeof i.options.ondelete&&i.options.ondelete(e,t)},i.appendElement=function(e,t,n,s){if(e||(e=prompt("Title?","")),e){var r=document.createElement("div"),o=document.createElement("div");if(o.innerHTML=e,o.content=r,void 0===s)i.content.appendChild(r),i.headers.insertBefore(o,i.headers.lastChild);else{let e=i.content.children[s];e?i.content.insertBefore(r,e):i.content.appendChild(r),e=i.headers.children[s]||i.headers.lastChild,i.headers.insertBefore(o,e)}return i.options.allowChangePosition&&o.setAttribute("draggable","true"),!1!==n&&i.selectIndex(o),"function"==typeof t&&t(r,o),r}},i.getActive=function(){for(var e=0;e<i.headers.children.length;e++)if(i.headers.children[e].classList.contains("jtabs-selected"))return e;return!1},i.updateContent=function(e,t){"string"!=typeof t||(document.createElement("div").innerHTML=t),i.content.children[e].classList.contains("jtabs-selected")&&t.classList.add("jtabs-selected"),i.content.replaceChild(t,i.content.children[e]),c()},i.updatePosition=function(e,t,n,s){if(e>t?i.content.insertBefore(i.content.children[e],i.content.children[t]):i.content.insertBefore(i.content.children[e],i.content.children[t].nextSibling),!1!==s)i.open(t);else{const e=i.getActive();t<e&&i.setBorder(e)}n||"function"!=typeof i.options.onchangeposition||i.options.onchangeposition(i.headers,e,t)},i.move=function(e,t,n,s){e>t?i.headers.insertBefore(i.headers.children[e],i.headers.children[t]):i.headers.insertBefore(i.headers.children[e],i.headers.children[t].nextSibling),i.updatePosition(e,t,n,s)},i.setBorder=c,i.init=function(){e.innerHTML="",i.headers=document.createElement("div"),i.content=document.createElement("div"),i.headers.classList.add("jtabs-headers"),i.content.classList.add("jtabs-content"),i.options.palette?e.classList.add("jtabs-modern"):e.classList.remove("jtabs-modern"),i.options.padding&&(i.content.style.padding=parseInt(i.options.padding)+"px");var t=document.createElement("div");t.className="jtabs-headers-container",t.appendChild(i.headers),i.options.maxWidth&&(t.style.maxWidth=parseInt(i.options.maxWidth)+"px");var n=document.createElement("div");if(n.className="jtabs-controls",n.setAttribute("draggable","false"),t.appendChild(n),"bottom"==i.options.position?(e.appendChild(i.content),e.appendChild(t)):(e.appendChild(t),e.appendChild(i.content)),1==i.options.allowCreate){var s=document.createElement("div");s.className="jtabs-add",s.onclick=function(){i.create()},n.appendChild(s)}(r=document.createElement("div")).className="jtabs-prev",r.onclick=function(){h(i.headers.scrollLeft-i.headers.offsetWidth)},n.appendChild(r),(o=document.createElement("div")).className="jtabs-next",o.onclick=function(){h(i.headers.scrollLeft+i.headers.offsetWidth)},n.appendChild(o);for(var c=0;c<i.options.data.length;c++){if(i.options.data[c].titleElement)var d=i.options.data[c].titleElement;else d=document.createElement("div");if(i.options.data[c].icon){var u=document.createElement("div"),p=document.createElement("i");p.classList.add("material-icons"),p.innerHTML=i.options.data[c].icon,u.appendChild(p),d.appendChild(u)}if(i.options.data[c].title){var f=document.createTextNode(i.options.data[c].title);d.appendChild(f)}if(i.options.data[c].width&&(d.style.width=i.options.data[c].width),i.options.data[c].contentElement)var m=i.options.data[c].contentElement;else(m=document.createElement("div")).innerHTML=i.options.data[c].content;i.headers.appendChild(d),i.content.appendChild(m)}(a=document.createElement("div")).className="jtabs-border",i.headers.appendChild(a),i.options.animation&&e.classList.add("jtabs-animation"),i.headers.addEventListener("click",(function(t){if(t.target.parentNode.classList.contains("jtabs-headers"))var n=t.target;else n="I"==t.target.tagName?t.target.parentNode.parentNode:t.target.parentNode;var s=i.selectIndex(n);"function"==typeof i.options.onclick&&i.options.onclick(e,i,s,i.headers.children[s],i.content.children[s])})),i.headers.addEventListener("contextmenu",(function(e){i.selectIndex(e.target)})),i.headers.children.length&&i.open(0),h(0),1==i.options.allowChangePosition&&l(i.headers,{direction:1,ondrop:function(e,t,n){i.updatePosition(t,n)}}),"function"==typeof i.options.onload&&i.options.onload(e,i)},e.children[0]&&e.children[0].children.length)for(var u=0;u<e.children[0].children.length;u++){var p=i.options.data&&i.options.data[u]?i.options.data[u]:{};e.children[1]&&e.children[1].children[u]?(p.titleElement=e.children[0].children[u],p.contentElement=e.children[1].children[u]):p.contentElement=e.children[0].children[u],i.options.data[u]=p}var f=!1;if(i.options.data)for(u=0;u<i.options.data.length;u++)i.options.data[u].url&&(d({url:i.options.data[u].url,type:"GET",dataType:"text/html",index:u,success:function(e){i.options.data[this.index].content=e},complete:function(){i.init()}}),f=!0);return f||i.init(),e.tabs=i,i}function _(e,t){if(e.color)return e.color.setOptions(t,!0);var n={type:"color",options:{}},s=null,r=null,a=null,l=null,c=null,h=null,d=null;n.setOptions=function(t,i){var s={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};for(var r in t||(t={}),t&&!t.palette&&(t.palette=g()),s)t&&t.hasOwnProperty(r)?n.options[r]=t[r]:void 0!==n.options[r]&&!0!==i||(n.options[r]=s[r]);return l&&(l.innerHTML=n.options.resetLabel),c&&(c.innerHTML=n.options.doneLabel),n.options.palette&&d&&d.updateContent(0,b()),"string"==typeof n.options.value&&(e.value=n.options.value,"INPUT"===e.tagName&&(e.style.color=e.value,e.style.backgroundColor=e.value)),n.options.placeholder?e.setAttribute("placeholder",n.options.placeholder):e.getAttribute("placeholder")&&e.removeAttribute("placeholder"),n},n.select=function(e){var t=s.querySelector(".jcolor-selected");t&&t.classList.remove("jcolor-selected"),n.values[e]&&n.values[e].classList.add("jcolor-selected"),n.options.value=e},n.open=function(){if(!s.classList.contains("jcolor-focus")){i(n,!0),s.classList.add("jcolor-focus"),n.options.value&&n.select(n.options.value),a.style.marginTop="",a.style.marginLeft="";var t=a.getBoundingClientRect(),l=o.getWindowWidth(),c=o.getWindowHeight();if(l<800||1==n.options.fullscreen?(a.classList.add("jcolor-fullscreen"),u.slideBottom(a,1),r.style.display="block"):(a.classList.contains("jcolor-fullscreen")&&(a.classList.remove("jcolor-fullscreen"),r.style.display=""),n.options.position?a.style.position="fixed":a.style.position="",t.left+t.width>l&&(a.style.marginLeft=-1*(t.left+t.width-(l-20))+"px"),t.top+t.height>c&&(a.style.marginTop=-1*(t.top+t.height-(c-20))+"px")),"function"==typeof n.options.onopen&&n.options.onopen(e,n),d.setBorder(d.getActive()),n.options.value){var h=_(n.options.value);T.forEach((function(e,t){e.value=h[t],e.dispatchEvent(new Event("input"))}))}}},n.close=function(t){return s.classList.contains("jcolor-focus")&&(s.classList.remove("jcolor-focus"),r.style.display="",t||"function"!=typeof n.options.onclose||n.options.onclose(e,n),i(n,!1)),n.options.value},n.setValue=function(t){t||(t=""),t!=n.options.value&&(n.options.value=t,x=t,n.select(t),"function"==typeof n.options.onchange&&n.options.onchange(e,t,n),e.value!=n.options.value&&(e.value=n.options.value,"INPUT"===e.tagName&&(e.style.color=e.value,e.style.backgroundColor=e.value),"function"==typeof e.oninput&&e.oninput({type:"input",target:e,value:e.value})),1==n.options.closeOnChange&&n.close())},n.getValue=function(){return n.options.value};var p=function(e){var t=e.toString(16);return 1===t.length?"0"+t:t},f=function(e,t,i){return"#"+p(e)+p(t)+p(i)},m=function(e){return parseInt("0x"+e)},_=function(e){return[m(e.substr(1,2)),m(e.substr(3,2)),m(e.substr(5,2))]},b=function(){var e=document.createElement("div");e.className="jcolor-grid",n.values=[];var t=document.createElement("table");t.setAttribute("cellpadding","7"),t.setAttribute("cellspacing","0");for(var i=0;i<n.options.palette.length;i++){for(var s=document.createElement("tr"),r=0;r<n.options.palette[i].length;r++){var o=document.createElement("td"),a=n.options.palette[i][r];a.length<7&&"#"!==a.substr(0,1)&&(a="#"+a),o.style.backgroundColor=a,o.setAttribute("data-value",a),o.innerHTML="",s.appendChild(o),n.options.value==a&&o.classList.add("jcolor-selected"),n.values[a]=o}t.appendChild(s)}return e.appendChild(t),e},y=document.createElement("canvas");y.width=200,y.height=160;var C=y.getContext("2d"),w=function(){var e=h.firstChild.getBoundingClientRect();y.width=e.width-14,S()},S=function(){var e=C.createLinearGradient(0,0,y.width,0);e.addColorStop(0,"rgb(255,0,0)"),e.addColorStop(.15,"rgb(255,0,255)"),e.addColorStop(.33,"rgb(0,0,255)"),e.addColorStop(.49,"rgb(0,255,255)"),e.addColorStop(.67,"rgb(0,255,0)"),e.addColorStop(.84,"rgb(255,255,0)"),e.addColorStop(1,"rgb(255,0,0)"),C.fillStyle=e,C.fillRect(0,0,y.width,y.height),(e=C.createLinearGradient(0,0,0,y.height)).addColorStop(0,"rgba(255,255,255,1)"),e.addColorStop(.5,"rgba(255,255,255,0)"),e.addColorStop(.5,"rgba(0,0,0,0)"),e.addColorStop(1,"rgba(0,0,0,1)"),C.fillStyle=e,C.fillRect(0,0,y.width,y.height)},E=function(){var e=document.createElement("div");e.className="jcolor-hsl";var t=document.createElement("div");t.className="jcolor-point";var i=document.createElement("div");i.appendChild(y),i.appendChild(t),e.appendChild(i);var n=function(i,n,s){if(1===i){var r=e.getBoundingClientRect(),o=n-r.left,a=s-r.top;o<0&&(o=0),a<0&&(a=0),o>r.width&&(o=r.width),a>r.height&&(a=r.height),t.style.left=o+"px",t.style.top=a+"px";var l=C.getImageData(o,a,1,1).data;x=f(l[0],l[1],l[2])}};return e.addEventListener("mousedown",(function(e){n(e.buttons,e.clientX,e.clientY)})),e.addEventListener("mousemove",(function(e){n(e.buttons,e.clientX,e.clientY)})),e.addEventListener("touchmove",(function(e){n(1,e.changedTouches[0].clientX,e.changedTouches[0].clientY)})),e},x="",T=[],A=function(){var e=document.createElement("div");e.className="jcolor-sliders";var t=document.createElement("div"),i=function(e){var i=document.createElement("div");i.className="jcolor-sliders-input-container";var n=document.createElement("label");n.innerText=e;var s=document.createElement("div");s.className="jcolor-sliders-input-subcontainer";var r=document.createElement("input");r.type="range",r.min=0,r.max=255,r.value=0,i.appendChild(n),s.appendChild(r);var o=document.createElement("div");return o.innerText=r.value,r.addEventListener("input",(function(){o.innerText=r.value})),s.appendChild(o),i.appendChild(s),t.appendChild(i),r};T=[i("Red"),i("Green"),i("Blue")],e.appendChild(t);var n=document.createElement("div");n.className="jcolor-sliders-final-color";var s=document.createElement("div");s.style.visibility="hidden",s.innerText="a",n.appendChild(s);return T.forEach((function(e){e.addEventListener("input",(function(){var e;e=f(parseInt(T[0].value),parseInt(T[1].value),parseInt(T[2].value)),s.innerText=e,s.style.color=e,s.style.removeProperty("visibility"),x=e,function(){if(""!==x)for(var e=0;e<T.length;e++){var t=_(x);t[e]=0;var i="linear-gradient(90deg, rgb(";i+=t.join(", "),i+="), rgb(",t[e]=255,i+=t.join(", "),i+="))",T[e].style.backgroundImage=i}}()}))})),e.appendChild(n),e};return n.toHex=function(e){var t=function(e){return("0"+parseInt(e).toString(16)).slice(-2)};if(e)return/^#[0-9A-F]{6}$/i.test(e)?e:(e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/))&&e.length?"#"+t(e[1])+t(e[2])+t(e[3]):""},function(){n.setOptions(t),"INPUT"==e.tagName&&(e.classList.add("jcolor-input"),e.readOnly=!0),(s=document.createElement("div")).className="jcolor",(r=document.createElement("div")).className="jcolor-backdrop",s.appendChild(r),(a=document.createElement("div")).className="jcolor-content";var i=document.createElement("div");i.className="jcolor-controls",a.appendChild(i),(l=document.createElement("div")).className="jcolor-reset",l.innerHTML=n.options.resetLabel,i.appendChild(l),(c=document.createElement("div")).className="jcolor-close",c.innerHTML=n.options.doneLabel,i.appendChild(c),h=document.createElement("div"),a.appendChild(h),d=v(h,{animation:!0,data:[{title:"Grid",contentElement:b()},{title:"Spectrum",contentElement:E()},{title:"Sliders",contentElement:A()}],onchange:function(e,t,i){if(1===i)w();else{var s=""!==x?x:n.getValue();if(2===i&&s){var r=_(s);T.forEach((function(e,t){e.value=r[t],e.dispatchEvent(new Event("input"))}))}}},palette:"modern"}),s.appendChild(a),"INPUT"==e.tagName?e.parentNode.insertBefore(s,e.nextSibling):e.appendChild(s),s.addEventListener("click",(function(e){if("TD"==e.target.tagName){var t=e.target.getAttribute("data-value");t&&n.setValue(t)}else e.target.classList.contains("jcolor-reset")?(n.setValue(""),n.close()):e.target.classList.contains("jcolor-close")?(d.getActive()>0&&n.setValue(x),n.close()):e.target.classList.contains("jcolor-backdrop")?n.close():n.open()})),e.addEventListener("mouseup",(function(e){n.open()})),window.addEventListener("resize",(function(){s.classList.contains("jcolor-focus")&&1==d.getActive()&&w()})),1==n.options.opened&&n.open(),e.change=n.setValue,e.val=function(e){if(void 0===e)return n.getValue();n.setValue(e)},e.color=n,s.color=n}(),n}var b=function(){var t=function(n,s){var r={type:"contextmenu",options:{}},o={items:null,onclick:null};for(var a in o)s&&s.hasOwnProperty(a)?r.options[a]=s[a]:r.options[a]=o[a];function l(e){if(!e.type||"line"!=e.type&&"divisor"!=e.type){c=document.createElement("div");var t=document.createElement("a");if(t.innerHTML=e.title,e.tooltip&&c.setAttribute("title",e.tooltip),e.icon&&c.setAttribute("data-icon",e.icon),e.id&&(c.id=e.id),e.disabled?c.className="jcontextmenu-disabled":e.onclick&&(c.method=e.onclick,c.addEventListener("mousedown",(function(e){e.preventDefault()})),c.addEventListener("mouseup",(function(e){this.method(this,e)}))),c.appendChild(t),e.submenu){var i=document.createElement("span");i.innerHTML="&#9658;",c.appendChild(i),c.classList.add("jcontexthassubmenu");var n=document.createElement("div");n.classList.add("jcontextmenu"),n.setAttribute("tabindex","900");for(var s=e.submenu,r=0;r<s.length;r++){var o=l(s[r]);n.appendChild(o)}c.appendChild(n)}else if(e.shortcut){var a=document.createElement("span");a.innerHTML=e.shortcut,c.appendChild(a)}}else var c=document.createElement("hr");return c}return n.classList.add("jcontextmenu"),r.open=function(e,s){if(s&&(r.options.items=s,r.create(s)),t.current&&t.current.close(),i(r,!0),n.classList.add("jcontextmenu-focus"),t.current=r,r.options.items&&r.options.items.length>0||n.children.length){if(e.target)if(e.changedTouches&&e.changedTouches[0])o=e.changedTouches[0].clientX,a=e.changedTouches[0].clientY;else var o=e.clientX,a=e.clientY;else o=e.x,a=e.y;var l=n.getBoundingClientRect();if(window.innerHeight<a+l.height){var c=a-l.height;c<0&&(c=0),n.style.top=c+"px"}else n.style.top=a+"px";window.innerWidth<o+l.width?o-l.width>0?n.style.left=o-l.width+"px":n.style.left="10px":n.style.left=o+"px"}},r.isOpened=function(){return!!n.classList.contains("jcontextmenu-focus")},r.close=function(){n.classList.contains("jcontextmenu-focus")&&n.classList.remove("jcontextmenu-focus"),i(r,!1)},r.create=function(t){n.innerHTML="";var i=function(){var t=document.createElement("div");t.classList.add("header"),t.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation()}));var i=document.createElement("a");i.classList.add("title"),i.innerHTML=e.translate("Menu"),t.appendChild(i);var n=document.createElement("a");return n.classList.add("close"),n.innerHTML=e.translate("close"),n.addEventListener("click",(function(e){r.close()})),t.appendChild(n),t}();n.appendChild(i);for(var s=0;s<t.length;s++){var o=l(t[s]);n.appendChild(o)}},"function"==typeof r.options.onclick&&n.addEventListener("click",(function(e){r.options.onclick(r,e)})),r.options.items&&r.create(r.options.items),window.addEventListener("mousewheel",(function(){r.close()})),n.contextmenu=r,r};return t}();var C=function(){var t=function(n,s){if(n.dropdown)return n.dropdown.setOptions(s,!0);var r={type:"dropdown",options:{}},a=function(e,t){e&&e.length&&(!1!==r.options.sortResults&&("function"==typeof r.options.sortResults?e.sort(r.options.sortResults):e.sort(l)),r.setData(e)),"function"==typeof r.options.onload&&r.options.onload(n,r,e,t),t&&p(t),null==t&&(r.options.value=""),n.value=r.options.value,1==r.options.opened&&r.open()},l=function(e,t){var i,n;return"string"==typeof e?i=e:e.text?i=e.text:e.name&&(i=e.name),"string"==typeof t?n=t:t.text?n=t.text:t.name&&(n=t.name),"string"==typeof i||"string"==typeof n?("string"!=typeof i&&(i=""+i),"string"!=typeof n&&(n=""+n),i.localeCompare(n)):i-n},h=function(){r.value={};for(var e=0;e<r.items.length;e++)1==r.items[e].selected&&(r.items[e].element&&r.items[e].element.classList.remove("jdropdown-selected"),r.items[e].selected=null);r.options.value="",n.value=""},p=function(e){if(h(),null!==e)if(e){Array.isArray(e)||(e=(""+e).split(";"));for(var t=0;t<e.length;t++)r.value[e[t]]=""}else void 0!==r.value[""]&&(r.value[""]="");for(t=0;t<r.items.length;t++)void 0!==r.value[f(t)]&&(r.items[t].element&&r.items[t].element.classList.add("jdropdown-selected"),r.items[t].selected=!0,r.value[f(t)]=m(t));r.options.value=Object.keys(r.value).join(";"),r.header.value=r.getText()},f=function(e,t){if(r.options.format)i="id";else var i="value";return r.items[e]?void 0!==t?r.items[e].data[i]=t:r.items[e].data[i]:""},m=function(e,t){if(r.options.format)i="name";else var i="text";return r.items[e]?void 0!==t?r.items[e].data[i]=t:r.items[e].data[i]:""},g=function(){return Object.keys(r.value)},v=function(){for(var e=[],t=Object.keys(r.value),i=0;i<t.length;i++)e.push(r.value[t[i]]);return e};r.setOptions=function(e,t){e||(e={});var i={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,onsearch:null,onbeforesearch:null,sortResults:!1,autofocus:!1,prompt:null,allowEmpty:!0};for(var s in i)e&&e.hasOwnProperty(s)?r.options[s]=e[s]:void 0!==r.options[s]&&!0!==t||(r.options[s]=i[s]);return 1!=r.options.remoteSearch&&"searchbar"!==r.options.type||(r.options.autocomplete=!0),1==r.options.newOptions?r.header.classList.add("jdropdown-add"):r.header.classList.remove("jdropdown-add"),1==r.options.autocomplete?r.header.removeAttribute("readonly"):r.header.setAttribute("readonly","readonly"),r.options.placeholder?r.header.setAttribute("placeholder",r.options.placeholder):r.header.removeAttribute("placeholder"),n.classList.remove("jdropdown-searchbar"),n.classList.remove("jdropdown-picker"),n.classList.remove("jdropdown-list"),"searchbar"==r.options.type?n.classList.add("jdropdown-searchbar"):"list"==r.options.type?n.classList.add("jdropdown-list"):"picker"==r.options.type?n.classList.add("jdropdown-picker"):o.getWindowWidth()<800?r.options.autocomplete?(n.classList.add("jdropdown-searchbar"),r.options.type="searchbar"):(n.classList.add("jdropdown-picker"),r.options.type="picker"):(r.options.width?(n.style.width=r.options.width,n.style.minWidth=r.options.width):(n.style.removeProperty("width"),n.style.removeProperty("min-width")),n.classList.add("jdropdown-default"),r.options.type="default"),"searchbar"==r.options.type?_.appendChild(C):b.insertBefore(C,b.firstChild),r.options.url&&!e.data?d({url:r.options.url,method:"GET",dataType:"json",success:function(e){e&&a(e,r.options.value)}}):a(r.options.data,r.options.value),r};var _=null,b=null,y=null,C=null,w=null,S=null,E=null;r.getUrl=function(){return r.options.url},r.setUrl=function(e,t){r.options.url=e,d({url:r.options.url,method:"GET",dataType:"json",success:function(e){r.setData(e),"function"==typeof t&&t(r)}})},r.setId=function(e,t){if(r.options.format)i="id";else var i="value";"object"==typeof e?e[i]=t:r.items[e].data[i]=t};const x=function(t,i){if(!t){let i=1==r.options.autocomplete?r.header.value:"";if(!(t=prompt(e.translate("Add A New Option"),i)))return!1}if(i||(i=o.guid()),r.options.format)n={id:i,name:t};else var n={value:i,text:t};if("function"==typeof r.options.onbeforeinsert){let e=r.options.onbeforeinsert(r,n);if(!1===e)return!1;e&&(n=e)}r.options.data.push(n);var s=r.createItem(n);return y.appendChild(s.element),"function"==typeof r.options.oninsert&&r.options.oninsert(r,n,s),"none"==y.style.display&&(y.style.display=""),r.results&&r.results.push(s),n};r.add=function(e,t){return"function"==typeof r.options.prompt?r.options.prompt.call(r,x):x(e,t)},r.createItem=function(e,t,i){r.options.format?(e.id||void 0===e.value||(e.id=e.value),e.name||void 0===e.text||(e.name=e.text)):(e.value||void 0===e.id||(e.value=e.id),e.text||void 0===e.name||(e.text=e.name));var n={};if(n.element=document.createElement("div"),n.element.className="jdropdown-item",n.element.indexValue=r.items.length,n.data=e,t&&(n.group=t),e.id&&n.element.setAttribute("id",e.id),1==e.disabled&&n.element.setAttribute("data-disabled",!0),e.tooltip&&n.element.setAttribute("title",e.tooltip),e.image){var s=document.createElement("img");s.className="jdropdown-image",s.src=e.image,e.title||s.classList.add("jdropdown-image-small"),n.element.appendChild(s)}else if(e.icon){var o=document.createElement("span");o.className="jdropdown-icon material-icons",o.innerText=e.icon,e.title||o.classList.add("jdropdown-icon-small"),e.color&&(o.style.color=e.color),n.element.appendChild(o)}else if(e.color){var a=document.createElement("div");a.className="jdropdown-color",a.style.backgroundColor=e.color,n.element.appendChild(a)}if(r.options.format)l=e.name;else var l=e.text;var c=document.createElement("div");if(c.className="jdropdown-description",c.textContent=l||"&nbsp;",e.title){var h=document.createElement("div");h.className="jdropdown-title",h.innerText=e.title,c.appendChild(h)}if(r.options.format)d=e.id;else var d=e.value;return r.value[d]&&(n.element.classList.add("jdropdown-selected"),n.selected=!0),r.items.push(n),n.element.appendChild(c),n},r.appendData=function(e){if(e.length){for(var t=[],i=[],n=0;n<e.length;n++)e[n].group?(i[e[n].group]||(i[e[n].group]=[]),i[e[n].group].push(n)):t.push(n);var s=0,o=Object.keys(i);if(o.length>0)for(n=0;n<o.length;n++){var a=document.createElement("div");a.className="jdropdown-group";var l=document.createElement("div");l.className="jdropdown-group-name",l.textContent=o[n];var c=document.createElement("i");c.className="jdropdown-group-arrow jdropdown-group-arrow-down",l.appendChild(c);var h=document.createElement("div");h.className="jdropdown-group-items";for(var d=0;d<i[o[n]].length;d++){var u=r.createItem(e[i[o[n]][d]],a,o[n]);(0==r.options.lazyLoading||s<200)&&(h.appendChild(u.element),s++)}a.appendChild(l),a.appendChild(h),r.groups.push(a),h.children.length>0&&y.appendChild(a)}if(t.length)for(n=0;n<t.length;n++)u=r.createItem(e[t[n]]),(0==r.options.lazyLoading||s<200)&&(y.appendChild(u.element),s++)}},r.setData=function(e){if(h(),y.textContent="",r.header.value="",r.items=[],e&&e.length){for(var t=0;t<e.length;t++)"object"!=typeof e[t]&&(r.options.format?e[t]={id:e[t],name:e[t]}:e[t]={value:e[t],text:e[t]});r.appendData(e),r.options.data=e}else r.options.data=[];r.close()},r.getData=function(){return r.options.data},r.getPosition=function(e){for(var t=0;t<r.items.length;t++)if(f(t)==e)return t;return!1},r.getText=function(e){var t=v();return e?t:t.join("; ")},r.getValue=function(e){var t=g();return e?t:t.join(";")};var T=function(e){n.value!=r.options.value&&(n.value=r.options.value,"function"==typeof n.oninput&&n.oninput({type:"input",target:n,value:n.value})),"function"==typeof r.options.onchange&&r.options.onchange(n,r,e,r.options.value)};r.setValue=function(e){var t=r.getValue();Array.isArray(e)&&(e=e.join(";")),t!==e&&(p(e),T(t))},r.resetSelected=function(){r.setValue(null)},r.selectIndex=function(e,t){if(e=parseInt(e),r.items&&r.items[e]&&(!0===t||!0!==r.items[e].data.disabled))if(r.setCursor(e,!1),r.options.multiple){var i=r.options.value;r.items[e].selected?(r.items[e].element.classList.remove("jdropdown-selected"),r.items[e].selected=!1,delete r.value[f(e)]):(r.items[e].element.classList.add("jdropdown-selected"),r.items[e].selected=!0,r.value[f(e)]=m(e)),r.options.value=Object.keys(r.value).join(";"),0==r.options.autocomplete&&(r.header.value=v().join("; ")),T(i)}else r.items[e].selected?!1!==r.options.allowEmpty&&r.setValue(null):r.setValue(f(e)),r.close()},r.selectItem=function(e){r.selectIndex(e.indexValue)};var A=function(e,t){for(var i=0;i<t.length;i++)if(r.options.format){if(t[i].id==e)return!0}else if(t[i].value==e)return!0;return!1};return r.find=function(e){if(r.search==e.trim())return!1;if(r.search=e,r.setCursor(),r.groups.length)for(var t=0;t<r.groups.length;t++)r.groups[t].lastChild.textContent="";if(y.textContent="",1==r.options.remoteSearch){r.results=null;let t={url:r.options.url,method:"GET",data:{q:e},dataType:"json",success:function(e){r.items=[];var t=Object.keys(r.value);if(t.length)for(var i=0;i<t.length;i++)A(t[i],e)||(r.options.format?e.unshift({id:t[i],name:r.value[t[i]]}):e.unshift({value:t[i],text:r.value[t[i]]}));r.appendData(e),e.length?y.style.display="":y.style.display="none","function"==typeof r.options.onsearch&&r.options.onsearch(r,e)}};if("function"==typeof r.options.onbeforesearch){let e=r.options.onbeforesearch(r,t);if(!1===e)return;"object"==typeof e&&(t=e)}d(t)}else{e=new RegExp(e,"gi");var i=[];for(t=0;t<r.items.length;t++){var n=m(t),s=r.items[t].data.title||"",o=r.items[t].data.group||"",a=r.items[t].data.synonym||"";a&&(a=a.join(" ")),(null==e||1==r.items[t].selected||n.toString().match(e)||s.match(e)||o.match(e)||a.match(e))&&i.push(r.items[t])}if(i.length){y.style.display="",r.results=i;var l=i.length||0;for(1==r.options.lazyLoading&&l>200&&(l=200),t=0;t<l;t++)r.results[t].group?(r.results[t].group.parentNode||y.appendChild(r.results[t].group),r.results[t].group.lastChild.appendChild(r.results[t].element)):y.appendChild(r.results[t].element)}else y.style.display="none",r.results=null}1==r.options.autofocus&&r.first()},r.open=function(){if(!n.classList.contains("jdropdown-focus")){t.current=r,i(r,!0),n.classList.add("jdropdown-focus"),o.getWindowWidth()<800&&(null!=r.options.type&&"picker"!=r.options.type||u.slideBottom(b,1)),1==r.options.autocomplete&&(r.header.value=r.search,r.header.focus());var e=g();if(e[0]){var s=r.getPosition(e[0]);!1!==s&&r.setCursor(s)}if(!r.options.type||"default"==r.options.type){var a=n.getBoundingClientRect(),l=b.getBoundingClientRect();r.options.position?(b.style.position="fixed",window.innerHeight<a.bottom+l.height?(b.style.top="",b.style.bottom=window.innerHeight-a.top+1+"px"):(b.style.top=a.bottom+"px",b.style.bottom=""),b.style.left=a.left+"px"):window.innerHeight<a.bottom+l.height?(b.style.top="",b.style.bottom=a.height+1+"px"):(b.style.top="",b.style.bottom=""),b.style.minWidth=a.width+"px",r.options.maxWidth&&(b.style.maxWidth=r.options.maxWidth),r.items.length||1!=r.options.autocomplete?y.style.display="":y.style.display="none"}}"function"==typeof r.options.onopen&&r.options.onopen(n)},r.close=function(e){return n.classList.contains("jdropdown-focus")&&(r.header.value=r.getText(),r.setCursor(),e||"function"!=typeof r.options.onclose||r.options.onclose(n),r.header.blur&&r.header.blur(),n.classList.remove("jdropdown-focus"),i(r,!1),t.current=null),r.getValue()},r.setCursor=function(e,t){if(null!=r.currentIndex&&r.items&&r.items[r.currentIndex]&&r.items[r.currentIndex].element.classList.remove("jdropdown-cursor"),null==e)r.currentIndex=null;else if(e=parseInt(e),r.items[e].element.parentNode&&(r.items[e].element.classList.add("jdropdown-cursor"),r.currentIndex=e,!1!==t&&r.items[r.currentIndex].element)){y.scrollTop;var i=r.items[r.currentIndex].element;y.scrollTop=i.offsetTop-i.scrollTop+i.clientTop-95}},r.resetCursor=r.setCursor,r.updateCursor=r.setCursor,r.reset=function(){r.setCursor(),r.setValue(null)},r.first=function(){!0===r.options.lazyLoading&&r.loadFirst();var e=y.querySelectorAll(".jdropdown-item");if(e.length){var t=e[0].indexValue;r.setCursor(t)}},r.last=function(){!0===r.options.lazyLoading&&r.loadLast();var e=y.querySelectorAll(".jdropdown-item");if(e.length){var t=e[e.length-1].indexValue;r.setCursor(t)}},r.next=function(e){var t=null;if(e){if(1==e.length){var i=r.currentIndex||-1;e=e.toLowerCase();var n=null,s=null,o=y.querySelectorAll(".jdropdown-item");if(o.length){for(var a=0;a<o.length;a++)if(o[a].indexValue>i&&(n=r.items[o[a].indexValue])&&(s=n.element.innerText[0])&&e==(s=s.toLowerCase())){t=o[a].indexValue;break}r.setCursor(t)}}}else if(null==r.currentIndex||null==r.currentIndex)r.first();else{var l=r.items[r.currentIndex].element,c=l.nextElementSibling;c?(c.classList.contains("jdropdown-group")&&(c=c.lastChild.firstChild),t=c.indexValue):l.parentNode.classList.contains("jdropdown-group-items")&&((c=l.parentNode.parentNode.nextElementSibling)&&(c.classList.contains("jdropdown-group")?c=c.lastChild.firstChild:c.classList.contains("jdropdown-item")?t=c.indexValue:c=null),c&&(t=c.indexValue)),null!==t&&r.setCursor(t)}},r.prev=function(){var e=null;if(null===r.currentIndex)r.first();else{var t=r.items[r.currentIndex].element,i=t.previousElementSibling;i?(i.classList.contains("jdropdown-group")&&(i=i.lastChild.lastChild),e=i.indexValue):t.parentNode.classList.contains("jdropdown-group-items")&&((i=t.parentNode.parentNode.previousElementSibling)&&(i.classList.contains("jdropdown-group")?i=i.lastChild.lastChild:i.classList.contains("jdropdown-item")?e=i.indexValue:i=null),i&&(e=i.indexValue))}null!==e&&r.setCursor(e)},r.loadFirst=function(){if(r.results)var e=r.results;else e=r.items;var t=e.length||0;1==r.options.lazyLoading&&t>200&&(t=200),y.textContent="";for(var i=0;i<t;i++)e[i].group?(e[i].group.parentNode||y.appendChild(e[i].group),e[i].group.lastChild.appendChild(e[i].element)):y.appendChild(e[i].element);y.scrollTop=0},r.loadLast=function(){if(r.results)var e=r.results;else e=r.items;var t=e.length;if(t>200){t-=200,y.textContent="";for(var i=t;i<e.length;i++)e[i].group?(e[i].group.parentNode||y.appendChild(e[i].group),e[i].group.lastChild.appendChild(e[i].element)):y.appendChild(e[i].element);y.scrollTop=y.scrollHeight}},r.loadUp=function(){var e=!1;if(r.results)var t=r.results;else t=r.items;var i=y.querySelectorAll(".jdropdown-item")[0].indexValue;i=r.items[i];var n=t.indexOf(i)-1;if(n>0){for(var s=0;n>0&&t[n]&&s<200;)t[n].group?(t[n].group.parentNode||y.insertBefore(t[n].group,y.firstChild),t[n].group.lastChild.insertBefore(t[n].element,t[n].group.lastChild.firstChild)):y.insertBefore(t[n].element,y.firstChild),n--,s++;e=!0}return e},r.loadDown=function(){var e=!1;if(r.results)var t=r.results;else t=r.items;var i=y.querySelectorAll(".jdropdown-item"),n=i[i.length-1].indexValue;n=r.items[n];var s=t.indexOf(n)+1;if(s<t.length){for(var o=0;s<t.length&&t[s]&&o<200;)t[s].group?(t[s].group.parentNode||y.appendChild(t[s].group),t[s].group.lastChild.appendChild(t[s].element)):y.appendChild(t[s].element),s++,o++;e=!0}return e},function(){if(s||(s={}),"SELECT"==n.tagName){var e=t.extractFromDom(n,s);n=e.el,s=e.options}!s.placeholder&&n.getAttribute("placeholder")&&(s.placeholder=n.getAttribute("placeholder")),r.value={},r.items=[],r.groups=[],r.search="",r.results=null,n.classList.add("jdropdown"),(_=document.createElement("div")).className="jdropdown-container-header",r.header=document.createElement("input"),r.header.className="jdropdown-header jss_object",r.header.type="text",r.header.setAttribute("autocomplete","off"),r.header.onfocus=function(){"function"==typeof r.options.onfocus&&r.options.onfocus(n)},r.header.onblur=function(){"function"==typeof r.options.onblur&&r.options.onblur(n)},r.header.onkeyup=function(e){1!=r.options.autocomplete||E?r.options.autocomplete||r.next(e.key):(r.search!=r.header.value.trim()&&(E=setTimeout((function(){r.find(r.header.value.trim()),E=null}),400)),n.classList.contains("jdropdown-focus")||r.open())},t.hasEvents||(t.hasEvents=!0,document.addEventListener("keydown",t.keydown)),(b=document.createElement("div")).className="jdropdown-container",(y=document.createElement("div")).className="jdropdown-content",(C=document.createElement("div")).className="jdropdown-close",C.textContent="Done",(w=document.createElement("div")).className="jdropdown-reset",w.textContent="x",w.onclick=function(){r.reset(),r.close()},(S=document.createElement("div")).className="jdropdown-backdrop",_.appendChild(r.header),b.appendChild(y),n.appendChild(_),n.appendChild(b),n.appendChild(S),r.setOptions(s),"ontouchsend"in document.documentElement==1?n.addEventListener("touchsend",t.mouseup):n.addEventListener("mouseup",t.mouseup),1==r.options.lazyLoading&&c(y,{loadUp:r.loadUp,loadDown:r.loadDown}),y.onwheel=function(e){e.stopPropagation()},n.change=r.setValue,n.val=function(e){if(void 0===e)return r.getValue(!!r.options.multiple);r.setValue(e)},n.dropdown=r}(),r};return t.keydown=function(e){var i=null;if(i=t.current)if(13==e.which||9==e.which)i.header.value&&null==i.currentIndex&&i.options.newOptions?i.add():(null==i.currentIndex&&1==i.options.autocomplete&&""!=i.header.value&&i.find(i.header.value),i.selectIndex(i.currentIndex));else if(38==e.which)null==i.currentIndex?i.first():i.currentIndex>0&&i.prev(),e.preventDefault();else if(40==e.which)null==i.currentIndex?i.first():i.currentIndex+1<i.items.length&&i.next(),e.preventDefault();else if(36==e.which)i.first(),e.target.classList.contains("jdropdown-header")||e.preventDefault();else if(35==e.which)i.last(),e.target.classList.contains("jdropdown-header")||e.preventDefault();else if(27==e.which)i.close();else if(33==e.which){if(null==i.currentIndex)i.first();else if(i.currentIndex>0)for(var n=0;n<7;n++)i.prev();e.preventDefault()}else if(34==e.which){if(null==i.currentIndex)i.first();else if(i.currentIndex+1<i.items.length)for(n=0;n<7;n++)i.next();e.preventDefault()}},t.mouseup=function(e){var t=o.findElement(e.target,"jdropdown");if(t){var i=t.dropdown;if(e.target.classList.contains("jdropdown-header"))if(t.classList.contains("jdropdown-focus")&&t.classList.contains("jdropdown-default")){var n=t.getBoundingClientRect();if(e.changedTouches&&e.changedTouches[0]){var s=e.changedTouches[0].clientX;e.changedTouches[0].clientY}else s=e.clientX,e.clientY;n.width-(s-n.left)<30?e.target.classList.contains("jdropdown-add")?i.add():i.close():0==i.options.autocomplete&&i.close()}else i.open();else if(e.target.classList.contains("jdropdown-group-name")){var r=e.target.nextSibling.children;if("none"!=e.target.nextSibling.style.display)for(var a=0;a<r.length;a++)"none"!=r[a].style.display&&i.selectItem(r[a])}else e.target.classList.contains("jdropdown-group-arrow")?e.target.classList.contains("jdropdown-group-arrow-down")?(e.target.classList.remove("jdropdown-group-arrow-down"),e.target.classList.add("jdropdown-group-arrow-up"),e.target.parentNode.nextSibling.style.display="none"):(e.target.classList.remove("jdropdown-group-arrow-up"),e.target.classList.add("jdropdown-group-arrow-down"),e.target.parentNode.nextSibling.style.display=""):e.target.classList.contains("jdropdown-item")?i.selectItem(e.target):e.target.classList.contains("jdropdown-image")||e.target.classList.contains("jdropdown-description")?i.selectItem(e.target.parentNode):e.target.classList.contains("jdropdown-title")?i.selectItem(e.target.parentNode.parentNode):(e.target.classList.contains("jdropdown-close")||e.target.classList.contains("jdropdown-backdrop"))&&i.close()}},t.extractFromDom=function(e,t){var i=e;if(t||(t={}),!e.getAttribute("multiple")||t&&null!=t.multiple||(t.multiple=!0),!e.getAttribute("placeholder")||t&&null!=t.placeholder||(t.placeholder=e.getAttribute("placeholder")),!e.getAttribute("data-autocomplete")||t&&null!=t.autocomplete||(t.autocomplete=!0),t&&null!=t.width||(t.width=e.offsetWidth),!e.value||t&&null!=t.value||(t.value=e.value),!t||null==t.data){t.data=[];for(var n=0;n<e.children.length;n++)if("OPTGROUP"==e.children[n].tagName)for(var s=0;s<e.children[n].children.length;s++)t.data.push({value:e.children[n].children[s].value,text:e.children[n].children[s].textContent,group:e.children[n].getAttribute("label")});else t.data.push({value:e.children[n].value,text:e.children[n].textContent})}t&&null!=t.onchange||(t.onchange=function(e,n,s,r){1==t.multiple?obj.items[n].classList.contains("jdropdown-selected")?i.options[n].setAttribute("selected","selected"):i.options[n].removeAttribute("selected"):i.value=r});var r=document.createElement("div");return e.parentNode.insertBefore(r,e),e.style.display="none",{el:e=r,options:t}},t}();function w(e,t){if(e.picker)return e.picker.setOptions(t,!0);var n={type:"picker",options:{}},s=null,r=null,a=function(e){return e instanceof Element||e instanceof HTMLDocument};return n.setOptions=function(e,t){var i={value:0,data:null,render:null,onchange:null,onmouseover:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,bottom:!1,content:!1,columns:null,grid:null,height:null};for(var o in e&&e.options&&(e.data=e.options),i)e&&e.hasOwnProperty(o)?n.options[o]=e[o]:void 0!==n.options[o]&&!0!==t||(n.options[o]=i[o]);return!1===n.options.header?s.style.display="none":s.style.display="",n.options.width?s.style.width=parseInt(n.options.width)+"px":s.style.width="",n.options.height?(r.style.maxHeight=n.options.height+"px",r.style.overflow="scroll"):r.style.overflow="",n.options.columns>0&&(n.options.grid?(r.classList.add("jpicker-grid"),r.style.gridTemplateColumns="repeat("+n.options.grid+", 1fr)"):(r.classList.add("jpicker-columns"),r.style.width=n.options.width?n.options.width:36*n.options.columns+"px")),isNaN(parseInt(n.options.value))&&(n.options.value=0),function(){r.innerHTML="";for(var e=Object.keys(n.options.data),t=0;t<e.length;t++){var i=document.createElement("div");i.classList.add("jpicker-item"),i.k=e[t],i.v=n.options.data[e[t]];var s=n.getLabel(e[t],i);a(s)?i.appendChild(s):i.innerHTML=s,r.appendChild(i)}}(),n.setValue(n.options.value),n},n.getValue=function(){return n.options.value},n.setValue=function(t,i){if(n.setLabel(t),n.options.value=String(t),e.value!=n.options.value&&(e.value=n.options.value,"function"==typeof e.oninput&&e.oninput({type:"input",target:e,value:e.value})),r.children[t]&&"generic"!==r.children[t].getAttribute("type")&&n.close(),i&&"function"==typeof n.options.onchange){var s=n.options.data[t];n.options.onchange(e,n,s,s,t,i)}},n.getLabel=function(e,t){var i=n.options.data[e]||null;return"function"==typeof n.options.render&&(i=n.options.render(i,t)),i},n.setLabel=function(e){var t;t=n.options.content?'<i class="material-icons">'+n.options.content+"</i>":n.getLabel(e,null),a(t)?(s.innerHTML="",s.appendChild(t)):s.innerHTML=t},n.open=function(){if(!e.classList.contains("jpicker-focus")){i(n,!0),e.classList.add("jpicker-focus"),e.focus();var t,o=0;r.style.marginLeft="";var a=s.getBoundingClientRect(),l=r.getBoundingClientRect();t=window.innerHeight<a.bottom+l.height||n.options.bottom?-1*(l.height+4):a.height+4,!0===n.options.right&&(o=-1*l.width+a.width),l.left+o<0&&(o=o+l.left+10),l.left+l.width>window.innerWidth&&(o=-1*(10+l.left+l.width-window.innerWidth)),r.style.marginTop=parseInt(t)+"px",r.style.marginLeft=parseInt(o)+"px","function"==typeof n.options.onopen&&n.options.onopen(e,n)}},n.close=function(){e.classList.contains("jpicker-focus")&&(e.classList.remove("jpicker-focus"),i(n,!1),"function"==typeof n.options.onclose&&n.options.onclose(e,n))},e.classList.add("jpicker"),e.setAttribute("tabindex","900"),e.onmousedown=function(t){e.classList.contains("jpicker-focus")||n.open()},(s=document.createElement("div")).classList.add("jpicker-header"),(r=document.createElement("div")).classList.add("jpicker-content"),r.onclick=function(e){var t=o.findElement(e.target,"jpicker-item");t&&t.parentNode===r&&n.setValue(t.k,e)},e.appendChild(s),e.appendChild(r),e.value=t.value||0,n.setOptions(t),"function"==typeof n.options.onload&&n.options.onload(e,n),e.change=n.setValue,e.val=function(e){if(void 0===e)return n.getValue();n.setValue(e)},e.picker=n,n}function S(e,t){var n={type:"toolbar",options:{}},s={app:null,container:!1,badge:!1,title:!1,responsive:!1,maxWidth:null,bottom:!0,items:[]};for(var r in s)t&&t.hasOwnProperty(r)?n.options[r]=t[r]:n.options[r]=s[r];!e&&t.app&&t.app.el&&(e=document.createElement("div"),t.app.el.appendChild(e));var a=document.createElement("div");a.classList.add("jtoolbar-item"),a.classList.add("jtoolbar-arrow");var l=document.createElement("div");l.classList.add("jtoolbar-floating"),a.appendChild(l),n.selectItem=function(e){for(var t=c.children,i=0;i<t.length;i++)e!=t[i]&&t[i].classList.remove("jtoolbar-selected");e.classList.add("jtoolbar-selected")},n.hide=function(){u.slideBottom(e,0,(function(){e.style.display="none"}))},n.show=function(){e.style.display="",u.slideBottom(e,1)},n.get=function(){return e},n.setBadge=function(e,t){c.children[e].children[1].firstChild.innerHTML=t},n.destroy=function(){toolbar.remove(),e.innerHTML=""},n.update=function(t,i){for(var s=0;s<c.children.length;s++)"function"==typeof(r=c.children[s]).updateState&&r.updateState(e,n,r,t,i);for(s=0;s<l.children.length;s++){var r;"function"==typeof(r=l.children[s]).updateState&&r.updateState(e,n,r,t,i)}},n.create=function(t){c.innerHTML="";for(var i=0;i<t.length;i++){var s=document.createElement("div");if(s.classList.add("jtoolbar-item"),t[i].width&&(s.style.width=parseInt(t[i].width)+"px"),t[i].k&&(s.k=t[i].k),t[i].tooltip&&s.setAttribute("title",t[i].tooltip),t[i].id&&s.setAttribute("id",t[i].id),t[i].updateState&&(s.updateState=t[i].updateState),t[i].active&&s.classList.add("jtoolbar-active"),t[i].disabled&&s.classList.add("jtoolbar-disabled"),"select"==t[i].type||"dropdown"==t[i].type)w(s,t[i]);else if("divisor"==t[i].type)s.classList.add("jtoolbar-divisor");else if("label"==t[i].type)s.classList.add("jtoolbar-label"),s.innerHTML=t[i].content;else{var r=document.createElement("i");if(void 0===t[i].class)r.classList.add("material-icons");else for(var o=t[i].class.split(" "),a=0;a<o.length;a++)r.classList.add(o[a]);if(r.innerHTML=t[i].content?t[i].content:"",s.appendChild(r),1==n.options.badge){var l=document.createElement("div");l.classList.add("jbadge");var h=document.createElement("div");h.innerHTML=t[i].badge?t[i].badge:"",l.appendChild(h),s.appendChild(l)}if(t[i].title)if(1==n.options.title){var d=document.createElement("span");d.innerHTML=t[i].title,s.appendChild(d)}else s.setAttribute("title",t[i].title);n.options.app&&t[i].route&&(s.route=t[i].route,s.onclick=function(){n.options.app.pages(this.route)},n.options.app.pages(t[i].route,{toolbarItem:s,closed:!0})),"function"==typeof t[i].render&&t[i].render(s,t[i])}t[i].onclick&&(s.onclick=t[i].onclick.bind(t[i],e,n,s)),c.appendChild(s)}setTimeout((function(){n.refresh()}),0)},n.open=function(){a.classList.add("jtoolbar-arrow-selected"),e.getBoundingClientRect(),l.getBoundingClientRect().bottom>window.innerHeight||n.options.bottom?l.style.bottom="0":l.style.removeProperty("bottom"),l.style.right="0",a.children[0].focus(),i(n,!0)},n.close=function(){a.classList.remove("jtoolbar-arrow-selected"),i(n,!1)},n.refresh=function(){if(1==n.options.responsive){var t=e.parentNode.getBoundingClientRect();n.options.maxWidth||(n.options.maxWidth=t.width);var i=parseInt(n.options.maxWidth);for(a.parentNode&&a.parentNode.removeChild(a);l.firstChild;)c.appendChild(l.firstChild);if(i<c.offsetWidth)for(i-=50;c.lastChild&&i<c.offsetWidth;)l.insertBefore(c.lastChild,l.firstChild);l.children.length>0&&c.appendChild(a)}},n.setReadonly=function(t){t=t?"add":"remove",e.classList[t]("jtoolbar-disabled")},e.onclick=function(e){var t=o.findElement(e.target,"jtoolbar-item");t&&n.selectItem(t),e.target.classList.contains("jtoolbar-arrow")&&n.open()},window.addEventListener("resize",(function(){n.refresh()})),e.classList.add("jtoolbar"),e.innerHTML="",1==n.options.container&&e.classList.add("jtoolbar-container");var c=document.createElement("div");return e.appendChild(c),n.options.app&&e.classList.add("jtoolbar-mobile"),n.create(n.options.items),e.toolbar=n,n}var E=function(){var e=function(t,i){var n={type:"editor",options:{}},s={url:null,value:"",snippet:null,toolbar:!0,toolbarOnTop:!1,remoteParser:null,placeholder:null,filterPaste:!0,dropZone:!0,dropAsSnippet:!1,acceptImages:!0,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null,extensions:null,type:null};for(var r in s)i&&i.hasOwnProperty(r)?n.options[r]=i[r]:n.options[r]=s[r];var a=null,l=null,c=[];n.el=t,"function"==typeof n.options.onclick&&(t.onclick=function(e){n.options.onclick(t,n,e)}),t.classList.add("jeditor-container");var h=document.createElement("div");h.className="jsnippet",h.setAttribute("contenteditable",!1);var u=document.createElement("div");if(u.className="jeditor-toolbar",n.editor=document.createElement("div"),n.editor.setAttribute("contenteditable",!0),n.editor.setAttribute("spellcheck",!1),n.editor.classList.add("jeditor"),n.options.placeholder&&n.editor.setAttribute("data-placeholder",n.options.placeholder),(n.options.maxHeight||n.options.height)&&(n.editor.style.overflowY="auto",n.options.maxHeight&&(n.editor.style.maxHeight=n.options.maxHeight),n.options.height&&(n.editor.style.height=n.options.height)),n.options.url)d({url:n.options.url,dataType:"html",success:function(t){n.editor.innerHTML=t,e.setCursor(n.editor,"initial"==n.options.focus)}});else if(n.options.value)n.editor.innerHTML=n.options.value;else for(var p=0;p<t.children.length;p++)n.editor.appendChild(t.children[p]);t.innerHTML="";var f=function(e){"function"==typeof n.options.onchange&&n.options.onchange(t,n,e),n.options.value=n.getData(),t.value!=n.options.value&&(t.value=n.options.value,"function"==typeof t.oninput&&t.oninput({type:"input",target:t,value:t.value}))},m=function(){var e=null;if(e=h.children[0]){e.classList.contains("jslider-grid")||e.classList.add("jslider-grid");var t=e.children.length;e.setAttribute("data-number",t>4?4:t),t>4?e.setAttribute("data-total",t-4):e.removeAttribute("data-total")}};n.appendSnippet=function(e){h.innerHTML="";for(var t=["image","title","description","host","url"],i=0;i<t.length;i++){var s=document.createElement("div");if(s.className="jsnippet-"+t[i],s.setAttribute("data-k",t[i]),h.appendChild(s),e[t[i]])if("image"==t[i]){Array.isArray(e.image)||(e.image=[e.image]);for(var r=0;r<e.image.length;r++){var o=document.createElement("img");o.src=e.image[r],s.appendChild(o)}}else s.innerHTML=e[t[i]]}n.editor.appendChild(document.createElement("br")),n.editor.appendChild(h)},n.setData=function(t){n.editor.innerHTML="object"==typeof t?t.content:t,n.options.focus&&e.setCursor(n.editor,!0),c=[]},n.getFiles=function(){for(var e=n.editor.querySelectorAll(".jfile"),t=[],i=0;i<e.length;i++)c[e[i].src]&&t.push(c[e[i].src]);return t},n.getText=function(){return n.editor.innerText},n.getData=function(e){if(e){if(d={content:""},h.innerHTML){d.snippet={};for(var t=0;t<h.children.length;t++){var i=h.children[t].getAttribute("data-k");if(i)if("image"==i){d.snippet.image||(d.snippet.image=[]);for(var s=0;s<h.children[t].children.length;s++)d.snippet.image.push(h.children[t].children[s].getAttribute("src"))}else d.snippet[i]=h.children[t].innerHTML}}var r=Object.keys(c);if(r.length)for(d.files=[],t=0;t<r.length;t++)d.files.push(c[r[t]]);var o=document.createElement("div");o.innerHTML=n.editor.innerHTML;var a=o.querySelector(".jsnippet");a&&a.remove();var l=o.innerHTML;l=(l=(l=l.replace(/<br>/g,"\n")).replace(/<\/div>/g,"</div>\n")).replace(/<(?:.|\n)*?>/gm,""),d.content=l.trim(),L("getData",d)}else var d=n.editor.innerHTML;return d},n.reset=function(){n.editor.innerHTML="",h.innerHTML="",c=[]},n.addPdf=function(e){if("data"!=e.result.substr(0,4))console.error("Invalid source");else{var t=document.createElement("canvas");t.width=60,t.height=60;var i=new Image;t.getContext("2d").drawImage(i,0,0,t.width,t.height),t.toBlob((function(t){var i=document.createElement("img");i.src=window.URL.createObjectURL(t),i.title=e.name,i.className="jfile pdf",c[i.src]={file:i.src,extension:"pdf",content:e.result},document.execCommand("insertHtml",!1,i.outerHTML)}))}},n.addImage=function(e,t){if(n.options.acceptImages)if(e||(e=""),"data"==e.substr(0,4)||n.options.remoteParser){if("data"==e.substr(0,4))i=(i=(i=e.split(";"))[0].split("/"))[1];else{var i=e.substr(e.lastIndexOf(".")+1);e=n.options.remoteParser+e}var s=new Image;s.onload=function(){var e=document.createElement("canvas");e.width=s.width,e.height=s.height,e.getContext("2d").drawImage(s,0,0,e.width,e.height),e.toBlob((function(r){var o,a=document.createElement("img");a.src=window.URL.createObjectURL(r),a.classList.add("jfile"),a.setAttribute("tabindex","900"),a.setAttribute("width",s.width),a.setAttribute("height",s.height),c[a.src]={file:a.src,extension:i,content:e.toDataURL()},n.options.dropAsSnippet||t?(o=a,h.innerHTML||n.appendSnippet({}),h.children[0].appendChild(o),m(),c[a.src].snippet=!0):document.execCommand("insertHtml",!1,a.outerHTML),f()}))},s.src=e}else console.error("remoteParser not defined in your initialization")},n.addFile=function(e){for(var t=[],i=0;i<e.length;i++)if(e[i].size>n.options.maxFileSize)alert("The file is too big");else{var s=e[i].type.split("/");(s="image"==s[0]?1:"pdf"==s[1]?2:0)?(t[i]=new FileReader,t[i].index=i,t[i].type=s,t[i].name=e[i].name,t[i].date=e[i].lastModified,t[i].size=e[i].size,t[i].addEventListener("load",(function(e){2==e.target.type?1==n.options.acceptFiles&&n.addPdf(e.target):n.addImage(e.target.result)}),!1),t[i].readAsDataURL(e[i])):alert("The extension is not allowed")}},n.destroy=function(){n.editor.removeEventListener("mouseup",D),n.editor.removeEventListener("mousedown",j),n.editor.removeEventListener("mousemove",R),n.editor.removeEventListener("keyup",I),n.editor.removeEventListener("keydown",k),n.editor.removeEventListener("dragstart",w),n.editor.removeEventListener("dragenter",E),n.editor.removeEventListener("dragover",x),n.editor.removeEventListener("drop",T),n.editor.removeEventListener("paste",C),n.editor.removeEventListener("blur",A),n.editor.removeEventListener("focus",O),t.editor=null,t.classList.remove("jeditor-container"),u.remove(),h.remove(),n.editor.remove()},n.upload=function(){o.click(n.file)};const g=["html","body","address","span","div","h1","h2","h3","h4","h5","h6","p","b","i","blockquote","strong","em","ul","ol","li","a","code","pre","hr","br","img","figure","picture","figcaption","iframe","table","thead","tbody","tfoot","tr","th","td","caption","u","del","ins","sub","sup","small","mark","input","textarea","select","option","button","label","fieldset","legend","audio","video","abbr","cite","kbd","section","article","nav","aside","header","footer","main","details","summary","svg","line","source"],v=["width","height","align","border","src","tabindex"],_=["color","font-weight","font-size","background","background-color","margin"],b=function(e){if(e.tagName&&-1===g.indexOf(e.tagName.toLowerCase())&&e.innerText&&(e.innerHTML=e.innerText),e.attributes&&e.attributes.length){let t=null,i=e.getAttribute("style");if(i){t=[];let e=i.split(";");for(let i=0;i<e.length;i++){let n=e[i].trim().split(":");if(_.indexOf(n[0].trim())>=0){let e=n.shift();n=n.join(":"),t.push(e+":"+n)}}}"IMG"===e.tagName.toUpperCase()&&(n.options.acceptImages&&e.src?(e.setAttribute("tabindex","900"),n.addImage(e.src)):e.parentNode.removeChild(e));let s=[];for(let t=0;t<e.attributes.length;t++)s.push(e.attributes[t].name);s.length&&s.forEach((function(t){-1===v.indexOf(t)?e.removeAttribute(t):e.attributes&&e.attributes[p]&&-1!==e.attributes[p].value.indexOf("<")&&e.attributes[p].value.replace("<","&#60;")})),e.style="",t&&t.length&&e.setAttribute("style",t.join(";"))}if(e.children.length)for(let t=e.children.length;t>0;t--)b(e.children[t-1])};var y=function(e){var t=window.getSelection(),i=document.createRange();i.selectNode(e),t.addRange(i)},C=function(e){if(1==n.options.filterPaste){if(e.clipboardData||e.originalEvent.clipboardData)var t=(e.originalEvent||e).clipboardData.getData("text/html"),i=(e.originalEvent||e).clipboardData.getData("text/plain"),s=(e.originalEvent||e).clipboardData.files;else window.clipboardData&&(t=window.clipboardData.getData("Html"),i=window.clipboardData.getData("Text"),s=window.clipboardData.files);if(s.length)n.addFile(s);else if(t){var r=function(e){e&&(e=e.replace(new RegExp("\x3c!--(.*?)--\x3e","gsi"),""));var t=(new DOMParser).parseFromString(e,"text/html");b(t);var i=document.createElement("div");return i.innerHTML=t.firstChild.innerHTML,i}(t);document.execCommand("insertHtml",!1,r.innerHTML)}else t=i.split("\r\n"),e.target.innerText?(t=t.map((function(e){return"<div>"+e+"</div>"})),document.execCommand("insertText",!1,t.join(""))):t.map((function(e){var t=document.createElement("div");t.innerText=e,n.editor.appendChild(t)}));e.preventDefault()}},w=function(e){l&&l.e&&e.preventDefault()},E=function(e){l||0==n.options.dropZone||(t.classList.add("jeditor-dragging"),e.preventDefault())},x=function(e){l||0==n.options.dropZone||(a&&clearTimeout(a),a=setTimeout((function(){t.classList.remove("jeditor-dragging")}),100),e.preventDefault())},T=function(e){if(l||0==n.options.dropZone);else{var i=null;document.caretRangeFromPoint?i=document.caretRangeFromPoint(e.clientX,e.clientY):e.rangeParent&&(i=document.createRange()).setStart(e.rangeParent,e.rangeOffset);var s=window.getSelection();s.removeAllRanges(),s.addRange(i),s.anchorNode.parentNode.focus();var r=(e.originalEvent||e).dataTransfer.getData("text/html"),o=(e.originalEvent||e).dataTransfer.getData("text/plain"),a=(e.originalEvent||e).dataTransfer.files;a.length?n.addFile(a):o&&function(e){var t=document.createElement("div");t.innerHTML=e;var i=t.querySelectorAll("img");if(i.length)for(var s=0;s<i.length;s++)n.addImage(i[s].src)}(r),t.classList.remove("jeditor-dragging"),e.preventDefault()}},A=function(e){L("onevent",e),f(e),"function"==typeof n.options.onblur&&n.options.onblur(t,n,e)},O=function(e){"function"==typeof n.options.onfocus&&n.options.onfocus(t,n,e)},I=function(e){n.editor.innerHTML||(n.editor.innerHTML="<div><br></div>"),"function"==typeof n.options.onkeyup&&n.options.onkeyup(t,n,e)},k=function(e){if(L("onevent",e),"Delete"==e.key&&"IMG"==e.target.tagName){var i=e.target.parentNode;y(e.target),i.classList.contains("jsnippet-image")&&m()}"function"==typeof n.options.onkeydown&&n.options.onkeydown(t,n,e)},D=function(e){if(l&&l.e&&(l.e.classList.remove("resizing"),1==l.e.changed)){var t=l.e.cloneNode();t.width=parseInt(l.e.style.width)||l.e.getAttribute("width"),t.height=parseInt(l.e.style.height)||l.e.getAttribute("height"),l.e.style.width="",l.e.style.height="",y(l.e),document.execCommand("insertHtml",!1,t.outerHTML)}l=!1},j=function(e){var t=function(t){var i=t.getBoundingClientRect();i.width-(e.clientX-i.left)<40&&e.clientY-i.top<40&&(t.innerHTML="",t.remove())};if("IMG"==e.target.tagName)if(e.target.style.cursor){var i=e.target.getBoundingClientRect();l={e:e.target,x:e.clientX,y:e.clientY,w:i.width,h:i.height,d:e.target.style.cursor},e.target.getAttribute("width")||e.target.setAttribute("width",i.width),e.target.getAttribute("height")||e.target.setAttribute("height",i.height);var n=window.getSelection();if(n.rangeCount)for(var s=0;s<n.rangeCount;s++)n.removeRange(n.getRangeAt(s));e.target.classList.add("resizing")}else l=!0;else e.target.classList.contains("jsnippet")?t(e.target):e.target.parentNode.classList.contains("jsnippet")&&t(e.target.parentNode),l=!0},R=function(e){if("IMG"==e.target.tagName&&!e.target.parentNode.classList.contains("jsnippet-image")&&1==n.options.allowImageResize&&e.target.getAttribute("tabindex")){var t=e.target.getBoundingClientRect();e.clientY-t.top<5?t.width-(e.clientX-t.left)<5?e.target.style.cursor="ne-resize":e.clientX-t.left<5?e.target.style.cursor="nw-resize":e.target.style.cursor="n-resize":t.height-(e.clientY-t.top)<5?t.width-(e.clientX-t.left)<5?e.target.style.cursor="se-resize":e.clientX-t.left<5?e.target.style.cursor="sw-resize":e.target.style.cursor="s-resize":t.width-(e.clientX-t.left)<5?e.target.style.cursor="e-resize":e.clientX-t.left<5?e.target.style.cursor="w-resize":e.target.style.cursor=""}if(1==e.which&&l&&l.d){if("e-resize"==l.d||"ne-resize"==l.d||"se-resize"==l.d)if(l.e.style.width=l.w+(e.clientX-l.x),e.shiftKey){var i=(e.clientX-l.x)*(l.h/l.w);l.e.style.height=l.h+i}else i=null;i||"s-resize"!=l.d&&"se-resize"!=l.d&&"sw-resize"!=l.d||e.shiftKey||(l.e.style.height=l.h+(e.clientY-l.y)),l.e.changed=!0}},L=function(e,t){if(n.options.extensions){var i=Object.keys(n.options.extensions);if(i.length)for(var s=0;s<i.length;s++)n.options.extensions[i[s]]&&"function"==typeof n.options.extensions[i[s]][e]&&n.options.extensions[i[s]][e].call(n,t)}};if(document.addEventListener("mouseup",D),document.addEventListener("mousemove",R),n.editor.addEventListener("mousedown",j),n.editor.addEventListener("keyup",I),n.editor.addEventListener("keydown",k),n.editor.addEventListener("dragstart",w),n.editor.addEventListener("dragenter",E),n.editor.addEventListener("dragover",x),n.editor.addEventListener("drop",T),n.editor.addEventListener("paste",C),n.editor.addEventListener("focus",O),n.editor.addEventListener("blur",A),t.appendChild(n.editor),n.options.snippet&&n.appendSnippet(n.options.snippet),n.options.toolbar){if(Array.isArray(n.options.toolbar))var M={container:!0,responsive:!0,items:n.options.toolbar};else M=!0===n.options.toolbar?{container:!0,responsive:!0,items:[]}:n.options.toolbar;M.items&&M.items.length||(M.items=e.getDefaultToolbar(n)),n.options.toolbarOnTop?(t.classList.add("toolbar-on-top"),t.insertBefore(u,t.firstChild)):(n.editor.style.padding="15px",t.appendChild(u)),S(u,M),u.addEventListener("click",(function(){n.editor.focus()}))}return n.file=document.createElement("input"),n.file.style.display="none",n.file.type="file",n.file.setAttribute("accept","image/*"),n.file.onchange=function(){n.addFile(this.files)},t.appendChild(n.file),n.options.focus&&e.setCursor(n.editor,"initial"==n.options.focus),t.change=n.setData,t.val=function(e){if(void 0===e){var i="true"!==t.getAttribute("data-html");return n.getData(i)}n.setData(e)},function(){if(n.options.extensions){var e=Object.keys(n.options.extensions);if(e.length)for(var i=0;i<e.length;i++)n.options.extensions[e[i]]&&"function"==typeof n.options.extensions[e[i]]&&(n.options.extensions[e[i]]=n.options.extensions[e[i]](t,n))}}(),t.editor=n,"function"==typeof n.options.onload&&n.options.onload(t,n,n.editor),n};return e.setCursor=function(e,t){e.focus(),document.execCommand("selectAll");var i=window.getSelection(),n=i.getRangeAt(0);if(1==t)var s=n.startContainer,r=0;else r=(s=n.endContainer).length;n.setStart(s,r),n.setEnd(s,r),i.removeAllRanges(),i.addRange(n)},e.getDefaultToolbar=function(e){var t=function(e,t,i){i.color||(_(i,{onchange:function(e,t){"color"===i.k?document.execCommand("foreColor",!1,t):document.execCommand("backColor",!1,t)}}),i.color.open())},i=[];return i.push({content:"undo",onclick:function(){document.execCommand("undo")}}),i.push({content:"redo",onclick:function(){document.execCommand("redo")}}),i.push({type:"divisor"}),e.options.toolbarOnTop&&(i.push({type:"select",width:"140px",options:["Default","Verdana","Arial","Courier New"],render:function(e){return'<span style="font-family:'+e+'">'+e+"</span>"},onchange:function(e,t,i,n,s){document.execCommand("fontName",!1,n)}}),i.push({type:"select",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(e){return'<span style="font-size:'+e+'">'+e+"</span>"},onchange:function(e,t,i,n,s){document.execCommand("fontSize",!1,parseInt(s)+1)}}),i.push({type:"select",options:["format_align_left","format_align_center","format_align_right","format_align_justify"],render:function(e){return'<i class="material-icons">'+e+"</i>"},onchange:function(e,t,i,n,s){document.execCommand(["JustifyLeft","justifyCenter","justifyRight","justifyFull"][s])}}),i.push({type:"divisor"}),i.push({content:"format_color_text",k:"color",onclick:t}),i.push({content:"format_color_fill",k:"background-color",onclick:t})),i.push({content:"format_bold",onclick:function(e,t,i){document.execCommand("bold"),document.queryCommandState("bold")?i.classList.add("selected"):i.classList.remove("selected")}}),i.push({content:"format_italic",onclick:function(e,t,i){document.execCommand("italic"),document.queryCommandState("italic")?i.classList.add("selected"):i.classList.remove("selected")}}),i.push({content:"format_underline",onclick:function(e,t,i){document.execCommand("underline"),document.queryCommandState("underline")?i.classList.add("selected"):i.classList.remove("selected")}}),i.push({type:"divisor"}),i.push({content:"format_list_bulleted",onclick:function(e,t,i){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?i.classList.add("selected"):i.classList.remove("selected")}}),i.push({content:"format_list_numbered",onclick:function(e,t,i){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?i.classList.add("selected"):i.classList.remove("selected")}}),i.push({content:"format_indent_increase",onclick:function(e,t,i){document.execCommand("indent",!0,null),document.queryCommandState("indent")?i.classList.add("selected"):i.classList.remove("selected")}}),i.push({content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}),e.options.toolbarOnTop&&(i.push({type:"divisor"}),i.push({content:"photo",onclick:function(){e.upload()}}),i.push({type:"select",content:"table_view",columns:8,grid:8,right:!0,options:["0x0","1x0","2x0","3x0","4x0","5x0","6x0","7x0","0x1","1x1","2x1","3x1","4x1","5x1","6x1","7x1","0x2","1x2","2x2","3x2","4x2","5x2","6x2","7x2","0x3","1x3","2x3","3x3","4x3","5x3","6x3","7x3","0x4","1x4","2x4","3x4","4x4","5x4","6x4","7x4","0x5","1x5","2x5","3x5","4x5","5x5","6x5","7x5","0x6","1x6","2x6","3x6","4x6","5x6","6x6","7x6","0x7","1x7","2x7","3x7","4x7","5x7","6x7","7x7"],render:function(e,t){t&&(t.onmouseover=this.onmouseover,e=e.split("x"),t.setAttribute("data-x",e[0]),t.setAttribute("data-y",e[1]));var i=document.createElement("div");return t.style.margin="1px",t.style.border="1px solid #ddd",i},onmouseover:function(e){for(var t=parseInt(e.target.getAttribute("data-x")),i=parseInt(e.target.getAttribute("data-y")),n=0;n<e.target.parentNode.children.length;n++){var s=e.target.parentNode.children[n],r=parseInt(s.getAttribute("data-x")),o=parseInt(s.getAttribute("data-y"));r<=t&&o<=i?(s.style.backgroundColor="#cae1fc",s.style.borderColor="#2977ff"):(s.style.backgroundColor="",s.style.borderColor="#ddd")}},onchange:function(e,t,i){i=i.split("x");for(var n=document.createElement("table"),s=document.createElement("tbody"),r=0;r<=i[1];r++){for(var o=document.createElement("tr"),a=0;a<=i[0];a++){var l=document.createElement("td");l.innerHTML="",o.appendChild(l)}s.appendChild(o)}n.appendChild(s),n.setAttribute("width","100%"),n.setAttribute("cellpadding","6"),n.setAttribute("cellspacing","0"),document.execCommand("insertHTML",!1,n.outerHTML)}})),i},e}();var T=function(){var e=function(t,i){var n={options:{}},s={type:"big",title:"Untitled",width:510,height:472};for(var r in s)i&&i.hasOwnProperty(r)?n.options[r]=i[r]:n.options[r]=s[r];return n.state={isMinized:!1},n.setState=function(){n.state.isMinized?n.container.classList.remove("jfloating-minimized"):n.container.classList.add("jfloating-minimized"),n.state.isMinized=!n.state.isMinized},n.close=function(){Components.elements.splice(e.elements.indexOf(n.container),1),n.updatePosition(),t.remove()},n.updatePosition=function(){for(var t=0;t<e.elements.length;t++){var i=e.elements[t],n=e.elements[t-1];i.style.right=t*(n?n.offsetWidth:i.offsetWidth)*1.01+"px"}},n.init=function(){(function(){for(var e=document.createElement("div");t.children[0];)e.appendChild(t.children[0]);for(n.content=document.createElement("div"),n.content.className="jfloating_content",n.content.innerHTML=t.innerHTML;e.children[0];)n.content.appendChild(e.children[0]);n.container=document.createElement("div"),n.container.className="jfloating",n.container.appendChild(n.content),n.options.title?n.container.setAttribute("title",n.options.title):n.container.classList.add("no-title"),n.options.width&&(n.container.style.width=parseInt(n.options.width)+"px"),n.options.height&&(n.container.style.height=parseInt(n.options.height)+"px"),t.innerHTML="",t.appendChild(n.container)})(),n.container&&n.container.addEventListener("click",(function(e){var t=e.target.getBoundingClientRect();if(e.target.classList.contains("jfloating")){if(e.changedTouches&&e.changedTouches[0])var i=e.changedTouches[0].clientX,s=e.changedTouches[0].clientY;else i=e.clientX,s=e.clientY;t.width-(i-t.left)<50&&s-t.top<50?setTimeout((function(){n.close()}),100):n.setState()}})),n.container.classList.add("jfloating-"+n.options.type),e.elements.push(n.container),n.updatePosition(),t.floating=n},n.init(),n};return e.elements=[],e}();var A=function(){const e=function(e){return!isNaN(e)&&null!==e&&("string"!=typeof e||""!==e.trim())},t={between:function(e,t){return e>=t[0]&&e<=t[1]},"not between":function(e,t){return e<t[0]||e>t[1]},"<":function(e,t){return e<t[0]},"<=":function(e,t){return e<=t[0]},">":function(e,t){return e>t[0]},">=":function(e,t){return e>=t[0]},"=":function(e,t){return e==t[0]},"!=":function(e,t){return e!=t[0]}},i={"valid date":function(){return!0},"=":function(e,t){return e===t[0]},"!=":function(e,t){return e!==t[0]},"<":function(e,t){return e<t[0]},"<=":function(e,t){return e<=t[0]},">":function(e,t){return e>t[0]},">=":function(e,t){return e>=t[0]},between:function(e,t){return e>=t[0]&&e<=t[1]},"not between":function(e,t){return e<t[0]||e>t[1]}},n={contains:function(e,t){return e.includes(t[0])},"not contains":function(e,t){return!e.includes(t[0])},"begins with":function(e,t){return e.startsWith(t[0])},"ends with":function(e,t){return e.endsWith(t[0])},"=":function(e,t){return e===t[0]},"!=":function(e,t){return e!==t[0]},"valid email":function(e){return new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/).test(e)},"valid url":function(e){return new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/gi).test(e)}},s=function(e,t){return"function"==typeof s[t.type]?!(!t.allowBlank||void 0!==e&&""!==e&&null!==e)||s[t.type].call(this,e,t):null};s.url=function(e){return!!new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/gi).test(e)},s.email=function(e){var t=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!(!e||!t.test(e))},s.required=function(e){return!(!e||!e.trim())},s.empty=function(e){return null==e||"string"==typeof e&&!e.toString().trim()},s["not exist"]=s.empty,s.notEmpty=function(e){return!s.empty(e)},s.exist=s.notEmpty,s.number=function(i,n){if(!e(i))return!1;if(!n||!n.criteria)return!0;if(!t[n.criteria])return!1;let s=n.value.map((function(e){return parseFloat(e)}));return t[n.criteria](i,s)},s.login=function(e){let t=new RegExp(/^[a-zA-Z0-9._-]+$/);return!(!e||!t.test(e))},s.list=function(e,t){let i,n=typeof e;return("string"===n||"number"===n)&&(i="string"==typeof t.value[0]?t.source?t.source:t.value[0].split(","):t.value[0],!!Array.isArray(i)&&i.findIndex((function(t){return t==e}))>-1)};const r=function(){let e=new Date;return e.setHours(0,0,0,0),e},o={"one year ago":function(){let e=r();return e.setFullYear(e.getFullYear()-1),e},"one month ago":function(){let e=r();return e.setMonth(e.getMonth()-1),e},"one week ago":function(){let e=r();return e.setDate(e.getDate()-7),e},yesterday:function(){let e=r();return e.setDate(e.getDate()-1),e},today:r,tomorrow:function(){let e=r();return e.setDate(e.getDate()+1),e}};return s.date=function(t,n){if(e(t)&&t>0&&t<1e6&&(t=p.numToDate(t)),"Invalid Date"==new Date(t))return!1;if(!n||!n.criteria)return!0;if(!i[n.criteria])return!1;let s=n.value.map((function(e){return"string"==typeof e&&o[e]?o[e]().getTime():new Date(e).getTime()}));return i[n.criteria](new Date(t).getTime(),s)},s.text=function(e,t){if(null==e)e="";else if("string"!=typeof e)return!1;return!t||!t.criteria||!!n[t.criteria]&&n[t.criteria](e,t.value)},s.textLength=function(e,t){return e=e.toString(),s.number(e.length,t)},s}();var O=function(){var e=function(t,i){var n={options:{}},s={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(e,t){alert(t)}};for(var r in s)i&&i.hasOwnProperty(r)?n.options[r]=i[r]:n.options[r]=s[r];n.options.validations||(n.options.validations={}),n.options.submitButton||(n.options.submitButton=t.querySelector("input[type=submit]")),n.options.submitButton&&n.options.url&&(n.options.submitButton.onclick=function(){n.save()}),n.options.validations.email||(n.options.validations.email=A.email),n.options.validations.length||(n.options.validations.length=A.length),n.options.validations.required||(n.options.validations.required=A.required),n.setUrl=function(e){n.options.url=e},n.load=function(){d({url:n.options.url,method:"GET",dataType:"json",queue:!0,success:function(i){if("function"==typeof n.options.onbeforeload){var s=n.options.onbeforeload(t,i);s&&(i=s)}e.setElements(t,i),"function"==typeof n.options.onload&&n.options.onload(t,i)}})},n.save=function(){var i=n.validate();if(i)n.options.onerror(t,i);else{var s=e.getElements(t,!0);if("function"==typeof n.options.onbeforesave&&!1===(s=n.options.onbeforesave(t,s)))return;d({url:n.options.url,method:"POST",dataType:"json",data:s,success:function(e){"function"==typeof n.options.onsave&&n.options.onsave(t,s,e)}})}},n.remove=function(){if("function"==typeof n.options.onbeforeremove&&!1===n.options.onbeforeremove(t,n))return!1;d({url:n.options.url,method:"DELETE",dataType:"json",success:function(e){"function"==typeof n.options.onremove&&n.options.onremove(t,n,e),n.reset()}})};return n.validateElement=function(i){var s=!1,r=e.getValue(i),o=i.getAttribute("data-validation");return"function"!=typeof n.options.validations[o]||n.options.validations[o](r,i)?i.classList.contains("error")&&function(e){var i=!1;e.classList.remove("error"),e.removeAttribute("title");for(var s=t.querySelectorAll("input, select, textarea, div[name]"),r=0;r<s.length;r++)s[r].getAttribute("data-validation")&&s[r].classList.contains("error")&&(i=!0);n.options.submitButton&&(i?n.options.submitButton.setAttribute("disabled",!0):n.options.submitButton.removeAttribute("disabled"))}(i):s=function(e){e.classList.add("error"),n.options.submitButton&&n.options.submitButton.setAttribute("disabled",!0);var t=e.getAttribute("data-error")||"There is an error in the form";return e.setAttribute("title",t),t}(i),s},n.reset=function(){for(var e=t.querySelectorAll("input, select, textarea, div[name]"),i=0;i<e.length;i++)e[i].getAttribute("name")&&("checkbox"==e[i].type||"radio"==e[i].type?e[i].checked=!1:"function"==typeof e[i].val?e[i].val(""):e[i].value="")},n.validate=function(){for(var e=[],i=t.querySelectorAll("input, select, textarea, div[name]"),s=0;s<i.length;s++)if(i[s].getAttribute("data-validation")){var r=n.validateElement(i[s]);r&&e.push(r)}return e.length>0&&e.join("<br>")},n.getError=function(){return!!n.validation()},n.setHash=function(){return n.getHash(e.getElements(t))},n.getHash=function(e){var t,i=0;if(0===e.length)return i;for(t=0;t<e.length;t++)i=(i<<5)-i+e.charCodeAt(t),i|=0;return i},n.isChanged=function(){var e=n.setHash();return n.options.currentHash!=e},n.resetTracker=function(){n.options.currentHash=n.setHash(),n.options.ignore=!1},n.setIgnore=function(e){n.options.ignore=!!e},setTimeout((function(){n.options.currentHash=n.setHash()}),1e3),t.addEventListener("keyup",(function(e){e.target.getAttribute("data-validation")&&n.validateElement(e.target)})),e.hasEvents||(window.addEventListener("beforeunload",(function(e){if(n.isChanged()&&0==n.options.ignore){var t=n.options.message?n.options.message:"o/";return t?(void 0===e&&(e=window.event),e&&(e.returnValue=t),t):void 0}})),e.hasEvents=!0),t.form=n,n};return e.getValue=function(e){var t=null;if("checkbox"==e.type)1==e.checked&&(t=e.value||!0);else if("radio"==e.type)1==e.checked&&(t=e.value);else if("file"==e.type)t=e.files;else if("select"==e.tagName&&1==e.multiple){t=[];for(var i=e.querySelectorAll("options[selected]"),n=0;n<i.length;n++)t.push(i[n].value)}else t="function"==typeof e.val?e.val():e.value||"";return t},e.getElements=function(t,i){for(var n={},s=null,r=t.querySelectorAll("input, select, textarea, div[name]"),o=0;o<r.length;o++)(s=r[o].getAttribute("name"))&&(n[s]=e.getValue(r[o])||"");return 1==i?n:JSON.stringify(n)},e.setElements=function(e,t){for(var i=null,n=null,s=e.querySelectorAll("input, select, textarea, div[name]"),r=0;r<s.length;r++){var o=s[r].getAttribute("type");if(i=s[r].getAttribute("name")){if(n=null,(i=i.replace(new RegExp(/\[(.*?)\]/gi),".$1")).match(/\./)){var l=a.call(t,i)||"";void 0!==l&&(n=l)}else void 0!==t[i]&&(n=t[i]);null!==n&&("checkbox"==o||"radio"==o?s[r].checked=!!n:"file"==o||("function"==typeof s[r].val?s[r].val(n):s[r].value=n))}}},e}();var I=function(){var e=function(){var e=null;document.addEventListener("keydown",(function(e){if(27==e.which)for(var t=document.querySelectorAll(".jmodal"),i=0;i<t.length;i++)t[i].parentNode.modal.close()})),document.addEventListener("mouseup",(function(t){let i=t.composedPath();var n=o.findElement(i[0],"jmodal");if(n){var s=n.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0])var r=t.changedTouches[0].clientX,a=t.changedTouches[0].clientY;else r=t.clientX,a=t.clientY;s.width-(r-s.left)<50&&a-s.top<50&&n.parentNode.modal.close()}e&&(e.element.style.cursor="auto",e=null)})),document.addEventListener("mousedown",(function(t){let i=t.composedPath();var n=o.findElement(i[0],"jmodal");if(n){var s=n.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0])var r=t.changedTouches[0].clientX,a=t.changedTouches[0].clientY;else r=t.clientX,a=t.clientY;s.width-(r-s.left)<50&&a-s.top<50||a-s.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),e={left:s.left,top:s.top,x:t.clientX,y:t.clientY,width:s.width,height:s.height,element:n})}})),document.addEventListener("mousemove",(function(t){if(e){if((t=t||window.event).buttons)var i=t.buttons;else i=t.button?t.button:t.which;i?(e.element.style.top=e.top+(t.clientY-e.y)+e.height/2+"px",e.element.style.left=e.left+(t.clientX-e.x)+e.width/2+"px",e.element.style.cursor="move"):e.element.style.cursor="auto"}}))};return function(t,i){var n={options:{}},s={url:null,onopen:null,onclose:null,onload:null,closed:!1,width:null,height:null,title:null,padding:null,backdrop:!0,icon:null};for(var r in s)i&&i.hasOwnProperty(r)?n.options[r]=i[r]:n.options[r]=s[r];!n.options.title&&t.getAttribute("title")&&(n.options.title=t.getAttribute("title"));for(var a=document.createElement("div");t.children[0];)a.appendChild(t.children[0]);for(n.title=document.createElement("div"),n.title.className="jmodal_title",n.options.icon&&n.title.setAttribute("data-icon",n.options.icon),n.content=document.createElement("div"),n.content.className="jmodal_content",n.content.innerHTML=t.innerHTML;a.children[0];)n.content.appendChild(a.children[0]);if(n.container=document.createElement("div"),n.container.className="jmodal",n.container.appendChild(n.title),n.container.appendChild(n.content),n.options.padding&&(n.content.style.padding=n.options.padding),n.options.width&&(n.container.style.width=n.options.width),n.options.height&&(n.container.style.height=n.options.height),n.options.title){var l=document.createElement("h4");l.innerText=n.options.title,n.title.appendChild(l)}if(t.innerHTML="",t.style.display="none",t.appendChild(n.container),n.options.backdrop){var c=document.createElement("div");c.className="jmodal_backdrop",c.onclick=function(){n.close()},t.appendChild(c)}return n.open=function(){t.style.display="block";var e=n.container.getBoundingClientRect();o.getWindowWidth()<e.width?(n.container.style.top="",n.container.style.left="",n.container.classList.add("jmodal_fullscreen"),u.slideBottom(n.container,1)):n.options.backdrop&&(c.style.display="block"),"function"==typeof n.options.onopen&&n.options.onopen(t,n)},n.resetPosition=function(){n.container.style.top="",n.container.style.left=""},n.isOpen=function(){return"none"!=t.style.display},n.close=function(){n.isOpen()&&(t.style.display="none",n.options.backdrop&&(c.style.display=""),n.container.classList.remove("jmodal_fullscreen"),"function"==typeof n.options.onclose&&n.options.onclose(t,n))},n.options.url?d({url:n.options.url,method:"GET",dataType:"text/html",success:function(e){n.content.innerHTML=e,n.options.closed||n.open(),"function"==typeof n.options.onload&&n.options.onload(n)}}):(n.options.closed||n.open(),"function"==typeof n.options.onload&&n.options.onload(n)),t.modal=n,e(),e=function(){},n}}();var k=function(){var e=function(e){var t={options:{}},i={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(var n in i)e&&e.hasOwnProperty(n)?t.options[n]=e[n]:t.options[n]=i[n];var s=document.createElement("div");s.className="jnotification",t.options.error&&s.classList.add("jnotification-error");var r=document.createElement("div");r.className="jnotification-container",s.appendChild(r);var a=document.createElement("div");a.className="jnotification-header",r.appendChild(a);var l=document.createElement("div");if(l.className="jnotification-image",a.appendChild(l),t.options.icon){var c=document.createElement("img");c.src=t.options.icon,l.appendChild(c)}var h=document.createElement("div");if(h.className="jnotification-name",h.innerHTML=t.options.name,a.appendChild(h),1==t.options.closeable){var d=document.createElement("div");d.className="jnotification-close",d.onclick=function(){t.hide()},a.appendChild(d)}var p=document.createElement("div");p.className="jnotification-date",a.appendChild(p);var f=document.createElement("div");if(f.className="jnotification-content",r.appendChild(f),t.options.title){var m=document.createElement("div");m.className="jnotification-title",m.innerHTML=t.options.title,f.appendChild(m)}var g=document.createElement("div");if(g.className="jnotification-message",g.innerHTML=t.options.message,f.appendChild(g),t.show=function(){document.body.appendChild(s),o.getWindowWidth()>800?u.fadeIn(s):u.slideTop(s,1)},t.hide=function(){o.getWindowWidth()>800?u.fadeOut(s,(function(){s.parentNode&&(s.parentNode.removeChild(s),v&&clearTimeout(v))})):u.slideTop(s,0,(function(){s.parentNode&&(s.parentNode.removeChild(s),v&&clearTimeout(v))}))},t.show(),1==t.options.autoHide)var v=setTimeout((function(){t.hide()}),t.options.timeout);return o.getWindowWidth()<800&&s.addEventListener("swipeup",(function(e){t.hide(),e.preventDefault(),e.stopPropagation()})),t};return e.isVisible=function(){var e=document.querySelector(".jnotification");return!(!e||!e.parentNode)},e}();function D(e,t){if(e.search)return e.search;var i=null,n=function(t){if("function"==typeof a.options.onsearch){var i=a.options.onsearch(a,t);i&&(t=i)}if(l.innerHTML="",t.length){e.style.display="block";for(var n=t.length<11?t.length:10,s=0;s<n;s++){if("string"==typeof t[s])var r=t[s],o=t[s];else!(r=t[s].text)&&t[s].name&&(r=t[s].name),!(o=t[s].value)&&t[s].id&&(o=t[s].id);var c=document.createElement("div");c.setAttribute("data-value",o),c.setAttribute("data-text",r),c.className="jsearch_item",t[s].id&&c.setAttribute("id",t[s].id),a.options.forceSelect&&0==s&&c.classList.add("selected");var h=document.createElement("img");t[s].image?h.src=t[s].image:h.style.display="none",c.appendChild(h);var d=document.createElement("div");d.innerHTML=r,c.appendChild(d),l.appendChild(c)}}else e.style.display=""},s=function(e){if(e!=a.terms)if(a.terms=e,i=a.options.forceSelect?0:null,Array.isArray(a.options.data)){var t=a.options.data.filter((function(t){return function(t){if("string"==typeof t){if((""+t).toLowerCase().search(e.toLowerCase())>=0)return!0}else for(var i in t)if((""+t[i]).toLowerCase().search(e.toLowerCase())>=0)return!0;return!1}(t)}));n(t)}else d({url:a.options.data+e,method:"GET",dataType:"json",success:function(e){n(e)}})},r=null,a=function(e){r&&clearTimeout(r),r=setTimeout((function(){s(e)}),500)};null===t.forceSelect&&(t.forceSelect=!0),a.options={data:t.data||null,input:t.input||null,searchByNode:t.searchByNode||null,onselect:t.onselect||null,forceSelect:t.forceSelect,onsearch:t.onsearch||null,onbeforesearch:t.onbeforesearch||null},a.selectIndex=function(e){var t=e.getAttribute("id"),i=e.getAttribute("data-text"),n=e.getAttribute("data-value"),s=e.children[0].src||"";"function"==typeof a.options.onselect&&a.options.onselect(a,i,n,t,s),a.close()},a.open=function(){e.style.display="block"},a.close=function(){r&&clearTimeout(r),a.terms="",l.innerHTML="",e.style.display=""},a.isOpened=function(){return!!e.style.display},a.keydown=function(e){a.isOpened()&&("Enter"==e.key?null!==i&&l.children[i]?(a.selectIndex(l.children[i]),e.preventDefault()):a.close():"ArrowUp"===e.key?(null!==i&&l.children[0]&&(l.children[i].classList.remove("selected"),a.options.forceSelect||0!==i?(i=Math.max(0,i-1),l.children[i].classList.add("selected")):i=null),e.preventDefault()):"ArrowDown"===e.key&&(null==i?i=-1:l.children[i].classList.remove("selected"),i<9&&l.children[i+1]&&i++,l.children[i].classList.add("selected"),e.preventDefault()))},a.keyup=function(e){if(!a.options.searchByNode&&a.options.input)if("DIV"===a.options.input.tagName)var t=a.options.input.innerText;else t=a.options.input.value;else{var i=o.getNode();i&&(t=i.innerText)}if("function"==typeof a.options.onbeforesearch){var n=a.options.onbeforesearch(a,t);if(n)t=n;else if(!1===n)return}a(t)},a.blur=function(e){a.close()},a.options.input&&(a.options.input.addEventListener("keyup",a.keyup),a.options.input.addEventListener("keydown",a.keydown),a.options.input.addEventListener("blur",a.blur));var l=document.createElement("div");return l.classList.add("jsearch_container"),l.onmousedown=function(e){if(e.target.classList.contains("jsearch_item"))var t=e.target;else t=e.target.parentNode;a.selectIndex(t),e.preventDefault()},e.appendChild(l),e.classList.add("jsearch"),e.search=a,a}function j(t,i){var n={options:{}},s={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null};for(var r in s)i&&i.hasOwnProperty(r)?n.options[r]=i[r]:n.options[r]=s[r];1==n.options.multiple&&t.setAttribute("data-multiple",!0),t.content=[],t.classList.add("jupload"),1==n.options.input&&t.classList.add("input"),n.add=function(e){if(0==n.options.multiple&&(t.content=[],t.innerText=""),"image"==n.options.type){var i=document.createElement("img");i.setAttribute("src",e.file),i.setAttribute("tabindex",-1),t.getAttribute("name")||(i.className="jfile",i.content=e),t.appendChild(i)}else{if(e.name)var s=e.name;else s=e.file;var r=document.createElement("div");r.innerText=s||n.options.type,r.classList.add("jupload-item"),r.setAttribute("tabindex",-1),t.appendChild(r)}e.content&&(e.file=o.guid()),t.content.push(e),"function"==typeof n.options.onchange&&n.options.onchange(t,e)},n.addFromFile=function(t){if(t.type.split("/")[0]==n.options.type){var i=new FileReader;i.addEventListener("load",(function(e){var i={file:e.srcElement.result,extension:t.name.substr(t.name.lastIndexOf(".")+1),name:t.name,size:t.size,lastmodified:t.lastModified,content:e.srcElement.result};n.add(i)})),i.readAsDataURL(t)}else alert(e.translate("This extension is not allowed"))},n.addFromUrl=function(e){if("data"==e.substr(0,4)||n.options.remoteParser)if("data"==e.substr(0,4))if((i=(i=e.split(";"))[0].split("/"))[0].replace("data:","")==n.options.type){var t={file:e,name:"",extension:i[1],content:e};n.add(t)}else alert(n.options.text.extensionNotAllowed);else{var i=e.substr(e.lastIndexOf(".")+1);e=n.options.remoteParser+e,d({url:e,type:"GET",dataType:"blob",success:function(e){}})}else console.error("remoteParser not defined in your initialization")};var a=n.options.type+"/"+n.options.extension,l=document.createElement("input");l.type="file",l.setAttribute("accept",a),l.onchange=function(){for(var e=0;e<this.files.length;e++)n.addFromFile(this.files[e])},1==n.options.multiple&&l.setAttribute("multiple",!0);var c=null;return t.addEventListener("click",(function(e){c=null,t.children.length&&e.target!==t?e.target.parentNode==t&&(c=e.target):o.click(l)})),t.addEventListener("dblclick",(function(e){o.click(l)})),t.addEventListener("dragenter",(function(e){t.style.border="1px dashed #000"})),t.addEventListener("dragleave",(function(e){t.style.border="1px solid #eee"})),t.addEventListener("dragstop",(function(e){t.style.border="1px solid #eee"})),t.addEventListener("dragover",(function(e){e.preventDefault()})),t.addEventListener("keydown",(function(e){if(c&&46==e.which){var i=Array.prototype.indexOf.call(t.children,c);i>=0&&(t.content.splice(i,1),c.remove(),c=null)}})),t.addEventListener("drop",(function(e){e.preventDefault(),e.stopPropagation();var i=(e.originalEvent||e).dataTransfer.getData("text/html");if((e.originalEvent||e).dataTransfer.files.length)for(var s=0;s<e.dataTransfer.files.length;s++)n.addFromFile(e.dataTransfer.files[s]);else if(i){0==n.options.multiple&&(t.innerText="");var r=document.createElement("div");r.innerHTML=i;var o=r.querySelectorAll("img");if(o.length)for(s=0;s<o.length;s++)n.addFromUrl(o[s].src)}return t.style.border="1px solid #eee",!1})),t.val=function(e){if(void 0===e)return t.content&&t.content.length?t.content:null;if(t.innerText="",t.content=[],e)if(Array.isArray(e))for(var i=0;i<e.length;i++)"string"==typeof e[i]?n.add({file:e[i]}):n.add(e[i]);else"string"==typeof e&&n.add({file:e})},t.upload=t.image=n,n}var R=n(195),L=n.n(R),M={...e,...o,version:"5.8.3",setExtensions:function(e){if("object"==typeof e)for(var t=Object.keys(e),i=0;i<t.length;i++)M[t[i]]=e[t[i]]},tracking:i,path:a,sorting:l,lazyLoading:c,ajax:d,animation:u,calendar:m,color:_,contextmenu:b,dropdown:C,editor:E,floating:T,form:O,mask:f,modal:I,notification:k,palette:g,picker:w,progressbar:function(e,t){var i={options:{}},n={value:0,onchange:null,width:null};for(var s in n)t&&t.hasOwnProperty(s)?i.options[s]=t[s]:i.options[s]=n[s];e.classList.add("jprogressbar"),e.setAttribute("tabindex",1),e.setAttribute("data-value",i.options.value);var r=document.createElement("div");r.style.width=i.options.value+"%",r.style.color="#fff",e.appendChild(r),i.options.width&&(e.style.width=i.options.width),i.setValue=function(t){t=parseInt(t),i.options.value=t,r.style.width=t+"%",e.setAttribute("data-value",t+"%"),e.style.color=t<6?"#000":"#fff",i.options.value=t,"function"==typeof i.options.onchange&&i.options.onchange(e,t),e.value!=i.options.value&&(e.value=i.options.value,"function"==typeof e.oninput&&e.oninput({type:"input",target:e,value:e.value}))},i.getValue=function(){return i.options.value};var o=function(t){if(t.which){var n=e.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0]){var s=t.changedTouches[0].clientX;t.changedTouches[0].clientY}else s=t.clientX,t.clientY;i.setValue(Math.round((s-n.left)/n.width*100))}};return"touchstart"in document.documentElement==1?(e.addEventListener("touchstart",o),e.addEventListener("touchend",o)):(e.addEventListener("mousedown",o),e.addEventListener("mousemove",o)),e.change=i.setValue,e.val=function(e){if(void 0===e)return i.getValue();i.setValue(e)},e.progressbar=i,i},rating:function(e,t){if(e.rating)return e.rating.setOptions(t,!0);var i={options:{},setOptions:function(t,n){var s={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(var r in s)t&&t.hasOwnProperty(r)?i.options[r]=t[r]:void 0!==i.options[r]&&!0!==n||(i.options[r]=s[r]);e.innerHTML="";for(var o=0;o<i.options.number;o++){var a=document.createElement("div");a.setAttribute("data-index",o+1),a.setAttribute("title",i.options.tooltip[o]),e.appendChild(a)}if(i.options.value)for(o=0;o<i.options.number;o++)o<i.options.value&&e.children[o].classList.add("jrating-selected");return i},setValue:function(t){for(var n=0;n<i.options.number;n++)n<t?e.children[n].classList.add("jrating-selected"):(e.children[n].classList.remove("jrating-over"),e.children[n].classList.remove("jrating-selected"));i.options.value=t,"function"==typeof i.options.onchange&&i.options.onchange(e,t),e.value!=i.options.value&&(e.value=i.options.value,"function"==typeof e.oninput&&e.oninput({type:"input",target:e,value:e.value}))},getValue:function(){return i.options.value}};return i.setOptions(t),e.classList.add("jrating"),e.addEventListener("click",(function(e){var t=e.target.getAttribute("data-index");null!=t&&(t==i.options.value?i.setValue(0):i.setValue(t))})),e.addEventListener("mouseover",(function(t){for(var n=t.target.getAttribute("data-index"),s=0;s<i.options.number;s++)s<n?e.children[s].classList.add("jrating-over"):e.children[s].classList.remove("jrating-over")})),e.addEventListener("mouseout",(function(t){for(var n=0;n<i.options.number;n++)e.children[n].classList.remove("jrating-over")})),e.change=i.setValue,e.val=function(e){if(void 0===e)return i.getValue();i.setValue(e)},e.rating=i,i},search:D,slider:function(e,t){var i={options:{},currentImage:null};if(t&&(i.options=t),e.setAttribute("tabindex","900"),i.options.items=[],!e.classList.contains("jslider")){if(e.classList.add("jslider"),e.classList.add("unselectable"),i.options.height&&(e.style.minHeight=parseInt(i.options.height)+"px"),i.options.width&&(e.style.width=parseInt(i.options.width)+"px"),i.options.grid){e.classList.add("jslider-grid");var n=e.children.length;n>4&&e.setAttribute("data-total",n-4),e.setAttribute("data-number",n>4?4:n)}var s=document.createElement("div");if(s.classList.add("jslider-counter"),e.children.length>0)for(var r=0;r<e.children.length;r++){i.options.items.push(e.children[r]);var o=document.createElement("div");o.onclick=function(){var e=Array.prototype.slice.call(s.children).indexOf(this);i.show(i.currentImage=i.options.items[e])},s.appendChild(o)}var a=document.createElement("div");a.className="jslider-caption";var l=document.createElement("div"),c=document.createElement("div");c.className="jslider-close",c.innerHTML="",c.onclick=function(){i.close()},l.appendChild(a),l.appendChild(c)}i.updateCounter=function(e){for(var t=0;t<s.children.length;t++)if(s.children[t].classList.contains("jslider-counter-focus")){s.children[t].classList.remove("jslider-counter-focus");break}s.children[e].classList.add("jslider-counter-focus")},i.show=function(t){t||(t=e.children[0]),e.classList.add("jslider-focus"),e.classList.remove("jslider-grid"),e.appendChild(l),e.appendChild(s);var n=i.options.items.indexOf(t);i.updateCounter(n);for(var r=0;r<e.children.length;r++)e.children[r].style.display="";t.style.display="block",t.previousElementSibling?e.classList.add("jslider-left"):e.classList.remove("jslider-left"),t.nextElementSibling&&"IMG"==t.nextElementSibling.tagName?e.classList.add("jslider-right"):e.classList.remove("jslider-right"),i.currentImage=t,i.currentImage.offsetHeight>i.currentImage.offsetWidth&&i.currentImage.classList.add("jslider-vertical"),l.children[0].innerText=i.currentImage.getAttribute("title")},i.open=function(){i.show(),"function"==typeof i.options.onopen&&i.options.onopen(e)},i.close=function(){e.classList.remove("jslider-focus"),e.classList.remove("jslider-left"),e.classList.remove("jslider-right"),i.options.grid&&e.classList.add("jslider-grid");for(var t=0;t<e.children.length;t++)e.children[t].style.display="";s.remove(),l.remove(),i.currentImage=null,"function"==typeof i.options.onclose&&i.options.onclose(e)},i.reset=function(){e.innerHTML=""},i.next=function(){var e=i.currentImage.nextElementSibling;e&&"IMG"===e.tagName&&i.show(i.currentImage.nextElementSibling)},i.prev=function(){i.currentImage.previousElementSibling&&i.show(i.currentImage.previousElementSibling)};var h=function(e){if("IMG"==e.target.tagName)i.show(e.target);else if(!e.target.classList.contains("jslider-close")&&!e.target.parentNode.classList.contains("jslider-counter")&&!e.target.classList.contains("jslider-counter")){var t=e.offsetX||e.changedTouches[0].clientX;e.target.clientWidth-t<40?i.next():t<40&&i.prev()}};return"ontouchend"in document.documentElement==1?e.addEventListener("touchend",h):e.addEventListener("mouseup",h),e.addEventListener("swipeleft",(function(e){i.next(),e.preventDefault(),e.stopPropagation()})),e.addEventListener("swiperight",(function(e){i.prev(),e.preventDefault(),e.stopPropagation()})),e.addEventListener("keydown",(function(e){27==e.which&&i.close()})),e.slider=i,i},tabs:v,tags:function(t,i){if(t.tags)return t.tags.setOptions(i,!0);var n={type:"tags",options:{}},s=function(){return!!(n.options.limit&&t.children.length>=n.options.limit)},r=null,a=null;n.setOptions=function(e,i){var s={value:"",limit:null,search:null,placeholder:null,validation:null,onbeforepaste:null,onbeforechange:null,onremoveitem:null,onlimit:null,onchange:null,onfocus:null,onblur:null,onload:null};for(var o in s)e&&e.hasOwnProperty(o)?n.options[o]=e[o]:void 0!==n.options[o]&&!0!==i||(n.options[o]=s[o]);return n.options.placeholder?t.setAttribute("data-placeholder",n.options.placeholder):t.removeAttribute("data-placeholder"),t.placeholder=n.options.placeholder,n.setValue(n.options.value),d(),n.options.search?a||(a=document.createElement("div"),t.parentNode.insertBefore(a,t.nextSibling),r=D(a,{data:n.options.search,onselect:function(e,t,i){n.selectIndex(t,i)}})):a&&(r=null,a.remove(),a=null),n},n.add=function(i,a){if("function"==typeof n.options.onbeforechange){var d=n.options.onbeforechange(t,n,n.options.value,i);if(!1===d)return!1;null!=d&&(i=d)}if(r&&r.close(),s())"function"==typeof n.options.onlimit?n.options.onlimit(n,n.options.limit):alert(e.translate("You reach the limit number of entries")+" "+n.options.limit);else{var u=o.getNode();if(!(u&&u.parentNode&&u.parentNode.classList.contains("jtags")&&u.nextSibling)||u.nextSibling.innerText&&u.nextSibling.innerText.trim()){if(t.lastChild&&(t.lastChild.innerText.trim()||t.removeChild(t.lastChild)),i&&"string"!=typeof i){for(var p=0;p<=i.length;p++)if(!s()){if(i[p]&&"string"!=typeof i[p])f=i[p].text,m=i[p].value;else var f=i[p]||"",m=null;g=c(f,m)}}else var g=c(i,i,u);h()}else g=u.nextSibling;a&&l(g)}},n.setLimit=function(e){for(n.options.limit=e,t.children.length;t.children.length>e;)t.removeChild(t.lastChild)},n.remove=function(e){e.parentNode.removeChild(e),t.children.length?h():n.add("",!0),"function"==typeof n.options.onremoveitem&&n.options.onremoveitem(t,n,e)},n.getData=function(){for(var e=[],i=0;i<t.children.length;i++){var n=t.children[i].innerText.replace("\n",""),s=t.children[i].getAttribute("data-value");s||(s=n),(n||s)&&e.push({text:n,value:s})}return e},n.getValue=function(e){var i=null;if(null!=e)(i=t.children[e].getAttribute("data-value"))||(i=t.children[e].innerText.replace("\n",""));else{for(var s=[],r=0;r<t.children.length;r++)(i=t.children[r].innerText.replace("\n",""))&&s.push(n.getValue(r));i=s.join(",")}return i},n.setValue=function(e){if(e){if(t.value!=e)if(Array.isArray(e))n.add(e);else{var i=(""+e).trim(),s=p(i);t.innerHTML="",n.add(s)}}else n.reset()},n.reset=function(){t.classList.add("jtags-empty"),t.innerHTML="<div></div>",h()},n.isValid=function(){for(var e=0,i=0;i<t.children.length;i++)t.children[i].classList.contains("jtags_error")&&e++;return 0==e},n.selectIndex=function(e,t){var i=o.getNode();i&&(i.innerText=e,t&&i.setAttribute("data-value",t),i.classList.remove("jtags_error"),s()||n.add("",!0))},n.search=function(e){e.innerText},n.destroy=function(){t.removeEventListener("mouseup",_),t.removeEventListener("keydown",m),t.removeEventListener("keyup",g),t.removeEventListener("paste",v),t.removeEventListener("focus",b),t.removeEventListener("blur",y),t.parentNode.removeChild(t)};var l=function(e){if(t.children.length){var i=document.createRange(),n=window.getSelection();e||(e=t.childNodes[t.childNodes.length-1]),i.setStart(e,e.length),i.collapse(!0),n.removeAllRanges(),n.addRange(i),t.scrollLeft=t.scrollWidth}},c=function(e,i,n){var s=document.createElement("div");return s.textContent=e||"",i&&s.setAttribute("data-value",i),n&&n.parentNode.classList.contains("jtags")?t.insertBefore(s,n.nextSibling):t.appendChild(s),s},h=function(){var e=n.getValue();e!=n.options.value&&(n.options.value=e,"function"==typeof n.options.onchange&&n.options.onchange(t,n,n.options.value),t.value!=n.options.value&&(t.value=n.options.value,"function"==typeof t.oninput&&t.oninput({type:"input",target:t,value:t.value}))),d()},d=function(){for(var e=0;e<t.children.length;e++)"DIV"===t.children[e].tagName&&(n.getValue(e)?(t.children[e].classList.add("jtags_label"),"function"==typeof n.options.validation&&n.getValue(e)?n.options.validation(t.children[e],t.children[e].innerText,t.children[e].getAttribute("data-value"))?t.children[e].classList.remove("jtags_error"):t.children[e].classList.add("jtags_error"):t.children[e].classList.remove("jtags_error")):t.children[e].classList.remove("jtags_label"));u()},u=function(){t.innerText.trim()?t.classList.remove("jtags-empty"):t.children.length&&"BR"!==t.children[0].tagName||(t.innerHTML="",l(c()))},p=function(e){var t=[],i="";if(e=e.trim()){for(var n=0;n<e.length;n++)","==e[n]||";"==e[n]||"\n"==e[n]?i&&(t.push(i.trim()),i=""):i+=e[n];i&&t.push(i)}return t},f=0,m=function(e){f=window.getSelection().anchorOffset,u(),"Tab"===e.key||";"===e.key||","===e.key?(window.getSelection().anchorOffset>1&&(s()?"function"==typeof n.options.onlimit&&n.options.onlimit(n,n.options.limit):n.add("",!0)),e.preventDefault()):"Enter"==e.key?r&&r.isOpened()||(window.getSelection().anchorOffset>1&&(s()||n.add("",!0)),e.preventDefault()):"Backspace"==e.key&&1==t.children.length&&window.getSelection().anchorOffset<1&&e.preventDefault(),r&&r.keydown(e),u()},g=function(e){if(39==e.which){var t=window.getSelection().anchorOffset;t>1&&t==f&&n.add("",!0)}else 13==e.which||38==e.which||40==e.which?e.preventDefault():r&&r.keyup(e);d()},v=function(e){if(e.clipboardData||e.originalEvent.clipboardData)var i=(e.originalEvent||e).clipboardData.getData("text/plain");else window.clipboardData&&(i=window.clipboardData.getData("Text"));var s=p(i);if("function"==typeof n.options.onbeforepaste){var r=n.options.onbeforepaste(t,n,s);if(!1===r)return e.preventDefault(),!1;r&&(s=r)}s.length>1?(n.add(s,!0),e.preventDefault()):s[0]&&(document.execCommand("insertText",!1,s[0]),e.preventDefault())},_=function(e){if(e.target.parentNode&&e.target.parentNode.classList.contains("jtags")&&(e.target.classList.contains("jtags_label")||e.target.classList.contains("jtags_error"))){var i=e.target.getBoundingClientRect();i.width-(e.clientX-i.left)<16&&n.remove(e.target)}e.target==t&&l()},b=function(){t.classList.contains("jtags-focus")||(t.children.length&&!n.getValue(t.children.length-1)||s()||c(""),"function"==typeof n.options.onfocus&&n.options.onfocus(t,n,n.getValue()),t.classList.add("jtags-focus"))},y=function(){if(t.classList.contains("jtags-focus")){r&&r.close();for(var e=0;e<t.children.length-1;e++)n.getValue(e)||t.removeChild(t.children[e]);h(),t.classList.remove("jtags-focus"),"function"==typeof n.options.onblur&&n.options.onblur(t,n,n.getValue())}};return"touchend"in document.documentElement==1?t.addEventListener("touchend",_):t.addEventListener("mouseup",_),t.addEventListener("keydown",m),t.addEventListener("keyup",g),t.addEventListener("paste",v),t.addEventListener("focus",b),t.addEventListener("blur",y),t.setAttribute("contenteditable",!0),t.classList.add("jtags"),n.setOptions(i),"function"==typeof n.options.onload&&n.options.onload(t,n),t.change=n.setValue,t.val=function(e){if(void 0===e)return n.getValue();n.setValue(e)},t.tags=n,n},toolbar:S,upload:j,validations:A};M.image=j,M.image.create=function(e){var t=document.createElement("img");return t.setAttribute("src",e.file),t.className="jfile",t.setAttribute("tabindex",-1),t.content=e,t},M.tracker=O,M.loading=u.loading,M.sha512=L();"undefined"!=typeof document&&function(){if(void 0!==window.jSuitesStateControl)return;window.jSuitesStateControl=[];const e=function(t,i){return!(!t[i.type]||t[i.type]!=i)||!(!t.component||t.component!=i)||!!t.parentNode&&e(t.parentNode,i)};let t=15,i=!1,n={x:null,y:null},s=document.createElement("div");s.classList.add("jtooltip");const r=function(e){return e&&(e.shadowRoot||e.tagName&&e.tagName.includes("-"))},o=function(e){let t,i,n=e.path||e.composedPath&&e.composedPath();return n?(i=n[0],i&&r(i)&&!i.shadowRoot&&e.toElement&&(i=e.toElement)):(t=e.target&&r(e.target)?e.target.shadowRoot:document,i=t.elementFromPoint(x,y)),i};let a,l=["n","ne","e","se","s","sw","w","nw","rotate"];l.forEach((function(e,t){l[t]=document.createElement("div"),l[t].classList.add("jpanel-action"),"rotate"===e?l[t].setAttribute("data-action","rotate"):(l[t].setAttribute("data-action","resize"),l[t].setAttribute("data-position",e+"-resize"))}));const c=function(e){let t=o(e),i=M.findElement(t,"jpanel");i&&!i.classList.contains("readonly")&&i.classList.contains("jpanel-controls")?(i.append(...l),i.classList.contains("jpanel-rotate")||l[l.length-1].remove(),a=i):h(e)},h=function(e){a&&(l.forEach((function(e){e.remove()})),a=null)};document.addEventListener("focusin",c),document.addEventListener("mouseup",(function(e){i&&i.e&&("function"==typeof i.e.refresh&&n.actioned&&i.e.refresh(),i.e.style.cursor=""),n={x:null,y:null},i=!1})),document.addEventListener("mousedown",(function(t){if(t.changedTouches&&t.changedTouches[0])var n=t.changedTouches[0].clientX,s=t.changedTouches[0].clientY;else n=t.clientX,s=t.clientY;let r=o(t),a=r&&"DIV"===r.tagName&&r.getAttribute("contentEditable"),l=M.findElement(r,"jpanel");if(!l||l.classList.contains("readonly")||a)i=!1;else{let e=l.getBoundingClientRect(),t=0;l.style.rotate&&(t=parseFloat(l.style.rotate));let o="move";r.getAttribute("data-action")?o=r.getAttribute("data-action"):l.style.cursor?o="resize":l.style.cursor="move",i={action:o,a:t,e:l,x:n,y:s,l:e.left,t:e.top,b:e.bottom,r:e.right,w:e.width,h:e.height,d:l.style.cursor,actioned:!1},l.style.width||(l.style.width=e.width+"px"),l.style.height||(l.style.height=e.height+"px")}(function(t){let i=window.jSuitesStateControl;if(i&&i.length>0)for(let n=0;n<i.length;n++)i[n]&&!e(t,i[n])&&i[n].close()})(r),c(t)})),document.addEventListener("mousemove",(function(e){if(i){let t=e.clientX||e.pageX,o=e.clientY||e.pageY;if(null==n.x&&null==n.y&&(n.x=t,n.y=o),"move"===i.action){var s=t-n.x,r=o-n.y,a=i.e.offsetTop+r,l=i.e.offsetLeft+s;i.e.style.top=a+"px",i.e.style.left=l+"px","function"==typeof i.e.refresh&&(n.actioned=!0,i.e.refresh("position",a,l))}else if("rotate"===i.action){let e=function(e,t,i,n,s,r){const o=i-e,a=n-t,l=s-e,c=r-t;let h=Math.atan2(a,o),d=Math.atan2(c,l)-h;return d*=180/Math.PI,d<0&&(d+=360),d}(i.l+i.w/2,i.t+i.h/2,i.x,i.y,t,o);e+=i.a%360,e=2*Math.round(e/2),i.e.style.rotate=`${e}deg`,"function"==typeof i.e.refresh&&(n.actioned=!0,i.e.refresh("rotate",e))}else if("resize"===i.action){let s=null,r=null,a=null,l=null;"e-resize"==i.d||"ne-resize"==i.d||"se-resize"==i.d?(a=i.e.offsetWidth+(t-n.x),e.shiftKey&&(l=i.e.offsetHeight+(t-n.x)*(i.e.offsetHeight/i.e.offsetWidth))):"w-resize"!==i.d&&"nw-resize"!=i.d&&"sw-resize"!=i.d||(r=i.e.offsetLeft+(t-n.x),a=i.e.offsetLeft+i.e.offsetWidth-r,e.shiftKey&&(l=i.e.offsetHeight-(t-n.x)*(i.e.offsetHeight/i.e.offsetWidth))),"s-resize"==i.d||"se-resize"==i.d||"sw-resize"==i.d?l||(l=i.e.offsetHeight+(o-n.y)):"n-resize"!==i.d&&"ne-resize"!=i.d&&"nw-resize"!=i.d||(s=i.e.offsetTop+(o-n.y),l=i.e.offsetTop+i.e.offsetHeight-s),s&&(i.e.style.top=s+"px"),r&&(i.e.style.left=r+"px"),a&&(i.e.style.width=a+"px"),l&&(i.e.style.height=l+"px"),"function"==typeof i.e.refresh&&(n.actioned=!0,i.e.refresh("dimensions",a,l))}n.x=t,n.y=o}else{let i=o(e),n=M.findElement(i,"jpanel");if(n)if(n.classList.contains("jpanel-controls")){let e=i.getAttribute("data-position");n.style.cursor=e||""}else if(n.getAttribute("tabindex")){let i=n.getBoundingClientRect();e.clientY-i.top<t?i.width-(e.clientX-i.left)<t?n.style.cursor="ne-resize":e.clientX-i.left<t?n.style.cursor="nw-resize":n.style.cursor="n-resize":i.height-(e.clientY-i.top)<t?i.width-(e.clientX-i.left)<t?n.style.cursor="se-resize":e.clientX-i.left<t?n.style.cursor="sw-resize":n.style.cursor="s-resize":i.width-(e.clientX-i.left)<t?n.style.cursor="e-resize":e.clientX-i.left<t?n.style.cursor="w-resize":n.style.cursor=""}}})),document.addEventListener("mouseover",(function(e){var t=o(e).getAttribute("data-tooltip");if(t){if(s.innerText=t,e.changedTouches&&e.changedTouches[0])var i=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY;else i=e.clientX,n=e.clientY;s.style.top=n+"px",s.style.left=i+"px",document.body.appendChild(s)}else s.innerText&&(s.innerText="",document.body.removeChild(s))})),document.addEventListener("keydown",(function(e){let t=document.activeElement;t&&"Delete"===e.key&&"function"==typeof t.delete&&(t.delete(),e.preventDefault(),e.stopImmediatePropagation());let i=window.jSuitesStateControl;i&&i.length>0&&(t=i[i.length-1],t&&"Escape"===e.key&&"function"==typeof t.isOpened&&"function"==typeof t.close&&t.isOpened()&&(t.close(),e.preventDefault(),e.stopImmediatePropagation()))})),document.addEventListener("contextmenu",(function(e){var t=document.activeElement;if(t&&"function"==typeof t.contextmenu)t.contextmenu(e),e.preventDefault(),e.stopImmediatePropagation();else if(t=M.findElement(e.target,(function(e){return e.tagName&&e.getAttribute("aria-contextmenu-id")})),t){var i=document.querySelector("#"+t);i?(i.contextmenu.open(e),e.preventDefault(),e.stopImmediatePropagation()):console.error("JSUITES: contextmenu id not found: "+t)}})),document.addEventListener("input",(function(e){(e.target.getAttribute("data-mask")||e.target.mask)&&M.mask(e)}))}();var P=M}(),t=s.default}(),t)},965:function(e){e.exports=function(){"use strict";var e=Object.prototype.toString,t=Array.isArray||function(t){return"[object Array]"===e.call(t)};function i(e){return"function"==typeof e}function n(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function s(e,t){return null!=e&&"object"==typeof e&&t in e}var r=RegExp.prototype.test;var o=/\S/;function a(e){return!function(e,t){return r.call(e,t)}(o,e)}var l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};var c=/\s*/,h=/\s+/,d=/\s*=/,u=/\s*\}/,p=/#|\^|\/|>|\{|&|=|!/;function f(e){this.string=e,this.tail=e,this.pos=0}function m(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function g(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}f.prototype.eos=function(){return""===this.tail},f.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var i=t[0];return this.tail=this.tail.substring(i.length),this.pos+=i.length,i},f.prototype.scanUntil=function(e){var t,i=this.tail.search(e);switch(i){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,i),this.tail=this.tail.substring(i)}return this.pos+=t.length,t},m.prototype.push=function(e){return new m(e,this)},m.prototype.lookup=function(e){var t,n,r,o=this.cache;if(o.hasOwnProperty(e))t=o[e];else{for(var a,l,c,h=this,d=!1;h;){if(e.indexOf(".")>0)for(a=h.view,l=e.split("."),c=0;null!=a&&c<l.length;)c===l.length-1&&(d=s(a,l[c])||(n=a,r=l[c],null!=n&&"object"!=typeof n&&n.hasOwnProperty&&n.hasOwnProperty(r))),a=a[l[c++]];else a=h.view[e],d=s(h.view,e);if(d){t=a;break}h=h.parent}o[e]=t}return i(t)&&(t=t.call(this.view)),t},g.prototype.clearCache=function(){void 0!==this.templateCache&&this.templateCache.clear()},g.prototype.parse=function(e,i){var s=this.templateCache,r=e+":"+(i||v.tags).join(":"),o=void 0!==s,l=o?s.get(r):void 0;return null==l&&(l=function(e,i){if(!e)return[];var s,r,o,l=!1,m=[],g=[],_=[],b=!1,y=!1,C="",w=0;function S(){if(b&&!y)for(;_.length;)delete g[_.pop()];else _=[];b=!1,y=!1}function E(e){if("string"==typeof e&&(e=e.split(h,2)),!t(e)||2!==e.length)throw new Error("Invalid tags: "+e);s=new RegExp(n(e[0])+"\\s*"),r=new RegExp("\\s*"+n(e[1])),o=new RegExp("\\s*"+n("}"+e[1]))}E(i||v.tags);for(var x,T,A,O,I,k,D=new f(e);!D.eos();){if(x=D.pos,A=D.scanUntil(s))for(var j=0,R=A.length;j<R;++j)a(O=A.charAt(j))?(_.push(g.length),C+=O):(y=!0,l=!0,C+=" "),g.push(["text",O,x,x+1]),x+=1,"\n"===O&&(S(),C="",w=0,l=!1);if(!D.scan(s))break;if(b=!0,T=D.scan(p)||"name",D.scan(c),"="===T?(A=D.scanUntil(d),D.scan(d),D.scanUntil(r)):"{"===T?(A=D.scanUntil(o),D.scan(u),D.scanUntil(r),T="&"):A=D.scanUntil(r),!D.scan(r))throw new Error("Unclosed tag at "+D.pos);if(I=">"==T?[T,A,x,D.pos,C,w,l]:[T,A,x,D.pos],w++,g.push(I),"#"===T||"^"===T)m.push(I);else if("/"===T){if(!(k=m.pop()))throw new Error('Unopened section "'+A+'" at '+x);if(k[1]!==A)throw new Error('Unclosed section "'+k[1]+'" at '+x)}else"name"===T||"{"===T||"&"===T?y=!0:"="===T&&E(A)}if(S(),k=m.pop())throw new Error('Unclosed section "'+k[1]+'" at '+D.pos);return function(e){for(var t,i=[],n=i,s=[],r=0,o=e.length;r<o;++r)switch((t=e[r])[0]){case"#":case"^":n.push(t),s.push(t),n=t[4]=[];break;case"/":s.pop()[5]=t[2],n=s.length>0?s[s.length-1][4]:i;break;default:n.push(t)}return i}(function(e){for(var t,i,n=[],s=0,r=e.length;s<r;++s)(t=e[s])&&("text"===t[0]&&i&&"text"===i[0]?(i[1]+=t[1],i[3]=t[3]):(n.push(t),i=t));return n}(g))}(e,i),o&&s.set(r,l)),l},g.prototype.render=function(e,t,i,n){var s=this.getConfigTags(n),r=this.parse(e,s),o=t instanceof m?t:new m(t,void 0);return this.renderTokens(r,o,i,e,n)},g.prototype.renderTokens=function(e,t,i,n,s){for(var r,o,a,l="",c=0,h=e.length;c<h;++c)a=void 0,"#"===(o=(r=e[c])[0])?a=this.renderSection(r,t,i,n,s):"^"===o?a=this.renderInverted(r,t,i,n,s):">"===o?a=this.renderPartial(r,t,i,s):"&"===o?a=this.unescapedValue(r,t):"name"===o?a=this.escapedValue(r,t,s):"text"===o&&(a=this.rawValue(r)),void 0!==a&&(l+=a);return l},g.prototype.renderSection=function(e,n,s,r,o){var a=this,l="",c=n.lookup(e[1]);if(c){if(t(c))for(var h=0,d=c.length;h<d;++h)l+=this.renderTokens(e[4],n.push(c[h]),s,r,o);else if("object"==typeof c||"string"==typeof c||"number"==typeof c)l+=this.renderTokens(e[4],n.push(c),s,r,o);else if(i(c)){if("string"!=typeof r)throw new Error("Cannot use higher-order sections without the original template");null!=(c=c.call(n.view,r.slice(e[3],e[5]),(function(e){return a.render(e,n,s,o)})))&&(l+=c)}else l+=this.renderTokens(e[4],n,s,r,o);return l}},g.prototype.renderInverted=function(e,i,n,s,r){var o=i.lookup(e[1]);if(!o||t(o)&&0===o.length)return this.renderTokens(e[4],i,n,s,r)},g.prototype.indentPartial=function(e,t,i){for(var n=t.replace(/[^ \t]/g,""),s=e.split("\n"),r=0;r<s.length;r++)s[r].length&&(r>0||!i)&&(s[r]=n+s[r]);return s.join("\n")},g.prototype.renderPartial=function(e,t,n,s){if(n){var r=this.getConfigTags(s),o=i(n)?n(e[1]):n[e[1]];if(null!=o){var a=e[6],l=e[5],c=e[4],h=o;0==l&&c&&(h=this.indentPartial(o,c,a));var d=this.parse(h,r);return this.renderTokens(d,t,n,h,s)}}},g.prototype.unescapedValue=function(e,t){var i=t.lookup(e[1]);if(null!=i)return i},g.prototype.escapedValue=function(e,t,i){var n=this.getConfigEscape(i)||v.escape,s=t.lookup(e[1]);if(null!=s)return"number"==typeof s&&n===v.escape?String(s):n(s)},g.prototype.rawValue=function(e){return e[1]},g.prototype.getConfigTags=function(e){return t(e)?e:e&&"object"==typeof e?e.tags:void 0},g.prototype.getConfigEscape=function(e){return e&&"object"==typeof e&&!t(e)?e.escape:void 0};var v={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){_.templateCache=e},get templateCache(){return _.templateCache}},_=new g;return v.clearCache=function(){return _.clearCache()},v.parse=function(e,t){return _.parse(e,t)},v.render=function(e,i,n,s){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+function(e){return t(e)?"array":typeof e}(e)+'" was given as the first argument for mustache#render(template, view, partials)');return _.render(e,i,n,s)},v.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,(function(e){return l[e]}))},v.Scanner=f,v.Context=m,v.Writer=g,v}()},668:(e,t,i)=>{"use strict";const{Deflate:n,deflate:s,deflateRaw:r,gzip:o}=i(303),{Inflate:a,inflate:l,inflateRaw:c,ungzip:h}=i(83),d=i(681);e.exports.Deflate=n,e.exports.deflate=s,e.exports.deflateRaw=r,e.exports.gzip=o,e.exports.Inflate=a,e.exports.inflate=l,e.exports.inflateRaw=c,e.exports.ungzip=h,e.exports.constants=d},303:(e,t,i)=>{"use strict";const n=i(411),s=i(805),r=i(996),o=i(674),a=i(442),l=Object.prototype.toString,{Z_NO_FLUSH:c,Z_SYNC_FLUSH:h,Z_FULL_FLUSH:d,Z_FINISH:u,Z_OK:p,Z_STREAM_END:f,Z_DEFAULT_COMPRESSION:m,Z_DEFAULT_STRATEGY:g,Z_DEFLATED:v}=i(681);function _(e){this.options=s.assign({level:m,method:v,chunkSize:16384,windowBits:15,memLevel:8,strategy:g},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;let i=n.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(i!==p)throw new Error(o[i]);if(t.header&&n.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?r.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,i=n.deflateSetDictionary(this.strm,e),i!==p)throw new Error(o[i]);this._dict_set=!0}}function b(e,t){const i=new _(t);if(i.push(e,!0),i.err)throw i.msg||o[i.err];return i.result}_.prototype.push=function(e,t){const i=this.strm,s=this.options.chunkSize;let o,a;if(this.ended)return!1;for(a=t===~~t?t:!0===t?u:c,"string"==typeof e?i.input=r.string2buf(e):"[object ArrayBuffer]"===l.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;)if(0===i.avail_out&&(i.output=new Uint8Array(s),i.next_out=0,i.avail_out=s),(a===h||a===d)&&i.avail_out<=6)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else{if(o=n.deflate(i,a),o===f)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),o=n.deflateEnd(this.strm),this.onEnd(o),this.ended=!0,o===p;if(0!==i.avail_out){if(a>0&&i.next_out>0)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else if(0===i.avail_in)break}else this.onData(i.output)}return!0},_.prototype.onData=function(e){this.chunks.push(e)},_.prototype.onEnd=function(e){e===p&&(this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},e.exports.Deflate=_,e.exports.deflate=b,e.exports.deflateRaw=function(e,t){return(t=t||{}).raw=!0,b(e,t)},e.exports.gzip=function(e,t){return(t=t||{}).gzip=!0,b(e,t)},e.exports.constants=i(681)},83:(e,t,i)=>{"use strict";const n=i(447),s=i(805),r=i(996),o=i(674),a=i(442),l=i(414),c=Object.prototype.toString,{Z_NO_FLUSH:h,Z_FINISH:d,Z_OK:u,Z_STREAM_END:p,Z_NEED_DICT:f,Z_STREAM_ERROR:m,Z_DATA_ERROR:g,Z_MEM_ERROR:v}=i(681);function _(e){this.options=s.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(15&t.windowBits||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;let i=n.inflateInit2(this.strm,t.windowBits);if(i!==u)throw new Error(o[i]);if(this.header=new l,n.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=r.string2buf(t.dictionary):"[object ArrayBuffer]"===c.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(i=n.inflateSetDictionary(this.strm,t.dictionary),i!==u)))throw new Error(o[i])}function b(e,t){const i=new _(t);if(i.push(e),i.err)throw i.msg||o[i.err];return i.result}_.prototype.push=function(e,t){const i=this.strm,s=this.options.chunkSize,o=this.options.dictionary;let a,l,_;if(this.ended)return!1;for(l=t===~~t?t:!0===t?d:h,"[object ArrayBuffer]"===c.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;){for(0===i.avail_out&&(i.output=new Uint8Array(s),i.next_out=0,i.avail_out=s),a=n.inflate(i,l),a===f&&o&&(a=n.inflateSetDictionary(i,o),a===u?a=n.inflate(i,l):a===g&&(a=f));i.avail_in>0&&a===p&&i.state.wrap>0&&0!==e[i.next_in];)n.inflateReset(i),a=n.inflate(i,l);switch(a){case m:case g:case f:case v:return this.onEnd(a),this.ended=!0,!1}if(_=i.avail_out,i.next_out&&(0===i.avail_out||a===p))if("string"===this.options.to){let e=r.utf8border(i.output,i.next_out),t=i.next_out-e,n=r.buf2string(i.output,e);i.next_out=t,i.avail_out=s-t,t&&i.output.set(i.output.subarray(e,e+t),0),this.onData(n)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(a!==u||0!==_){if(a===p)return a=n.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(0===i.avail_in)break}}return!0},_.prototype.onData=function(e){this.chunks.push(e)},_.prototype.onEnd=function(e){e===u&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},e.exports.Inflate=_,e.exports.inflate=b,e.exports.inflateRaw=function(e,t){return(t=t||{}).raw=!0,b(e,t)},e.exports.ungzip=b,e.exports.constants=i(681)},805:e=>{"use strict";const t=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);e.exports.assign=function(e){const i=Array.prototype.slice.call(arguments,1);for(;i.length;){const n=i.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(const i in n)t(n,i)&&(e[i]=n[i])}}return e},e.exports.flattenChunks=e=>{let t=0;for(let i=0,n=e.length;i<n;i++)t+=e[i].length;const i=new Uint8Array(t);for(let t=0,n=0,s=e.length;t<s;t++){let s=e[t];i.set(s,n),n+=s.length}return i}},996:e=>{"use strict";let t=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){t=!1}const i=new Uint8Array(256);for(let e=0;e<256;e++)i[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;i[254]=i[254]=1,e.exports.string2buf=e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,i,n,s,r,o=e.length,a=0;for(s=0;s<o;s++)i=e.charCodeAt(s),55296==(64512&i)&&s+1<o&&(n=e.charCodeAt(s+1),56320==(64512&n)&&(i=65536+(i-55296<<10)+(n-56320),s++)),a+=i<128?1:i<2048?2:i<65536?3:4;for(t=new Uint8Array(a),r=0,s=0;r<a;s++)i=e.charCodeAt(s),55296==(64512&i)&&s+1<o&&(n=e.charCodeAt(s+1),56320==(64512&n)&&(i=65536+(i-55296<<10)+(n-56320),s++)),i<128?t[r++]=i:i<2048?(t[r++]=192|i>>>6,t[r++]=128|63&i):i<65536?(t[r++]=224|i>>>12,t[r++]=128|i>>>6&63,t[r++]=128|63&i):(t[r++]=240|i>>>18,t[r++]=128|i>>>12&63,t[r++]=128|i>>>6&63,t[r++]=128|63&i);return t},e.exports.buf2string=(e,n)=>{const s=n||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,n));let r,o;const a=new Array(2*s);for(o=0,r=0;r<s;){let t=e[r++];if(t<128){a[o++]=t;continue}let n=i[t];if(n>4)a[o++]=65533,r+=n-1;else{for(t&=2===n?31:3===n?15:7;n>1&&r<s;)t=t<<6|63&e[r++],n--;n>1?a[o++]=65533:t<65536?a[o++]=t:(t-=65536,a[o++]=55296|t>>10&1023,a[o++]=56320|1023&t)}}return((e,i)=>{if(i<65534&&e.subarray&&t)return String.fromCharCode.apply(null,e.length===i?e:e.subarray(0,i));let n="";for(let t=0;t<i;t++)n+=String.fromCharCode(e[t]);return n})(a,o)},e.exports.utf8border=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let n=t-1;for(;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+i[e[n]]>t?n:t}},269:e=>{"use strict";e.exports=(e,t,i,n)=>{let s=65535&e,r=e>>>16&65535,o=0;for(;0!==i;){o=i>2e3?2e3:i,i-=o;do{s=s+t[n++]|0,r=r+s|0}while(--o);s%=65521,r%=65521}return s|r<<16}},681:e=>{"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},823:e=>{"use strict";const t=new Uint32Array((()=>{let e,t=[];for(var i=0;i<256;i++){e=i;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t})());e.exports=(e,i,n,s)=>{const r=t,o=s+n;e^=-1;for(let t=s;t<o;t++)e=e>>>8^r[255&(e^i[t])];return~e}},411:(e,t,i)=>{"use strict";const{_tr_init:n,_tr_stored_block:s,_tr_flush_block:r,_tr_tally:o,_tr_align:a}=i(665),l=i(269),c=i(823),h=i(674),{Z_NO_FLUSH:d,Z_PARTIAL_FLUSH:u,Z_FULL_FLUSH:p,Z_FINISH:f,Z_BLOCK:m,Z_OK:g,Z_STREAM_END:v,Z_STREAM_ERROR:_,Z_DATA_ERROR:b,Z_BUF_ERROR:y,Z_DEFAULT_COMPRESSION:C,Z_FILTERED:w,Z_HUFFMAN_ONLY:S,Z_RLE:E,Z_FIXED:x,Z_DEFAULT_STRATEGY:T,Z_UNKNOWN:A,Z_DEFLATED:O}=i(681),I=258,k=262,D=42,j=113,R=666,L=(e,t)=>(e.msg=h[t],t),M=e=>2*e-(e>4?9:0),P=e=>{let t=e.length;for(;--t>=0;)e[t]=0},N=e=>{let t,i,n,s=e.w_size;t=e.hash_size,n=t;do{i=e.head[--n],e.head[n]=i>=s?i-s:0}while(--t);t=s,n=t;do{i=e.prev[--n],e.prev[n]=i>=s?i-s:0}while(--t)};let F=(e,t,i)=>(t<<e.hash_shift^i)&e.hash_mask;const H=e=>{const t=e.state;let i=t.pending;i>e.avail_out&&(i=e.avail_out),0!==i&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+i),e.next_out),e.next_out+=i,t.pending_out+=i,e.total_out+=i,e.avail_out-=i,t.pending-=i,0===t.pending&&(t.pending_out=0))},B=(e,t)=>{r(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,H(e.strm)},z=(e,t)=>{e.pending_buf[e.pending++]=t},V=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},W=(e,t,i,n)=>{let s=e.avail_in;return s>n&&(s=n),0===s?0:(e.avail_in-=s,t.set(e.input.subarray(e.next_in,e.next_in+s),i),1===e.state.wrap?e.adler=l(e.adler,t,s,i):2===e.state.wrap&&(e.adler=c(e.adler,t,s,i)),e.next_in+=s,e.total_in+=s,s)},$=(e,t)=>{let i,n,s=e.max_chain_length,r=e.strstart,o=e.prev_length,a=e.nice_match;const l=e.strstart>e.w_size-k?e.strstart-(e.w_size-k):0,c=e.window,h=e.w_mask,d=e.prev,u=e.strstart+I;let p=c[r+o-1],f=c[r+o];e.prev_length>=e.good_match&&(s>>=2),a>e.lookahead&&(a=e.lookahead);do{if(i=t,c[i+o]===f&&c[i+o-1]===p&&c[i]===c[r]&&c[++i]===c[r+1]){r+=2,i++;do{}while(c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&r<u);if(n=I-(u-r),r=u-I,n>o){if(e.match_start=t,o=n,n>=a)break;p=c[r+o-1],f=c[r+o]}}}while((t=d[t&h])>l&&0!=--s);return o<=e.lookahead?o:e.lookahead},U=e=>{const t=e.w_size;let i,n,s;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-k)&&(e.window.set(e.window.subarray(t,t+t-n),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),N(e),n+=t),0===e.strm.avail_in)break;if(i=W(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=i,e.lookahead+e.insert>=3)for(s=e.strstart-e.insert,e.ins_h=e.window[s],e.ins_h=F(e,e.ins_h,e.window[s+1]);e.insert&&(e.ins_h=F(e,e.ins_h,e.window[s+3-1]),e.prev[s&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=s,s++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<k&&0!==e.strm.avail_in)},q=(e,t)=>{let i,n,r,o=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,a=0,l=e.strm.avail_in;do{if(i=65535,r=e.bi_valid+42>>3,e.strm.avail_out<r)break;if(r=e.strm.avail_out-r,n=e.strstart-e.block_start,i>n+e.strm.avail_in&&(i=n+e.strm.avail_in),i>r&&(i=r),i<o&&(0===i&&t!==f||t===d||i!==n+e.strm.avail_in))break;a=t===f&&i===n+e.strm.avail_in?1:0,s(e,0,0,a),e.pending_buf[e.pending-4]=i,e.pending_buf[e.pending-3]=i>>8,e.pending_buf[e.pending-2]=~i,e.pending_buf[e.pending-1]=~i>>8,H(e.strm),n&&(n>i&&(n=i),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+n),e.strm.next_out),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n,e.block_start+=n,i-=n),i&&(W(e.strm,e.strm.output,e.strm.next_out,i),e.strm.next_out+=i,e.strm.avail_out-=i,e.strm.total_out+=i)}while(0===a);return l-=e.strm.avail_in,l&&(l>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=l&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-l,e.strm.next_in),e.strstart),e.strstart+=l,e.insert+=l>e.w_size-e.insert?e.w_size-e.insert:l),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),a?4:t!==d&&t!==f&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(r=e.window_size-e.strstart,e.strm.avail_in>r&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,r+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),r>e.strm.avail_in&&(r=e.strm.avail_in),r&&(W(e.strm,e.window,e.strstart,r),e.strstart+=r,e.insert+=r>e.w_size-e.insert?e.w_size-e.insert:r),e.high_water<e.strstart&&(e.high_water=e.strstart),r=e.bi_valid+42>>3,r=e.pending_buf_size-r>65535?65535:e.pending_buf_size-r,o=r>e.w_size?e.w_size:r,n=e.strstart-e.block_start,(n>=o||(n||t===f)&&t!==d&&0===e.strm.avail_in&&n<=r)&&(i=n>r?r:n,a=t===f&&0===e.strm.avail_in&&i===n?1:0,s(e,e.block_start,i,a),e.block_start+=i,H(e.strm)),a?3:1)},G=(e,t)=>{let i,n;for(;;){if(e.lookahead<k){if(U(e),e.lookahead<k&&t===d)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=F(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==i&&e.strstart-i<=e.w_size-k&&(e.match_length=$(e,i)),e.match_length>=3)if(n=o(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=F(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=F(e,e.ins_h,e.window[e.strstart+1]);else n=o(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(B(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===f?(B(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(B(e,!1),0===e.strm.avail_out)?1:2},K=(e,t)=>{let i,n,s;for(;;){if(e.lookahead<k){if(U(e),e.lookahead<k&&t===d)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=F(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==i&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-k&&(e.match_length=$(e,i),e.match_length<=5&&(e.strategy===w||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){s=e.strstart+e.lookahead-3,n=o(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=s&&(e.ins_h=F(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,n&&(B(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(n=o(e,0,e.window[e.strstart-1]),n&&B(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=o(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===f?(B(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(B(e,!1),0===e.strm.avail_out)?1:2};function Y(e,t,i,n,s){this.good_length=e,this.max_lazy=t,this.nice_length=i,this.max_chain=n,this.func=s}const X=[new Y(0,0,0,0,q),new Y(4,4,8,4,G),new Y(4,5,16,8,G),new Y(4,6,32,32,G),new Y(4,4,16,16,K),new Y(8,16,32,32,K),new Y(8,16,128,128,K),new Y(8,32,128,256,K),new Y(32,128,258,1024,K),new Y(32,258,258,4096,K)];function Z(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=O,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),P(this.dyn_ltree),P(this.dyn_dtree),P(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),P(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),P(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Q=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==D&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==j&&t.status!==R?1:0},J=e=>{if(Q(e))return L(e,_);e.total_in=e.total_out=0,e.data_type=A;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?D:j,e.adler=2===t.wrap?0:1,t.last_flush=-2,n(t),g},ee=e=>{const t=J(e);var i;return t===g&&((i=e.state).window_size=2*i.w_size,P(i.head),i.max_lazy_match=X[i.level].max_lazy,i.good_match=X[i.level].good_length,i.nice_match=X[i.level].nice_length,i.max_chain_length=X[i.level].max_chain,i.strstart=0,i.block_start=0,i.lookahead=0,i.insert=0,i.match_length=i.prev_length=2,i.match_available=0,i.ins_h=0),t},te=(e,t,i,n,s,r)=>{if(!e)return _;let o=1;if(t===C&&(t=6),n<0?(o=0,n=-n):n>15&&(o=2,n-=16),s<1||s>9||i!==O||n<8||n>15||t<0||t>9||r<0||r>x||8===n&&1!==o)return L(e,_);8===n&&(n=9);const a=new Z;return e.state=a,a.strm=e,a.status=D,a.wrap=o,a.gzhead=null,a.w_bits=n,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=s+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<s+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=3*(a.lit_bufsize-1),a.level=t,a.strategy=r,a.method=i,ee(e)};e.exports.deflateInit=(e,t)=>te(e,t,O,15,8,T),e.exports.deflateInit2=te,e.exports.deflateReset=ee,e.exports.deflateResetKeep=J,e.exports.deflateSetHeader=(e,t)=>Q(e)||2!==e.state.wrap?_:(e.state.gzhead=t,g),e.exports.deflate=(e,t)=>{if(Q(e)||t>m||t<0)return e?L(e,_):_;const i=e.state;if(!e.output||0!==e.avail_in&&!e.input||i.status===R&&t!==f)return L(e,0===e.avail_out?y:_);const n=i.last_flush;if(i.last_flush=t,0!==i.pending){if(H(e),0===e.avail_out)return i.last_flush=-1,g}else if(0===e.avail_in&&M(t)<=M(n)&&t!==f)return L(e,y);if(i.status===R&&0!==e.avail_in)return L(e,y);if(i.status===D&&0===i.wrap&&(i.status=j),i.status===D){let t=O+(i.w_bits-8<<4)<<8,n=-1;if(n=i.strategy>=S||i.level<2?0:i.level<6?1:6===i.level?2:3,t|=n<<6,0!==i.strstart&&(t|=32),t+=31-t%31,V(i,t),0!==i.strstart&&(V(i,e.adler>>>16),V(i,65535&e.adler)),e.adler=1,i.status=j,H(e),0!==i.pending)return i.last_flush=-1,g}if(57===i.status)if(e.adler=0,z(i,31),z(i,139),z(i,8),i.gzhead)z(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),z(i,255&i.gzhead.time),z(i,i.gzhead.time>>8&255),z(i,i.gzhead.time>>16&255),z(i,i.gzhead.time>>24&255),z(i,9===i.level?2:i.strategy>=S||i.level<2?4:0),z(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(z(i,255&i.gzhead.extra.length),z(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=c(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69;else if(z(i,0),z(i,0),z(i,0),z(i,0),z(i,0),z(i,9===i.level?2:i.strategy>=S||i.level<2?4:0),z(i,3),i.status=j,H(e),0!==i.pending)return i.last_flush=-1,g;if(69===i.status){if(i.gzhead.extra){let t=i.pending,n=(65535&i.gzhead.extra.length)-i.gzindex;for(;i.pending+n>i.pending_buf_size;){let s=i.pending_buf_size-i.pending;if(i.pending_buf.set(i.gzhead.extra.subarray(i.gzindex,i.gzindex+s),i.pending),i.pending=i.pending_buf_size,i.gzhead.hcrc&&i.pending>t&&(e.adler=c(e.adler,i.pending_buf,i.pending-t,t)),i.gzindex+=s,H(e),0!==i.pending)return i.last_flush=-1,g;t=0,n-=s}let s=new Uint8Array(i.gzhead.extra);i.pending_buf.set(s.subarray(i.gzindex,i.gzindex+n),i.pending),i.pending+=n,i.gzhead.hcrc&&i.pending>t&&(e.adler=c(e.adler,i.pending_buf,i.pending-t,t)),i.gzindex=0}i.status=73}if(73===i.status){if(i.gzhead.name){let t,n=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>n&&(e.adler=c(e.adler,i.pending_buf,i.pending-n,n)),H(e),0!==i.pending)return i.last_flush=-1,g;n=0}t=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,z(i,t)}while(0!==t);i.gzhead.hcrc&&i.pending>n&&(e.adler=c(e.adler,i.pending_buf,i.pending-n,n)),i.gzindex=0}i.status=91}if(91===i.status){if(i.gzhead.comment){let t,n=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>n&&(e.adler=c(e.adler,i.pending_buf,i.pending-n,n)),H(e),0!==i.pending)return i.last_flush=-1,g;n=0}t=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,z(i,t)}while(0!==t);i.gzhead.hcrc&&i.pending>n&&(e.adler=c(e.adler,i.pending_buf,i.pending-n,n))}i.status=103}if(103===i.status){if(i.gzhead.hcrc){if(i.pending+2>i.pending_buf_size&&(H(e),0!==i.pending))return i.last_flush=-1,g;z(i,255&e.adler),z(i,e.adler>>8&255),e.adler=0}if(i.status=j,H(e),0!==i.pending)return i.last_flush=-1,g}if(0!==e.avail_in||0!==i.lookahead||t!==d&&i.status!==R){let n=0===i.level?q(i,t):i.strategy===S?((e,t)=>{let i;for(;;){if(0===e.lookahead&&(U(e),0===e.lookahead)){if(t===d)return 1;break}if(e.match_length=0,i=o(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(B(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===f?(B(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(B(e,!1),0===e.strm.avail_out)?1:2})(i,t):i.strategy===E?((e,t)=>{let i,n,s,r;const a=e.window;for(;;){if(e.lookahead<=I){if(U(e),e.lookahead<=I&&t===d)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(s=e.strstart-1,n=a[s],n===a[++s]&&n===a[++s]&&n===a[++s])){r=e.strstart+I;do{}while(n===a[++s]&&n===a[++s]&&n===a[++s]&&n===a[++s]&&n===a[++s]&&n===a[++s]&&n===a[++s]&&n===a[++s]&&s<r);e.match_length=I-(r-s),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(i=o(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=o(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(B(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===f?(B(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(B(e,!1),0===e.strm.avail_out)?1:2})(i,t):X[i.level].func(i,t);if(3!==n&&4!==n||(i.status=R),1===n||3===n)return 0===e.avail_out&&(i.last_flush=-1),g;if(2===n&&(t===u?a(i):t!==m&&(s(i,0,0,!1),t===p&&(P(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),H(e),0===e.avail_out))return i.last_flush=-1,g}return t!==f?g:i.wrap<=0?v:(2===i.wrap?(z(i,255&e.adler),z(i,e.adler>>8&255),z(i,e.adler>>16&255),z(i,e.adler>>24&255),z(i,255&e.total_in),z(i,e.total_in>>8&255),z(i,e.total_in>>16&255),z(i,e.total_in>>24&255)):(V(i,e.adler>>>16),V(i,65535&e.adler)),H(e),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?g:v)},e.exports.deflateEnd=e=>{if(Q(e))return _;const t=e.state.status;return e.state=null,t===j?L(e,b):g},e.exports.deflateSetDictionary=(e,t)=>{let i=t.length;if(Q(e))return _;const n=e.state,s=n.wrap;if(2===s||1===s&&n.status!==D||n.lookahead)return _;if(1===s&&(e.adler=l(e.adler,t,i,0)),n.wrap=0,i>=n.w_size){0===s&&(P(n.head),n.strstart=0,n.block_start=0,n.insert=0);let e=new Uint8Array(n.w_size);e.set(t.subarray(i-n.w_size,i),0),t=e,i=n.w_size}const r=e.avail_in,o=e.next_in,a=e.input;for(e.avail_in=i,e.next_in=0,e.input=t,U(n);n.lookahead>=3;){let e=n.strstart,t=n.lookahead-2;do{n.ins_h=F(n,n.ins_h,n.window[e+3-1]),n.prev[e&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=e,e++}while(--t);n.strstart=e,n.lookahead=2,U(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=o,e.input=a,e.avail_in=r,n.wrap=s,g},e.exports.deflateInfo="pako deflate (from Nodeca project)"},414:e=>{"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},293:e=>{"use strict";const t=16209;e.exports=function(e,i){let n,s,r,o,a,l,c,h,d,u,p,f,m,g,v,_,b,y,C,w,S,E,x,T;const A=e.state;n=e.next_in,x=e.input,s=n+(e.avail_in-5),r=e.next_out,T=e.output,o=r-(i-e.avail_out),a=r+(e.avail_out-257),l=A.dmax,c=A.wsize,h=A.whave,d=A.wnext,u=A.window,p=A.hold,f=A.bits,m=A.lencode,g=A.distcode,v=(1<<A.lenbits)-1,_=(1<<A.distbits)-1;e:do{f<15&&(p+=x[n++]<<f,f+=8,p+=x[n++]<<f,f+=8),b=m[p&v];t:for(;;){if(y=b>>>24,p>>>=y,f-=y,y=b>>>16&255,0===y)T[r++]=65535&b;else{if(!(16&y)){if(64&y){if(32&y){A.mode=16191;break e}e.msg="invalid literal/length code",A.mode=t;break e}b=m[(65535&b)+(p&(1<<y)-1)];continue t}for(C=65535&b,y&=15,y&&(f<y&&(p+=x[n++]<<f,f+=8),C+=p&(1<<y)-1,p>>>=y,f-=y),f<15&&(p+=x[n++]<<f,f+=8,p+=x[n++]<<f,f+=8),b=g[p&_];;){if(y=b>>>24,p>>>=y,f-=y,y=b>>>16&255,16&y){if(w=65535&b,y&=15,f<y&&(p+=x[n++]<<f,f+=8,f<y&&(p+=x[n++]<<f,f+=8)),w+=p&(1<<y)-1,w>l){e.msg="invalid distance too far back",A.mode=t;break e}if(p>>>=y,f-=y,y=r-o,w>y){if(y=w-y,y>h&&A.sane){e.msg="invalid distance too far back",A.mode=t;break e}if(S=0,E=u,0===d){if(S+=c-y,y<C){C-=y;do{T[r++]=u[S++]}while(--y);S=r-w,E=T}}else if(d<y){if(S+=c+d-y,y-=d,y<C){C-=y;do{T[r++]=u[S++]}while(--y);if(S=0,d<C){y=d,C-=y;do{T[r++]=u[S++]}while(--y);S=r-w,E=T}}}else if(S+=d-y,y<C){C-=y;do{T[r++]=u[S++]}while(--y);S=r-w,E=T}for(;C>2;)T[r++]=E[S++],T[r++]=E[S++],T[r++]=E[S++],C-=3;C&&(T[r++]=E[S++],C>1&&(T[r++]=E[S++]))}else{S=r-w;do{T[r++]=T[S++],T[r++]=T[S++],T[r++]=T[S++],C-=3}while(C>2);C&&(T[r++]=T[S++],C>1&&(T[r++]=T[S++]))}break}if(64&y){e.msg="invalid distance code",A.mode=t;break e}b=g[(65535&b)+(p&(1<<y)-1)]}}break}}while(n<s&&r<a);C=f>>3,n-=C,f-=C<<3,p&=(1<<f)-1,e.next_in=n,e.next_out=r,e.avail_in=n<s?s-n+5:5-(n-s),e.avail_out=r<a?a-r+257:257-(r-a),A.hold=p,A.bits=f}},447:(e,t,i)=>{"use strict";const n=i(269),s=i(823),r=i(293),o=i(998),{Z_FINISH:a,Z_BLOCK:l,Z_TREES:c,Z_OK:h,Z_STREAM_END:d,Z_NEED_DICT:u,Z_STREAM_ERROR:p,Z_DATA_ERROR:f,Z_MEM_ERROR:m,Z_BUF_ERROR:g,Z_DEFLATED:v}=i(681),_=16180,b=16190,y=16191,C=16192,w=16194,S=16199,E=16200,x=16206,T=16209,A=16210,O=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function I(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const k=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<_||t.mode>16211?1:0},D=e=>{if(k(e))return p;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=_,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,h},j=e=>{if(k(e))return p;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,D(e)},R=(e,t)=>{let i;if(k(e))return p;const n=e.state;return t<0?(i=0,t=-t):(i=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?p:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=i,n.wbits=t,j(e))},L=(e,t)=>{if(!e)return p;const i=new I;e.state=i,i.strm=e,i.window=null,i.mode=_;const n=R(e,t);return n!==h&&(e.state=null),n};let M,P,N=!0;const F=e=>{if(N){M=new Int32Array(512),P=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(o(1,e.lens,0,288,M,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;o(2,e.lens,0,32,P,0,e.work,{bits:5}),N=!1}e.lencode=M,e.lenbits=9,e.distcode=P,e.distbits=5},H=(e,t,i,n)=>{let s;const r=e.state;return null===r.window&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new Uint8Array(r.wsize)),n>=r.wsize?(r.window.set(t.subarray(i-r.wsize,i),0),r.wnext=0,r.whave=r.wsize):(s=r.wsize-r.wnext,s>n&&(s=n),r.window.set(t.subarray(i-n,i-n+s),r.wnext),(n-=s)?(r.window.set(t.subarray(i-n,i),0),r.wnext=n,r.whave=r.wsize):(r.wnext+=s,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=s))),0};e.exports.inflateReset=j,e.exports.inflateReset2=R,e.exports.inflateResetKeep=D,e.exports.inflateInit=e=>L(e,15),e.exports.inflateInit2=L,e.exports.inflate=(e,t)=>{let i,I,D,j,R,L,M,P,N,B,z,V,W,$,U,q,G,K,Y,X,Z,Q,J=0;const ee=new Uint8Array(4);let te,ie;const ne=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(k(e)||!e.output||!e.input&&0!==e.avail_in)return p;i=e.state,i.mode===y&&(i.mode=C),R=e.next_out,D=e.output,M=e.avail_out,j=e.next_in,I=e.input,L=e.avail_in,P=i.hold,N=i.bits,B=L,z=M,Q=h;e:for(;;)switch(i.mode){case _:if(0===i.wrap){i.mode=C;break}for(;N<16;){if(0===L)break e;L--,P+=I[j++]<<N,N+=8}if(2&i.wrap&&35615===P){0===i.wbits&&(i.wbits=15),i.check=0,ee[0]=255&P,ee[1]=P>>>8&255,i.check=s(i.check,ee,2,0),P=0,N=0,i.mode=16181;break}if(i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&P)<<8)+(P>>8))%31){e.msg="incorrect header check",i.mode=T;break}if((15&P)!==v){e.msg="unknown compression method",i.mode=T;break}if(P>>>=4,N-=4,Z=8+(15&P),0===i.wbits&&(i.wbits=Z),Z>15||Z>i.wbits){e.msg="invalid window size",i.mode=T;break}i.dmax=1<<i.wbits,i.flags=0,e.adler=i.check=1,i.mode=512&P?16189:y,P=0,N=0;break;case 16181:for(;N<16;){if(0===L)break e;L--,P+=I[j++]<<N,N+=8}if(i.flags=P,(255&i.flags)!==v){e.msg="unknown compression method",i.mode=T;break}if(57344&i.flags){e.msg="unknown header flags set",i.mode=T;break}i.head&&(i.head.text=P>>8&1),512&i.flags&&4&i.wrap&&(ee[0]=255&P,ee[1]=P>>>8&255,i.check=s(i.check,ee,2,0)),P=0,N=0,i.mode=16182;case 16182:for(;N<32;){if(0===L)break e;L--,P+=I[j++]<<N,N+=8}i.head&&(i.head.time=P),512&i.flags&&4&i.wrap&&(ee[0]=255&P,ee[1]=P>>>8&255,ee[2]=P>>>16&255,ee[3]=P>>>24&255,i.check=s(i.check,ee,4,0)),P=0,N=0,i.mode=16183;case 16183:for(;N<16;){if(0===L)break e;L--,P+=I[j++]<<N,N+=8}i.head&&(i.head.xflags=255&P,i.head.os=P>>8),512&i.flags&&4&i.wrap&&(ee[0]=255&P,ee[1]=P>>>8&255,i.check=s(i.check,ee,2,0)),P=0,N=0,i.mode=16184;case 16184:if(1024&i.flags){for(;N<16;){if(0===L)break e;L--,P+=I[j++]<<N,N+=8}i.length=P,i.head&&(i.head.extra_len=P),512&i.flags&&4&i.wrap&&(ee[0]=255&P,ee[1]=P>>>8&255,i.check=s(i.check,ee,2,0)),P=0,N=0}else i.head&&(i.head.extra=null);i.mode=16185;case 16185:if(1024&i.flags&&(V=i.length,V>L&&(V=L),V&&(i.head&&(Z=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(I.subarray(j,j+V),Z)),512&i.flags&&4&i.wrap&&(i.check=s(i.check,I,V,j)),L-=V,j+=V,i.length-=V),i.length))break e;i.length=0,i.mode=16186;case 16186:if(2048&i.flags){if(0===L)break e;V=0;do{Z=I[j+V++],i.head&&Z&&i.length<65536&&(i.head.name+=String.fromCharCode(Z))}while(Z&&V<L);if(512&i.flags&&4&i.wrap&&(i.check=s(i.check,I,V,j)),L-=V,j+=V,Z)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=16187;case 16187:if(4096&i.flags){if(0===L)break e;V=0;do{Z=I[j+V++],i.head&&Z&&i.length<65536&&(i.head.comment+=String.fromCharCode(Z))}while(Z&&V<L);if(512&i.flags&&4&i.wrap&&(i.check=s(i.check,I,V,j)),L-=V,j+=V,Z)break e}else i.head&&(i.head.comment=null);i.mode=16188;case 16188:if(512&i.flags){for(;N<16;){if(0===L)break e;L--,P+=I[j++]<<N,N+=8}if(4&i.wrap&&P!==(65535&i.check)){e.msg="header crc mismatch",i.mode=T;break}P=0,N=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=y;break;case 16189:for(;N<32;){if(0===L)break e;L--,P+=I[j++]<<N,N+=8}e.adler=i.check=O(P),P=0,N=0,i.mode=b;case b:if(0===i.havedict)return e.next_out=R,e.avail_out=M,e.next_in=j,e.avail_in=L,i.hold=P,i.bits=N,u;e.adler=i.check=1,i.mode=y;case y:if(t===l||t===c)break e;case C:if(i.last){P>>>=7&N,N-=7&N,i.mode=x;break}for(;N<3;){if(0===L)break e;L--,P+=I[j++]<<N,N+=8}switch(i.last=1&P,P>>>=1,N-=1,3&P){case 0:i.mode=16193;break;case 1:if(F(i),i.mode=S,t===c){P>>>=2,N-=2;break e}break;case 2:i.mode=16196;break;case 3:e.msg="invalid block type",i.mode=T}P>>>=2,N-=2;break;case 16193:for(P>>>=7&N,N-=7&N;N<32;){if(0===L)break e;L--,P+=I[j++]<<N,N+=8}if((65535&P)!=(P>>>16^65535)){e.msg="invalid stored block lengths",i.mode=T;break}if(i.length=65535&P,P=0,N=0,i.mode=w,t===c)break e;case w:i.mode=16195;case 16195:if(V=i.length,V){if(V>L&&(V=L),V>M&&(V=M),0===V)break e;D.set(I.subarray(j,j+V),R),L-=V,j+=V,M-=V,R+=V,i.length-=V;break}i.mode=y;break;case 16196:for(;N<14;){if(0===L)break e;L--,P+=I[j++]<<N,N+=8}if(i.nlen=257+(31&P),P>>>=5,N-=5,i.ndist=1+(31&P),P>>>=5,N-=5,i.ncode=4+(15&P),P>>>=4,N-=4,i.nlen>286||i.ndist>30){e.msg="too many length or distance symbols",i.mode=T;break}i.have=0,i.mode=16197;case 16197:for(;i.have<i.ncode;){for(;N<3;){if(0===L)break e;L--,P+=I[j++]<<N,N+=8}i.lens[ne[i.have++]]=7&P,P>>>=3,N-=3}for(;i.have<19;)i.lens[ne[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,te={bits:i.lenbits},Q=o(0,i.lens,0,19,i.lencode,0,i.work,te),i.lenbits=te.bits,Q){e.msg="invalid code lengths set",i.mode=T;break}i.have=0,i.mode=16198;case 16198:for(;i.have<i.nlen+i.ndist;){for(;J=i.lencode[P&(1<<i.lenbits)-1],U=J>>>24,q=J>>>16&255,G=65535&J,!(U<=N);){if(0===L)break e;L--,P+=I[j++]<<N,N+=8}if(G<16)P>>>=U,N-=U,i.lens[i.have++]=G;else{if(16===G){for(ie=U+2;N<ie;){if(0===L)break e;L--,P+=I[j++]<<N,N+=8}if(P>>>=U,N-=U,0===i.have){e.msg="invalid bit length repeat",i.mode=T;break}Z=i.lens[i.have-1],V=3+(3&P),P>>>=2,N-=2}else if(17===G){for(ie=U+3;N<ie;){if(0===L)break e;L--,P+=I[j++]<<N,N+=8}P>>>=U,N-=U,Z=0,V=3+(7&P),P>>>=3,N-=3}else{for(ie=U+7;N<ie;){if(0===L)break e;L--,P+=I[j++]<<N,N+=8}P>>>=U,N-=U,Z=0,V=11+(127&P),P>>>=7,N-=7}if(i.have+V>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=T;break}for(;V--;)i.lens[i.have++]=Z}}if(i.mode===T)break;if(0===i.lens[256]){e.msg="invalid code -- missing end-of-block",i.mode=T;break}if(i.lenbits=9,te={bits:i.lenbits},Q=o(1,i.lens,0,i.nlen,i.lencode,0,i.work,te),i.lenbits=te.bits,Q){e.msg="invalid literal/lengths set",i.mode=T;break}if(i.distbits=6,i.distcode=i.distdyn,te={bits:i.distbits},Q=o(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,te),i.distbits=te.bits,Q){e.msg="invalid distances set",i.mode=T;break}if(i.mode=S,t===c)break e;case S:i.mode=E;case E:if(L>=6&&M>=258){e.next_out=R,e.avail_out=M,e.next_in=j,e.avail_in=L,i.hold=P,i.bits=N,r(e,z),R=e.next_out,D=e.output,M=e.avail_out,j=e.next_in,I=e.input,L=e.avail_in,P=i.hold,N=i.bits,i.mode===y&&(i.back=-1);break}for(i.back=0;J=i.lencode[P&(1<<i.lenbits)-1],U=J>>>24,q=J>>>16&255,G=65535&J,!(U<=N);){if(0===L)break e;L--,P+=I[j++]<<N,N+=8}if(q&&!(240&q)){for(K=U,Y=q,X=G;J=i.lencode[X+((P&(1<<K+Y)-1)>>K)],U=J>>>24,q=J>>>16&255,G=65535&J,!(K+U<=N);){if(0===L)break e;L--,P+=I[j++]<<N,N+=8}P>>>=K,N-=K,i.back+=K}if(P>>>=U,N-=U,i.back+=U,i.length=G,0===q){i.mode=16205;break}if(32&q){i.back=-1,i.mode=y;break}if(64&q){e.msg="invalid literal/length code",i.mode=T;break}i.extra=15&q,i.mode=16201;case 16201:if(i.extra){for(ie=i.extra;N<ie;){if(0===L)break e;L--,P+=I[j++]<<N,N+=8}i.length+=P&(1<<i.extra)-1,P>>>=i.extra,N-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=16202;case 16202:for(;J=i.distcode[P&(1<<i.distbits)-1],U=J>>>24,q=J>>>16&255,G=65535&J,!(U<=N);){if(0===L)break e;L--,P+=I[j++]<<N,N+=8}if(!(240&q)){for(K=U,Y=q,X=G;J=i.distcode[X+((P&(1<<K+Y)-1)>>K)],U=J>>>24,q=J>>>16&255,G=65535&J,!(K+U<=N);){if(0===L)break e;L--,P+=I[j++]<<N,N+=8}P>>>=K,N-=K,i.back+=K}if(P>>>=U,N-=U,i.back+=U,64&q){e.msg="invalid distance code",i.mode=T;break}i.offset=G,i.extra=15&q,i.mode=16203;case 16203:if(i.extra){for(ie=i.extra;N<ie;){if(0===L)break e;L--,P+=I[j++]<<N,N+=8}i.offset+=P&(1<<i.extra)-1,P>>>=i.extra,N-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=T;break}i.mode=16204;case 16204:if(0===M)break e;if(V=z-M,i.offset>V){if(V=i.offset-V,V>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=T;break}V>i.wnext?(V-=i.wnext,W=i.wsize-V):W=i.wnext-V,V>i.length&&(V=i.length),$=i.window}else $=D,W=R-i.offset,V=i.length;V>M&&(V=M),M-=V,i.length-=V;do{D[R++]=$[W++]}while(--V);0===i.length&&(i.mode=E);break;case 16205:if(0===M)break e;D[R++]=i.length,M--,i.mode=E;break;case x:if(i.wrap){for(;N<32;){if(0===L)break e;L--,P|=I[j++]<<N,N+=8}if(z-=M,e.total_out+=z,i.total+=z,4&i.wrap&&z&&(e.adler=i.check=i.flags?s(i.check,D,z,R-z):n(i.check,D,z,R-z)),z=M,4&i.wrap&&(i.flags?P:O(P))!==i.check){e.msg="incorrect data check",i.mode=T;break}P=0,N=0}i.mode=16207;case 16207:if(i.wrap&&i.flags){for(;N<32;){if(0===L)break e;L--,P+=I[j++]<<N,N+=8}if(4&i.wrap&&P!==(4294967295&i.total)){e.msg="incorrect length check",i.mode=T;break}P=0,N=0}i.mode=16208;case 16208:Q=d;break e;case T:Q=f;break e;case A:return m;default:return p}return e.next_out=R,e.avail_out=M,e.next_in=j,e.avail_in=L,i.hold=P,i.bits=N,(i.wsize||z!==e.avail_out&&i.mode<T&&(i.mode<x||t!==a))&&H(e,e.output,e.next_out,z-e.avail_out)?(i.mode=A,m):(B-=e.avail_in,z-=e.avail_out,e.total_in+=B,e.total_out+=z,i.total+=z,4&i.wrap&&z&&(e.adler=i.check=i.flags?s(i.check,D,z,e.next_out-z):n(i.check,D,z,e.next_out-z)),e.data_type=i.bits+(i.last?64:0)+(i.mode===y?128:0)+(i.mode===S||i.mode===w?256:0),(0===B&&0===z||t===a)&&Q===h&&(Q=g),Q)},e.exports.inflateEnd=e=>{if(k(e))return p;let t=e.state;return t.window&&(t.window=null),e.state=null,h},e.exports.inflateGetHeader=(e,t)=>{if(k(e))return p;const i=e.state;return 2&i.wrap?(i.head=t,t.done=!1,h):p},e.exports.inflateSetDictionary=(e,t)=>{const i=t.length;let s,r,o;return k(e)?p:(s=e.state,0!==s.wrap&&s.mode!==b?p:s.mode===b&&(r=1,r=n(r,t,i,0),r!==s.check)?f:(o=H(e,t,i,i),o?(s.mode=A,m):(s.havedict=1,h)))},e.exports.inflateInfo="pako inflate (from Nodeca project)"},998:e=>{"use strict";const t=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),i=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),n=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),s=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);e.exports=(e,r,o,a,l,c,h,d)=>{const u=d.bits;let p,f,m,g,v,_,b=0,y=0,C=0,w=0,S=0,E=0,x=0,T=0,A=0,O=0,I=null;const k=new Uint16Array(16),D=new Uint16Array(16);let j,R,L,M=null;for(b=0;b<=15;b++)k[b]=0;for(y=0;y<a;y++)k[r[o+y]]++;for(S=u,w=15;w>=1&&0===k[w];w--);if(S>w&&(S=w),0===w)return l[c++]=20971520,l[c++]=20971520,d.bits=1,0;for(C=1;C<w&&0===k[C];C++);for(S<C&&(S=C),T=1,b=1;b<=15;b++)if(T<<=1,T-=k[b],T<0)return-1;if(T>0&&(0===e||1!==w))return-1;for(D[1]=0,b=1;b<15;b++)D[b+1]=D[b]+k[b];for(y=0;y<a;y++)0!==r[o+y]&&(h[D[r[o+y]]++]=y);if(0===e?(I=M=h,_=20):1===e?(I=t,M=i,_=257):(I=n,M=s,_=0),O=0,y=0,b=C,v=c,E=S,x=0,m=-1,A=1<<S,g=A-1,1===e&&A>852||2===e&&A>592)return 1;for(;;){j=b-x,h[y]+1<_?(R=0,L=h[y]):h[y]>=_?(R=M[h[y]-_],L=I[h[y]-_]):(R=96,L=0),p=1<<b-x,f=1<<E,C=f;do{f-=p,l[v+(O>>x)+f]=j<<24|R<<16|L}while(0!==f);for(p=1<<b-1;O&p;)p>>=1;if(0!==p?(O&=p-1,O+=p):O=0,y++,0==--k[b]){if(b===w)break;b=r[o+h[y]]}if(b>S&&(O&g)!==m){for(0===x&&(x=S),v+=C,E=b-x,T=1<<E;E+x<w&&(T-=k[E+x],!(T<=0));)E++,T<<=1;if(A+=1<<E,1===e&&A>852||2===e&&A>592)return 1;m=O&g,l[m]=S<<24|E<<16|v-c}}return 0!==O&&(l[v+O]=b-x<<24|64<<16),d.bits=S,0}},674:e=>{"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},665:e=>{"use strict";function t(e){let t=e.length;for(;--t>=0;)e[t]=0}const i=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),n=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),s=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),r=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),o=new Array(576);t(o);const a=new Array(60);t(a);const l=new Array(512);t(l);const c=new Array(256);t(c);const h=new Array(29);t(h);const d=new Array(30);function u(e,t,i,n,s){this.static_tree=e,this.extra_bits=t,this.extra_base=i,this.elems=n,this.max_length=s,this.has_stree=e&&e.length}let p,f,m;function g(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}t(d);const v=e=>e<256?l[e]:l[256+(e>>>7)],_=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},b=(e,t,i)=>{e.bi_valid>16-i?(e.bi_buf|=t<<e.bi_valid&65535,_(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=i-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=i)},y=(e,t,i)=>{b(e,i[2*t],i[2*t+1])},C=(e,t)=>{let i=0;do{i|=1&e,e>>>=1,i<<=1}while(--t>0);return i>>>1},w=(e,t,i)=>{const n=new Array(16);let s,r,o=0;for(s=1;s<=15;s++)o=o+i[s-1]<<1,n[s]=o;for(r=0;r<=t;r++){let t=e[2*r+1];0!==t&&(e[2*r]=C(n[t]++,t))}},S=e=>{let t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},E=e=>{e.bi_valid>8?_(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},x=(e,t,i,n)=>{const s=2*t,r=2*i;return e[s]<e[r]||e[s]===e[r]&&n[t]<=n[i]},T=(e,t,i)=>{const n=e.heap[i];let s=i<<1;for(;s<=e.heap_len&&(s<e.heap_len&&x(t,e.heap[s+1],e.heap[s],e.depth)&&s++,!x(t,n,e.heap[s],e.depth));)e.heap[i]=e.heap[s],i=s,s<<=1;e.heap[i]=n},A=(e,t,s)=>{let r,o,a,l,u=0;if(0!==e.sym_next)do{r=255&e.pending_buf[e.sym_buf+u++],r+=(255&e.pending_buf[e.sym_buf+u++])<<8,o=e.pending_buf[e.sym_buf+u++],0===r?y(e,o,t):(a=c[o],y(e,a+256+1,t),l=i[a],0!==l&&(o-=h[a],b(e,o,l)),r--,a=v(r),y(e,a,s),l=n[a],0!==l&&(r-=d[a],b(e,r,l)))}while(u<e.sym_next);y(e,256,t)},O=(e,t)=>{const i=t.dyn_tree,n=t.stat_desc.static_tree,s=t.stat_desc.has_stree,r=t.stat_desc.elems;let o,a,l,c=-1;for(e.heap_len=0,e.heap_max=573,o=0;o<r;o++)0!==i[2*o]?(e.heap[++e.heap_len]=c=o,e.depth[o]=0):i[2*o+1]=0;for(;e.heap_len<2;)l=e.heap[++e.heap_len]=c<2?++c:0,i[2*l]=1,e.depth[l]=0,e.opt_len--,s&&(e.static_len-=n[2*l+1]);for(t.max_code=c,o=e.heap_len>>1;o>=1;o--)T(e,i,o);l=r;do{o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],T(e,i,1),a=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=a,i[2*l]=i[2*o]+i[2*a],e.depth[l]=(e.depth[o]>=e.depth[a]?e.depth[o]:e.depth[a])+1,i[2*o+1]=i[2*a+1]=l,e.heap[1]=l++,T(e,i,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const i=t.dyn_tree,n=t.max_code,s=t.stat_desc.static_tree,r=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,a=t.stat_desc.extra_base,l=t.stat_desc.max_length;let c,h,d,u,p,f,m=0;for(u=0;u<=15;u++)e.bl_count[u]=0;for(i[2*e.heap[e.heap_max]+1]=0,c=e.heap_max+1;c<573;c++)h=e.heap[c],u=i[2*i[2*h+1]+1]+1,u>l&&(u=l,m++),i[2*h+1]=u,h>n||(e.bl_count[u]++,p=0,h>=a&&(p=o[h-a]),f=i[2*h],e.opt_len+=f*(u+p),r&&(e.static_len+=f*(s[2*h+1]+p)));if(0!==m){do{for(u=l-1;0===e.bl_count[u];)u--;e.bl_count[u]--,e.bl_count[u+1]+=2,e.bl_count[l]--,m-=2}while(m>0);for(u=l;0!==u;u--)for(h=e.bl_count[u];0!==h;)d=e.heap[--c],d>n||(i[2*d+1]!==u&&(e.opt_len+=(u-i[2*d+1])*i[2*d],i[2*d+1]=u),h--)}})(e,t),w(i,c,e.bl_count)},I=(e,t,i)=>{let n,s,r=-1,o=t[1],a=0,l=7,c=4;for(0===o&&(l=138,c=3),t[2*(i+1)+1]=65535,n=0;n<=i;n++)s=o,o=t[2*(n+1)+1],++a<l&&s===o||(a<c?e.bl_tree[2*s]+=a:0!==s?(s!==r&&e.bl_tree[2*s]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=0,r=s,0===o?(l=138,c=3):s===o?(l=6,c=3):(l=7,c=4))},k=(e,t,i)=>{let n,s,r=-1,o=t[1],a=0,l=7,c=4;for(0===o&&(l=138,c=3),n=0;n<=i;n++)if(s=o,o=t[2*(n+1)+1],!(++a<l&&s===o)){if(a<c)do{y(e,s,e.bl_tree)}while(0!=--a);else 0!==s?(s!==r&&(y(e,s,e.bl_tree),a--),y(e,16,e.bl_tree),b(e,a-3,2)):a<=10?(y(e,17,e.bl_tree),b(e,a-3,3)):(y(e,18,e.bl_tree),b(e,a-11,7));a=0,r=s,0===o?(l=138,c=3):s===o?(l=6,c=3):(l=7,c=4)}};let D=!1;const j=(e,t,i,n)=>{b(e,0+(n?1:0),3),E(e),_(e,i),_(e,~i),i&&e.pending_buf.set(e.window.subarray(t,t+i),e.pending),e.pending+=i};e.exports._tr_init=e=>{D||((()=>{let e,t,r,g,v;const _=new Array(16);for(r=0,g=0;g<28;g++)for(h[g]=r,e=0;e<1<<i[g];e++)c[r++]=g;for(c[r-1]=g,v=0,g=0;g<16;g++)for(d[g]=v,e=0;e<1<<n[g];e++)l[v++]=g;for(v>>=7;g<30;g++)for(d[g]=v<<7,e=0;e<1<<n[g]-7;e++)l[256+v++]=g;for(t=0;t<=15;t++)_[t]=0;for(e=0;e<=143;)o[2*e+1]=8,e++,_[8]++;for(;e<=255;)o[2*e+1]=9,e++,_[9]++;for(;e<=279;)o[2*e+1]=7,e++,_[7]++;for(;e<=287;)o[2*e+1]=8,e++,_[8]++;for(w(o,287,_),e=0;e<30;e++)a[2*e+1]=5,a[2*e]=C(e,5);p=new u(o,i,257,286,15),f=new u(a,n,0,30,15),m=new u(new Array(0),s,0,19,7)})(),D=!0),e.l_desc=new g(e.dyn_ltree,p),e.d_desc=new g(e.dyn_dtree,f),e.bl_desc=new g(e.bl_tree,m),e.bi_buf=0,e.bi_valid=0,S(e)},e.exports._tr_stored_block=j,e.exports._tr_flush_block=(e,t,i,n)=>{let s,l,c=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,i=4093624447;for(t=0;t<=31;t++,i>>>=1)if(1&i&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),O(e,e.l_desc),O(e,e.d_desc),c=(e=>{let t;for(I(e,e.dyn_ltree,e.l_desc.max_code),I(e,e.dyn_dtree,e.d_desc.max_code),O(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*r[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),s=e.opt_len+3+7>>>3,l=e.static_len+3+7>>>3,l<=s&&(s=l)):s=l=i+5,i+4<=s&&-1!==t?j(e,t,i,n):4===e.strategy||l===s?(b(e,2+(n?1:0),3),A(e,o,a)):(b(e,4+(n?1:0),3),((e,t,i,n)=>{let s;for(b(e,t-257,5),b(e,i-1,5),b(e,n-4,4),s=0;s<n;s++)b(e,e.bl_tree[2*r[s]+1],3);k(e,e.dyn_ltree,t-1),k(e,e.dyn_dtree,i-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,c+1),A(e,e.dyn_ltree,e.dyn_dtree)),S(e),n&&E(e)},e.exports._tr_tally=(e,t,i)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=i,0===t?e.dyn_ltree[2*i]++:(e.matches++,t--,e.dyn_ltree[2*(c[i]+256+1)]++,e.dyn_dtree[2*v(t)]++),e.sym_next===e.sym_end),e.exports._tr_align=e=>{b(e,2,3),y(e,256,o),(e=>{16===e.bi_valid?(_(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}},442:e=>{"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var i=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(i.exports,i,i.exports,__webpack_require__),i.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var i in t)__webpack_require__.o(t,i)&&!__webpack_require__.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};(()=>{"use strict";var e={};__webpack_require__.r(e),__webpack_require__.d(e,{BackendUtilityService:()=>d});var t={};__webpack_require__.r(t),__webpack_require__.d(t,{collectionObserver:()=>u,propertyObserver:()=>p});var i={};__webpack_require__.r(i),__webpack_require__.d(i,{CaseType:()=>g,DelimiterType:()=>v,EmitterType:()=>l,ExtensionName:()=>_,FieldType:()=>b,FileType:()=>y,FilterMultiplePassType:()=>C,GridStateType:()=>w,OperatorType:()=>S,SortDirection:()=>E,SortDirectionNumber:()=>x,ToggleStateChangeType:()=>T});var n={};__webpack_require__.r(n),__webpack_require__.d(n,{CancelledException:()=>A,addTreeLevelAndAggregatorsByMutation:()=>D,addTreeLevelByMutation:()=>k,cancellablePromise:()=>O,castObservableToPromise:()=>I,decimalFormatted:()=>P,findItemInTreeStructure:()=>M,findOrDefault:()=>K,flattenToParentChildArray:()=>j,formatNumber:()=>N,getCellValueFromQueryFieldGetter:()=>F,getColumnFieldType:()=>z,getDescendantProperty:()=>H,getTranslationPrefix:()=>B,getTreeDataOptionPropName:()=>R,isColumnDateType:()=>V,mapOperatorByFieldType:()=>U,mapOperatorToShorthandDesignation:()=>$,mapOperatorType:()=>W,objectWithoutKey:()=>q,thousandSeparatorFormatted:()=>G,unflattenParentChildArrayToTree:()=>L,unsubscribeAll:()=>Y});var s={};__webpack_require__.r(s),__webpack_require__.d(s,{addToArrayWhenNotExists:()=>we,addWhiteSpaces:()=>Se,arrayRemoveItemByIndex:()=>Ee,calculateAvailableSpace:()=>X,classNameToList:()=>Q,createDomElement:()=>Z,deepCopy:()=>xe,deepMerge:()=>Te,destroyAllElementProps:()=>J,emptyElement:()=>ee,emptyObject:()=>Ae,extend:()=>Ce,findFirstAttribute:()=>oe,findWidthOrDefault:()=>ae,getFunctionDetails:()=>Oe,getHtmlStringOutput:()=>te,getInnerSize:()=>se,getOffset:()=>ne,getOffsetRelativeToParent:()=>ie,getStyleProp:()=>re,htmlEncode:()=>le,htmlEncodeWithPadding:()=>he,htmlEntityDecode:()=>ce,insertAfterElement:()=>de,isDefined:()=>ke,isDefinedNumber:()=>De,isEmptyObject:()=>Ie,isNumber:()=>Me,isObject:()=>je,isObjectEmpty:()=>Pe,isPrimitiveOrHTML:()=>Le,isPrimitiveValue:()=>Re,parseBoolean:()=>Ne,removeAccentFromText:()=>Fe,setDeepValue:()=>He,stripTags:()=>Qe,titleCase:()=>Be,toCamelCase:()=>ze,toKebabCase:()=>Ve,toSentenceCase:()=>We,toSnakeCase:()=>$e,uniqueArray:()=>Ue,uniqueObjectArray:()=>qe,windowScrollPosition:()=>ue});var r={};__webpack_require__.r(r),__webpack_require__.d(r,{sortByFieldType:()=>Lt});var o={};__webpack_require__.r(o),__webpack_require__.d(o,{afterMain:()=>dl,afterRead:()=>ll,afterWrite:()=>fl,applyStyles:()=>Cl,arrow:()=>zl,auto:()=>Xa,basePlacements:()=>Za,beforeMain:()=>cl,beforeRead:()=>ol,beforeWrite:()=>ul,bottom:()=>Ga,clippingParents:()=>el,computeStyles:()=>Ul,createPopper:()=>yc,createPopperBase:()=>bc,createPopperLite:()=>Cc,detectOverflow:()=>oc,end:()=>Ja,eventListeners:()=>Gl,flip:()=>ac,hide:()=>hc,left:()=>Ya,main:()=>hl,modifierPhases:()=>ml,offset:()=>dc,placements:()=>rl,popper:()=>il,popperGenerator:()=>_c,popperOffsets:()=>uc,preventOverflow:()=>pc,read:()=>al,reference:()=>nl,right:()=>Ka,start:()=>Qa,top:()=>qa,variationPlacements:()=>sl,viewport:()=>tl,write:()=>pl});var a={};__webpack_require__.r(a),__webpack_require__.d(a,{Alert:()=>mh,Button:()=>vh,Carousel:()=>Qh,Collapse:()=>ud,Dropdown:()=>Nd,Modal:()=>_u,Offcanvas:()=>Pu,Popover:()=>lp,ScrollSpy:()=>bp,Tab:()=>Hp,Toast:()=>ef,Tooltip:()=>np});var l,c=__webpack_require__(856),h=__webpack_require__(616);!function(e){e.local="local",e.remote="remote"}(l||(l={}));class d{constructor(e){this.rxjs=e,this._infiniteScrollBottomHit=!1}addRxJsResource(e){this.rxjs=e}executeBackendProcessesCallback(e,t,i,n){const s=new Date;t&&i.service.postProcess&&i.service.postProcess(t),t&&i?.internalPostProcess&&i.internalPostProcess(t),void 0!==i.postProcess&&(t instanceof Object&&(t.metrics={startTime:e,endTime:s,executionTime:s.valueOf()-e.valueOf(),itemCount:n,totalItemCount:n},i.service.options?.infiniteScroll&&(t.infiniteScrollBottomHit=this._infiniteScrollBottomHit,delete t.itemCount)),i.postProcess(t),this.setInfiniteScrollBottomHit(!1))}onBackendError(e,t){if("function"!=typeof t?.onError)throw e;t.onError(e)}executeBackendCallback(e,t,i,n,s,r){if(e){i&&!i.clearFilterTriggered&&!i.clearSortTriggered&&r?.emitActionChangedCallback&&r.emitActionChangedCallback.call(this,l.remote);const o=e.process(t);if(o instanceof Promise&&o.then)o.then((t=>{this.executeBackendProcessesCallback(n,t,e,s),r?.successCallback?.call(this,i)})).catch((t=>{r?.errorCallback?.call(this,i),this.onBackendError(t,e)}));else if(this.rxjs?.isObservable(o)){const t=this.rxjs;t.isObservable(r?.httpCancelRequestSubject)&&r?.httpCancelRequestSubject.next(),o.pipe(t.takeUntil(t.iif((()=>t.isObservable(r?.httpCancelRequestSubject)),r?.httpCancelRequestSubject,t.EMPTY))).subscribe((t=>{this.executeBackendProcessesCallback(n,t,e,s),r?.successCallback?.call(this,i)}),(t=>{r?.errorCallback?.call(this,i),this.onBackendError(t,e)}))}}}refreshBackendDataset(e){let t="";const i=e?.backendServiceApi;if(!i||!i.service||!i.process)throw new Error('BackendServiceApi requires at least a "process" function and a "service" defined');if(i.service&&(t=i.service.buildQuery()),t&&""!==t){const n=new Date;i.preProcess&&i.preProcess();const s=e?.pagination?.totalItems??0;this.executeBackendCallback(i,t,null,n,s)}}setInfiniteScrollBottomHit(e){this._infiniteScrollBottomHit=e}}function u(e,t){["pop","push","reverse","shift","unshift","splice","sort"].forEach((i=>{e[i]=(...n)=>{const s=Array.prototype[i].apply(e,n);return t.apply(e,[e,n]),s}}))}function p(e,t,i){let n=e[t];Object.defineProperty(e,t,{configurable:!0,get:()=>n,set(s){n=s,i.apply(e,[s,e[t]])}})}Array.prototype.map,Array.prototype.reduce;const f=e=>e;class m{}var g,v,_;m.locales={TEXT_ALL_SELECTED:"All Selected",TEXT_ALL_X_RECORDS_SELECTED:"All {{x}} records selected",TEXT_APPLY_MASS_UPDATE:"Apply Mass Update",TEXT_APPLY_TO_SELECTION:"Update Selection",TEXT_CANCEL:"Cancel",TEXT_CLEAR_ALL_FILTERS:"Clear all Filters",TEXT_CLEAR_ALL_GROUPING:"Clear all Grouping",TEXT_CLEAR_ALL_SORTING:"Clear all Sorting",TEXT_CLEAR_PINNING:"Unfreeze Columns/Rows",TEXT_CLONE:"Clone",TEXT_COLLAPSE_ALL_GROUPS:"Collapse all Groups",TEXT_CONTAINS:"Contains",TEXT_COLUMNS:"Columns",TEXT_COLUMN_RESIZE_BY_CONTENT:"Resize by Content",TEXT_COMMANDS:"Commands",TEXT_COPY:"Copy",TEXT_DROP_COLUMN_HEADER_TO_GROUP_BY:"Drop a column header here to group by the column",TEXT_EQUALS:"Equals",TEXT_EQUAL_TO:"Equal to",TEXT_ENDS_WITH:"Ends With",TEXT_ERROR_EDITABLE_GRID_REQUIRED:"Your grid must be editable in order to use the Composite Editor Modal.",TEXT_ERROR_ENABLE_CELL_NAVIGATION_REQUIRED:'Composite Editor requires the flag "enableCellNavigation" to be set to True in your Grid Options.',TEXT_ERROR_NO_CHANGES_DETECTED:"Sorry we could not detect any changes.",TEXT_ERROR_NO_EDITOR_FOUND:"We could not find any Editor in your Column Definition.",TEXT_ERROR_NO_RECORD_FOUND:"No records selected for edit or clone operation.",TEXT_ERROR_ROW_NOT_EDITABLE:"Current row is not editable.",TEXT_ERROR_ROW_SELECTION_REQUIRED:"You must select some rows before trying to apply new value(s).",TEXT_EXPAND_ALL_GROUPS:"Expand all Groups",TEXT_EXPORT_TO_CSV:"Export in CSV format",TEXT_EXPORT_TO_TEXT_FORMAT:"Export in Text format (Tab delimited)",TEXT_EXPORT_TO_EXCEL:"Export to Excel",TEXT_EXPORT_TO_TAB_DELIMITED:"Export in Text format (Tab delimited)",TEXT_FORCE_FIT_COLUMNS:"Force fit columns",TEXT_FILTER_SHORTCUTS:"Filter Shortcuts",TEXT_FREEZE_COLUMNS:"Freeze Columns",TEXT_GREATER_THAN:"Greater than",TEXT_GREATER_THAN_OR_EQUAL_TO:"Greater than or equal to",TEXT_GROUP_BY:"Group By",TEXT_HIDE_COLUMN:"Hide Column",TEXT_ITEMS:"items",TEXT_ITEMS_PER_PAGE:"items per page",TEXT_ITEMS_SELECTED:"items selected",TEXT_OF:"of",TEXT_OK:"OK",TEXT_LAST_UPDATE:"Last Update",TEXT_LESS_THAN:"Less than",TEXT_LESS_THAN_OR_EQUAL_TO:"Less than or equal to",TEXT_NOT_CONTAINS:"Not contains",TEXT_NOT_EQUAL_TO:"Not equal to",TEXT_PAGE:"Page",TEXT_RECORDS_SELECTED:"records selected",TEXT_REFRESH_DATASET:"Refresh Dataset",TEXT_REMOVE_FILTER:"Remove Filter",TEXT_REMOVE_SORT:"Remove Sort",TEXT_RESET_INPUT_VALUE:"Reset Input Value",TEXT_RESET_FORM:"Reset Form",TEXT_SAVE:"Save",TEXT_SELECT_ALL:"Select All",TEXT_SYNCHRONOUS_RESIZE:"Synchronous resize",TEXT_SORT_ASCENDING:"Sort Ascending",TEXT_SORT_DESCENDING:"Sort Descending",TEXT_STARTS_WITH:"Starts With",TEXT_TOGGLE_ALL_GROUPS:"Toggle all Groups",TEXT_TOGGLE_DARK_MODE:"Toggle Dark Mode",TEXT_TOGGLE_FILTER_ROW:"Toggle Filter Row",TEXT_TOGGLE_PRE_HEADER_ROW:"Toggle Pre-Header Row",TEXT_UNFREEZE_COLUMNS:"Unfreeze Columns",TEXT_X_OF_Y_SELECTED:"# of % selected",TEXT_X_OF_Y_MASS_SELECTED:"{{x}} of {{y}} selected"},m.treeDataProperties={CHILDREN_PROP:"children",COLLAPSED_PROP:"__collapsed",HAS_CHILDREN_PROP:"__hasChildren",TREE_LEVEL_PROP:"__treeLevel",PARENT_PROP:"__parentId"},m.DEFAULT_FORMATTER_NUMBER_MIN_DECIMAL=2,m.DEFAULT_FORMATTER_NUMBER_MAX_DECIMAL=2,m.DEFAULT_FORMATTER_CURRENCY_MIN_DECIMAL=2,m.DEFAULT_FORMATTER_CURRENCY_MAX_DECIMAL=4,m.DEFAULT_FORMATTER_PERCENT_MIN_DECIMAL=void 0,m.DEFAULT_FORMATTER_PERCENT_MAX_DECIMAL=void 0,m.DEFAULT_NUMBER_DECIMAL_SEPARATOR=".",m.DEFAULT_NUMBER_THOUSAND_SEPARATOR="",m.DEFAULT_NEGATIVE_NUMBER_WRAPPED_IN_BRAQUET=!1,m.SLIDER_DEFAULT_MIN_VALUE=0,m.SLIDER_DEFAULT_MAX_VALUE=100,m.SLIDER_DEFAULT_STEP=1,m.VALIDATION_REQUIRED_FIELD="Field is required",m.VALIDATION_EDITOR_VALID_NUMBER="Please enter a valid number",m.VALIDATION_EDITOR_VALID_INTEGER="Please enter a valid integer number",m.VALIDATION_EDITOR_INTEGER_BETWEEN="Please enter a valid integer number between {{minValue}} and {{maxValue}}",m.VALIDATION_EDITOR_INTEGER_MAX="Please enter a valid integer number that is lower than {{maxValue}}",m.VALIDATION_EDITOR_INTEGER_MAX_INCLUSIVE="Please enter a valid integer number that is lower than or equal to {{maxValue}}",m.VALIDATION_EDITOR_INTEGER_MIN="Please enter a valid integer number that is greater than {{minValue}}",m.VALIDATION_EDITOR_INTEGER_MIN_INCLUSIVE="Please enter a valid integer number that is greater than or equal to {{minValue}}",m.VALIDATION_EDITOR_NUMBER_BETWEEN="Please enter a valid number between {{minValue}} and {{maxValue}}",m.VALIDATION_EDITOR_NUMBER_MAX="Please enter a valid number that is lower than {{maxValue}}",m.VALIDATION_EDITOR_NUMBER_MAX_INCLUSIVE="Please enter a valid number that is lower than or equal to {{maxValue}}",m.VALIDATION_EDITOR_NUMBER_MIN="Please enter a valid number that is greater than {{minValue}}",m.VALIDATION_EDITOR_NUMBER_MIN_INCLUSIVE="Please enter a valid number that is greater than or equal to {{minValue}}",m.VALIDATION_EDITOR_DECIMAL_BETWEEN="Please enter a valid number with a maximum of {{maxDecimal}} decimals",m.VALIDATION_EDITOR_TEXT_LENGTH_BETWEEN="Please make sure your text length is between {{minLength}} and {{maxLength}} characters",m.VALIDATION_EDITOR_TEXT_MAX_LENGTH="Please make sure your text is less than {{maxLength}} characters",m.VALIDATION_EDITOR_TEXT_MAX_LENGTH_INCLUSIVE="Please make sure your text is less than or equal to {{maxLength}} characters",m.VALIDATION_EDITOR_TEXT_MIN_LENGTH="Please make sure your text is more than {{minLength}} character(s)",m.VALIDATION_EDITOR_TEXT_MIN_LENGTH_INCLUSIVE="Please make sure your text is at least {{minLength}} character(s)",function(e){e[e.camelCase=0]="camelCase",e[e.pascalCase=1]="pascalCase",e[e.snakeCase=2]="snakeCase",e[e.kebabCase=3]="kebabCase"}(g||(g={})),function(e){e.colon=":",e.comma=",",e.equalSign="=",e.pipe="|",e.semicolon=";",e.space=" ",e.tab="\t",e.doubleColon="::",e.doublePipe="||",e.doubleSemicolon=";;"}(v||(v={})),function(e){e.autoTooltip="autoTooltip",e.cellExternalCopyManager="cellExternalCopyManager",e.cellMenu="cellMenu",e.checkboxSelector="checkboxSelector",e.columnPicker="columnPicker",e.contextMenu="contextMenu",e.customTooltip="customTooltip",e.draggableGrouping="draggableGrouping",e.groupItemMetaProvider="groupItemMetaProvider",e.gridMenu="gridMenu",e.headerButton="headerButton",e.headerMenu="headerMenu",e.rowBasedEdit="rowBasedEdit",e.rowDetailView="rowDetailView",e.rowMoveManager="rowMoveManager",e.rowSelection="rowSelection"}(_||(_={}));const b={unknown:"unknown",string:"string",boolean:"boolean",integer:"integer",float:"float",number:"number",date:"date",dateIso:"dateIso",dateUtc:"dateUtc",dateTime:"dateTime",dateTimeIso:"dateTimeIso",dateTimeIsoAmPm:"dateTimeIsoAmPm",dateTimeIsoAM_PM:"dateTimeIsoAM_PM",dateTimeShortIso:"dateTimeShortIso",dateEuro:"dateEuro",dateEuroShort:"dateEuroShort",dateTimeShortEuro:"dateTimeShortEuro",dateTimeEuro:"dateTimeEuro",dateTimeEuroAmPm:"dateTimeEuroAmPm",dateTimeEuroAM_PM:"dateTimeEuroAM_PM",dateTimeEuroShort:"dateTimeEuroShort",dateTimeEuroShortAmPm:"dateTimeEuroShortAmPm",dateTimeEuroShortAM_PM:"dateTimeEuroShortAM_PM",dateUs:"dateUs",dateUsShort:"dateUsShort",dateTimeShortUs:"dateTimeShortUs",dateTimeUs:"dateTimeUs",dateTimeUsAmPm:"dateTimeUsAmPm",dateTimeUsAM_PM:"dateTimeUsAM_PM",dateTimeUsShort:"dateTimeUsShort",dateTimeUsShortAmPm:"dateTimeUsShortAmPm",dateTimeUsShortAM_PM:"dateTimeUsShortAM_PM",object:"object",password:"password",text:"text",readonly:"readonly"};var y,C,w,S,E,x,T;!function(e){e.csv="csv",e.txt="txt",e.xls="xls",e.xlsx="xlsx"}(y||(y={})),function(e){e.merge="merge",e.chain="chain"}(C||(C={})),function(e){e.columns="columns",e.filter="filter",e.pagination="pagination",e.pinning="pinning",e.rowSelection="rowSelection",e.sorter="sorter",e.treeData="treeData"}(w||(w={})),function(e){e.empty="",e.custom="Custom",e.contains="Contains",e.notContains="Not_Contains",e.lessThan="LT",e.lessThanOrEqual="LE",e.greaterThan="GT",e.greaterThanOrEqual="GE",e.notEqual="NE",e.equal="EQ",e.endsWith="EndsWith",e.rangeInclusive="RangeInclusive",e.rangeExclusive="RangeExclusive",e.startsWith="StartsWith",e.startsWithEndsWith="StartsWithEndsWith",e.in="IN",e.notIn="NOT_IN",e.inContains="IN_CONTAINS",e.notInContains="NOT_IN_CONTAINS",e.inCollection="IN_COLLECTION",e.notInCollection="NOT_IN_COLLECTION"}(S||(S={})),function(e){e.asc="asc",e.ASC="ASC",e.desc="desc",e.DESC="DESC"}(E||(E={})),function(e){e[e.asc=1]="asc",e[e.desc=-1]="desc",e[e.neutral=0]="neutral"}(x||(x={})),function(e){e.toggleCollapse="toggle-collapse",e.fullExpand="full-expand",e.fullCollapse="full-collapse",e.toggleExpand="toggle-expand"}(T||(T={}));class A extends Error{constructor(e){super(e),Object.setPrototypeOf(this,A.prototype)}}function O(e){let t=!1;return e instanceof Promise?{promise:e.then((e=>{if(t)throw new A("Cancelled Promise");return e})),cancel:()=>t=!0}:e}function I(e,t,i=""){let n=t;if(t instanceof Promise)return t;if(e.isObservable(t)&&(n=e.firstValueFrom(t)),!(n instanceof Promise))throw new Error(`Something went wrong, Slickgrid-Universal ${i} is not able to convert the Observable into a Promise.`);return n}function k(e,t,i=0){const n=R(t,"childrenPropName");Array.isArray(e)&&e.forEach((e=>{e&&(Array.isArray(e[n])&&e[n].length>0&&(i++,k(e[n],t,i),i--),e[t.levelPropName]=i)}))}function D(e,t,i=0,n=null){const s=R(t,"childrenPropName"),{aggregator:r}=t;Array.isArray(e)&&e.forEach((e=>{if(e){const o=Array.isArray(e[s]);Array.isArray(e[s])&&e[s].length>0&&(r.init(e,!0),i++,D(e[s],t,i,e),i--),n&&r.isInitialized&&"function"==typeof r.accumulate&&!e?.__filteredOut&&(r.accumulate(e,o),r.storeResult(n.__treeTotals)),e[t.levelPropName]=i}}))}function j(e,t){const i=R(t,"identifierPropName"),n=R(t,"childrenPropName"),s=R(t,"hasChildrenPropName"),r=R(t,"parentPropName"),o=R(t,"levelPropName");t?.shouldAddTreeLevelNumber&&(Array.isArray(t?.aggregators)?t.aggregators.forEach((t=>{D(e,{childrenPropName:n,levelPropName:o,aggregator:t})})):k(e,{childrenPropName:n,levelPropName:o}));const a=function(e,t,i=f,n=()=>{}){const s=e&&e.length?[{pointer:e,offset:0}]:[],r=[];let o;for(;s.length;)for(o=s.pop();o.offset<o.pointer.length;){const e=o.pointer[o.offset],a=n(e),l=t(e);r.push(i(e,o.node,a,o.nodeId)),o.offset+=1,l&&(s.push(o),o={pointer:l,offset:0,node:e,nodeId:a})}return r}(e,(e=>e[n]),((e,t)=>({[i]:e[i],[r]:void 0!==t?t[i]:null,[s]:!!e[n],...q(e,n)})));return a}function R(e,t,i="id"){let n="";switch(t){case"childrenPropName":n=e?.childrenPropName??m.treeDataProperties.CHILDREN_PROP;break;case"collapsedPropName":n=e?.collapsedPropName??m.treeDataProperties.COLLAPSED_PROP;break;case"hasChildrenPropName":n=e?.hasChildrenPropName??m.treeDataProperties.HAS_CHILDREN_PROP;break;case"identifierPropName":n=e?.identifierPropName??i;break;case"levelPropName":n=e?.levelPropName??m.treeDataProperties.TREE_LEVEL_PROP;break;case"parentPropName":n=e?.parentPropName??m.treeDataProperties.PARENT_PROP}return n}function L(e,t){const i=R(t,"identifierPropName"),n=R(t,"childrenPropName"),s=R(t,"parentPropName"),r=R(t,"levelPropName"),o=R(t,"collapsedPropName"),a=[],l={};return(e||[]).forEach((e=>{l[e[i]]=e,delete e[n]})),Object.keys(l).forEach((e=>{const i=l[e];if(s in i&&null!==i[s]&&void 0!==i[s]&&""!==i[s]){if(i[s]in l){const e=l[i[s]];n in e||(e[n]=[]),e[n].push(i),void 0===e[o]&&(e[o]=t?.initiallyCollapsed??!1)}}else a.push(i)})),Array.isArray(t?.aggregators)?t.aggregators.forEach((e=>{D(a,{childrenPropName:n,levelPropName:r,aggregator:e},0)})):k(a,{childrenPropName:n,levelPropName:r},0),a}function M(e,t,i){if(!i)throw new Error('findRecursive requires parameter "childrenPropertyName"');const n=e.find(t),s=e.filter((e=>e?.hasOwnProperty(i)&&e[i]));if(n)return n;if(s.length){const e=[];return s.forEach((t=>{t?.hasOwnProperty(i)&&e.push(...t[i])})),M(e,t,i)}}function P(e,t,i,n=".",s=""){if(isNaN(+e))return e;const r=void 0===t?2:t,o=void 0===i?2:i;let a=String(Math.round(+e*Math.pow(10,o))/Math.pow(10,o));for(a.indexOf(".")<0&&r>0&&(a+=".");a.length-a.indexOf(".")<=r;)a+="0";const l=a.split(".");let c,h;c=s?l.length>=1?G(l[0],s):void 0:l.length>=1?l[0]:a,l.length>1&&(h=l[1]);let d="";return void 0!==c&&void 0!==h?d=`${c}${n}${h}`:null!=c&&(d=c),d}function N(e,t,i,n,s="",r="",o=".",a=""){if(isNaN(+e))return e;const l=Math.round(1e6*parseFloat(e))/1e6;if(l<0){const e=Math.abs(l);return n?isNaN(t)&&isNaN(i)?`(${s}${G(`${e}`,a)}${r})`:`(${s}${P(e,t,i,o,a)}${r})`:isNaN(t)&&isNaN(i)?`-${s}${G(`${e}`,a)}${r}`:`-${s}${P(e,t,i,o,a)}${r}`}return isNaN(t)&&isNaN(i)?`${s}${G(`${e}`,a)}${r}`:`${s}${P(e,t,i,o,a)}${r}`}function F(e,t,i){if("function"==typeof e.queryFieldNameGetterFn){const n=e.queryFieldNameGetterFn(t);i=n?.indexOf(".")>=0?H(t,n):t.hasOwnProperty(n)?t[n]:i}return i}function H(e,t){return e&&t?t.split(".").reduce(((e,t)=>e&&e[t]),e):e}function B(e){return e&&e.translationNamespace?e.translationNamespace+(e.translationNamespaceSeparator||""):""}function z(e){return e.outputType||e.type||b.string}function V(e){switch(e){case b.date:case b.dateTime:case b.dateIso:case b.dateTimeIso:case b.dateTimeShortIso:case b.dateTimeIsoAmPm:case b.dateTimeIsoAM_PM:case b.dateEuro:case b.dateEuroShort:case b.dateTimeEuro:case b.dateTimeShortEuro:case b.dateTimeEuroAmPm:case b.dateTimeEuroAM_PM:case b.dateTimeEuroShort:case b.dateTimeEuroShortAmPm:case b.dateTimeEuroShortAM_PM:case b.dateUs:case b.dateUsShort:case b.dateTimeUs:case b.dateTimeShortUs:case b.dateTimeUsAmPm:case b.dateTimeUsAM_PM:case b.dateTimeUsShort:case b.dateTimeUsShortAmPm:case b.dateTimeUsShortAM_PM:case b.dateUtc:return!0;default:return!1}}function W(e){let t;switch(e){case"<":case"LT":t=S.lessThan;break;case"<=":case"LE":t=S.lessThanOrEqual;break;case">":case"GT":t=S.greaterThan;break;case">=":case"GE":t=S.greaterThanOrEqual;break;case"!=":case"NE":t=S.notEqual;break;case"*":case"a*":case"StartsWith":t=S.startsWith;break;case"*z":case"EndsWith":t=S.endsWith;break;case"=":case"==":case"EQ":t=S.equal;break;case"IN":t=S.in;break;case"NIN":case"NOT_IN":t=S.notIn;break;case"<>":case"Not_Contains":case"NOT_CONTAINS":t=S.notContains;break;default:t=S.contains}return t}function $(e){let t="";switch(e){case S.greaterThan:case">":t=">";break;case S.greaterThanOrEqual:case">=":t=">=";break;case S.lessThan:case"<":t="<";break;case S.lessThanOrEqual:case"<=":t="<=";break;case S.notEqual:case"<>":t="<>";break;case S.equal:case"=":case"==":case"EQ":t="=";break;case S.startsWith:case"a*":case"*":t="a*";break;case S.endsWith:case"*z":t="*z";break;default:t=e}return t}function U(e){let t;if(V(e))t=S.equal;else switch(e){case b.unknown:case b.string:case b.text:case b.password:case b.readonly:t=S.contains;break;case b.float:case b.number:default:t=S.equal}return t}function q(e,t){return Object.keys(e).reduce(((i,n)=>(n!==t&&(i[n]=e[n]),i)),{})}function G(e,t=","){if(null!=e){const i=`${e}`,n=i.split(".");return 2===n.length?`${n[0].replace(/\B(?=(\d{3})+(?!\d))/g,t)}.${n[1]}`:i.replace(/\B(?=(\d{3})+(?!\d))/g,t)}return e}function K(e,t,i={}){return Array.isArray(e)?e.find(t)||i:e}function Y(e){if(Array.isArray(e))for(;e.length>0;){const t=e.pop();t?.unsubscribe&&t.unsubscribe()}return e}function X(e){let t=0,i=0,n=0,s=0;const r=window.innerHeight||0,o=window.innerWidth||0,a=ue(),l=a.top,c=a.left,h=ne(e);if(h){const a=h.top,d=h.left;i=a-l,n=d-c,t=r-(a-l+e.clientHeight),s=o-(d-c+e.clientWidth)}return{top:i,bottom:t,left:n,right:s}}function Z(e,t,i){const n=document.createElement(e);return t&&Object.keys(t).forEach((i=>{"innerHTML"===i&&console.warn(`[Slickgrid-Universal] For better CSP (Content Security Policy) support, do not use "innerHTML" directly in "createDomElement('${e}', { innerHTML: 'some html'})", it is better as separate assignment: "const elm = createDomElement('span'); elm.innerHTML = 'some html';"`);const s=t[i];"object"==typeof s?Object.assign(n[i],s):n[i]=t[i]})),i?.appendChild&&i.appendChild(n),n}function Q(e=""){return e.split(" ").filter((e=>e))}function J(e){"object"==typeof e&&Object.keys(e).forEach((t=>{Array.isArray(e[t])&&J(e[t]),e[t]instanceof HTMLElement&&(e[t]=null)}))}function ee(e){for(;e?.firstChild;)e.removeChild(e.firstChild);return e}function te(e,t="innerHTML"){return e instanceof DocumentFragment?[].map.call(e.childNodes,(e=>e[t])).join("")||e.textContent||"":e instanceof HTMLElement?e[t]:String(e??"")}function ie(e,t){if(!e||!t)return;const i=e.getBoundingClientRect(),n=t.getBoundingClientRect();return{top:n.top-i.top,right:n.right-i.right,bottom:n.bottom-i.bottom,left:n.left-i.left}}function ne(e){let t=0,i=0,n=0,s=0;if(!e||!e.getBoundingClientRect)return{top:t,bottom:n,left:i,right:s};const r=e.getBoundingClientRect(),o=document.documentElement;return void 0!==r?.top&&void 0!==r.left&&(t=r.top+window.pageYOffset-o.clientTop,i=r.left+window.pageXOffset-o.clientLeft,s=r.right,n=r.bottom),{top:t,left:i,bottom:n,right:s}}function se(e,t){let i=0;if(e){const n="height"===t?["top","bottom"]:["left","right"];i=e["height"===t?"clientHeight":"clientWidth"];for(const t of n)i-=parseFloat(re(e,`padding-${t}`)||"")||0}return i}function re(e,t){return e?window.getComputedStyle(e).getPropertyValue(t):null}function oe(e,t){if(e)for(const i of t){const t=e.getAttribute(i);if(t)return t}return null}function ae(e,t="auto"){return(/^[0-9]+$/i.test(`${e}`)?+e+"px":e)||t}function le(e){const t="string"==typeof e?e:String(e),i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return(t||"").toString().replace(/[&<>"']/g,(e=>i[e]))}function ce(e){return e.replace(/&#(\d+);/g,((e,t)=>String.fromCharCode(t)))}function he(e,t){const i=e.length;let n=le(e);if(i<t)for(let e=i;e<t;e++)n+="&nbsp;";return n}function de(e,t){e.parentNode?.insertBefore(t,e.nextSibling)}function ue(){return{left:window.pageXOffset||document.documentElement.scrollLeft||0,top:window.pageYOffset||document.documentElement.scrollTop||0}}const pe=Object.prototype.hasOwnProperty,fe=Object.prototype.toString,me=Object.defineProperty,ge=Object.getOwnPropertyDescriptor,ve=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===fe.call(e)},_e=function(e){if(!e||"[object Object]"!==fe.call(e))return!1;const t=pe.call(e,"constructor"),i=e.constructor&&e.constructor.prototype&&pe.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!t&&!i)return!1;let n;for(n in e);return void 0===n||pe.call(e,n)},be=function(e,t){me&&"__proto__"===t.name?me(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},ye=function(e,t){if("__proto__"===t){if(!pe.call(e,t))return;if(ge)return ge(e,t).value}return e[t]};function Ce(...e){let t,i,n,s,r,o,a=e[0],l=1;const c=e.length;let h=!1;for("boolean"==typeof a&&(h=a,a=e[1]||{},l=2),(null==a||"object"!=typeof a&&"function"!=typeof a)&&(a={});l<c;++l)if(t=e[l],null!=t)for(i in t)n=ye(a,i),s=ye(t,i),a!==s&&(h&&s&&(_e(s)||(r=ve(s)))?(r?(r=!1,o=n&&ve(n)?n:[]):o=n&&_e(n)?n:{},be(a,{name:i,newValue:Ce(h,o,s)})):void 0!==s&&be(a,{name:i,newValue:s}));return a}function we(e,t,i="id"){let n=-1;n=t&&"object"==typeof t&&i in t?e.findIndex((e=>e[i]===t[i])):e.findIndex((e=>e===t)),n<0&&e.push(t)}function Se(e,t=" "){let i="";for(let n=0;n<e;n++)i+=t;return i}function Ee(e,t){return e.filter(((e,i)=>t!==i))}function xe(e){return Array.isArray(e)||je(e)?Ce(!0,Array.isArray(e)?[]:{},e):e}function Te(e,...t){if(!t.length)return e;const i=t.shift();return e=!je(e)&&je(i)?{}:e,je(e)&&je(i)&&Object.keys(i).forEach((t=>{i.hasOwnProperty(t)&&(t in e?"object"!=typeof e[t]||"object"!=typeof i[t]?e[t]=i[t]:e[t].concat&&i[t].concat?e[t]=e[t].concat(i[t]):e[t]=Te(e[t],i[t]):e[t]=i[t])})),Te(e,...t)}function Ae(e){return je(e)&&Object.keys(e).forEach((t=>{e.hasOwnProperty(t)&&delete e[t]})),e=null,e={}}function Oe(e,t=!0){let i=!1;return{params:(e=>{const t=e.toString().replace(/(\/\/.*$)|(\/\*[\s\S]*?\*\/)|(\s*=[^,)]*(('(?:\\'|[^'\r\n])*')|("(?:\\"|[^"\r\n])*"))|(\s*=[^,)]*))/gm,"");return t.slice(t.indexOf("(")+1,t.indexOf(")")).match(/([^\s,]+)/g)??[]})(e),body:(e=>{const n=e.toString();if(i=n.includes("async "),n.replaceAll(" ","").includes("=>({")){const e=n.match(/(({.*}))/g)||[];return e.length>=1?`return ${e[0].trimStart()}`:n}const s=!n.includes("{")&&n.includes("=>"),r=n.substring(n.indexOf("{")+1||n.indexOf("=>")+2,n.includes("}")?n.lastIndexOf("}"):n.length);return t&&s&&!r.startsWith("return")?"return "+r.trimStart():r})(e),isAsync:i}}function Ie(e){return null==e||0===Object.entries(e).length}function ke(e){return null!=e&&""!==e}function De(e){return null!==e&&!isNaN(e)&&""!==e}function je(e){return!(null===e||"object"!=typeof e||Array.isArray(e)||e instanceof Date)}function Re(e){return"boolean"==typeof e||"number"==typeof e||"string"==typeof e||null==e}function Le(e){return e instanceof HTMLElement||e instanceof DocumentFragment||Re(e)}function Me(e,t=!1){return t?null!=e&&"string"!=typeof e&&!isNaN(e):null!=e&&""!==e&&!isNaN(+e)}function Pe(e){return!e||e&&"object"==typeof e&&0===Object.keys(e).length}function Ne(e){return/(true|1)/i.test(e+"")}function Fe(e,t=!1){const i="function"==typeof e.normalize?e.normalize("NFD").replace(/[\u0300-\u036f]/g,""):e;return t?i.toLowerCase():i}function He(e,t,i){if("string"==typeof t&&(t=t.split(".")),t.length>1){const n=t.shift();e&&void 0!==n&&He(e[n]=ke(e[n])&&(Array.isArray(e[n])||"[object Object]"===Object.prototype.toString.call(e[n]))?e[n]:{},t,i)}else e&&t[0]&&(e[t[0]]=i)}function Be(e,t=!1){return"string"==typeof e?t?e.replace(/\w\S*/g,(e=>e.charAt(0).toUpperCase()+e.substring(1).toLowerCase())):e.charAt(0).toUpperCase()+e.slice(1):e}function ze(e){return"string"==typeof e?e.replace(/(?:^\w|[A-Z]|\b\w|[\s+\-_/])/g,((e,t)=>/[\s+\-_/]/.test(e)?"":0===t?e.toLowerCase():e.toUpperCase())):e}function Ve(e){return"string"==typeof e?ze(e).replace(/([A-Z])|([-_])/g,"-$1").toLowerCase():e}function We(e){if("string"==typeof e){const t=e.replace(/([A-Z])|([-_])/g," $1").replace(/\s+/g," ").trim();return t.charAt(0).toUpperCase()+t.slice(1)}return e}function $e(e){return"string"==typeof e?ze(e).replace(/([A-Z])/g,"_$1").toLowerCase():e}function Ue(e){return Array.isArray(e)&&e.length>0?e.filter(((t,i)=>e.indexOf(t)>=i)):e}function qe(e,t="id"){if(Array.isArray(e)&&e.length>0){const i=[],n=new Map;for(const s of e)s&&!n.has(s[t])&&(n.set(s[t],!0),i.push({id:s[t],name:s.name}));return i}return e}const Ge=Symbol("plaintext"),Ke=Symbol("html"),Ye=Symbol("comment"),Xe=/<(\w*)>/g,Ze=/<\/?([^\s/>]+)/;function Qe(e,t,i){function n(e){let t=new Set;if("string"==typeof e){let i;for(;i=Xe.exec(e);)t.add(i[1])}else"function"==typeof e[Symbol.iterator]&&(t=new Set(e));return t}function s(e){const t=Ze.exec(e);return t?t[1].toLowerCase():null}return function(e,t,i){if("string"!=typeof e&&(Me(e)||"boolean"==typeof e))return String(e);if(e instanceof HTMLElement&&(e=e.innerHTML),"string"!=typeof e&&null!=e)throw new TypeError("'html' parameter must be a string");return function(e,t){const i=t.allowable_tags,n=t.tag_replacement;let r=t.state,o=t.tag_buffer,a=t.depth,l=t.in_quote_char,c="";for(let t=0,h=e.length;t<h;t++){const h=e[t];if(r===Ge)"<"===h?(r=Ke,o+=h):c+=h;else if(r===Ke)switch(h){case"<":if(l)break;a++;break;case">":if(l)break;if(a){a--;break}l="",r=Ge,o+=">",i.has(s(o))?c+=o:c+=n,o="";break;case'"':case"'":l=h===l?"":l||h,o+=h;break;case"-":"<!-"===o&&(r=Ye),o+=h;break;case" ":case"\n":if("<"===o){r=Ge,c+="< ",o="";break}o+=h;break;default:o+=h}else r===Ye&&(">"===h?("--"===o.slice(-2)&&(r=Ge),o=""):o+=h)}return t.state=r,t.tag_buffer=o,t.depth=a,t.in_quote_char=l,c}(e||"",function(e,t){return{allowable_tags:n(e),tag_replacement:t,state:Ge,tag_buffer:"",depth:0,in_quote_char:""}}(t||"",i||""))}(e,t,i)}var Je=/^([0-9]{4})-([0-1][0-9])(?:-([0-3][0-9]))?(?:[T ]?([0-2][0-9])(?::([0-5][0-9]))?(?::([0-5][0-9]))?)?(?:\.[0-9]+)?(Z|(?:\+|\-)[0-9]{2}:?[0-9]{2})?$/;function et(e){if(e||(e=new Date),e instanceof Date){const t=new Date(e);return t.setMilliseconds(0),t}if(function(e){const t=e.match(Je);if(t){const e=Number(t[2]);if(e<1||e>12)return!1;if(void 0!==typeof t[3]){const e=Number(t[3]);if(e<1||e>31)return!1}if(void 0!==typeof t[4]){const e=Number(t[4]);if(e<0||e>23)return!1}return!0}return!1}(e=e.trim()))return new Date(function(e){const t=e.match(Je);return t&&void 0===t[4]?e+"T00:00:00":e}(e));throw new Error(`Non ISO 8601 compliant date (${e}).`)}var tt="1999-03-04T02:05:01.000Z",it=new Map,nt=[["YYYY",{year:"numeric"}],["YY",{year:"2-digit"}],["MMMM",{month:"long"}],["MMM",{month:"short"}],["MM",{month:"2-digit"}],["M",{month:"numeric"}],["DD",{day:"2-digit"}],["D",{day:"numeric"}],["dddd",{weekday:"long"}],["ddd",{weekday:"short"}],["d",{weekday:"narrow"}],["mm",{minute:"2-digit"}],["m",{minute:"numeric"}],["ss",{second:"2-digit"}],["s",{second:"numeric"}],["ZZ",{timeZoneName:"long"}],["Z",{timeZoneName:"short"}]],st=[["HH",{hour:"2-digit"}],["H",{hour:"numeric"}]],rt=[["hh",{hour:"2-digit"}],["h",{hour:"numeric"}],["a",{dayPeriod:"narrow"}],["A",{dayPeriod:"narrow"}]],ot={DD:2,HH:2,MM:2,YY:2,YYYY:4,hh:2,mm:2,ss:2};function at(e){if(/^[+-]\d{2}:\d{2}/.test(e))return 6;if(/^[+-]\d{4}/.test(e))return 5;throw new Error("Invalid offset format")}var lt=["MMMM","MMM","dddd","ddd"],ct=new Map([...nt,...st,...rt].map((e=>[e[0],e]))),ht=new Map,dt=["full","long","medium","short"],ut=e=>String(e).padStart(2,"0"),pt=e=>String(e).padStart(2,"0");function ft(e){return"literal"===e.type&&(e.value=e.value.normalize("NFKC")),e}function mt(e,t="Z"){const i=String(Math.floor(Math.abs(e/60))).padStart(2,"0"),n=String(Math.abs(e%60)).padStart(2,"0"),s=e<0?"-":"+";return"ZZ"===t?`${s}${i}${n}`:`${s}${i}:${n}`}function gt(e,t="Z"){if(!(t=>{switch(t){case"Z":return/^([+-])[0-3][0-9]:[0-6][0-9]$/.test(e);case"ZZ":return/^([+-])[0-3][0-9][0-6][0-9]$/.test(e)}})(t))throw new Error(`Invalid offset: ${e}`);return e}function vt(e){return["numeric","2-digit"].includes(e.partValue)}function _t(e,t){const i=ht.get(t);if(i&&i[e])return i[e];const n=new Date(tt);n.setUTCHours("am"===e?5:20);const s=new Intl.DateTimeFormat(t,{timeStyle:"full",timeZone:"UTC",hour12:!0}).formatToParts(n).map(ft).find((e=>"dayPeriod"===e.type));if(s){const n=i||{};return ht.set(t,Object.assign(n,{[e]:s.value})),s.value}return e}function bt(){return Intl.DateTimeFormat().resolvedOptions().timeZone}function yt(e,t){const i=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZone:t,hourCycle:"h23"}).formatToParts(e).map(ft),n={};return i.forEach((e=>{n[e.type]=e.value})),new Date(`${n.year}-${n.month}-${n.day}T${n.hour}:${n.minute}:${n.second}Z`)}function Ct(e,t="UTC",i="device",n="Z"){var s;i="device"===i?null!=(s=bt())?s:"utc":i;const r=et(e),o=yt(r,t),a=yt(r,i);return mt(Math.round((a.getTime()-o.getTime())/1e3/60),n)}function wt(e){const t=et(e);return t.setHours(0,0,0),t}function St(e,t){if(dt.includes(e)||"object"==typeof e)return function(e,t){const i={timeZone:"UTC"};"string"==typeof e?i.dateStyle=e:("date"in e&&(i.dateStyle=e.date),"time"in e&&(i.timeStyle=e.time));const n=new Intl.DateTimeFormat(t,i),s=n.formatToParts(new Date(tt)).map(ft),r=n.formatToParts(new Date("1999-04-05T23:05:01.000Z")).map(ft).find((e=>"hour"===e.type)),o=r&&"23"===r.value?24:12;return s.map((e=>{const n=e.type,s=function(e,t,i,n,s){const r=t.length,o=!isNaN(Number(t));let a;switch(e){case"year":return 2===r?ct.get("YY"):ct.get("YYYY");case"month":return o?1===r?ct.get("M"):ct.get("MM"):(a=Et(i,e,t),"long"===a?ct.get("MMMM"):ct.get("MMM"));case"day":return 1===r?ct.get("D"):ct.get("DD");case"weekday":switch(a=Et(i,e,t),a){case"narrow":return ct.get("d");case"short":return ct.get("ddd");default:return ct.get("dddd")}case"hour":return 12===n?1===r?ct.get("h"):ct.get("hh"):1===r?ct.get("H"):ct.get("HH");case"minute":return 1===r?ct.get("m"):ct.get("mm");case"second":return 1===r?ct.get("s"):ct.get("ss");case"dayPeriod":return/^[A-Z]+$/u.test(t)?ct.get("A"):ct.get("a");case"literal":return[t,{literal:t},new RegExp("")];case"timeZoneName":return"full"===s.timeStyle?ct.get("Z"):ct.get("ZZ");default:return}}(e.type,e.value,t,"hour"===e.type?o:void 0,i);if(void 0===s)return;const r=s[1][n];return r?(s[2]||(s[2]=new RegExp(`${s[0]}`,"g")),{option:{[n]:r},partName:n,partValue:r,token:s[0],pattern:s[2],hour12:12===o}):void 0})).filter((e=>!!e))}(e,t);let i=e,n=0;const s=e=>{if(e[2]||(e[2]=new RegExp(`(.)?(${e[0]})`,"g")),e[2].test(i)){let t=0;return i=i.replace(e[2],((e,i,s)=>"\\"===i?s:`${"string"==typeof i?i:""}{!${t++?n:n++}!}`)),!!t}return!1};function r(e,[t,i,n]){const s=Object.keys(i)[0];return{option:i,partName:s,partValue:i[s],token:t,pattern:n,hour12:e}}const o=function(e){const t=e.map((e=>e.partName)),i=new Set(t);if(t.length>i.size)throw new Error("Cannot reuse format tokens.");return e}(nt.filter(s).concat(st.filter(s)).map(r.bind(null,!1)).concat(rt.filter(s).map(r.bind(null,!0)))),a=/^\{!(\d+)!\}$/;return i.split(/(\{!\d+!\})/).map((e=>{const t=e.match(a);return t?o[Number(t[1])]:{option:{literal:e},partName:"literal",partValue:e,token:e,pattern:new RegExp(""),hour12:!1}})).filter((e=>!("literal"===e.partName&&""===e.partValue)))}function Et(e,t,i){if(!it.has(e)){const t=new Date(tt),i=[3,8,9,7,6,4,3],n=["weekday","month","dayPeriod"],s=["long","short","narrow"],r={};for(let o=0;o<12;o++){t.setMonth(0+o),o in i&&t.setDate(i[o]),t.setUTCHours(8+o);for(const i of s){const s=new Intl.DateTimeFormat(e,n.reduce(((e,t)=>Object.assign(e,{[t]:i})),{hour12:!0,timeZone:"UTC"})).formatToParts(t).map(ft);if("long"===i||"short"===i){const n=new Intl.DateTimeFormat(e,{dateStyle:"short"===i?"medium":"long",timeZone:"UTC"}).formatToParts(t).map(ft).find((e=>"month"===e.type)),r=s.findIndex((e=>"month"===e.type));r>-1&&n&&(s[r]=n)}s.forEach((e=>{if("literal"===e.type)return;const t=e.type;r[t]=Object.assign(r[t]||{},{[e.value]:i})}))}}it.set(e,r)}const n=it.get(e);return n?n[t][i]:void 0}function xt(e,t="+00:00"){const i="+"===t.slice(0,1);return function(e,t="+00:00"){const i=et(e),n=(()=>{switch(at(t)){case 5:return"ZZ";case 6:return"Z"}})(),s=function(e,t){gt(e,t);const[i,n,s,r]=e.match(/([+-])([0-3][0-9]):?([0-6][0-9])/),o=60*Number(s)+Number(r);return"+"===n?o:-o}(t,n);return new Date(i.getTime()+1e3*s*60)}(e,t.replace(i?"+":"-",i?"-":"+"))}function Tt(e,t="long",i="device",n=!1,s){let r,o;return"object"!=typeof e||e instanceof Date||({date:e,format:t,locale:i,genitive:n,partFilter:s,tz:r}=e),"ISO8601"===t?et(e).toISOString():(r&&(o=Ct(e,"utc",r,function(e){return"string"==typeof e?e.includes("ZZ")?"ZZ":"Z":"time"in e&&"full"===e.time?"Z":"ZZ"}(t))),null!=r||(r=bt()),"utc"!==(null==r?void 0:r.toLowerCase())&&(e=xt(e,Ct(e,r,"utc"))),i&&"device"!==i||(i=Intl.DateTimeFormat().resolvedOptions().locale),function(e,t,i,n=!1,s=null){const r=function(e,t,i,n=!1){const s=et(e),r=t.filter((e=>e.hour12)),o=t.filter((e=>!e.hour12)),a=[],l=[];function c(e,t=!1){const r=`${i}-u-hc-${t?"h12":"h23"}`;if(a.push(...new Intl.DateTimeFormat(r,e.reduce(((e,t)=>"literal"===t.partName?e:(n&&lt.includes(t.token)&&l.push(t),Object.assign(e,t.option))),{timeZone:"UTC"})).formatToParts(s).map(ft)),n&&l.length)for(const e of l){let t=[];switch(e.token){case"MMMM":t=new Intl.DateTimeFormat(r,{dateStyle:"long",timeZone:"UTC"}).formatToParts(s).map(ft);break;case"MMM":t=new Intl.DateTimeFormat(r,{dateStyle:"medium",timeZone:"UTC"}).formatToParts(s).map(ft)}const i=t.find((t=>t.type===e.partName)),n=a.findIndex((t=>t.type===e.partName));i&&n>-1&&(a[n]=i)}}return r.length&&c(r,!0),o.length&&c(o),a.reduce(((e,t)=>(e[t.type]=t.value,e)),{})}(e,t,i,n),o=et(e);function a({partName:e,partValue:t,token:n}){if("literal"===e)return t;const a=r[e];if("hour"===e&&"H"===n)return a.replace(/^0/,"")||"0";if(["mm","ss","MM"].includes(n)&&1===a.length)return`0${a}`;if("dayPeriod"===e){const e=_t(o.getUTCHours()<12?"am":"pm",i);return"A"===n?e.toUpperCase():e.toLowerCase()}return"timeZoneName"===e?null!=s?s:mt(-1*o.getTimezoneOffset(),n):a}return t.map((e=>({...e,value:a(e)})))}(e,St(t,i).filter(null!=s?s:()=>!0),i,n,o).map((e=>e.value)).join(""))}function At(e,t="en",i=!1){const n=(e,t)=>Array(e).fill("").map(((e,i)=>`${t(i)}`));if("M"===e)return n(12,(e=>e+1));if("MM"===e)return n(12,(e=>{const t=e+1;return t<10?`0${t}`:t}));if(e.startsWith("M"))return At("MM").map((n=>Tt(`2000-${n}-05`,e,t,i)));if(e.startsWith("d"))return n(7,(e=>`0${e+2}`)).map((i=>Tt(`2022-10-${i}`,e,t)));if("a"===e)return[_t("am",t).toLowerCase(),_t("pm",t).toLowerCase()];if("A"===e)return[_t("am",t).toUpperCase(),_t("pm",t).toUpperCase()];if(e.startsWith("Y")){const i=(new Date).getFullYear();return n(120,(e=>e+1)).reduce(((n,s)=>("120"!==s&&n.push(Tt(`${i+Number(s)}-06-06`,e,t)),n.unshift(Tt(i-Number(s)+"-06-06",e,t)),n)),[Tt(`${i}-06-06`,e,t)])}return e.startsWith("D")?n(31,(t=>`${"DD"===e&&t<9?"0":""}${t+1}`)):e.startsWith("H")?n(24,(t=>`${"HH"===e&&t<10?"0":""}${t}`)):e.startsWith("h")?n(12,(t=>`${"hh"===e&&t<9?"0":""}${t+1}`)):e.startsWith("m")||e.startsWith("s")?n(60,(t=>`${e.length>1&&t<10?"0":""}${t}`)):[]}function Ot(e,t="ISO8601",i="device"){let n,s=()=>!0,r="backward";if("object"==typeof e?({date:n,format:t="ISO8601",locale:i="device",dateOverflow:r="backward",partFilter:s=()=>!0}=e):n=e,!n)throw new Error("parse() requires a date string.");const o=()=>{throw new Error(`Date (${n}) does not match format (${function(e,t="en",i=!1,n=()=>!0){return St(e,t).filter(n).reduce(((e,t)=>{return e+(i&&"literal"===t.partName?(n=t.token,nt.concat(st).concat(rt).sort(((e,t)=>e[0].length>t[0].length?1:-1)).reduce(((e,t)=>e.replace(t[0],`\\${t[0]}`)),n)):t.token);var n}),"").normalize("NFKC")}(t,i)})`)};if("ISO8601"===t)return et(n);const a=dt.includes(t)||"object"==typeof t,l=function(e){let t;for(const i of e){if("literal"===i.partName&&!isNaN(parseFloat(i.partValue)))throw new Error(`Numbers in format (${i.partValue}).`);if(t&&"literal"!==t.partName&&"literal"!==i.partName&&!(t.token in ot||i.token in ot||vt(t)&&"a"===i.token.toLowerCase()))throw new Error(`Illegal adjacent tokens (${t.token}, ${i.token})`);t=i}return e}(St(t,i).filter(s));if(!l.length)throw new Error("parse() requires a pattern.");let c;try{c=function(e,t){let i=0;let n=0;const s=[];let r;do{const[a,l]=[(o=t)[i++],o[i]];r=l;let c=1;if("literal"===a.partName)c=a.partValue.length;else if("timeZoneName"===a.partName)c=at(e.substring(n));else if(a.token in ot)c=ot[a.token];else if(l)if("literal"===l.partName){if(c=e.indexOf(l.partValue,n)-n,c<0)throw new Error}else if("dayPeriod"===l.partName){for(let t=1;t<=4;t++)if(isNaN(Number(e.charAt(n+t)))){c=t;break}}else{const t=e.substring(n).search(/\d/);-1!==t&&(c=n+t)}else c=e.length;s.push({...a,value:e.substring(n,n+c)}),n+=c}while(r);var o;return s}(n,l)}catch{return o()}const h=new Date,d=new Map([["YYYY",h.getFullYear()],["MM",h.getMonth()+1],["DD",h.getDate()],["HH",0],["mm",0],["ss",0]]);let u=null,p="";c.forEach((e=>{if("literal"===e.partName)return;if(e.token===e.value)return o();const t=Number(e.value);if(d.has(e.token))d.set(e.token,t);else if("YY"===e.token)d.set("YYYY",function(e){const t=(new Date).getFullYear(),i=t%100,n=Math.floor(t/100),s=Number(e);return 100*(n+(s>i+20?-1:0))+s}(e.value));else{const n=e.token;if(n.startsWith("d"))return;if("D"===n)d.set("DD",t);else if("H"===n||n.startsWith("h"))d.set("HH",t);else if("M"===n)d.set("MM",t);else if("a"===n||"A"===n)u=e.value.toLowerCase()===_t("am",i).toLowerCase();else if("Z"===n||"ZZ"===n)p=gt(e.value,n);else{const t=At(n,i,a).indexOf(e.value);if(-1!==t)switch(n){case"MMM":case"MMMM":d.set("MM",t+1)}}}}));let f=d.get("HH")||0;!1===u?(f+=12===f?0:12,d.set("HH",24===f?0:f)):!0===u&&12===f&&d.set("HH",0),d.set("MM",(d.get("MM")||1)-1);let[m,g,v,_,b,y]=Array.from(d.values());const C=function(e){const t=function(e){const t=et(e);return t.setDate(1),t.setMonth(t.getMonth()+1),t.setDate(0),t}(e);return t.getDate()}(new Date(`${pt(m)}-${ut(g+1)}-10`));if(C<v&&"throw"===r)throw new Error(`Invalid date ${pt(m)}-${ut(g+1)}-${ut(v)}`);v="backward"===r?Math.min(v,C):v;const w=`${pt(m)}-${ut(g+1)}-${ut(v)}T${ut(_)}:${ut(b)}:${ut(y)}${p}`,S=new Date(w);return isFinite(+S)?S:o()}function It(e,t){let i;const n=t?.withZeroPadding??!1;switch(e){case b.dateTime:case b.dateTimeIso:i="YYYY-MM-DD HH:mm:ss";break;case b.dateTimeIsoAmPm:i="YYYY-MM-DD hh:mm:ss a";break;case b.dateTimeIsoAM_PM:i="YYYY-MM-DD hh:mm:ss A";break;case b.dateTimeShortIso:i="YYYY-MM-DD HH:mm";break;case b.dateEuro:i="DD/MM/YYYY";break;case b.dateEuroShort:i=n?"DD/MM/YY":"D/M/YY";break;case b.dateTimeEuro:i="DD/MM/YYYY HH:mm:ss";break;case b.dateTimeShortEuro:i=n?"DD/MM/YYYY HH:mm":"D/M/YYYY H:m";break;case b.dateTimeEuroAmPm:i="DD/MM/YYYY hh:mm:ss a";break;case b.dateTimeEuroAM_PM:i="DD/MM/YYYY hh:mm:ss A";break;case b.dateTimeEuroShort:i=n?"DD/MM/YY HH:mm:ss":"D/M/YY H:m:s";break;case b.dateTimeEuroShortAmPm:i=n?"DD/MM/YY hh:mm:ss a":"D/M/YY h:m:s a";break;case b.dateTimeEuroShortAM_PM:i=n?"DD/MM/YY hh:mm:ss A":"D/M/YY h:m:s A";break;case b.dateUs:i="MM/DD/YYYY";break;case b.dateUsShort:i=n?"MM/DD/YY":"M/D/YY";break;case b.dateTimeUs:i="MM/DD/YYYY HH:mm:ss";break;case b.dateTimeUsAmPm:i="MM/DD/YYYY hh:mm:ss a";break;case b.dateTimeUsAM_PM:i="MM/DD/YYYY hh:mm:ss A";break;case b.dateTimeUsShort:i=n?"MM/DD/YY HH:mm:ss":"M/D/YY H:m:s";break;case b.dateTimeUsShortAmPm:i=n?"MM/DD/YY hh:mm:ss a":"M/D/YY h:m:s a";break;case b.dateTimeUsShortAM_PM:i=n?"MM/DD/YY hh:mm:ss A":"M/D/YY h:m:s A";break;case b.dateTimeShortUs:i=n?"MM/DD/YYYY HH:mm":"M/D/YYYY H:m";break;case b.dateUtc:i="ISO8601";break;case b.date:case b.dateIso:default:i=t?.withDefaultIso8601?"ISO8601":"YYYY-MM-DD"}return i}function kt(e,t,i){const n=t?It(t):void 0,s=It(i),r=e instanceof Date?e:Dt(e,n);return r&&void 0!==e?i===b.dateUtc?r.toISOString():Tt(r,s,"en-US"):""}function Dt(e,t,i=!1){try{return!!e&&(e instanceof Date?e:Ot({date:e,format:t,dateOverflow:i?"throw":"backward",locale:"en-US"}))}catch(e){return!1}}function jt(e){const t=e===b.date?void 0:It(e);return(e,i,n)=>function(e,t,i,n,s){let r=0;if(e===t)r=0;else{let i=Dt(e,n,s),o=Dt(t,n,s);i||(i=new Date(1001,1,1)),o||(o=new Date(1001,1,1)),r=i.valueOf()-o.valueOf()}return i*r}(e,i,n,t,void 0!==t)}const Rt={boolean:(e,t,i=x.neutral)=>{let n=0;return n=e===t?0:null===e?-1:null===t?1:i?e<t?-1:1:e<t?1:-1,i*n},date:jt(b.date),dateIso:jt(b.dateIso),dateUtc:jt(b.dateUtc),dateTime:jt(b.dateTime),dateTimeIso:jt(b.dateTimeIso),dateTimeIsoAmPm:jt(b.dateTimeIsoAmPm),dateTimeIsoAM_PM:jt(b.dateTimeIsoAM_PM),dateTimeShortIso:jt(b.dateTimeShortIso),dateEuro:jt(b.dateEuro),dateEuroShort:jt(b.dateEuroShort),dateTimeShortEuro:jt(b.dateTimeShortEuro),dateTimeEuro:jt(b.dateTimeEuro),dateTimeEuroAmPm:jt(b.dateTimeEuroAmPm),dateTimeEuroAM_PM:jt(b.dateTimeEuroAM_PM),dateTimeEuroShort:jt(b.dateTimeEuroShort),dateTimeEuroShortAmPm:jt(b.dateTimeEuroShortAmPm),dateTimeEuroShortAM_PM:jt(b.dateTimeEuroShortAM_PM),dateUs:jt(b.dateUs),dateUsShort:jt(b.dateUsShort),dateTimeShortUs:jt(b.dateTimeShortUs),dateTimeUs:jt(b.dateTimeUs),dateTimeUsAmPm:jt(b.dateTimeUsAmPm),dateTimeUsAM_PM:jt(b.dateTimeUsAM_PM),dateTimeUsShort:jt(b.dateTimeUsShort),dateTimeUsShortAmPm:jt(b.dateTimeUsShortAmPm),dateTimeUsShortAM_PM:jt(b.dateTimeUsShortAM_PM),numeric:(e,t,i=x.neutral,n,s)=>{const r=n?.valueCouldBeUndefined??s?.cellValueCouldBeUndefined??!1,o=isNaN(e)||""===e||null===e||r&&void 0===e?-1/0:parseFloat(e),a=isNaN(t)||""===t||null===t||r&&void 0===t?-1/0:parseFloat(t);return i*(o===a?0:o>a?1:-1)},objectString:(e,t,i=x.neutral,n,s)=>{if(!n||!n.dataKey)throw new Error('Sorting a "FieldType.object" requires you to provide the "dataKey" (object property name) of the object so that we can use it to sort correctly');const r=e?.hasOwnProperty(n.dataKey)?e[n.dataKey]:e,o=t?.hasOwnProperty(n.dataKey)?t[n.dataKey]:t,a=n?.valueCouldBeUndefined??s?.cellValueCouldBeUndefined??!1;let l=0;return l="object"!=typeof e?-1/0:"object"!=typeof t?1/0:null===r||a&&void 0===r?-1:null===o||a&&void 0===o?1:r===o?0:i?r<o?-1:1:r<o?1:-1,i*l},string:(e,t,i=x.neutral,n,s)=>{let r=0;const o=n?.valueCouldBeUndefined??s?.cellValueCouldBeUndefined??!1;return e===t?r=0:null===e||o&&void 0===e?r=-1:null===t||o&&void 0===t?r=1:(s?.ignoreAccentOnStringFilterAndSort&&(e=Fe(e,!1),t=Fe(t,!1)),r=i?e<t?-1:1:e<t?1:-1),i*r}};function Lt(e,t,i,n,s,r){let o=0;if(V(e))o=jt(e).call(this,t,i,n,s,r);else switch(e){case b.boolean:o=Rt.boolean(t,i,n,s,r);break;case b.float:case b.integer:case b.number:o=Rt.numeric(t,i,n,s,r);break;case b.object:o=Rt.objectString(t,i,n,s,r);break;case b.string:case b.text:case b.password:case b.readonly:default:o=Rt.string(t,i,n,s,r)}return o}var Mt;!function(e){e.camelCase="camelCase",e.kebabCase="kebabCase",e.lowerCase="lowerCase",e.lowerCaseWithoutOnPrefix="lowerCaseWithoutOnPrefix"}(Mt||(Mt={}));class Pt{get elementSource(){return this._elementSource}set elementSource(e){this._elementSource=e}get subscribedEvents(){return this._subscribedEvents}get subscribedEventNames(){return this._subscribedEvents.map((e=>e.name))}constructor(e){this._subscribedEvents=[],this.eventNamingStyle=Mt.camelCase,this._elementSource=e||document.createElement("div")}dispose(){this.unsubscribeAll(),this._subscribedEvents=[],window.clearTimeout(this._timer),this._elementSource?.remove(),this._elementSource=null}dispatchCustomEvent(e,t,i=!0,n=!0,s){const r={bubbles:i,cancelable:n};t&&(r.detail=t);const o=new CustomEvent(e,r);return"function"==typeof s&&s(o),this._elementSource?.dispatchEvent(o)}getEventNameByNamingConvention(e,t){let i="";switch(this.eventNamingStyle){case Mt.camelCase:i=""!==t?`${t}${Be(e)}`:e;break;case Mt.kebabCase:i=""!==t?`${t}-${Ve(e)}`:Ve(e);break;case Mt.lowerCase:i=`${t}${e}`.toLowerCase();break;case Mt.lowerCaseWithoutOnPrefix:i=`${t}${e.replace(/^on/,"")}`.toLowerCase()}return i}publish(e,t,i,n){const s=this.getEventNameByNamingConvention(e,"");return i?new Promise((e=>{window.clearTimeout(this._timer),this._timer=window.setTimeout((()=>e(this.dispatchCustomEvent(s,t,!0,!0,n))),i)})):this.dispatchCustomEvent(s,t,!0,!0,n)}subscribe(e,t){e=Array.isArray(e)?e:[e];const i=[];return e.forEach((e=>{const n=this.getEventNameByNamingConvention(e,"");this._elementSource.addEventListener(n,(e=>t.call(null,e.detail))),this._subscribedEvents.push({name:n,listener:t}),i.push((()=>this.unsubscribe(n,t)))})),{unsubscribe:()=>i.forEach((e=>e()))}}subscribeEvent(e,t){const i=this.getEventNameByNamingConvention(e,"");return this._elementSource.addEventListener(i,t),this._subscribedEvents.push({name:i,listener:t}),{unsubscribe:()=>this.unsubscribe(i,t)}}unsubscribe(e,t,i=!0){const n=this.getEventNameByNamingConvention(e,"");this._elementSource.removeEventListener(n,t),i&&this.removeSubscribedEventWhenFound(e,t)}unsubscribeAll(e){if(Array.isArray(e)){let t;do{t=e.pop(),t?.dispose?t.dispose():t?.unsubscribe&&t.unsubscribe()}while(t)}else{let e=this._subscribedEvents.pop();for(;e;)this.unsubscribe(e.name,e.listener,!1),e=this._subscribedEvents.pop()}}removeSubscribedEventWhenFound(e,t){const i=this._subscribedEvents.findIndex((i=>i.name===e&&i.listener===t));i>=0&&this._subscribedEvents.splice(i,1)}}const Nt=function(e){var t=document,i=e.container||t.createElement("div"),n=e.preventSubmit||0;i.id=i.id||"autocomplete-"+_();var s,r,o=i.style,a=e.debounceWaitMs||0,l=e.disableAutoSelect||!1,c=i.parentElement,h=[],d="",u=2,p=e.showOnFocus,f=0,m=!1,g=!1;if(void 0!==e.minLength&&(u=e.minLength),!e.input)throw new Error("input undefined");var v=e.input;function _(){return Date.now().toString(36)+Math.random().toString(36).substring(2)}function b(){var e=i.parentNode;e&&e.removeChild(i)}function y(){r&&window.clearTimeout(r)}function C(){return!!i.parentNode}function w(){f++,h=[],d="",s=void 0,v.setAttribute("aria-activedescendant",""),v.setAttribute("aria-expanded","false"),b()}function S(){i.textContent="",v.setAttribute("aria-activedescendant","");var n=function(e,i,n){var s=t.createElement("div");return s.textContent=e.label||"",s};e.render&&(n=e.render);var r=function(e,i){var n=t.createElement("div");return n.textContent=e,n};e.renderGroup&&(r=e.renderGroup);var a=t.createDocumentFragment(),l=_();if(h.forEach((function(t,o){if(t.group&&t.group!==l){l=t.group;var c=r(t.group,d);c&&(c.className+=" group",a.appendChild(c))}var h=n(t,d,o);h&&(h.id=i.id+"_"+o,h.setAttribute("role","option"),h.addEventListener("click",(function(i){g=!0;try{e.onSelect(t,v)}finally{g=!1}w(),i.preventDefault(),i.stopPropagation()})),t===s&&(h.className+=" selected",h.setAttribute("aria-selected","true"),v.setAttribute("aria-activedescendant",h.id)),a.appendChild(h))})),i.appendChild(a),h.length<1){if(!e.emptyMsg)return void w();var u=t.createElement("div");u.id=i.id+"_"+_(),u.className="empty",u.textContent=e.emptyMsg,i.appendChild(u),v.setAttribute("aria-activedescendant",u.id)}i.parentNode||(c||t.body).appendChild(i),function(){if(C()){v.setAttribute("aria-expanded","true"),o.height="auto",o.width=v.offsetWidth+"px";var n,s=0;r(),r(),e.customize&&n&&e.customize(v,n,i,s)}function r(){var e=t.documentElement,i=e.clientTop||t.body.clientTop||0,r=e.clientLeft||t.body.clientLeft||0,a=window.pageYOffset||e.scrollTop,l=window.pageXOffset||e.scrollLeft,c=(n=v.getBoundingClientRect()).top+v.offsetHeight+a-i,h=n.left+l-r;o.top=c+"px",o.left=h+"px",(s=window.innerHeight-(n.top+v.offsetHeight))<0&&(s=0),o.top=c+"px",o.bottom="",o.left=h+"px",o.maxHeight=s+"px"}}(),O()}function E(){C()&&S()}function x(){E()}function T(e){e.target!==i?E():e.preventDefault()}function A(){g||j(0)}function O(){var e=i.getElementsByClassName("selected");if(e.length>0){var t=e[0],n=t.previousElementSibling;if(n&&-1!==n.className.indexOf("group")&&!n.previousElementSibling&&(t=n),t.offsetTop<i.scrollTop)i.scrollTop=t.offsetTop;else{var s=t.offsetTop+t.offsetHeight,r=i.scrollTop+i.offsetHeight;s>r&&(i.scrollTop+=s-r)}}}function I(e){h.length>0&&(function(e){var n=t.getElementById(i.id+"_"+e);n&&(n.classList.remove("selected"),n.removeAttribute("aria-selected"),v.removeAttribute("aria-activedescendant"))}(e),function(e){var n=t.getElementById(i.id+"_"+e);n&&(n.classList.add("selected"),n.setAttribute("aria-selected","true"),v.setAttribute("aria-activedescendant",n.id))}(h.indexOf(s)),O())}function k(t){var i=t.key;switch(i){case"ArrowUp":case"ArrowDown":case"Escape":!function(e,t){var i=C();if("Escape"===t)w();else{if(!i||h.length<1)return;"ArrowUp"===t?function(){var e=h.indexOf(s);s=-1===e?void 0:h[(e+h.length-1)%h.length],I(e)}():function(){var e=h.indexOf(s);s=h.length<1?void 0:-1===e?h[0]:h[(e+1)%h.length],I(e)}()}e.preventDefault(),i&&e.stopPropagation()}(t,i);break;case"Enter":!function(t){if(s){2===n&&t.preventDefault(),g=!0;try{e.onSelect(s,v)}finally{g=!1}w()}1===n&&t.preventDefault()}(t)}}function D(){p&&j(1)}function j(e){v.value.length>=u||1===e?(y(),r=window.setTimeout((function(){return R(v.value,e,v.selectionStart||0)}),0===e||2===e?a:0)):w()}function R(t,i,n){if(!m){var r=++f;e.fetch(t,(function(e){f===r&&e&&(d=t,s=(h=e).length<1||l?void 0:h[0],S())}),i,n)}}function L(t){e.keyup?e.keyup({event:t,fetch:function(){return j(0)}}):C()||"ArrowDown"!==t.key||j(0)}function M(t){e.click&&e.click({event:t,fetch:function(){return j(2)}})}function P(){setTimeout((function(){t.activeElement!==v&&w()}),200)}return i.className=[i.className,"autocomplete",e.className||""].join(" ").trim(),i.setAttribute("role","listbox"),v.setAttribute("role","combobox"),v.setAttribute("aria-expanded","false"),v.setAttribute("aria-autocomplete","list"),v.setAttribute("aria-controls",i.id),v.setAttribute("aria-owns",i.id),v.setAttribute("aria-activedescendant",""),v.setAttribute("aria-haspopup","listbox"),o.position="absolute",i.addEventListener("mousedown",(function(e){e.stopPropagation(),e.preventDefault()})),i.addEventListener("focus",(function(){return v.focus()})),b(),v.addEventListener("keyup",L),v.addEventListener("click",M),v.addEventListener("keydown",k),v.addEventListener("input",A),v.addEventListener("blur",P),v.addEventListener("focus",D),window.addEventListener("resize",x),t.addEventListener("scroll",T,!0),{destroy:function(){v.removeEventListener("focus",D),v.removeEventListener("keyup",L),v.removeEventListener("click",M),v.removeEventListener("keydown",k),v.removeEventListener("input",A),v.removeEventListener("blur",P),window.removeEventListener("resize",x),t.removeEventListener("scroll",T,!0),v.removeAttribute("role"),v.removeAttribute("aria-expanded"),v.removeAttribute("aria-autocomplete"),v.removeAttribute("aria-controls"),v.removeAttribute("aria-activedescendant"),v.removeAttribute("aria-owns"),v.removeAttribute("aria-haspopup"),y(),w(),m=!0},fetch:function(){R(v.value,3,v.selectionStart||0)}}};class Ft{constructor(){this._boundedEvents=[]}get boundedEvents(){return this._boundedEvents}dispose(){this.unbindAll(),this._boundedEvents=[]}bind(e,t,i,n,s=""){const r=Array.isArray(t)?t:[t];if(e?.forEach)e.forEach((e=>{for(const t of r)e.addEventListener(t,i,n),this._boundedEvents.push({element:e,eventName:t,listener:i,groupName:s})}));else if(e)for(const t of r)e.addEventListener(t,i,n),this._boundedEvents.push({element:e,eventName:t,listener:i,groupName:s})}unbind(e,t,i){const n=Array.isArray(e)?e:[e],s=Array.isArray(t)?t:[t];for(const e of s)for(const t of n)"function"==typeof t?.removeEventListener&&t.removeEventListener(e,i)}unbindByEventName(e,t){const i=this._boundedEvents.find((i=>i.element===e&&i.eventName===t));i&&this.unbind(i.element,i.eventName,i.listener)}unbindAll(e){if(e){const t=Array.isArray(e)?e:[e];for(let e=this._boundedEvents.length-1;e>=0;--e){const i=this._boundedEvents[e];if(t.some((e=>e===i.groupName))){const{element:t,eventName:n,listener:s}=i;this.unbind(t,n,s),this._boundedEvents.splice(e,1)}}}else for(;this._boundedEvents.length>0;){const e=this._boundedEvents.pop(),{element:t,eventName:i,listener:n}=e;this.unbind(t,i,n)}}}var Ht=Object.prototype.hasOwnProperty;function Bt(e,t){var i,n;if(e===t)return!0;if(e&&t&&(i=e.constructor)===t.constructor){if(i===Date)return e.getTime()===t.getTime();if(i===RegExp)return e.toString()===t.toString();if(i===Array){if((n=e.length)===t.length)for(;n--&&Bt(e[n],t[n]););return-1===n}if(!i||"object"==typeof e){for(i in n=0,e){if(Ht.call(e,i)&&++n&&!Ht.call(t,i))return!1;if(!(i in t)||!Bt(e[i],t[i]))return!1}return Object.keys(t).length===n}}return e!=e&&t!=t}function zt(e,t){const i=t.fetch;i&&(t.fetch=(t,n,s,r)=>{e.classList.add("slick-autocomplete-loading");const o=n;i(t,(t=>{o(t),e.classList.remove("slick-autocomplete-loading")}),s,r)})}function Vt(e,t,i,n){const{oldVal:s,newVal:r,columnDef:o,selectedSettings:a,updatePickerUI:l}=n;if(s!==r){const n=e.type||o.type,s=o.outputType||e.type||o.type||b.dateUtc,c=Array.isArray(r)?r:[r||""],h=[],d=It(b.dateIso),u=n?It(n):void 0;for(const e of c){const t=e instanceof Date?e:Dt(e,u);t&&h.push(t)}const p=a??{dates:[h.map((e=>Tt(e,d))).join(":")],month:h[0]?.getMonth(),year:h[0]?.getFullYear(),time:"ISO8601"===u||(u||"").toLowerCase().includes("h")?Tt(h[0],"HH:mm"):void 0};Bt(i.settings.selected,p)||(i.settings.selected=p,l&&i?.update&&i.update({dates:!0,month:!0,year:!0,time:!0})),t.value=c.length?h.map((e=>kt(e,void 0,s))).join(" â "):""}}function Wt(e,t){const i=Z("select",{className:"form-control"});for(const n of e){const e=document.createElement("option");e.value=n.operator,t.applyHtmlCode(e,`${he(n.operatorAlt||n.operator,3)}${n.descAlt||n.desc}`),i.appendChild(e)}return i}async function $t(e,t,i,n,s){const r=t?.filter??{},o=r?.collectionOptions??{};let a=null;if(e){const l=n?.isObservable(e)??!1;l&&n&&(a=await I(n,e));const c=await e;if(Array.isArray(c)?a=c:c?.status>=200&&c.status<300&&"function"==typeof c.json?a=await c.json():c&&c.content&&(a=c.content),!Array.isArray(a)&&o?.collectionInsideObjectProperty&&(a=H(a||c,o.collectionInsideObjectProperty||"")),!Array.isArray(a))throw new Error('Something went wrong while trying to pull the collection from the "collectionAsync" call in the Filter, the collection is not a valid array.');r.collection=a,i(a),l&&function(e,t,i,n){const s=e?.filter??{},r=i?.createSubject();s.collectionAsync=r,n&&r&&n.push(r.subscribe((i=>function(e,t,i){const n=t?.filter??{},s=n?.collectionOptions??{};if(s&&s.collectionInsideObjectProperty&&(e=H(e,s.collectionInsideObjectProperty)),!Array.isArray(e))throw new Error('Something went wrong while trying to pull the collection from the "collectionAsync" call in the Filter, the collection is not a valid array.');n.collection=e,i(e)}(i,e,t))))}(t,i,n,s)}return a}function Ut(e,t,i,n,s){if(n?.enableTranslate&&s?.translate){const t=B(n);return s.translate(`${t}${e}`)}const r=n.locales||m.locales;return r?.[t]??i}function qt(e,t){return[{operator:"",desc:""},{operator:"=",desc:Ut("EQUAL_TO","TEXT_EQUAL_TO","Equal to",e,t)},{operator:"<",desc:Ut("LESS_THAN","TEXT_LESS_THAN","Less than",e,t)},{operator:"<=",desc:Ut("LESS_THAN_OR_EQUAL_TO","TEXT_LESS_THAN_OR_EQUAL_TO","Less than or equal to",e,t)},{operator:">",desc:Ut("GREATER_THAN","TEXT_GREATER_THAN","Greater than",e,t)},{operator:">=",desc:Ut("GREATER_THAN_OR_EQUAL_TO","TEXT_GREATER_THAN_OR_EQUAL_TO","Greater than or equal to",e,t)},{operator:"<>",desc:Ut("NOT_EQUAL_TO","TEXT_NOT_EQUAL_TO","Not equal to",e,t)}]}function Gt(e,t,i){if(e.compoundOperatorAltTexts)for(const n of t)if(e.compoundOperatorAltTexts.hasOwnProperty(i)){const t=e.compoundOperatorAltTexts[i][n.operator];n.operatorAlt=t?.operatorAlt||"",n.descAlt=t?.descAlt||""}}var Kt=Object.defineProperty,Yt=Object.getOwnPropertySymbols,Xt=Object.prototype.hasOwnProperty,Zt=Object.prototype.propertyIsEnumerable,Qt=(e,t,i)=>t in e?Kt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,Jt=(e,t)=>{for(var i in t||(t={}))Xt.call(t,i)&&Qt(e,i,t[i]);if(Yt)for(var i of Yt(t))Zt.call(t,i)&&Qt(e,i,t[i]);return e},ei=(e,t,i)=>(Qt(e,"symbol"!=typeof t?t+"":t,i),i);const ti={calendar:"vanilla-calendar",calendarDefault:"vanilla-calendar_default",calendarMultiple:"vanilla-calendar_multiple",calendarMonth:"vanilla-calendar_month",calendarYear:"vanilla-calendar_year",calendarHidden:"vanilla-calendar_hidden",calendarToInput:"vanilla-calendar_to-input",calendarToInputTop:"vanilla-calendar_to-input_top",calendarToInputBottom:"vanilla-calendar_to-input_bottom",controls:"vanilla-calendar-controls",grid:"vanilla-calendar-grid",gridDisabled:"vanilla-calendar-grid_disabled",column:"vanilla-calendar-column",columnMonth:"vanilla-calendar-column_month",columnYear:"vanilla-calendar-column_year",header:"vanilla-calendar-header",headerContent:"vanilla-calendar-header__content",month:"vanilla-calendar-month",monthDisabled:"vanilla-calendar-month_disabled",year:"vanilla-calendar-year",yearDisabled:"vanilla-calendar-year_disabled",arrow:"vanilla-calendar-arrow",arrowPrev:"vanilla-calendar-arrow_prev",arrowNext:"vanilla-calendar-arrow_next",wrapper:"vanilla-calendar-wrapper",content:"vanilla-calendar-content",week:"vanilla-calendar-week",weekDay:"vanilla-calendar-week__day",weekDayWeekend:"vanilla-calendar-week__day_weekend",days:"vanilla-calendar-days",daysSelecting:"vanilla-calendar-days_selecting",months:"vanilla-calendar-months",monthsSelecting:"vanilla-calendar-months_selecting",monthsMonth:"vanilla-calendar-months__month",monthsMonthSelected:"vanilla-calendar-months__month_selected",monthsMonthDisabled:"vanilla-calendar-months__month_disabled",years:"vanilla-calendar-years",yearsSelecting:"vanilla-calendar-years_selecting",yearsYear:"vanilla-calendar-years__year",yearsYearSelected:"vanilla-calendar-years__year_selected",yearsYearDisabled:"vanilla-calendar-years__year_disabled",time:"vanilla-calendar-time",timeContent:"vanilla-calendar-time__content",timeHours:"vanilla-calendar-time__hours",timeMinutes:"vanilla-calendar-time__minutes",timeKeeping:"vanilla-calendar-time__keeping",timeRanges:"vanilla-calendar-time__ranges",timeRange:"vanilla-calendar-time__range",day:"vanilla-calendar-day",dayHoverFirst:"vanilla-calendar-day_hover-first",dayHoverLast:"vanilla-calendar-day_hover-last",dayHoverIntermediate:"vanilla-calendar-day_hover-intermediate",daySelectedFirst:"vanilla-calendar-day_selected-first",daySelectedLast:"vanilla-calendar-day_selected-last",daySelectedIntermediate:"vanilla-calendar-day_selected-intermediate",dayPopup:"vanilla-calendar-day__popup",dayBtn:"vanilla-calendar-day__btn",dayBtnPrev:"vanilla-calendar-day__btn_prev",dayBtnNext:"vanilla-calendar-day__btn_next",dayBtnToday:"vanilla-calendar-day__btn_today",dayBtnSelected:"vanilla-calendar-day__btn_selected",dayBtnHover:"vanilla-calendar-day__btn_hover",dayBtnDisabled:"vanilla-calendar-day__btn_disabled",dayBtnWeekend:"vanilla-calendar-day__btn_weekend",dayBtnHoliday:"vanilla-calendar-day__btn_holiday",weekNumbers:"vanilla-calendar-week-numbers",weekNumbersTitle:"vanilla-calendar-week-numbers__title",weekNumbersContent:"vanilla-calendar-week-numbers__content",weekNumber:"vanilla-calendar-week-number",isFocus:"vanilla-calendar-is-focus"},ii=e=>`<div class="${e.controls}"><#ArrowPrev /><#ArrowNext /></div><div class="${e.grid}"><#Multiple><div class="${e.column}"><div class="${e.header}"><div class="${e.headerContent}"><#Month /><#Year /></div></div><div class="${e.wrapper}"><#WeekNumbers /><div class="${e.content}"><#Week /><#Days /></div></div></div><#/Multiple></div><#ControlTime />`,ni=e=>`<div class="${e.header}"><div class="${e.headerContent}"><#Month /><#Year /></div></div><div class="${e.wrapper}"><div class="${e.content}"><#Months /></div></div>`,si=e=>`<div class="${e.header}"><#ArrowPrev /><div class="${e.headerContent}"><#Month /><#Year /></div><#ArrowNext /></div><div class="${e.wrapper}"><div class="${e.content}"><#Years /></div></div>`;class ri{constructor(){var e;ei(this,"isInit",!1),ei(this,"isInputInit",!1),ei(this,"input",!1),ei(this,"type","default"),ei(this,"months",2),ei(this,"jumpMonths",1),ei(this,"jumpToSelectedDate",!1),ei(this,"toggleSelected",!0),ei(this,"date",{min:"1970-01-01",max:"2470-12-31",today:new Date}),ei(this,"settings",{lang:"en",iso8601:!0,range:{min:void 0,max:void 0,disablePast:!1,disableGaps:!1,edgesOnly:!1,disableAllDays:!1,disableWeekday:void 0,disabled:void 0,enabled:void 0},selection:{day:"single",month:!0,year:!0,time:!1,controlTime:"all",stepHours:1,stepMinutes:1,cancelableDay:!0},selected:{dates:void 0,month:void 0,year:void 0,holidays:void 0,time:void 0},visibility:{theme:"system",themeDetect:"html[data-theme]",monthShort:!0,weekNumbers:!1,weekend:!0,today:!0,disabled:!1,daysOutside:!0,positionToInput:"left"}}),ei(this,"locale",{months:[],weekday:[]}),ei(this,"sanitizer",(e=>e)),ei(this,"actions",{clickDay:null,clickWeekNumber:null,clickMonth:null,clickYear:null,clickArrow:null,changeTime:null,changeToInput:null,getDays:null,getMonths:null,getYears:null,initCalendar:null,updateCalendar:null,destroyCalendar:null,showCalendar:null,hideCalendar:null}),ei(this,"popups",{}),ei(this,"CSSClasses",Jt({},ti)),ei(this,"DOMTemplates",{default:(e=this.CSSClasses,`<div class="${e.header}"><#ArrowPrev /><div class="${e.headerContent}"><#Month /><#Year /></div><#ArrowNext /></div><div class="${e.wrapper}"><#WeekNumbers /><div class="${e.content}"><#Week /><#Days /></div></div><#ControlTime />`),multiple:ii(this.CSSClasses),month:ni(this.CSSClasses),year:si(this.CSSClasses)}),ei(this,"HTMLElement"),ei(this,"HTMLOriginalElement"),ei(this,"HTMLInputElement"),ei(this,"rangeMin"),ei(this,"rangeMax"),ei(this,"rangeDisabled"),ei(this,"rangeEnabled"),ei(this,"selectedDates"),ei(this,"selectedHolidays"),ei(this,"selectedMonth"),ei(this,"selectedYear"),ei(this,"selectedHours"),ei(this,"selectedMinutes"),ei(this,"selectedKeeping"),ei(this,"selectedTime"),ei(this,"currentType"),ei(this,"correctMonths"),ei(this,"viewYear"),ei(this,"dateMin"),ei(this,"dateMax")}}const oi=e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`,ai=e=>new Date(`${e}T00:00:00`),li=e=>e.reduce(((e,t)=>{if(t instanceof Date||"number"==typeof t){const i=t instanceof Date?t:new Date(t);e.push(i.toISOString().substring(0,10))}else t.match(/^(\d{4}-\d{2}-\d{2})$/g)?e.push(t):t.replace(/(\d{4}-\d{2}-\d{2}).*?(\d{4}-\d{2}-\d{2})/g,((t,i,n)=>{const s=ai(i),r=ai(n),o=new Date(s.getTime());for(;o<=r;o.setDate(o.getDate()+1))e.push(oi(o));return t}));return e}),[]),ci=()=>{const e=new Date;return new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().substring(0,10)},hi=e=>e?{0:"12",13:"01",14:"02",15:"03",16:"04",17:"05",18:"06",19:"07",20:"08",21:"09",22:"10",23:"11"}[Number(e)]||String(e):"",di='The calendar has not been initialized, please initialize it using the "init()" method first.',ui=e=>{e.currentType=e.type,(e=>{var t;if(e.jumpToSelectedDate&&(null==(t=e.settings.selected.dates)?void 0:t.length)&&void 0===e.settings.selected.month&&void 0===e.settings.selected.year){const t=ai(li(e.settings.selected.dates)[0]);e.settings.selected.month=t.getMonth(),e.settings.selected.year=t.getFullYear()}const i=void 0!==e.settings.selected.month&&Number(e.settings.selected.month)>=0&&Number(e.settings.selected.month)<12,n=void 0!==e.settings.selected.year&&Number(e.settings.selected.year)>=0&&Number(e.settings.selected.year)<=9999;e.selectedMonth=i?Number(e.settings.selected.month):e.date.today.getMonth(),e.selectedYear=n?Number(e.settings.selected.year):e.date.today.getFullYear(),e.viewYear=e.selectedYear})(e),(e=>{var t,i,n;"today"===e.date.min&&(e.date.min=ci()),"today"===e.date.max&&(e.date.max=ci()),"today"===e.settings.range.min&&(e.settings.range.min=ci()),"today"===e.settings.range.max&&(e.settings.range.max=ci()),e.settings.range.min=e.settings.range.min?ai(e.date.min)>=ai(e.settings.range.min)?e.date.min:e.settings.range.min:e.date.min,e.settings.range.max=e.settings.range.max?ai(e.date.max)<=ai(e.settings.range.max)?e.date.max:e.settings.range.max:e.date.max;const s=e.settings.range.disablePast&&!e.settings.range.disableAllDays&&ai(e.settings.range.min)<e.date.today;e.rangeMin=s||e.settings.range.disableAllDays?oi(e.date.today):e.settings.range.min,e.rangeMax=e.settings.range.disableAllDays?oi(e.date.today):e.settings.range.max,e.rangeDisabled=e.settings.range.disabled&&!e.settings.range.disableAllDays?li(e.settings.range.disabled):e.settings.range.disableAllDays?[e.rangeMin]:[],e.rangeDisabled.length>1&&e.rangeDisabled.sort(((e,t)=>+new Date(e)-+new Date(t))),e.rangeEnabled=e.settings.range.enabled?li(e.settings.range.enabled):[],(null==(t=e.rangeEnabled)?void 0:t[0])&&(null==(i=e.rangeDisabled)?void 0:i[0])&&(e.rangeDisabled=e.rangeDisabled.filter((t=>!e.rangeEnabled.includes(t)))),e.rangeEnabled.length>1&&e.rangeEnabled.sort(((e,t)=>+new Date(e)-+new Date(t))),(null==(n=e.rangeEnabled)?void 0:n[0])&&e.settings.range.disableAllDays&&(e.rangeMin=e.rangeEnabled[0],e.rangeMax=e.rangeEnabled[e.rangeEnabled.length-1])})(e),(e=>{var t,i;e.selectedDates=(null==(t=e.settings.selected.dates)?void 0:t[0])?li(e.settings.selected.dates):[],e.selectedHolidays=(null==(i=e.settings.selected.holidays)?void 0:i[0])?li(e.settings.selected.holidays):[]})(e),(e=>{e.dateMin=e.settings.visibility.disabled?ai(e.date.min):ai(e.rangeMin),e.dateMax=e.settings.visibility.disabled?ai(e.date.max):ai(e.rangeMax)})(e),(e=>{const t=!0===e.settings.selection.time||12===e.settings.selection.time;if(t||24===e.settings.selection.time){let i=!1;if("string"==typeof e.settings.selected.time){const n=t?/^([0-9]|0[1-9]|1[0-2]):([0-5][0-9])|(AM|PM)/g:/^([0-1]?[0-9]|2[0-3]):([0-5][0-9])/g;e.settings.selected.time.replace(n,((n,s,r,o)=>(s&&r&&(i=!0,e.selectedHours=s,e.selectedMinutes=r),o&&t?e.selectedKeeping=o:t&&(e.selectedKeeping="AM"),"")))}!i&&t?(e.selectedHours=hi(String(e.date.today.getHours())),e.selectedMinutes=String(e.date.today.getMinutes()),e.selectedKeeping=Number(e.date.today.getHours())>=12?"PM":"AM"):i||(e.selectedHours=String(e.date.today.getHours()),e.selectedMinutes=String(e.date.today.getMinutes())),e.selectedHours=Number(e.selectedHours)<10?`0${Number(e.selectedHours)}`:`${e.selectedHours}`,e.selectedMinutes=Number(e.selectedMinutes)<10?`0${Number(e.selectedMinutes)}`:`${e.selectedMinutes}`,e.selectedTime=`${e.selectedHours}:${e.selectedMinutes}${e.selectedKeeping?` ${e.selectedKeeping}`:""}`}else if(e.settings.selection.time)throw new Error("The value of the time property can be: false, true, 12 or 24.")})(e),(e=>{e.correctMonths="multiple"===e.type?1===e.months?2:e.months>12?12:e.months:1})(e)},pi=({arrowPrev:e,arrowNext:t,isPrevHidden:i,isNextHidden:n})=>{e.style.visibility=i?"hidden":"",t.style.visibility=n?"hidden":""},fi=e=>{var t,i;if("month"===e.currentType)return;const n=null==(t=e.HTMLElement)?void 0:t.querySelector(`.${e.CSSClasses.arrowPrev}`),s=null==(i=e.HTMLElement)?void 0:i.querySelector(`.${e.CSSClasses.arrowNext}`);n&&s&&{default:()=>{const t=ai(oi(new Date(e.selectedYear,e.selectedMonth,1))),i=new Date(t.getTime()),r=new Date(t.getTime());i.setMonth(i.getMonth()-e.jumpMonths),r.setMonth(r.getMonth()+e.jumpMonths),e.settings.selection.year||(e.dateMin.setFullYear(t.getFullYear()),e.dateMax.setFullYear(t.getFullYear()));const o=!e.settings.selection.month||i.getFullYear()<e.dateMin.getFullYear()||i.getFullYear()===e.dateMin.getFullYear()&&i.getMonth()<e.dateMin.getMonth(),a=!e.settings.selection.month||r.getFullYear()>e.dateMax.getFullYear()||r.getFullYear()===e.dateMax.getFullYear()&&r.getMonth()>e.dateMax.getMonth();pi({arrowPrev:n,arrowNext:s,isPrevHidden:o,isNextHidden:a})},year:()=>{pi({arrowPrev:n,arrowNext:s,isPrevHidden:e.dateMin.getFullYear()&&e.viewYear-7<=e.dateMin.getFullYear(),isNextHidden:e.dateMax.getFullYear()&&e.viewYear+7>=e.dateMax.getFullYear()})}}["multiple"===e.currentType?"default":e.currentType]()},mi=(e,t)=>{if(!e)return null;const i=ai(e),n=t?i.getDay()||7:i.getDay();i.setDate(i.getDate()+4-n);const s=new Date(i.getFullYear(),0,1),r=Math.ceil(((+i-+s)/864e5+1)/7);return{year:i.getFullYear(),week:r}};function gi(e){if(!e||!e.getBoundingClientRect)return{top:0,bottom:0,left:0,right:0};const t=e.getBoundingClientRect(),i=document.documentElement;return{bottom:t.bottom,right:t.right,top:t.top+window.scrollY-i.clientTop,left:t.left+window.scrollX-i.clientLeft}}function vi(){return{vw:Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),vh:Math.max(document.documentElement.clientHeight||0,window.innerHeight||0)}}function _i(e,t,i=5){const n={top:!0,bottom:!0,left:!0,right:!0},s=[];if(!t||!e)return{canShow:n,parentPositions:s};const{bottom:r,top:o}=function(e){const{top:t,left:i}={left:window.scrollX||document.documentElement.scrollLeft||0,top:window.scrollY||document.documentElement.scrollTop||0},{top:n,left:s}=gi(e),{vh:r,vw:o}=vi(),a=n-t,l=s-i;return{top:a,bottom:r-(a+e.clientHeight),left:l,right:o-(l+e.clientWidth)}}(e),{top:a,left:l}=gi(e),{height:c,width:h}=t.getBoundingClientRect(),{vh:d,vw:u}=vi(),p=u/2,f=d/2;return[{condition:a<f,position:"top"},{condition:a>f,position:"bottom"},{condition:l<p,position:"left"},{condition:l>p,position:"right"}].forEach((({condition:e,position:t})=>{e&&s.push(t)})),Object.assign(n,{top:c<=o-i,bottom:c<=r-i,left:h<=l,right:h<=u-l}),{canShow:n,parentPositions:s}}const bi=(e,t,i,n)=>{if(e){const s="auto"===i?function(e,t){const i="left";if(!t||!e)return i;const{canShow:n,parentPositions:s}=_i(e,t),r=n.left&&n.right;return(r&&n.bottom?"center":r&&n.top?["top","center"]:Array.isArray(s)?["bottom"===s[0]?"top":"bottom",...s.slice(1)]:s)||i}(e,t):i,r={top:-t.offsetHeight,bottom:e.offsetHeight,left:0,center:e.offsetWidth/2-t.offsetWidth/2,right:e.offsetWidth-t.offsetWidth},o=Array.isArray(s)?s[0]:"bottom",a=Array.isArray(s)?s[1]:s;"bottom"===o?(t.classList.remove(n.calendarToInputTop),t.classList.add(n.calendarToInputBottom)):(t.classList.remove(n.calendarToInputBottom),t.classList.add(n.calendarToInputTop));const{top:l,left:c}=gi(e),h=l+r[o];let d=c+r[a];const{vw:u}=vi();if(d+t.clientWidth>u){const e=window.innerWidth-document.body.clientWidth;d=u-t.clientWidth-e}else d<0&&(d=0);Object.assign(t.style,{left:`${d}px`,top:`${h}px`})}},yi=(e,t,i,n,s)=>{const r=t[i].querySelector(`.${e.CSSClasses.dayBtn}`),o=mi(null==r?void 0:r.dataset.calendarDay,e.settings.iso8601);if(!o)return;const a=n.cloneNode(!0);a.innerText=String(o.week),a.dataset.calendarYearWeek=String(o.year),s.appendChild(a)},Ci=(e,t,i,n,s,r,o,a)=>{const l=document.createElement("div");l.className=e.CSSClasses.day;const c=document.createElement("button");c.className=`${e.CSSClasses.dayBtn}${a?` ${a}`:""}`,c.type="button",c.innerText=String(n),c.dataset.calendarDay=r,e.settings.visibility.weekNumbers&&(()=>{const t=mi(r,e.settings.iso8601);t&&(c.dataset.calendarWeekNumber=String(t.week))})(),o?e.settings.visibility.daysOutside&&l.appendChild(c):l.appendChild(c),((e,t,i)=>{var n,s,r,o,a;const l=null==(n=e.settings.range.disableWeekday)?void 0:n.includes(i),c=e.settings.range.disableAllDays&&!!(null==(s=e.rangeEnabled)?void 0:s[0]);!l&&!c||(null==(r=e.rangeEnabled)?void 0:r.includes(t))||(null==(o=e.rangeDisabled)?void 0:o.includes(t))||(e.rangeDisabled.push(t),null==(a=e.rangeDisabled)||a.sort(((e,t)=>+new Date(e)-+new Date(t))))})(e,r,s),((e,t,i,n,s,r,o)=>{var a,l,c;if((ai(e.rangeMin)>ai(r)||ai(e.rangeMax)<ai(r)||(null==(a=e.rangeDisabled)?void 0:a.includes(r))||!e.settings.selection.month&&o||!e.settings.selection.year&&ai(r).getFullYear()!==t)&&(n.classList.add(e.CSSClasses.dayBtnDisabled),n.tabIndex=-1),e.settings.visibility.today&&oi(e.date.today)===r&&n.classList.add(e.CSSClasses.dayBtnToday),!e.settings.visibility.weekend||0!==s&&6!==s||n.classList.add(e.CSSClasses.dayBtnWeekend),(null==(l=e.selectedHolidays)?void 0:l.includes(r))&&n.classList.add(e.CSSClasses.dayBtnHoliday),(null==(c=e.selectedDates)?void 0:c.includes(r))&&(n.classList.add(e.CSSClasses.dayBtnSelected),e.selectedDates.length>1&&"multiple-ranged"===e.settings.selection.day&&(e.selectedDates[0]===r&&i.classList.add(e.CSSClasses.daySelectedFirst),e.selectedDates[e.selectedDates.length-1]===r&&i.classList.add(e.CSSClasses.daySelectedLast),e.selectedDates[0]!==r&&e.selectedDates[e.selectedDates.length-1]!==r&&i.classList.add(e.CSSClasses.daySelectedIntermediate))),e.settings.range.edgesOnly&&e.selectedDates.length>1&&"multiple-ranged"===e.settings.selection.day){const t=+new Date(e.selectedDates[0]),s=+new Date(e.selectedDates[e.selectedDates.length-1]),o=+new Date(r);o>t&&o<s&&(n.classList.add(e.CSSClasses.dayBtnSelected),i.classList.add(e.CSSClasses.daySelectedIntermediate))}})(e,t,l,c,s,r,o),i.appendChild(l),e.actions.getDays&&e.actions.getDays(n,r,l,c,e)},wi=e=>{const t=e.HTMLElement.querySelectorAll(`.${e.CSSClasses.days}`),i=e.HTMLElement.querySelectorAll(`.${e.CSSClasses.weekNumbers}`),n=new Date(e.selectedYear,e.selectedMonth,1);t.forEach(((t,s)=>{const r=new Date(n);r.setMonth(r.getMonth()+s);const o=r.getMonth(),a=r.getFullYear(),l=new Date(a,o,1),c=new Date(a,o+1,0).getDate(),h=e.settings.iso8601?(0!==l.getDay()?l.getDay():7)-1:l.getDay();e.settings.selection.day&&t.classList.add(e.CSSClasses.daysSelecting),t.textContent="",((e,t,i,n,s)=>{let r=new Date(i,n,0).getDate()-(s-1);const o=0===n?i-1:i,a=0===n?12:n<10?`0${n}`:n;for(let n=s;n>0;n--,r++){const n=`${o}-${a}-${r}`,s=ai(n).getDay();Ci(e,i,t,r,s,n,!0,e.CSSClasses.dayBtnPrev)}})(e,t,a,o,h),((e,t,i,n,s)=>{for(let r=1;r<=i;r++){const i=new Date(n,s,r),o=oi(i),a=i.getDay();Ci(e,n,t,r,a,o,!1,null)}})(e,t,c,a,o),((e,t,i,n,s,r)=>{const o=r+i,a=7*Math.ceil(o/7)-o,l=s+1===12?n+1:n,c=s+1===12?"01":s+2<10?`0${s+2}`:s+2;for(let i=1;i<=a;i++){const s=`${l}-${c}-${i<10?`0${i}`:String(i)}`,r=ai(s).getDay();Ci(e,n,t,i,r,s,!0,e.CSSClasses.dayBtnNext)}})(e,t,c,a,o,h),((e,t,i,n,s)=>{if(!e.settings.visibility.weekNumbers)return;n.textContent="";const r=document.createElement("b");r.className=e.CSSClasses.weekNumbersTitle,r.innerText="#",n.appendChild(r);const o=document.createElement("div");o.className=e.CSSClasses.weekNumbersContent,n.appendChild(o);const a=document.createElement("button");a.type="button",a.className=e.CSSClasses.weekNumber;const l=s.querySelectorAll(`.${e.CSSClasses.day}`),c=Math.ceil((t+i)/7);for(let t=0;t<c;t++)yi(e,l,0===t?6:7*t,a,o)})(e,h,c,i[s],t),((e,t)=>{var i;e.popups&&(null==(i=Object.entries(e.popups))||i.forEach((([i,n])=>((e,t,i,n)=>{const s=e.CSSClasses.dayPopup,r=n.querySelector(`[data-calendar-day="${t}"]`);if(r&&((null==i?void 0:i.modifier)&&r.classList.add(...i.modifier.trim().split(" ")),null==i?void 0:i.html)){const t=r.parentElement,n=document.createElement("div");n.className=s,n.innerHTML=e.sanitizer(i.html),t.appendChild(n),setTimeout((()=>{if(n){const{canShow:e}=_i(t,n),i=5;let s=t.offsetHeight,r=0;e.bottom||(s=-n.offsetHeight-i),e.left&&!e.right&&(r=t.offsetWidth-n.offsetWidth/2),!e.left&&e.right&&(r=n.offsetWidth/2),Object.assign(n.style,{left:`${r}px`,top:`${s}px`})}}))}})(e,i,n,t))))})(e,t)}))},Si=e=>{var t,i;const n=null==(t=e.HTMLElement)?void 0:t.querySelectorAll("[data-calendar-selected-month]"),s=null==(i=e.HTMLElement)?void 0:i.querySelectorAll("[data-calendar-selected-year]");if(!(null==n?void 0:n[0])&&(null==s?void 0:s[0]))return;const r=new Date(e.selectedYear,e.selectedMonth,1);null==n||n.forEach(((t,i)=>((e,t,i,n)=>{const s=new Date(n.setMonth(e.selectedMonth+i)).getMonth(),r=!1===e.settings.selection.month||"only-arrows"===e.settings.selection.month;t.tabIndex=r?-1:0,t.classList.toggle(e.CSSClasses.monthDisabled,r),t.setAttribute("data-calendar-selected-month",String(s)),t.innerText=e.locale.months[s]})(e,t,i,r))),null==s||s.forEach(((t,i)=>((e,t,i,n)=>{const s=new Date(n.setFullYear(e.selectedYear,e.selectedMonth+i)).getFullYear(),r=!1===e.settings.selection.year||"only-arrows"===e.settings.selection.year;t.tabIndex=r?-1:0,t.classList.toggle(e.CSSClasses.yearDisabled,r),t.setAttribute("data-calendar-selected-year",String(s)),t.innerText=String(s)})(e,t,i,r)))},Ei=(e,t)=>{const i=ai(oi(new Date(e.selectedYear,e.selectedMonth,1)));({prev:()=>i.setMonth(i.getMonth()-e.jumpMonths),next:()=>i.setMonth(i.getMonth()+e.jumpMonths)})[t](),[e.selectedMonth,e.selectedYear]=[i.getMonth(),i.getFullYear()],Si(e),fi(e),wi(e)},xi=Object.freeze(Object.defineProperty({__proto__:null,ArrowNext:e=>`<button type="button"class="${e.CSSClasses.arrow} ${e.CSSClasses.arrowNext}"data-calendar-arrow="next"></button>`,ArrowPrev:e=>`<button type="button"class="${e.CSSClasses.arrow} ${e.CSSClasses.arrowPrev}"data-calendar-arrow="prev"></button>`,ControlTime:e=>e.settings.selection.time?`<div class="${e.CSSClasses.time}"></div>`:"",Days:e=>`<div class="${e.CSSClasses.days}"></div>`,Month:e=>`<button type="button"class="${e.CSSClasses.month}"data-calendar-selected-month></button>`,Months:e=>`<div class="${e.CSSClasses.months}"></div>`,Week:e=>`<div class="${e.CSSClasses.week}"></div>`,WeekNumbers:e=>e.settings.visibility.weekNumbers?`<div class="${e.CSSClasses.weekNumbers}"></div>`:"",Year:e=>`<button type="button"class="${e.CSSClasses.year}"data-calendar-selected-year></button>`,Years:e=>`<div class="${e.CSSClasses.years}"></div>`},Symbol.toStringTag,{value:"Module"})),Ti=(e,t)=>t.replace(/[\n\t]/g,"").replace(/<#(?!\/?Multiple)(.*?)>/g,((t,i)=>{const n=(s=i.replace(/[/\s\n\t]/g,""),xi[s]);var s;const r=n?n(e):"";return e.sanitizer(r)})).replace(/[\n\t]/g,""),Ai=(e,t)=>{const{HTMLElement:i,CSSClasses:n,DOMTemplates:s,type:r,currentType:o,correctMonths:a}=e,l=(s,r)=>{if(!t)return;const o=i.querySelector(`.${n.controls}`);o&&i.removeChild(o),i.querySelector(`.${n.grid}`).classList.add(n.gridDisabled);const a=t.closest(`.${n.column}`);a.classList.add(s),a.innerHTML=Ti(e,r)},c={default:()=>{i.classList.add(n.calendarDefault),i.classList.remove(n.calendarMonth,n.calendarYear),i.innerHTML=Ti(e,s.default)},multiple:()=>{a&&(i.classList.add(n.calendarMultiple),i.classList.remove(n.calendarMonth,n.calendarYear),i.innerHTML=((e,t)=>t.replace(/<#Multiple>(.*?)<#\/Multiple>/g,((t,i)=>{let n="";for(let t=0;t<e.correctMonths;t++)n+=i;return e.sanitizer(n)})).replace(/[\n\t]/g,""))(e,Ti(e,s.multiple)))},month:()=>{"multiple"!==r?(i.classList.add(n.calendarMonth),i.classList.remove(n.calendarDefault,n.calendarYear),i.innerHTML=Ti(e,s.month)):l(n.columnMonth,s.month)},year:()=>{"multiple"!==r?(i.classList.add(n.calendarYear),i.classList.remove(n.calendarDefault,n.calendarMonth),i.innerHTML=Ti(e,s.year)):l(n.columnYear,s.year)}};i.classList.add(n.calendar),c[o]()},Oi=(e,t,i,n,s)=>{const r=t.cloneNode(!1);return r.className=`${e.CSSClasses.yearsYear}${i===s?` ${e.CSSClasses.yearsYearSelected}`:n?` ${e.CSSClasses.yearsYearDisabled}`:""}`,r.dataset.calendarYear=String(s),r.title=String(s),r.innerText=String(s),n&&(r.tabIndex=-1),r},Ii=(e,t)=>{const i=(null==t?void 0:t.dataset.calendarSelectedYear)?Number(null==t?void 0:t.dataset.calendarSelectedYear):e.selectedYear;e.currentType="year",Ai(e,t),Si(e),fi(e);const n=e.HTMLElement.querySelector(`.${e.CSSClasses.years}`);if(!e.settings.selection.year||!n)return;n.classList.add(e.CSSClasses.yearsSelecting);const s="multiple"!==e.type||e.selectedYear===i?0:1,r=document.createElement("button");r.type="button";for(let t=e.viewYear-7;t<e.viewYear+8;t++){const o=t<e.dateMin.getFullYear()+s||t>e.dateMax.getFullYear(),a=Oi(e,r,i,o,t);n.appendChild(a),e.actions.getYears&&e.actions.getYears(t,a,e)}},ki=e=>`${e.charAt(0).toUpperCase()}${e.substring(1,e.length)}`.replace(/\./,""),Di=(e,t)=>{const i=new Date(`1978-01-0${t+1}T00:00:00.000Z`).toLocaleString(e.settings.lang,{weekday:"short",timeZone:"UTC"});e.locale.weekday.push(ki(i))},ji=(e,t)=>{const i=new Date(`1978-${t+1<=9?`0${t+1}`:t+1}-01T00:00:00.000Z`).toLocaleString(e.settings.lang,{month:"long",timeZone:"UTC"});e.locale.months.push(ki(i))},Ri=e=>{if("multiple"!==e.type)return 0;const t=e.HTMLElement.querySelectorAll(`.${e.CSSClasses.column}`),i=Array.from(t).findIndex((t=>t.classList.contains(`${e.CSSClasses.columnMonth}`)));return i>0?i:0},Li=(e,t,i,n,s,r)=>{const o=t.cloneNode(!1);return o.className=`${e.CSSClasses.monthsMonth}${i===r?` ${e.CSSClasses.monthsMonthSelected}`:s?` ${e.CSSClasses.monthsMonthDisabled}`:""}`,o.title=n,o.innerText=`${e.settings.visibility.monthShort?n.substring(0,3):n}`,o.dataset.calendarMonth=String(r),s&&(o.tabIndex=-1),o},Mi=(e,t)=>{var i,n;const s=(null==t?void 0:t.dataset.calendarSelectedMonth)?Number(t.dataset.calendarSelectedMonth):e.selectedMonth,r=null==(i=null==t?void 0:t.closest(`.${e.CSSClasses.column}`))?void 0:i.querySelector(`.${e.CSSClasses.year}`),o=r?Number(r.dataset.calendarSelectedYear):e.selectedYear;e.currentType="month",Ai(e,t),Si(e);const a=null==(n=e.HTMLElement)?void 0:n.querySelector(`.${e.CSSClasses.months}`);if(!e.settings.selection.month||!a)return;a.classList.add(e.CSSClasses.monthsSelecting);const l=e.jumpMonths>1?e.locale.months.map(((t,i)=>s-e.jumpMonths*i)).concat(e.locale.months.map(((t,i)=>s+e.jumpMonths*i))).filter((e=>e>=0&&e<=12)):Array.from(Array(12).keys()),c=document.createElement("button");c.type="button";for(let t=0;t<12;t++){const i=e.locale.months[t],n=t<e.dateMin.getMonth()+Ri(e)&&o<=e.dateMin.getFullYear()||t>e.dateMax.getMonth()+Ri(e)&&o>=e.dateMax.getFullYear()||t!==s&&!l.includes(t),r=Li(e,c,s,i,n,t);a.appendChild(r),e.actions.getMonths&&e.actions.getMonths(t,r,e)}},Pi=(e,t)=>e&&t?{0:{AM:"00",PM:"12"},1:{AM:"01",PM:"13"},2:{AM:"02",PM:"14"},3:{AM:"03",PM:"15"},4:{AM:"04",PM:"16"},5:{AM:"05",PM:"17"},6:{AM:"06",PM:"18"},7:{AM:"07",PM:"19"},8:{AM:"08",PM:"20"},9:{AM:"09",PM:"21"},10:{AM:"10",PM:"22"},11:{AM:"11",PM:"23"},12:{AM:"12",PM:"12"}}[Number(e)][t]:"",Ni=(e,t,i)=>e.querySelector(`.${t}${i?` input[name="${i}"]`:""}`),Fi=(e,t,i)=>{e.addEventListener("mouseover",(()=>t.classList.add(i))),e.addEventListener("mouseout",(()=>t.classList.remove(i)))},Hi=(e,t,i,n)=>{({hours:()=>{e.selectedHours=i},minutes:()=>{e.selectedMinutes=i}})[n](),e.selectedTime=`${e.selectedHours}:${e.selectedMinutes}${e.selectedKeeping?` ${e.selectedKeeping}`:""}`,e.actions.changeTime&&e.actions.changeTime(t,e),e.input&&e.HTMLInputElement&&e.actions.changeToInput&&e.actions.changeToInput(t,e)},Bi=(e,t,i,n,s,r)=>{t.addEventListener("input",(t=>{const o=t.target,a=Number(o.value),l=a<10?`0${a}`:`${a}`;if("hours"!==s||12!==r)return i.value=l,void Hi(e,t,l,s);a<r&&a>0?(i.value=l,e.selectedKeeping="AM",n.innerText=e.selectedKeeping,Hi(e,t,l,s)):(0===a?(e.selectedKeeping="AM",n.innerText="AM"):(e.selectedKeeping="PM",n.innerText="PM"),i.value=hi(o.value),Hi(e,t,hi(o.value),s))}))},zi=(e,t,i,n,s,r)=>{i.addEventListener("change",(i=>{const o=i.target,a=Number(o.value),l=a<10?`0${a}`:`${a}`;"hours"===s&&12===r?o.value&&a<=r&&a>0?(o.value=l,t.value=Pi(l,e.selectedKeeping),Hi(e,i,l,s)):o.value&&a<24&&(a>r||0===a)?(0===a?(e.selectedKeeping="AM",n.innerText="AM"):(e.selectedKeeping="PM",n.innerText="PM"),o.value=hi(o.value),t.value=l,Hi(e,i,hi(o.value),s)):o.value=e.selectedHours:o.value&&a<=r&&a>=0?(o.value=l,t.value=l,Hi(e,i,l,s)):"hours"===s?o.value=e.selectedHours:"minutes"===s&&(o.value=e.selectedMinutes)}))},Vi=(e,t,i,n)=>`<label class="${t}"><input type="text"name="${e}"maxlength="2"value="${i}"${n?"disabled":""}></label>`,Wi=(e,t,i,n,s,r)=>`<label class="${t}"><input type="range"name="${e}"min="${i}"max="${n}"step="${s}"value="${r}"></label>`,$i=e=>{const t=[...e.locale.weekday];t[0]&&(e.settings.iso8601&&t.push(t.shift()),e.HTMLElement.querySelectorAll(`.${e.CSSClasses.week}`).forEach((i=>((e,t,i)=>{const n=document.createElement("b");t.textContent="";for(let s=0;s<i.length;s++){const r=i[s],o=n.cloneNode(!0);o.className=`${e.CSSClasses.weekDay}`,o.className=`${e.CSSClasses.weekDay}${e.settings.visibility.weekend&&e.settings.iso8601?5===s||6===s?` ${e.CSSClasses.weekDayWeekend}`:"":!e.settings.visibility.weekend||e.settings.iso8601||0!==s&&6!==s?"":` ${e.CSSClasses.weekDayWeekend}`}`,o.innerText=`${r}`,t.appendChild(o)}})(e,i,t))))},Ui=["light","dark","system"],qi={value:!1,set:()=>{qi.value=!0},check:()=>qi.value},Gi=(e,t)=>Ui.find((i=>{var n;return"system"!==i&&(null==(n=e.getAttribute(t))?void 0:n.includes(i))})),Ki=(e,t)=>{e.dataset.calendarTheme=t},Yi=(e,t)=>{var i;if(i=t,Ki(e.HTMLElement,i.matches?"dark":"light"),"system"!==e.settings.visibility.theme||qi.check())return;const n=t=>{const i=document.querySelectorAll(`.${e.CSSClasses.calendar}`);null==i||i.forEach((e=>Ki(e,t.matches?"dark":"light")))};t.addEventListener?t.addEventListener("change",n):t.addListener(n),qi.set()},Xi=e=>{const t={default:()=>{$i(e),wi(e)},multiple:()=>{$i(e),wi(e)},month:()=>Mi(e),year:()=>Ii(e)};(e=>{if(!Ui.includes(e.settings.visibility.theme))throw new Error('Incorrect name of theme in "settings.visibility.theme".');"not all"!==window.matchMedia("(prefers-color-scheme)").media?{light:()=>Ki(e.HTMLElement,"light"),dark:()=>Ki(e.HTMLElement,"dark"),system:()=>((e,t)=>{const i=e.settings.visibility.themeDetect?document.querySelector(e.settings.visibility.themeDetect):null;if(!i)return void Yi(e,t);const n=e.settings.visibility.themeDetect.replace(/^.*\[(.+)\]/g,((e,t)=>t)),s=Gi(i,n);s?(Ki(e.HTMLElement,s),((e,t,i)=>{new MutationObserver((n=>{for(let s=0;s<n.length;s++)if(n[s].attributeName===i){const n=Gi(t,i);n&&Ki(e.HTMLElement,n);break}})).observe(t,{attributes:!0})})(e,i,n)):Yi(e,t)})(e,window.matchMedia("(prefers-color-scheme: dark)"))}[e.settings.visibility.theme]():Ki(e.HTMLElement,"light")})(e),(e=>{if("define"!==e.settings.lang||!e.locale.weekday[6]||!e.locale.months[11]){if("define"===e.settings.lang)throw new Error('You specified "define" for "settings.lang" but did not provide the required values for "locale.weekday" or "locale.months".');e.locale.weekday=[],e.locale.months=[];for(let t=0;t<7;t++)Di(e,t);for(let t=0;t<12;t++)ji(e,t)}})(e),Ai(e),Si(e),fi(e),(e=>{const t=e.HTMLElement.querySelector(`.${e.CSSClasses.time}`);if(!t)return;const i=!0===e.settings.selection.time?12:e.settings.selection.time,n="range"===e.settings.selection.controlTime,[s,r]=[0,23],[o,a]=[0,59];t.innerHTML=e.sanitizer(`<div class="${e.CSSClasses.timeContent}">${Vi("hours",e.CSSClasses.timeHours,e.selectedHours,n)}${Vi("minutes",e.CSSClasses.timeMinutes,e.selectedMinutes,n)}${12===i?`<button type="button" class="${e.CSSClasses.timeKeeping}"${n?"disabled":""}>${e.selectedKeeping}</button>`:""}</div><div class="${e.CSSClasses.timeRanges}">${Wi("hours",e.CSSClasses.timeRange,s,r,e.settings.selection.stepHours,e.selectedKeeping?Pi(e.selectedHours,e.selectedKeeping):e.selectedHours)}${Wi("minutes",e.CSSClasses.timeRange,o,a,e.settings.selection.stepMinutes,e.selectedMinutes)}</div>`),((e,t,i)=>{const n=24===i?23:i||12,s=Ni(t,e.CSSClasses.timeRange,"hours"),r=Ni(t,e.CSSClasses.timeRange,"minutes"),o=Ni(t,e.CSSClasses.timeHours,"hours"),a=Ni(t,e.CSSClasses.timeMinutes,"minutes"),l=t.querySelector(`.${e.CSSClasses.timeKeeping}`);Fi(s,o,e.CSSClasses.isFocus),Fi(r,a,e.CSSClasses.isFocus),Bi(e,s,o,l,"hours",n),Bi(e,r,a,l,"minutes",0),zi(e,s,o,l,"hours",n),zi(e,r,a,l,"minutes",59),l&&((e,t,i)=>{t.addEventListener("click",(n=>{e.selectedKeeping=t.innerText.includes("AM")?"PM":"AM",t.innerText=e.selectedKeeping,i.value=Pi(e.selectedHours,e.selectedKeeping),Hi(e,n,e.selectedHours,"hours")}))})(e,l,s)})(e,t,i)})(e),t[e.currentType]()},Zi={self:null,rangeMin:void 0,rangeMax:void 0},Qi=()=>{var e;if(!(null==(e=Zi.self)?void 0:e.HTMLElement))return;const{CSSClasses:t}=Zi.self;Zi.self.HTMLElement.querySelectorAll(`.${Zi.self.CSSClasses.dayBtnHover}`).forEach((e=>{var i;e.classList.remove(Zi.self.CSSClasses.dayBtnHover),null==(i=e.parentElement)||i.classList.remove(t.dayHoverIntermediate,t.dayHoverFirst,t.dayHoverLast)}))},Ji=(e,t,i)=>{var n,s,r;if(!(null==(n=Zi.self)?void 0:n.selectedDates))return;const o=oi(e),{CSSClasses:a}=Zi.self;if(null==(s=Zi.self.rangeDisabled)?void 0:s.includes(o))return;const l=null==(r=Zi.self.HTMLElement)?void 0:r.querySelectorAll(`[data-calendar-day="${o}"]`);null==l||l.forEach((e=>{var t;e.classList.add(a.dayBtnHover),null==(t=e.parentElement)||t.classList.add(a.dayHoverIntermediate)})),null==t||t.forEach((e=>{var t;return null==(t=e.parentElement)?void 0:t.classList.add(a.dayHoverFirst)})),null==i||i.forEach((e=>{var t;return null==(t=e.parentElement)?void 0:t.classList.add(a.dayHoverLast)}))},en=e=>{var t;if(!e.target||!(null==(t=Zi.self)?void 0:t.selectedDates))return;if(!e.target.closest(`.${Zi.self.CSSClasses.days}`))return void Qi();const i=e.target.closest("[data-calendar-day]");if(!i)return;const n=i.dataset.calendarDay,s=ai(Zi.self.selectedDates[0]),r=ai(n),o=Zi.self.HTMLElement.querySelectorAll(`[data-calendar-day="${Zi.self.selectedDates[0]}"]`),a=Zi.self.HTMLElement.querySelectorAll(`[data-calendar-day="${n}"]`),[l,c]=s<r?[o,a]:[a,o],[h,d]=s<r?[s,r]:[r,s];Qi();for(let e=new Date(h);e<=d;e.setDate(e.getDate()+1))Ji(e,l,c)},tn=e=>{Zi.self&&"Escape"===e.key&&(Zi.self.selectedDates=[],Zi.self.HTMLElement.removeEventListener("mousemove",en),document.removeEventListener("keydown",tn),Xi(Zi.self))},nn=(e,t)=>{var i;if(t){const n=1===e.selectedDates.length&&e.selectedDates[0].includes(t);e.selectedDates=n&&!e.settings.selection.cancelableDay?[t,t]:n&&e.settings.selection.cancelableDay?[]:e.selectedDates.length>1?[t]:[...e.selectedDates,t],null==(i=e.selectedDates)||i.sort(((e,t)=>+new Date(e)-+new Date(t)))}e.settings.range.disableGaps&&(Zi.rangeMin=Zi.rangeMin?Zi.rangeMin:e.rangeMin,Zi.rangeMax=Zi.rangeMax?Zi.rangeMax:e.rangeMax),Zi.self=e,{set:()=>{e.HTMLElement.addEventListener("mousemove",en),document.addEventListener("keydown",tn),e.settings.range.disableGaps&&(()=>{var e,t,i;if(!(null==(t=null==(e=Zi.self)?void 0:e.selectedDates)?void 0:t[0])||!(null==(i=Zi.self.rangeDisabled)?void 0:i[0]))return;const n=ai(Zi.self.selectedDates[0]),[s,r]=Zi.self.rangeDisabled.map((e=>ai(e))).reduce((([e,t],i)=>[n>=i?i:e,n<i&&null===t?i:t]),[null,null]);s&&(Zi.self.rangeMin=oi(new Date(s.setDate(s.getDate()+1)))),r&&(Zi.self.rangeMax=oi(new Date(r.setDate(r.getDate()-1))))})()},reset:()=>{const[t,i]=[e.selectedDates[0],e.selectedDates[e.selectedDates.length-1]];e.selectedDates=e.selectedDates[0]!==e.selectedDates[e.selectedDates.length-1]?e.settings.range.edgesOnly?[t,i]:li([`${t}:${i}`]):[e.selectedDates[0],e.selectedDates[0]],e.HTMLElement.removeEventListener("mousemove",en),document.removeEventListener("keydown",tn),e.settings.range.disableGaps&&Zi.self&&(Zi.self.rangeMin=Zi.rangeMin,Zi.self.rangeMax=Zi.rangeMax)}}[1===e.selectedDates.length?"set":"reset"]()},sn=(e,t,i)=>{if(!t.dataset.calendarDay)return;const n=t.dataset.calendarDay,s=t.classList.contains(e.CSSClasses.dayBtnSelected);if(s&&!e.settings.selection.cancelableDay)return;let r=!0;void 0!==e.toggleSelected&&(r="function"==typeof e.toggleSelected?e.toggleSelected(e):e.toggleSelected),s&&!r||(e.selectedDates=s?e.selectedDates.filter((e=>e!==n)):i?[...e.selectedDates,n]:[n])},rn=(e,t,i,n,s)=>{const r=e.HTMLElement.querySelectorAll(`.${e.CSSClasses.column}`),o=Array.from(r).findIndex((e=>e.classList.contains(t))),a=Number(r[o].querySelector(`.${i}`).getAttribute(s));return"month"===e.currentType&&o>=0?n-o:"year"===e.currentType&&e.selectedYear!==a?n-1:n},on=(e,t,i,n)=>{if(!e.settings.selection[i])return;const s=t.target,r=e=>s.closest(`.${e}`),o=r(n.header),a=r(n.item),l=r(e.CSSClasses.grid),c=r(e.CSSClasses.column);e.currentType!==i&&o?{year:()=>Ii(e,s),month:()=>Mi(e,s)}[i]():a?((e,t,i,n,s)=>{const r={year:()=>{var i,n;return null==(n=(i=e.actions).clickYear)?void 0:n.call(i,t,e)},month:()=>{var i,n;return null==(n=(i=e.actions).clickMonth)?void 0:n.call(i,t,e)}};({year:()=>{if("multiple"===e.type){const t=rn(e,e.CSSClasses.columnYear,e.CSSClasses.year,Number(s.dataset.calendarYear),"data-calendar-selected-year"),i=e.selectedMonth<e.dateMin.getMonth()&&t<=e.dateMin.getFullYear(),n=e.selectedMonth>e.dateMax.getMonth()&&t>=e.dateMax.getFullYear(),r=t<e.dateMin.getFullYear(),o=t>e.dateMax.getFullYear();i||r?(e.selectedYear=e.dateMin.getFullYear(),e.selectedMonth=e.dateMin.getMonth()):n||o?(e.selectedYear=e.dateMax.getFullYear(),e.selectedMonth=e.dateMax.getMonth()):e.selectedYear=t}else e.selectedYear=Number(s.dataset.calendarYear)},month:()=>{if("multiple"===e.type){const t=rn(e,e.CSSClasses.columnMonth,e.CSSClasses.month,Number(s.dataset.calendarMonth),"data-calendar-selected-month"),i=s.closest(`.${n.column}`).querySelector(`.${e.CSSClasses.year}`);e.selectedYear=Number(i.dataset.calendarSelectedYear);const r=t<e.dateMin.getMonth()&&e.selectedYear<=e.dateMin.getFullYear(),o=t>e.dateMax.getMonth()&&e.selectedYear>=e.dateMax.getFullYear();e.selectedMonth=r?e.dateMin.getMonth():o?e.dateMax.getMonth():t}else e.selectedMonth=Number(s.dataset.calendarMonth)}})[i](),r[i](),e.currentType=e.type,Xi(e)})(e,t,i,n,a):(e.currentType===i&&o||"multiple"===e.type&&e.currentType===i&&l&&!c)&&(e.currentType=e.type,Xi(e))},an=e=>{const t=t=>{((e,t)=>{const i=t.target.closest(`.${e.CSSClasses.arrow}`);i&&(["default","multiple"].includes(e.currentType)?Ei(e,i.dataset.calendarArrow):"year"===e.currentType&&void 0!==e.viewYear&&(e.viewYear+={prev:-15,next:15}[i.dataset.calendarArrow],Ii(e,t.target)),e.actions.clickArrow&&e.actions.clickArrow(t,e))})(e,t),((e,t)=>{var i;if(!e.settings.visibility.weekNumbers||!e.actions.clickWeekNumber)return;const n=t.target.closest(`.${e.CSSClasses.weekNumber}`),s=null==(i=e.HTMLElement)?void 0:i.querySelectorAll("[data-calendar-week-number]");if(!n||!s)return;const r=Number(n.innerText),o=Number(n.dataset.calendarYearWeek),a=Array.from(s).filter((e=>Number(e.dataset.calendarWeekNumber)===r));e.actions.clickWeekNumber(t,r,a,o,e)})(e,t),((e,t)=>{var i;const n=t.target,s=e=>n.closest(`.${e}`),r=s(e.CSSClasses.dayBtn);if(!e.settings.selection.day||!["single","multiple","multiple-ranged"].includes(e.settings.selection.day)||!r)return;({single:()=>sn(e,r,!1),multiple:()=>sn(e,r,!0),"multiple-ranged":()=>nn(e,r.dataset.calendarDay)})[e.settings.selection.day](),null==(i=e.selectedDates)||i.sort(((e,t)=>+new Date(e)-+new Date(t))),e.actions.clickDay&&e.actions.clickDay(t,e),e.input&&e.HTMLInputElement&&e.HTMLElement&&e.actions.changeToInput&&e.actions.changeToInput(t,e);const o=s(e.CSSClasses.dayBtnPrev),a=s(e.CSSClasses.dayBtnNext);({prev:()=>Ei(e,"prev"),next:()=>Ei(e,"next"),default:()=>wi(e)})[o?"prev":a?"next":"default"]()})(e,t),on(e,t,"month",{header:e.CSSClasses.month,item:e.CSSClasses.monthsMonth,column:e.CSSClasses.columnMonth}),on(e,t,"year",{header:e.CSSClasses.year,item:e.CSSClasses.yearsYear,column:e.CSSClasses.columnYear})};return e.HTMLElement.addEventListener("click",t),()=>e.HTMLElement.removeEventListener("click",t)},ln=(e,{year:t,month:i,dates:n,holidays:s,time:r}={})=>{var o;const a=Jt({},e.settings.selected);e.settings.selected.year=t?a.year:e.selectedYear,e.settings.selected.month=i?a.month:e.selectedMonth,e.settings.selected.holidays=s?a.holidays:e.selectedHolidays,e.settings.selected.time=r?a.time:e.selectedTime,e.settings.selected.dates="only-first"===n&&(null==(o=e.selectedDates)?void 0:o[0])?[e.selectedDates[0]]:!0===n?a.dates:e.selectedDates,ui(e),Xi(e),e.settings.selected=a,"multiple-ranged"===e.settings.selection.day&&n&&nn(e)},cn=(e,t=!0)=>{e.isInputInit=!0;const i=document.createElement("div");return i.className=`${e.CSSClasses.calendar} ${e.CSSClasses.calendarToInput} ${e.CSSClasses.calendarHidden}`,e.HTMLElement=i,document.body.appendChild(e.HTMLElement),e.HTMLElement.style.visibility="hidden",t&&queueMicrotask((()=>{bi(e.HTMLInputElement,i,e.settings.visibility.positionToInput,e.CSSClasses),e.HTMLElement.style.visibility="visible",e.show()})),ln(e,{year:!0,month:!0,dates:!0,holidays:!0,time:!0}),e.actions.initCalendar&&e.actions.initCalendar(e),an(e)};class hn extends ri{constructor(e,t){if(super(),ei(this,"init",(()=>{return(e=this).HTMLOriginalElement=e.HTMLElement.cloneNode(!0),e.isInit=!0,e.input?(e=>{const t=[];e.HTMLInputElement=e.HTMLElement;const i=()=>bi(e.HTMLInputElement,e.HTMLElement,e.settings.visibility.positionToInput,e.CSSClasses),n=t=>{"Escape"===t.key&&((null==e?void 0:e.HTMLInputElement)&&(null==e?void 0:e.HTMLElement)&&e.hide(),document.removeEventListener("keydown",n))},s=t=>{var n;e&&t.target!==e.HTMLInputElement&&!(null==(n=e.HTMLElement)?void 0:n.contains(t.target))&&(e.HTMLInputElement&&e.HTMLElement&&e.hide(),window.removeEventListener("resize",i),document.removeEventListener("click",s,{capture:!0}))},r=()=>{e.isInputInit?(bi(e.HTMLInputElement,e.HTMLElement,e.settings.visibility.positionToInput,e.CSSClasses),e.HTMLElement.style.visibility="visible",e.show()):t.push(cn(e)),window.addEventListener("resize",i),document.addEventListener("click",s,{capture:!0}),document.addEventListener("keydown",n)};return e.HTMLInputElement.addEventListener("click",r),e.HTMLInputElement.addEventListener("focus",r),()=>{t.forEach((e=>e()))}})(e):(ui(e),Xi(e),e.actions.initCalendar&&e.actions.initCalendar(e),an(e));var e})),ei(this,"update",(e=>((e,{year:t,month:i,dates:n,holidays:s,time:r}={})=>{if(!e.isInit)throw new Error(di);e.input&&!e.isInputInit&&cn(e,!1),ln(e,{year:t,month:i,dates:n,holidays:s,time:r}),e.actions.updateCalendar&&e.actions.updateCalendar(e)})(this,e))),ei(this,"destroy",(()=>(e=>{var t,i,n,s,r,o;if(!e.isInit)throw new Error(di);e.input?(null==(i=null==(t=e.HTMLElement)?void 0:t.parentElement)||i.removeChild(e.HTMLElement),null==(s=null==(n=e.HTMLInputElement)?void 0:n.replaceWith)||s.call(n,e.HTMLOriginalElement),e.HTMLInputElement=void 0):null==(o=null==(r=e.HTMLElement)?void 0:r.replaceWith)||o.call(r,e.HTMLOriginalElement),e.HTMLElement=e.HTMLOriginalElement,e.actions.destroyCalendar&&e.actions.destroyCalendar(e)})(this))),ei(this,"show",(()=>{var e;(e=this).currentType?(e.HTMLElement.classList.remove(e.CSSClasses.calendarHidden),e.actions.showCalendar&&e.actions.showCalendar(e)):e.HTMLElement.click()})),ei(this,"hide",(()=>{var e;(e=this).currentType&&(e.HTMLElement.classList.add(e.CSSClasses.calendarHidden),e.actions.hideCalendar&&e.actions.hideCalendar(e))})),this.HTMLElement="string"==typeof e?document.querySelector(e):e,!this.HTMLElement)throw new Error((e=>`${e} is not found, check the first argument passed to new VanillaCalendar.`)(e));if(!t)return;const i=(e,t)=>{Object.keys(t).forEach((n=>{"object"!=typeof e[n]||"object"!=typeof t[n]||t[n]instanceof Date?e[n]=t[n]:i(e[n],t[n])}))};i(this,t)}}class dn{constructor(e){this.translaterService=e,this._clearFilterTriggered=!1,this._lastClickIsDate=!1,this._shouldTriggerQuery=!0,this.hasTimePicker=!1,this.inputFilterType="range",this.searchTerms=[],this._bindEventService=new Ft}get gridOptions(){return this.grid?.getOptions()??{}}get columnFilter(){return this.columnDef?.filter||{}}get currentDateOrDates(){return this._currentDateOrDates}get defaultOperator(){return"compound"===this.inputFilterType?S.empty:this.gridOptions.defaultFilterRangeOperator||S.rangeInclusive}get pickerOptions(){return this._pickerOptions||{}}get filterOptions(){return{...this.gridOptions.defaultFilterOptions?.date,...this.columnFilter?.filterOptions}}get operator(){return"compound"===this.inputFilterType?this._operator||this.columnFilter.operator||this.defaultOperator:this.columnFilter?.operator??this.defaultOperator}set operator(e){"compound"===this.inputFilterType?this._operator=e:this.columnFilter&&(this.columnFilter.operator=e)}init(e){if(!e)throw new Error('[Slickgrid-Universal] A filter must always have an "init()" with valid arguments.');this.grid=e.grid,this.callback=e.callback,this.columnDef=e.columnDef,"compound"===this.inputFilterType&&(this.operator=e.operator||""),this.searchTerms=e?.searchTerms??[],this.filterContainerElm=e.filterContainerElm;const t="compound"===this.inputFilterType?Array.isArray(this.searchTerms)&&this.searchTerms.length>=0?this.searchTerms[0]:"":this.searchTerms;this._filterElm=this.createDomFilterElement(t),this.updateFilterStyle(this.searchTerms.length>0),this._selectOperatorElm&&this._bindEventService.bind(this._selectOperatorElm,"change",this.onTriggerEvent.bind(this)),this._bindEventService.bind(document.body,"keydown",(e=>{"Escape"!==e.key&&"Tab"!==e.key||this.hide()})),this._bindEventService.bind(this._dateInputElm,"keydown",(e=>{"Backspace"===e.key&&this.clear(!0,!1)}))}clear(e=!0,t=!0){if(this.calendarInstance&&(this._clearFilterTriggered=t,this._shouldTriggerQuery=e,this._currentValue="",this.searchTerms=[],this._currentDateStrings=[],this._selectOperatorElm&&(this._selectOperatorElm.selectedIndex=0),this.calendarInstance)){const e=new Date;Vt(this.columnFilter,this._dateInputElm,this.calendarInstance,{columnDef:this.columnDef,oldVal:this._currentDateOrDates,newVal:"",updatePickerUI:!0,selectedSettings:{dates:[],month:e.getMonth(),year:e.getFullYear()}})}this.onTriggerEvent(new Event("keyup")),this.updateFilterStyle(!1)}destroy(){this._bindEventService.unbindAll(),this.calendarInstance?.destroy(),ee(this.filterContainerElm),this.filterContainerElm?.remove(),this._selectOperatorElm?.remove(),this._filterElm?.remove()}hide(){"function"==typeof this.calendarInstance?.hide&&this.calendarInstance.hide()}show(){"function"==typeof this.calendarInstance?.show&&this.calendarInstance.show()}getValues(){return this._currentDateOrDates}setValues(e,t,i=!1){let n;"compound"===this.inputFilterType?n=Array.isArray(e)?e[0]:e:"string"==typeof e||Array.isArray(e)&&"string"==typeof e[0]&&e[0].indexOf("..")>0?n="string"==typeof e?[e]:e[0].split(".."):Array.isArray(e)&&(n=e),this.calendarInstance&&void 0!==n&&(Vt(this.columnFilter,this._dateInputElm,this.calendarInstance,{columnDef:this.columnDef,newVal:n,updatePickerUI:!0}),this._currentDateOrDates=e&&n?n:void 0);const s=this.getValues()||[],r=Array.isArray(s)?s:[s];if(this.updateFilterStyle(r.length>0),this.operator=t||this.defaultOperator,t&&this._selectOperatorElm){const e=$(this.operator);this._selectOperatorElm.value=e}i&&this.callback(void 0,{columnDef:this.columnDef,searchTerms:r,operator:this.operator,shouldTriggerQuery:!0})}buildDatePickerInput(e){const t=this.columnDef?.id??"",i=this.columnFilter.type||this.columnDef.type||b.dateIso,n=this.columnDef.outputType||this.columnFilter.type||this.columnDef.type||b.dateUtc,s=It(n),r=this.columnFilter.type||this.columnDef.type||b.dateIso;s&&"range"!==this.inputFilterType&&("ISO8601"===s||s.toLowerCase().includes("h"))&&(this.hasTimePicker=!0);const o=It(this.hasTimePicker?b.dateTimeIsoAM_PM:b.dateIso),a=(this.filterOptions?.locale??this.translaterService?.getCurrentLanguage?.())||this.gridOptions.locale||"en";let l;"compound"===this.inputFilterType?e&&(l=e,this._currentDateOrDates=e):("string"==typeof e||Array.isArray(e)&&"string"==typeof e[0]&&e[0].indexOf("..")>0?l="string"==typeof e?[e]:e[0].split(".."):Array.isArray(e)&&(l=e),Array.isArray(l)&&(this._currentDateOrDates=l,this._currentDateStrings=l.map((e=>kt(e,void 0,r)))));const c={input:!0,jumpToSelectedDate:!0,type:"range"===this.inputFilterType?"multiple":"default",sanitizer:e=>this.grid.sanitizeHtmlString(e),toggleSelected:!1,actions:{clickDay:e=>{this._lastClickIsDate=!0},changeToInput:(e,t)=>{if(t.HTMLInputElement){let e=[],r="",a="";if(t.selectedDates[1]){t.selectedDates.sort(((e,t)=>+new Date(e)-+new Date(t))),r=t.selectedDates[0],a=t.selectedDates[t.selectedDates.length-1];const i=Tt(t.selectedDates[0],s,"en-US"),n=Tt(a,s,"en-US");t.HTMLInputElement.value=`${i} â ${n}`,e=[r,a]}else t.selectedDates[0]?(r=t.selectedDates[0],t.HTMLInputElement.value=kt(r,b.dateIso,n),e=t.selectedDates):t.HTMLInputElement.value="";if(this.hasTimePicker&&r){const i=Ot(r,o);i.setHours(+(t.selectedHours||0)),i.setMinutes(+(t.selectedMinutes||0)),t.HTMLInputElement.value=kt(i,void 0,n),e=[i]}if("compound"===this.inputFilterType?this._currentValue=kt(e[0],void 0,i):Array.isArray(e)&&(this._currentDateStrings=e.map((e=>kt(e,void 0,i))),this._currentValue=this._currentDateStrings.join("..")),this._currentDateOrDates=e.map((e=>e instanceof Date?e:Ot(e,o))),this._currentValue){const e=this.hasTimePicker?new Event("keyup"):void 0;this.onTriggerEvent(e)}"range"===this.inputFilterType&&t.selectedDates.length<2&&(this._lastClickIsDate=!1),this._lastClickIsDate&&(t.hide(),this._lastClickIsDate=!1)}}},settings:{lang:a,iso8601:!1,visibility:{theme:this.gridOptions?.darkMode?"dark":"light",positionToInput:"auto",weekend:!1}}};"range"===this.inputFilterType&&(c.type="multiple",c.months=2,c.jumpMonths=2,c.settings={...c.settings,range:{edgesOnly:!0},selection:{day:"multiple-ranged"},visibility:{...c.settings?.visibility,daysOutside:!1}}),this.hasTimePicker&&(c.settings.selection??={},c.settings.selection.time=24),this._pickerOptions=Ce(!0,{},c,{settings:this.filterOptions});let h=this.gridOptions?.defaultFilterPlaceholder??"";this.columnFilter?.placeholder&&(h=this.columnFilter.placeholder),this._dateInputElm=Z("input",{type:"text",className:"form-control date-picker",placeholder:h,readOnly:!0,dataset:{input:"",columnid:`${t}`}}),this.calendarInstance=new hn(this._dateInputElm,this._pickerOptions),this.calendarInstance.init(),this._pickerOptions.settings?.selected?.dates&&(l=this._pickerOptions.settings.selected.dates),l&&Vt(this.columnFilter,this._dateInputElm,this.calendarInstance,{columnDef:this.columnDef,oldVal:void 0,newVal:l,updatePickerUI:!1})}getOperatorOptionValues(){let e;return e=this.columnFilter?.compoundOperatorList?this.columnFilter.compoundOperatorList:qt(this.gridOptions,this.translaterService),Gt(this.gridOptions,e,"numeric"),e}createDomFilterElement(e){const t=this.columnDef?.id??"";if(ee(this.filterContainerElm),this.buildDatePickerInput(e),"range"===this.inputFilterType){const i=Z("div",{className:`date-picker form-group search-filter filter-${t}`});return Array.isArray(e)&&e.length>0&&""!==e[0]&&(this._currentDateOrDates=e,this._currentValue=e[0]),i.appendChild(this._dateInputElm),i&&this.filterContainerElm.appendChild(i),i}{this._selectOperatorElm=Wt(this.getOperatorOptionValues(),this.grid);const i=Z("div",{className:`date-picker form-group search-filter filter-${t}`}),n=Z("div",{className:"input-group date-picker"},i);if(Z("div",{className:"input-group-addon input-group-prepend operator"},n).appendChild(this._selectOperatorElm),n.appendChild(this._dateInputElm),this.operator){const e=$(this.operator);this._selectOperatorElm.value=e}return this._currentDateOrDates=e,this._currentValue=e,i&&this.filterContainerElm.appendChild(i),i}}onTriggerEvent(e){if(this._clearFilterTriggered)this.callback(e,{columnDef:this.columnDef,clearFilterTriggered:this._clearFilterTriggered,shouldTriggerQuery:this._shouldTriggerQuery}),this.updateFilterStyle(!1);else if("range"===this.inputFilterType){const t=this._currentDateStrings?this._currentDateStrings:[this._currentValue];this.updateFilterStyle(t.length>0),this.callback(e,{columnDef:this.columnDef,searchTerms:t,operator:this.operator||"",shouldTriggerQuery:this._shouldTriggerQuery})}else if("compound"===this.inputFilterType&&this._selectOperatorElm){const t=this._selectOperatorElm.value;this.updateFilterStyle(!!this._currentValue);const i=this.columnFilter.skipCompoundOperatorFilterWithNullInput??this.gridOptions.skipCompoundOperatorFilterWithNullInput??void 0===this.gridOptions.skipCompoundOperatorFilterWithNullInput,n=i&&ke(this._currentDateOrDates)||""===this._currentDateOrDates&&ke(this._lastSearchValue);i&&i&&!n||this.callback(e,{columnDef:this.columnDef,searchTerms:this._currentValue?[this._currentValue]:null,operator:t||"",shouldTriggerQuery:this._shouldTriggerQuery})}this._clearFilterTriggered=!1,this._shouldTriggerQuery=!0,this._lastSearchValue=this._currentValue}updateFilterStyle(e){e?this._filterElm.classList.add("filled"):this._filterElm.classList.remove("filled")}}class un{constructor(e){this.translaterService=e}filterCollection(e,t,i=C.chain){let n=[];return Array.isArray(t)?(n=i===C.merge?[]:[...e],t.forEach((t=>{if(i===C.merge){const i=this.singleFilterCollection(e,t);n=Ue([...n,...i])}else n=this.singleFilterCollection(n,t)}))):n=this.singleFilterCollection(e,t),n}preParseByMutationDateItems(e,t,i){const n=[];t.getColumns().forEach((e=>{const t=this.getParseDateInfo(e,i);t&&n.push(t)})),e.forEach((e=>{n.forEach((({columnId:t,dateFormat:i,queryFieldName:n})=>{this.reassignDateWhenValid(e,t,i,n)}))}))}parseSingleDateItem(e,t,i){i&&t.getColumns().forEach((t=>{const n=this.getParseDateInfo(t,i);n&&this.reassignDateWhenValid(e,t.id,n.dateFormat,n.queryFieldName)}))}singleFilterCollection(e,t){let i=[];if(t){const n=t.property,s=t.operator||S.equal,r=void 0===t.value?"":t.value;switch(s){case S.equal:i=n?e.filter((e=>e[n]===r)):e.filter((e=>e===r));break;case S.contains:i=n?e.filter((e=>-1!==e[n]?.toString().indexOf(r.toString()))):e.filter((e=>null!=e&&-1!==e.toString().indexOf(r.toString())));break;case S.notContains:i=n?e.filter((e=>-1===e[n]?.toString().indexOf(r.toString()))):e.filter((e=>null!=e&&-1===e.toString().indexOf(r.toString())));break;case S.notEqual:default:i=n?e.filter((e=>e[n]!==r)):e.filter((e=>e!==r))}}return i}sortCollection(e,t,i,n){if(n&&(!this.translaterService||!this.translaterService.translate))throw new Error('[Slickgrid-Universal] requires a Translate Service to be installed and configured when the grid option "enableTranslate" is enabled.');let s=[];if(i)if(Array.isArray(i))s=t.sort(((t,s)=>{for(let r=0,o=i.length;r<o;r++){const o=i[r];if(o?.property){const i=o.sortDesc?x.desc:x.asc,r=o.property,a=Lt(o?.fieldType??e?.type??b.string,n?this.translaterService?.translate?.(t[r]||" "):t[r],n?this.translaterService?.translate?.(s[r]||" "):s[r],i,e);if(a!==x.neutral)return a}}return x.neutral}));else if(i?.property){const r=i.property,o=i.sortDesc?x.desc:x.asc,a=i?.fieldType??e?.type??b.string;s=t.sort(((t,i)=>{const s=n?this.translaterService?.translate&&this.translaterService.translate(t[r]||" "):t[r],l=n?this.translaterService?.translate&&this.translaterService.translate(i[r]||" "):i[r],c=Lt(a,s,l,o,e);return c!==x.neutral?c:x.neutral}))}else if(i&&!i.property){const r=i.sortDesc?x.desc:x.asc,o=i?.fieldType??e?.type??b.string;s=t.sort(((t,i)=>{const s=n?this.translaterService?.translate&&this.translaterService.translate(t||" "):t,a=n?this.translaterService?.translate&&this.translaterService.translate(i||" "):i,l=Lt(o,s,a,r,e);return l!==x.neutral?l:x.neutral}))}return s}getParseDateInfo(e,t){const i=e.type||b.string,n=It(i);if(V(i)&&t){const i="string"==typeof t?`${t}${e.id}`:`${e.id}`;return{columnId:e.id,dateFormat:n,queryFieldName:i}}}reassignDateWhenValid(e,t,i,n){const s=Dt(e[t],i,!1);s&&(e[n]=s)}}function pn(e,t,i,n,s=!1,r,o){const a=i?.id??"",l=n.getOptions(),c=("editor"===e?i?.editor:i?.filter)??{},h=c?.collectionOptions??{},d=h?.separatorBetweenTextLabels??"",u=c?.enableTranslateLabel??!1,p=l?.enableTranslate??!1,f=c?.enableRenderHtml??!1,m=c?.customStructure?.label??"label",g=c?.customStructure?.labelPrefix??"labelPrefix",v=c?.customStructure?.labelSuffix??"labelSuffix",_=c?.customStructure?.optionLabel??"value",b=c?.customStructure?.value??"value",y=Z("select",{className:"ms-filter search-filter"}),C="filter"===e?["search-filter",`filter-${a}`]:["select-editor",`editor-${a}`];y.classList.add(...C),y.multiple=s;const w=[];let S=!1;return Array.isArray(t)&&(t.every((e=>"number"==typeof e||"string"==typeof e))?t.forEach((t=>{const i={text:String(t),value:t};"filter"===e&&Array.isArray(o)&&(i.selected=o.findIndex((e=>e===t))>=0),w.push(i),(i.selected&&s||i.selected&&!s&&""!==t)&&(S=!0)})):t.forEach((t=>{if(void 0===t||"object"==typeof t&&void 0===t[m]&&void 0===t.labelKey)throw new Error("[Slickgrid-Universal] Select Filter/Editor collection with value/label (or value/labelKey when using Locale) is required to populate the Select list, for example:: { filter: model: Filters.multipleSelect, collection: [ { value: '1', label: 'One' } ]')");const i=t.labelKey||t[m],a=(t.labelKey||u&&r)&&i&&p?r?.translate(i||" "):i;let l=t[g]||"",c=t[v]||"",h=t.hasOwnProperty(_)?t[_]:"";h?.toString&&(h=h.toString().replace(/"/g,"'")),l=u&&r&&l&&"string"==typeof l?r.translate(l||" "):l,c=u&&r&&c&&"string"==typeof c?r.translate(c||" "):c,h=u&&r&&h&&"string"==typeof h?r.translate(h||" "):h;let y=[l,"string"==typeof a||"number"==typeof a?a.toString():a,c].filter((e=>e)).join(d);const C={text:"",value:""};f&&(y=n.sanitizeHtmlString(y)),C.text=y;let E=t[b];null==E&&(E=""),"filter"===e&&Array.isArray(o)&&(C.selected=o.findIndex((e=>`${e}`==`${t[b]}`))>=0),C.value=`${E??""}`,w.push(C),(C.selected&&s||C.selected&&!s&&""!==t[b])&&(S=!0)}))),{selectElement:y,dataCollection:w,hasFoundSearchTerm:S}}class fn{constructor(e,t,i){this.sharedService=e,this.backendUtilities=t,this.translaterService=i}getPickerTitleOutputString(e,t){if(this.sharedService.gridOptions?.enableTranslate&&!this.translaterService?.translate)throw new Error('[Slickgrid-Universal] requires a Translate Service to be installed and configured when the grid option "enableTranslate" is enabled.');let i="";const n=this.sharedService.gridOptions?.[t]??{},s=this.sharedService.gridOptions?.enableTranslate??!1,r=this.sharedService.gridOptions?.locales??m.locales,o=n?.[e],a=n?.[`${e}Key`],l=B(this.sharedService.gridOptions);if(a&&this.translaterService?.translate)i=this.translaterService.translate(a||" ");else switch(e){case"commandTitle":i=o||s&&this.translaterService?.getCurrentLanguage&&this.translaterService?.translate(`${l}COMMANDS`)||r?.TEXT_COMMANDS;break;case"columnTitle":i=o||s&&this.translaterService?.getCurrentLanguage&&this.translaterService?.translate(`${l}COLUMNS`)||r?.TEXT_COLUMNS;break;case"forceFitTitle":i=o||s&&this.translaterService?.getCurrentLanguage&&this.translaterService?.translate(`${l}FORCE_FIT_COLUMNS`)||r?.TEXT_FORCE_FIT_COLUMNS;break;case"syncResizeTitle":i=o||s&&this.translaterService?.getCurrentLanguage&&this.translaterService?.translate(`${l}SYNCHRONOUS_RESIZE`)||r?.TEXT_SYNCHRONOUS_RESIZE;break;default:i=o}return i}readjustFrozenColumnIndexWhenNeeded(e,t,i){if(e>=0){const n=i.findIndex((e=>e.id===this.sharedService.frozenVisibleColumnId));n>=0&&n!==e&&(this.sharedService.gridOptions.frozenColumn=n,this.sharedService.slickGrid.setOptions({frozenColumn:n})),Array.isArray(i)&&Array.isArray(t)&&i.length!==t.length&&this.sharedService.slickGrid.setColumns(i)}}refreshBackendDataset(e){let t=this.sharedService.gridOptions;e&&(t={...this.sharedService.gridOptions,...e},this.sharedService.gridOptions=t),this.backendUtilities?.refreshBackendDataset(t)}runOverrideFunctionWhenExists(e,t){return"function"!=typeof e||!!e.call(this,t)}sortItems(e,t){Array.isArray(e)&&e.sort(((e,i)=>e&&i&&e.hasOwnProperty(t)&&i.hasOwnProperty(t)?e[t]-i[t]:0))}translateItems(e,t,i){if(Array.isArray(e))for(const n of e)n.hasOwnProperty(t)&&(n[i]=this.translaterService?.translate?.(n[t]))}translateMenuItemsFromTitleKey(e,t="commandItems"){for(const i of e)"object"==typeof i&&(i.titleKey&&(i.title=this.translateWhenEnabledAndServiceExist(`${i.titleKey}`,`TEXT_${i.titleKey}`)),i.subMenuTitleKey&&(i.subMenuTitle=this.translateWhenEnabledAndServiceExist(`${i.subMenuTitleKey}`,`TEXT_${i.subMenuTitleKey}`))),Array.isArray(i?.[t])&&this.translateMenuItemsFromTitleKey(i?.[t])}translateWhenEnabledAndServiceExist(e,t,i){let n="";const s=this.sharedService?.gridOptions,r=s?.locales??m.locales;return n=i||(s.enableTranslate&&this.translaterService?.translate?this.translaterService.translate(e||" "):t in r?r[t]:t),n}}class mn{get defaultPrevented(){return this._isDefaultPrevented}constructor(e,t){this.event=e,this.args=t,this._isPropagationStopped=!1,this._isImmediatePropagationStopped=!1,this._isDefaultPrevented=!1,this.returnValue=void 0,this.nativeEvent=e,this._arguments=t,e&&["altKey","ctrlKey","metaKey","shiftKey","key","keyCode","clientX","clientY","offsetX","offsetY","pageX","pageY","bubbles","target","type","which","x","y"].forEach((t=>this[t]=e[t])),this._eventTarget=this.nativeEvent?this.nativeEvent.target:void 0}stopPropagation(){this._isPropagationStopped=!0,this.nativeEvent?.stopPropagation()}isPropagationStopped(){return this._isPropagationStopped}stopImmediatePropagation(){this._isImmediatePropagationStopped=!0,this.nativeEvent&&this.nativeEvent.stopImmediatePropagation()}isImmediatePropagationStopped(){return this._isImmediatePropagationStopped}getNativeEvent(){return this.nativeEvent}preventDefault(){this.nativeEvent&&this.nativeEvent.preventDefault(),this._isDefaultPrevented=!0}isDefaultPrevented(){return this.nativeEvent?this.nativeEvent.defaultPrevented:this._isDefaultPrevented}addReturnValue(e){void 0===this.returnValue&&void 0!==e&&(this.returnValue=e)}getReturnValue(){return this.returnValue}getArguments(){return this._arguments}resetReturnValue(){this.returnValue=void 0}}class gn{get subscriberCount(){return this._handlers.length}constructor(e,t){this.eventName=e,this.pubSub=t,this._handlers=[],this._pubSubService=t}subscribe(e){this._handlers.push(e)}unsubscribe(e){for(let t=this._handlers.length-1;t>=0;t--)this._handlers[t]===e&&this._handlers.splice(t,1)}notify(e,t,i,n=!1){const s=t instanceof mn?t:new mn(t,e);n&&s.resetReturnValue(),i=i||this;for(let t=0;t<this._handlers.length&&!s.isPropagationStopped()&&!s.isImmediatePropagationStopped();t++){const n=this._handlers[t].call(i,s,e);s.addReturnValue(n)}if("function"==typeof this._pubSubService?.publish&&this.eventName){const t=this._pubSubService.publish(this.eventName,{args:e,eventData:s},void 0,(e=>s.nativeEvent??=e));s.addReturnValue(t)}return s}setPubSubService(e){this._pubSubService=e}}class vn{constructor(){this.handlers=[]}get subscriberCount(){return this.handlers.length}subscribe(e,t){return this.handlers.push({event:e,handler:t}),e.subscribe(t),this}unsubscribe(e,t){let i=this.handlers.length;for(;i--;)if(this.handlers[i].event===e&&this.handlers[i].handler===t)return this.handlers.splice(i,1),void e.unsubscribe(t);return this}unsubscribeAll(){let e=this.handlers.length;for(;e--;)this.handlers[e].event.unsubscribe(this.handlers[e].handler);return this.handlers=[],this}}class _n{constructor(e,t,i,n){void 0===i&&void 0===n&&(i=e,n=t),this.fromRow=Math.min(e,i),this.fromCell=Math.min(t,n),this.toRow=Math.max(e,i),this.toCell=Math.max(t,n)}isSingleCell(){return this.fromRow===this.toRow&&this.fromCell===this.toCell}isSingleRow(){return this.fromRow===this.toRow}contains(e,t){return e>=this.fromRow&&e<=this.toRow&&t>=this.fromCell&&t<=this.toCell}toString(){return this.isSingleCell()?`(${this.fromRow}:${this.fromCell})`:`(${this.fromRow}:${this.fromCell} - ${this.toRow}:${this.toCell})`}}class bn{constructor(){this.__nonDataRow=!0}}class yn extends bn{constructor(){super(),this.__group=!0,this.level=0,this.count=0,this.value=null,this.title=null,this.collapsed=!1,this.selectChecked=!1,this.totals=null,this.rows=[],this.groups=null,this.groupingKey=""}equals(e){return this.value===e.value&&this.count===e.count&&this.collapsed===e.collapsed&&this.title===e.title}}class Cn extends bn{constructor(){super(),this.__groupTotals=!0,this.group=null,this.initialized=!1}}class wn{static height(e,t){if(e)return void 0===t?e.getBoundingClientRect().height:void wn.setStyleSize(e,"height",t)}static width(e,t){if(e&&e.getBoundingClientRect)return void 0===t?e.getBoundingClientRect().width:void wn.setStyleSize(e,"width",t)}static setStyleSize(e,t,i){"function"==typeof i&&(i=i()),e.style[t]="string"==typeof i?i:`${i}px`}static isHidden(e){return 0===e.offsetWidth&&0===e.offsetHeight}static parents(e,t){const i=[],n=":visible"===t,s=":hidden"===t;for(;(e=e.parentNode)&&e!==document&&e&&e.parentNode;)s?wn.isHidden(e)&&i.push(e):n?wn.isHidden(e)||i.push(e):t&&!e.matches(t)||i.push(e);return i}static toFloat(e){const t=parseFloat(e);return isNaN(t)?0:t}static show(e,t=""){Array.isArray(e)?e.forEach((e=>e.style.display=t)):e.style.display=t}static hide(e){Array.isArray(e)?e.forEach((e=>e.style.display="none")):e.style.display="none"}static applyDefaults(e,t){"object"==typeof t&&Object.keys(t).forEach((i=>{t.hasOwnProperty(i)&&!e.hasOwnProperty(i)&&(e[i]=t[i])}))}static addSlickEventPubSubWhenDefined(e,t){if(e)for(const i in t)t[i]instanceof gn&&"function"==typeof t[i].setPubSubService&&t[i].setPubSubService(e)}}wn.storage={_storage:new WeakMap,put:function(e,t,i){this._storage.has(e)||this._storage.set(e,new Map),this._storage.get(e).set(t,i)},get:function(e,t){const i=this._storage.get(e);return i?i.get(t):null},remove:function(e,t){const i=this._storage.get(e).delete(t);return 0!==this._storage.get(e).size&&this._storage.delete(e),i}};const Sn=new class{constructor(){this.activeEditController=null}isActive(e){return e?this.activeEditController===e:null!==this.activeEditController}activate(e){if(e!==this.activeEditController){if(null!==this.activeEditController)throw new Error("SlickEditorLock.activate: an editController is still active, can't activate another editController");if(!e.commitCurrentEdit)throw new Error("SlickEditorLock.activate: editController must implement .commitCurrentEdit()");if(!e.cancelCurrentEdit)throw new Error("SlickEditorLock.activate: editController must implement .cancelCurrentEdit()");this.activeEditController=e}}deactivate(e){if(this.activeEditController){if(this.activeEditController!==e)throw new Error("SlickEditorLock.deactivate: specified editController is not the currently active one");this.activeEditController=null}}commitCurrentEdit(){return!this.activeEditController||this.activeEditController.commitCurrentEdit()}cancelCurrentEdit(){return!this.activeEditController||this.activeEditController.cancelCurrentEdit()}};class En{constructor(e){this.pluginName="GroupItemMetadataProvider",this._defaults={groupCssClass:"slick-group",groupTitleCssClass:"slick-group-title",totalsCssClass:"slick-group-totals",groupFocusable:!0,indentation:15,totalsFocusable:!1,toggleCssClass:"slick-group-toggle",toggleExpandedCssClass:"expanded",toggleCollapsedCssClass:"collapsed",enableExpandCollapse:!0,groupFormatter:this.defaultGroupCellFormatter.bind(this),totalsFormatter:this.defaultTotalsCellFormatter.bind(this),includeHeaderTotals:!1},this._eventHandler=new vn,this._options=Ce(!0,{},this._defaults,e)}get eventHandler(){return this._eventHandler}get dataView(){return this._grid?.getData()??{}}get gridOptions(){return this._grid?.getOptions()||{}}init(e,t){this._grid=e,this._options={...this._defaults,...t},this._eventHandler.subscribe(e.onClick,this.handleGridClick.bind(this)),this._eventHandler.subscribe(e.onKeyDown,this.handleGridKeyDown.bind(this))}destroy(){this.dispose()}dispose(){this._eventHandler?.unsubscribeAll()}getOptions(){return this._options}setOptions(e){this._options={...this._options,...e}}getGroupRowMetadata(e){return{selectable:!1,focusable:this._options.groupFocusable,cssClasses:`${this._options.groupCssClass} slick-group-level-${e?.level||0}`,formatter:this._options.includeHeaderTotals&&this._options.totalsFormatter||void 0,columns:{0:{colspan:this._options.includeHeaderTotals?"1":"*",formatter:this._options.groupFormatter,editorClass:null}}}}getTotalsRowMetadata(e){return{selectable:!1,focusable:this._options.totalsFocusable,cssClasses:`${this._options.totalsCssClass} slick-group-level-${e?.group?.level||0}`,formatter:this._options.totalsFormatter,editorClass:null}}defaultGroupCellFormatter(e,t,i,n,s){if(!this._options.enableExpandCollapse)return s.title;const r=s.level||0,o=r*(this._options?.indentation??15)+"px",a=s.collapsed?this._options.toggleCollapsedCssClass:this._options.toggleExpandedCssClass,l=this.gridOptions?.preventDocumentFragmentUsage?document.createElement("span"):new DocumentFragment;l.appendChild(Z("span",{className:`${this._options.toggleCssClass} ${a}`,ariaExpanded:String(!s.collapsed),style:{marginLeft:o}}));const c=Z("span",{className:this._options.groupTitleCssClass||""});return c.setAttribute("level",r),s.title instanceof HTMLElement||s.title instanceof DocumentFragment?c.appendChild(s.title):this._grid.applyHtmlCode(c,s.title??""),l.appendChild(c),l}defaultTotalsCellFormatter(e,t,i,n,s,r){return n?.groupTotalsFormatter?.(s,n,r)??""}handleGridClick(e,t){const i=e.target,n=this._grid?.getDataItem(t.row);n instanceof yn&&i.classList.contains(this._options.toggleCssClass||"")&&(this.handleDataViewExpandOrCollapse(n),e.stopImmediatePropagation(),e.preventDefault())}handleGridKeyDown(e){if(this._options.enableExpandCollapse&&" "===e.key){const t=this._grid?.getActiveCell();if(t){const i=this._grid.getDataItem(t.row);i instanceof yn&&(this.handleDataViewExpandOrCollapse(i),e.stopImmediatePropagation(),e.preventDefault())}}}handleDataViewExpandOrCollapse(e){const t=this._grid?.getRenderedRange();this.dataView.setRefreshHints({ignoreDiffsBefore:t.top,ignoreDiffsAfter:t.bottom+1}),e.collapsed?this.dataView.expandGroup(e.groupingKey):this.dataView.collapseGroup(e.groupingKey)}}class xn{constructor(e,t){this.externalPubSub=t,this.defaults={groupItemMetadataProvider:null,inlineFilters:!1,useCSPSafeFilter:!1},this.idProperty="id",this.items=[],this.rows=[],this.idxById=new Map,this.rowsById=void 0,this.filter=null,this.filterCSPSafe=null,this.updated=null,this.suspend=!1,this.isBulkSuspend=!1,this.bulkDeleteIds=new Map,this.sortAsc=!0,this.refreshHints={},this.prevRefreshHints={},this.filteredItems=[],this.filterCache=[],this.groupingInfoDefaults={getter:void 0,formatter:void 0,comparer:(e,t)=>e.value===t.value?0:e.value>t.value?1:-1,predefinedValues:[],aggregators:[],aggregateEmpty:!1,aggregateCollapsed:!1,aggregateChildGroups:!1,collapsed:!1,displayTotalsRow:!0,lazyTotalsCalculation:!1},this.groupingInfos=[],this.groups=[],this.toggledGroupsByLevel=[],this.groupingDelimiter=":|:",this.selectedRowIds=[],this.pagesize=0,this.pagenum=0,this.totalRows=0,this.onBeforePagingInfoChanged=new gn("onBeforePagingInfoChanged",t),this.onGroupExpanded=new gn("onGroupExpanded",t),this.onGroupCollapsed=new gn("onGroupCollapsed",t),this.onPagingInfoChanged=new gn("onPagingInfoChanged",t),this.onRowCountChanged=new gn("onRowCountChanged",t),this.onRowsChanged=new gn("onRowsChanged",t),this.onRowsOrCountChanged=new gn("onRowsOrCountChanged",t),this.onSelectedRowIdsChanged=new gn("onSelectedRowIdsChanged",t),this.onSetItemsCalled=new gn("onSetItemsCalled",t),this._options=Ce(!0,{},this.defaults,e)}beginUpdate(e){this.suspend=!0,this.isBulkSuspend=!0===e}endUpdate(){const e=this.isBulkSuspend;this.isBulkSuspend=!1,this.suspend=!1,e&&(this.processBulkDelete(),this.ensureIdUniqueness()),this.refresh()}destroy(){this.items=[],this.idProperty="id",this.idxById=null,this.rowsById=null,this.filter=null,this.filterCSPSafe=null,this.updated=null,this.sortComparer=null,this.filterCache=[],this.filteredItems=[],this.compiledFilter=null,this.compiledFilterCSPSafe=null,this.compiledFilterWithCaching=null,this.compiledFilterWithCachingCSPSafe=null,this._grid&&(this._grid.onSelectedRowsChanged?.unsubscribe(),this._grid.onCellCssStylesChanged?.unsubscribe()),this.onRowsOrCountChanged?.unsubscribe()}setRefreshHints(e){this.refreshHints=e}getFilterArgs(){return this.filterArgs}setFilterArgs(e){this.filterArgs=e}processBulkDelete(){if(!this.idxById)return;let e,t,i=0;for(let n=0,s=this.items.length;n<s;n++){if(t=this.items[n],e=t[this.idProperty],void 0===e)throw new Error("[SlickGrid DataView] Each data element must implement a unique 'id' property");this.bulkDeleteIds.has(e)?this.idxById.delete(e):(this.items[i]=t,this.idxById.set(e,i),++i)}this.items.length=i,this.bulkDeleteIds=new Map}updateIdxById(e){if(this.isBulkSuspend||!this.idxById)return;let t;for(let i=e=e||0,n=this.items.length;i<n;i++){if(t=this.items[i][this.idProperty],void 0===t)throw new Error("[SlickGrid DataView] Each data element must implement a unique 'id' property");this.idxById.set(t,i)}}ensureIdUniqueness(){if(this.isBulkSuspend||!this.idxById)return;let e;for(let t=0,i=this.items.length;t<i;t++)if(e=this.items[t][this.idProperty],void 0===e||this.idxById.get(e)!==t)throw new Error("[SlickGrid DataView] Each data element must implement a unique 'id' property")}getItems(){return this.items}getIdPropertyName(){return this.idProperty}setItems(e,t){void 0!==t&&(this.idProperty=t),this.items=this.filteredItems=e,this.onSetItemsCalled.notify({idProperty:this.idProperty,itemCount:this.items.length},null,this),this.idxById=new Map,this.updateIdxById(),this.ensureIdUniqueness(),this.refresh()}setPagingOptions(e){!1!==this.onBeforePagingInfoChanged.notify(this.getPagingInfo(),null,this).getReturnValue()&&(ke(e.pageSize)&&(this.pagesize=e.pageSize,this.pagenum=this.pagesize?Math.min(this.pagenum,Math.max(0,Math.ceil(this.totalRows/this.pagesize)-1)):0),ke(e.pageNum)&&(this.pagenum=Math.min(e.pageNum,Math.max(0,Math.ceil(this.totalRows/this.pagesize)-1))),this.onPagingInfoChanged.notify(this.getPagingInfo(),null,this),this.refresh())}getPagingInfo(){const e=this.pagesize?Math.max(1,Math.ceil(this.totalRows/this.pagesize)):1;return{pageSize:this.pagesize,pageNum:this.pagenum,totalRows:this.totalRows,totalPages:e,dataView:this}}sort(e,t){this.sortAsc=t,this.sortComparer=e,!1===t&&this.items.reverse(),this.items.sort(e),!1===t&&this.items.reverse(),this.idxById=new Map,this.updateIdxById(),this.refresh()}reSort(){this.sortComparer&&this.sort(this.sortComparer,this.sortAsc)}getFilteredItems(){return this.filteredItems}getFilteredItemCount(){return this.filteredItems.length}getFilter(){return this._options.useCSPSafeFilter?this.filterCSPSafe:this.filter}setFilter(e){this.filterCSPSafe=e,this.filter=e,this._options.inlineFilters&&(this.compiledFilterCSPSafe=this.compileFilterCSPSafe,this.compiledFilterWithCachingCSPSafe=this.compileFilterWithCachingCSPSafe,this.compiledFilter=this.compileFilter(this._options.useCSPSafeFilter),this.compiledFilterWithCaching=this.compileFilterWithCaching(this._options.useCSPSafeFilter)),this.refresh()}getGrouping(){return this.groupingInfos}setGrouping(e){this._options.groupItemMetadataProvider||(this._options.groupItemMetadataProvider=new En),this.groups=[],this.toggledGroupsByLevel=[],e=e||[],this.groupingInfos=e instanceof Array?e:[e];for(let e=0;e<this.groupingInfos.length;e++){const t=this.groupingInfos[e]=Ce(!0,{},this.groupingInfoDefaults,this.groupingInfos[e]);t.getterIsAFn="function"==typeof t.getter,t.compiledAccumulators=[];let i=t.aggregators.length;for(;i--;)t.compiledAccumulators[i]=this.compileAccumulatorLoopCSPSafe(t.aggregators[i]);this.toggledGroupsByLevel[e]={}}this.refresh()}getItemByIdx(e){return this.items[e]}getIdxById(e){return this.idxById?.get(e)}ensureRowsByIdCache(){if(!this.rowsById){this.rowsById={};for(let e=0,t=this.rows.length;e<t;e++)this.rowsById[this.rows[e][this.idProperty]]=e}}getRowByItem(e){return this.ensureRowsByIdCache(),this.rowsById?.[e[this.idProperty]]}getRowById(e){return this.ensureRowsByIdCache(),this.rowsById?.[e]}getItemById(e){return this.items[this.idxById.get(e)]}mapItemsToRows(e){const t=[];this.ensureRowsByIdCache();for(let i=0,n=e.length;i<n;i++){const n=this.rowsById?.[e[i][this.idProperty]];ke(n)&&(t[t.length]=n)}return t}mapIdsToRows(e){const t=[];this.ensureRowsByIdCache();for(let i=0,n=e.length;i<n;i++){const n=this.rowsById?.[e[i]];ke(n)&&(t[t.length]=n)}return t}mapRowsToIds(e){const t=[];for(let i=0,n=e.length;i<n;i++)if(e[i]<this.rows.length){const n=this.rows[e[i]];t[t.length]=n[this.idProperty]}return t}updateSingleItem(e,t){if(this.idxById){if(!this.idxById.has(e))throw new Error("[SlickGrid DataView] Invalid id");if(e!==t[this.idProperty]){const i=t[this.idProperty];if(!ke(i))throw new Error("[SlickGrid DataView] Cannot update item to associate with a null id");if(this.idxById.has(i))throw new Error("[SlickGrid DataView] Cannot update item to associate with a non-unique id");this.idxById.set(i,this.idxById.get(e)),this.idxById.delete(e),this.updated?.[e]&&delete this.updated[e],e=i}this.items[this.idxById.get(e)]=t,this.updated||(this.updated={}),this.updated[e]=!0}}updateItem(e,t){this.updateSingleItem(e,t),this.refresh()}updateItems(e,t){if(e.length!==t.length)throw new Error("[SlickGrid DataView] Mismatch on the length of ids and items provided to update");for(let i=0,n=t.length;i<n;i++)this.updateSingleItem(e[i],t[i]);this.refresh()}insertItem(e,t){this.items.splice(e,0,t),this.updateIdxById(e),this.refresh()}insertItems(e,t){Array.prototype.splice.apply(this.items,[e,0].concat(t)),this.updateIdxById(e),this.refresh()}addItem(e){this.items.push(e),this.updateIdxById(this.items.length-1),this.refresh()}addItems(e){this.items=this.items.concat(e),this.updateIdxById(this.items.length-e.length),this.refresh()}deleteItem(e){if(this.idxById)if(this.isBulkSuspend)this.bulkDeleteIds.set(e,!0);else{const t=this.idxById.get(e);if(void 0===t)throw new Error("[SlickGrid DataView] Invalid id");this.idxById.delete(e),this.items.splice(t,1),this.updateIdxById(t),this.refresh()}}deleteItems(e){if(0!==e.length&&this.idxById)if(this.isBulkSuspend)for(let t=0,i=e.length;t<i;t++){const i=e[t];if(void 0===this.idxById.get(i))throw new Error("[SlickGrid DataView] Invalid id");this.bulkDeleteIds.set(i,!0)}else{const t=[];for(let i=0,n=e.length;i<n;i++){const n=e[i],s=this.idxById.get(n);if(void 0===s)throw new Error("[SlickGrid DataView] Invalid id");this.idxById.delete(n),t.push(s)}t.sort();for(let e=t.length-1;e>=0;--e)this.items.splice(t[e],1);this.updateIdxById(t[0]),this.refresh()}}sortedAddItem(e){if(!this.sortComparer)throw new Error("[SlickGrid DataView] sortedAddItem() requires a sort comparer, use sort()");this.insertItem(this.sortedIndex(e),e)}sortedUpdateItem(e,t){if(!this.idxById)return;if(!this.idxById.has(e)||e!==t[this.idProperty])throw new Error(`[SlickGrid DataView] Invalid or non-matching id ${e}`);if(!this.sortComparer)throw new Error("[SlickGrid DataView] sortedUpdateItem() requires a sort comparer, use sort()");const i=this.getItemById(e);0!==this.sortComparer(i,t)?(this.deleteItem(e),this.sortedAddItem(t)):this.updateItem(e,t)}sortedIndex(e){let t=0,i=this.items.length;for(;t<i;){const n=t+i>>>1;-1===this.sortComparer(this.items[n],e)?t=n+1:i=n}return t}getItemCount(){return this.items.length}getLength(){return this.rows.length}getItem(e){const t=this.rows[e];if(t?.__group&&t.totals&&!t.totals?.initialized){const e=this.groupingInfos[t.level];e.displayTotalsRow||(this.calculateTotals(t.totals),t.title=e.formatter?e.formatter(t):t.value)}else t?.__groupTotals&&!t.initialized&&this.calculateTotals(t);return t}getItemMetadata(e){const t=this.rows[e];return void 0===t?null:t.__group?this._options.groupItemMetadataProvider.getGroupRowMetadata(t):t.__groupTotals?this._options.groupItemMetadataProvider.getTotalsRowMetadata(t):null}expandCollapseAllGroups(e,t){if(ke(e))this.toggledGroupsByLevel[e]={},this.groupingInfos[e].collapsed=t,!0===t?this.onGroupCollapsed.notify({level:e,groupingKey:null}):this.onGroupExpanded.notify({level:e,groupingKey:null});else for(let e=0;e<this.groupingInfos.length;e++)this.toggledGroupsByLevel[e]={},this.groupingInfos[e].collapsed=t,!0===t?this.onGroupCollapsed.notify({level:e,groupingKey:null}):this.onGroupExpanded.notify({level:e,groupingKey:null});this.refresh()}collapseAllGroups(e){this.expandCollapseAllGroups(e,!0)}expandAllGroups(e){this.expandCollapseAllGroups(e,!1)}expandCollapseGroup(e,t,i){this.toggledGroupsByLevel[e]&&(this.toggledGroupsByLevel[e][t]=this.groupingInfos[e].collapsed^i),this.refresh()}collapseGroup(...e){const t=Array.prototype.slice.call(e)[0];let i,n;1===e.length&&-1!==t.indexOf(this.groupingDelimiter)?(i=t,n=t.split(this.groupingDelimiter).length-1):(i=e.join(this.groupingDelimiter),n=e.length-1),this.expandCollapseGroup(n,i,!0),this.onGroupCollapsed.notify({level:n,groupingKey:i})}expandGroup(...e){const t=Array.prototype.slice.call(e)[0];let i,n;1===e.length&&-1!==t.indexOf(this.groupingDelimiter)?(n=t.split(this.groupingDelimiter).length-1,i=t):(n=e.length-1,i=e.join(this.groupingDelimiter)),this.expandCollapseGroup(n,i,!1),this.onGroupExpanded.notify({level:n,groupingKey:i})}getGroups(){return this.groups}extractGroups(e,t){let i,n;const s=[],r={};let o;const a=t?t.level+1:0,l=this.groupingInfos[a];for(let e=0,o=l.predefinedValues?.length??0;e<o;e++)n=l.predefinedValues?.[e],i=r[n],i||(i=new yn,i.value=n,i.level=a,i.groupingKey=(t?t.groupingKey+this.groupingDelimiter:"")+n,s[s.length]=i,r[n]=i);for(let c=0,h=e.length;c<h;c++)o=e[c],n=l.getterIsAFn?l.getter(o):o[l.getter],i=r[n],i||(i=new yn,i.value=n,i.level=a,i.groupingKey=(t?t.groupingKey+this.groupingDelimiter:"")+n,s[s.length]=i,r[n]=i),i.rows[i.count++]=o;if(a<this.groupingInfos.length-1)for(let e=0;e<s.length;e++)i=s[e],i.groups=this.extractGroups(i.rows,i);return s.length&&this.addTotals(s,a),s.sort(this.groupingInfos[a].comparer),s}calculateTotals(e){const t=e.group,i=this.groupingInfos[t?.level??0],n=t.level===this.groupingInfos.length;let s,r=i.aggregators.length;if(!n&&i.aggregateChildGroups){let e=t.groups?.length??0;for(;e--;)t.groups[e].totals.initialized||this.calculateTotals(t.groups[e].totals)}for(;r--;)s=i.aggregators[r],s.init(),!n&&i.aggregateChildGroups?i.compiledAccumulators[r].call(s,t.groups):i.compiledAccumulators[r].call(s,t.rows),s.storeResult(e);e.initialized=!0}addGroupTotals(e){const t=this.groupingInfos[e.level],i=new Cn;i.group=e,e.totals=i,t.lazyTotalsCalculation||this.calculateTotals(i)}addTotals(e,t){t=t||0;const i=this.groupingInfos[t],n=i.collapsed,s=this.toggledGroupsByLevel[t];let r,o=e.length;for(;o--;)r=e[o],r.collapsed&&!i.aggregateCollapsed||(r.groups&&this.addTotals(r.groups,t+1),i.aggregators?.length&&(i.aggregateEmpty||r.rows.length||r.groups?.length)&&this.addGroupTotals(r),r.collapsed=n^s[r.groupingKey],r.title=i.formatter?i.formatter(r):r.value)}flattenGroupedRows(e,t){t=t||0;const i=this.groupingInfos[t],n=[];let s,r,o=0;for(let a=0,l=e.length;a<l;a++){if(r=e[a],n[o++]=r,!r.collapsed){s=r.groups?this.flattenGroupedRows(r.groups,t+1):r.rows;for(let e=0,t=s.length;e<t;e++)n[o++]=s[e]}r.totals&&i.displayTotalsRow&&(!r.collapsed||i.aggregateCollapsed)&&(n[o++]=r.totals)}return n}compileAccumulatorLoopCSPSafe(e){return e.accumulate?function(t){let i;if(Array.isArray(t))for(let n=0;n<t.length;n++){const s=t[n];i=e.accumulate.call(e,s)}return i}:function(){}}compileFilterCSPSafe(e,t){if("function"!=typeof this.filterCSPSafe)return[];const i=[],n=e.length;for(let s=0;s<n;s++)this.filterCSPSafe(e[s],t)&&i.push(e[s]);return i}compileFilter(e=!1){if(e)return null;const t=Oe(this.filter),i="{ continue _coreloop; }$1",n="{ _retval[_idx++] = $item$; continue _coreloop; }$1",s=t.body.replace(/return false\s*([;}]|\}|$)/gi,i).replace(/return!1([;}]|\}|$)/gi,i).replace(/return true\s*([;}]|\}|$)/gi,n).replace(/return!0([;}]|\}|$)/gi,n).replace(/return ([^;}]+?)\s*([;}]|$)/gi,"{ if ($1) { _retval[_idx++] = $item$; }; continue _coreloop; }$2");let r=["var _retval = [], _idx = 0; ","var $item$, $args$ = _args; ","_coreloop: ","for (var _i = 0, _il = _items.length; _i < _il; _i++) { ","$item$ = _items[_i]; ","$filter$; ","} ","return _retval; "].join("");r=r.replace(/\$filter\$/gi,s),r=r.replace(/\$item\$/gi,t.params[0]),r=r.replace(/\$args\$/gi,t.params[1]);const o=new Function("_items,_args",r),a="compiledFilter";return o.displayName=a,o.name=this.setFunctionName(o,a),o}compileFilterWithCaching(e=!1){if(e)return null;const t=Oe(this.filter),i="{ continue _coreloop; }$1",n="{ _cache[_i] = true;_retval[_idx++] = $item$; continue _coreloop; }$1",s=t.body.replace(/return false\s*([;}]|\}|$)/gi,i).replace(/return!1([;}]|\}|$)/gi,i).replace(/return true\s*([;}]|\}|$)/gi,n).replace(/return!0([;}]|\}|$)/gi,n).replace(/return ([^;}]+?)\s*([;}]|$)/gi,"{ if ((_cache[_i] = $1)) { _retval[_idx++] = $item$; }; continue _coreloop; }$2");let r=["var _retval = [], _idx = 0; ","var $item$, $args$ = _args; ","_coreloop: ","for (var _i = 0, _il = _items.length; _i < _il; _i++) { ","$item$ = _items[_i]; ","if (_cache[_i]) { ","_retval[_idx++] = $item$; ","continue _coreloop; ","} ","$filter$; ","} ","return _retval; "].join("");r=r.replace(/\$filter\$/gi,s),r=r.replace(/\$item\$/gi,t.params[0]),r=r.replace(/\$args\$/gi,t.params[1]);const o=new Function("_items,_args,_cache",r),a="compiledFilterWithCaching";return o.displayName=a,o.name=this.setFunctionName(o,a),o}compileFilterWithCachingCSPSafe(e,t,i){if("function"!=typeof this.filterCSPSafe)return[];const n=[],s=e.length;for(let r=0;r<s;r++)(i[r]||this.filterCSPSafe(e[r],t))&&n.push(e[r]);return n}setFunctionName(e,t){try{Object.defineProperty(e,"name",{writable:!0,value:t})}catch(i){e.name=t}}uncompiledFilter(e,t){const i=[];let n=0;for(let s=0,r=e.length;s<r;s++)this.filter?.(e[s],t)&&(i[n++]=e[s]);return i}uncompiledFilterWithCaching(e,t,i){const n=[];let s,r=0;for(let o=0,a=e.length;o<a;o++)s=e[o],i[o]?n[r++]=s:this.filter?.(s,t)&&(n[r++]=s,i[o]=!0);return n}getFilteredAndPagedItems(e){if(this._options.useCSPSafeFilter?this.filterCSPSafe:this.filter){let t,i;this._options.useCSPSafeFilter?(t=this._options.inlineFilters?this.compiledFilterCSPSafe:this.uncompiledFilter,i=this._options.inlineFilters?this.compiledFilterWithCachingCSPSafe:this.uncompiledFilterWithCaching):(t=this._options.inlineFilters?this.compiledFilter:this.uncompiledFilter,i=this._options.inlineFilters?this.compiledFilterWithCaching:this.uncompiledFilterWithCaching),this.refreshHints.isFilterNarrowing?this.filteredItems=t.call(this,this.filteredItems,this.filterArgs):this.refreshHints.isFilterExpanding?this.filteredItems=i.call(this,e,this.filterArgs,this.filterCache):this.refreshHints.isFilterUnchanged||(this.filteredItems=t.call(this,e,this.filterArgs))}else this.filteredItems=this.pagesize?e:e.concat();let t;return this.pagesize?(this.filteredItems.length<=this.pagenum*this.pagesize&&(0===this.filteredItems.length?this.pagenum=0:this.pagenum=Math.floor((this.filteredItems.length-1)/this.pagesize)),t=this.filteredItems.slice(this.pagesize*this.pagenum,this.pagesize*this.pagenum+this.pagesize)):t=this.filteredItems,{totalRows:this.filteredItems.length,rows:t}}getRowDiffs(e,t){let i,n,s;const r=[];let o=0,a=Math.max(t.length,e.length);this.refreshHints?.ignoreDiffsBefore&&(o=Math.max(0,Math.min(t.length,this.refreshHints.ignoreDiffsBefore))),this.refreshHints?.ignoreDiffsAfter&&(a=Math.min(t.length,Math.max(0,this.refreshHints.ignoreDiffsAfter)));for(let l=o,c=e.length;l<a;l++)l>=c?r[r.length]=l:(i=t[l],n=e[l],(!i||this.groupingInfos.length&&(s=i.__nonDataRow||n.__nonDataRow)&&i.__group!==n.__group||i.__group&&!i.equals(n)||s&&(i.__groupTotals||n.__groupTotals)||i[this.idProperty]!==n[this.idProperty]||this.updated?.[i[this.idProperty]])&&(r[r.length]=l));return r}recalc(e){this.rowsById=void 0,this.refreshHints.isFilterNarrowing===this.prevRefreshHints.isFilterNarrowing&&this.refreshHints.isFilterExpanding===this.prevRefreshHints.isFilterExpanding||(this.filterCache=[]);const t=this.getFilteredAndPagedItems(e);this.totalRows=t.totalRows;let i=t.rows;this.groups=[],this.groupingInfos.length&&(this.groups=this.extractGroups(i),this.groups.length&&(i=this.flattenGroupedRows(this.groups)));const n=this.getRowDiffs(this.rows,i);return this.rows=i,n}refresh(){if(this.suspend)return;const e=Ce(!0,{},this.getPagingInfo()),t=this.rows.length,i=this.totalRows;let n=this.recalc(this.items);this.pagesize&&this.totalRows<this.pagenum*this.pagesize&&(this.pagenum=Math.max(0,Math.ceil(this.totalRows/this.pagesize)-1),n=this.recalc(this.items)),this.updated=null,this.prevRefreshHints=this.refreshHints,this.refreshHints={},i!==this.totalRows&&!1!==this.onBeforePagingInfoChanged.notify(e,null,this).getReturnValue()&&this.onPagingInfoChanged.notify(this.getPagingInfo(),null,this),t!==this.rows.length&&this.onRowCountChanged.notify({previous:t,current:this.rows.length,itemCount:this.items.length,dataView:this,callingOnRowsChanged:n.length>0},null,this),n.length>0&&this.onRowsChanged.notify({rows:n,itemCount:this.items.length,dataView:this,calledOnRowCountChanged:t!==this.rows.length},null,this),(t!==this.rows.length||n.length>0)&&this.onRowsOrCountChanged.notify({rowsDiff:n,previousRowCount:t,currentRowCount:this.rows.length,itemCount:this.items.length,rowCountChanged:t!==this.rows.length,rowsChanged:n.length>0,dataView:this},null,this)}syncGridSelection(e,t,i){let n;this._grid=e,this.selectedRowIds=this.mapRowsToIds(e.getSelectedRows());const s=e.getOptions(),r=e=>{!1===e?this.selectedRowIds=[]:this.selectedRowIds.sort().join(",")!==e.sort().join(",")&&(this.selectedRowIds=e)};return e.onSelectedRowsChanged.subscribe(((e,t)=>{if(!n){const e=this.mapRowsToIds(t.rows),i={grid:this._grid,ids:e,rows:t.rows,added:!0,dataView:this};this.preSelectedRowIdsChangeFn(i),this.onSelectedRowIdsChanged.notify(Object.assign(i,{selectedRowIds:this.selectedRowIds,filteredIds:this.getAllSelectedFilteredIds()}),new mn,this)}})),this.preSelectedRowIdsChangeFn=e=>{if(!n){if(n=!0,void 0===e.added)r(e.ids);else{let t;if(e.added)if(i&&s.multiSelect){const i=this.selectedRowIds?.filter((e=>void 0===this.getRowById(e)));t=i.concat(e.ids)}else t=e.ids;else if(i&&s.multiSelect){const i=new Set(e.ids);t=this.selectedRowIds?.filter((e=>!i.has(e)))}else t=[];r(t)}n=!1}},this.onRowsOrCountChanged.subscribe((()=>{if((this.selectedRowIds||[]).length>0&&!n){n=!0;const i=this.mapIdsToRows(this.selectedRowIds||[]);if(!t){const e={grid:this._grid,ids:this.mapRowsToIds(i),rows:i,dataView:this};this.preSelectedRowIdsChangeFn(e),this.onSelectedRowIdsChanged.notify(Object.assign(e,{selectedRowIds:this.selectedRowIds,filteredIds:this.getAllSelectedFilteredIds()}),new mn,this)}e.setSelectedRows(i),n=!1}}).bind(this)),this.onSelectedRowIdsChanged}getAllSelectedIds(){return this.selectedRowIds}getAllSelectedFilteredIds(){return this.getAllSelectedFilteredItems().map((e=>e[this.idProperty]))}setSelectedIds(e,t){let i=t?.isRowBeingAdded;const n=t?.shouldTriggerEvent,s=t?.applyRowSelectionToGrid;!1!==i&&(i=!0);const r=this.mapIdsToRows(e),o={grid:this._grid,ids:e,rows:r,added:i,dataView:this};this.preSelectedRowIdsChangeFn?.(o),!1!==n&&this.onSelectedRowIdsChanged.notify(Object.assign(o,{selectedRowIds:this.selectedRowIds,filteredIds:this.getAllSelectedFilteredIds()}),new mn,this),!1!==s&&this._grid&&this._grid.setSelectedRows(r)}getAllSelectedItems(){const e=[];return this.getAllSelectedIds().forEach((t=>{e.push(this.getItemById(t))})),e}getAllSelectedFilteredItems(){if(!Array.isArray(this.selectedRowIds))return[];const e=new Set(this.selectedRowIds);return this.filteredItems.filter((t=>e.has(t[this.idProperty])))||[]}syncGridCellCssStyles(e,t){let i,n;const s=e=>{i={},"object"==typeof e&&Object.keys(e).forEach((t=>{if(e&&this.rows[t]){const n=this.rows[t][this.idProperty];i[n]=e[t]}}))};s(e.getCellCssStyles(t));const r=()=>{if("object"==typeof i){n=!0,this.ensureRowsByIdCache();const s={};Object.keys(i).forEach((e=>{const t=this.rowsById?.[e];ke(t)&&(s[t]=i[e])})),e.setCellCssStyles(t,s),n=!1}};e.onCellCssStylesChanged.subscribe(((i,o)=>{n||t!==o.key||(o.hash?s(o.hash):(e.onCellCssStylesChanged.unsubscribe(),this.onRowsOrCountChanged.unsubscribe(r)))})),this.onRowsOrCountChanged.subscribe(r.bind(this))}}function Tn(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function An(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Tn(Object(i),!0).forEach((function(t){In(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Tn(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function On(e){return On="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},On(e)}function In(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function kn(){return kn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},kn.apply(this,arguments)}function Dn(e){if("undefined"!=typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var jn=Dn(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Rn=Dn(/Edge/i),Ln=Dn(/firefox/i),Mn=Dn(/safari/i)&&!Dn(/chrome/i)&&!Dn(/android/i),Pn=Dn(/iP(ad|od|hone)/i),Nn=Dn(/chrome/i)&&Dn(/android/i),Fn={capture:!1,passive:!1};function Hn(e,t,i){e.addEventListener(t,i,!jn&&Fn)}function Bn(e,t,i){e.removeEventListener(t,i,!jn&&Fn)}function zn(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(e){return!1}return!1}}function Vn(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function Wn(e,t,i,n){if(e){i=i||document;do{if(null!=t&&(">"===t[0]?e.parentNode===i&&zn(e,t):zn(e,t))||n&&e===i)return e;if(e===i)break}while(e=Vn(e))}return null}var $n,Un=/\s+/g;function qn(e,t,i){if(e&&t)if(e.classList)e.classList[i?"add":"remove"](t);else{var n=(" "+e.className+" ").replace(Un," ").replace(" "+t+" "," ");e.className=(n+(i?" "+t:"")).replace(Un," ")}}function Gn(e,t,i){var n=e&&e.style;if(n){if(void 0===i)return document.defaultView&&document.defaultView.getComputedStyle?i=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(i=e.currentStyle),void 0===t?i:i[t];t in n||-1!==t.indexOf("webkit")||(t="-webkit-"+t),n[t]=i+("string"==typeof i?"":"px")}}function Kn(e,t){var i="";if("string"==typeof e)i=e;else do{var n=Gn(e,"transform");n&&"none"!==n&&(i=n+" "+i)}while(!t&&(e=e.parentNode));var s=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return s&&new s(i)}function Yn(e,t,i){if(e){var n=e.getElementsByTagName(t),s=0,r=n.length;if(i)for(;s<r;s++)i(n[s],s);return n}return[]}function Xn(){return document.scrollingElement||document.documentElement}function Zn(e,t,i,n,s){if(e.getBoundingClientRect||e===window){var r,o,a,l,c,h,d;if(e!==window&&e.parentNode&&e!==Xn()?(o=(r=e.getBoundingClientRect()).top,a=r.left,l=r.bottom,c=r.right,h=r.height,d=r.width):(o=0,a=0,l=window.innerHeight,c=window.innerWidth,h=window.innerHeight,d=window.innerWidth),(t||i)&&e!==window&&(s=s||e.parentNode,!jn))do{if(s&&s.getBoundingClientRect&&("none"!==Gn(s,"transform")||i&&"static"!==Gn(s,"position"))){var u=s.getBoundingClientRect();o-=u.top+parseInt(Gn(s,"border-top-width")),a-=u.left+parseInt(Gn(s,"border-left-width")),l=o+r.height,c=a+r.width;break}}while(s=s.parentNode);if(n&&e!==window){var p=Kn(s||e),f=p&&p.a,m=p&&p.d;p&&(l=(o/=m)+(h/=m),c=(a/=f)+(d/=f))}return{top:o,left:a,bottom:l,right:c,width:d,height:h}}}function Qn(e,t,i){for(var n=ns(e,!0),s=Zn(e)[t];n;){var r=Zn(n)[i];if(!("top"===i||"left"===i?s>=r:s<=r))return n;if(n===Xn())break;n=ns(n,!1)}return!1}function Jn(e,t,i,n){for(var s=0,r=0,o=e.children;r<o.length;){if("none"!==o[r].style.display&&o[r]!==or.ghost&&(n||o[r]!==or.dragged)&&Wn(o[r],i.draggable,e,!1)){if(s===t)return o[r];s++}r++}return null}function es(e,t){for(var i=e.lastElementChild;i&&(i===or.ghost||"none"===Gn(i,"display")||t&&!zn(i,t));)i=i.previousElementSibling;return i||null}function ts(e,t){var i=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)"TEMPLATE"===e.nodeName.toUpperCase()||e===or.clone||t&&!zn(e,t)||i++;return i}function is(e){var t=0,i=0,n=Xn();if(e)do{var s=Kn(e),r=s.a,o=s.d;t+=e.scrollLeft*r,i+=e.scrollTop*o}while(e!==n&&(e=e.parentNode));return[t,i]}function ns(e,t){if(!e||!e.getBoundingClientRect)return Xn();var i=e,n=!1;do{if(i.clientWidth<i.scrollWidth||i.clientHeight<i.scrollHeight){var s=Gn(i);if(i.clientWidth<i.scrollWidth&&("auto"==s.overflowX||"scroll"==s.overflowX)||i.clientHeight<i.scrollHeight&&("auto"==s.overflowY||"scroll"==s.overflowY)){if(!i.getBoundingClientRect||i===document.body)return Xn();if(n||t)return i;n=!0}}}while(i=i.parentNode);return Xn()}function ss(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function rs(e,t){return function(){if(!$n){var i=arguments;1===i.length?e.call(this,i[0]):e.apply(this,i),$n=setTimeout((function(){$n=void 0}),t)}}}function os(e,t,i){e.scrollLeft+=t,e.scrollTop+=i}function as(e){var t=window.Polymer,i=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):i?i(e).clone(!0)[0]:e.cloneNode(!0)}function ls(e,t,i){var n={};return Array.from(e.children).forEach((function(s){var r,o,a,l;if(Wn(s,t.draggable,e,!1)&&!s.animated&&s!==i){var c=Zn(s);n.left=Math.min(null!==(r=n.left)&&void 0!==r?r:1/0,c.left),n.top=Math.min(null!==(o=n.top)&&void 0!==o?o:1/0,c.top),n.right=Math.max(null!==(a=n.right)&&void 0!==a?a:-1/0,c.right),n.bottom=Math.max(null!==(l=n.bottom)&&void 0!==l?l:-1/0,c.bottom)}})),n.width=n.right-n.left,n.height=n.bottom-n.top,n.x=n.left,n.y=n.top,n}var cs="Sortable"+(new Date).getTime();var hs=[],ds={initializeByDefault:!0},us={mount:function(e){for(var t in ds)ds.hasOwnProperty(t)&&!(t in e)&&(e[t]=ds[t]);hs.forEach((function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")})),hs.push(e)},pluginEvent:function(e,t,i){var n=this;this.eventCanceled=!1,i.cancel=function(){n.eventCanceled=!0};var s=e+"Global";hs.forEach((function(n){t[n.pluginName]&&(t[n.pluginName][s]&&t[n.pluginName][s](An({sortable:t},i)),t.options[n.pluginName]&&t[n.pluginName][e]&&t[n.pluginName][e](An({sortable:t},i)))}))},initializePlugins:function(e,t,i,n){for(var s in hs.forEach((function(n){var s=n.pluginName;if(e.options[s]||n.initializeByDefault){var r=new n(e,t,e.options);r.sortable=e,r.options=e.options,e[s]=r,kn(i,r.defaults)}})),e.options)if(e.options.hasOwnProperty(s)){var r=this.modifyOption(e,s,e.options[s]);void 0!==r&&(e.options[s]=r)}},getEventProperties:function(e,t){var i={};return hs.forEach((function(n){"function"==typeof n.eventProperties&&kn(i,n.eventProperties.call(t[n.pluginName],e))})),i},modifyOption:function(e,t,i){var n;return hs.forEach((function(s){e[s.pluginName]&&s.optionListeners&&"function"==typeof s.optionListeners[t]&&(n=s.optionListeners[t].call(e[s.pluginName],i))})),n}};var ps=["evt"],fs=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=i.evt,s=function(e,t){if(null==e)return{};var i,n,s=function(e,t){if(null==e)return{};var i,n,s={},r=Object.keys(e);for(n=0;n<r.length;n++)i=r[n],t.indexOf(i)>=0||(s[i]=e[i]);return s}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)i=r[n],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(s[i]=e[i])}return s}(i,ps);us.pluginEvent.bind(or)(e,t,An({dragEl:gs,parentEl:vs,ghostEl:_s,rootEl:bs,nextEl:ys,lastDownEl:Cs,cloneEl:ws,cloneHidden:Ss,dragStarted:Ps,putSortable:Is,activeSortable:or.active,originalEvent:n,oldIndex:Es,oldDraggableIndex:Ts,newIndex:xs,newDraggableIndex:As,hideGhostForTarget:ir,unhideGhostForTarget:nr,cloneNowHidden:function(){Ss=!0},cloneNowShown:function(){Ss=!1},dispatchSortableEvent:function(e){ms({sortable:t,name:e,originalEvent:n})}},s))};function ms(e){!function(e){var t=e.sortable,i=e.rootEl,n=e.name,s=e.targetEl,r=e.cloneEl,o=e.toEl,a=e.fromEl,l=e.oldIndex,c=e.newIndex,h=e.oldDraggableIndex,d=e.newDraggableIndex,u=e.originalEvent,p=e.putSortable,f=e.extraEventProperties;if(t=t||i&&i[cs]){var m,g=t.options,v="on"+n.charAt(0).toUpperCase()+n.substr(1);!window.CustomEvent||jn||Rn?(m=document.createEvent("Event")).initEvent(n,!0,!0):m=new CustomEvent(n,{bubbles:!0,cancelable:!0}),m.to=o||i,m.from=a||i,m.item=s||i,m.clone=r,m.oldIndex=l,m.newIndex=c,m.oldDraggableIndex=h,m.newDraggableIndex=d,m.originalEvent=u,m.pullMode=p?p.lastPutMode:void 0;var _=An(An({},f),us.getEventProperties(n,t));for(var b in _)m[b]=_[b];i&&i.dispatchEvent(m),g[v]&&g[v].call(t,m)}}(An({putSortable:Is,cloneEl:ws,targetEl:gs,rootEl:bs,oldIndex:Es,oldDraggableIndex:Ts,newIndex:xs,newDraggableIndex:As},e))}var gs,vs,_s,bs,ys,Cs,ws,Ss,Es,xs,Ts,As,Os,Is,ks,Ds,js,Rs,Ls,Ms,Ps,Ns,Fs,Hs,Bs,zs=!1,Vs=!1,Ws=[],$s=!1,Us=!1,qs=[],Gs=!1,Ks=[],Ys="undefined"!=typeof document,Xs=Pn,Zs=Rn||jn?"cssFloat":"float",Qs=Ys&&!Nn&&!Pn&&"draggable"in document.createElement("div"),Js=function(){if(Ys){if(jn)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),er=function(e,t){var i=Gn(e),n=parseInt(i.width)-parseInt(i.paddingLeft)-parseInt(i.paddingRight)-parseInt(i.borderLeftWidth)-parseInt(i.borderRightWidth),s=Jn(e,0,t),r=Jn(e,1,t),o=s&&Gn(s),a=r&&Gn(r),l=o&&parseInt(o.marginLeft)+parseInt(o.marginRight)+Zn(s).width,c=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+Zn(r).width;if("flex"===i.display)return"column"===i.flexDirection||"column-reverse"===i.flexDirection?"vertical":"horizontal";if("grid"===i.display)return i.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(s&&o.float&&"none"!==o.float){var h="left"===o.float?"left":"right";return!r||"both"!==a.clear&&a.clear!==h?"horizontal":"vertical"}return s&&("block"===o.display||"flex"===o.display||"table"===o.display||"grid"===o.display||l>=n&&"none"===i[Zs]||r&&"none"===i[Zs]&&l+c>n)?"vertical":"horizontal"},tr=function(e){function t(e,i){return function(n,s,r,o){var a=n.options.group.name&&s.options.group.name&&n.options.group.name===s.options.group.name;if(null==e&&(i||a))return!0;if(null==e||!1===e)return!1;if(i&&"clone"===e)return e;if("function"==typeof e)return t(e(n,s,r,o),i)(n,s,r,o);var l=(i?n:s).options.group.name;return!0===e||"string"==typeof e&&e===l||e.join&&e.indexOf(l)>-1}}var i={},n=e.group;n&&"object"==On(n)||(n={name:n}),i.name=n.name,i.checkPull=t(n.pull,!0),i.checkPut=t(n.put),i.revertClone=n.revertClone,e.group=i},ir=function(){!Js&&_s&&Gn(_s,"display","none")},nr=function(){!Js&&_s&&Gn(_s,"display","")};Ys&&!Nn&&document.addEventListener("click",(function(e){if(Vs)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Vs=!1,!1}),!0);var sr=function(e){if(gs){var t=function(e,t){var i;return Ws.some((function(n){var s=n[cs].options.emptyInsertThreshold;if(s&&!es(n)){var r=Zn(n),o=e>=r.left-s&&e<=r.right+s,a=t>=r.top-s&&t<=r.bottom+s;return o&&a?i=n:void 0}})),i}((e=e.touches?e.touches[0]:e).clientX,e.clientY);if(t){var i={};for(var n in e)e.hasOwnProperty(n)&&(i[n]=e[n]);i.target=i.rootEl=t,i.preventDefault=void 0,i.stopPropagation=void 0,t[cs]._onDragOver(i)}}},rr=function(e){gs&&gs.parentNode[cs]._isOutsideThisEl(e.target)};function or(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=kn({},t),e[cs]=this;var i,n,s={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return er(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==or.supportPointer&&"PointerEvent"in window&&!Mn,emptyInsertThreshold:5};for(var r in us.initializePlugins(this,e,s),s)!(r in t)&&(t[r]=s[r]);for(var o in tr(t),this)"_"===o.charAt(0)&&"function"==typeof this[o]&&(this[o]=this[o].bind(this));this.nativeDraggable=!t.forceFallback&&Qs,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?Hn(e,"pointerdown",this._onTapStart):(Hn(e,"mousedown",this._onTapStart),Hn(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(Hn(e,"dragover",this),Hn(e,"dragenter",this)),Ws.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),kn(this,(n=[],{captureAnimationState:function(){n=[],this.options.animation&&[].slice.call(this.el.children).forEach((function(e){if("none"!==Gn(e,"display")&&e!==or.ghost){n.push({target:e,rect:Zn(e)});var t=An({},n[n.length-1].rect);if(e.thisAnimationDuration){var i=Kn(e,!0);i&&(t.top-=i.f,t.left-=i.e)}e.fromRect=t}}))},addAnimationState:function(e){n.push(e)},removeAnimationState:function(e){n.splice(function(e,t){for(var i in e)if(e.hasOwnProperty(i))for(var n in t)if(t.hasOwnProperty(n)&&t[n]===e[i][n])return Number(i);return-1}(n,{target:e}),1)},animateAll:function(e){var t=this;if(!this.options.animation)return clearTimeout(i),void("function"==typeof e&&e());var s=!1,r=0;n.forEach((function(e){var i=0,n=e.target,o=n.fromRect,a=Zn(n),l=n.prevFromRect,c=n.prevToRect,h=e.rect,d=Kn(n,!0);d&&(a.top-=d.f,a.left-=d.e),n.toRect=a,n.thisAnimationDuration&&ss(l,a)&&!ss(o,a)&&(h.top-a.top)/(h.left-a.left)==(o.top-a.top)/(o.left-a.left)&&(i=function(e,t,i,n){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-i.top,2)+Math.pow(t.left-i.left,2))*n.animation}(h,l,c,t.options)),ss(a,o)||(n.prevFromRect=o,n.prevToRect=a,i||(i=t.options.animation),t.animate(n,h,a,i)),i&&(s=!0,r=Math.max(r,i),clearTimeout(n.animationResetTimer),n.animationResetTimer=setTimeout((function(){n.animationTime=0,n.prevFromRect=null,n.fromRect=null,n.prevToRect=null,n.thisAnimationDuration=null}),i),n.thisAnimationDuration=i)})),clearTimeout(i),s?i=setTimeout((function(){"function"==typeof e&&e()}),r):"function"==typeof e&&e(),n=[]},animate:function(e,t,i,n){if(n){Gn(e,"transition",""),Gn(e,"transform","");var s=Kn(this.el),r=s&&s.a,o=s&&s.d,a=(t.left-i.left)/(r||1),l=(t.top-i.top)/(o||1);e.animatingX=!!a,e.animatingY=!!l,Gn(e,"transform","translate3d("+a+"px,"+l+"px,0)"),this.forRepaintDummy=function(e){return e.offsetWidth}(e),Gn(e,"transition","transform "+n+"ms"+(this.options.easing?" "+this.options.easing:"")),Gn(e,"transform","translate3d(0,0,0)"),"number"==typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout((function(){Gn(e,"transition",""),Gn(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1}),n)}}}))}function ar(e,t,i,n,s,r,o,a){var l,c,h=e[cs],d=h.options.onMove;return!window.CustomEvent||jn||Rn?(l=document.createEvent("Event")).initEvent("move",!0,!0):l=new CustomEvent("move",{bubbles:!0,cancelable:!0}),l.to=t,l.from=e,l.dragged=i,l.draggedRect=n,l.related=s||t,l.relatedRect=r||Zn(t),l.willInsertAfter=a,l.originalEvent=o,e.dispatchEvent(l),d&&(c=d.call(h,l,o)),c}function lr(e){e.draggable=!1}function cr(){Gs=!1}function hr(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,i=t.length,n=0;i--;)n+=t.charCodeAt(i);return n.toString(36)}function dr(e){return setTimeout(e,0)}function ur(e){return clearTimeout(e)}or.prototype={constructor:or,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||(Ns=null)},_getDirection:function(e,t){return"function"==typeof this.options.direction?this.options.direction.call(this,e,t,gs):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,i=this.el,n=this.options,s=n.preventOnFilter,r=e.type,o=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,a=(o||e).target,l=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||a,c=n.filter;if(function(e){Ks.length=0;for(var t=e.getElementsByTagName("input"),i=t.length;i--;){var n=t[i];n.checked&&Ks.push(n)}}(i),!gs&&!(/mousedown|pointerdown/.test(r)&&0!==e.button||n.disabled)&&!l.isContentEditable&&(this.nativeDraggable||!Mn||!a||"SELECT"!==a.tagName.toUpperCase())&&!((a=Wn(a,n.draggable,i,!1))&&a.animated||Cs===a)){if(Es=ts(a),Ts=ts(a,n.draggable),"function"==typeof c){if(c.call(this,e,a,this))return ms({sortable:t,rootEl:l,name:"filter",targetEl:a,toEl:i,fromEl:i}),fs("filter",t,{evt:e}),void(s&&e.cancelable&&e.preventDefault())}else if(c&&(c=c.split(",").some((function(n){if(n=Wn(l,n.trim(),i,!1))return ms({sortable:t,rootEl:n,name:"filter",targetEl:a,fromEl:i,toEl:i}),fs("filter",t,{evt:e}),!0}))))return void(s&&e.cancelable&&e.preventDefault());n.handle&&!Wn(l,n.handle,i,!1)||this._prepareDragStart(e,o,a)}}},_prepareDragStart:function(e,t,i){var n,s=this,r=s.el,o=s.options,a=r.ownerDocument;if(i&&!gs&&i.parentNode===r){var l=Zn(i);if(bs=r,vs=(gs=i).parentNode,ys=gs.nextSibling,Cs=i,Os=o.group,or.dragged=gs,ks={target:gs,clientX:(t||e).clientX,clientY:(t||e).clientY},Ls=ks.clientX-l.left,Ms=ks.clientY-l.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,gs.style["will-change"]="all",n=function(){fs("delayEnded",s,{evt:e}),or.eventCanceled?s._onDrop():(s._disableDelayedDragEvents(),!Ln&&s.nativeDraggable&&(gs.draggable=!0),s._triggerDragStart(e,t),ms({sortable:s,name:"choose",originalEvent:e}),qn(gs,o.chosenClass,!0))},o.ignore.split(",").forEach((function(e){Yn(gs,e.trim(),lr)})),Hn(a,"dragover",sr),Hn(a,"mousemove",sr),Hn(a,"touchmove",sr),Hn(a,"mouseup",s._onDrop),Hn(a,"touchend",s._onDrop),Hn(a,"touchcancel",s._onDrop),Ln&&this.nativeDraggable&&(this.options.touchStartThreshold=4,gs.draggable=!0),fs("delayStart",this,{evt:e}),!o.delay||o.delayOnTouchOnly&&!t||this.nativeDraggable&&(Rn||jn))n();else{if(or.eventCanceled)return void this._onDrop();Hn(a,"mouseup",s._disableDelayedDrag),Hn(a,"touchend",s._disableDelayedDrag),Hn(a,"touchcancel",s._disableDelayedDrag),Hn(a,"mousemove",s._delayedDragTouchMoveHandler),Hn(a,"touchmove",s._delayedDragTouchMoveHandler),o.supportPointer&&Hn(a,"pointermove",s._delayedDragTouchMoveHandler),s._dragStartTimer=setTimeout(n,o.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){gs&&lr(gs),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;Bn(e,"mouseup",this._disableDelayedDrag),Bn(e,"touchend",this._disableDelayedDrag),Bn(e,"touchcancel",this._disableDelayedDrag),Bn(e,"mousemove",this._delayedDragTouchMoveHandler),Bn(e,"touchmove",this._delayedDragTouchMoveHandler),Bn(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?Hn(document,"pointermove",this._onTouchMove):Hn(document,t?"touchmove":"mousemove",this._onTouchMove):(Hn(gs,"dragend",this),Hn(bs,"dragstart",this._onDragStart));try{document.selection?dr((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(e,t){if(zs=!1,bs&&gs){fs("dragStarted",this,{evt:t}),this.nativeDraggable&&Hn(document,"dragover",rr);var i=this.options;!e&&qn(gs,i.dragClass,!1),qn(gs,i.ghostClass,!0),or.active=this,e&&this._appendGhost(),ms({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(Ds){this._lastX=Ds.clientX,this._lastY=Ds.clientY,ir();for(var e=document.elementFromPoint(Ds.clientX,Ds.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(Ds.clientX,Ds.clientY))!==t;)t=e;if(gs.parentNode[cs]._isOutsideThisEl(e),t)do{if(t[cs]&&t[cs]._onDragOver({clientX:Ds.clientX,clientY:Ds.clientY,target:e,rootEl:t})&&!this.options.dragoverBubble)break;e=t}while(t=Vn(t));nr()}},_onTouchMove:function(e){if(ks){var t=this.options,i=t.fallbackTolerance,n=t.fallbackOffset,s=e.touches?e.touches[0]:e,r=_s&&Kn(_s,!0),o=_s&&r&&r.a,a=_s&&r&&r.d,l=Xs&&Bs&&is(Bs),c=(s.clientX-ks.clientX+n.x)/(o||1)+(l?l[0]-qs[0]:0)/(o||1),h=(s.clientY-ks.clientY+n.y)/(a||1)+(l?l[1]-qs[1]:0)/(a||1);if(!or.active&&!zs){if(i&&Math.max(Math.abs(s.clientX-this._lastX),Math.abs(s.clientY-this._lastY))<i)return;this._onDragStart(e,!0)}if(_s){r?(r.e+=c-(js||0),r.f+=h-(Rs||0)):r={a:1,b:0,c:0,d:1,e:c,f:h};var d="matrix(".concat(r.a,",").concat(r.b,",").concat(r.c,",").concat(r.d,",").concat(r.e,",").concat(r.f,")");Gn(_s,"webkitTransform",d),Gn(_s,"mozTransform",d),Gn(_s,"msTransform",d),Gn(_s,"transform",d),js=c,Rs=h,Ds=s}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!_s){var e=this.options.fallbackOnBody?document.body:bs,t=Zn(gs,!0,Xs,!0,e),i=this.options;if(Xs){for(Bs=e;"static"===Gn(Bs,"position")&&"none"===Gn(Bs,"transform")&&Bs!==document;)Bs=Bs.parentNode;Bs!==document.body&&Bs!==document.documentElement?(Bs===document&&(Bs=Xn()),t.top+=Bs.scrollTop,t.left+=Bs.scrollLeft):Bs=Xn(),qs=is(Bs)}qn(_s=gs.cloneNode(!0),i.ghostClass,!1),qn(_s,i.fallbackClass,!0),qn(_s,i.dragClass,!0),Gn(_s,"transition",""),Gn(_s,"transform",""),Gn(_s,"box-sizing","border-box"),Gn(_s,"margin",0),Gn(_s,"top",t.top),Gn(_s,"left",t.left),Gn(_s,"width",t.width),Gn(_s,"height",t.height),Gn(_s,"opacity","0.8"),Gn(_s,"position",Xs?"absolute":"fixed"),Gn(_s,"zIndex","100000"),Gn(_s,"pointerEvents","none"),or.ghost=_s,e.appendChild(_s),Gn(_s,"transform-origin",Ls/parseInt(_s.style.width)*100+"% "+Ms/parseInt(_s.style.height)*100+"%")}},_onDragStart:function(e,t){var i=this,n=e.dataTransfer,s=i.options;fs("dragStart",this,{evt:e}),or.eventCanceled?this._onDrop():(fs("setupClone",this),or.eventCanceled||((ws=as(gs)).removeAttribute("id"),ws.draggable=!1,ws.style["will-change"]="",this._hideClone(),qn(ws,this.options.chosenClass,!1),or.clone=ws),i.cloneId=dr((function(){fs("clone",i),or.eventCanceled||(i.options.removeCloneOnHide||bs.insertBefore(ws,gs),i._hideClone(),ms({sortable:i,name:"clone"}))})),!t&&qn(gs,s.dragClass,!0),t?(Vs=!0,i._loopId=setInterval(i._emulateDragOver,50)):(Bn(document,"mouseup",i._onDrop),Bn(document,"touchend",i._onDrop),Bn(document,"touchcancel",i._onDrop),n&&(n.effectAllowed="move",s.setData&&s.setData.call(i,n,gs)),Hn(document,"drop",i),Gn(gs,"transform","translateZ(0)")),zs=!0,i._dragStartId=dr(i._dragStarted.bind(i,t,e)),Hn(document,"selectstart",i),Ps=!0,Mn&&Gn(document.body,"user-select","none"))},_onDragOver:function(e){var t,i,n,s,r=this.el,o=e.target,a=this.options,l=a.group,c=or.active,h=Os===l,d=a.sort,u=Is||c,p=this,f=!1;if(!Gs){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),o=Wn(o,a.draggable,r,!0),I("dragOver"),or.eventCanceled)return f;if(gs.contains(e.target)||o.animated&&o.animatingX&&o.animatingY||p._ignoreWhileAnimating===o)return D(!1);if(Vs=!1,c&&!a.disabled&&(h?d||(n=vs!==bs):Is===this||(this.lastPutMode=Os.checkPull(this,c,gs,e))&&l.checkPut(this,c,gs,e))){if(s="vertical"===this._getDirection(e,o),t=Zn(gs),I("dragOverValid"),or.eventCanceled)return f;if(n)return vs=bs,k(),this._hideClone(),I("revert"),or.eventCanceled||(ys?bs.insertBefore(gs,ys):bs.appendChild(gs)),D(!0);var m=es(r,a.draggable);if(!m||function(e,t,i){var n=Zn(es(i.el,i.options.draggable)),s=ls(i.el,i.options,_s);return t?e.clientX>s.right+10||e.clientY>n.bottom&&e.clientX>n.left:e.clientY>s.bottom+10||e.clientX>n.right&&e.clientY>n.top}(e,s,this)&&!m.animated){if(m===gs)return D(!1);if(m&&r===e.target&&(o=m),o&&(i=Zn(o)),!1!==ar(bs,r,gs,t,o,i,e,!!o))return k(),m&&m.nextSibling?r.insertBefore(gs,m.nextSibling):r.appendChild(gs),vs=r,j(),D(!0)}else if(m&&function(e,t,i){var n=Zn(Jn(i.el,0,i.options,!0)),s=ls(i.el,i.options,_s);return t?e.clientX<s.left-10||e.clientY<n.top&&e.clientX<n.right:e.clientY<s.top-10||e.clientY<n.bottom&&e.clientX<n.left}(e,s,this)){var g=Jn(r,0,a,!0);if(g===gs)return D(!1);if(i=Zn(o=g),!1!==ar(bs,r,gs,t,o,i,e,!1))return k(),r.insertBefore(gs,g),vs=r,j(),D(!0)}else if(o.parentNode===r){i=Zn(o);var v,_,b,y=gs.parentNode!==r,C=!function(e,t,i){var n=i?e.left:e.top,s=i?e.right:e.bottom,r=i?e.width:e.height,o=i?t.left:t.top,a=i?t.right:t.bottom,l=i?t.width:t.height;return n===o||s===a||n+r/2===o+l/2}(gs.animated&&gs.toRect||t,o.animated&&o.toRect||i,s),w=s?"top":"left",S=Qn(o,"top","top")||Qn(gs,"top","top"),E=S?S.scrollTop:void 0;if(Ns!==o&&(_=i[w],$s=!1,Us=!C&&a.invertSwap||y),v=function(e,t,i,n,s,r,o,a){var l=n?e.clientY:e.clientX,c=n?i.height:i.width,h=n?i.top:i.left,d=n?i.bottom:i.right,u=!1;if(!o)if(a&&Hs<c*s){if(!$s&&(1===Fs?l>h+c*r/2:l<d-c*r/2)&&($s=!0),$s)u=!0;else if(1===Fs?l<h+Hs:l>d-Hs)return-Fs}else if(l>h+c*(1-s)/2&&l<d-c*(1-s)/2)return function(e){return ts(gs)<ts(e)?1:-1}(t);return(u=u||o)&&(l<h+c*r/2||l>d-c*r/2)?l>h+c/2?1:-1:0}(e,o,i,s,C?1:a.swapThreshold,null==a.invertedSwapThreshold?a.swapThreshold:a.invertedSwapThreshold,Us,Ns===o),0!==v){var x=ts(gs);do{x-=v,b=vs.children[x]}while(b&&("none"===Gn(b,"display")||b===_s))}if(0===v||b===o)return D(!1);Ns=o,Fs=v;var T=o.nextElementSibling,A=!1,O=ar(bs,r,gs,t,o,i,e,A=1===v);if(!1!==O)return 1!==O&&-1!==O||(A=1===O),Gs=!0,setTimeout(cr,30),k(),A&&!T?r.appendChild(gs):o.parentNode.insertBefore(gs,A?T:o),S&&os(S,0,E-S.scrollTop),vs=gs.parentNode,void 0===_||Us||(Hs=Math.abs(_-Zn(o)[w])),j(),D(!0)}if(r.contains(gs))return D(!1)}return!1}function I(a,l){fs(a,p,An({evt:e,isOwner:h,axis:s?"vertical":"horizontal",revert:n,dragRect:t,targetRect:i,canSort:d,fromSortable:u,target:o,completed:D,onMove:function(i,n){return ar(bs,r,gs,t,i,Zn(i),e,n)},changed:j},l))}function k(){I("dragOverAnimationCapture"),p.captureAnimationState(),p!==u&&u.captureAnimationState()}function D(t){return I("dragOverCompleted",{insertion:t}),t&&(h?c._hideClone():c._showClone(p),p!==u&&(qn(gs,Is?Is.options.ghostClass:c.options.ghostClass,!1),qn(gs,a.ghostClass,!0)),Is!==p&&p!==or.active?Is=p:p===or.active&&Is&&(Is=null),u===p&&(p._ignoreWhileAnimating=o),p.animateAll((function(){I("dragOverAnimationComplete"),p._ignoreWhileAnimating=null})),p!==u&&(u.animateAll(),u._ignoreWhileAnimating=null)),(o===gs&&!gs.animated||o===r&&!o.animated)&&(Ns=null),a.dragoverBubble||e.rootEl||o===document||(gs.parentNode[cs]._isOutsideThisEl(e.target),!t&&sr(e)),!a.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),f=!0}function j(){xs=ts(gs),As=ts(gs,a.draggable),ms({sortable:p,name:"change",toEl:r,newIndex:xs,newDraggableIndex:As,originalEvent:e})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){Bn(document,"mousemove",this._onTouchMove),Bn(document,"touchmove",this._onTouchMove),Bn(document,"pointermove",this._onTouchMove),Bn(document,"dragover",sr),Bn(document,"mousemove",sr),Bn(document,"touchmove",sr)},_offUpEvents:function(){var e=this.el.ownerDocument;Bn(e,"mouseup",this._onDrop),Bn(e,"touchend",this._onDrop),Bn(e,"pointerup",this._onDrop),Bn(e,"touchcancel",this._onDrop),Bn(document,"selectstart",this)},_onDrop:function(e){var t=this.el,i=this.options;xs=ts(gs),As=ts(gs,i.draggable),fs("drop",this,{evt:e}),vs=gs&&gs.parentNode,xs=ts(gs),As=ts(gs,i.draggable),or.eventCanceled||(zs=!1,Us=!1,$s=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),ur(this.cloneId),ur(this._dragStartId),this.nativeDraggable&&(Bn(document,"drop",this),Bn(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Mn&&Gn(document.body,"user-select",""),Gn(gs,"transform",""),e&&(Ps&&(e.cancelable&&e.preventDefault(),!i.dropBubble&&e.stopPropagation()),_s&&_s.parentNode&&_s.parentNode.removeChild(_s),(bs===vs||Is&&"clone"!==Is.lastPutMode)&&ws&&ws.parentNode&&ws.parentNode.removeChild(ws),gs&&(this.nativeDraggable&&Bn(gs,"dragend",this),lr(gs),gs.style["will-change"]="",Ps&&!zs&&qn(gs,Is?Is.options.ghostClass:this.options.ghostClass,!1),qn(gs,this.options.chosenClass,!1),ms({sortable:this,name:"unchoose",toEl:vs,newIndex:null,newDraggableIndex:null,originalEvent:e}),bs!==vs?(xs>=0&&(ms({rootEl:vs,name:"add",toEl:vs,fromEl:bs,originalEvent:e}),ms({sortable:this,name:"remove",toEl:vs,originalEvent:e}),ms({rootEl:vs,name:"sort",toEl:vs,fromEl:bs,originalEvent:e}),ms({sortable:this,name:"sort",toEl:vs,originalEvent:e})),Is&&Is.save()):xs!==Es&&xs>=0&&(ms({sortable:this,name:"update",toEl:vs,originalEvent:e}),ms({sortable:this,name:"sort",toEl:vs,originalEvent:e})),or.active&&(null!=xs&&-1!==xs||(xs=Es,As=Ts),ms({sortable:this,name:"end",toEl:vs,originalEvent:e}),this.save())))),this._nulling()},_nulling:function(){fs("nulling",this),bs=gs=vs=_s=ys=ws=Cs=Ss=ks=Ds=Ps=xs=As=Es=Ts=Ns=Fs=Is=Os=or.dragged=or.ghost=or.clone=or.active=null,Ks.forEach((function(e){e.checked=!0})),Ks.length=js=Rs=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":gs&&(this._onDragOver(e),function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}(e));break;case"selectstart":e.preventDefault()}},toArray:function(){for(var e,t=[],i=this.el.children,n=0,s=i.length,r=this.options;n<s;n++)Wn(e=i[n],r.draggable,this.el,!1)&&t.push(e.getAttribute(r.dataIdAttr)||hr(e));return t},sort:function(e,t){var i={},n=this.el;this.toArray().forEach((function(e,t){var s=n.children[t];Wn(s,this.options.draggable,n,!1)&&(i[e]=s)}),this),t&&this.captureAnimationState(),e.forEach((function(e){i[e]&&(n.removeChild(i[e]),n.appendChild(i[e]))})),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return Wn(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var i=this.options;if(void 0===t)return i[e];var n=us.modifyOption(this,e,t);i[e]=void 0!==n?n:t,"group"===e&&tr(i)},destroy:function(){fs("destroy",this);var e=this.el;e[cs]=null,Bn(e,"mousedown",this._onTapStart),Bn(e,"touchstart",this._onTapStart),Bn(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(Bn(e,"dragover",this),Bn(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),(function(e){e.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),Ws.splice(Ws.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Ss){if(fs("hideClone",this),or.eventCanceled)return;Gn(ws,"display","none"),this.options.removeCloneOnHide&&ws.parentNode&&ws.parentNode.removeChild(ws),Ss=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(Ss){if(fs("showClone",this),or.eventCanceled)return;gs.parentNode!=bs||this.options.group.revertClone?ys?bs.insertBefore(ws,ys):bs.appendChild(ws):bs.insertBefore(ws,gs),this.options.group.revertClone&&this.animate(gs,ws),Gn(ws,"display",""),Ss=!1}}else this._hideClone()}},Ys&&Hn(document,"touchmove",(function(e){(or.active||zs)&&e.cancelable&&e.preventDefault()})),or.utils={on:Hn,off:Bn,css:Gn,find:Yn,is:function(e,t){return!!Wn(e,t,e,!1)},extend:function(e,t){if(e&&t)for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},throttle:rs,closest:Wn,toggleClass:qn,clone:as,index:ts,nextTick:dr,cancelNextTick:ur,detectDirection:er,getChild:Jn,expando:cs},or.get=function(e){return e[cs]},or.mount=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t[0].constructor===Array&&(t=t[0]),t.forEach((function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(or.utils=An(An({},or.utils),e.utils)),us.mount(e)}))},or.create=function(e,t){return new or(e,t)},or.version="1.15.3";var pr,fr,mr,gr,vr,_r,br=[],yr=!1;function Cr(){br.forEach((function(e){clearInterval(e.pid)})),br=[]}function wr(){clearInterval(_r)}var Sr=rs((function(e,t,i,n){if(t.scroll){var s,r=(e.touches?e.touches[0]:e).clientX,o=(e.touches?e.touches[0]:e).clientY,a=t.scrollSensitivity,l=t.scrollSpeed,c=Xn(),h=!1;fr!==i&&(fr=i,Cr(),pr=t.scroll,s=t.scrollFn,!0===pr&&(pr=ns(i,!0)));var d=0,u=pr;do{var p=u,f=Zn(p),m=f.top,g=f.bottom,v=f.left,_=f.right,b=f.width,y=f.height,C=void 0,w=void 0,S=p.scrollWidth,E=p.scrollHeight,x=Gn(p),T=p.scrollLeft,A=p.scrollTop;p===c?(C=b<S&&("auto"===x.overflowX||"scroll"===x.overflowX||"visible"===x.overflowX),w=y<E&&("auto"===x.overflowY||"scroll"===x.overflowY||"visible"===x.overflowY)):(C=b<S&&("auto"===x.overflowX||"scroll"===x.overflowX),w=y<E&&("auto"===x.overflowY||"scroll"===x.overflowY));var O=C&&(Math.abs(_-r)<=a&&T+b<S)-(Math.abs(v-r)<=a&&!!T),I=w&&(Math.abs(g-o)<=a&&A+y<E)-(Math.abs(m-o)<=a&&!!A);if(!br[d])for(var k=0;k<=d;k++)br[k]||(br[k]={});br[d].vx==O&&br[d].vy==I&&br[d].el===p||(br[d].el=p,br[d].vx=O,br[d].vy=I,clearInterval(br[d].pid),0==O&&0==I||(h=!0,br[d].pid=setInterval(function(){n&&0===this.layer&&or.active._onTouchMove(vr);var t=br[this.layer].vy?br[this.layer].vy*l:0,i=br[this.layer].vx?br[this.layer].vx*l:0;"function"==typeof s&&"continue"!==s.call(or.dragged.parentNode[cs],i,t,e,vr,br[this.layer].el)||os(br[this.layer].el,i,t)}.bind({layer:d}),24))),d++}while(t.bubbleScroll&&u!==c&&(u=ns(u,!1)));yr=h}}),30),Er=function(e){var t=e.originalEvent,i=e.putSortable,n=e.dragEl,s=e.activeSortable,r=e.dispatchSortableEvent,o=e.hideGhostForTarget,a=e.unhideGhostForTarget;if(t){var l=i||s;o();var c=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,h=document.elementFromPoint(c.clientX,c.clientY);a(),l&&!l.el.contains(h)&&(r("spill"),this.onSpill({dragEl:n,putSortable:i}))}};function xr(){}function Tr(){}xr.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,i=e.putSortable;this.sortable.captureAnimationState(),i&&i.captureAnimationState();var n=Jn(this.sortable.el,this.startIndex,this.options);n?this.sortable.el.insertBefore(t,n):this.sortable.el.appendChild(t),this.sortable.animateAll(),i&&i.animateAll()},drop:Er},kn(xr,{pluginName:"revertOnSpill"}),Tr.prototype={onSpill:function(e){var t=e.dragEl,i=e.putSortable||this.sortable;i.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),i.animateAll()},drop:Er},kn(Tr,{pluginName:"removeOnSpill"}),or.mount(new function(){function e(){for(var e in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"==typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){var t=e.originalEvent;this.sortable.nativeDraggable?Hn(document,"dragover",this._handleAutoScroll):this.options.supportPointer?Hn(document,"pointermove",this._handleFallbackAutoScroll):t.touches?Hn(document,"touchmove",this._handleFallbackAutoScroll):Hn(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var t=e.originalEvent;this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?Bn(document,"dragover",this._handleAutoScroll):(Bn(document,"pointermove",this._handleFallbackAutoScroll),Bn(document,"touchmove",this._handleFallbackAutoScroll),Bn(document,"mousemove",this._handleFallbackAutoScroll)),wr(),Cr(),clearTimeout($n),$n=void 0},nulling:function(){vr=fr=pr=yr=_r=mr=gr=null,br.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,t){var i=this,n=(e.touches?e.touches[0]:e).clientX,s=(e.touches?e.touches[0]:e).clientY,r=document.elementFromPoint(n,s);if(vr=e,t||this.options.forceAutoScrollFallback||Rn||jn||Mn){Sr(e,this.options,r,t);var o=ns(r,!0);!yr||_r&&n===mr&&s===gr||(_r&&wr(),_r=setInterval((function(){var r=ns(document.elementFromPoint(n,s),!0);r!==o&&(o=r,Cr()),Sr(e,i.options,r,t)}),10),mr=n,gr=s)}else{if(!this.options.bubbleScroll||ns(r,!0)===Xn())return void Cr();Sr(e,this.options,ns(r,!1),!1)}}},kn(e,{pluginName:"scroll",initializeByDefault:!0})}),or.mount(Tr,xr);const Ar=or;function Or(e){let{containerElement:t}=e;const{onDragInit:i,onDragStart:n,onDrag:s,onDragEnd:r,preventDragFromKeys:o}=e;let a,l,c,h,d,u;t||(t=document.body);let p={dragSource:t,dragHandle:null};function f(e,t,i){if("function"==typeof e)return e(t,i)}function m(e){let t=!1;return o&&o.forEach((i=>{e[i]&&(t=!0)})),t}function g(t){if(a=t.target,!m(t)){const n=t?.touches?.[0]??t,{target:s}=n;if(!e.allowDragFrom||e.allowDragFrom&&a.matches(e.allowDragFrom)||e.allowDragFromClosest&&a.closest(e.allowDragFromClosest)){p.dragHandle=a;const e=ue();l=e.left+n.clientX,c=e.top+n.clientY,h=n.clientX-n.clientX,d=n.clientY-n.clientY,p=Object.assign(p,{deltaX:h,deltaY:d,startX:l,startY:c,target:s}),!1!==f(i,t,p)&&(document.body.addEventListener("mousemove",v),document.body.addEventListener("touchmove",v),document.body.addEventListener("mouseup",_),document.body.addEventListener("touchend",_),document.body.addEventListener("touchcancel",_))}}}function v(e){const t=e?.touches?.[0]??e;if(!m(e)){h=t.clientX-l,d=t.clientY-c;const{target:i}=t;u||(p=Object.assign(p,{deltaX:h,deltaY:d,startX:l,startY:c,target:i}),f(n,e,p),u=!0),p=Object.assign(p,{deltaX:h,deltaY:d,startX:l,startY:c,target:i}),f(s,e,p)}}function _(e){if(document.body.removeEventListener("mousemove",v),document.body.removeEventListener("touchmove",v),document.body.removeEventListener("mouseup",_),document.body.removeEventListener("touchend",_),document.body.removeEventListener("touchcancel",_),u){const{target:t}=e;p=Object.assign(p,{target:t}),f(r,e,p),u=!1}}return t&&(t.addEventListener("mousedown",g),t.addEventListener("touchstart",g)),{destroy:function(){t&&(t.removeEventListener("mousedown",g),t.removeEventListener("touchstart",g))}}}function Ir(e){const{element:t,onMouseWheel:i}=e;function n(e){const t=e||window.event;let n=0,s=0,r=0;t.wheelDelta&&(n=t.wheelDelta/120),t.detail&&(n=-t.detail/3),r=n,void 0!==t.axis&&t.axis===t.HORIZONTAL_AXIS&&(r=0,s=-1*n),void 0!==t.wheelDeltaY&&(r=t.wheelDeltaY/120),void 0!==t.wheelDeltaX&&(s=-1*t.wheelDeltaX/120),"function"==typeof i&&i(e,n,s,r)}return t.addEventListener("wheel",n),t.addEventListener("mousewheel",n),{destroy:function(){t.removeEventListener("wheel",n),t.removeEventListener("mousewheel",n)}}}function kr(e){const{resizeableElement:t,resizeableHandleElement:i,onResizeStart:n,onResize:s,onResizeEnd:r}=e;if(!i||"function"!=typeof i.addEventListener)throw new Error("[SlickResizable] You did not provide a valid html element that will be used for the handle to resize.");function o(e,n){if("function"==typeof e)return e(n,{resizeableElement:t,resizeableHandleElement:i})}function a(e){e.preventDefault();const t=e.touches?e.changedTouches[0]:e;!1!==o(n,t)&&(document.body.addEventListener("mousemove",l),document.body.addEventListener("mouseup",c),document.body.addEventListener("touchmove",l),document.body.addEventListener("touchend",c))}function l(e){e.preventDefault&&"touchmove"!==e.type&&e.preventDefault();const n=e.touches?e.changedTouches[0]:e;"function"==typeof s&&s(n,{resizeableElement:t,resizeableHandleElement:i})}function c(e){const t=e.touches?e.changedTouches[0]:e;o(r,t),document.body.removeEventListener("mousemove",l),document.body.removeEventListener("mouseup",c),document.body.removeEventListener("touchmove",l),document.body.removeEventListener("touchend",c)}return i.addEventListener("mousedown",a),i.addEventListener("touchstart",a),{destroy:function(){"function"==typeof i?.removeEventListener&&(i.removeEventListener("mousedown",a),i.removeEventListener("touchstart",a))}}}class Dr{constructor(e,t,i,n,s){if(this.container=e,this.data=t,this.columns=i,this.externalPubSub=s,this.cid="",this.canvas=null,this.canvas_context=null,this._defaults={alwaysShowVerticalScroll:!1,alwaysAllowHorizontalScroll:!1,explicitInitialization:!1,rowHeight:25,defaultColumnWidth:80,enableHtmlRendering:!0,enableAddRow:!1,leaveSpaceForNewRows:!1,editable:!1,autoEdit:!0,autoEditNewRow:!0,autoCommitEdit:!1,suppressActiveCellChangeOnEdit:!1,enableCellNavigation:!0,enableColumnReorder:!0,unorderableColumnCssClass:"unorderable",asyncEditorLoading:!1,asyncEditorLoadDelay:100,forceFitColumns:!1,enableAsyncPostRender:!1,asyncPostRenderDelay:50,enableAsyncPostRenderCleanup:!1,asyncPostRenderCleanupDelay:40,columnResizingDelay:300,nonce:"",editorLock:Sn,showColumnHeader:!0,showHeaderRow:!1,headerRowHeight:25,createFooterRow:!1,showFooterRow:!1,footerRowHeight:25,createPreHeaderPanel:!1,createTopHeaderPanel:!1,showPreHeaderPanel:!1,showTopHeaderPanel:!1,preHeaderPanelHeight:25,preHeaderPanelWidth:"auto",topHeaderPanelHeight:25,topHeaderPanelWidth:"auto",showTopPanel:!1,topPanelHeight:25,formatterFactory:null,editorFactory:null,cellFlashingCssClass:"flashing",rowHighlightCssClass:"highlight-animate",rowHighlightDuration:400,selectedCellCssClass:"selected",multiSelect:!0,enableTextSelectionOnCells:!1,dataItemColumnValueExtractor:null,frozenBottom:!1,frozenColumn:-1,frozenRow:-1,frozenRightViewportMinWidth:100,throwWhenFrozenNotAllViewable:!1,fullWidthRows:!1,multiColumnSort:!1,numberedMultiColumnSort:!1,tristateMultiColumnSort:!1,sortColNumberInSeparateSpan:!1,defaultFormatter:this.defaultFormatter,forceSyncScrolling:!1,addNewRowCssClass:"new-row",preserveCopiedSelectionOnPaste:!1,preventDragFromKeys:["ctrlKey","metaKey"],showCellSelection:!0,viewportClass:void 0,minRowBuffer:3,emulatePagingWhenScrolling:!0,editorCellNavOnLRKeys:!1,enableMouseWheelScrollHandler:!0,doPaging:!0,rowTopOffsetRenderType:"top",scrollRenderThrottling:10,suppressCssChangesOnHiddenInit:!1,ffMaxSupportedCssHeight:6e6,maxSupportedCssHeight:1e9,sanitizer:void 0,mixinDefaults:!1,shadowRoot:void 0},this._columnDefaults={name:"",headerCssClass:null,defaultSortAsc:!0,focusable:!0,hidden:!1,minWidth:30,maxWidth:void 0,rerenderOnResize:!1,reorderable:!0,resizable:!0,sortable:!1,selectable:!0},this.page=0,this.offset=0,this.vScrollDir=1,this._bindingEventService=new Ft,this.initialized=!1,this.uid=`slickgrid_${Math.round(1e6*Math.random())}`,this._groupHeaders=[],this._headerScroller=[],this._headers=[],this._boundAncestors=[],this.viewportH=0,this.viewportW=0,this.canvasWidth=0,this.canvasWidthL=0,this.canvasWidthR=0,this.headersWidth=0,this.headersWidthL=0,this.headersWidthR=0,this.viewportHasHScroll=!1,this.viewportHasVScroll=!1,this.headerColumnWidthDiff=0,this.headerColumnHeightDiff=0,this.cellWidthDiff=0,this.cellHeightDiff=0,this.hasFrozenRows=!1,this.frozenRowsHeight=0,this.actualFrozenRow=-1,this.paneTopH=0,this.paneBottomH=0,this.viewportTopH=0,this.viewportBottomH=0,this.topPanelH=0,this.headerRowH=0,this.footerRowH=0,this.tabbingDirection=1,this.activeCellNode=null,this.currentEditor=null,this.rowsCache={},this.renderedRows=0,this.numVisibleRows=0,this.prevScrollTop=0,this.scrollHeight=0,this.scrollTop=0,this.lastRenderedScrollTop=0,this.lastRenderedScrollLeft=0,this.prevScrollLeft=0,this.scrollLeft=0,this.selectedRows=[],this.plugins=[],this.cellCssClasses={},this.columnsById={},this.sortColumns=[],this.columnPosLeft=[],this.columnPosRight=[],this.pagingActive=!1,this.pagingIsLastPage=!1,this.h_render=null,this.postProcessedRows={},this.postProcessToRow=null,this.postProcessFromRow=null,this.postProcessedCleanupQueue=[],this.postProcessgroupId=0,this.counter_rows_rendered=0,this.counter_rows_removed=0,this.cssShow={position:"absolute",visibility:"hidden",display:"block"},this._hiddenParents=[],this.oldProps=[],this.enforceFrozenRowHeightRecalc=!1,this.columnResizeDragging=!1,this.slickDraggableInstance=null,this.slickMouseWheelInstances=[],this.slickResizableInstances=[],this.logMessageMaxCount=30,this._container="string"==typeof this.container?document.querySelector(this.container):this.container,!this._container)throw new Error(`SlickGrid requires a valid container, ${this.container} does not exist in the DOM.`);this._pubSubService=s,this.onActiveCellChanged=new gn("onActiveCellChanged",s),this.onActiveCellPositionChanged=new gn("onActiveCellPositionChanged",s),this.onAddNewRow=new gn("onAddNewRow",s),this.onAfterSetColumns=new gn("onAfterSetColumns",s),this.onAutosizeColumns=new gn("onAutosizeColumns",s),this.onBeforeAppendCell=new gn("onBeforeAppendCell",s),this.onBeforeCellEditorDestroy=new gn("onBeforeCellEditorDestroy",s),this.onBeforeColumnsResize=new gn("onBeforeColumnsResize",s),this.onBeforeDestroy=new gn("onBeforeDestroy",s),this.onBeforeEditCell=new gn("onBeforeEditCell",s),this.onBeforeFooterRowCellDestroy=new gn("onBeforeFooterRowCellDestroy",s),this.onBeforeHeaderCellDestroy=new gn("onBeforeHeaderCellDestroy",s),this.onBeforeHeaderRowCellDestroy=new gn("onBeforeHeaderRowCellDestroy",s),this.onBeforeSetColumns=new gn("onBeforeSetColumns",s),this.onBeforeSort=new gn("onBeforeSort",s),this.onBeforeUpdateColumns=new gn("onBeforeUpdateColumns",s),this.onCellChange=new gn("onCellChange",s),this.onCellCssStylesChanged=new gn("onCellCssStylesChanged",s),this.onClick=new gn("onClick",s),this.onColumnsReordered=new gn("onColumnsReordered",s),this.onColumnsDrag=new gn("onColumnsDrag",s),this.onColumnsResized=new gn("onColumnsResized",s),this.onColumnsResizeDblClick=new gn("onColumnsResizeDblClick",s),this.onCompositeEditorChange=new gn("onCompositeEditorChange",s),this.onContextMenu=new gn("onContextMenu",s),this.onDblClick=new gn("onDblClick",s),this.onDrag=new gn("onDrag",s),this.onDragInit=new gn("onDragInit",s),this.onDragStart=new gn("onDragStart",s),this.onDragEnd=new gn("onDragEnd",s),this.onFooterClick=new gn("onFooterClick",s),this.onFooterContextMenu=new gn("onFooterContextMenu",s),this.onFooterRowCellRendered=new gn("onFooterRowCellRendered",s),this.onHeaderCellRendered=new gn("onHeaderCellRendered",s),this.onHeaderClick=new gn("onHeaderClick",s),this.onHeaderContextMenu=new gn("onHeaderContextMenu",s),this.onHeaderMouseEnter=new gn("onHeaderMouseEnter",s),this.onHeaderMouseLeave=new gn("onHeaderMouseLeave",s),this.onHeaderMouseOver=new gn("onHeaderMouseOver",s),this.onHeaderMouseOut=new gn("onHeaderMouseOut",s),this.onHeaderRowMouseOver=new gn("onHeaderRowMouseOver",s),this.onHeaderRowMouseOut=new gn("onHeaderRowMouseOut",s),this.onHeaderRowCellRendered=new gn("onHeaderRowCellRendered",s),this.onHeaderRowMouseEnter=new gn("onHeaderRowMouseEnter",s),this.onHeaderRowMouseLeave=new gn("onHeaderRowMouseLeave",s),this.onKeyDown=new gn("onKeyDown",s),this.onMouseEnter=new gn("onMouseEnter",s),this.onMouseLeave=new gn("onMouseLeave",s),this.onPreHeaderClick=new gn("onPreHeaderClick",s),this.onPreHeaderContextMenu=new gn("onPreHeaderContextMenu",s),this.onRendered=new gn("onRendered",s),this.onScroll=new gn("onScroll",s),this.onSelectedRowsChanged=new gn("onSelectedRowsChanged",s),this.onSetOptions=new gn("onSetOptions",s),this.onActivateChangedOptions=new gn("onActivateChangedOptions",s),this.onSort=new gn("onSort",s),this.onValidationError=new gn("onValidationError",s),this.onViewportChanged=new gn("onViewportChanged",s),this.initialize(n)}init(){!this._options.silenceWarnings&&document.body.style.zoom&&"100%"!==document.body.style.zoom&&console.warn("[Slickgrid-Universal] Zoom level other than 100% is not supported by the library and will give subpar experience. SlickGrid relies on the `rowHeight` grid option to do row positioning & calculation and when zoom is not 100% then calculation becomes all offset."),this.finishInitialization()}applyHtmlCode(e,t="",i){if(e)if(t instanceof HTMLElement||t instanceof DocumentFragment)!1!==i?.emptyTarget&&ee(e),e.appendChild(t);else{if(!1!==i?.skipEmptyReassignment&&!ke(t)&&!e.innerHTML)return;if("number"==typeof t||"boolean"==typeof t)e.textContent=String(t);else{const i=this.sanitizeHtmlString(t);this._options.enableHtmlRendering&&i?e.innerHTML=i:e.textContent=i}}}initialize(e){if(e?.mixinDefaults?(this._options||(this._options=e),wn.applyDefaults(this._options,this._defaults)):this._options=Ce(!0,{},this._defaults,e),this.scrollThrottle=this.actionThrottle(this.render.bind(this),this._options.scrollRenderThrottling),this.maxSupportedCssHeight=this.maxSupportedCssHeight||this.getMaxSupportedCssHeight(),this.validateAndEnforceOptions(),this._columnDefaults.width=this._options.defaultColumnWidth,this._options.suppressCssChangesOnHiddenInit||this.cacheCssForHiddenInit(),this.updateColumnProps(),this._options.enableColumnReorder&&(!Ar||!Ar.create))throw new Error("SlickGrid requires Sortable.js module to be loaded");this.editController={commitCurrentEdit:this.commitCurrentEdit.bind(this),cancelCurrentEdit:this.cancelCurrentEdit.bind(this)},ee(this._container),this._container.style.outline=String(0),this._container.classList.add(this.uid),this._container.classList.add("slick-widget"),this._container.setAttribute("role","grid");const t=window.getComputedStyle(this._container);/relative|absolute|fixed/.test(t.position)||(this._container.style.position="relative"),this._focusSink=Z("div",{tabIndex:0,style:{position:"fixed",width:"0px",height:"0px",top:"0px",left:"0px",outline:"0px"}},this._container),this._options.createTopHeaderPanel&&(this._topHeaderPanelScroller=Z("div",{className:"slick-topheader-panel slick-state-default",style:{overflow:"hidden",position:"relative"}},this._container),this._topHeaderPanelScroller.appendChild(document.createElement("div")),this._topHeaderPanel=Z("div",null,this._topHeaderPanelScroller),this._topHeaderPanelSpacer=Z("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._topHeaderPanelScroller),this._options.showTopHeaderPanel||wn.hide(this._topHeaderPanelScroller)),this._paneHeaderL=Z("div",{className:"slick-pane slick-pane-header slick-pane-left",tabIndex:0},this._container),this._paneHeaderR=Z("div",{className:"slick-pane slick-pane-header slick-pane-right",tabIndex:0},this._container),this._paneTopL=Z("div",{className:"slick-pane slick-pane-top slick-pane-left",tabIndex:0},this._container),this._paneTopR=Z("div",{className:"slick-pane slick-pane-top slick-pane-right",tabIndex:0},this._container),this._paneBottomL=Z("div",{className:"slick-pane slick-pane-bottom slick-pane-left",tabIndex:0},this._container),this._paneBottomR=Z("div",{className:"slick-pane slick-pane-bottom slick-pane-right",tabIndex:0},this._container),this._options.createPreHeaderPanel&&(this._preHeaderPanelScroller=Z("div",{className:"slick-preheader-panel slick-state-default",style:{overflow:"hidden",position:"relative"}},this._paneHeaderL),this._preHeaderPanelScroller.appendChild(document.createElement("div")),this._preHeaderPanel=Z("div",null,this._preHeaderPanelScroller),this._preHeaderPanelSpacer=Z("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._preHeaderPanelScroller),this._preHeaderPanelScrollerR=Z("div",{className:"slick-preheader-panel slick-state-default",style:{overflow:"hidden",position:"relative"}},this._paneHeaderR),this._preHeaderPanelR=Z("div",null,this._preHeaderPanelScrollerR),this._preHeaderPanelSpacerR=Z("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._preHeaderPanelScrollerR),this._options.showPreHeaderPanel||(wn.hide(this._preHeaderPanelScroller),wn.hide(this._preHeaderPanelScrollerR))),this._headerScrollerL=Z("div",{className:"slick-header slick-state-default slick-header-left"},this._paneHeaderL),this._headerScrollerR=Z("div",{className:"slick-header slick-state-default slick-header-right"},this._paneHeaderR),this._headerScroller.push(this._headerScrollerL),this._headerScroller.push(this._headerScrollerR),this._headerL=Z("div",{className:"slick-header-columns slick-header-columns-left",style:{left:"-1000px"}},this._headerScrollerL),this._headerR=Z("div",{className:"slick-header-columns slick-header-columns-right",style:{left:"-1000px"}},this._headerScrollerR),this._headers=[this._headerL,this._headerR],this._headerRowScrollerL=Z("div",{className:"slick-headerrow slick-state-default"},this._paneTopL),this._headerRowScrollerR=Z("div",{className:"slick-headerrow slick-state-default"},this._paneTopR),this._headerRowScroller=[this._headerRowScrollerL,this._headerRowScrollerR],this._headerRowSpacerL=Z("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._headerRowScrollerL),this._headerRowSpacerR=Z("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._headerRowScrollerR),this._headerRowL=Z("div",{className:"slick-headerrow-columns slick-headerrow-columns-left"},this._headerRowScrollerL),this._headerRowR=Z("div",{className:"slick-headerrow-columns slick-headerrow-columns-right"},this._headerRowScrollerR),this._headerRows=[this._headerRowL,this._headerRowR],this._topPanelScrollerL=Z("div",{className:"slick-top-panel-scroller slick-state-default"},this._paneTopL),this._topPanelScrollerR=Z("div",{className:"slick-top-panel-scroller slick-state-default"},this._paneTopR),this._topPanelScrollers=[this._topPanelScrollerL,this._topPanelScrollerR],this._topPanelL=Z("div",{className:"slick-top-panel",style:{width:"10000px"}},this._topPanelScrollerL),this._topPanelR=Z("div",{className:"slick-top-panel",style:{width:"10000px"}},this._topPanelScrollerR),this._topPanels=[this._topPanelL,this._topPanelR],this._options.showColumnHeader||this._headerScroller.forEach((e=>{wn.hide(e)})),this._options.showTopPanel||this._topPanelScrollers.forEach((e=>{wn.hide(e)})),this._options.showHeaderRow||this._headerRowScroller.forEach((e=>{wn.hide(e)})),this._viewportTopL=Z("div",{className:"slick-viewport slick-viewport-top slick-viewport-left",tabIndex:0},this._paneTopL),this._viewportTopR=Z("div",{className:"slick-viewport slick-viewport-top slick-viewport-right",tabIndex:0},this._paneTopR),this._viewportBottomL=Z("div",{className:"slick-viewport slick-viewport-bottom slick-viewport-left",tabIndex:0},this._paneBottomL),this._viewportBottomR=Z("div",{className:"slick-viewport slick-viewport-bottom slick-viewport-right",tabIndex:0},this._paneBottomR),this._viewport=[this._viewportTopL,this._viewportTopR,this._viewportBottomL,this._viewportBottomR],this._options.viewportClass&&this._viewport.forEach((e=>{e.classList.add(...Q(this._options.viewportClass))})),this._activeViewportNode=this._viewportTopL,this._canvasTopL=Z("div",{className:"grid-canvas grid-canvas-top grid-canvas-left",tabIndex:0},this._viewportTopL),this._canvasTopR=Z("div",{className:"grid-canvas grid-canvas-top grid-canvas-right",tabIndex:0},this._viewportTopR),this._canvasBottomL=Z("div",{className:"grid-canvas grid-canvas-bottom grid-canvas-left",tabIndex:0},this._viewportBottomL),this._canvasBottomR=Z("div",{className:"grid-canvas grid-canvas-bottom grid-canvas-right",tabIndex:0},this._viewportBottomR),this._canvas=[this._canvasTopL,this._canvasTopR,this._canvasBottomL,this._canvasBottomR],this.scrollbarDimensions=this.scrollbarDimensions||this.measureScrollbar(),this._activeCanvasNode=this._canvasTopL,this._topHeaderPanelSpacer&&wn.width(this._topHeaderPanelSpacer,this.getCanvasWidth()+this.scrollbarDimensions.width),this._preHeaderPanelSpacer&&wn.width(this._preHeaderPanelSpacer,this.getCanvasWidth()+this.scrollbarDimensions.width),this._headers.forEach((e=>{wn.width(e,this.getHeadersWidth())})),wn.width(this._headerRowSpacerL,this.getCanvasWidth()+this.scrollbarDimensions.width),wn.width(this._headerRowSpacerR,this.getCanvasWidth()+this.scrollbarDimensions.width),this._options.createFooterRow&&(this._footerRowScrollerR=Z("div",{className:"slick-footerrow slick-state-default"},this._paneTopR),this._footerRowScrollerL=Z("div",{className:"slick-footerrow slick-state-default"},this._paneTopL),this._footerRowScroller=[this._footerRowScrollerL,this._footerRowScrollerR],this._footerRowSpacerL=Z("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._footerRowScrollerL),wn.width(this._footerRowSpacerL,this.getCanvasWidth()+this.scrollbarDimensions.width),this._footerRowSpacerR=Z("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._footerRowScrollerR),wn.width(this._footerRowSpacerR,this.getCanvasWidth()+this.scrollbarDimensions.width),this._footerRowL=Z("div",{className:"slick-footerrow-columns slick-footerrow-columns-left"},this._footerRowScrollerL),this._footerRowR=Z("div",{className:"slick-footerrow-columns slick-footerrow-columns-right"},this._footerRowScrollerR),this._footerRow=[this._footerRowL,this._footerRowR],this._options.showFooterRow||this._footerRowScroller.forEach((e=>{wn.hide(e)}))),this._focusSink2=this._focusSink.cloneNode(!0),this._container.appendChild(this._focusSink2),this._options.explicitInitialization||this.finishInitialization()}finishInitialization(){this.initialized||(this.initialized=!0,this.getViewportWidth(),this.getViewportHeight(),this.measureCellPaddingAndBorder(),this.disableSelection(this._headers),this._options.enableTextSelectionOnCells||this._viewport.forEach((e=>{this._bindingEventService.bind(e,"selectstart",(e=>{e.target instanceof HTMLInputElement||(e.target,HTMLTextAreaElement)}))})),this.setFrozenOptions(),this.setPaneVisibility(),this.setScroller(),this.setOverflow(),this.updateColumnCaches(),this.createColumnHeaders(),this.createColumnFooter(),this.setupColumnSort(),this.createCssRules(),this.resizeCanvas(),this.bindAncestorScrollEvents(),this._bindingEventService.bind(this._container,"resize",this.resizeCanvas.bind(this)),this._viewport.forEach((e=>{this._bindingEventService.bind(e,"scroll",this.handleScroll.bind(this))})),this._options.enableMouseWheelScrollHandler&&this._viewport.forEach((e=>{this.slickMouseWheelInstances.push(Ir({element:e,onMouseWheel:this.handleMouseWheel.bind(this)}))})),this._headerScroller.forEach((e=>{this._bindingEventService.bind(e,"contextmenu",this.handleHeaderContextMenu.bind(this)),this._bindingEventService.bind(e,"click",this.handleHeaderClick.bind(this))})),this._headerRowScroller.forEach((e=>{this._bindingEventService.bind(e,"scroll",this.handleHeaderRowScroll.bind(this))})),this._options.createFooterRow&&(this._footerRow.forEach((e=>{this._bindingEventService.bind(e,"contextmenu",this.handleFooterContextMenu.bind(this)),this._bindingEventService.bind(e,"click",this.handleFooterClick.bind(this))})),this._footerRowScroller.forEach((e=>{this._bindingEventService.bind(e,"scroll",this.handleFooterRowScroll.bind(this))}))),this._options.createTopHeaderPanel&&this._bindingEventService.bind(this._topHeaderPanelScroller,"scroll",this.handleTopHeaderPanelScroll.bind(this)),this._options.createPreHeaderPanel&&(this._bindingEventService.bind(this._preHeaderPanelScroller,"scroll",this.handlePreHeaderPanelScroll.bind(this)),this._bindingEventService.bind([this._preHeaderPanelScroller,this._preHeaderPanelScrollerR],"contextmenu",this.handlePreHeaderContextMenu.bind(this)),this._bindingEventService.bind([this._preHeaderPanelScroller,this._preHeaderPanelScrollerR],"click",this.handlePreHeaderClick.bind(this))),this._bindingEventService.bind(this._focusSink,"keydown",this.handleKeyDown.bind(this)),this._bindingEventService.bind(this._focusSink2,"keydown",this.handleKeyDown.bind(this)),this._canvas.forEach((e=>{this._bindingEventService.bind(e,"keydown",this.handleKeyDown.bind(this)),this._bindingEventService.bind(e,"click",this.handleClick.bind(this)),this._bindingEventService.bind(e,"dblclick",this.handleDblClick.bind(this)),this._bindingEventService.bind(e,"contextmenu",this.handleContextMenu.bind(this)),this._bindingEventService.bind(e,"mouseover",this.handleCellMouseOver.bind(this)),this._bindingEventService.bind(e,"mouseout",this.handleCellMouseOut.bind(this))})),Or&&(this.slickDraggableInstance=Or({containerElement:this._container,allowDragFrom:"div.slick-cell",allowDragFromClosest:"div.slick-cell.dnd, div.slick-cell.cell-reorder",preventDragFromKeys:this._options.preventDragFromKeys,onDragInit:this.handleDragInit.bind(this),onDragStart:this.handleDragStart.bind(this),onDrag:this.handleDrag.bind(this),onDragEnd:this.handleDragEnd.bind(this)})),this._options.suppressCssChangesOnHiddenInit||this.restoreCssFromHiddenInit())}cacheCssForHiddenInit(){this._hiddenParents=wn.parents(this._container,":hidden"),this._hiddenParents.forEach((e=>{const t={};Object.keys(this.cssShow).forEach((i=>{this.cssShow&&(t[i]=e.style[i],e.style[i]=this.cssShow[i])})),this.oldProps.push(t)}))}restoreCssFromHiddenInit(){let e=0;this._hiddenParents&&this._hiddenParents.forEach((t=>{const i=this.oldProps[e++];Object.keys(this.cssShow).forEach((e=>{this.cssShow&&(t.style[e]=i[e])}))}))}hasFrozenColumns(){return this._options.frozenColumn>-1}registerPlugin(e){this.plugins.unshift(e),e.init(this)}unregisterPlugin(e){for(let t=this.plugins.length;t>=0;t--)if(this.plugins[t]===e){this.plugins[t]?.destroy(),this.plugins.splice(t,1);break}}getPluginByName(e){for(let t=this.plugins.length-1;t>=0;t--)if(this.plugins[t]?.pluginName===e)return this.plugins[t]}getPubSubService(){return this._pubSubService}setSelectionModel(e){this.selectionModel&&(this.selectionModel.onSelectedRangesChanged.unsubscribe(this.handleSelectedRangesChanged.bind(this)),this.selectionModel.destroy&&this.selectionModel.destroy()),this.selectionModel=e,this.selectionModel&&(this.selectionModel.init(this),this.selectionModel.onSelectedRangesChanged.subscribe(this.handleSelectedRangesChanged.bind(this)))}getSelectionModel(){return this.selectionModel}getCanvasNode(e,t){return this._getContainerElement(this.getCanvases(),e,t)}getActiveCanvasNode(e){return void 0===e||(e instanceof mn&&(e=e.getNativeEvent()),this._activeCanvasNode=e?.target?.closest(".grid-canvas")),this._activeCanvasNode}getCanvases(){return this._canvas}getViewportNode(e,t){return this._getContainerElement(this.getViewports(),e,t)}getViewports(){return this._viewport}getActiveViewportNode(e){return this.setActiveViewportNode(e),this._activeViewportNode}setActiveViewportNode(e){return e instanceof mn&&(e=e.getNativeEvent()),this._activeViewportNode=e?.target?.closest(".slick-viewport"),this._activeViewportNode}_getContainerElement(e,t,i){if(!e)return;t||(t=0),i||(i=0);const n="number"==typeof t?t:this.getColumnIndex(t);return e[(this.hasFrozenRows&&i>=this.actualFrozenRow+(this._options.frozenBottom?0:1)?2:0)+(this.hasFrozenColumns()&&n>this._options.frozenColumn?1:0)]}measureScrollbar(){let e="";this._viewport.forEach((t=>e+=t.className));const t=Z("div",{className:e,style:{position:"absolute",top:"-10000px",left:"-10000px",overflow:"auto",width:"100px",height:"100px"}},document.body),i=Z("div",{style:{width:"200px",height:"200px",overflow:"auto"}},t),n={width:t.offsetWidth-t.clientWidth,height:t.offsetHeight-t.clientHeight};return i.remove(),t.remove(),n}getHeadersWidth(){this.headersWidth=this.headersWidthL=this.headersWidthR=0;const e=!this._options.autoHeight;let t=0;const i=this.columns.length;for(t=0;t<i;t++){if(!this.columns[t]||this.columns[t].hidden)continue;const e=this.columns[t].width;this._options.frozenColumn>-1&&t>this._options.frozenColumn?this.headersWidthR+=e||0:this.headersWidthL+=e||0}return e&&(this._options.frozenColumn>-1&&t>this._options.frozenColumn?this.headersWidthR+=this.scrollbarDimensions?.width||0:this.headersWidthL+=this.scrollbarDimensions?.width||0),this.hasFrozenColumns()?(this.headersWidthL=this.headersWidthL+1e3,this.headersWidthR=Math.max(this.headersWidthR,this.viewportW)+this.headersWidthL,this.headersWidthR+=this.scrollbarDimensions?.width||0):(this.headersWidthL+=this.scrollbarDimensions?.width||0,this.headersWidthL=Math.max(this.headersWidthL,this.viewportW)+1e3),this.headersWidth=this.headersWidthL+this.headersWidthR,Math.max(this.headersWidth,this.viewportW)+1e3}getCanvasWidth(){const e=this.viewportHasVScroll?this.viewportW-(this.scrollbarDimensions?.width||0):this.viewportW;let t=this.columns.length;for(this.canvasWidthL=this.canvasWidthR=0;t--;)this.columns[t]&&!this.columns[t].hidden&&(this.hasFrozenColumns()&&t>this._options.frozenColumn?this.canvasWidthR+=this.columns[t].width||0:this.canvasWidthL+=this.columns[t].width||0);let i=this.canvasWidthL+this.canvasWidthR;if(this._options.fullWidthRows){const t=Math.max(i,e)-i;t>0&&(i+=t,this.hasFrozenColumns()?this.canvasWidthR+=t:this.canvasWidthL+=t)}return i}updateCanvasWidth(e){const t=this.canvasWidth,i=this.canvasWidthL,n=this.canvasWidthR;this.canvasWidth=this.getCanvasWidth(),this._options.createTopHeaderPanel&&wn.width(this._topHeaderPanel,this._options.topHeaderPanelWidth??this.canvasWidth);const s=this.canvasWidth!==t||this.canvasWidthL!==i||this.canvasWidthR!==n;if(s||this.hasFrozenColumns()||this.hasFrozenRows)if(wn.width(this._canvasTopL,this.canvasWidthL),this.getHeadersWidth(),wn.width(this._headerL,this.headersWidthL),wn.width(this._headerR,this.headersWidthR),this.hasFrozenColumns()){const e=wn.width(this._container)||0;if(e>0&&this.canvasWidthL>e&&this._options.throwWhenFrozenNotAllViewable)throw new Error("[SlickGrid] Frozen columns cannot be wider than the actual grid container width. Make sure to have less columns freezed or make your grid container wider");wn.width(this._canvasTopR,this.canvasWidthR),wn.width(this._paneHeaderL,this.canvasWidthL),wn.setStyleSize(this._paneHeaderR,"left",this.canvasWidthL),wn.setStyleSize(this._paneHeaderR,"width",this.viewportW-this.canvasWidthL),wn.width(this._paneTopL,this.canvasWidthL),wn.setStyleSize(this._paneTopR,"left",this.canvasWidthL),wn.width(this._paneTopR,this.viewportW-this.canvasWidthL),wn.width(this._headerRowScrollerL,this.canvasWidthL),wn.width(this._headerRowScrollerR,this.viewportW-this.canvasWidthL),wn.width(this._headerRowL,this.canvasWidthL),wn.width(this._headerRowR,this.canvasWidthR),this._options.createFooterRow&&(wn.width(this._footerRowScrollerL,this.canvasWidthL),wn.width(this._footerRowScrollerR,this.viewportW-this.canvasWidthL),wn.width(this._footerRowL,this.canvasWidthL),wn.width(this._footerRowR,this.canvasWidthR)),this._options.createPreHeaderPanel&&wn.width(this._preHeaderPanel,this._options.preHeaderPanelWidth??this.canvasWidth),wn.width(this._viewportTopL,this.canvasWidthL),wn.width(this._viewportTopR,this.viewportW-this.canvasWidthL),this.hasFrozenRows&&(wn.width(this._paneBottomL,this.canvasWidthL),wn.setStyleSize(this._paneBottomR,"left",this.canvasWidthL),wn.width(this._viewportBottomL,this.canvasWidthL),wn.width(this._viewportBottomR,this.viewportW-this.canvasWidthL),wn.width(this._canvasBottomL,this.canvasWidthL),wn.width(this._canvasBottomR,this.canvasWidthR))}else wn.width(this._paneHeaderL,"100%"),wn.width(this._paneTopL,"100%"),wn.width(this._headerRowScrollerL,"100%"),wn.width(this._headerRowL,this.canvasWidth),this._options.createFooterRow&&(wn.width(this._footerRowScrollerL,"100%"),wn.width(this._footerRowL,this.canvasWidth)),this._options.createPreHeaderPanel&&wn.width(this._preHeaderPanel,this._options.preHeaderPanelWidth??this.canvasWidth),wn.width(this._viewportTopL,"100%"),this.hasFrozenRows&&(wn.width(this._viewportBottomL,"100%"),wn.width(this._canvasBottomL,this.canvasWidthL));this.viewportHasHScroll=this.canvasWidth>=this.viewportW-(this.scrollbarDimensions?.width||0),wn.width(this._headerRowSpacerL,this.canvasWidth+(this.viewportHasVScroll&&this.scrollbarDimensions?.width||0)),wn.width(this._headerRowSpacerR,this.canvasWidth+(this.viewportHasVScroll&&this.scrollbarDimensions?.width||0)),this._options.createFooterRow&&(wn.width(this._footerRowSpacerL,this.canvasWidth+(this.viewportHasVScroll&&this.scrollbarDimensions?.width||0)),wn.width(this._footerRowSpacerR,this.canvasWidth+(this.viewportHasVScroll&&this.scrollbarDimensions?.width||0))),(s||e)&&this.applyColumnWidths()}disableSelection(e){e.forEach((e=>{e.setAttribute("unselectable","on"),e.style.mozUserSelect="none",this._bindingEventService.bind(e,"selectstart",(()=>!1))}))}getMaxSupportedCssHeight(){let e=1e6;const t=navigator.userAgent.toLowerCase().match(/firefox/)?this._options.ffMaxSupportedCssHeight:this._options.maxSupportedCssHeight,i=Z("div",{style:{display:"hidden"}},document.body);let n=!0;for(;n;){const s=2*e;wn.height(i,s);const r=wn.height(i);if(s>t||r!==s){n=!1;break}e=s}return i.remove(),e}getUID(){return this.uid}getHeaderColumnWidthDiff(){return this.headerColumnWidthDiff}getScrollbarDimensions(){return this.scrollbarDimensions}getDisplayedScrollbarDimensions(){return{width:this.viewportHasVScroll&&this.scrollbarDimensions?.width||0,height:this.viewportHasHScroll&&this.scrollbarDimensions?.height||0}}getAbsoluteColumnMinWidth(){return this.absoluteColumnMinWidth}bindAncestorScrollEvents(){let e=this.hasFrozenRows&&!this._options.frozenBottom?this._canvasBottomL:this._canvasTopL;for(;(e=e.parentNode)!==document.body&&e;)e!==this._viewportTopL&&e.scrollWidth===e.clientWidth&&e.scrollHeight===e.clientHeight||(this._boundAncestors.push(e),this._bindingEventService.bind(e,"scroll",this.handleActiveCellPositionChange.bind(this)))}unbindAncestorScrollEvents(){this._boundAncestors.forEach((e=>{this._bindingEventService.unbindByEventName(e,"scroll")})),this._boundAncestors=[]}updateColumnHeader(e,t,i){if(this.initialized){const n=this.getColumnIndex(e);if(!ke(n))return;const s=this.columns[n],r=this.getColumnByIndex(n);return r&&(void 0!==t&&(this.columns[n].name=t),void 0!==i&&(this.columns[n].toolTip=i),this.triggerEvent(this.onBeforeHeaderCellDestroy,{node:r,column:s,grid:this}),r.setAttribute("title",i||""),void 0!==t&&this.applyHtmlCode(r.children[0],t),this.triggerEvent(this.onHeaderCellRendered,{node:r,column:s,grid:this})),r}}getHeader(e){if(!e)return this.hasFrozenColumns()?this._headers:this._headerL;const t=this.getColumnIndex(e.id);return this.hasFrozenColumns()?t<=this._options.frozenColumn?this._headerL:this._headerR:this._headerL}getHeaderColumn(e){const t="number"==typeof e?e:this.getColumnIndex(e),i=this.hasFrozenColumns()?t<=this._options.frozenColumn?this._headerL:this._headerR:this._headerL,n=this.hasFrozenColumns()?t<=this._options.frozenColumn?t:t-this._options.frozenColumn-1:t;return i.children[n]}getHeaderRow(){return this.hasFrozenColumns()?this._headerRows:this._headerRows?.[0]}getFooterRow(){return this.hasFrozenColumns()?this._footerRow:this._footerRow?.[0]}getPreHeaderPanel(){return this._preHeaderPanel}getPreHeaderPanelLeft(){return this._preHeaderPanel}getPreHeaderPanelRight(){return this._preHeaderPanelR}getTopHeaderPanel(){return this._topHeaderPanel}getHeaderRowColumn(e){let t,i="number"==typeof e?e:this.getColumnIndex(e);return this.hasFrozenColumns()?i<=this._options.frozenColumn?t=this._headerRowL:(t=this._headerRowR,i-=this._options.frozenColumn+1):t=this._headerRowL,t.children[i]}getFooterRowColumn(e){let t,i="number"==typeof e?e:this.getColumnIndex(e);return this.hasFrozenColumns()?i<=this._options.frozenColumn?t=this._footerRowL:(t=this._footerRowR,i-=this._options.frozenColumn+1):t=this._footerRowL,t?.children[i]}createColumnFooter(){if(this._options.createFooterRow){this._footerRow.forEach((e=>{e.querySelectorAll(".slick-footerrow-column").forEach((e=>{const t=wn.storage.get(e,"column");this.triggerEvent(this.onBeforeFooterRowCellDestroy,{node:e,column:t,grid:this})}))})),ee(this._footerRowL),ee(this._footerRowR);for(let e=0;e<this.columns.length;e++){const t=this.columns[e];if(!t||t.hidden)continue;const i=Z("div",{className:`slick-state-default slick-footerrow-column l${e} r${e}`},this.hasFrozenColumns()&&e>this._options.frozenColumn?this._footerRowR:this._footerRowL),n=this.hasFrozenColumns()&&e<=this._options.frozenColumn?"frozen":null;n&&i.classList.add(n),wn.storage.put(i,"column",t),this.triggerEvent(this.onFooterRowCellRendered,{node:i,column:t,grid:this})}}}handleHeaderMouseHoverOn(e){e?.target.classList.add("slick-state-hover")}handleHeaderMouseHoverOff(e){e?.target.classList.remove("slick-state-hover")}createColumnHeaders(){this._headers.forEach((e=>{e.querySelectorAll(".slick-header-column").forEach((e=>{const t=wn.storage.get(e,"column");t&&this.triggerEvent(this.onBeforeHeaderCellDestroy,{node:e,column:t,grid:this})}))})),ee(this._headerL),ee(this._headerR),this.getHeadersWidth(),wn.width(this._headerL,this.headersWidthL),wn.width(this._headerR,this.headersWidthR),this._headerRows.forEach((e=>{e.querySelectorAll(".slick-headerrow-column").forEach((e=>{const t=wn.storage.get(e,"column");t&&this.triggerEvent(this.onBeforeHeaderRowCellDestroy,{node:this,column:t,grid:this})}))})),ee(this._headerRowL),ee(this._headerRowR),this._options.createFooterRow&&(this._footerRowL.querySelectorAll(".slick-footerrow-column").forEach((e=>{const t=wn.storage.get(e,"column");t&&this.triggerEvent(this.onBeforeFooterRowCellDestroy,{node:this,column:t,grid:this})})),ee(this._footerRowL),this.hasFrozenColumns()&&(this._footerRowR.querySelectorAll(".slick-footerrow-column").forEach((e=>{const t=wn.storage.get(e,"column");t&&this.triggerEvent(this.onBeforeFooterRowCellDestroy,{node:this,column:t,grid:this})})),ee(this._footerRowR)));for(let e=0;e<this.columns.length;e++){const t=this.columns[e];if(!t||t.hidden)continue;const i=this.hasFrozenColumns()?e<=this._options.frozenColumn?this._headerL:this._headerR:this._headerL,n=this.hasFrozenColumns()?e<=this._options.frozenColumn?this._headerRowL:this._headerRowR:this._headerRowL,s=Z("div",{id:`${this.uid+t.id}`,dataset:{id:String(t.id)},role:"columnheader",className:"slick-state-default slick-header-column"},i);t.toolTip&&(s.title=t.toolTip),t.reorderable||s.classList.add(this._options.unorderableColumnCssClass);const r=Z("span",{className:"slick-column-name"},s);this.applyHtmlCode(r,t.name),wn.width(s,t.width-this.headerColumnWidthDiff);let o=t.headerCssClass||null;if(o&&s.classList.add(...Q(o)),o=this.hasFrozenColumns()&&e<=this._options.frozenColumn?"frozen":null,o&&s.classList.add(o),this._bindingEventService.bind(s,"mouseenter",this.handleHeaderMouseEnter.bind(this)),this._bindingEventService.bind(s,"mouseleave",this.handleHeaderMouseLeave.bind(this)),this._bindingEventService.bind(s,"mouseover",this.handleHeaderMouseOver.bind(this)),this._bindingEventService.bind(s,"mouseout",this.handleHeaderMouseOut.bind(this)),wn.storage.put(s,"column",t),(this._options.enableColumnReorder||t.sortable)&&(this._bindingEventService.bind(s,"mouseenter",this.handleHeaderMouseHoverOn.bind(this)),this._bindingEventService.bind(s,"mouseleave",this.handleHeaderMouseHoverOff.bind(this))),t.hasOwnProperty("headerCellAttrs")&&t.headerCellAttrs instanceof Object&&Object.keys(t.headerCellAttrs).forEach((e=>{t.headerCellAttrs.hasOwnProperty(e)&&s.setAttribute(e,t.headerCellAttrs[e])})),t.sortable&&(s.classList.add("slick-header-sortable"),Z("div",{className:"slick-sort-indicator "+(this._options.numberedMultiColumnSort&&!this._options.sortColNumberInSeparateSpan?" slick-sort-indicator-numbered":"")},s),this._options.numberedMultiColumnSort&&this._options.sortColNumberInSeparateSpan&&Z("div",{className:"slick-sort-indicator-numbered"},s)),this.triggerEvent(this.onHeaderCellRendered,{node:s,column:t,grid:this}),this._options.showHeaderRow){const i=Z("div",{className:`slick-state-default slick-headerrow-column l${e} r${e}`},n),s=this.hasFrozenColumns()&&e<=this._options.frozenColumn?"frozen":null;s&&i.classList.add(s),this._bindingEventService.bind(i,"mouseenter",this.handleHeaderRowMouseEnter.bind(this)),this._bindingEventService.bind(i,"mouseleave",this.handleHeaderRowMouseLeave.bind(this)),this._bindingEventService.bind(i,"mouseover",this.handleHeaderRowMouseOver.bind(this)),this._bindingEventService.bind(i,"mouseout",this.handleHeaderRowMouseOut.bind(this)),wn.storage.put(i,"column",t),this.triggerEvent(this.onHeaderRowCellRendered,{node:i,column:t,grid:this})}if(this._options.createFooterRow&&this._options.showFooterRow){const i=Z("div",{className:`slick-state-default slick-footerrow-column l${e} r${e}`},this.hasFrozenColumns()?e<=this._options.frozenColumn?this._footerRow[0]:this._footerRow[1]:this._footerRow[0]);wn.storage.put(i,"column",t),this.triggerEvent(this.onFooterRowCellRendered,{node:i,column:t,grid:this})}}this.setSortColumns(this.sortColumns),this.setupColumnResize(),this._options.enableColumnReorder&&("function"==typeof this._options.enableColumnReorder?this._options.enableColumnReorder(this,this._headers,this.headerColumnWidthDiff,this.setColumns,this.setupColumnResize,this.columns,this.getColumnIndex,this.uid,this.triggerEvent):this.setupColumnReorder())}setupColumnSort(){this._headers.forEach((e=>{this._bindingEventService.bind(e,"click",(e=>{if(this.columnResizeDragging||e.target.classList.contains("slick-resizable-handle"))return;const t=e.target.closest(".slick-header-column");if(!t)return;const i=wn.storage.get(t,"column");if(i?.sortable){if(!this.getEditorLock()?.commitCurrentEdit())return;const t=this.sortColumns.slice();let n=null,s=0;for(;s<this.sortColumns.length;s++)if(this.sortColumns[s].columnId===i.id){n=this.sortColumns[s],n.sortAsc=!n.sortAsc;break}const r=!!n;let o;this._options.tristateMultiColumnSort?(n||(n={columnId:i.id,sortAsc:i.defaultSortAsc,sortCol:i}),r&&n.sortAsc&&(this.sortColumns.splice(s,1),n=null),this._options.multiColumnSort||(this.sortColumns=[]),!n||r&&this._options.multiColumnSort||this.sortColumns.push(n)):e.metaKey&&this._options.multiColumnSort?n&&this.sortColumns.splice(s,1):((e.shiftKey||e.metaKey)&&this._options.multiColumnSort||(this.sortColumns=[]),n?0===this.sortColumns.length&&this.sortColumns.push(n):(n={columnId:i.id,sortAsc:i.defaultSortAsc,sortCol:i},this.sortColumns.push(n))),o=this._options.multiColumnSort?{multiColumnSort:!0,previousSortColumns:t,sortCols:this.sortColumns.map((e=>{const t=this.columns[this.getColumnIndex(e.columnId)];return!t||t.hidden?null:{columnId:t.id,sortCol:t,sortAsc:e.sortAsc}})).filter((e=>e))}:{multiColumnSort:!1,previousSortColumns:t,columnId:this.sortColumns.length>0?i.id:null,sortCol:this.sortColumns.length>0?i:null,sortAsc:!(this.sortColumns.length>0)||this.sortColumns[0].sortAsc},!1!==this.triggerEvent(this.onBeforeSort,o,e).getReturnValue()&&(this.setSortColumns(this.sortColumns),this.triggerEvent(this.onSort,o,e))}}))}))}setupColumnReorder(){let e;this.sortableSideLeftInstance?.destroy(),this.sortableSideRightInstance?.destroy();const t=()=>this._viewportScrollContainerX.scrollLeft+=10,i=()=>this._viewportScrollContainerX.scrollLeft-=10;let n=!1;const s={animation:50,direction:"horizontal",chosenClass:"slick-header-column-active",ghostClass:"slick-sortable-placeholder",draggable:".slick-header-column",dragoverBubble:!1,revertClone:!0,scroll:!this.hasFrozenColumns(),filter:`.${this._options.unorderableColumnCssClass}`,onMove:e=>!e.related.classList.contains(this._options.unorderableColumnCssClass),onStart:s=>{n=!this.hasFrozenColumns()||ne(s.item).left>ne(this._viewportScrollContainerX).left,n&&s.originalEvent.pageX>this._container.clientWidth?e||(e=window.setInterval(t,100)):n&&s.originalEvent.pageX<ne(this._viewportScrollContainerX).left?e||(e=window.setInterval(i,100)):window.clearInterval(e)},onEnd:t=>{if(window.clearInterval(e),!this.getEditorLock()?.commitCurrentEdit())return;let i=this.sortableSideLeftInstance?.toArray()??[];i=i.concat(this.sortableSideRightInstance?.toArray()??[]);const n=[];for(let e=0;e<i.length;e++)n.push(this.columns[this.getColumnIndex(i[e])]);this.setColumns(n),this.triggerEvent(this.onColumnsReordered,{impactedColumns:this.columns}),t.stopPropagation(),this.setupColumnResize(),this.activeCellNode&&this.setFocus()}};this.sortableSideLeftInstance=Ar.create(this._headerL,s),this.sortableSideRightInstance=Ar.create(this._headerR,s)}getHeaderChildren(){const e=Array.from(this._headers[0].children),t=Array.from(this._headers[1].children);return e.concat(t)}handleResizeableDoubleClick(e){const t=e.target.parentElement.id.replace(this.uid,"");this.triggerEvent(this.onColumnsResizeDblClick,{triggeredByColumn:t})}setupColumnResize(){if(void 0===kr)throw new Error('SlickResizable is undefined, make sure to import "slick.interactions.js"');let e,t,i,n,s,r,o,a=-1,l=0;const c=this.getHeaderChildren(),h=this.getVisibleColumns();for(let e=0;e<c.length;e++)c[e].querySelectorAll(".slick-resizable-handle").forEach((e=>e.remove())),e<h.length&&h[e]?.resizable&&(void 0===o&&(o=e),a=e);if(void 0!==o)for(let d=0;d<c.length;d++){const u=c[d];if(d>=h.length||!h[d])continue;if(d<o||this._options.forceFitColumns&&d>=a)continue;const p=Z("div",{className:"slick-resizable-handle",role:"separator",ariaOrientation:"horizontal"},u);this._bindingEventService.bind(p,"dblclick",this.handleResizeableDoubleClick.bind(this)),this.slickResizableInstances.push(kr({resizeableElement:u,resizeableHandleElement:p,onResizeStart:(t,o)=>{const a=t.touches?t.changedTouches[0]:t;if(!this.getEditorLock()?.commitCurrentEdit())return!1;n=a.pageX,l=0,o.resizeableElement.classList.add("slick-header-column-active");let u=null,p=null;for(let e=0;e<c.length;e++)e<h.length&&h[e]&&(h[e].previousWidth=c[e].offsetWidth);if(this._options.forceFitColumns)for(u=0,p=0,e=d+1;e<h.length;e++)i=h[e],i?.resizable&&(null!==p&&(i.maxWidth?p+=i.maxWidth-(i.previousWidth||0):p=null),u+=(i.previousWidth||0)-Math.max(i.minWidth||0,this.absoluteColumnMinWidth));let f=0,m=0;for(e=0;e<=d;e++)i=h[e],i?.resizable&&(null!==m&&(i.maxWidth?m+=i.maxWidth-(i.previousWidth||0):m=null),f+=(i.previousWidth||0)-Math.max(i.minWidth||0,this.absoluteColumnMinWidth));null===u&&(u=1e5),null===f&&(f=1e5),null===p&&(p=1e5),null===m&&(m=1e5),r=n+Math.min(u,m),s=n-Math.min(f,p)},onResize:(o,a)=>{const c=o.touches?o.changedTouches[0]:o;let u;this.columnResizeDragging=!0;const p=Math.min(r,Math.max(s,c.pageX))-n;let f,m=0,g=0;const v=this.viewportHasVScroll?this.viewportW-(this.scrollbarDimensions?.width||0):this.viewportW;if(p<0){for(f=p,e=d;e>=0;e--)i=h[e],i&&i.resizable&&!i.hidden&&(u=Math.max(i.minWidth||0,this.absoluteColumnMinWidth),f&&(i.previousWidth||0)+f<u?(f+=(i.previousWidth||0)-u,i.width=u):(i.width=(i.previousWidth||0)+f,f=0));for(t=0;t<=d;t++)i=h[t],i&&!i.hidden&&(this.hasFrozenColumns()&&t>this._options.frozenColumn?g+=i.width||0:m+=i.width||0);if(this._options.forceFitColumns)for(f=-p,e=d+1;e<h.length;e++)i=h[e],i&&!i.hidden&&i.resizable&&(f&&i.maxWidth&&i.maxWidth-(i.previousWidth||0)<f?(f-=i.maxWidth-(i.previousWidth||0),i.width=i.maxWidth):(i.width=(i.previousWidth||0)+f,f=0),this.hasFrozenColumns()&&e>this._options.frozenColumn?g+=i.width||0:m+=i.width||0);else for(e=d+1;e<h.length;e++)i=h[e],i&&!i.hidden&&(this.hasFrozenColumns()&&e>this._options.frozenColumn?g+=i.width||0:m+=i.width||0);if(this._options.forceFitColumns)for(f=-p,e=d+1;e<h.length;e++)i=h[e],i&&!i.hidden&&i.resizable&&(f&&i.maxWidth&&i.maxWidth-(i.previousWidth||0)<f?(f-=i.maxWidth-(i.previousWidth||0),i.width=i.maxWidth):(i.width=(i.previousWidth||0)+f,f=0))}else{for(f=p,m=0,g=0,e=d;e>=0;e--)if(i=h[e],i&&!i.hidden&&i.resizable)if(f&&i.maxWidth&&i.maxWidth-(i.previousWidth||0)<f)f-=i.maxWidth-(i.previousWidth||0),i.width=i.maxWidth;else{const t=(i.previousWidth||0)+f,n=this.canvasWidthL+f;this.hasFrozenColumns()&&e<=this._options.frozenColumn?(t>l&&n<v-this._options.frozenRightViewportMinWidth&&(l=t),i.width=n+this._options.frozenRightViewportMinWidth>v?l:t):i.width=t,f=0}for(t=0;t<=d;t++)i=h[t],i&&!i.hidden&&(this.hasFrozenColumns()&&t>this._options.frozenColumn?g+=i.width||0:m+=i.width||0);if(this._options.forceFitColumns)for(f=-p,e=d+1;e<h.length;e++)i=h[e],i&&!i.hidden&&i.resizable&&(u=Math.max(i.minWidth||0,this.absoluteColumnMinWidth),f&&(i.previousWidth||0)+f<u?(f+=(i.previousWidth||0)-u,i.width=u):(i.width=(i.previousWidth||0)+f,f=0),this.hasFrozenColumns()&&e>this._options.frozenColumn?g+=i.width||0:m+=i.width||0);else for(e=d+1;e<h.length;e++)i=h[e],i&&!i.hidden&&(this.hasFrozenColumns()&&e>this._options.frozenColumn?g+=i.width||0:m+=i.width||0)}this.hasFrozenColumns()&&m!==this.canvasWidthL&&(wn.width(this._headerL,m+1e3),wn.setStyleSize(this._paneHeaderR,"left",m)),this.applyColumnHeaderWidths(),this._options.syncColumnCellResize&&this.applyColumnWidths(),this.triggerEvent(this.onColumnsDrag,{triggeredByColumn:a.resizeableElement,resizeHandle:a.resizeableHandleElement})},onResizeEnd:(t,n)=>{n.resizeableElement.classList.remove("slick-header-column-active");const s=n.resizeableElement.id.replace(this.uid,"");let r;for(!0===this.triggerEvent(this.onBeforeColumnsResize,{triggeredByColumn:s}).getReturnValue()&&this.applyColumnHeaderWidths(),e=0;e<h.length;e++)i=h[e],i&&!i.hidden&&c[e]&&(r=c[e].offsetWidth,i.previousWidth!==r&&i.rerenderOnResize&&this.invalidateAllRows());this.updateCanvasWidth(!0),this.render(),this.triggerEvent(this.onColumnsResized,{triggeredByColumn:s}),window.clearTimeout(this._columnResizeTimer),this._columnResizeTimer=window.setTimeout((()=>this.columnResizeDragging=!1),this._options.columnResizingDelay)}}))}}getVBoxDelta(e){const t=getComputedStyle(e);let i=0;return["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"].forEach((e=>i+=wn.toFloat(t[e]))),i}setFrozenOptions(){if(this._options.frozenColumn=this._options.frozenColumn>=0&&this._options.frozenColumn<this.columns.length?parseInt(this._options.frozenColumn,10):-1,this._options.frozenRow>-1){this.hasFrozenRows=!0,this.frozenRowsHeight=this._options.frozenRow*this._options.rowHeight;const e=this.getDataLength();this.actualFrozenRow=this._options.frozenBottom?e-this._options.frozenRow:this._options.frozenRow}else this.hasFrozenRows=!1}setPaneVisibility(){this.hasFrozenColumns()?(wn.show(this._paneHeaderR),wn.show(this._paneTopR),this.hasFrozenRows?(wn.show(this._paneBottomL),wn.show(this._paneBottomR)):(wn.hide(this._paneBottomR),wn.hide(this._paneBottomL))):(wn.hide(this._paneHeaderR),wn.hide(this._paneTopR),wn.hide(this._paneBottomR),this.hasFrozenRows?wn.show(this._paneBottomL):(wn.hide(this._paneBottomR),wn.hide(this._paneBottomL)))}setOverflow(){if(this._viewportTopL.style.overflowX=this.hasFrozenColumns()?this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"hidden":"scroll":this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"hidden":"auto",this._viewportTopL.style.overflowY=!this.hasFrozenColumns()&&this._options.alwaysShowVerticalScroll?"scroll":this.hasFrozenColumns()?(this.hasFrozenRows,"hidden"):this.hasFrozenRows?"scroll":"auto",this._viewportTopR.style.overflowX=this.hasFrozenColumns()?this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"hidden":"scroll":this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"hidden":"auto",this._viewportTopR.style.overflowY=this._options.alwaysShowVerticalScroll?"scroll":(this.hasFrozenColumns(),this.hasFrozenRows?"scroll":"auto"),this._viewportBottomL.style.overflowX=this.hasFrozenColumns()?this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"scroll":"auto":(this.hasFrozenRows&&this._options.alwaysAllowHorizontalScroll,"auto"),this._viewportBottomL.style.overflowY=!this.hasFrozenColumns()&&this._options.alwaysShowVerticalScroll?"scroll":this.hasFrozenColumns()?(this.hasFrozenRows,"hidden"):this.hasFrozenRows?"scroll":"auto",this._viewportBottomR.style.overflowX=this.hasFrozenColumns()?this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"scroll":"auto":(this.hasFrozenRows&&this._options.alwaysAllowHorizontalScroll,"auto"),this._viewportBottomR.style.overflowY=this._options.alwaysShowVerticalScroll?"scroll":(this.hasFrozenColumns(),this.hasFrozenRows,"auto"),this._options.viewportClass){const e=Q(this._options.viewportClass);this._viewportTopL.classList.add(...e),this._viewportTopR.classList.add(...e),this._viewportBottomL.classList.add(...e),this._viewportBottomR.classList.add(...e)}}setScroller(){this.hasFrozenColumns()?(this._headerScrollContainer=this._headerScrollerR,this._headerRowScrollContainer=this._headerRowScrollerR,this._footerRowScrollContainer=this._footerRowScrollerR,this.hasFrozenRows?this._options.frozenBottom?(this._viewportScrollContainerX=this._viewportBottomR,this._viewportScrollContainerY=this._viewportTopR):this._viewportScrollContainerX=this._viewportScrollContainerY=this._viewportBottomR:this._viewportScrollContainerX=this._viewportScrollContainerY=this._viewportTopR):(this._headerScrollContainer=this._headerScrollerL,this._headerRowScrollContainer=this._headerRowScrollerL,this._footerRowScrollContainer=this._footerRowScrollerL,this.hasFrozenRows?this._options.frozenBottom?(this._viewportScrollContainerX=this._viewportBottomL,this._viewportScrollContainerY=this._viewportTopL):this._viewportScrollContainerX=this._viewportScrollContainerY=this._viewportBottomL:this._viewportScrollContainerX=this._viewportScrollContainerY=this._viewportTopL)}measureCellPaddingAndBorder(){const e=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],t=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],i=this._headers[0];this.headerColumnWidthDiff=this.headerColumnHeightDiff=0,this.cellWidthDiff=this.cellHeightDiff=0;let n=Z("div",{className:"slick-state-default slick-header-column",style:{visibility:"hidden"},textContent:"-"},i),s=getComputedStyle(n);"border-box"!==s.boxSizing&&(e.forEach((e=>this.headerColumnWidthDiff+=wn.toFloat(s[e]))),t.forEach((e=>this.headerColumnHeightDiff+=wn.toFloat(s[e])))),n.remove();const r=Z("div",{className:"slick-row"},this._canvas[0]);n=Z("div",{className:"slick-cell",id:"",style:{visibility:"hidden"},textContent:"-"},r),s=getComputedStyle(n),"border-box"!==s.boxSizing&&(e.forEach((e=>this.cellWidthDiff+=wn.toFloat(s[e]))),t.forEach((e=>this.cellHeightDiff+=wn.toFloat(s[e])))),r.remove(),this.absoluteColumnMinWidth=Math.max(this.headerColumnWidthDiff,this.cellWidthDiff)}createCssRules(){this._style=document.createElement("style"),this._style.nonce=this._options.nonce||"",(this._options.shadowRoot||document.head).appendChild(this._style);const e=this._options.rowHeight-this.cellHeightDiff,t=[`.${this.uid} .slick-group-header-column { left: 1000px; }`,`.${this.uid} .slick-header-column { left: 1000px; }`,`.${this.uid} .slick-top-panel { height: ${this._options.topPanelHeight}px; }`,`.${this.uid} .slick-preheader-panel { height: ${this._options.preHeaderPanelHeight}px; }`,`.${this.uid} .slick-topheader-panel { height: ${this._options.topHeaderPanelHeight}px; }`,`.${this.uid} .slick-headerrow-columns { height: ${this._options.headerRowHeight}px; }`,`.${this.uid} .slick-footerrow-columns { height: ${this._options.footerRowHeight}px; }`,`.${this.uid} .slick-cell { height: ${e}px; }`,`.${this.uid} .slick-row { height: ${this._options.rowHeight}px; }`],i=this._style.sheet;if(i){t.forEach((e=>{i.insertRule(e)}));for(let e=0;e<this.columns.length;e++)this.columns[e]&&!this.columns[e].hidden&&(i.insertRule(`.${this.uid} .l${e} { }`),i.insertRule(`.${this.uid} .r${e} { }`))}else this.createCssRulesAlternative(t)}createCssRulesAlternative(e){const t=document.createElement("template");t.innerHTML='<style type="text/css" rel="stylesheet" />',this._style=t.content.firstChild,(this._options.shadowRoot||document.head).appendChild(this._style);for(let t=0;t<this.columns.length;t++)this.columns[t]&&!this.columns[t].hidden&&(e.push(`.${this.uid} .l${t} { }`),e.push(`.${this.uid} .r${t} { }`));this._style.styleSheet?this._style.styleSheet.cssText=e.join(" "):this._style.appendChild(document.createTextNode(e.join(" ")))}getColumnCssRules(e){let t;if(!this.stylesheet){const e=(this._options.shadowRoot||document).styleSheets;for(this._options.devMode&&"number"==typeof this._options.devMode.ownerNodeIndex&&this._options.devMode.ownerNodeIndex>=0&&(e[this._options.devMode.ownerNodeIndex].ownerNode=this._style),t=0;t<e.length;t++){const i=e[t];if((i.ownerNode||i.owningElement)===this._style){this.stylesheet=i;break}}if(!this.stylesheet)throw new Error("SlickGrid Cannot find stylesheet.");this.columnCssRulesL=[],this.columnCssRulesR=[];const i=this.stylesheet.cssRules||this.stylesheet.rules;let n,s;for(t=0;t<i.length;t++){const e=i[t].selectorText;(n=/\.l\d+/.exec(e))?(s=parseInt(n[0].substr(2,n[0].length-2),10),this.columnCssRulesL[s]=i[t]):(n=/\.r\d+/.exec(e))&&(s=parseInt(n[0].substr(2,n[0].length-2),10),this.columnCssRulesR[s]=i[t])}}return{left:this.columnCssRulesL[e],right:this.columnCssRulesR[e]}}removeCssRules(){this._style?.remove(),this.stylesheet=null}clearAllTimers(){window.clearTimeout(this._columnResizeTimer),window.clearTimeout(this._executionBlockTimer),window.clearTimeout(this._flashCellTimer),window.clearTimeout(this._highlightRowTimer),window.clearTimeout(this.h_editorLoader)}destroy(e){this._bindingEventService.unbindAll(),this.slickDraggableInstance=this.destroyAllInstances(this.slickDraggableInstance),this.slickMouseWheelInstances=this.destroyAllInstances(this.slickMouseWheelInstances),this.slickResizableInstances=this.destroyAllInstances(this.slickResizableInstances),this.getEditorLock()?.cancelCurrentEdit(),this.triggerEvent(this.onBeforeDestroy,{});let t=this.plugins.length;for(;t--;)this.unregisterPlugin(this.plugins[t]);this._options.enableColumnReorder&&"function"==typeof this.sortableSideLeftInstance?.destroy&&"function"==typeof this.sortableSideRightInstance?.destroy&&(this.sortableSideLeftInstance.destroy(),this.sortableSideRightInstance.destroy()),this.unbindAncestorScrollEvents(),this._bindingEventService.unbindByEventName(this._container,"resize"),this.removeCssRules(),this._canvas.forEach((e=>{this._bindingEventService.unbindByEventName(e,"keydown"),this._bindingEventService.unbindByEventName(e,"click"),this._bindingEventService.unbindByEventName(e,"dblclick"),this._bindingEventService.unbindByEventName(e,"contextmenu"),this._bindingEventService.unbindByEventName(e,"mouseover"),this._bindingEventService.unbindByEventName(e,"mouseout")})),this._viewport.forEach((e=>{this._bindingEventService.unbindByEventName(e,"scroll")})),this._headerScroller.forEach((e=>{this._bindingEventService.unbindByEventName(e,"contextmenu"),this._bindingEventService.unbindByEventName(e,"click")})),this._headerRowScroller.forEach((e=>{this._bindingEventService.unbindByEventName(e,"scroll")})),this._footerRow&&this._footerRow.forEach((e=>{this._bindingEventService.unbindByEventName(e,"contextmenu"),this._bindingEventService.unbindByEventName(e,"click")})),this._footerRowScroller&&this._footerRowScroller.forEach((e=>{this._bindingEventService.unbindByEventName(e,"scroll")})),this._preHeaderPanelScroller&&this._bindingEventService.unbindByEventName(this._preHeaderPanelScroller,"scroll"),this._topHeaderPanelScroller&&this._bindingEventService.unbindByEventName(this._topHeaderPanelScroller,"scroll"),this._bindingEventService.unbindByEventName(this._focusSink,"keydown"),this._bindingEventService.unbindByEventName(this._focusSink2,"keydown");const i=this._container.querySelectorAll(".slick-resizable-handle");[].forEach.call(i,(e=>{this._bindingEventService.unbindByEventName(e,"dblclick")}));const n=this._container.querySelectorAll(".slick-header-column");[].forEach.call(n,(e=>{this._bindingEventService.unbindByEventName(e,"mouseenter"),this._bindingEventService.unbindByEventName(e,"mouseleave"),this._bindingEventService.unbindByEventName(e,"mouseover"),this._bindingEventService.unbindByEventName(e,"mouseout")})),ee(this._container),this._container.classList.remove(this.uid),this.clearAllTimers(),e&&J(this)}destroyAllInstances(e){if(e){const t=Array.isArray(e)?e:[e];let i;for(;ke(i=t.pop());)i&&"function"==typeof i.destroy&&i.destroy()}return Array.isArray(e)?[]:null}autosizeColumns(){this.legacyAutosizeColumns()}legacyAutosizeColumns(){let e,t,i=0,n=0,s=0;const r=[],o=this.viewportHasVScroll?this.viewportW-(this.scrollbarDimensions?.width||0):this.viewportW;for(e=0;e<this.columns.length;e++)t=this.columns[e],t&&!t.hidden?(r.push(t.width||0),n+=t.width||0,t.resizable&&(i+=(t.width||0)-Math.max(t.minWidth||0,this.absoluteColumnMinWidth))):r.push(0);for(s=n;n>o&&i;){const a=(n-o)/i;for(e=0;e<this.columns.length&&n>o;e++){if(t=this.columns[e],!t||t.hidden)continue;const s=r[e];if(!t.resizable||s<=t.minWidth||s<=this.absoluteColumnMinWidth)continue;const o=Math.max(t.minWidth,this.absoluteColumnMinWidth);let l=Math.floor(a*(s-o))||1;l=Math.min(l,s-o),n-=l,i-=l,r[e]-=l}if(s<=n)break;s=n}for(s=n;n<o;){const i=o/n;for(e=0;e<this.columns.length&&n<o;e++){if(t=this.columns[e],!t||t.hidden)continue;const s=r[e];let a;a=!t.resizable||t.maxWidth<=s?0:Math.min(Math.floor(i*s)-s,t.maxWidth-s||1e6)||1,n+=a,r[e]+=n<=o?a:0}if(s>=n)break;s=n}let a=!1;for(e=0;e<this.columns.length;e++)t&&!t.hidden&&(this.columns[e].rerenderOnResize&&this.columns[e].width!==r[e]&&(a=!0),this.columns[e].width=r[e]);this.reRenderColumns(a)}reRenderColumns(e){this.applyColumnHeaderWidths(),this.updateCanvasWidth(!0),this.triggerEvent(this.onAutosizeColumns,{columns:this.columns}),e&&(this.invalidateAllRows(),this.render())}getVisibleColumns(){return this.columns.filter((e=>!e.hidden))}triggerEvent(e,t,i){const n=i||new mn(i,t),s=t||{};return s.grid=this,e.notify(s,n,this)}getEditorLock(){return this._options.editorLock}getEditController(){return this.editController}getColumnIndex(e){return this.columnsById[e]}applyColumnHeaderWidths(){if(this.initialized){let e=0;const t=this.getVisibleColumns();this._headers.forEach((i=>{for(let n=0;n<i.children.length;n++,e++){const s=i.children[n],r=((t[e]||{}).width||0)-this.headerColumnWidthDiff;wn.width(s)!==r&&wn.width(s,r)}})),this.updateColumnCaches()}}applyColumnWidths(){let e,t=0,i=0;for(let n=0;n<this.columns.length;n++)this.columns[n]?.hidden||(i=this.columns[n].width||0,e=this.getColumnCssRules(n),e.left&&(e.left.style.left=`${t}px`),e.right&&(e.right.style.right=(-1!==this._options.frozenColumn&&n>this._options.frozenColumn?this.canvasWidthR:this.canvasWidthL)-t-i+"px"),this._options.frozenColumn!==n&&(t+=this.columns[n].width)),this._options.frozenColumn===n&&(t=0)}setSortColumn(e,t){this.setSortColumns([{columnId:e,sortAsc:t}])}getColumnByIndex(e){let t;return this._headers.every((i=>{const n=i.children.length;return e<n?(t=i.children[e],!1):(e-=n,!0)})),t}setSortColumns(e){this.sortColumns=e;const t=this._options.numberedMultiColumnSort&&this.sortColumns.length>1;this._headers.forEach((e=>{let t=e.querySelectorAll(".slick-header-column-sorted");t.forEach((e=>e.classList.remove("slick-header-column-sorted"))),t=e.querySelectorAll(".slick-sort-indicator"),t.forEach((e=>e.classList.remove("slick-sort-indicator-asc","slick-sort-indicator-desc"))),t=e.querySelectorAll(".slick-sort-indicator-numbered"),t.forEach((e=>e.textContent=""))}));let i=1;this.sortColumns.forEach((e=>{ke(e.sortAsc)||(e.sortAsc=!0);const n=this.getColumnIndex(e.columnId);if(ke(n)){const s=this.getColumnByIndex(n);if(s){s.classList.add("slick-header-column-sorted");let n=s.querySelector(".slick-sort-indicator");n?.classList.add(e.sortAsc?"slick-sort-indicator-asc":"slick-sort-indicator-desc"),t&&(n=s.querySelector(".slick-sort-indicator-numbered"),n&&(n.textContent=String(i)))}}i++}))}getSortColumns(){return this.sortColumns}handleSelectedRangesChanged(e,t){const i=e.getNativeEvent(),n=this.selectedRows.slice(0);this.selectedRows=[];const s={};for(let e=0;e<t.length;e++)for(let i=t[e].fromRow;i<=t[e].toRow;i++){s[i]||(this.selectedRows.push(i),s[i]={});for(let n=t[e].fromCell;n<=t[e].toCell;n++)this.canCellBeSelected(i,n)&&(s[i][this.columns[n].id]=this._options.selectedCellCssClass)}if(this.setCellCssStyles(this._options.selectedCellCssClass||"",s),this.simpleArrayEquals(n,this.selectedRows)){const t=i?.detail?.caller??"click",s=new Set(this.getSelectedRows()),r=new Set(n),o=Array.from(s).filter((e=>!r.has(e))),a=Array.from(r).filter((e=>!s.has(e)));this.triggerEvent(this.onSelectedRowsChanged,{rows:this.getSelectedRows(),previousSelectedRows:n,caller:t,changedSelectedRows:o,changedUnselectedRows:a},e)}}simpleArrayEquals(e,t){return Array.isArray(e)&&Array.isArray(t)&&t.sort().toString()!==e.sort().toString()}getColumns(){return this.columns}updateColumnCaches(){this.columnPosLeft=[],this.columnPosRight=[];let e=0;for(let t=0,i=this.columns.length;t<i;t++)this.columns[t]&&!this.columns[t].hidden&&(this.columnPosLeft[t]=e,this.columnPosRight[t]=e+(this.columns[t].width||0),this._options.frozenColumn===t?e=0:e+=this.columns[t].width||0)}updateColumnProps(){this.columnsById={};for(let e=0;e<this.columns.length;e++){let t=this.columns[e]||{};t.width&&(t.widthRequest=t.width),this._options.mixinDefaults?wn.applyDefaults(t,this._columnDefaults):t=this.columns[e]=Ce({},this._columnDefaults,t),this.columnsById[t.id]=e,t.minWidth&&(t.width||0)<t.minWidth&&(t.width=t.minWidth),t.maxWidth&&(t.width||0)>t.maxWidth&&(t.width=t.maxWidth)}}setColumns(e){this.triggerEvent(this.onBeforeSetColumns,{previousColumns:this.columns,newColumns:e,grid:this}),this.columns=e,this.updateColumnsInternal(),this.triggerEvent(this.onAfterSetColumns,{newColumns:e,grid:this})}updateColumns(){this.triggerEvent(this.onBeforeUpdateColumns,{columns:this.columns,grid:this}),this.updateColumnsInternal()}updateColumnsInternal(){this.updateColumnProps(),this.updateColumnCaches(),this.initialized&&(this.setPaneVisibility(),this.setOverflow(),this.invalidateAllRows(),this.createColumnHeaders(),this.createColumnFooter(),this.removeCssRules(),this.createCssRules(),this.resizeCanvas(),this.updateCanvasWidth(),this.applyColumnWidths(),this.handleScroll(),this.getSelectionModel()?.refreshSelections())}getOptions(){return this._options}setOptions(e,t,i,n){this.prepareForOptionsChange(),this._options.enableAddRow!==e.enableAddRow&&this.invalidateRow(this.getDataLength()),void 0!==e.frozenColumn&&e.frozenColumn>=0&&(this.getViewports().forEach((e=>e.scrollLeft=0)),this.handleScroll());const s=Ce(!0,{},this._options);this._options=Ce(this._options,e),this.triggerEvent(this.onSetOptions,{optionsBefore:s,optionsAfter:this._options}),this.internal_setOptions(t,i,n)}activateChangedOptions(e,t,i){this.prepareForOptionsChange(),this.invalidateRow(this.getDataLength()),this.triggerEvent(this.onActivateChangedOptions,{options:this._options}),this.internal_setOptions(e,t,i)}prepareForOptionsChange(){this.getEditorLock()?.commitCurrentEdit()&&this.makeActiveCellNormal()}internal_setOptions(e,t,i){void 0!==this._options.showColumnHeader&&this.setColumnHeaderVisibility(this._options.showColumnHeader),this.validateAndEnforceOptions(),this.setFrozenOptions(),void 0!==this._options.frozenBottom&&(this.enforceFrozenRowHeightRecalc=!0),this._viewport.forEach((e=>{e.style.overflowY=this._options.autoHeight?"hidden":"auto"})),e||this.render(),this.setScroller(),i||this.setOverflow(),t||this.setColumns(this.columns),!this._options.enableMouseWheelScrollHandler||!this._viewport||this.slickMouseWheelInstances&&0!==this.slickMouseWheelInstances.length?!1===this._options.enableMouseWheelScrollHandler&&this.destroyAllInstances(this.slickMouseWheelInstances):this._viewport.forEach((e=>{this.slickMouseWheelInstances.push(Ir({element:e,onMouseWheel:this.handleMouseWheel.bind(this)}))}))}validateAndEnforceOptions(){this._options.autoHeight&&(this._options.leaveSpaceForNewRows=!1)}setData(e,t){this.data=e,this.invalidateAllRows(),this.updateRowCount(),t&&this.scrollTo(0)}getData(){return this.data}getDataLength(){return this.data.getLength?this.data.getLength():this.data?.length||0}getDataLengthIncludingAddNew(){return this.getDataLength()+(!this._options.enableAddRow||this.pagingActive&&!this.pagingIsLastPage?0:1)}getDataItem(e){return this.data.getItem?this.data.getItem(e):this.data[e]}getTopPanel(){return this._topPanels[0]}getTopPanels(){return this._topPanels}hasDataView(){return!Array.isArray(this.data)}togglePanelVisibility(e,t,i){this._options[e]!==i&&(this._options[e]=i,i?wn.show(t):wn.hide(t),this.resizeCanvas())}setTopPanelVisibility(e){this.togglePanelVisibility("showTopPanel",this._topPanelScrollers,e)}setHeaderRowVisibility(e){this.togglePanelVisibility("showHeaderRow",this._headerRowScroller,e)}setColumnHeaderVisibility(e){this.togglePanelVisibility("showColumnHeader",this._headerScroller,e)}setFooterRowVisibility(e){this.togglePanelVisibility("showFooterRow",this._footerRowScroller,e)}setPreHeaderPanelVisibility(e){this.togglePanelVisibility("showPreHeaderPanel",[this._preHeaderPanelScroller,this._preHeaderPanelScrollerR],e)}setTopHeaderPanelVisibility(e){this.togglePanelVisibility("showTopHeaderPanel",this._topHeaderPanelScroller,e)}getContainerNode(){return this._container}getRowTop(e){return Math.round(this._options.rowHeight*e-this.offset)}getRowFromPosition(e){return Math.floor((e+this.offset)/this._options.rowHeight)}scrollTo(e){e=Math.max(e,0),e=Math.min(e,(this.th||0)-wn.height(this._viewportScrollContainerY)+((this.viewportHasHScroll||this.hasFrozenColumns())&&this.scrollbarDimensions?.height||0));const t=this.offset;this.offset=Math.round(this.page*(this.cj||0)),this.page=Math.min((this.n||0)-1,Math.floor(e/(this.ph||0)));const i=e-this.offset;if(this.offset!==t){const e=this.getVisibleRange(i);this.cleanupRows(e),this.updateRowPositions()}this.prevScrollTop!==i&&(this.vScrollDir=this.prevScrollTop+t<i+this.offset?1:-1,this.lastRenderedScrollTop=this.scrollTop=this.prevScrollTop=i,this.hasFrozenColumns()&&(this._viewportTopL.scrollTop=i),this.hasFrozenRows&&(this._viewportBottomL.scrollTop=this._viewportBottomR.scrollTop=i),this._viewportScrollContainerY&&(this._viewportScrollContainerY.scrollTop=i),this.triggerEvent(this.onViewportChanged,{}))}defaultFormatter(e,t,i){return ke(i)?(i+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""}getFormatter(e,t){const i=this.data?.getItemMetadata?.(e),n=i?.columns&&(i.columns[t.id]||i.columns[this.getColumnIndex(t.id)]);return n?.formatter||i?.formatter||t.formatter||this._options.formatterFactory?.getFormatter(t)||this._options.defaultFormatter}getEditor(e,t){const i=this.columns[t],n=this.data?.getItemMetadata?.(e),s=n?.columns;return void 0!==s?.[i.id]?.editorClass?s[i.id].editorClass:void 0!==s?.[t]?.editorClass?s[t].editorClass:i.editorClass||this._options?.editorFactory?.getEditor(i)}getDataItemValueForColumn(e,t){return this._options.dataItemColumnValueExtractor?this._options.dataItemColumnValueExtractor(e,t):e[t.field]}appendRowHtml(e,t,i,n,s){const r=this.getDataItem(i),o=i<s&&!r;let a="slick-row"+(this.hasFrozenRows&&i<=this._options.frozenRow?" frozen":"")+(o?" loading":"")+(i===this.activeRow&&this._options.showCellSelection?" active":"")+(i%2==1?" odd":" even");r||(a+=` ${this._options.addNewRowCssClass}`);const l=this.data?.getItemMetadata?.(i);l?.cssClasses&&(a+=` ${l.cssClasses}`);const c=Z("div",{className:`slick-widget-content ${a}`,role:"row"}),h=this.getFrozenRowOffset(i),d=this.getRowTop(i)-h;let u,p,f;"transform"===this._options.rowTopOffsetRenderType?c.style.transform=`translateY(${d}px)`:c.style.top=`${d}px`,e.push(c),this.hasFrozenColumns()&&(u=c.cloneNode(!0),t.push(u));for(let e=0,t=this.columns.length;e<t;e++)if(f=this.columns[e],f&&!f.hidden){if(p=1,l?.columns){const i=l.columns[f.id]||l.columns[e];p=i?.colspan||1,"*"===p&&(p=t-e)}if(this.columnPosRight[Math.min(t-1,e+p-1)]>n.leftPx){if(!f.alwaysRenderColumn&&this.columnPosLeft[e]>n.rightPx)break;this.hasFrozenColumns()&&e>this._options.frozenColumn?this.appendCellHtml(u,i,e,p,r):this.appendCellHtml(c,i,e,p,r)}else(f.alwaysRenderColumn||this.hasFrozenColumns()&&e<=this._options.frozenColumn)&&this.appendCellHtml(c,i,e,p,r);p>1&&(e+=p-1)}}appendCellHtml(e,t,i,n,s){const r=this.columns[i];let o="slick-cell l"+i+" r"+Math.min(this.columns.length-1,i+n-1)+(r.cssClass?" "+r.cssClass:"");this.hasFrozenColumns()&&i<=this._options.frozenColumn&&(o+=" frozen"),t===this.activeRow&&i===this.activeCell&&this._options.showCellSelection&&(o+=" active"),Object.keys(this.cellCssClasses).forEach((e=>{this.cellCssClasses[e][t]?.[r.id]&&(o+=` ${this.cellCssClasses[e][t][r.id]}`)}));let a=null,l="";s&&(a=this.getDataItemValueForColumn(s,r),l=this.getFormatter(t,r)(t,i,a,r,s,this),null==l&&(l=""));const c=this.triggerEvent(this.onBeforeAppendCell,{row:t,cell:i,value:a,dataContext:s}).getReturnValue();let h="string"==typeof c?c:"";l?.addClasses&&(h+=Q((h?" ":"")+l.addClasses).join(" "));const d=l?.toolTip?`${l.toolTip}`:"",u=Z("div",{className:Q(`${o} ${h||""}`).join(" "),role:"gridcell",tabIndex:-1});if(u.setAttribute("aria-describedby",this.uid+r.id),d&&u.setAttribute("title",d),r.hasOwnProperty("cellAttrs")&&r.cellAttrs instanceof Object&&Object.keys(r.cellAttrs).forEach((e=>{r.cellAttrs.hasOwnProperty(e)&&u.setAttribute(e,r.cellAttrs[e])})),s){const e=Le(l)?l:l.html||l.text;this.applyHtmlCode(u,e)}e.appendChild(u),l.insertElementAfterTarget&&de(u,l.insertElementAfterTarget),this.rowsCache[t].cellRenderQueue.push(i),this.rowsCache[t].cellColSpans[i]=n}cleanupRows(e){Object.keys(this.rowsCache).forEach((t=>{if(this.rowsCache){let i=+t,n=!0;this.hasFrozenRows&&(this._options.frozenBottom&&i>=this.actualFrozenRow||!this._options.frozenBottom&&i<=this.actualFrozenRow)&&(n=!1),(i=parseInt(t,10))!==this.activeRow&&(i<e.top||i>e.bottom)&&n&&this.removeRowFromCache(i)}})),this._options.enableAsyncPostRenderCleanup&&this.startPostProcessingCleanup()}invalidate(){this.updateRowCount(),this.invalidateAllRows(),this.render()}invalidateAllRows(){this.currentEditor&&this.makeActiveCellNormal(),"object"==typeof this.rowsCache&&Object.keys(this.rowsCache).forEach((e=>{this.rowsCache&&this.removeRowFromCache(+e)})),this._options.enableAsyncPostRenderCleanup&&this.startPostProcessingCleanup()}invalidateRows(e){if(e?.length){this.vScrollDir=0;const t=e.length;for(let i=0;i<t;i++)this.currentEditor&&this.activeRow===e[i]&&this.makeActiveCellNormal(),this.rowsCache[e[i]]&&this.removeRowFromCache(e[i]);this._options.enableAsyncPostRenderCleanup&&this.startPostProcessingCleanup()}}invalidateRow(e){e>=0&&this.invalidateRows([e])}queuePostProcessedRowForCleanup(e,t,i){this.postProcessgroupId++,"object"==typeof t&&Object.keys(t).forEach((n=>{t.hasOwnProperty(n)&&this.postProcessedCleanupQueue.push({actionType:"C",groupId:this.postProcessgroupId,node:e.cellNodesByColumnIdx[+n],columnIdx:+n,rowIdx:i})})),e.rowNode||(e.rowNode=[]),this.postProcessedCleanupQueue.push({actionType:"R",groupId:this.postProcessgroupId,node:e.rowNode}),e.rowNode?.forEach((e=>e.remove()))}queuePostProcessedCellForCleanup(e,t,i){this.postProcessedCleanupQueue.push({actionType:"C",groupId:this.postProcessgroupId,node:e,columnIdx:t,rowIdx:i}),e.remove()}removeRowFromCache(e){const t=this.rowsCache[e];t?.rowNode&&(this._options.enableAsyncPostRenderCleanup&&this.postProcessedRows[e]?this.queuePostProcessedRowForCleanup(t,this.postProcessedRows[e],e):t.rowNode?.forEach((e=>e.parentElement?.removeChild(e))),delete this.rowsCache[e],delete this.postProcessedRows[e],this.renderedRows--,this.counter_rows_removed++)}applyFormatResultToCellNode(e,t,i){if(null==e&&(e=""),Le(e))return void this.applyHtmlCode(t,e);const n=e.html||e.text;this.applyHtmlCode(t,n),e.removeClasses&&!i&&t.classList.remove(...Q(e.removeClasses)),e.addClasses&&t.classList.add(...Q(e.addClasses)),e.toolTip&&t.setAttribute("title",e.toolTip)}updateCell(e,t){const i=this.getCellNode(e,t);if(i){const n=this.columns[t],s=this.getDataItem(e);if(this.currentEditor&&this.activeRow===e&&this.activeCell===t)this.currentEditor.loadValue(s);else{const r=s?this.getFormatter(e,n)(e,t,this.getDataItemValueForColumn(s,n),n,s,this):"";this.applyFormatResultToCellNode(r,i),this.invalidatePostProcessingResults(e)}}}updateRow(e){const t=this.rowsCache[e];if(!t)return;let i;this.ensureCellNodesInRowsCache(e);const n=this.getDataItem(e);Object.keys(t.cellNodesByColumnIdx).forEach((s=>{if(!t.cellNodesByColumnIdx.hasOwnProperty(s))return;const r=+s,o=this.columns[r],a=t.cellNodesByColumnIdx[r];this.currentEditor&&e===this.activeRow&&r===this.activeCell?this.currentEditor.loadValue(n):n?(i=this.getFormatter(e,o)(e,r,this.getDataItemValueForColumn(n,o),o,n,this),this.applyFormatResultToCellNode(i,a)):ee(a)})),this.invalidatePostProcessingResults(e)}getViewportRowCount(){const e=this.getViewportHeight(),t=this.getScrollbarDimensions()?.height||0;return Math.floor((e-t)/this._options.rowHeight)}getViewportHeight(){if(this._options.autoHeight&&-1===this._options.frozenColumn||(this.topPanelH=this._options.showTopPanel?this._options.topPanelHeight+this.getVBoxDelta(this._topPanelScrollers[0]):0,this.headerRowH=this._options.showHeaderRow?this._options.headerRowHeight+this.getVBoxDelta(this._headerRowScroller[0]):0,this.footerRowH=this._options.showFooterRow?this._options.footerRowHeight+this.getVBoxDelta(this._footerRowScroller[0]):0),this._options.autoHeight){let e=this._paneHeaderL.offsetHeight;e+=this._options.showHeaderRow?this._options.headerRowHeight+this.getVBoxDelta(this._headerRowScroller[0]):0,e+=this._options.showFooterRow?this._options.footerRowHeight+this.getVBoxDelta(this._footerRowScroller[0]):0,e+=this.getCanvasWidth()>this.viewportW&&this.scrollbarDimensions?.height||0,this.viewportH=this._options.rowHeight*this.getDataLengthIncludingAddNew()+(-1===this._options.frozenColumn?e:0)}else{const e=this._options.showColumnHeader?wn.toFloat(wn.height(this._headerScroller[0]))+this.getVBoxDelta(this._headerScroller[0]):0,t=this._options.createPreHeaderPanel&&this._options.showPreHeaderPanel?this._options.preHeaderPanelHeight+this.getVBoxDelta(this._preHeaderPanelScroller):0,i=this._options.createTopHeaderPanel&&this._options.showTopHeaderPanel?this._options.topHeaderPanelHeight+this.getVBoxDelta(this._topHeaderPanelScroller):0,n=getComputedStyle(this._container);this.viewportH=wn.toFloat(n.height)-wn.toFloat(n.paddingTop)-wn.toFloat(n.paddingBottom)-e-this.topPanelH-this.headerRowH-this.footerRowH-t-i}return this.numVisibleRows=Math.ceil(this.viewportH/this._options.rowHeight),this.viewportH}getViewportWidth(){return this.viewportW=parseFloat(se(this._container,"width"))||this._options.devMode&&this._options.devMode.containerClientWidth||0,this.viewportW}resizeCanvas(){if(this.initialized){if(this.paneTopH=0,this.paneBottomH=0,this.viewportTopH=0,this.viewportBottomH=0,this.getViewportWidth(),this.getViewportHeight(),this.hasFrozenRows?this._options.frozenBottom?(this.paneTopH=this.viewportH-this.frozenRowsHeight-(this.scrollbarDimensions?.height||0),this.paneBottomH=this.frozenRowsHeight+(this.scrollbarDimensions?.height||0)):(this.paneTopH=this.frozenRowsHeight,this.paneBottomH=this.viewportH-this.frozenRowsHeight):this.paneTopH=this.viewportH,this.paneTopH+=this.topPanelH+this.headerRowH+this.footerRowH,this.hasFrozenColumns()&&this._options.autoHeight&&(this.paneTopH+=this.scrollbarDimensions?.height||0),this.viewportTopH=this.paneTopH-this.topPanelH-this.headerRowH-this.footerRowH,this._options.autoHeight){if(this.hasFrozenColumns()){const e=getComputedStyle(this._headerScrollerL);wn.height(this._container,this.paneTopH+wn.toFloat(e.height))}this._paneTopL.style.position="relative"}let e=wn.height(this._paneHeaderL);e?e+=this._options.showTopHeaderPanel?this._options.topHeaderPanelHeight:0:e=(this._options.showHeaderRow?this._options.headerRowHeight:0)+(this._options.showPreHeaderPanel?this._options.preHeaderPanelHeight:0),wn.setStyleSize(this._paneTopL,"top",e||e),wn.height(this._paneTopL,this.paneTopH);const t=this._paneTopL.offsetTop+this.paneTopH;if(this._options.autoHeight||wn.height(this._viewportTopL,this.viewportTopH),this.hasFrozenColumns()){let e=wn.height(this._paneHeaderL);e&&(e+=this._options.showTopHeaderPanel?this._options.topHeaderPanelHeight:0),wn.setStyleSize(this._paneTopR,"top",e),wn.height(this._paneTopR,this.paneTopH),wn.height(this._viewportTopR,this.viewportTopH),this.hasFrozenRows&&(wn.setStyleSize(this._paneBottomL,"top",t),wn.height(this._paneBottomL,this.paneBottomH),wn.setStyleSize(this._paneBottomR,"top",t),wn.height(this._paneBottomR,this.paneBottomH),wn.height(this._viewportBottomR,this.paneBottomH))}else this.hasFrozenRows&&(wn.width(this._paneBottomL,"100%"),wn.height(this._paneBottomL,this.paneBottomH),wn.setStyleSize(this._paneBottomL,"top",t));this.hasFrozenRows?(wn.height(this._viewportBottomL,this.paneBottomH),this._options.frozenBottom?(wn.height(this._canvasBottomL,this.frozenRowsHeight),this.hasFrozenColumns()&&wn.height(this._canvasBottomR,this.frozenRowsHeight)):(wn.height(this._canvasTopL,this.frozenRowsHeight),this.hasFrozenColumns()&&wn.height(this._canvasTopR,this.frozenRowsHeight))):wn.height(this._viewportTopR,this.viewportTopH),this.scrollbarDimensions&&this.scrollbarDimensions.width||(this.scrollbarDimensions=this.measureScrollbar()),this._options.forceFitColumns&&this.legacyAutosizeColumns(),this.updateRowCount(),this.handleScroll(),this.lastRenderedScrollLeft=-1,this.render()}}updatePagingStatusFromView(e){this.pagingActive=0!==e.pageSize,this.pagingIsLastPage=e.pageNum===e.totalPages-1}updateRowCount(){if(this.initialized){const e=this.getDataLength(),t=this.getDataLengthIncludingAddNew();let i=0,n=this.hasFrozenRows&&!this._options.frozenBottom?wn.height(this._canvasBottomL):wn.height(this._canvasTopL);i=this.hasFrozenRows?this.getDataLength()-this._options.frozenRow:t+(this._options.leaveSpaceForNewRows?this.numVisibleRows-1:0);const s=wn.height(this._viewportScrollContainerY),r=this.viewportHasVScroll;this.viewportHasVScroll=this._options.alwaysShowVerticalScroll||!this._options.autoHeight&&i*this._options.rowHeight>s,this.makeActiveCellNormal();const o=e-1;"object"==typeof this.rowsCache&&Object.keys(this.rowsCache).forEach((e=>{const t=+e;t>o&&this.removeRowFromCache(t)})),this._options.enableAsyncPostRenderCleanup&&this.startPostProcessingCleanup(),this.activeCellNode&&this.activeRow>o&&this.resetActiveCell(),n=this.h,this._options.autoHeight?this.h=this._options.rowHeight*i:(this.th=Math.max(this._options.rowHeight*i,s-(this.scrollbarDimensions?.height||0)),this.th<this.maxSupportedCssHeight?(this.h=this.ph=this.th,this.n=1,this.cj=0):(this.h=this.maxSupportedCssHeight,this.ph=this.h/100,this.n=Math.floor(this.th/this.ph),this.cj=(this.th-this.h)/(this.n-1))),(this.h!==n||this.enforceFrozenRowHeightRecalc)&&(this.hasFrozenRows&&!this._options.frozenBottom?(wn.height(this._canvasBottomL,this.h),this.hasFrozenColumns()&&wn.height(this._canvasBottomR,this.h)):(wn.height(this._canvasTopL,this.h),wn.height(this._canvasTopR,this.h)),this.scrollTop=this._viewportScrollContainerY.scrollTop,this.scrollHeight=this._viewportScrollContainerY.scrollHeight,this.enforceFrozenRowHeightRecalc=!1);const a=this.scrollTop+this.offset<=this.th-s;0===this.th||0===this.scrollTop?this.page=this.offset=0:a?this.scrollTo(this.scrollTop+this.offset):this.scrollTo(this.th-s+(this.scrollbarDimensions?.height||0)),this.h!==n&&this._options.autoHeight&&this.resizeCanvas(),this._options.forceFitColumns&&r!==this.viewportHasVScroll&&this.legacyAutosizeColumns(),this.updateCanvasWidth(!1)}}getViewport(e,t){return this.getVisibleRange(e,t)}getVisibleRange(e,t){return e??=this.scrollTop,t??=this.scrollLeft,{top:this.getRowFromPosition(e),bottom:this.getRowFromPosition(e+this.viewportH)+1,leftPx:t,rightPx:t+this.viewportW}}getRenderedRange(e,t){const i=this.getVisibleRange(e,t),n=Math.round(this.viewportH/this._options.rowHeight),s=this._options.minRowBuffer;return-1===this.vScrollDir?(i.top-=n,i.bottom+=s):1===this.vScrollDir?(i.top-=s,i.bottom+=n):(i.top-=s,i.bottom+=s),i.top=Math.max(0,i.top),i.bottom=Math.min(this.getDataLengthIncludingAddNew()-1,i.bottom),i.leftPx-=this.viewportW,i.rightPx+=this.viewportW,i.leftPx=Math.max(0,i.leftPx),i.rightPx=Math.min(this.canvasWidth,i.rightPx),i}ensureCellNodesInRowsCache(e){const t=this.rowsCache[e];if(t?.cellRenderQueue.length&&t.rowNode?.length){const e=t.rowNode;let i=Array.from(e[0].children);e.length>1&&(i=i.concat(Array.from(e[1].children)));let n=i.length-1;for(;t.cellRenderQueue.length;){const e=t.cellRenderQueue.pop();t.cellNodesByColumnIdx[e]=i[n--]}}}cleanUpCells(e,t){if(this.hasFrozenRows&&(this._options.frozenBottom&&t>this.actualFrozenRow||t<=this.actualFrozenRow))return;const i=this.rowsCache[t],n=[];let s,r;for(Object.keys(i.cellNodesByColumnIdx).forEach((s=>{if(!i.cellNodesByColumnIdx.hasOwnProperty(s))return;const r=+s;if(r<=this._options.frozenColumn)return;if(Array.isArray(this.columns)&&this.columns[r]?.alwaysRenderColumn)return;const o=i.cellColSpans[r];(this.columnPosLeft[r]>e.rightPx||this.columnPosRight[Math.min(this.columns.length-1,(r||0)+o-1)]<e.leftPx)&&(t===this.activeRow&&Number(r)===this.activeCell||n.push(r))}));ke(s=n.pop());)r=i.cellNodesByColumnIdx[s],this._options.enableAsyncPostRenderCleanup&&this.postProcessedRows[t]?.[s]?this.queuePostProcessedCellForCleanup(r,s,t):r.parentElement?.removeChild(r),delete i.cellColSpans[s],delete i.cellNodesByColumnIdx[s],this.postProcessedRows[t]&&delete this.postProcessedRows[t][s]}cleanUpAndRenderCells(e){let t;const i=document.createElement("div"),n=[];let s,r,o,a,l=0;for(let o=e.top,a=e.bottom;o<=a;o++){if(t=this.rowsCache[o],!t)continue;this.ensureCellNodesInRowsCache(o),this.cleanUpCells(e,o),s=0;let a=this.data?.getItemMetadata?.(o)??{};a=a?.columns;const c=this.getDataItem(o);for(let n=0,l=this.columns.length;n<l;n++){if(!this.columns[n]||this.columns[n].hidden)continue;if(this.columnPosLeft[n]>e.rightPx)break;if(ke(r=t.cellColSpans[n])){n+=r>1?r-1:0;continue}if(r=1,a){const e=a[this.columns[n].id]||a[n];r=e?.colspan??1,"*"===r&&(r=l-n)}const h=r;this.columnPosRight[Math.min(l-1,n+h-1)]>e.leftPx&&(this.appendCellHtml(i,o,n,h,c),s++),n+=h>1?h-1:0}s&&(l+=s,n.push(o))}if(i.children.length)for(;ke(o=n.pop());){let e;for(t=this.rowsCache[o];ke(e=t.cellRenderQueue.pop());)a=i.lastChild,a&&(this.hasFrozenColumns()&&e>this._options.frozenColumn?t.rowNode[1].appendChild(a):t.rowNode[0].appendChild(a),t.cellNodesByColumnIdx[e]=a)}}renderRows(e){const t=[],i=[],n=[];let s=!1;const r=this.getDataLength();for(let o=e.top,a=e.bottom;o<=a;o++)this.rowsCache[o]||this.hasFrozenRows&&this._options.frozenBottom&&o===this.getDataLength()||(this.renderedRows++,n.push(o),this.rowsCache[o]={rowNode:null,cellColSpans:[],cellNodesByColumnIdx:[],cellRenderQueue:[]},this.appendRowHtml(t,i,o,e,r),this.activeCellNode&&this.activeRow===o&&(s=!0),this.counter_rows_rendered++);if(!n.length)return;const o=document.createElement("div"),a=document.createElement("div");t.forEach((e=>o.appendChild(e))),i.forEach((e=>a.appendChild(e)));for(let e=0,t=n.length;e<t;e++)this.hasFrozenRows&&n[e]>=this.actualFrozenRow?this.hasFrozenColumns()?this.rowsCache?.hasOwnProperty(n[e])&&o.firstChild&&a.firstChild&&(this.rowsCache[n[e]].rowNode=[o.firstChild,a.firstChild],this._canvasBottomL.appendChild(o.firstChild),this._canvasBottomR.appendChild(a.firstChild)):this.rowsCache?.hasOwnProperty(n[e])&&o.firstChild&&(this.rowsCache[n[e]].rowNode=[o.firstChild],this._canvasBottomL.appendChild(o.firstChild)):this.hasFrozenColumns()?this.rowsCache?.hasOwnProperty(n[e])&&o.firstChild&&a.firstChild&&(this.rowsCache[n[e]].rowNode=[o.firstChild,a.firstChild],this._canvasTopL.appendChild(o.firstChild),this._canvasTopR.appendChild(a.firstChild)):this.rowsCache?.hasOwnProperty(n[e])&&o.firstChild&&(this.rowsCache[n[e]].rowNode=[o.firstChild],this._canvasTopL.appendChild(o.firstChild));s&&(this.activeCellNode=this.getCellNode(this.activeRow,this.activeCell))}startPostProcessing(){this._options.enableAsyncPostRender&&(window.clearTimeout(this.h_postrender),this.h_postrender=window.setTimeout(this.asyncPostProcessRows.bind(this),this._options.asyncPostRenderDelay))}startPostProcessingCleanup(){this._options.enableAsyncPostRenderCleanup&&(window.clearTimeout(this.h_postrenderCleanup),this.h_postrenderCleanup=window.setTimeout(this.asyncPostProcessCleanupRows.bind(this),this._options.asyncPostRenderCleanupDelay))}invalidatePostProcessingResults(e){"object"==typeof this.postProcessedRows[e]&&Object.keys(this.postProcessedRows[e]).forEach((t=>{this.postProcessedRows[e].hasOwnProperty(t)&&(this.postProcessedRows[e][t]="C")})),this.postProcessFromRow=Math.min(this.postProcessFromRow,e),this.postProcessToRow=Math.max(this.postProcessToRow,e),this.startPostProcessing()}updateRowPositions(){this.rowsCache&&"object"==typeof this.rowsCache&&Object.keys(this.rowsCache).forEach((e=>{const t=e?parseInt(e,10):0,i=this.rowsCache[t].rowNode[0];"transform"===this._options.rowTopOffsetRenderType?i.style.transform=`translateY(${this.getRowTop(t)}px)`:i.style.top=`${this.getRowTop(t)}px`}))}render(){if(this.initialized){this.scrollThrottle.dequeue();const e=this.getVisibleRange(),t=this.getRenderedRange();if(this.cleanupRows(t),this.lastRenderedScrollLeft!==this.scrollLeft){if(this.hasFrozenRows){const e=Ce(!0,{},t);this._options.frozenBottom?(e.top=this.actualFrozenRow,e.bottom=this.getDataLength()):(e.top=0,e.bottom=this._options.frozenRow),this.cleanUpAndRenderCells(e)}this.cleanUpAndRenderCells(t)}this.renderRows(t),this.hasFrozenRows&&(this._options.frozenBottom?this.renderRows({top:this.actualFrozenRow,bottom:this.getDataLength()-1,leftPx:t.leftPx,rightPx:t.rightPx}):this.renderRows({top:0,bottom:this._options.frozenRow-1,leftPx:t.leftPx,rightPx:t.rightPx})),this.postProcessFromRow=e.top,this.postProcessToRow=Math.min(this.getDataLengthIncludingAddNew()-1,e.bottom),this.startPostProcessing(),this.lastRenderedScrollTop=this.scrollTop,this.lastRenderedScrollLeft=this.scrollLeft,this.h_render=null,this.triggerEvent(this.onRendered,{startRow:e.top,endRow:e.bottom,grid:this})}}handleHeaderRowScroll(){const e=this._headerRowScrollContainer.scrollLeft;e!==this._viewportScrollContainerX.scrollLeft&&(this._viewportScrollContainerX.scrollLeft=e)}handleFooterRowScroll(){const e=this._footerRowScrollContainer.scrollLeft;e!==this._viewportScrollContainerX.scrollLeft&&(this._viewportScrollContainerX.scrollLeft=e)}handlePreHeaderPanelScroll(){this.handleElementScroll(this._preHeaderPanelScroller)}handleTopHeaderPanelScroll(){this.handleElementScroll(this._topHeaderPanelScroller)}handleElementScroll(e){const t=e.scrollLeft;t!==this._viewportScrollContainerX.scrollLeft&&(this._viewportScrollContainerX.scrollLeft=t)}handleScroll(e){return this.scrollHeight=this._viewportScrollContainerY.scrollHeight,this.scrollTop=this._viewportScrollContainerY.scrollTop,this.scrollLeft=this._viewportScrollContainerX.scrollLeft,this._handleScroll(e?"scroll":"system")}_handleScroll(e="system"){let t=this._viewportScrollContainerY.scrollHeight-this._viewportScrollContainerY.clientHeight,i=this._viewportScrollContainerY.scrollWidth-this._viewportScrollContainerY.clientWidth;t=Math.max(0,t),i=Math.max(0,i),this.scrollTop>t&&(this.scrollTop=t,this.scrollHeight=t),this.scrollLeft>i&&(this.scrollLeft=i);const n=Math.abs(this.scrollTop-this.prevScrollTop),s=Math.abs(this.scrollLeft-this.prevScrollLeft);if(s&&(this.prevScrollLeft=this.scrollLeft,this._viewportScrollContainerX.scrollLeft=this.scrollLeft,this._headerScrollContainer.scrollLeft=this.scrollLeft,this._topPanelScrollers[0].scrollLeft=this.scrollLeft,this._options.createFooterRow&&(this._footerRowScrollContainer.scrollLeft=this.scrollLeft),this._options.createPreHeaderPanel&&(this.hasFrozenColumns()?this._preHeaderPanelScrollerR.scrollLeft=this.scrollLeft:this._preHeaderPanelScroller.scrollLeft=this.scrollLeft),this._options.createTopHeaderPanel&&(this._topHeaderPanelScroller.scrollLeft=this.scrollLeft),this.hasFrozenColumns()?(this.hasFrozenRows&&(this._viewportTopR.scrollLeft=this.scrollLeft),this._headerRowScrollerR.scrollLeft=this.scrollLeft):(this.hasFrozenRows&&(this._viewportTopL.scrollLeft=this.scrollLeft),this._headerRowScrollerL.scrollLeft=this.scrollLeft)),n&&!this._options.autoHeight)if(this.vScrollDir=this.prevScrollTop<this.scrollTop?1:-1,this.prevScrollTop=this.scrollTop,"mousewheel"===e&&(this._viewportScrollContainerY.scrollTop=this.scrollTop),this.hasFrozenColumns()&&(this.hasFrozenRows&&!this._options.frozenBottom?this._viewportBottomL.scrollTop=this.scrollTop:this._viewportTopL.scrollTop=this.scrollTop),n<this.viewportH)this.scrollTo(this.scrollTop+this.offset);else{const e=this.offset;this.h===this.viewportH?this.page=0:this.page=Math.min(this.n-1,Math.floor(this.scrollTop*((this.th-this.viewportH)/(this.h-this.viewportH))*(1/this.ph))),this.offset=Math.round(this.page*this.cj),e!==this.offset&&this.invalidateAllRows()}if(s||n){const e=Math.abs(this.lastRenderedScrollLeft-this.scrollLeft),t=Math.abs(this.lastRenderedScrollTop-this.scrollTop);(e>20||t>20)&&(this._options.forceSyncScrolling||t<this.viewportH&&e<this.viewportW?this.render():this.scrollThrottle.enqueue(),this.triggerEvent(this.onViewportChanged,{}))}return this.triggerEvent(this.onScroll,{triggeredBy:e,scrollHeight:this.scrollHeight,scrollLeft:this.scrollLeft,scrollTop:this.scrollTop}),!(!s&&!n)}actionThrottle(e,t){let i=!1,n=!1;const s=()=>{n=!1},r=()=>{i=!0,window.clearTimeout(this._executionBlockTimer),this._executionBlockTimer=window.setTimeout(o,t),e.call(this)},o=()=>{n?(s(),r()):i=!1};return{enqueue:(()=>{i?n=!0:r()}).bind(this),dequeue:s.bind(this)}}asyncPostProcessRows(){const e=this.getDataLength();for(;this.postProcessFromRow<=this.postProcessToRow;){const t=this.vScrollDir>=0?this.postProcessFromRow++:this.postProcessToRow--,i=this.rowsCache[t];if(i&&!(t>=e))return this.postProcessedRows[t]||(this.postProcessedRows[t]={}),this.ensureCellNodesInRowsCache(t),Object.keys(i.cellNodesByColumnIdx).forEach((e=>{if(i.cellNodesByColumnIdx.hasOwnProperty(e)){const n=+e,s=this.columns[n],r=this.postProcessedRows[t][n];if(s.asyncPostRender&&"R"!==r){const e=i.cellNodesByColumnIdx[n];e&&s.asyncPostRender(e,t,this.getDataItem(t),s,"C"===r),this.postProcessedRows[t][n]="R"}}})),void(this.h_postrender=window.setTimeout(this.asyncPostProcessRows.bind(this),this._options.asyncPostRenderDelay))}}asyncPostProcessCleanupRows(){if(this.postProcessedCleanupQueue.length>0){const e=this.postProcessedCleanupQueue[0].groupId;for(;this.postProcessedCleanupQueue.length>0&&this.postProcessedCleanupQueue[0].groupId===e;){const e=this.postProcessedCleanupQueue.shift();if("R"===e?.actionType&&e.node.forEach((e=>{e.remove()})),"C"===e?.actionType){const t=this.columns[e.columnIdx];t.asyncPostRenderCleanup&&e.node&&t.asyncPostRenderCleanup(e.node,e.rowIdx,t)}}this.h_postrenderCleanup=window.setTimeout(this.asyncPostProcessCleanupRows.bind(this),this._options.asyncPostRenderCleanupDelay)}}updateCellCssStylesOnRenderedRows(e,t){let i,n,s;"object"==typeof this.rowsCache&&Object.keys(this.rowsCache).forEach((r=>{this.rowsCache&&(s=t?.[r],n=e?.[r],s&&Object.keys(s).forEach((e=>{n&&s[e]===n[e]||(i=this.getCellNode(+r,this.getColumnIndex(e)),i&&i.classList.remove(s[e]))})),n&&Object.keys(n).forEach((e=>{s&&s[e]===n[e]||(i=this.getCellNode(+r,this.getColumnIndex(e)),i&&i.classList.add(n[e]))})))}))}addCellCssStyles(e,t){if(this.cellCssClasses[e])throw new Error(`SlickGrid addCellCssStyles: cell CSS hash with key "${e}" already exists.`);this.cellCssClasses[e]=t,this.updateCellCssStylesOnRenderedRows(t,null),this.triggerEvent(this.onCellCssStylesChanged,{key:e,hash:t,grid:this})}removeCellCssStyles(e){this.cellCssClasses[e]&&(this.updateCellCssStylesOnRenderedRows(null,this.cellCssClasses[e]),delete this.cellCssClasses[e],this.triggerEvent(this.onCellCssStylesChanged,{key:e,hash:null,grid:this}))}setCellCssStyles(e,t){const i=this.cellCssClasses[e];this.cellCssClasses[e]=t,this.updateCellCssStylesOnRenderedRows(t,i),this.triggerEvent(this.onCellCssStylesChanged,{key:e,hash:t,grid:this})}getCellCssStyles(e){return this.cellCssClasses[e]}flashCell(e,t,i=250){const n=(e,t)=>{t<1||(window.clearTimeout(this._flashCellTimer),this._flashCellTimer=window.setTimeout((()=>{t%2==0?e.classList.add(this._options.cellFlashingCssClass||""):e.classList.remove(this._options.cellFlashingCssClass||""),n(e,t-1)}),i))};if(this.rowsCache[e]){const i=this.getCellNode(e,t);i&&n(i,5)}}highlightRow(e,t){const i=this.rowsCache[e];t||=this._options.rowHighlightDuration,Array.isArray(i?.rowNode)&&this._options.rowHighlightCssClass&&(i.rowNode.forEach((e=>e.classList.add(...Q(this._options.rowHighlightCssClass)))),window.clearTimeout(this._highlightRowTimer),this._highlightRowTimer=window.setTimeout((()=>{i.rowNode?.forEach((e=>e.classList.remove(...Q(this._options.rowHighlightCssClass))))}),t))}handleMouseWheel(e,t,i,n){this.scrollHeight=this._viewportScrollContainerY.scrollHeight,this.scrollTop=Math.max(0,this._viewportScrollContainerY.scrollTop-n*this._options.rowHeight),this.scrollLeft=this._viewportScrollContainerX.scrollLeft+10*i,this._handleScroll("mousewheel")&&e.preventDefault()}handleDragInit(e,t){const i=this.getCellFromEvent(e);if(!i||!this.cellExists(i.row,i.cell))return!1;const n=this.triggerEvent(this.onDragInit,t,e);return!!n.isImmediatePropagationStopped()&&n.getReturnValue()}handleDragStart(e,t){const i=this.getCellFromEvent(e);if(!i||!this.cellExists(i.row,i.cell))return!1;const n=this.triggerEvent(this.onDragStart,t,e);return!!n.isImmediatePropagationStopped()&&n.getReturnValue()}handleDrag(e,t){return this.triggerEvent(this.onDrag,t,e).getReturnValue()}handleDragEnd(e,t){this.triggerEvent(this.onDragEnd,t,e)}handleKeyDown(e){let t=this.triggerEvent(this.onKeyDown,{row:this.activeRow,cell:this.activeCell},e).isImmediatePropagationStopped();if(!t&&!e.shiftKey&&!e.altKey){if(this._options.editable&&this.currentEditor?.keyCaptureList&&this.currentEditor.keyCaptureList.indexOf(e.which)>-1)return;"Home"===e.key?t=e.ctrlKey?this.navigateTop():this.navigateRowStart():"End"===e.key&&(t=e.ctrlKey?this.navigateBottom():this.navigateRowEnd())}if(!t)if(e.shiftKey||e.altKey||e.ctrlKey)"Tab"!==e.key||!e.shiftKey||e.ctrlKey||e.altKey||(t=this.navigatePrev());else if("Escape"===e.key){if(!this.getEditorLock()?.isActive())return;this.cancelEditAndSetFocus()}else"PageDown"===e.key?(this.navigatePageDown(),t=!0):"PageUp"===e.key?(this.navigatePageUp(),t=!0):"ArrowLeft"===e.key?t=this.navigateLeft():"ArrowRight"===e.key?t=this.navigateRight():"ArrowUp"===e.key?t=this.navigateUp():"ArrowDown"===e.key?t=this.navigateDown():"Tab"===e.key?t=this.navigateNext():"Enter"===e.key&&(this._options.editable&&(this.currentEditor?this.activeRow===this.getDataLength()?this.navigateDown():this.commitEditAndSetFocus():this.getEditorLock()?.commitCurrentEdit()&&this.makeActiveCellEditable(void 0,void 0,e)),t=!0);t&&(e.stopPropagation(),e.preventDefault())}handleClick(e){const t=e instanceof mn?e.getNativeEvent():e;if(!this.currentEditor&&(t.target!==document.activeElement||t.target.classList.contains("slick-cell"))){const e=this.getTextSelection();this.setFocus(),this.setTextSelection(e)}const i=this.getCellFromEvent(t);if(i&&(null===this.currentEditor||this.activeRow!==i.row||this.activeCell!==i.cell)&&!(e=this.triggerEvent(this.onClick,{row:i.row,cell:i.cell},e||t)).isImmediatePropagationStopped()&&!t.defaultPrevented&&this.canCellBeActive(i.row,i.cell)&&(!this.getEditorLock()?.isActive()||this.getEditorLock()?.commitCurrentEdit())){this.scrollRowIntoView(i.row,!1);const e="slick-edit-preclick"===t.target?.className,n=this.columns[i.cell],s=!!(this._options.editable&&n?.editorClass&&this._options.suppressActiveCellChangeOnEdit);this.setActiveCellInternal(this.getCellNode(i.row,i.cell),null,e,s,t)}}handleContextMenu(e){const t=e.target.closest(".slick-cell");t&&(this.activeCellNode===t&&null!==this.currentEditor||this.triggerEvent(this.onContextMenu,{},e))}handleDblClick(e){const t=this.getCellFromEvent(e);!t||null!==this.currentEditor&&this.activeRow===t.row&&this.activeCell===t.cell||(this.triggerEvent(this.onDblClick,{row:t.row,cell:t.cell},e),e.defaultPrevented||this._options.editable&&this.gotoCell(t.row,t.cell,!0,e))}handleHeaderMouseEnter(e){const t=wn.storage.get(e.target.closest(".slick-header-column"),"column");t&&this.triggerEvent(this.onHeaderMouseEnter,{column:t,grid:this},e)}handleHeaderMouseOver(e){const t=wn.storage.get(e.target.closest(".slick-header-column"),"column");t&&this.triggerEvent(this.onHeaderMouseOver,{column:t,grid:this},e)}handleHeaderMouseLeave(e){const t=wn.storage.get(e.target.closest(".slick-header-column"),"column");t&&this.triggerEvent(this.onHeaderMouseLeave,{column:t,grid:this},e)}handleHeaderMouseOut(e){const t=wn.storage.get(e.target.closest(".slick-header-column"),"column");t&&this.triggerEvent(this.onHeaderMouseOut,{column:t,grid:this},e)}handleHeaderRowMouseEnter(e){const t=wn.storage.get(e.target.closest(".slick-headerrow-column"),"column");t&&this.triggerEvent(this.onHeaderRowMouseEnter,{column:t,grid:this},e)}handleHeaderRowMouseOver(e){const t=wn.storage.get(e.target.closest(".slick-headerrow-column"),"column");t&&this.triggerEvent(this.onHeaderRowMouseOver,{column:t,grid:this},e)}handleHeaderRowMouseLeave(e){const t=wn.storage.get(e.target.closest(".slick-headerrow-column"),"column");t&&this.triggerEvent(this.onHeaderRowMouseLeave,{column:t,grid:this},e)}handleHeaderRowMouseOut(e){const t=wn.storage.get(e.target.closest(".slick-headerrow-column"),"column");t&&this.triggerEvent(this.onHeaderRowMouseOut,{column:t,grid:this},e)}handleHeaderContextMenu(e){const t=e.target.closest(".slick-header-column"),i=t&&wn.storage.get(t,"column");this.triggerEvent(this.onHeaderContextMenu,{column:i},e)}handleHeaderClick(e){if(!this.columnResizeDragging){const t=e.target.closest(".slick-header-column"),i=t&&wn.storage.get(t,"column");i&&this.triggerEvent(this.onHeaderClick,{column:i},e)}}handlePreHeaderContextMenu(e){this.triggerEvent(this.onPreHeaderContextMenu,{node:e.target},e)}handlePreHeaderClick(e){this.columnResizeDragging||this.triggerEvent(this.onPreHeaderClick,{node:e.target},e)}handleFooterContextMenu(e){const t=e.target.closest(".slick-footerrow-column"),i=t&&wn.storage.get(t,"column");this.triggerEvent(this.onFooterContextMenu,{column:i},e)}handleFooterClick(e){const t=e.target.closest(".slick-footerrow-column"),i=t&&wn.storage.get(t,"column");this.triggerEvent(this.onFooterClick,{column:i},e)}handleCellMouseOver(e){this.triggerEvent(this.onMouseEnter,{},e)}handleCellMouseOut(e){this.triggerEvent(this.onMouseLeave,{},e)}cellExists(e,t){return!(e<0||e>=this.getDataLength()||t<0||t>=this.columns.length)}getCellFromPoint(e,t){let i=this.getRowFromPosition(t),n=0,s=0;for(let t=0;t<this.columns.length&&s<=e;t++)this.columns[t]&&(s+=this.columns[t].width,n++);return n-=1,i<-1&&(i=-1),{row:i,cell:n}}getCellFromNode(e){const t=/l\d+/.exec(e.className);if(!t)throw new Error(`SlickGrid getCellFromNode: cannot get cell - ${e.className}`);return parseInt(t[0].substr(1,t[0].length-1),10)}getRowFromNode(e){for(const t in this.rowsCache)if(this.rowsCache)for(const i in this.rowsCache[t].rowNode)if(this.rowsCache[t].rowNode?.[+i]===e)return t?parseInt(t,10):0;return null}getFrozenRowOffset(e){let t=0;return t=this.hasFrozenRows?this._options.frozenBottom?e>=this.actualFrozenRow?this.h<this.viewportTopH?this.actualFrozenRow*this._options.rowHeight:this.h:0:e>=this.actualFrozenRow?this.frozenRowsHeight:0:0,t}getCellFromEvent(e){const t=e instanceof mn?e.getNativeEvent():e;if(!t)return null;const i=t.touches?t.touches[0]:t,n=t.target.closest(".slick-cell");if(!n)return null;let s=this.getRowFromNode(n.parentNode);if(this.hasFrozenRows){let e=0;const t=ne(wn.parents(n,".grid-canvas")[0]);wn.parents(n,".grid-canvas-bottom").length&&(e=this._options.frozenBottom?wn.height(this._canvasTopL):this.frozenRowsHeight);const r=i.clientX-t.left,o=i.clientY-t.top+e+document.documentElement.scrollTop;s=this.getCellFromPoint(r,o).row}const r=this.getCellFromNode(n);return De(s)&&De(r)?{row:s,cell:r}:null}getCellNodeBox(e,t){if(!this.cellExists(e,t))return null;const i=this.getFrozenRowOffset(e),n=this.getRowTop(e)-i,s=n+this._options.rowHeight-1;let r=0;for(let e=0;e<t;e++)this.columns[e]&&!this.columns[e].hidden&&(r+=this.columns[e].width||0,this._options.frozenColumn===e&&(r=0));return{top:n,left:r,bottom:s,right:r+(this.columns[t]?.width||0)}}resetActiveCell(){this.setActiveCellInternal(null,!1)}focus(){this.setFocus()}setFocus(){-1===this.tabbingDirection?this._focusSink.focus():this._focusSink2.focus()}scrollCellIntoView(e,t,i){if(this.scrollRowIntoView(e,i),t<=this._options.frozenColumn)return;const n=this.getColspan(e,t);this.internalScrollColumnIntoView(this.columnPosLeft[t],this.columnPosRight[t+(n>1?n-1:0)])}internalScrollColumnIntoView(e,t){const i=this.scrollLeft+wn.width(this._viewportScrollContainerX)-(this.viewportHasVScroll&&this.scrollbarDimensions?.width||0);e<this.scrollLeft?(this._viewportScrollContainerX.scrollLeft=e,this.handleScroll(),this.render()):t>i&&(this._viewportScrollContainerX.scrollLeft=Math.min(e,t-this._viewportScrollContainerX.clientWidth),this.handleScroll(),this.render())}scrollColumnIntoView(e){this.internalScrollColumnIntoView(this.columnPosLeft[e],this.columnPosRight[e])}setActiveCellInternal(e,t,i,n,s){if(ke(this.activeCellNode)&&(this.makeActiveCellNormal(),this.activeCellNode.classList.remove("active"),this.rowsCache[this.activeRow]?.rowNode?.forEach((e=>e.classList.remove("active")))),this.activeCellNode=e,ke(this.activeCellNode)){const e=ne(this.activeCellNode);let n=Math.floor(ne(wn.parents(this.activeCellNode,".grid-canvas")[0]).top);const r=wn.parents(this.activeCellNode,".grid-canvas-bottom").length;this.hasFrozenRows&&r&&(n-=this._options.frozenBottom?wn.height(this._canvasTopL):this.frozenRowsHeight);const o=this.getCellFromPoint(e.left,Math.ceil(e.top)-n);this.activeRow=o.row,this.activeCell=this.activePosX=this.activeCell=this.activePosX=this.getCellFromNode(this.activeCellNode),!ke(t)&&this._options.autoEditNewRow&&(t=this.activeRow===this.getDataLength()||this._options.autoEdit),this._options.showCellSelection&&(this.activeCellNode.classList.add("active"),this.rowsCache[this.activeRow]?.rowNode?.forEach((e=>e.classList.add("active")))),this._options.editable&&t&&this.isCellPotentiallyEditable(this.activeRow,this.activeCell)&&(this._options.asyncEditorLoading?(window.clearTimeout(this.h_editorLoader),this.h_editorLoader=window.setTimeout((()=>{this.makeActiveCellEditable(void 0,i,s)}),this._options.asyncEditorLoadDelay)):this.makeActiveCellEditable(void 0,i,s))}else this.activeRow=this.activeCell=null;n||this.triggerEvent(this.onActiveCellChanged,this.getActiveCell())}clearTextSelection(){if(document.selection?.empty)try{document.selection.empty()}catch(e){}else if(window.getSelection){const e=window.getSelection();e?.removeAllRanges&&e.removeAllRanges()}}isCellPotentiallyEditable(e,t){const i=this.getDataLength();return!(e<i&&!this.getDataItem(e)||this.columns[t].cannotTriggerInsert&&e>=i||!this.columns[t]||this.columns[t].hidden||!this.getEditor(e,t))}makeActiveCellNormal(e=!1){if(this.currentEditor){if(this.triggerEvent(this.onBeforeCellEditorDestroy,{editor:this.currentEditor}),this.currentEditor.destroy(),this.currentEditor=null,this.activeCellNode){const t=this.getDataItem(this.activeRow);if(this.activeCellNode.classList.remove("editable"),this.activeCellNode.classList.remove("invalid"),t){const e=this.columns[this.activeCell],i=this.getFormatter(this.activeRow,e)(this.activeRow,this.activeCell,this.getDataItemValueForColumn(t,e),e,t,this);this.applyFormatResultToCellNode(i,this.activeCellNode),this.invalidatePostProcessingResults(this.activeRow)}e&&this.setFocus()}navigator.userAgent.toLowerCase().match(/msie/)&&this.clearTextSelection(),this.getEditorLock()?.deactivate(this.editController)}}editActiveCell(e,t,i){this.makeActiveCellEditable(e,t,i)}makeActiveCellEditable(e,t,i){if(!this.activeCellNode)return;if(!this._options.editable)throw new Error("SlickGrid makeActiveCellEditable : should never get called when grid options.editable is false");if(window.clearTimeout(this.h_editorLoader),!this.isCellPotentiallyEditable(this.activeRow,this.activeCell))return;const n=this.columns[this.activeCell],s=this.getDataItem(this.activeRow);if(!1===this.triggerEvent(this.onBeforeEditCell,{row:this.activeRow,cell:this.activeCell,item:s,column:n,target:"grid"}).getReturnValue())return void this.setFocus();this.getEditorLock()?.activate(this.editController),this.activeCellNode.classList.add("editable");const r=e||this.getEditor(this.activeRow,this.activeCell);if("function"==typeof r){e||r.suppressClearOnEdit||ee(this.activeCellNode);let o=this.data?.getItemMetadata?.(this.activeRow);o=o?.columns;const a=o&&(o[n.id]||o[this.activeCell]),l={grid:this,gridPosition:this.absBox(this._container),position:this.absBox(this.activeCellNode),container:this.activeCellNode,column:n,columnMetaData:a,item:s||{},event:i,commitChanges:this.commitEditAndSetFocus.bind(this),cancelChanges:this.cancelEditAndSetFocus.bind(this)};this.currentEditor=new r(l),s&&this.currentEditor&&(this.currentEditor.loadValue(s),t&&"function"==typeof this.currentEditor?.preClick&&this.currentEditor.preClick()),this.serializedEditorValue=this.currentEditor?.serializeValue(),this.currentEditor?.position&&this.handleActiveCellPositionChange()}}commitEditAndSetFocus(e=!0){this.getEditorLock()?.commitCurrentEdit()&&(this.setFocus(),this._options.autoEdit&&!this._options.autoCommitEdit&&e&&this.navigateDown())}cancelEditAndSetFocus(){this.getEditorLock()?.cancelCurrentEdit()&&this.setFocus()}absBox(e){const t={top:e.offsetTop,left:e.offsetLeft,bottom:0,right:0,width:e.offsetWidth,height:e.offsetWidth,visible:!0};t.bottom=t.top+t.height,t.right=t.left+t.width;let i=e.offsetParent;for(;(e=e.parentNode)!==document.body&&e&&e.parentNode;){const n=getComputedStyle(e);t.visible&&e.scrollHeight!==e.offsetHeight&&"visible"!==n.overflowY&&(t.visible=t.bottom>e.scrollTop&&t.top<e.scrollTop+e.clientHeight),t.visible&&e.scrollWidth!==e.offsetWidth&&"visible"!==n.overflowX&&(t.visible=t.right>e.scrollLeft&&t.left<e.scrollLeft+e.clientWidth),t.left-=e.scrollLeft,t.top-=e.scrollTop,e===i&&(t.left+=e.offsetLeft,t.top+=e.offsetTop,i=e.offsetParent),t.bottom=t.top+t.height,t.right=t.left+t.width}return t}getActiveCellPosition(){return this.absBox(this.activeCellNode)}getGridPosition(){return this.absBox(this._container)}handleActiveCellPositionChange(){if(this.activeCellNode&&(this.triggerEvent(this.onActiveCellPositionChanged,{}),this.currentEditor)){const e=this.getActiveCellPosition();this.currentEditor.show&&this.currentEditor.hide&&(e.visible?this.currentEditor.show():this.currentEditor.hide()),this.currentEditor.position&&this.currentEditor.position(e)}}getCellEditor(){return this.currentEditor}getActiveCell(){return this.activeCellNode?{row:this.activeRow,cell:this.activeCell}:null}getActiveCellNode(){return this.activeCellNode}getTextSelection(){let e=null;if(window.getSelection){const t=window.getSelection();(t?.rangeCount||0)>0&&(e=t.getRangeAt(0))}return e}setTextSelection(e){if(window.getSelection&&e){const t=window.getSelection();t&&(t.removeAllRanges(),t.addRange(e))}}scrollRowIntoView(e,t){if(!this.hasFrozenRows||!this._options.frozenBottom&&e>this.actualFrozenRow-1||this._options.frozenBottom&&e<this.actualFrozenRow-1){const i=wn.height(this._viewportScrollContainerY),n=this.hasFrozenRows&&!this._options.frozenBottom?e-this._options.frozenRow:e,s=n*this._options.rowHeight,r=(n+1)*this._options.rowHeight-i+(this.viewportHasHScroll&&this.scrollbarDimensions?.height||0);(n+1)*this._options.rowHeight>this.scrollTop+i+this.offset?(this.scrollTo(t?s:r),this.render()):n*this._options.rowHeight<this.scrollTop+this.offset&&(this.scrollTo(t?r:s),this.render())}}scrollRowToTop(e){this.scrollTo(e*this._options.rowHeight),this.render()}scrollPage(e){const t=e*this.numVisibleRows,i=this.scrollTop+this._options.rowHeight-1;if(this.scrollTo((this.getRowFromPosition(i)+t)*this._options.rowHeight),this.render(),this._options.enableCellNavigation&&ke(this.activeRow)){let e=this.activeRow+t;const i=this.getDataLengthIncludingAddNew();e>=i&&(e=i-1),e<0&&(e=0);let n=0,s=null;const r=this.activePosX;for(;n<=this.activePosX;)this.canCellBeActive(e,n)&&(s=n),n+=this.getColspan(e,n);null!==s?(this.setActiveCellInternal(this.getCellNode(e,s)),this.activePosX=r):this.resetActiveCell()}}navigatePageDown(){this.scrollPage(1)}navigatePageUp(){this.scrollPage(-1)}navigateTop(){this.navigateToRow(0)}navigateBottom(){return this.navigateToRow(this.getDataLength()-1)}navigateToRow(e){const t=this.getDataLength();if(!t)return!0;if(e<0?e=0:e>=t&&(e=t-1),this.scrollCellIntoView(e,0,!0),this._options.enableCellNavigation&&ke(this.activeRow)){let t=0,i=null;const n=this.activePosX;for(;t<=this.activePosX;)this.canCellBeActive(e,t)&&(i=t),t+=this.getColspan(e,t);null!==i?(this.setActiveCellInternal(this.getCellNode(e,i)),this.activePosX=n):this.resetActiveCell()}return!0}getColspan(e,t){const i=this.data?.getItemMetadata?.(e);if(!i||!i.columns)return 1;const n=i.columns[this.columns[t].id]||i.columns[t];let s=n?.colspan;return s="*"===s?this.columns.length-t:s||1,s}findFirstFocusableCell(e){let t=0;for(;t<this.columns.length;){if(this.canCellBeActive(e,t))return t;t+=this.getColspan(e,t)}return null}findLastFocusableCell(e){let t=0,i=null;for(;t<this.columns.length;)this.canCellBeActive(e,t)&&(i=t),t+=this.getColspan(e,t);return i}gotoRight(e,t,i){if(t>=this.columns.length)return null;do{t+=this.getColspan(e,t)}while(t<this.columns.length&&!this.canCellBeActive(e,t));return t<this.columns.length?{row:e,cell:t,posX:t}:null}gotoLeft(e,t,i){if(t<=0)return null;const n=this.findFirstFocusableCell(e);if(null===n||n>=t)return null;let s,r={row:e,cell:n,posX:n},o=!0;for(;o;){if(s=this.gotoRight(r.row,r.cell,r.posX),!s)return o=!1,null;if(s.cell>=t)return o=!1,r;r=s}}gotoDown(e,t,i){let n;const s=this.getDataLengthIncludingAddNew();let r=!0;for(;r;){if(++e>=s)return r=!1,null;for(n=t=0;t<=i;)n=t,t+=this.getColspan(e,t);if(this.canCellBeActive(e,n))return r=!1,{row:e,cell:n,posX:i}}}gotoUp(e,t,i){let n,s=!0;for(;s;){if(--e<0)return s=!1,null;for(n=t=0;t<=i;)n=t,t+=this.getColspan(e,t);if(this.canCellBeActive(e,n))return s=!1,{row:e,cell:n,posX:i}}}gotoNext(e,t,i){if(!De(e)&&!De(t)&&(e=t=i=0,this.canCellBeActive(e,t)))return{row:e,cell:t,posX:t};const n=this.gotoRight(e,t,i);if(n)return n;let s=null;const r=this.getDataLengthIncludingAddNew();for(e===r-1&&e--;++e<r;)if(s=this.findFirstFocusableCell(e),null!==s)return{row:e,cell:s,posX:s};return null}gotoPrev(e,t,i){if(!De(e)&&!De(t)&&(e=this.getDataLengthIncludingAddNew()-1,t=i=this.columns.length-1,this.canCellBeActive(e,t)))return{row:e,cell:t,posX:t};let n,s;for(;!n&&(n=this.gotoLeft(e,t,i),!n);){if(--e<0)return null;t=0,s=this.findLastFocusableCell(e),null!==s&&(n={row:e,cell:s,posX:s})}return n}gotoRowStart(e,t,i){const n=this.findFirstFocusableCell(e);return null===n?null:{row:e,cell:n,posX:n}}gotoRowEnd(e,t,i){const n=this.findLastFocusableCell(e);return null===n?null:{row:e,cell:n,posX:n}}navigateRight(){return this.navigate("right")}navigateLeft(){return this.navigate("left")}navigateDown(){return this.navigate("down")}navigateUp(){return this.navigate("up")}navigateNext(){return this.navigate("next")}navigatePrev(){return this.navigate("prev")}navigateRowStart(){return this.navigate("home")}navigateRowEnd(){return this.navigate("end")}navigate(e){if(!this._options.enableCellNavigation||!this.activeCellNode&&"prev"!==e&&"next"!==e)return!1;if(!this.getEditorLock()?.commitCurrentEdit())return!0;this.setFocus(),this.tabbingDirection={up:-1,down:1,left:-1,right:1,prev:-1,next:1,home:-1,end:1}[e];const t={up:this.gotoUp,down:this.gotoDown,left:this.gotoLeft,right:this.gotoRight,prev:this.gotoPrev,next:this.gotoNext,home:this.gotoRowStart,end:this.gotoRowEnd}[e].call(this,this.activeRow,this.activeCell,this.activePosX);if(t){const e=this.getDataLength();if(this.hasFrozenRows&&this._options.frozenBottom&&t.row===e)return;const i=t.row===e;return(!this._options.frozenBottom&&t.row>=this.actualFrozenRow||this._options.frozenBottom&&t.row<this.actualFrozenRow)&&this.scrollCellIntoView(t.row,t.cell,!i&&this._options.emulatePagingWhenScrolling),this.setActiveCellInternal(this.getCellNode(t.row,t.cell)),this.activePosX=t.posX,!0}return this.setActiveCellInternal(this.getCellNode(this.activeRow,this.activeCell)),!1}getCellNode(e,t){if(this.rowsCache[e]){this.ensureCellNodesInRowsCache(e);try{return this.rowsCache[e].cellNodesByColumnIdx.length>t?this.rowsCache[e].cellNodesByColumnIdx[t]:null}catch(i){return this.rowsCache[e].cellNodesByColumnIdx[t]}}return null}setActiveCell(e,t,i,n,s){!this.initialized||!this._options.enableCellNavigation||e>this.getDataLength()||e<0||t>=this.columns.length||t<0||(this.scrollCellIntoView(e,t,!1),this.setActiveCellInternal(this.getCellNode(e,t),i,n,s))}setActiveRow(e,t,i){t??=0,!this.initialized||e>this.getDataLength()||e<0||t>=this.columns.length||t<0||(this.activeRow=e,i||this.scrollCellIntoView(e,t,!1))}canCellBeActive(e,t){if(!this._options.enableCellNavigation||e>=this.getDataLengthIncludingAddNew()||e<0||t>=this.columns.length||t<0)return!1;if(!this.columns[t]||this.columns[t].hidden)return!1;const i=this.data?.getItemMetadata?.(e);if(void 0!==i?.focusable)return!!i.focusable;const n=i?.columns;return void 0!==n?.[this.columns[t].id]?.focusable?!!n[this.columns[t].id].focusable:void 0!==n?.[t]?.focusable?!!n[t].focusable:!!this.columns[t].focusable}canCellBeSelected(e,t){if(e>=this.getDataLength()||e<0||t>=this.columns.length||t<0)return!1;if(!this.columns[t]||this.columns[t].hidden)return!1;const i=this.data?.getItemMetadata?.(e);if(void 0!==i?.selectable)return!!i.selectable;const n=i?.columns&&(i.columns[this.columns[t].id]||i.columns[t]);return void 0!==n?.selectable?!!n.selectable:!!this.columns[t].selectable}gotoCell(e,t,i,n){if(!this.initialized||!this.canCellBeActive(e,t)||!this.getEditorLock()?.commitCurrentEdit())return;this.scrollCellIntoView(e,t,!1);const s=this.getCellNode(e,t),r=this.columns[t],o=!!(this._options.editable&&r?.editorClass&&this._options.suppressActiveCellChangeOnEdit);this.setActiveCellInternal(s,i||e===this.getDataLength()||this._options.autoEdit,null,o,n),this.currentEditor||this.setFocus()}commitCurrentEdit(){const e=this,t=e.getDataItem(e.activeRow),i=e.columns[e.activeCell];if(e.currentEditor){if(e.currentEditor.isValueChanged()){const n=e.currentEditor.validate();if(n.valid){const n=e.activeRow,s=e.activeCell,r=e.currentEditor,o=e.currentEditor.serializeValue(),a=e.serializedEditorValue;if(e.activeRow<e.getDataLength()){const l={row:n,cell:s,editor:r,serializedValue:o,prevSerializedValue:a,execute:()=>{r.applyValue(t,o),e.updateRow(n),e.triggerEvent(e.onCellChange,{command:"execute",row:n,cell:s,item:t,column:i})},undo:()=>{r.applyValue(t,a),e.updateRow(n),e.triggerEvent(e.onCellChange,{command:"undo",row:n,cell:s,item:t,column:i})}};e._options.editCommandHandler?(e.makeActiveCellNormal(!0),e._options.editCommandHandler(t,i,l)):(l.execute(),e.makeActiveCellNormal(!0))}else{const t={};e.currentEditor.applyValue(t,e.currentEditor.serializeValue()),e.makeActiveCellNormal(!0),e.triggerEvent(e.onAddNewRow,{item:t,column:i})}return!e.getEditorLock()?.isActive()}return e.activeCellNode&&(e.activeCellNode.classList.remove("invalid"),wn.width(e.activeCellNode),e.activeCellNode.classList.add("invalid")),e.triggerEvent(e.onValidationError,{editor:e.currentEditor,cellNode:e.activeCellNode,validationResults:n,row:e.activeRow,cell:e.activeCell,column:i}),e.currentEditor.focus(),!1}e.makeActiveCellNormal(!0)}return!0}cancelCurrentEdit(){return this.makeActiveCellNormal(),!0}rowsToRanges(e){const t=[],i=this.columns.length-1;for(let n=0;n<e.length;n++)t.push(new _n(e[n],0,e[n],i));return t}getSelectedRows(){if(!this.selectionModel)throw new Error("SlickGrid Selection model is not set");return this.selectedRows.slice(0)}setSelectedRows(e,t){if(!this.selectionModel)throw new Error("SlickGrid Selection model is not set");const i=this.getEditorLock();"function"!=typeof i?.isActive||i.isActive()||this.selectionModel.setSelectedRanges(this.rowsToRanges(e),t||"SlickGrid.setSelectedRows")}sanitizeHtmlString(e){return"function"==typeof this._options?.sanitizer&&e&&"string"==typeof e?this._options.sanitizer(e):e}}class jr{constructor(e){this.pluginName="AutoTooltips",this._defaults={enableForCells:!0,enableForHeaderCells:!1,maxToolTipLength:void 0,replaceExisting:!0},this._eventHandler=new vn,this._addonOptions=e}get addonOptions(){return this._addonOptions}get eventHandler(){return this._eventHandler}init(e){this._addonOptions={...this._defaults,...this.addonOptions},this._grid=e,this._addonOptions.enableForCells&&this._eventHandler.subscribe(this._grid.onMouseEnter,this.handleMouseEnter.bind(this)),this._addonOptions.enableForHeaderCells&&this._eventHandler.subscribe(this._grid.onHeaderMouseEnter,this.handleHeaderMouseEnter.bind(this))}destroy(){this.dispose()}dispose(){this._eventHandler?.unsubscribeAll()}handleMouseEnter(e){const t=this._grid.getCellFromEvent(e);if(t){let e,i=this._grid.getCellNode(t.row,t.cell);this._addonOptions&&i&&(!i.title||this._addonOptions?.replaceExisting)&&(i.clientWidth<i.scrollWidth?(e=i.textContent?.trim()??"",this._addonOptions?.maxToolTipLength&&e.length>this._addonOptions?.maxToolTipLength&&(e=e.substring(0,this._addonOptions.maxToolTipLength-3)+"...")):e="",i.title=e),i=null}}handleHeaderMouseEnter(e,t){const i=t.column;let n;const s=e.target;if(s&&(n=s.closest(".slick-header-column"),n&&!i?.toolTip)){const e=s.clientWidth<n.clientWidth?i?.name??"":"";n.title=Qe(te(e,"innerHTML"))}n=null}}class Rr{constructor(){this.pluginName="CellExcelCopyManager",this._eventHandler=new vn,this._bindingEventService=new Ft}get addonOptions(){return this._addonOptions}get eventHandler(){return this._eventHandler}get commandQueue(){return this._commandQueue}get gridOptions(){return this._grid?.getOptions()??{}}get undoRedoBuffer(){return this._undoRedoBuffer}init(e,t){this._grid=e,this.createUndoRedoBuffer(),this._cellSelectionModel=new Vr,this._grid.setSelectionModel(this._cellSelectionModel),this._bindingEventService.bind(document.body,"keydown",this.handleBodyKeyDown.bind(this)),this._addonOptions={...this.getDefaultOptions(),...t},this._cellExternalCopyManagerPlugin=new Pr,this._cellExternalCopyManagerPlugin.init(this._grid,this._addonOptions),this._eventHandler.subscribe(this._cellExternalCopyManagerPlugin.onCopyCells,((e,t)=>{this._addonOptions&&"function"==typeof this._addonOptions.onCopyCells&&this._addonOptions.onCopyCells(e,t)})),this._eventHandler.subscribe(this._cellExternalCopyManagerPlugin.onCopyCancelled,((e,t)=>{this._addonOptions&&"function"==typeof this._addonOptions.onCopyCancelled&&this._addonOptions.onCopyCancelled(e,t)})),this._eventHandler.subscribe(this._cellExternalCopyManagerPlugin.onPasteCells,((e,t)=>{this._addonOptions&&"function"==typeof this._addonOptions.onPasteCells&&this._addonOptions.onPasteCells(e,t)}))}dispose(){this._eventHandler.unsubscribeAll(),this._bindingEventService.unbindAll(),this._cellSelectionModel?.dispose(),this._cellExternalCopyManagerPlugin?.dispose()}createUndoRedoBuffer(){let e=0;this._commandQueue=[],this._undoRedoBuffer={queueAndExecuteCommand:t=>{this._commandQueue[e]=t,e++,t.execute()},undo:()=>{if(0===e)return;e--;const t=this._commandQueue[e];t&&Sn.cancelCurrentEdit()&&t.undo()},redo:()=>{if(e>=this._commandQueue.length)return;const t=this._commandQueue[e];e++,t&&Sn.cancelCurrentEdit()&&t.execute()}}}getDefaultOptions(){let e=0;return{clipboardCommandHandler:e=>{this._undoRedoBuffer.queueAndExecuteCommand.call(this._undoRedoBuffer,e)},dataItemColumnValueExtractor:(e,t,i=0,n=0)=>{const s=this._grid.getActiveCell(),r=this._grid.getCellEditor()&&s?.row===i&&s?.cell===n,o=this.addonOptions?.copyActiveEditorCell||!1;if(!this.gridOptions.editable||!t.editor||!r||o){const s=void 0!==t.exportWithFormatter?t.exportWithFormatter:this.gridOptions.textExportOptions?.exportWithFormatter;if(t.formatter&&s){const s=t.formatter(i,n,e[t.field],t,e,this._grid),r=Le(s)?s:s.html||s.text;return t.sanitizeDataExport||this.gridOptions.textExportOptions?.sanitizeDataExport?Qe((r instanceof HTMLElement?r.innerHTML:r)??""):s}}return null},readOnlyMode:!1,includeHeaderWhenCopying:!1,newRowCreator:t=>{for(let i=0;i<t;i++)this._grid.getData().addItem({[this.gridOptions.datasetIdPropertyName||"id"]:"newRow_"+e++})},replaceNewlinesWith:!1,removeDoubleQuotesOnPaste:!1}}handleBodyKeyDown(e){"Z"===e.key&&(e.ctrlKey||e.metaKey)&&(e.shiftKey?this._undoRedoBuffer.redo():this._undoRedoBuffer.undo())}}class Lr{init(e){this._grid=e,e.hasDataView()&&(this._dataView=e.getData())}getDataItem(e){return this._dataView?this._dataView.getItem(e):this._grid.getDataItem(e)}getDataItems(){return this._dataView?this._dataView.getItems():this._grid.getData()}getDataLength(){return this._dataView?this._dataView.getItemCount():this._grid.getDataLength()}setDataItems(e){this._dataView?this._dataView.setItems(e):this._grid.setData(e)}}const Mr=()=>{};class Pr{constructor(){this.pluginName="CellExternalCopyManager",this._bodyElement=document.body,this._copiedCellStyle="copied",this._copiedCellStyleLayerKey="copy-manager",this._copiedRanges=null,this._dataWrapper=new Lr,this.onCopyCells=new gn("onCopyCells"),this.onCopyCancelled=new gn("onCopyCancelled"),this.onPasteCells=new gn("onPasteCells"),this.onBeforePasteCell=new gn("onBeforePasteCell"),this._eventHandler=new vn}get addonOptions(){return this._addonOptions}get eventHandler(){return this._eventHandler}init(e,t){this._grid=e,this._dataWrapper.init(e),this._addonOptions={...this._addonOptions,...t},this._copiedCellStyleLayerKey=this._addonOptions.copiedCellStyleLayerKey||"copy-manager",this._copiedCellStyle=this._addonOptions.copiedCellStyle||"copied",this._bodyElement=this._addonOptions.bodyElement||document.body,this._onCopyInit=this._addonOptions.onCopyInit||void 0,this._onCopySuccess=this._addonOptions.onCopySuccess||void 0;const i=e.getPubSubService();i&&wn.addSlickEventPubSubWhenDefined(i,this),this._eventHandler.subscribe(this._grid.onKeyDown,this.handleKeyDown.bind(this));const n=e.getSelectionModel();if(!n)throw new Error("Selection model is mandatory for this plugin. Please set a selection model on the grid before adding this plugin: grid.setSelectionModel(new SlickCellSelectionModel())");this._eventHandler.subscribe(n.onSelectedRangesChanged,(()=>{this._grid.getEditorLock().isActive()||this._grid.focus()})),e&&"function"==typeof this._addonOptions?.onBeforePasteCell&&this._eventHandler.subscribe(this.onBeforePasteCell,((t,i)=>{const n=e.getColumns()[i.cell],s={row:i.row,cell:i.cell,dataView:e.getData(),grid:e,columnDef:n,dataContext:e.getDataItem(i.row)};return this._addonOptions.onBeforePasteCell?.(t,s)}))}dispose(){this._eventHandler.unsubscribeAll()}clearCopySelection(){this._grid.removeCellCssStyles(this._copiedCellStyleLayerKey)}getHeaderValueForColumn(e){if("function"==typeof this._addonOptions.headerColumnValueExtractor){const t=te(this._addonOptions.headerColumnValueExtractor(e),"innerHTML");if(t)return Qe(t)}return te(e.name||"","innerHTML")}getDataItemValueForColumn(e,t,i,n,s){if("function"==typeof this._addonOptions.dataItemColumnValueExtractor){const s=this._addonOptions.dataItemColumnValueExtractor(e,t,i,n);if(s)return s instanceof HTMLElement?Qe(s.innerHTML):s}let r="";if(t)if(t.editorClass){const i=document.createElement("p"),n=new t.editorClass({container:i,column:t,event:s,position:{top:0,left:0},gridPosition:{top:0,left:0},grid:this._grid,cancelChanges:Mr,commitChanges:Mr});n.loadValue(e),r=n.serializeValue(),n.destroy(),i.remove()}else r=e[t.field||""];return r}setDataItemValueForColumn(e,t,i){if(!t?.denyPaste){if(this._addonOptions.dataItemColumnValueSetter){const n=this._addonOptions.dataItemColumnValueSetter(e,t,i);if(!0!==n)return n}if(t.editorClass){const n=document.createElement("div"),s=new t.editorClass({container:n,column:t,event:null,position:{top:0,left:0},gridPosition:{top:0,left:0},grid:this._grid,cancelChanges:Mr,commitChanges:Mr});s.loadValue(e);const r=s.validate(void 0,i);if(!r.valid){const e=this._grid.getActiveCell();this._grid.onValidationError.notify({editor:s,cellNode:this._grid.getActiveCellNode(),validationResults:r,row:e?.row,cell:e?.cell,column:t,grid:this._grid})}s.applyValue(e,i),s.destroy(),n.remove()}else e[t.field]=i}}setIncludeHeaderWhenCopying(e){this._addonOptions.includeHeaderWhenCopying=e}createTextBox(e){const t=Z("textarea",{value:e,style:{position:"absolute",left:"-1000px",top:`${document.body.scrollTop}px`}},this._bodyElement);return t.select(),t}decodeTabularData(e,t){const i=e.getColumns(),n=t.value.split(/[\n\f\r](?=(?:[^"]*"[^"]*")*[^"]*$)/);""===n[n.length-1]&&n.pop();let s=0;const r=[];this._bodyElement.removeChild(t);for(const e of n)e.startsWith('"')&&e.endsWith('"')?r[s++]=[e.replaceAll("\n",this._addonOptions.replaceNewlinesWith||"\n").replaceAll("\r","").replaceAll('"',this._addonOptions.removeDoubleQuotesOnPaste?"":'"')]:r[s++]=e.split("\t");const o=this._grid.getActiveCell(),a=this._grid.getSelectionModel()?.getSelectedRanges(),l=a?.length?a[0]:null;let c,h;if(l)c=l.fromRow,h=l.fromCell;else{if(!o)return;c=o.row,h=o.cell}let d=!1,u=r.length,p=r.length?r[0].length:0;1===r.length&&1===r[0].length&&l&&(d=!0,u=l.toRow-l.fromRow+1,p=l.toCell-l.fromCell+1);const f=this._dataWrapper.getDataLength()-c;if(f<u&&"function"==typeof this._addonOptions.newRowCreator){const e=u-f,t=this._dataWrapper.getDataLength();this._addonOptions.newRowCreator(e);const i=this._dataWrapper.getDataLength();i!==t+e&&console.warn(`[Slickgrid-Universal] The "newRowCreator" did not add the correct amount of rows, it should add "${e}" rows but it added "${i-t}" rows`),this._grid.render()}if(c+u>this._dataWrapper.getDataLength()&&"function"==typeof this._addonOptions.newRowCreator){const e=c+u-this._dataWrapper.getDataLength();this._addonOptions.newRowCreator(e)}const m={isClipboardCommand:!0,clippedRange:r,oldValues:[],cellExternalCopyManager:this,_options:this._addonOptions,setDataItemValueForColumn:this.setDataItemValueForColumn,markCopySelection:this.markCopySelection,oneCellToMultiple:d,activeRow:c,activeCell:h,destH:u,destW:p,maxDestY:this._dataWrapper.getDataLength(),maxDestX:this._grid.getColumns().length,h:0,w:0,execute:()=>{m.h=0;for(let e=0;e<m.destH;e++){m.oldValues[e]=[],m.w=0,m.h++;let t=0;for(let n=0;n<m.destW;n++){const s=c+e,o=h+n,a=i[o];if(a.hidden)m.destW++,t++;else if(m.w++,s<m.maxDestY&&o<m.maxDestX){const i=this._dataWrapper.getDataItem(s);if(!1===this._grid.triggerEvent(this.onBeforePasteCell,{row:s,cell:o,dt:i,column:a,target:"grid"}).getReturnValue())continue;m.oldValues[e][n-t]=i[a.field],d?this.setDataItemValueForColumn(i,a,r[0][0]):this.setDataItemValueForColumn(i,a,r[e]?r[e][n-t]:""),this._grid.updateCell(s,o),this._grid.onCellChange.notify({row:s,cell:o,item:i,grid:this._grid,column:{}})}}}const e=new _n(c,h,c+m.h-1,h+m.w-1);this.markCopySelection([e]),this._grid.getSelectionModel()?.setSelectedRanges([e]),this.onPasteCells.notify({ranges:[e]})},undo:()=>{for(let e=0;e<m.destH;e++)for(let t=0;t<m.destW;t++){const n=c+e,s=h+t;if(n<m.maxDestY&&s<m.maxDestX){const r=this._dataWrapper.getDataItem(n);d?this.setDataItemValueForColumn(r,i[s],m.oldValues[0][0]):this.setDataItemValueForColumn(r,i[s],m.oldValues[e][t]),this._grid.updateCell(n,s),this._grid.onCellChange.notify({row:n,cell:s,item:r,grid:this._grid,column:{}})}}const e=new _n(c,h,c+m.h-1,h+m.w-1);this.markCopySelection([e]),this._grid.getSelectionModel()?.setSelectedRanges([e]),this.onPasteCells.notify({ranges:[e]}),"function"==typeof this._addonOptions.onPasteCells&&this._addonOptions.onPasteCells(new mn,{ranges:[e]})}};this._addonOptions.clipboardCommandHandler?this._addonOptions.clipboardCommandHandler(m):m.execute()}handleKeyDown(e){let t;if(!this._grid.getEditorLock().isActive()||this._grid.getOptions().autoEdit){if("Escape"===e.key&&this._copiedRanges&&(e.preventDefault(),this.clearCopySelection(),this.onCopyCancelled.notify({ranges:this._copiedRanges}),"function"==typeof this._addonOptions.onCopyCancelled&&this._addonOptions.onCopyCancelled(e,{ranges:this._copiedRanges}),this._copiedRanges=null),("c"===e.key||"Insert"===e.key)&&(e.ctrlKey||e.metaKey)&&!e.shiftKey&&("function"==typeof this._onCopyInit&&this._onCopyInit.call(this),t=this._grid.getSelectionModel()?.getSelectedRanges()??[],0!==t.length)){this._copiedRanges=t,this.markCopySelection(t),this.onCopyCells.notify({ranges:t}),"function"==typeof this._addonOptions.onCopyCells&&this._addonOptions.onCopyCells(e,{ranges:t});const i=this._grid.getColumns();let n="";for(let s=0;s<t.length;s++){const r=t[s],o=[];for(let t=r.fromRow;t<r.toRow+1;t++){const n=[],s=this._dataWrapper.getDataItem(t);if(0===o.length&&this._addonOptions.includeHeaderWhenCopying){const e=[];for(let t=r.fromCell;t<r.toCell+1;t++)i[t]&&(i[t].name instanceof HTMLElement?Qe(i[t].name.innerHTML):i[t].name).length>0&&!i[t].hidden&&e.push(this.getHeaderValueForColumn(i[t]));o.push(e.join("\t"))}for(let o=r.fromCell;o<r.toCell+1;o++)i[o]&&(i[o].name instanceof HTMLElement?Qe(i[o].name.innerHTML):i[o].name).length>0&&!i[o].hidden&&n.push(this.getDataItemValueForColumn(s,i[o],t,o,e));o.push(n.join("\t"))}n+=o.join("\r\n")+"\r\n"}if(window.clipboardData)return window.clipboardData.setData("Text",n),!0;{const e=document.activeElement,i=this.createTextBox(n);if(i.focus(),window.setTimeout((()=>{this._bodyElement.removeChild(i),e?e.focus():console.log("No element to restore focus to after copy?")}),this.addonOptions?.clipboardPasteDelay??100),"function"==typeof this._onCopySuccess){const e=1===t.length?t[0].toRow+1-t[0].fromRow:t.length;this._onCopySuccess(e)}return!1}}if(!this._addonOptions.readOnlyMode&&("v"===e.key&&(e.ctrlKey||e.metaKey)&&!e.shiftKey||"Insert"===e.key&&e.shiftKey&&!e.ctrlKey)){const e=this.createTextBox("");return window.setTimeout((()=>this.decodeTabularData(this._grid,e)),this.addonOptions?.clipboardPasteDelay??100),!1}}}markCopySelection(e){this.clearCopySelection();const t=this._grid.getColumns(),i={};for(const n of e)for(let e=n.fromRow;e<=n.toRow;e++){i[e]={};for(let s=n.fromCell;s<=n.toCell&&s<t.length;s++)i[e][t[s].id]=this._copiedCellStyle}this._grid.setCellCssStyles(this._copiedCellStyleLayerKey,i),window.clearTimeout(this._clearCopyTI),this._clearCopyTI=window.setTimeout((()=>this.clearCopySelection()),this.addonOptions?.clearCopySelectionDelay||2e3)}}class Nr{constructor(e,t,i){this.extensionUtility=e,this.pubSubService=t,this.sharedService=i,this._addonOptions={},this._camelPluginName="",this._gridUid="",this._menuCssPrefix="",this._menuPluginCssPrefix="",this._bindEventService=new Ft,this._eventHandler=new vn}get addonOptions(){return this._addonOptions}set addonOptions(e){this._addonOptions=e}get eventHandler(){return this._eventHandler}get grid(){return this.sharedService.slickGrid}get gridOptions(){return this.sharedService.gridOptions??{}}get gridUid(){return this._gridUid||(this.grid?.getUID()??"")}get gridUidSelector(){return this.gridUid?`.${this.gridUid}`:""}get menuCssClass(){return this._menuPluginCssPrefix||this._menuCssPrefix}get menuElement(){return this._menuElm||document.querySelector(`.${this.menuCssClass}${this.gridUidSelector}`)}dispose(){this._eventHandler?.unsubscribeAll(),this._bindEventService.unbindAll(),this.pubSubService.unsubscribeAll(),this._commandTitleElm?.remove(),this._optionTitleElm?.remove(),this.disposeAllMenus(),ee(this._menuElm),this.menuElement?.remove(),this._menuElm?.remove()}disposeAllMenus(){this.disposeSubMenus(),this._bindEventService.unbindAll("parent-menu"),document.querySelectorAll(`.${this.menuCssClass}${this.gridUidSelector}`).forEach((e=>e.remove()))}disposeSubMenus(){this._bindEventService.unbindAll("sub-menu"),document.querySelectorAll(`.${this.menuCssClass}.slick-submenu${this.gridUidSelector}`).forEach((e=>e.remove()))}setOptions(e){this._addonOptions={...this._addonOptions,...e}}addSubMenuTitleWhenExists(e,t){if("divider"!==e&&e?.subMenuTitle){const i=document.createElement("div");i.className="slick-menu-title",i.textContent=e.subMenuTitle;const n=e.subMenuTitleCssClass;n&&i.classList.add(...Q(n)),t.appendChild(i)}}populateCommandOrOptionItems(e,t,i,n,s,r,o){if(s&&n&&t)for(const a of n)this.populateSingleCommandOrOptionItem(e,t,i,a,s,r,o)}populateCommandOrOptionTitle(e,t,i,n){if(t){const s=n>0,r=this._menuElm?.querySelector(`.slick-${e}-header`)??Z("div",{className:`slick-${e}-header`}),o=`${e}Title`;s||(t?.[o]?(ee(r),this[`_${e}TitleElm`]=Z("span",{className:"slick-menu-title",textContent:t[o]}),r.appendChild(this[`_${e}TitleElm`]),r.classList.add("with-title")):r.classList.add("no-title"),i.appendChild(r))}}populateSingleCommandOrOptionItem(e,t,i,n,s,r,o){let a=null;if(s&&n&&t){const t=s?.level||0,l="headerButtons"===this._camelPluginName?"":"-item",c=`${this._menuCssPrefix}${l}`;let h=!0,d=!0;if("object"==typeof n&&(h=this.extensionUtility.runOverrideFunctionWhenExists(n.itemVisibilityOverride,s),d=this.extensionUtility.runOverrideFunctionWhenExists(n.itemUsabilityOverride,s)),!h)return null;if("object"==typeof n&&n.itemUsabilityOverride&&(n.disabled=!d),a=Z("li",{className:c,role:"menuitem"}),"object"==typeof n&&ke(n[e])&&(a.dataset[e]=n?.[e]),i&&i.appendChild(a),"object"==typeof n&&n.divider||"divider"===n)return a.classList.add(`${c}-divider`),a;if(n.disabled&&a.classList.add(`${c}-disabled`),(n.hidden||n.showOnHover)&&a.classList.add(`${c}-hidden`),n.cssClass&&a.classList.add(...Q(n.cssClass)),n.tooltip&&(a.title=n.tooltip),"headerButtons"!==this._camelPluginName){const e=Z("div",{className:`${this._menuCssPrefix}-icon`});a.appendChild(e),n.iconCssClass?e.classList.add(...Q(n.iconCssClass)):n.commandItems||n.optionItems||(e.textContent="â¦");const t=Z("span",{className:`${this._menuCssPrefix}-content`,textContent:"object"==typeof n&&n.title||""},a);n.textCssClass&&t.classList.add(...Q(n.textCssClass))}const u=t>0?"sub-menu":"parent-menu";if(this._bindEventService.bind(a,"click",(i=>r.call(this,i,e,n,t,s?.column)),void 0,u),"mouseover"===this._addonOptions?.subMenuOpenByEvent&&"function"==typeof o&&this._bindEventService.bind(a,"mouseover",(i=>o.call(this,i,e,n,t,s?.column)),void 0,u),n.commandItems||n.optionItems){const e=document.createElement("span");e.className="sub-item-chevron",this._addonOptions.subItemChevronClass?e.classList.add(...Q(this._addonOptions.subItemChevronClass)):e.textContent="â®",a.classList.add("slick-submenu-item"),a.appendChild(e)}}return a}}class Fr extends Nr{constructor(e,t,i){super(e,t,i),this.extensionUtility=e,this.pubSubService=t,this.sharedService=i,this._currentCell=-1,this._currentRow=-1,this._lastMenuTypeClicked="",this._subMenuParentId=""}createParentMenu(e){this.menuElement?.remove(),this._menuElm=void 0;const t=this.grid.getCellFromEvent(e);if(t){this._currentCell=t.cell??0,this._currentRow=t.row??0;const i=this._addonOptions?.commandItems||[],n=this._addonOptions?.optionItems||[],s={cell:this._currentCell,row:this._currentRow,grid:this.grid};if(this.closeMenu(e,s),"function"==typeof e.stopPropagation&&(this.pubSubService.publish(`on${Be(this._camelPluginName)}BeforeMenuShow`,s),"function"==typeof this.addonOptions?.onBeforeMenuShow&&!1===this.addonOptions.onBeforeMenuShow(e,s)))return;if(this._menuElm=this.createMenu(i,n),this._menuElm&&(this._menuElm.style.top=`${(e.pageY||0)+5}px`,this._menuElm.style.left=`${e.pageX}px`,this._menuElm.style.display="block",document.body.appendChild(this._menuElm)),this.pubSubService.publish(`on${Be(this._camelPluginName)}AfterMenuShow`,s),"function"==typeof this.addonOptions?.onAfterMenuShow&&!1===this.addonOptions.onAfterMenuShow(e,s))return}return this._menuElm}createMenu(e,t,i=0,n){const s=this.grid.getColumns()[this._currentCell],r=this.grid.getDataItem(this._currentRow),o=n?.command||n?.option;let a=1===i&&o?String(o).replace(/\s/g,""):"";a&&(this._subMenuParentId=a),i>1&&(a=this._subMenuParentId);let l=!0,c=!0;if("contextMenu"===this._camelPluginName){if(l=this.checkIsColumnAllowed(this._addonOptions?.optionShownOverColumnIds??[],s.id),c=this.checkIsColumnAllowed(this._addonOptions?.commandShownOverColumnIds??[],s.id),!s||!(c&&e.length||l&&t.length))return void this.hideMenu()}else if(!s||!s.cellMenu||!e.length&&!t.length)return;const h=`${this.menuCssClass} slick-menu-level-${i} ${this.gridUid}`,d=document.body.querySelector(`.${this.menuCssClass}.slick-menu-level-${i}${this.gridUidSelector}`);if(d){if(d.dataset.subMenuParent===a)return d;this.disposeSubMenus()}const u=document.createElement("div");u.className=h,i>0&&(u.classList.add("slick-submenu"),this.gridOptions?.darkMode&&u.classList.add("slick-dark-mode"),a&&(u.dataset.subMenuParent=a));const p=isNaN(this.addonOptions.maxHeight)?this.addonOptions.maxHeight:`${this.addonOptions.maxHeight??0}px`,f=isNaN(this.addonOptions.maxWidth)?this.addonOptions.maxWidth:`${this.addonOptions.maxWidth??0}px`;p&&(u.style.maxHeight=p),f&&(u.style.maxWidth=f),this.addonOptions?.width&&(u.style.width=ae(this.addonOptions?.width));const m=Z("button",{ariaLabel:"Close",className:"close",type:"button",textContent:"Ã",dataset:{dismiss:this._menuCssPrefix}});if(!this.addonOptions.hideOptionSection&&l&&t.length>0){const e=Z("div",{className:`${this._menuCssPrefix}-option-list`,role:"menu"},u);this.populateCommandOrOptionTitle("option",this.addonOptions,e,i),!this.addonOptions.hideCloseButton&&i<1&&this.populateCommandOrOptionCloseBtn("option",m,e),n&&i>0&&this.addSubMenuTitleWhenExists(n,e),this.populateCommandOrOptionItems("option",this.addonOptions,e,t,{cell:this._currentCell,row:this._currentRow,column:s,dataContext:r,grid:this.grid,level:i},this.handleMenuItemCommandClick,this.handleMenuItemMouseOver)}if(!this.addonOptions.hideCommandSection&&c&&e.length>0){const o=Z("div",{className:`${this._menuCssPrefix}-command-list`,role:"menu"},u);this.populateCommandOrOptionTitle("command",this.addonOptions,o,i),!this.addonOptions.hideCloseButton&&i<1&&(!l||0===t.length||this.addonOptions.hideOptionSection)&&this.populateCommandOrOptionCloseBtn("command",m,o),n&&i>0&&this.addSubMenuTitleWhenExists(n,o),this.populateCommandOrOptionItems("command",this.addonOptions,o,e,{cell:this._currentCell,row:this._currentRow,column:s,dataContext:r,grid:this.grid,level:i},this.handleMenuItemCommandClick,this.handleMenuItemMouseOver)}return i++,u}closeMenu(e,t){if(this.menuElement){if("function"==typeof this.addonOptions?.onBeforeMenuClose&&!1===this.addonOptions.onBeforeMenuClose(e,t))return;this.hideMenu()}}hideMenu(){this.menuElement?.remove(),this._menuElm=null,this.disposeSubMenus()}checkIsColumnAllowed(e,t){return!(e?.length>0)||e.findIndex((e=>e===t))>=0}handleBodyMouseDown(e){if(this.menuElement){let t=!1;const i=e.target.closest(`.${this.menuCssClass}`);(this.menuElement.contains(e.target)||i)&&(t=!0),(this.menuElement!==e.target&&!t&&!e.defaultPrevented||"close"===e.target.className&&i)&&this.closeMenu(e,{cell:this._currentCell,row:this._currentRow,grid:this.grid})}}handleCloseButtonClicked(e){e.defaultPrevented||this.closeMenu(e,{cell:0,row:0,grid:this.grid})}handleMenuItemMouseOver(e,t,i,n=0){void 0===i?.[t]||"divider"===i||i.disabled||i.divider||(i.commandItems||i.optionItems?(this.repositionSubMenu(i,t,n,e),this._lastMenuTypeClicked=t):0===n&&this.disposeSubMenus())}handleMenuItemCommandClick(e,t,i,n=0){if(void 0!==i?.[t]&&"divider"!==i&&!i.disabled&&!i.divider&&void 0!==this._currentCell&&void 0!==this._currentRow){if("option"===t&&!this.grid.getEditorLock().commitCurrentEdit())return;const s=this._currentCell,r=this._currentRow,o=this.grid.getColumns()[this._currentCell],a=this.grid.getDataItem(this._currentRow),l=void 0!==i[t]?i[t]:"";if(void 0===l||i[`${t}Items`])(i.commandItems||i.optionItems)&&this.repositionSubMenu(i,t,n,e);else{const n={cell:this._currentCell,row:this._currentRow,grid:this.grid,[t]:l,item:i,column:o,dataContext:a},c="command"===t?"onCommand":"onOptionSelected",h=`${this._camelPluginName}:${c}`;this.pubSubService.publish(h,n),"function"==typeof this._addonOptions?.[c]&&this._addonOptions[c](e,n),"function"==typeof i.action&&i.action.call(this,e,n),e.defaultPrevented||this.closeMenu(e,{cell:s,row:r,grid:this.grid})}this._lastMenuTypeClicked=t}}populateCommandOrOptionCloseBtn(e,t,i){this._bindEventService.bind(t,"click",(e=>this.handleCloseButtonClicked(e)),void 0,"parent-menu");const n=i.querySelector(`.slick-${e}-header`)??Z("div",{className:`slick-${e}-header`});n?.appendChild(t),i.appendChild(n),n.classList.add("with-close")}repositionSubMenu(e,t,i,n){(n.target.classList.contains("slick-cell")||this._lastMenuTypeClicked!==t)&&this.disposeSubMenus();const s=this.createMenu(e?.commandItems||[],e?.optionItems||[],i+1,e);s&&(s.style.display="block",document.body.appendChild(s),this.repositionMenu(n,s))}repositionMenu(e,t){const i=t?.classList.contains("slick-submenu"),n=i?e.target.closest(`.${this._menuCssPrefix}-item`):e.target.closest(".slick-cell");if(t&&n){t.style.top="0px",t.style.left="0px";const s=e?.touches?.[0]??e,r=ne(n);let o=n&&"cellMenu"===this._camelPluginName?r.left:s.pageX,a=n&&"cellMenu"===this._camelPluginName?r.top:s.pageY;i&&"contextMenu"===this._camelPluginName&&(o=r.left,a=r.top);const l=n.offsetWidth||0,c=t?.offsetHeight||0,h=t?.offsetWidth||this._addonOptions.width||0,d=this.gridOptions.rowHeight||0,u=Number(this._addonOptions.autoAdjustDropOffset||0),p=Number(this._addonOptions.autoAlignSideOffset||0);if(this._addonOptions.autoAdjustDrop||this._addonOptions.dropDirection){const{bottom:e,top:s}=X(n),r=e+u-d;"top"==(r<c&&s-u+d>r?"top":"bottom")||"top"===this._addonOptions.dropDirection?(t.classList.remove("dropdown"),t.classList.add("dropup"),a-=i?c-u-n.clientHeight:c-u):(t.classList.remove("dropup"),t.classList.add("dropdown"),a+=u,"cellMenu"===this._camelPluginName&&(a+=i?u:d+u))}if(this._addonOptions.autoAlignSide||"left"===this._addonOptions.dropSide){const e=this.grid.getGridPosition();let s=o+Number(h);i&&(s+=n.clientWidth);const r=document.documentElement.clientWidth;"left"==(s>=e.width||s>=r?"left":"right")||!i&&"left"===this._addonOptions.dropSide?(t.classList.remove("dropright"),t.classList.add("dropleft"),"cellMenu"!==this._camelPluginName||i?o-=Number(h)-p:o-=Number(h)-l-p):(t.classList.remove("dropleft"),t.classList.add("dropright"),o+=i?p+n.offsetWidth:p)}t.style.top=`${a}px`,t.style.left=`${o}px`}}}class Hr extends Fr{constructor(e,t,i){super(e,t,i),this.extensionUtility=e,this.pubSubService=t,this.sharedService=i,this.pluginName="CellMenu",this._defaults={autoAdjustDrop:!0,autoAlignSide:!0,autoAdjustDropOffset:0,autoAlignSideOffset:0,hideMenuOnScroll:!0,subMenuOpenByEvent:"mouseover"},this._camelPluginName="cellMenu",this._menuCssPrefix="slick-menu",this._menuPluginCssPrefix="slick-cell-menu",this.init(i.gridOptions.cellMenu)}init(e){this._addonOptions={...this._defaults,...e},this.sortMenuItems(this.sharedService.allColumns),this._eventHandler.subscribe(this.grid.onClick,this.handleCellClick.bind(this)),this._addonOptions.hideMenuOnScroll&&this._eventHandler.subscribe(this.grid.onScroll,this.closeMenu.bind(this))}translateCellMenu(){const e=this.sharedService?.gridOptions,t=this.sharedService.allColumns;e?.enableTranslate&&Array.isArray(t)&&t.forEach((e=>{if(e?.cellMenu&&(Array.isArray(e.cellMenu.commandItems)||Array.isArray(e.cellMenu.optionItems))){const t=e.cellMenu.commandItems||[],i=e.cellMenu.optionItems||[];e.cellMenu.commandTitleKey&&(e.cellMenu.commandTitle=this.extensionUtility.translateWhenEnabledAndServiceExist(e.cellMenu.commandTitleKey,"TEXT_COMMANDS")||e.cellMenu.commandTitle),e.cellMenu.optionTitleKey&&(e.cellMenu.optionTitle=this.extensionUtility.translateWhenEnabledAndServiceExist(e.cellMenu.optionTitleKey,"TEXT_COMMANDS")||e.cellMenu.optionTitle),this.extensionUtility.translateMenuItemsFromTitleKey(t,"commandItems"),this.extensionUtility.translateMenuItemsFromTitleKey(i,"optionItems")}}))}handleCellClick(e,t){this.disposeAllMenus();const i=this.grid.getCellFromEvent(e);if(i){const n=this.grid.getDataItem(i.row),s=this.grid.getColumns()[i.cell];s?.cellMenu&&!this.gridOptions.cellMenu?.activateCellOnMenuClick&&e.preventDefault(),this._addonOptions={...this._addonOptions,...s.cellMenu};const r=t||{};if(r.column=s,r.dataContext=n,r.grid=this.grid,!this.extensionUtility.runOverrideFunctionWhenExists(this._addonOptions.menuUsabilityOverride,r))return;this._menuElm=this.createParentMenu(e),this._menuElm&&(this.repositionMenu(e,this._menuElm),this._menuElm.ariaExpanded="true",this._menuElm.style.display="block",this.gridOptions.darkMode&&this._menuElm.classList.add("slick-dark-mode")),this._bindEventService.bind(document.body,"mousedown",this.handleBodyMouseDown.bind(this))}}sortMenuItems(e){e.forEach((e=>{e?.cellMenu?.commandItems&&this.extensionUtility.sortItems(e.cellMenu.commandItems||[],"positionOrder"),e?.cellMenu?.optionItems&&this.extensionUtility.sortItems(e.cellMenu.optionItems||[],"positionOrder")}))}}class Br{constructor(e,t){this.grid=e,this.pluginName="CellRangeDecorator",this._defaults={selectionCssClass:"slick-range-decorator",selectionCss:{border:"2px dashed red",zIndex:"9999"},offset:{top:-1,left:-1,height:-2,width:-2}},this._options=Te(this._defaults,t)}get addonOptions(){return this._options}get addonElement(){return this._elem}destroy(){this.hide()}init(){}hide(){this._elem?.remove(),this._elem=null}show(e){this._elem||(this._elem=Z("div",{className:this._options.selectionCssClass}),Object.keys(this._options.selectionCss).forEach((e=>{this._elem.style[e]=this._options.selectionCss[e]})),this._elem.style.position="absolute",this.grid.getActiveCanvasNode()?.appendChild(this._elem));const t=this.grid.getCellNodeBox(e.fromRow,e.fromCell),i=this.grid.getCellNodeBox(e.toRow,e.toCell);return t&&i&&this._options?.offset&&(this._elem.style.top=`${t.top+this._options.offset.top}px`,this._elem.style.left=`${t.left+this._options.offset.left}px`,this._elem.style.height=`${i.bottom-t.top+this._options.offset.height}px`,this._elem.style.width=`${i.right-t.left+this._options.offset.width}px`),this._elem}}class zr{constructor(e){this.pluginName="CellRangeSelector",this._currentlySelectedRange=null,this._canvas=null,this._dragging=!1,this._gridUid="",this._columnOffset=0,this._rowOffset=0,this._isRightCanvas=!1,this._isBottomCanvas=!1,this._xDelayForNextCell=0,this._yDelayForNextCell=0,this._viewportHeight=0,this._viewportWidth=0,this._isRowMoveRegistered=!1,this._scrollLeft=0,this._scrollTop=0,this._defaults={autoScroll:!0,minIntervalToShowNextCell:30,maxIntervalToShowNextCell:600,accelerateInterval:5,selectionCss:{border:"2px dashed blue"}},this.onBeforeCellRangeSelected=new gn("onBeforeCellRangeSelected"),this.onCellRangeSelecting=new gn("onCellRangeSelecting"),this.onCellRangeSelected=new gn("onCellRangeSelected"),this._eventHandler=new vn,this._options=Te(this._defaults,e)}get addonOptions(){return this._options}get eventHandler(){return this._eventHandler}get gridUid(){return this._gridUid||(this._grid?.getUID()??"")}get gridUidSelector(){return this.gridUid?`.${this.gridUid}`:""}init(e){this._grid=e,this._decorator=this._options.cellDecorator||new Br(e,this._options),this._canvas=e.getCanvasNode(),this._gridOptions=e.getOptions(),this._gridUid=e.getUID();const t=e.getPubSubService();t&&wn.addSlickEventPubSubWhenDefined(t,this),this._eventHandler.subscribe(this._grid.onDrag,this.handleDrag.bind(this)).subscribe(this._grid.onDragInit,this.handleDragInit.bind(this)).subscribe(this._grid.onDragStart,this.handleDragStart.bind(this)).subscribe(this._grid.onDragEnd,this.handleDragEnd.bind(this)).subscribe(this._grid.onScroll,this.handleScroll.bind(this))}destroy(){this.dispose()}dispose(){this._eventHandler?.unsubscribeAll(),ee(this._activeCanvas),ee(this._canvas),this._decorator?.destroy(),this.stopIntervalTimer()}getCellDecorator(){return this._decorator}getCurrentRange(){return this._currentlySelectedRange}getMouseOffsetViewport(e,t){const i=e?.touches?.[0]??e,n=this._activeViewport.scrollLeft,s=this._activeViewport.scrollTop,r=n+this._viewportWidth,o=s+this._viewportHeight,a=ne(this._activeViewport),l=a.left,c=a.top,h=l+this._viewportWidth,d=c+this._viewportHeight,u={e,dd:t,viewport:{left:n,top:s,right:r,bottom:o,offset:{left:l,top:c,right:h,bottom:d}},offset:{x:0,y:0},isOutsideViewport:!1};return i.pageX<l?u.offset.x=i.pageX-l:i.pageX>h&&(u.offset.x=i.pageX-h),i.pageY<c?u.offset.y=c-i.pageY:i.pageY>d&&(u.offset.y=d-i.pageY),u.isOutsideViewport=!!u.offset.x||!!u.offset.y,u}stopIntervalTimer(){this._autoScrollTimerId&&(window.clearInterval(this._autoScrollTimerId),this._autoScrollTimerId=void 0)}handleDrag(e,t){if(!this._dragging&&!this._gridOptions.enableRowMoveManager)return;this._gridOptions.enableRowMoveManager||e.stopImmediatePropagation();const i=e.getNativeEvent();if(this.addonOptions.autoScroll&&(this._draggingMouseOffset=this.getMouseOffsetViewport(i,t),this._draggingMouseOffset.isOutsideViewport))return this.handleDragOutsideViewport();this.stopIntervalTimer(),this.handleDragTo(i,t)}handleDragOutsideViewport(){if(this._xDelayForNextCell=this.addonOptions.maxIntervalToShowNextCell-Math.abs(this._draggingMouseOffset.offset.x)*this.addonOptions.accelerateInterval,this._yDelayForNextCell=this.addonOptions.maxIntervalToShowNextCell-Math.abs(this._draggingMouseOffset.offset.y)*this.addonOptions.accelerateInterval,!this._autoScrollTimerId){let e=0,t=0;this._autoScrollTimerId=window.setInterval((()=>{let i=!1,n=!1;this._draggingMouseOffset.offset.x?(e+=this.addonOptions.minIntervalToShowNextCell,i=e>=this._xDelayForNextCell):e=0,this._draggingMouseOffset.offset.y?(t+=this.addonOptions.minIntervalToShowNextCell,n=t>=this._yDelayForNextCell):t=0,(i||n)&&(i&&(e=0),n&&(t=0),this.handleDragToNewPosition(i,n))}),this.addonOptions.minIntervalToShowNextCell)}}handleDragToNewPosition(e,t){let i=this._draggingMouseOffset.e.pageX,n=this._draggingMouseOffset.e.pageY;const s=this._draggingMouseOffset.offset.x,r=this._draggingMouseOffset.offset.y,o=this._draggingMouseOffset.viewport.offset;e&&s&&(i=s>0?o.right+this._moveDistanceForOneCell.x:o.left-this._moveDistanceForOneCell.x),t&&r&&(n=r>0?o.top-this._moveDistanceForOneCell.y:o.bottom+this._moveDistanceForOneCell.y),this.handleDragTo({pageX:i,pageY:n},this._draggingMouseOffset.dd)}handleDragTo(e,t){const i=e?.touches?.[0]??e,n=this._grid.getCellFromPoint(i.pageX-ne(this._activeCanvas).left+this._columnOffset,i.pageY-ne(this._activeCanvas).top+this._rowOffset);if(void 0!==n){if(this._gridOptions.frozenColumn>=0&&(!this._isRightCanvas&&n.cell>this._gridOptions.frozenColumn||this._isRightCanvas&&n.cell<=this._gridOptions.frozenColumn))return;if(this._gridOptions.frozenRow>=0&&(!this._isBottomCanvas&&n.row>=this._gridOptions.frozenRow||this._isBottomCanvas&&n.row<this._gridOptions.frozenRow))return;if(this.addonOptions.autoScroll&&this._draggingMouseOffset){const e=this._grid.getCellNodeBox(n.row,n.cell);if(e){const t=this._draggingMouseOffset.viewport;(e.left<t.left||e.right>t.right||e.top<t.top||e.bottom>t.bottom)&&this._grid.scrollCellIntoView(n.row,n.cell)}}if(!this._grid.canCellBeSelected(n.row,n.cell))return;if(t?.range){t.range.end=n;const e=new _n(t.range.start.row??0,t.range.start.cell??0,n.row,n.cell);this._decorator.show(e),this.onCellRangeSelecting.notify({range:e})}}}handleDragEnd(e,t){this._decorator.hide(),this._dragging&&(this._dragging=!1,e.stopImmediatePropagation(),this.stopIntervalTimer(),this.onCellRangeSelected.notify({range:new _n(t.range.start.row??0,t.range.start.cell??0,t.range.end.row,t.range.end.cell)}))}handleDragInit(e){this._activeCanvas=this._grid.getActiveCanvasNode(e),this._activeViewport=this._grid.getActiveViewportNode(e);const t=this._grid.getDisplayedScrollbarDimensions();if(this._viewportWidth=this._activeViewport.offsetWidth-t.width,this._viewportHeight=this._activeViewport.offsetHeight-t.height,this._moveDistanceForOneCell={x:this._grid.getAbsoluteColumnMinWidth()/2,y:this._gridOptions.rowHeight/2},this._rowOffset=0,this._columnOffset=0,this._isBottomCanvas=this._activeCanvas.classList.contains("grid-canvas-bottom"),this._gridOptions.frozenRow>-1&&this._isBottomCanvas){const e=`${this.gridUidSelector} .grid-canvas-${this._gridOptions.frozenBottom?"bottom":"top"}`;this._rowOffset=document.querySelector(e)?.clientHeight??0}this._isRightCanvas=this._activeCanvas.classList.contains("grid-canvas-right"),this._gridOptions.frozenColumn>-1&&this._isRightCanvas&&(this._columnOffset=document.querySelector(`${this.gridUidSelector} .grid-canvas-left`)?.clientWidth??0);const i=this._grid.getCellFromEvent(e),n=this._grid.getActiveCell();this._grid.getEditorLock().isActive()&&n&&i&&n.row===i.row&&n.cell===i.cell||(e.stopImmediatePropagation(),e.preventDefault())}handleDragStart(e,t){const i=this._grid.getCellFromEvent(e);if(i&&!1!==this.onBeforeCellRangeSelected.notify(i).getReturnValue()&&this._grid.canCellBeSelected(i.row,i.cell)&&(this._dragging=!0,e.stopImmediatePropagation()),!this._dragging)return;this._grid.focus();const n=ne(this._canvas);let s=t.startX-n.left;this._gridOptions.frozenColumn>=0&&this._isRightCanvas&&(s+=this._scrollLeft);let r=t.startY-n.top;this._gridOptions.frozenRow>=0&&this._isBottomCanvas&&(r+=this._scrollTop);const o=this._grid.getCellFromPoint(s,r);return t.range={start:o,end:{}},this._currentlySelectedRange=t.range,this._decorator.show(new _n(o.row,o.cell))}handleScroll(e,t){this._scrollTop=t.scrollTop,this._scrollLeft=t.scrollLeft}}class Vr{constructor(e){this.pluginName="CellSelectionModel",this._cachedPageRowCount=0,this._prevKeyDown="",this._ranges=[],this._defaults={selectActiveCell:!0},this.onSelectedRangesChanged=new gn("onSelectedRangesChanged"),this._eventHandler=new vn,this._selector=void 0===e||void 0===e.cellRangeSelector?new zr({selectionCss:{border:"2px solid black"}}):e.cellRangeSelector,this._addonOptions=e}get addonOptions(){return this._addonOptions}get cellRangeSelector(){return this._selector}get eventHandler(){return this._eventHandler}init(e){this._grid=e,void 0!==this._addonOptions&&void 0!==this._addonOptions.cellRangeSelector||(this._selector=new zr({selectionCss:{border:"2px solid "+(this._grid.getOptions().darkMode?"white":"black")}})),e.hasDataView()&&(this._dataView=e.getData()),this._addonOptions={...this._defaults,...this._addonOptions};const t=e.getPubSubService();t&&this.onSelectedRangesChanged.setPubSubService(t),this._eventHandler.subscribe(this._grid.onActiveCellChanged,this.handleActiveCellChange.bind(this)).subscribe(this._grid.onKeyDown,this.handleKeyDown.bind(this)).subscribe(this._selector.onBeforeCellRangeSelected,this.handleBeforeCellRangeSelected.bind(this)).subscribe(this._selector.onCellRangeSelected,this.handleCellRangeSelected.bind(this)),e.registerPlugin(this._selector)}destroy(){this.dispose()}dispose(){this._selector&&(this._selector.onBeforeCellRangeSelected.unsubscribe(this.handleBeforeCellRangeSelected.bind(this)),this._selector.onCellRangeSelected.unsubscribe(this.handleCellRangeSelected.bind(this))),this._eventHandler.unsubscribeAll(),this._grid?.unregisterPlugin(this._selector),this._selector?.dispose()}getSelectedRanges(){return this._ranges}rangesAreEqual(e,t){let i=e.length!==t.length;if(!i)for(let n=0;n<e.length;n++)if(e[n].fromCell!==t[n].fromCell||e[n].fromRow!==t[n].fromRow||e[n].toCell!==t[n].toCell||e[n].toRow!==t[n].toRow){i=!0;break}return!i}refreshSelections(){this.setSelectedRanges(this.getSelectedRanges())}removeInvalidRanges(e){const t=[];for(let i=0;i<e.length;i++){const n=e[i];this._grid.canCellBeSelected(n.fromRow,n.fromCell)&&this._grid.canCellBeSelected(n.toRow,n.toCell)&&t.push(n)}return t}resetPageRowCount(){this._cachedPageRowCount=0}setSelectedRanges(e,t="SlickCellSelectionModel.setSelectedRanges"){if(!(this._ranges&&0!==this._ranges.length||e&&0!==e.length))return;const i=!this.rangesAreEqual(this._ranges,e);if(this._ranges=this.removeInvalidRanges(e),i){const e=new mn(new CustomEvent("click",{detail:{caller:t}}),this._ranges);this.onSelectedRangesChanged.notify(this._ranges,e)}}handleActiveCellChange(e,t){this._prevSelectedRow=void 0;const i=ke(t.cell),n=ke(t.row);this._addonOptions?.selectActiveCell&&n&&i?this.setSelectedRanges([new _n(t.row,t.cell)]):this._addonOptions?.selectActiveCell&&(n||i)||this.setSelectedRanges([])}handleBeforeCellRangeSelected(e){const t=this._grid.getCellFromEvent(e),i=this._grid.getActiveCell();if(this._grid.getEditorLock().isActive()&&i&&t&&i.row===t.row&&i.cell===t.cell)return e.stopPropagation(),!1}handleCellRangeSelected(e,t){this._grid.setActiveCell(t.range.fromRow,t.range.fromCell,!1,!1,!0),this.setSelectedRanges([t.range])}isKeyAllowed(e){return["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","PageDown","PageUp","Home","End"].some((t=>t===e))}handleKeyDown(e){let t,i;const n=this._grid.getColumns().length,s=this._grid.getActiveCell();let r=0;if(r=this._dataView&&"getPagingInfo"in this._dataView?this._dataView?.getPagingInfo().pageSize||this._dataView.getLength():this._grid.getDataLength(),s&&(e.shiftKey||e.ctrlKey)&&!e.altKey&&this.isKeyAllowed(e.key)&&(t=this.getSelectedRanges().slice(),t.length||t.push(new _n(s.row,s.cell)),i=t.pop(),"function"==typeof i?.contains)){i.contains(s.row,s.cell)||(i=new _n(s.row,s.cell));let o=i.toRow-i.fromRow,a=i.toCell-i.fromCell;const l=s.row===i.fromRow?1:-1,c=s.cell===i.fromCell?1:-1,h=e.key.startsWith("Arrow");let d,u=0;h&&!e.ctrlKey?("ArrowLeft"===e.key?a-=c:"ArrowRight"===e.key?a+=c:"ArrowUp"===e.key?o-=l:"ArrowDown"===e.key&&(o+=l),u=s.row+l*o):(this._cachedPageRowCount<1&&(this._cachedPageRowCount=this._grid.getViewportRowCount()),void 0===this._prevSelectedRow&&(this._prevSelectedRow=s.row),e.shiftKey&&!e.ctrlKey&&"Home"===e.key?(d=0,u=s.row):e.shiftKey&&!e.ctrlKey&&"End"===e.key?(d=n-1,u=s.row):e.ctrlKey&&e.shiftKey&&"Home"===e.key?(d=0,u=0):e.ctrlKey&&e.shiftKey&&"End"===e.key?(d=n-1,u=r-1):"PageUp"===e.key?(this._prevSelectedRow>=0&&(u=this._prevSelectedRow-this._cachedPageRowCount),u<0&&(u=0)):"PageDown"===e.key&&(this._prevSelectedRow<=r-1&&(u=this._prevSelectedRow+this._cachedPageRowCount),u>r-1&&(u=r-1)),this._prevSelectedRow=u),d??=s.cell+c*a;const p=new _n(s.row,s.cell,u,d);if(this.removeInvalidRanges([p]).length){t.push(p);const e=l>0?p.toRow:p.fromRow,i=c>0?p.toCell:p.fromCell;h?(this._grid.scrollRowIntoView(e),this._grid.scrollCellIntoView(e,i,!1)):(this._grid.scrollRowIntoView(u),this._grid.scrollCellIntoView(u,i,!1))}else t.push(i);this.setSelectedRanges(t),e.preventDefault(),e.stopPropagation(),this._prevKeyDown=e.key}}}class Wr{constructor(e){this.pluginName="RowSelectionModel",this._inHandler=!1,this._ranges=[],this._defaults={autoScrollWhenDrag:!0,cellRangeSelector:void 0,dragToSelect:!1,selectActiveRow:!0},this.onSelectedRangesChanged=new gn("onSelectedRangesChanged"),this._eventHandler=new vn,this._options={...this._defaults,...e}}get addonOptions(){return this._options}get eventHandler(){return this._eventHandler}get gridOptions(){return this._grid?.getOptions()}init(e){this._grid=e,this._options={...this._defaults,...this._options},this._selector=this.addonOptions.cellRangeSelector;const t=e.getPubSubService();t&&this.onSelectedRangesChanged.setPubSubService(t),!this._selector&&this._options.dragToSelect&&(this._selector=new zr({selectionCss:{border:"none"},autoScroll:this._options.autoScrollWhenDrag}),this.addonOptions.cellRangeSelector=this._selector),this._eventHandler.subscribe(this._grid.onActiveCellChanged,this.handleActiveCellChange.bind(this)).subscribe(this._grid.onClick,this.handleClick.bind(this)).subscribe(this._grid.onKeyDown,this.handleKeyDown.bind(this)),this._selector&&(this._grid.registerPlugin(this._selector),this._selector.onCellRangeSelecting.subscribe(this.handleCellRangeSelected.bind(this)),this._selector.onCellRangeSelected.subscribe(this.handleCellRangeSelected.bind(this)),this._selector.onBeforeCellRangeSelected.subscribe(this.handleBeforeCellRangeSelected.bind(this)))}destroy(){this.dispose()}dispose(){this._eventHandler.unsubscribeAll(),this.disposeSelector()}disposeSelector(){this._selector&&(this._selector.onCellRangeSelecting.unsubscribe(this.handleCellRangeSelected.bind(this)),this._selector.onCellRangeSelected.unsubscribe(this.handleCellRangeSelected.bind(this)),this._selector.onBeforeCellRangeSelected.unsubscribe(this.handleBeforeCellRangeSelected.bind(this)),this._grid.unregisterPlugin(this._selector),this._selector?.destroy(),this._selector?.dispose())}getCellRangeSelector(){return this._selector}getSelectedRanges(){return this._ranges}getSelectedRows(){return this.rangesToRows(this._ranges)}refreshSelections(){this.setSelectedRows(this.getSelectedRows())}setSelectedRows(e){this.setSelectedRanges(this.rowsToRanges(e),"SlickRowSelectionModel.setSelectedRows")}setSelectedRanges(e,t="SlickRowSelectionModel.setSelectedRanges"){if(!(this._ranges&&0!==this._ranges.length||e&&0!==e.length))return;this._ranges=e;const i=new mn(new CustomEvent("click",{detail:{caller:t}}),this._ranges);this.onSelectedRangesChanged.notify(this._ranges,i)}getRowsRange(e,t){let i;const n=[];for(i=e;i<=t;i++)n.push(i);for(i=t;i<e;i++)n.push(i);return n}handleBeforeCellRangeSelected(e,t){let i=!1;if(this.gridOptions.enableRowMoveManager&&(i=this.isHandlerColumn(t.cell)??!1),this._grid.getEditorLock().isActive()||i)return e.stopPropagation(),!1;this._grid.setActiveCell(t.row,t.cell)}handleCellRangeSelected(e,t){if(!this.gridOptions.multiSelect||!this.addonOptions.selectActiveRow)return!1;this.setSelectedRanges([new _n(t.range.fromRow,0,t.range.toRow,this._grid.getColumns().length-1)])}handleActiveCellChange(e,t){this._options.selectActiveRow&&null!==t.row&&this.setSelectedRanges([new _n(t.row,0,t.row,this._grid.getColumns().length-1)])}handleClick(e){const t=this._grid.getCellFromEvent(e);if(!t||!this._grid.canCellBeActive(t.row,t.cell))return!1;if(!this.gridOptions.multiSelect||!e.ctrlKey&&!e.shiftKey&&!e.metaKey)return!1;let i=this.rangesToRows(this._ranges);const n=i.indexOf(t.row);if(-1===n&&(e.ctrlKey||e.metaKey))i.push(t.row),this._grid.setActiveCell(t.row,t.cell);else if(-1!==n&&(e.ctrlKey||e.metaKey))i=i.filter((e=>e!==t.row)),this._grid.setActiveCell(t.row,t.cell);else if(i.length&&e.shiftKey){const e=i.pop(),n=Math.min(t.row,e),s=Math.max(t.row,e);i=[];for(let t=n;t<=s;t++)t!==e&&i.push(t);i.push(e),this._grid.setActiveCell(t.row,t.cell)}const s=this.rowsToRanges(i);return this.setSelectedRanges(s),e.stopImmediatePropagation(),!0}handleKeyDown(e){const t=this._grid.getActiveCell();if(this.gridOptions.multiSelect&&t&&e.shiftKey&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&("ArrowUp"===e.key||"ArrowDown"===e.key)){let i,n=this.getSelectedRows();n.sort(((e,t)=>e-t)),n.length||(n=[t.row]);let s=n[0],r=n[n.length-1];if(i="ArrowDown"===e.key?t.row<r||s===r?++r:++s:t.row<r?--r:--s,i>=0&&i<this._grid.getDataLength()){this._grid.scrollRowIntoView(i);const e=this.rowsToRanges(this.getRowsRange(s,r));this.setSelectedRanges(e)}e.preventDefault(),e.stopPropagation()}}isHandlerColumn(e){const t=this._grid.getColumns()[e].behavior||"";return/move|selectAndMove/.test(t)}rangesToRows(e){const t=[];for(let i=0;i<e.length;i++)for(let n=e[i].fromRow;n<=e[i].toRow;n++)t.push(n);return t}rowsToRanges(e){const t=[],i=this._grid.getColumns().length-1;return e.forEach((e=>t.push(new _n(e,0,e,i)))),t}}const $r="mdi-icon-check",Ur="mdi-icon-uncheck";class qr{constructor(e,t){this.pubSubService=e,this.pluginName="CheckboxSelectColumn",this._defaults={columnId:"_checkbox_selector",cssClass:null,field:"_checkbox_selector",hideSelectAllCheckbox:!1,name:"",toolTip:"Select/Deselect All",width:30,reorderable:!1,applySelectOnAllPages:!0,hideInColumnTitleRow:!1,hideInFilterHeaderRow:!0},this._addonOptions=this._defaults,this._checkboxColumnCellIndex=null,this._isSelectAllChecked=!1,this._isUsingDataView=!1,this._selectedRowsLookup={},this._selectAll_UID=this.createUID(),this._bindEventService=new Ft,this._eventHandler=new vn,this._addonOptions={...this._defaults,...t}}get addonOptions(){return this._addonOptions}get headerRowNode(){return this._headerRowNode}get gridOptions(){return this._grid?.getOptions()??{}}get selectAllUid(){return this._selectAll_UID}set selectedRowsLookup(e){this._selectedRowsLookup=e}init(e){this._grid=e,this._isUsingDataView=!Array.isArray(e.getData()),this._isUsingDataView&&(this._dataView=e.getData()),this.gridOptions.backendServiceApi&&(this._addonOptions.applySelectOnAllPages=!1),this._eventHandler.subscribe(e.onSelectedRowsChanged,this.handleSelectedRowsChanged.bind(this)).subscribe(e.onClick,this.handleClick.bind(this)).subscribe(e.onKeyDown,this.handleKeyDown.bind(this)),this._isUsingDataView&&this._dataView&&(this._eventHandler.subscribe(e.onAfterSetColumns,this.handleDataViewSelectedIdsChanged.bind(this)),this._addonOptions.applySelectOnAllPages&&this._eventHandler.subscribe(this._dataView.onSelectedRowIdsChanged,this.handleDataViewSelectedIdsChanged.bind(this)).subscribe(this._dataView.onPagingInfoChanged,this.handleDataViewSelectedIdsChanged.bind(this))),this._addonOptions.hideInFilterHeaderRow||this.addCheckboxToFilterHeaderRow(e),this._addonOptions.hideInColumnTitleRow||this._eventHandler.subscribe(this._grid.onHeaderClick,this.handleHeaderClick.bind(this)),this._rowSelectionModel&&this._grid.getSelectionModel()||(this._rowSelectionModel=new Wr(this.gridOptions.rowSelectionOptions),this._grid.setSelectionModel(this._rowSelectionModel)),this.gridOptions.preselectedRows&&this._rowSelectionModel&&this._grid.getSelectionModel()&&window.setTimeout((()=>this.selectRows(this.gridOptions.preselectedRows||[]))),"function"==typeof this._addonOptions.selectableOverride&&this.selectableOverride(this._addonOptions.selectableOverride)}dispose(){this._bindEventService.unbindAll(),this._eventHandler.unsubscribeAll()}create(e,t){if(this._addonOptions={...this._defaults,...t.checkboxSelector},Array.isArray(e)&&t){const i=this.getColumnDefinition();if(!e.some((e=>e.id===i.id))){const n=t?.checkboxSelector?.columnIndexPosition??0;n>0?e.splice(n,0,i):e.unshift(i),this.pubSubService.publish("onPluginColumnsChanged",{columns:e,pluginName:this.pluginName})}}return this}getOptions(){return this._addonOptions}setOptions(e){if(this._addonOptions={...this._addonOptions,...e},this._addonOptions.hideSelectAllCheckbox)this.hideSelectAllFromColumnHeaderTitleRow(),this.hideSelectAllFromColumnHeaderFilterRow();else if(this._addonOptions.hideInColumnTitleRow?(this.hideSelectAllFromColumnHeaderTitleRow(),this._addonOptions.name&&this._grid.updateColumnHeader(this._addonOptions.columnId||"",this._addonOptions.name,"")):(this.renderSelectAllCheckbox(this._isSelectAllChecked),this._eventHandler.subscribe(this._grid.onHeaderClick,this.handleHeaderClick.bind(this))),this._addonOptions.hideInFilterHeaderRow)this.hideSelectAllFromColumnHeaderFilterRow();else{const e=this.headerRowNode?.querySelector("#filter-checkbox-selectall-container");if(e){e.style.display="flex",e.ariaChecked=String(this._isSelectAllChecked);const t=e.querySelector('input[type="checkbox"]');t&&(t.ariaChecked=String(this._isSelectAllChecked),t.checked=this._isSelectAllChecked)}}}deSelectRows(e){const t=[];for(const i of e)this._selectedRowsLookup[i]&&(t[t.length]=i);this._grid.setSelectedRows(this._grid.getSelectedRows().filter((e=>t.indexOf(e)<0)),"SlickCheckboxSelectColumn.deSelectRows")}selectRows(e){const t=[];for(const i of e)this._selectedRowsLookup[i]&&(t[t.length]=i);const i=this._grid.getSelectedRows()?.concat(t);this._grid.setSelectedRows(i)}createCheckboxElement(e,t=!1){const i=this.gridOptions?.preventDocumentFragmentUsage?document.createElement("span"):new DocumentFragment,n=Z("label",{className:"checkbox-selector-label",htmlFor:e}),s=Z("div",{className:"icon-checkbox-container"});return s.appendChild(Z("input",{id:e,type:"checkbox",checked:t,ariaChecked:String(t)})),s.appendChild(Z("div",{className:`mdi ${t?$r:Ur}`})),n.appendChild(s),i.appendChild(n),i}getColumnDefinition(){const e=String(this._addonOptions?.columnId??this._defaults.columnId);return{id:e,name:this._addonOptions.hideSelectAllCheckbox||this._addonOptions.hideInColumnTitleRow?this._addonOptions.name||"":this.createCheckboxElement(`header-selector${this._selectAll_UID}`),toolTip:this._addonOptions.hideSelectAllCheckbox||this._addonOptions.hideInColumnTitleRow?"":this._addonOptions.toolTip,field:e,cssClass:this._addonOptions.cssClass,excludeFromExport:!0,excludeFromColumnPicker:!0,excludeFromGridMenu:!0,excludeFromQuery:!0,excludeFromHeaderMenu:!0,hideSelectAllCheckbox:this._addonOptions.hideSelectAllCheckbox,resizable:!1,reorderable:this._addonOptions.reorderable,sortable:!1,width:this._addonOptions.width||30,maxWidth:this._addonOptions.width||30,formatter:this.checkboxSelectionFormatter.bind(this)}}hideSelectAllFromColumnHeaderTitleRow(){this._grid.updateColumnHeader(this._addonOptions.columnId||"",this._addonOptions.name||"","")}hideSelectAllFromColumnHeaderFilterRow(){const e=this.headerRowNode?.querySelector("#filter-checkbox-selectall-container");e&&(e.style.display="none")}toggleRowSelection(e){this.toggleRowSelectionWithEvent(null,e)}toggleRowSelectionWithEvent(e,t){const i=this._grid.getDataItem(t);if(!this.checkSelectableOverride(t,i,this._grid))return;const n=this._grid.getSelectedRows();"function"==typeof this._addonOptions.onRowToggleStart&&this._addonOptions.onRowToggleStart(e,{row:t,previousSelectedRows:n});const s=this._selectedRowsLookup[t]?this._grid.getSelectedRows().filter((e=>e!==t)):this._grid.getSelectedRows().concat(t);this._grid.setSelectedRows(s,"click.toggle"),this._grid.setActiveCell(t,this.getCheckboxColumnCellIndex()),this._addonOptions.onRowToggleEnd&&this._addonOptions.onRowToggleEnd(e,{row:t,previousSelectedRows:n})}selectableOverride(e){this._selectableOverride=e}addCheckboxToFilterHeaderRow(e){this._eventHandler.subscribe(e.onHeaderRowCellRendered,((e,t)=>{if(t.column.field===(this._addonOptions.field||"_checkbox_selector")){ee(t.node);const e=`header-filter-selector${this._selectAll_UID}`,i=Z("label",{id:"filter-checkbox-selectall-container",htmlFor:e}),n=Z("div",{className:"icon-checkbox-container"});n.appendChild(Z("input",{id:e,type:"checkbox",ariaChecked:"false"})),n.appendChild(Z("div",{className:"mdi mdi-icon-uncheck"})),i.appendChild(n),t.node.appendChild(i),this._headerRowNode=t.node,this._headerRowNode.classList.add("checkbox-header"),this._bindEventService.bind(i,"click",(e=>this.handleHeaderClick(e,t)))}}))}checkboxSelectionFormatter(e,t,i,n,s,r){if(s&&this.checkSelectableOverride(e,s,r)){const t=this.createUID()+e;return this.createCheckboxElement(`selector${t}`,!!this._selectedRowsLookup[e])}return null}checkSelectableOverride(e,t,i){return"function"!=typeof this._selectableOverride||this._selectableOverride(e,t,i)}createUID(){return Math.round(1e7*Math.random())}getCheckboxColumnCellIndex(){if(null===this._checkboxColumnCellIndex){this._checkboxColumnCellIndex=0;const e=this._grid.getColumns();for(let t=0;t<e.length;t++)e[t].id===this._addonOptions.columnId&&(this._checkboxColumnCellIndex=t)}return this._checkboxColumnCellIndex}handleDataViewSelectedIdsChanged(){const e=this._dataView.getAllSelectedFilteredIds(),t=this._dataView.getFilteredItems();let i=0;if("function"==typeof this._selectableOverride&&e.length>0)for(let e=0;e<this._dataView.getItemCount();e++){const n=this._dataView.getItemByIdx(e),s=this._dataView.getIdPropertyName(),r=n[s];t.findIndex((e=>e[s]===r))>=0&&!this.checkSelectableOverride(e,n,this._grid)&&i++}if(this._isSelectAllChecked=e.length+i>=t.length,this._addonOptions.hideInColumnTitleRow||this._addonOptions.hideSelectAllCheckbox||this.renderSelectAllCheckbox(this._isSelectAllChecked),!this._addonOptions.hideInFilterHeaderRow){const e=this.headerRowNode?.querySelector(`#header-filter-selector${this._selectAll_UID}`),t=this.headerRowNode?.querySelector(".icon-checkbox-container .mdi");e&&(e.ariaChecked=String(this._isSelectAllChecked),e.checked=this._isSelectAllChecked),t&&(t.className=`mdi ${this._isSelectAllChecked?$r:Ur}`)}}handleClick(e,t){if(this._grid.getColumns()[t.cell].id===this._addonOptions.columnId&&"checkbox"===e.target.type){if(e.target.ariaChecked=String(e.target.checked),this._grid.getEditorLock().isActive()&&!this._grid.getEditorLock().commitCurrentEdit())return e.preventDefault(),void e.stopImmediatePropagation();this.toggleRowSelectionWithEvent(e,t.row),e.stopPropagation(),e.stopImmediatePropagation()}}handleHeaderClick(e,t){if(t.column.id===this._addonOptions.columnId&&"checkbox"===e.target.type){if(e.target.ariaChecked=String(e.target.checked),this._grid.getEditorLock().isActive()&&!this._grid.getEditorLock().commitCurrentEdit())return e.preventDefault(),void e.stopImmediatePropagation();let t=e.target.checked;const i=t?"click.selectAll":"click.unselectAll",n=this._grid.getSelectedRows();this._addonOptions.onSelectAllToggleStart&&this._addonOptions.onSelectAllToggleStart(e,{previousSelectedRows:n,caller:i});let s=[];if(t){const e=[];for(let t=0;t<this._grid.getDataLength();t++){const i=this._grid.getDataItem(t);i.__group||i.__groupTotals||!this.checkSelectableOverride(t,i,this._grid)||e.push(t)}s=e,t=!0}if(this._isUsingDataView&&this._dataView&&this._addonOptions.applySelectOnAllPages){const e=[],i=this._dataView.getFilteredItems();for(let t=0;t<i.length;t++){const n=i[t];this.checkSelectableOverride(t,n,this._grid)&&e.push(n[this._dataView.getIdPropertyName()])}this._dataView.setSelectedIds(e,{isRowBeingAdded:t})}this._grid.setSelectedRows(s,i),this._addonOptions.onSelectAllToggleEnd&&this._addonOptions.onSelectAllToggleEnd(e,{rows:s,previousSelectedRows:n,caller:i}),e.stopPropagation(),e.stopImmediatePropagation()}}handleKeyDown(e,t){" "===e.key&&this._grid.getColumns()[t.cell].id===this._addonOptions.columnId&&(this._grid.getEditorLock().isActive()&&!this._grid.getEditorLock().commitCurrentEdit()||this.toggleRowSelectionWithEvent(e,t.row),e.preventDefault(),e.stopImmediatePropagation())}handleSelectedRowsChanged(){const e=this._grid.getSelectedRows(),t={};let i=0,n=0,s=0,r=0;if("function"==typeof this._selectableOverride)for(s=0;s<this._grid.getDataLength();s++){const e=this._grid.getDataItem(s);this.checkSelectableOverride(n,e,this._grid)||r++}const o=[];for(n=0;n<e.length;n++){i=e[n];const s=this._grid.getDataItem(i);this.checkSelectableOverride(n,s,this._grid)?(t[i]=!0,t[i]!==this._selectedRowsLookup[i]&&(this._grid.invalidateRow(i),delete this._selectedRowsLookup[i])):o.push(i)}if("object"==typeof this._selectedRowsLookup&&Object.keys(this._selectedRowsLookup).forEach((e=>{void 0!==e&&this._grid.invalidateRow(+e)})),this._selectedRowsLookup=t,this._grid.render(),this._isSelectAllChecked=(e?.length??0)+r>=this._grid.getDataLength(),!(this._isUsingDataView&&this._addonOptions.applySelectOnAllPages||(this._addonOptions.hideInColumnTitleRow||this._addonOptions.hideSelectAllCheckbox||this.renderSelectAllCheckbox(this._isSelectAllChecked),this._addonOptions.hideInFilterHeaderRow))){const e=this.headerRowNode?.querySelector(`#header-filter-selector${this._selectAll_UID}`);e&&(e.ariaChecked=String(this._isSelectAllChecked),e.checked=this._isSelectAllChecked)}if(o.length>0){for(const t of o){const i=e.indexOf(t);e.splice(i,1)}this._grid.setSelectedRows(e,"click.toggle")}}renderSelectAllCheckbox(e){const t=this._grid.updateColumnHeader(this._addonOptions.columnId||"",this.createCheckboxElement(`header-selector${this._selectAll_UID}`,!!e),this._addonOptions.toolTip);t?.classList.add("header-checkbox-selectall")}}class Gr extends Nr{constructor(e,t,i,n,s){super(e,i,n),this.extensionUtility=e,this.filterService=t,this.pubSubService=i,this.sharedService=n,this.sortService=s,this._areVisibleColumnDifferent=!1,this._columns=[],this._columnCheckboxes=[],this._commandMenuElm=null,this._headerElm=null,this._isMenuOpen=!1,this._subMenuParentId="",this._defaults={dropSide:"left",showButton:!0,hideForceFitButton:!1,hideSyncResizeButton:!1,forceFitTitle:"Force fit columns",marginBottom:15,menuWidth:18,minHeight:150,contentMinWidth:0,resizeOnShowHeaderRow:!1,syncResizeTitle:"Synchronous resize",subMenuOpenByEvent:"mouseover",headerColumnValueExtractor:e=>te(e.columnPickerLabel||e.name||"","innerHTML")},this._menuCssPrefix="slick-menu",this._menuPluginCssPrefix="slick-grid-menu",this._camelPluginName="gridMenu",this._columns=this.sharedService.allColumns??[],this._gridUid=this.grid?.getUID()??"",this.onAfterMenuShow=new gn("onAfterMenuShow"),this.onBeforeMenuShow=new gn("onBeforeMenuShow"),this.onMenuClose=new gn("onMenuClose"),this.onCommand=new gn("onCommand"),this.onColumnsChanged=new gn("onColumnsChanged"),this.initEventHandlers(),this.init()}get addonOptions(){return this._addonOptions||{}}get columns(){return this._columns}set columns(e){this._columns=e}get gridOptions(){return this.grid?.getOptions()||{}}get gridUidSelector(){return this.gridUid?`.${this.gridUid}`:""}initEventHandlers(){this._eventHandler.subscribe(this.grid.onColumnsReordered,io.bind(this)),this._eventHandler.subscribe(this.grid.onClick,(e=>this.hideMenu(e))),this._eventHandler.subscribe(this.grid.onBeforeDestroy,this.dispose.bind(this)),this._eventHandler.subscribe(this.grid.onSetOptions,((e,t)=>{if(t&&t.optionsBefore&&t.optionsAfter){const e=t.optionsBefore.frozenColumn>=0&&-1===t.optionsAfter.frozenColumn,i=-1===t.optionsBefore.frozenColumn&&t.optionsAfter.frozenColumn>=0;(e||i)&&this.recreateGridMenu()}}))}init(){this._gridUid=this.grid.getUID()??"",wn.addSlickEventPubSubWhenDefined(this.pubSubService,this),this._userOriginalGridMenu={...this.sharedService.gridOptions.gridMenu},this._addonOptions={...this._defaults,...this.getDefaultGridMenuOptions(),...this.sharedService.gridOptions.gridMenu},this.sharedService.gridOptions.gridMenu=this._addonOptions;const e=this._userOriginalGridMenu.commandItems,t=this._userOriginalGridMenu&&Array.isArray(e)?e:[];this._addonOptions.commandItems=[...t,...this.addGridMenuCustomCommands(t)],this.extensionUtility.translateMenuItemsFromTitleKey(this._addonOptions.commandItems||[],"commandItems"),this.extensionUtility.sortItems(this._addonOptions.commandItems,"positionOrder"),this.createGridMenu()}dispose(){this.deleteMenu(),super.dispose()}deleteMenu(){this._bindEventService.unbindAll(),this._menuElm?.remove(),this._menuElm=null,this._gridMenuButtonElm?.remove(),this._headerElm&&(this._headerElm.style.width="100%")}createColumnPickerContainer(){this._menuElm&&(Zr.call(this,this._menuElm),this._listElm=Z("div",{className:"slick-column-picker-list",role:"menu"}),this._bindEventService.bind(this._menuElm,"click",Qr.bind(this),void 0,"parent-menu"))}createGridMenu(){const e=this._gridUid?`.${this._gridUid}`:"",t=this._addonOptions?.menuWidth||this._defaults.menuWidth,i=this.gridOptions.hasOwnProperty("frozenColumn")&&this.gridOptions.frozenColumn>=0?"right":"left",n=this.grid.getContainerNode();if(this._headerElm=n.querySelector(`.slick-header-${i}`),this._headerElm&&this._addonOptions){if(this._headerElm.style.width=`calc(100% - ${t}px)`,(this._addonOptions.resizeOnShowHeaderRow??this._defaults.resizeOnShowHeaderRow)&&this.gridOptions.showHeaderRow){const i=n.querySelector(`${e} .slick-headerrow`);i&&(i.style.width=`calc(100% - ${t}px)`)}if(this._addonOptions.showButton??this._defaults.showButton){this._gridMenuButtonElm=Z("button",{className:"slick-grid-menu-button",ariaLabel:"Grid Menu"}),this._addonOptions?.iconCssClass&&this._gridMenuButtonElm.classList.add(...Q(this._addonOptions.iconCssClass));const e="preheader"===this._addonOptions.iconButtonContainer?"firstChild":"lastChild";this._headerElm.parentElement.insertBefore(this._gridMenuButtonElm,this._headerElm.parentElement[e]),this._bindEventService.bind(this._gridMenuButtonElm,"click",this.showGridMenu.bind(this))}this.sharedService.gridOptions.gridMenu={...this._defaults,...this._addonOptions},this.translateTitleLabels(this._addonOptions),this.translateTitleLabels(this.sharedService.gridOptions.gridMenu),this._bindEventService.bind(document.body,"mousedown",this.handleBodyMouseDown.bind(this)),this._bindEventService.bind(document.body,"beforeunload",this.dispose.bind(this))}}createCommandMenu(e,t=0,i){const n=i?.command;let s=1===t&&n?n.replace(/\s/g,""):"";s&&(this._subMenuParentId=s),t>1&&(s=this._subMenuParentId);const r=`${this.menuCssClass} slick-menu-level-${t} ${this._gridUid}`,o=document.body.querySelector(`.${this.menuCssClass}.slick-menu-level-${t}${this.gridUidSelector}`);if(o){if(o.dataset.subMenuParent===s)return o;this.disposeSubMenus()}const a=Z("div",{role:"menu",className:r,ariaLabel:t>1?"SubMenu":"Grid Menu"});t>0&&(a.classList.add("slick-submenu"),s&&(a.dataset.subMenuParent=s));const l={grid:this.grid,menu:this._menuElm,columns:this.columns,allColumns:this.getAllColumns(),visibleColumns:this.getVisibleColumns(),level:t};return this._commandMenuElm=this.recreateCommandList(e,a,l,i),t++,a}getAllColumns(){return this._columns}getVisibleColumns(){return this.grid.getColumns()}hideMenu(e){const t={grid:this.grid,menu:this._menuElm,allColumns:this.columns,visibleColumns:this.getVisibleColumns()};if(this.pubSubService.publish("onGridMenuMenuClose",t),("function"!=typeof this._addonOptions?.onMenuClose||!1!==this._addonOptions.onMenuClose(e,t))&&!1!==this.onMenuClose.notify(t,null,this).getReturnValue()){if(this._isMenuOpen=!1,"function"==typeof this.grid?.autosizeColumns){const e=this.grid.getUID()||"";this._areVisibleColumnDifferent&&e&&null!==document.querySelector(`.${e}`)&&(this.gridOptions.enableAutoSizeColumns&&this.grid.autosizeColumns(),this._areVisibleColumnDifferent=!1)}this.disposeSubMenus(),this._menuElm?.remove(),this._menuElm=null}}recreateGridMenu(){this.deleteMenu(),this.init()}repositionMenu(e,t,i,n){const s=e?.touches?.[0]??e,r=t.classList.contains("slick-submenu"),o=r?e.target.closest(".slick-menu-item"):s.target;if(o){const e=i||this._gridMenuButtonElm,s=ne(i),a=ne(o),l=n??this._addonOptions,c=getComputedStyle(e),h=parseInt(c?.width??this._defaults?.menuWidth,10),d=t?.offsetWidth??0,u=l?.contentMinWidth??this._defaults.contentMinWidth??0,p=(u>d?u:d)||0,f=s.top,m=s.right;let g,v;if(r?(v=a.top,g=a.left):(v=f+e.offsetHeight,g="right"===l?.dropSide?m-h:m-p),r){const e=t?.clientHeight||0,{bottom:i,top:n}=X(o);"top"==(i<e&&n>i?"top":"bottom")?(t.classList.remove("dropdown"),t.classList.add("dropup"),v-=e-o.clientHeight):(t.classList.remove("dropup"),t.classList.add("dropdown"))}const _=this.grid.getGridPosition();let b=g+Number(d);r&&(b+=o.clientWidth);const y=document.documentElement.clientWidth;"left"==(b>=_.width||b>=y?"left":"right")||!r&&"left"===l?.dropSide?(t.classList.remove("dropright"),t.classList.add("dropleft"),r&&(g-=Number(d))):(t.classList.remove("dropleft"),t.classList.add("dropright"),r&&(g+=o.offsetWidth)),t.style.top=`${v}px`,t.style.left=`${g}px`,u>0&&(t.style.minWidth=`${u}px`),t.style.opacity="1",t.style.display="block"}}openGridMenu(){const e=new MouseEvent("click",{bubbles:!0,cancelable:!0,composed:!1});Object.defineProperty(e,"target",{writable:!0,configurable:!0,value:Z("button",{className:"slick-grid-menu-button"})}),this.showGridMenu(e)}showGridMenu(e,t){const i=e?.touches?.[0]??e;if(e.preventDefault(),ee(this._menuElm),this._menuElm?.remove(),this._addonOptions){const n={grid:this.grid,menu:this._menuElm,columns:this.columns,allColumns:this.getAllColumns(),visibleColumns:this.getVisibleColumns()},s={...this._addonOptions,...t};if(s&&!this.extensionUtility.runOverrideFunctionWhenExists(s.menuUsabilityOverride,n))return;if("function"==typeof e.stopPropagation&&(this.pubSubService.publish("onGridMenuBeforeMenuShow",n),"function"==typeof s?.onBeforeMenuShow&&!1===s.onBeforeMenuShow(e,n)||!1===this.onBeforeMenuShow.notify(n,null,this).getReturnValue()))return;this._menuElm=this.createCommandMenu(this._addonOptions?.commandItems??[]),this.createColumnPickerContainer(),io.call(this),this._columnCheckboxes=[],to.call(this,s),document.body.appendChild(this._menuElm),this.gridOptions.darkMode&&this._menuElm.classList.add("slick-dark-mode"),this._menuElm.style.opacity="0";const r=(void 0!==s?.marginBottom?s.marginBottom:this._defaults.marginBottom)||0;this._menuElm.style.minHeight=ae(s?.minHeight,""),void 0!==s?.height?this._menuElm.style.height=ae(s.height,""):this._menuElm.style.maxHeight=ae(s?.maxHeight,window.innerHeight-i.clientY-r+"px");let o="BUTTON"===e.target.nodeName?e.target:e.target.querySelector("button");o||(o=e.target.parentElement),this._menuElm.ariaExpanded="true",this._menuElm.appendChild(this._listElm),this.repositionMenu(e,this._menuElm,o,s),this._isMenuOpen=!0,this.pubSubService.publish("onGridMenuAfterMenuShow",n),"function"==typeof s?.onAfterMenuShow&&s.onAfterMenuShow(e,n),this.onAfterMenuShow.notify(n,null,this)}}translateGridMenu(){if(this.sharedService.gridOptions.gridMenu){this.sharedService.gridOptions.gridMenu.commandItems=[],this.sharedService.gridOptions.gridMenu.commandTitle="",this.sharedService.gridOptions.gridMenu.columnTitle="",this.sharedService.gridOptions.gridMenu.forceFitTitle="",this.sharedService.gridOptions.gridMenu.syncResizeTitle="";const e=this._userOriginalGridMenu&&Array.isArray(this._userOriginalGridMenu.commandItems)?this._userOriginalGridMenu.commandItems:[];this.sharedService.gridOptions.gridMenu.commandItems=[...e,...this.addGridMenuCustomCommands(e)],this.extensionUtility.translateMenuItemsFromTitleKey(this._addonOptions?.commandItems||[],"commandItems"),this.extensionUtility.sortItems(this.sharedService.gridOptions.gridMenu.commandItems,"positionOrder"),this.translateTitleLabels(this.sharedService.gridOptions.gridMenu),this.translateTitleLabels(this._addonOptions),this.extensionUtility.translateItems(this._columns,"nameKey","name")}}translateTitleLabels(e){e&&(e.commandTitle=this.extensionUtility.getPickerTitleOutputString("commandTitle","gridMenu"),e.columnTitle=this.extensionUtility.getPickerTitleOutputString("columnTitle","gridMenu"),e.forceFitTitle=this.extensionUtility.getPickerTitleOutputString("forceFitTitle","gridMenu"),e.syncResizeTitle=this.extensionUtility.getPickerTitleOutputString("syncResizeTitle","gridMenu"))}addGridMenuCustomCommands(e){const t=this.gridOptions.backendServiceApi||null,i=[],n=B(this.gridOptions),s=this._addonOptions?.commandLabels;if(this._addonOptions&&this.gridOptions){if(!this._addonOptions.hideClearFrozenColumnsCommand){const t="clear-pinning";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===t))||i.push({iconCssClass:this._addonOptions.iconClearFrozenColumnsCommand||"mdi mdi-pin-off-outline",titleKey:`${n}${s?.clearFrozenColumnsCommandKey??"CLEAR_PINNING"}`,disabled:!1,command:t,positionOrder:52})}if(this.gridOptions.enableFiltering&&!this.sharedService.hideHeaderRowAfterPageLoad){if(!this._addonOptions.hideClearAllFiltersCommand){const t="clear-filter";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===t))||i.push({iconCssClass:this._addonOptions.iconClearAllFiltersCommand||"mdi mdi-filter-remove-outline",titleKey:`${n}${s?.clearAllFiltersCommandKey??"CLEAR_ALL_FILTERS"}`,disabled:!1,command:t,positionOrder:50})}if(!this._addonOptions.hideToggleFilterCommand){const t="toggle-filter";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===t))||i.push({iconCssClass:this._addonOptions.iconToggleFilterCommand||"mdi mdi-flip-vertical",titleKey:`${n}${s?.toggleFilterCommandKey??"TOGGLE_FILTER_ROW"}`,disabled:!1,command:t,positionOrder:53})}if(t&&!this._addonOptions.hideRefreshDatasetCommand){const t="refresh-dataset";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===t))||i.push({iconCssClass:this._addonOptions.iconRefreshDatasetCommand||"mdi mdi-sync",titleKey:`${n}${s?.refreshDatasetCommandKey??"REFRESH_DATASET"}`,disabled:!1,command:t,positionOrder:58})}}if(!this._addonOptions.hideToggleDarkModeCommand){const t="toggle-dark-mode";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===t))||i.push({iconCssClass:this._addonOptions.iconToggleDarkModeCommand||"mdi mdi-brightness-4",titleKey:`${n}${s?.toggleDarkModeCommandKey??"TOGGLE_DARK_MODE"}`,disabled:!1,command:t,positionOrder:54})}if(this.gridOptions.showPreHeaderPanel&&!this._addonOptions.hideTogglePreHeaderCommand){const t="toggle-preheader";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===t))||i.push({iconCssClass:this._addonOptions.iconTogglePreHeaderCommand||"mdi mdi-flip-vertical",titleKey:`${n}${s?.togglePreHeaderCommandKey??"TOGGLE_PRE_HEADER_ROW"}`,disabled:!1,command:t,positionOrder:53})}if(this.gridOptions.enableSorting&&!this._addonOptions.hideClearAllSortingCommand){const t="clear-sorting";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===t))||i.push({iconCssClass:this._addonOptions.iconClearAllSortingCommand||"mdi mdi-sort-variant-off",titleKey:`${n}${s?.clearAllSortingCommandKey??"CLEAR_ALL_SORTING"}`,disabled:!1,command:t,positionOrder:51})}if(this.gridOptions.enableTextExport&&!this._addonOptions.hideExportCsvCommand){const t="export-csv";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===t))||i.push({iconCssClass:this._addonOptions.iconExportCsvCommand||"mdi mdi-download",titleKey:`${n}${s?.exportCsvCommandKey??"EXPORT_TO_CSV"}`,disabled:!1,command:t,positionOrder:55})}if(this.gridOptions.enableExcelExport&&!this._addonOptions.hideExportExcelCommand){const t="export-excel";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===t))||i.push({iconCssClass:this._addonOptions.iconExportExcelCommand||"mdi mdi-file-excel-outline text-success",titleKey:`${n}${s?.exportExcelCommandKey??"EXPORT_TO_EXCEL"}`,disabled:!1,command:t,positionOrder:56})}if(this.gridOptions.enableTextExport&&!this._addonOptions.hideExportTextDelimitedCommand){const t="export-text-delimited";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===t))||i.push({iconCssClass:this._addonOptions.iconExportTextDelimitedCommand||"mdi mdi-download",titleKey:`${n}${s?.exportTextDelimitedCommandKey??"EXPORT_TO_TAB_DELIMITED"}`,disabled:!1,command:t,positionOrder:57})}const r=this._addonOptions?.commandItems||[];(Array.isArray(i)&&i.length>0||Array.isArray(r)&&r.length>0)&&(this._addonOptions.commandTitle=this._addonOptions.commandTitle||this.extensionUtility.getPickerTitleOutputString("commandTitle","gridMenu"))}return i}executeGridMenuInternalCustomCommands(e,t){const i=this.sharedService?.externalRegisteredResources||[];if(t?.command)switch(t.command){case"clear-pinning":const e=[...this.sharedService.visibleColumns],t={frozenColumn:-1,frozenRow:-1,frozenBottom:!1,enableMouseWheelScrollHandler:!1};this.grid.setOptions(t),this.sharedService.gridOptions.frozenColumn=t.frozenColumn,this.sharedService.gridOptions.frozenRow=t.frozenRow,this.sharedService.gridOptions.frozenBottom=t.frozenBottom,this.sharedService.gridOptions.enableMouseWheelScrollHandler=t.enableMouseWheelScrollHandler,Array.isArray(e)&&this.grid.setColumns(e),this.gridOptions.enableAutoSizeColumns&&this.grid.autosizeColumns(),this.pubSubService.publish("onGridMenuClearAllPinning");break;case"clear-filter":this.filterService.clearFilters(),this.sharedService.dataView.refresh(),this.pubSubService.publish("onGridMenuClearAllFilters");break;case"clear-sorting":this.sortService.clearSorting(),this.sharedService.dataView.refresh(),this.pubSubService.publish("onGridMenuClearAllSorting");break;case"export-csv":const n=i.find((e=>"TextExportService"===e.className));n?.exportToFile?n.exportToFile({delimiter:v.comma,format:y.csv}):console.error("[Slickgrid-Universal] You must register the TextExportService to properly use Export to File in the Grid Menu. Example:: this.gridOptions = { enableTextExport: true, externalResources: [new TextExportService()] };");break;case"export-excel":const s=i.find((e=>"ExcelExportService"===e.className));s?.exportToExcel?s.exportToExcel():console.error("[Slickgrid-Universal] You must register the ExcelExportService to properly use Export to Excel in the Grid Menu. Example:: this.gridOptions = { enableExcelExport: true, externalResources: [new ExcelExportService()] };");break;case"export-text-delimited":const r=i.find((e=>"TextExportService"===e.className));r?.exportToFile?r.exportToFile({delimiter:v.tab,format:y.txt}):console.error("[Slickgrid-Universal] You must register the TextExportService to properly use Export to File in the Grid Menu. Example:: this.gridOptions = { enableTextExport: true, externalResources: [new TextExportService()] };");break;case"toggle-dark-mode":const o=this.sharedService.gridOptions.darkMode;this.grid.setOptions({darkMode:!o}),this.sharedService.gridOptions.darkMode=!o;break;case"toggle-filter":let a=this.gridOptions?.showHeaderRow??!1;a=!a,this.grid.setHeaderRowVisibility(a),!0===a&&(this.grid.setColumns(this.sharedService.columnDefinitions),this.grid.scrollColumnIntoView(0));break;case"toggle-preheader":const l=this.gridOptions?.showPreHeaderPanel??!1;this.grid.setPreHeaderPanelVisibility(!l);break;case"refresh-dataset":this.extensionUtility.refreshBackendDataset()}}getDefaultGridMenuOptions(){return{commandTitle:void 0,columnTitle:this.extensionUtility.getPickerTitleOutputString("columnTitle","gridMenu"),forceFitTitle:this.extensionUtility.getPickerTitleOutputString("forceFitTitle","gridMenu"),syncResizeTitle:this.extensionUtility.getPickerTitleOutputString("syncResizeTitle","gridMenu"),iconCssClass:"mdi mdi-menu",menuWidth:18,commandItems:[],hideClearAllFiltersCommand:!1,hideRefreshDatasetCommand:!1,hideToggleFilterCommand:!1}}handleBodyMouseDown(e){if(this.menuElement){let t=!1;const i=e.target.closest(`.${this.menuCssClass}`);(this.menuElement.contains(e.target)||i)&&(t=!0),(this._isMenuOpen&&this.menuElement!==e.target&&!t&&!e.defaultPrevented||"close"===e.target.className&&i)&&this.hideMenu(e)}}handleMenuItemCommandClick(e,t,i,n=0){if("divider"!==i&&!i.disabled&&!i.divider)if(i.command&&!i.commandItems){const t={grid:this.grid,command:i.command,item:i,allColumns:this.columns,visibleColumns:this.getVisibleColumns()};this.executeGridMenuInternalCustomCommands(e,t),this.pubSubService.publish("onGridMenuCommand",t),"function"==typeof this._addonOptions?.onCommand&&this._addonOptions.onCommand(e,t),this.onCommand.notify(t,null,this),"function"==typeof i.action&&i.action.call(this,e,t),this._addonOptions?.leaveOpen||e.defaultPrevented||this.hideMenu(e),e.preventDefault(),e.stopPropagation()}else i.commandItems&&this.repositionSubMenu(e,i,n)}handleMenuItemMouseOver(e,t,i,n=0){"divider"===i||i.disabled||i.divider||(i.commandItems?this.repositionSubMenu(e,i,n):0===n&&this.disposeSubMenus())}recreateCommandList(e,t,i,n){const s=i.level||0;if(e.length>0){const r=Z("div",{className:`${this._menuCssPrefix}-command-list`,role:"menu"},t);if(0===s){this.populateCommandOrOptionTitle("command",this.addonOptions,r,s);const e=t.querySelector(".slick-command-header")??Z("div",{className:"slick-command-header"});e.classList.add("with-close"),Xr.call(this,e),r.appendChild(e)}return n&&s>0&&this.addSubMenuTitleWhenExists(n,r),this.populateCommandOrOptionItems("command",this._addonOptions,r,e,i,this.handleMenuItemCommandClick,this.handleMenuItemMouseOver),r}return null}repositionSubMenu(e,t,i){const n=t?.commandItems||[],s=this.createCommandMenu(n,i+1,t);s.style.display="block",document.body.appendChild(s),this.repositionMenu(e,s)}}const Kr="mdi-icon-picker-check",Yr="mdi-icon-picker-uncheck";function Xr(e){const t=Z("button",{type:"button",className:"close",ariaLabel:"Close",textContent:"Ã",dataset:{dismiss:this instanceof no?"slick-column-picker":"slick-grid-menu"}});e.appendChild(t)}function Zr(e){const t=this;t.addonOptions?.columnTitle&&(t._columnTitleElm=Z("div",{className:"slick-menu-title",textContent:t.addonOptions?.columnTitle??t._defaults.columnTitle},e))}function Qr(e){const t=this,i=t instanceof no?"columnPicker":"gridMenu",n=e.target?.closest(".icon-checkbox-container"),s=n?.querySelector(".mdi"),r=!!e.target.checked;if(e.target.ariaChecked=String(r),Jr(s,r),"autoresize"===e.target.dataset.option){const e=t.getVisibleColumns();return t.grid.setOptions({forceFitColumns:r}),void t.grid.setColumns(e)}if("syncresize"!==e.target.dataset.option){if("checkbox"===e.target.type){t._areVisibleColumnDifferent=!0;const n=e.target.dataset.columnid||"",o=[];if(t._columnCheckboxes.forEach(((e,i)=>{e.checked&&o.push(t.columns[i])})),!o.length)return e.target.checked=!0,void Jr(s,!0);if(t.grid.setColumns(o),(!t.sharedService.visibleColumns||Array.isArray(o)&&o.length!==t.sharedService.visibleColumns.length)&&(t.sharedService.visibleColumns=o),t.gridOptions.enableRowSelection&&r){const e=t.grid.getSelectedRows();t.grid.setSelectedRows(e)}const a=t.gridOptions.frozenColumn??-1;a>=0&&t.extensionUtility.readjustFrozenColumnIndexWhenNeeded(a,t.columns,o);const l={columnId:n,showing:r,allColumns:t.columns,visibleColumns:o,columns:o,grid:t.grid};t.pubSubService.publish(`on${Be(i)}ColumnsChanged`,l),"function"==typeof t.addonOptions?.onColumnsChanged&&t.addonOptions.onColumnsChanged(e,l),t.onColumnsChanged.notify(l,null,t)}}else t.grid.setOptions({syncColumnCellResize:r})}function Jr(e,t=!1){e&&(e.className=`mdi ${t?Kr:Yr}`)}function eo(e,t,i,n=!1){const s=Z("label",{className:"checkbox-picker-label",htmlFor:t}),r=Z("div",{className:"icon-checkbox-container"}),o=Z("input",{id:t,type:"checkbox",dataset:i}),a=Z("div",{className:`mdi ${n?Kr:Yr}`}),l=Z("span",{className:"checkbox-label"});return r.appendChild(o),r.appendChild(a),s.appendChild(r),s.appendChild(l),e.appendChild(s),n&&(o.ariaChecked="true",o.checked=!0),{inputElm:o,labelElm:s,labelSpanElm:l}}function to(e){const t=this,i=t instanceof Gr?"gridmenu-":"";for(const n of t.columns){const s=n.id,r=document.createElement("li");n.excludeFromColumnPicker&&(r.className="hidden");const o=`${t._gridUid}-${i}colpicker-${s}`,a=t.grid.getColumnIndex(s)>=0,{inputElm:l,labelElm:c,labelSpanElm:h}=eo(r,o,{columnid:`${s}`},a);t._columnCheckboxes.push(l);const d=("function"==typeof e?.headerColumnValueExtractor?e.headerColumnValueExtractor:t._defaults.headerColumnValueExtractor)(n,t.gridOptions);this.grid.applyHtmlCode(h,d),r.appendChild(c),t._listElm.appendChild(r)}if(e.hideForceFitButton&&e.hideSyncResizeButton||t._listElm.appendChild(document.createElement("hr")),!e?.hideForceFitButton){const n=document.createElement("li"),s=`${t._gridUid}-${i}colpicker-forcefit`,{labelSpanElm:r}=eo(n,s,{option:"autoresize"},t.gridOptions.forceFitColumns);r.textContent=e?.forceFitTitle??"",t._listElm.appendChild(n)}if(!e?.hideSyncResizeButton){const n=document.createElement("li"),s=`${t._gridUid}-${i}colpicker-syncresize`,{labelSpanElm:r}=eo(n,s,{option:"syncresize"},t.gridOptions.forceFitColumns);r.textContent=e?.syncResizeTitle??"",t._listElm.appendChild(n)}}function io(){const e=this,t=e.grid.getColumns().slice(0),i=new Array(e.columns.length);for(let n=0;n<i.length;n++){const s=e.grid.getColumnIndex(e.columns[n].id);i[n]=void 0===s?e.columns[n]:t.shift()}e._columns=i}class no{constructor(e,t,i){this.extensionUtility=e,this.pubSubService=t,this.sharedService=i,this._areVisibleColumnDifferent=!1,this._columns=[],this._gridUid="",this._menuElm=null,this._columnCheckboxes=[],this._defaults={hideForceFitButton:!1,hideSyncResizeButton:!1,forceFitTitle:"Force fit columns",minHeight:150,syncResizeTitle:"Synchronous resize",headerColumnValueExtractor:e=>te(e.columnPickerLabel||e.name||"","innerHTML")},this._bindEventService=new Ft,this.onColumnsChanged=new gn("onColumnsChanged"),this._eventHandler=new vn,this._columns=this.sharedService.allColumns??[],this._gridUid=this.grid?.getUID?.()??"",this.init()}get addonOptions(){return this.gridOptions.columnPicker||{}}get eventHandler(){return this._eventHandler}get columns(){return this._columns}set columns(e){this._columns=e}get gridOptions(){return this.sharedService.gridOptions??{}}get grid(){return this.sharedService.slickGrid}get menuElement(){return this._menuElm}init(){this._gridUid=this.grid.getUID()??"",this.gridOptions.columnPicker={...this._defaults,...this.gridOptions.columnPicker},this.onColumnsChanged.setPubSubService(this.pubSubService),this.addonOptions.columnTitle=this.extensionUtility.getPickerTitleOutputString("columnTitle","columnPicker"),this.addonOptions.forceFitTitle=this.extensionUtility.getPickerTitleOutputString("forceFitTitle","columnPicker"),this.addonOptions.syncResizeTitle=this.extensionUtility.getPickerTitleOutputString("syncResizeTitle","columnPicker"),this._eventHandler.subscribe(this.grid.onPreHeaderContextMenu,(e=>{["slick-column-name","slick-header-column"].some((t=>e.target?.classList.contains(t)))&&this.handleHeaderContextMenu(e)})),this._eventHandler.subscribe(this.grid.onHeaderContextMenu,this.handleHeaderContextMenu.bind(this)),this._eventHandler.subscribe(this.grid.onColumnsReordered,io.bind(this)),this._eventHandler.subscribe(this.grid.onClick,this.disposeMenu.bind(this)),this._bindEventService.bind(document.body,"mousedown",this.handleBodyMouseDown.bind(this),void 0,"body"),this._bindEventService.bind(document.body,"beforeunload",this.dispose.bind(this),void 0,"body")}dispose(){this._eventHandler.unsubscribeAll(),this._bindEventService.unbindAll(),this.disposeMenu()}disposeMenu(){this._bindEventService.unbindAll("parent-menu"),this._listElm?.remove(),this._menuElm?.remove(),this._menuElm=null}createPickerMenu(){const e=Z("div",{ariaExpanded:"true",className:`slick-column-picker ${this._gridUid}`,role:"menu"});return io.call(this),Zr.call(this,e),Xr.call(this,e),this._listElm=Z("div",{className:"slick-column-picker-list",role:"menu"}),this._bindEventService.bind(e,"click",Qr.bind(this),void 0,"parent-menu"),document.body.appendChild(e),e}getAllColumns(){return this._columns}getVisibleColumns(){return this.grid.getColumns()}translateColumnPicker(){this.addonOptions&&(this.addonOptions.columnTitle="",this.addonOptions.forceFitTitle="",this.addonOptions.syncResizeTitle="",this.addonOptions.columnTitle=this.extensionUtility.getPickerTitleOutputString("columnTitle","columnPicker"),this.addonOptions.forceFitTitle=this.extensionUtility.getPickerTitleOutputString("forceFitTitle","columnPicker"),this.addonOptions.syncResizeTitle=this.extensionUtility.getPickerTitleOutputString("syncResizeTitle","columnPicker")),this.extensionUtility.translateItems(this._columns,"nameKey","name"),this.translateTitleLabels(this.addonOptions)}handleBodyMouseDown(e){(this._menuElm!==e.target&&!this._menuElm?.contains(e.target)||"close"===e.target.className&&e.target.closest(".slick-column-picker"))&&this.disposeMenu()}handleHeaderContextMenu(e){e.preventDefault(),ee(this._menuElm),this._columnCheckboxes=[],this._menuElm=this.createPickerMenu(),this.gridOptions.darkMode&&this._menuElm.classList.add("slick-dark-mode"),to.call(this,this.addonOptions),document.body.appendChild(this._menuElm),this.repositionMenu(e)}repositionMenu(e){const t=e?.touches?.[0]??e;if(this._menuElm){const e=this.grid.getGridPosition(),i=this._menuElm.clientWidth||0;let n=t.pageX||0;e?.width&&n+i>=e.width&&(n-=i),this._menuElm.style.top=t.pageY-10+"px",this._menuElm.style.left=`${n}px`,this._menuElm.style.minHeight=ae(this.addonOptions.minHeight,""),this._menuElm.style.maxHeight=ae(this.addonOptions.maxHeight,window.innerHeight-t.clientY+"px"),this._menuElm.style.display="block",this._menuElm.ariaExpanded="true",this._menuElm.appendChild(this._listElm)}}translateTitleLabels(e){e&&(e.columnTitle=this.extensionUtility.getPickerTitleOutputString("columnTitle","gridMenu"))}}const so=(e,t,i,n,s,r)=>{const o=n.params||{};if(!o.formatters||!Array.isArray(o.formatters))throw new Error('[Slickgrid-Universal] The multiple formatter requires the "formatters" to be provided as a column params.\n    For example: this.columnDefinitions = [{ id: title, field: title, formatter: Formatters.multiple, params: { formatters: [Formatters.lowercase, Formatters.uppercase] }');const a=o.formatters;let l=i;return a.forEach(((i,o)=>{if("function"!=typeof i)throw new Error(`[Slickgrid-Universal] the "params.formatters" at index(${o}) to be used by "Formatters.multiple" is invalid, please verify all formatter functions.`);l=i.call(void 0,e,t,l,n,s,r)})),l};function ro(e,t){if(Array.isArray(e))for(const i of e)if(i.editor)if(i.formatter&&i.formatter!==so&&i.formatter!==t){const e=i.formatter;i.formatter=so,i.params={...i.params,formatters:[e,t]}}else i.formatter&&i.formatter===so&&i.params?-1===i.params.formatters.findIndex((e=>e===t))&&(i.params.formatters=[...i.params.formatters,t]):i.formatter=t}function oo(e,t,i,n){let s,r,o="",a="";switch(i){case"currency":s=m.DEFAULT_FORMATTER_CURRENCY_MIN_DECIMAL,r=m.DEFAULT_FORMATTER_CURRENCY_MAX_DECIMAL;break;case"decimal":s=m.DEFAULT_FORMATTER_NUMBER_MIN_DECIMAL,r=m.DEFAULT_FORMATTER_NUMBER_MAX_DECIMAL;break;case"percent":s=m.DEFAULT_FORMATTER_PERCENT_MIN_DECIMAL,r=m.DEFAULT_FORMATTER_PERCENT_MAX_DECIMAL}const l=t&&"function"==typeof t.getOptions?t.getOptions():{},c=ao("minDecimal",e,l,s),h=ao("maxDecimal",e,l,r),d=ao("decimalSeparator",e,l,m.DEFAULT_NUMBER_DECIMAL_SEPARATOR),u=ao("thousandSeparator",e,l,m.DEFAULT_NUMBER_THOUSAND_SEPARATOR),p=ao("displayNegativeNumberWithParentheses",e,l,m.DEFAULT_NEGATIVE_NUMBER_WRAPPED_IN_BRAQUET),f=ao("currencyPrefix",e,l,""),g=ao("currencySuffix",e,l,"");return"cell"===n&&(o=ao("numberPrefix",e,l,""),a=ao("numberSuffix",e,l,"")),{minDecimal:c,maxDecimal:h,decimalSeparator:d,thousandSeparator:u,wrapNegativeNumber:p,currencyPrefix:f,currencySuffix:g,numberPrefix:o,numberSuffix:a}}function ao(e,t,i,n){const s=t&&t.params;return s&&s.hasOwnProperty(e)?s[e]:i?.formatterOptions?.hasOwnProperty(e)?i.formatterOptions[e]:n}function lo(e,t){const i=It(e,{withZeroPadding:!0});return(e,n,s,r,o,a)=>{const l=a&&"function"==typeof a.getOptions?a.getOptions():{},c=l?.formatterOptions?.dateSeparator??t,h=It(r?.type??b.date,{withDefaultIso8601:!0}),d=r?.params?.parseDateAsUtc??!1,u=Dt(s,h);let p=s;if(u){let e=u;d&&(e=xt(f=u,Ct(f,"utc"))),p=Tt(e,i,"en-US")}var f;if(p&&c!==t){const e=new RegExp(t,"ig");p=p.replace(e,c)}return p}}function co(e,t,i,n,s,r){let o="",a=n.field||n.id||"";if("string"==typeof n.field&&n.field.indexOf(".")>0){const e=n.field.split(".");a=e.length>0?e[0]:n.field}const l=s?.hasOwnProperty(a)?s[a]:null;if("function"==typeof e){const a=e(t,i,l,n,s,r);o=te(Le(a)?a:a.html||a.text)}else o=s?.hasOwnProperty(a)?l:"";return null==o&&(o=""),"object"!=typeof o||o instanceof Date||0!==Object.entries(o).length||(o=""),o}class ho extends Fr{constructor(e,t,i,n){super(e,t,i),this.extensionUtility=e,this.pubSubService=t,this.sharedService=i,this.treeDataService=n,this._defaults={autoAdjustDrop:!0,autoAlignSide:!0,autoAdjustDropOffset:0,autoAlignSideOffset:0,hideMenuOnScroll:!1,optionShownOverColumnIds:[],commandShownOverColumnIds:[],subMenuOpenByEvent:"mouseover"},this.pluginName="ContextMenu",this._camelPluginName="contextMenu",this._menuCssPrefix="slick-menu",this._menuPluginCssPrefix="slick-context-menu",this.init(i.gridOptions.contextMenu)}init(e){this._addonOptions={...this._defaults,...e};const t=this._addonOptions&&Array.isArray(this._addonOptions.commandItems)?this._addonOptions.commandItems:[];this._addonOptions.commandItems=[...t,...this.addMenuCustomCommands(t)],this._addonOptions={...this._addonOptions},this.sharedService.gridOptions.contextMenu=this._addonOptions,this.sortMenuItems(),this._eventHandler.subscribe(this.grid.onContextMenu,this.handleOnContextMenu.bind(this)),this._eventHandler.subscribe(this.grid.onClick,this.hideMenu.bind(this)),this._addonOptions.hideMenuOnScroll&&this._eventHandler.subscribe(this.grid.onScroll,this.closeMenu.bind(this))}translateContextMenu(){const e=this.sharedService?.gridOptions??{},t=this.sharedService.gridOptions.contextMenu;if(t&&e?.enableTranslate){const e=t.commandItems||[],i=t.optionItems||[];t.commandTitleKey&&(t.commandTitle=this.extensionUtility.translateWhenEnabledAndServiceExist(t.commandTitleKey,"TEXT_COMMANDS")||t.commandTitle),t.optionTitleKey&&(t.optionTitle=this.extensionUtility.translateWhenEnabledAndServiceExist(t.optionTitleKey,"TEXT_COMMANDS")||t.optionTitle),this.extensionUtility.translateMenuItemsFromTitleKey(e,"commandItems"),this.extensionUtility.translateMenuItemsFromTitleKey(i,"optionItems")}}handleOnContextMenu(e,t){this.disposeAllMenus();const i=this.grid.getCellFromEvent(e);if(i){const n=this.grid.getDataItem(i.row),s=this.grid.getColumns()[i.cell],r=t||{};if(r.cell=i.cell,r.row=i.row,r.column=s,r.dataContext=n,r.grid=this.grid,!this.extensionUtility.runOverrideFunctionWhenExists(this._addonOptions.menuUsabilityOverride,r))return;this._menuElm=this.createParentMenu(e),this._menuElm&&e.preventDefault(),this._menuElm&&this.gridOptions.darkMode&&this._menuElm.classList.add("slick-dark-mode"),this._menuElm&&(this.repositionMenu(e,this._menuElm),this._menuElm.ariaExpanded="true",this._menuElm.style.display="block"),this._bindEventService.bind(document.body,"mousedown",this.handleBodyMouseDown.bind(this))}}addMenuCustomCommands(e){const t=[],i=this.sharedService&&this.sharedService.gridOptions||{},n=i?.contextMenu,s=this.sharedService?.dataView,r=B(i);if(n&&!n.hideCopyCellValueCommand){const i="copy";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===i))||t.push({iconCssClass:n.iconCopyCellValueCommand||"mdi mdi-content-copy",titleKey:`${r}COPY`,disabled:!1,command:i,positionOrder:50,action:(e,t)=>{this.copyToClipboard(t)},itemUsabilityOverride:e=>{const t=e?.column,i=e?.dataContext;if("function"==typeof t.queryFieldNameGetterFn){const e=F(t,i,"");if(""!==e&&void 0!==e)return!0}else if(t&&i.hasOwnProperty(t.field))return""!==i[t.field]&&null!==i[t.field]&&void 0!==i[t.field];return!1}})}if(i?.enableTextExport&&n&&!n.hideExportCsvCommand){const i="export-csv";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===i))||t.push({iconCssClass:n.iconExportCsvCommand||"mdi mdi-download",titleKey:`${r}EXPORT_TO_CSV`,disabled:!1,command:i,positionOrder:51,action:()=>{const e=(this.sharedService?.externalRegisteredResources||[]).find((e=>"TextExportService"===e.className));if(!e?.exportToFile)throw new Error("[Slickgrid-Universal] You must register the TextExportService to properly use Export to File in the Context Menu. Example:: this.gridOptions = { enableTextExport: true, externalResources: [new TextExportService()] };");e.exportToFile({delimiter:v.comma,format:y.csv})}})}if(i&&i.enableExcelExport&&n&&!n.hideExportExcelCommand){const i="export-excel";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===i))||t.push({iconCssClass:n.iconExportExcelCommand||"mdi mdi-file-excel-outline text-success",titleKey:`${r}EXPORT_TO_EXCEL`,disabled:!1,command:i,positionOrder:52,action:()=>{const e=(this.sharedService?.externalRegisteredResources||[]).find((e=>"ExcelExportService"===e.className));if(!e?.exportToExcel)throw new Error("[Slickgrid-Universal] You must register the ExcelExportService to properly use Export to Excel in the Context Menu. Example:: this.gridOptions = { enableExcelExport: true, externalResources: [new ExcelExportService()] };");e.exportToExcel()}})}if(i?.enableTextExport&&n&&!n.hideExportTextDelimitedCommand){const i="export-text-delimited";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===i))||t.push({iconCssClass:n.iconExportTextDelimitedCommand||"mdi mdi-download",titleKey:`${r}EXPORT_TO_TAB_DELIMITED`,disabled:!1,command:i,positionOrder:53,action:()=>{const e=(this.sharedService?.externalRegisteredResources||[]).find((e=>"TextExportService"===e.className));if(!e?.exportToFile)throw new Error("[Slickgrid-Universal] You must register the TextExportService to properly use Export to File in the Context Menu. Example:: this.gridOptions = { enableTextExport: true, externalResources: [new TextExportService()] };");e.exportToFile({delimiter:v.tab,format:y.txt})}})}if(i&&(i.enableGrouping||i.enableDraggableGrouping||i.enableTreeData)){if(n&&!n.hideCopyCellValueCommand&&t.push({divider:!0,command:"",positionOrder:54}),i&&!i.enableTreeData&&n&&!n.hideClearAllGrouping){const i="clear-grouping";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===i))||t.push({iconCssClass:n.iconClearGroupingCommand||"mdi mdi-close",titleKey:`${r}CLEAR_ALL_GROUPING`,disabled:!1,command:i,positionOrder:55,action:()=>{s.setGrouping([]),this.pubSubService.publish("onContextMenuClearGrouping")},itemUsabilityOverride:()=>{const e=s&&s.getGrouping&&s.getGrouping();return Array.isArray(e)&&e.length>0}})}if(i&&n&&!n.hideCollapseAllGroups){const o="collapse-all-groups";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===o))||t.push({iconCssClass:n.iconCollapseAllGroupsCommand||"mdi mdi-arrow-collapse",titleKey:`${r}COLLAPSE_ALL_GROUPS`,disabled:!1,command:o,positionOrder:56,action:()=>{i.enableTreeData?this.treeDataService.toggleTreeDataCollapse(!0):s.collapseAllGroups(),this.pubSubService.publish("onContextMenuCollapseAllGroups")},itemUsabilityOverride:()=>{if(i.enableTreeData)return!0;const e=s&&s.getGrouping&&s.getGrouping();return Array.isArray(e)&&e.length>0}})}if(i&&n&&!n.hideExpandAllGroups){const o="expand-all-groups";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===o))||t.push({iconCssClass:n.iconExpandAllGroupsCommand||"mdi mdi-arrow-expand",titleKey:`${r}EXPAND_ALL_GROUPS`,disabled:!1,command:o,positionOrder:57,action:()=>{i.enableTreeData?this.treeDataService.toggleTreeDataCollapse(!1):s.expandAllGroups(),this.pubSubService.publish("onContextMenuExpandAllGroups")},itemUsabilityOverride:()=>{if(i.enableTreeData)return!0;const e=s&&s.getGrouping&&s.getGrouping();return Array.isArray(e)&&e.length>0}})}}return this.extensionUtility.translateMenuItemsFromTitleKey(t),t}copyToClipboard(e){try{if(e&&e.grid&&e.command){const t=this.sharedService?.gridOptions??{},i=e?.cell??0,n=e?.row??0,s=e?.column,r=e?.dataContext,o=this.sharedService?.slickGrid;let a=function(e,t,i,n,s,r){let o,a=!1;i?.hasOwnProperty("exportWithFormatter")?a=!!i.exportWithFormatter:r?.hasOwnProperty("exportWithFormatter")&&(a=!!r.exportWithFormatter),n&&i.exportCustomFormatter?o=i.exportCustomFormatter:a&&i.formatter&&(o=i.formatter);const l=co(o,e,t,i,n,s);return r?.sanitizeDataExport&&"string"==typeof l?Qe(l):l}(n,i,s,r,o,t&&(t.excelExportOptions||t.textExportOptions));"function"==typeof s.queryFieldNameGetterFn&&(a=F(s,r,""));let l=a;"string"==typeof a&&(l=a.replace(/^([Â·|â®|â®]\s*)|([Â·|â®|â®])\s*/gi,"").replace(/[\u00b7|\u034f]/gi,"").trim());const c=document.createElement("textarea");c&&document.body&&(c.style.position="absolute",c.style.opacity="0",c.value=l,document.body.appendChild(c),c.select(),document.execCommand("copy",!1,l)&&c.remove())}}catch(e){}}sortMenuItems(){const e=this.sharedService?.gridOptions?.contextMenu;e&&(this.extensionUtility.sortItems(e.commandItems||[],"positionOrder"),this.extensionUtility.sortItems(e.optionItems||[],"positionOrder"))}}class uo{constructor(e,t,i){this.extensionUtility=e,this.pubSubService=t,this.sharedService=i,this.columnsGroupBy=[],this.pluginName="DraggableGrouping",this._gridColumns=[],this._gridUid="",this._reorderedColumns=[],this._subscriptions=[],this._defaults={dropPlaceHolderText:"Drop a column header here to group by the column",hideGroupSortIcons:!1,hideToggleAllButton:!1,toggleAllButtonText:"",toggleAllPlaceholderText:"Toggle all Groups"},this._bindingEventService=new Ft,this.onGroupChanged=new gn("onGroupChanged"),this._eventHandler=new vn}get addonOptions(){return this._addonOptions}get dataView(){return this.grid?.getData()??{}}get dropboxElement(){return this._dropzoneElm}get droppableInstance(){return this._droppableInstance}get sortableLeftInstance(){return this._sortableLeftInstance}get sortableRightInstance(){return this._sortableRightInstance}get eventHandler(){return this._eventHandler}get grid(){return this._grid??this.sharedService.slickGrid??{}}get gridOptions(){return this.sharedService.gridOptions??{}}get gridUid(){return this._gridUid||(this.grid?.getUID()??"")}get gridContainer(){return this.grid.getContainerNode()}init(e,t){if(this._addonOptions={...this._defaults,...t},this._grid=e,e){if(this._gridUid=e.getUID(),this._gridColumns=e.getColumns(),this._dropzoneElm=e.getTopHeaderPanel()||e.getPreHeaderPanel(),this._dropzoneElm.classList.add("slick-dropzone"),this.onGroupChanged.setPubSubService(this.pubSubService),!this._addonOptions.hideToggleAllButton){this._groupToggler=Z("div",{className:"slick-group-toggle-all",title:this._addonOptions.toggleAllPlaceholderText??"",style:{display:"none"}});const e=Z("span",{className:"slick-group-toggle-all-icon"},this._groupToggler);this.gridOptions.enableTranslate&&this._addonOptions.toggleAllButtonTextKey&&(this._addonOptions.toggleAllButtonText=this.extensionUtility.translateWhenEnabledAndServiceExist(this._addonOptions.toggleAllButtonTextKey,"TEXT_TOGGLE_ALL_GROUPS")),this.gridOptions.enableTranslate&&this._addonOptions.toggleAllPlaceholderTextKey&&(this._addonOptions.toggleAllPlaceholderText=this.extensionUtility.translateWhenEnabledAndServiceExist(this._addonOptions.toggleAllPlaceholderTextKey,"TEXT_TOGGLE_ALL_GROUPS")),this._groupToggler.title=this._addonOptions.toggleAllPlaceholderText??"",this._addonOptions.toggleAllButtonText&&this._groupToggler.appendChild(Z("span",{className:"slick-group-toggle-all-text",textContent:this._addonOptions.toggleAllButtonText||""})),this._dropzoneElm.appendChild(this._groupToggler),this._subscriptions.push(this.pubSubService.subscribe("onContextMenuCollapseAllGroups",(()=>this.toggleGroupToggler(e,!0,!1))),this.pubSubService.subscribe("onContextMenuExpandAllGroups",(()=>this.toggleGroupToggler(e,!1,!1))))}this._dropzonePlaceholderElm=Z("div",{className:"slick-draggable-dropzone-placeholder"},this._dropzoneElm),this.gridOptions.enableTranslate&&this._addonOptions?.dropPlaceHolderTextKey&&(this._addonOptions.dropPlaceHolderText=this.extensionUtility.translateWhenEnabledAndServiceExist(this._addonOptions.dropPlaceHolderTextKey,"TEXT_TOGGLE_ALL_GROUPS")),this._dropzonePlaceholderElm.textContent=this._addonOptions?.dropPlaceHolderText??this._defaults.dropPlaceHolderText??"",this.setupColumnDropbox(),this._eventHandler.subscribe(e.onHeaderCellRendered,((e,t)=>{const i=t.node;if(!Ie(t.column?.grouping)&&i&&(i.style.cursor="pointer",this._addonOptions.groupIconCssClass)){const e=Z("span",{className:"slick-column-groupable"},i);this._addonOptions.groupIconCssClass&&e.classList.add(...Q(this._addonOptions.groupIconCssClass))}})),this._subscriptions.push(this.pubSubService.subscribe("onContextMenuClearGrouping",(()=>this.clearDroppedGroups())));for(const t of this._gridColumns){const i=t.field;e.updateColumnHeader(i)}}return this}dispose(){this.destroySortableInstances(),this._droppableInstance?.el&&this._droppableInstance?.destroy(),this.onGroupChanged.unsubscribe(),this._eventHandler.unsubscribeAll(),this.pubSubService.unsubscribeAll(this._subscriptions),this._bindingEventService.unbindAll(),ee(this.gridContainer.querySelector(`.${this.gridUid} .slick-preheader-panel,.${this.gridUid} .slick-topheader-panel`))}clearDroppedGroups(){this.columnsGroupBy=[],this.updateGroupBy("clear-all");const e=this._dropzoneElm.querySelectorAll(".slick-dropped-grouping");for(const t of Array.from(e)){const e=this._dropzoneElm.querySelector(".slick-groupby-remove");e?.remove(),t?.remove()}this._dropzonePlaceholderElm.style.display="inline-block",this._groupToggler&&(this._groupToggler.style.display="none")}destroySortableInstances(){this._sortableLeftInstance?.el&&this._sortableLeftInstance?.destroy(),this._sortableRightInstance?.el&&this._sortableRightInstance?.destroy()}setAddonOptions(e){this._addonOptions={...this._addonOptions,...e}}setColumns(e){this._gridColumns=e}setDroppedGroups(e){this._dropzonePlaceholderElm.style.display="none";const t=Array.isArray(e)?e:[e];for(const e of t){const t=this.grid.getHeaderColumn(e);this.handleGroupByDrop(this._dropzoneElm,t)}}setupColumnReorder(e,t,i,n,s,r,o,a,l){this.destroySortableInstances();const c=e.getTopHeaderPanel()||e.getPreHeaderPanel(),h=c.querySelector(".slick-draggable-dropzone-placeholder"),d=c.querySelector(".slick-group-toggle-all"),u={animation:50,chosenClass:"slick-header-column-active",ghostClass:"slick-sortable-placeholder",draggable:".slick-header-column",dataIdAttr:"data-id",group:{name:"shared",pull:"clone",put:!1},revertClone:!0,onStart:()=>{h&&(h.style.display="inline-block"),c.querySelectorAll(".slick-dropped-grouping").forEach((e=>e.style.display="none")),d&&(d.style.display="none")},onEnd:i=>{c?.classList.remove("slick-dropzone-hover"),h?.parentElement?.classList.remove("slick-dropzone-placeholder-hover");const r=c.querySelectorAll(".slick-dropped-grouping");if(r.forEach((e=>e.style.display="flex")),r.length&&(h&&(h.style.display="none"),d&&(d.style.display="inline-flex")),!e.getEditorLock().commitCurrentEdit())return;const a=this.sortableLeftInstance?.toArray()??[];if(t.length>1){const e=this._sortableRightInstance?.toArray()??[];for(const t of e)a.push(t)}const u=[],p=e.getColumns();for(const t of a)u.push(p[o.call(e,t)]);n.call(e,u),l.call(e,e.onColumnsReordered,{grid:e,impactedColumns:u}),i.stopPropagation(),s.call(e)}};return this._sortableLeftInstance=Ar.create(this.gridContainer.querySelector(`.${e.getUID()} .slick-header-columns.slick-header-columns-left`),u),this._sortableRightInstance=Ar.create(this.gridContainer.querySelector(`.${e.getUID()} .slick-header-columns.slick-header-columns-right`),u),{sortableLeftInstance:this._sortableLeftInstance,sortableRightInstance:this._sortableRightInstance}}addColumnGroupBy(e){this.columnsGroupBy.push(e),this.updateGroupBy("add-group")}addGroupByRemoveClickHandler(e,t,i,n){this._bindingEventService.bind(t,"click",(()=>{const s=this._bindingEventService.boundedEvents.filter((e=>e.element===t));for(const e of s)this._bindingEventService.unbind(e.element,"click",e.listener);this.removeGroupBy(e,i,n)}))}addGroupSortClickHandler(e,t){const{grouping:i,type:n}=e;this._bindingEventService.bind(t,"click",(()=>{if(this.toggleGroupAll(e,!1),i){const s=i.sortAsc?x.desc:x.asc;i.comparer=(t,i)=>Lt(n||"text",t.value,i.value,s,e,this.gridOptions),this.getGroupBySortIcon(t,!i.sortAsc),this.updateGroupBy("sort-group"),i.sortAsc=!i.sortAsc,this.grid.invalidate()}}))}getGroupBySortIcon(e,t=!0){t?this._addonOptions.sortAscIconCssClass?(e.classList.remove(...Q(this._addonOptions.sortDescIconCssClass)),e.classList.add(...Q(this._addonOptions.sortAscIconCssClass))):(e.classList.add("slick-groupby-sort-asc-icon"),e.classList.remove("slick-groupby-sort-desc-icon")):this._addonOptions.sortDescIconCssClass?(e.classList.remove(...Q(this._addonOptions.sortAscIconCssClass)),e.classList.add(...Q(this._addonOptions.sortDescIconCssClass))):this._addonOptions.sortDescIconCssClass||(e.classList.add("slick-groupby-sort-desc-icon"),e.classList.remove("slick-groupby-sort-asc-icon"))}handleGroupByDrop(e,t){const i=t.getAttribute("data-id")?.replace(this._gridUid,"");let n=!0;for(const e of this.columnsGroupBy)e.id===i&&(n=!1);if(n){for(const n of this._gridColumns)if(n.id===i&&n.grouping&&!Ie(n.grouping)){const i=t.querySelector(".slick-column-name"),s=Z("div",{id:`${this._gridUid}_${n.id}_entry`,className:"slick-dropped-grouping",dataset:{id:`${n.id}`}});Z("div",{className:"slick-dropped-grouping-title",style:{display:"inline-flex"},textContent:i?i.textContent:t.textContent},s);const r=Z("div",{className:"slick-groupby-remove"});let o;this._addonOptions.deleteIconCssClass&&r.classList.add(...Q(this._addonOptions.deleteIconCssClass)),this._addonOptions.deleteIconCssClass||r.classList.add("slick-groupby-remove-icon"),!0!==this._addonOptions?.hideGroupSortIcons&&n.sortable&&(void 0===n.grouping?.sortAsc&&(n.grouping.sortAsc=!0),o=Z("div",{className:"slick-groupby-sort"},s),this.getGroupBySortIcon(o,n.grouping.sortAsc)),s.appendChild(r),s.appendChild(document.createElement("div")),e.appendChild(s),this._groupToggler&&0===this.columnsGroupBy.length&&this.toggleGroupAll(n),this.addColumnGroupBy(n),this.addGroupByRemoveClickHandler(n.id,r,t,s),o&&this.addGroupSortClickHandler(n,o)}this._groupToggler&&this.columnsGroupBy.length>0&&(this._groupToggler.style.display="inline-flex")}}toggleGroupAll({grouping:e},t){const i=this._groupToggler?.querySelector(".slick-group-toggle-all-icon");!0===t||e?.collapsed?(i?.classList.add("collapsed"),i?.classList.remove("expanded")):(i?.classList.add("expanded"),i?.classList.remove("collapsed"))}removeFromArray(e,t){if(Array.isArray(e)){const i=e.findIndex((e=>e.id===t.id));i>=0&&e.splice(i,1)}return e}removeGroupBy(e,t,i){i.remove();const n=[];this._gridColumns.forEach((e=>n[e.id]=e)),this.removeFromArray(this.columnsGroupBy,n[e]),0===this.columnsGroupBy.length&&(this._dropzonePlaceholderElm.style.display="inline-block",this._groupToggler&&(this._groupToggler.style.display="none")),this.updateGroupBy("remove-group")}addDragOverDropzoneListeners(){const e=this._dropzoneElm.querySelector(".slick-draggable-dropzone-placeholder");e&&this._dropzoneElm&&(this._bindingEventService.bind(e,"dragover",(e=>e.preventDefault())),this._bindingEventService.bind(e,"dragenter",(()=>this._dropzoneElm.classList.add("slick-dropzone-hover"))),this._bindingEventService.bind(e,"dragleave",(()=>this._dropzoneElm.classList.remove("slick-dropzone-hover"))))}setupColumnDropbox(){const e=this._dropzoneElm;this._droppableInstance=Ar.create(e,{group:"shared",ghostClass:"slick-droppable-sortitem-hover",draggable:".slick-dropped-grouping",dragoverBubble:!0,onAdd:t=>{const i=t.item;i.getAttribute("id")?.replace(this._gridUid,"")&&this.handleGroupByDrop(e,Ar.utils.clone(t.item)),i.parentNode?.removeChild(i)},onUpdate:()=>{const e=this._droppableInstance?.toArray()??[],t=[];for(const i of e)for(const e of this.columnsGroupBy)if(e.id===i){t.push(e);break}this.columnsGroupBy=t,this.updateGroupBy("sort-group")}}),this.addDragOverDropzoneListeners(),this._groupToggler&&this._bindingEventService.bind(this._groupToggler,"click",(e=>{const t=e.target.classList.contains("slick-group-toggle-all-icon")?e.target:e.currentTarget.querySelector(".slick-group-toggle-all-icon");this.toggleGroupToggler(t,t?.classList.contains("expanded"))}))}toggleGroupToggler(e,t=!0,i=!0){e&&(!0===t?(e.classList.add("collapsed"),e.classList.remove("expanded"),i&&this.dataView.collapseAllGroups()):(e.classList.remove("collapsed"),e.classList.add("expanded"),i&&this.dataView.expandAllGroups()))}updateGroupBy(e){if(0===this.columnsGroupBy.length)return this.dataView.setGrouping([]),this._dropzonePlaceholderElm.style.display="inline-block",void this.triggerOnGroupChangedEvent({caller:e,groupColumns:[]});const t=[];this.columnsGroupBy.forEach((e=>t.push(e.grouping))),this.dataView.setGrouping(t),this._dropzonePlaceholderElm.style.display="none",this.triggerOnGroupChangedEvent({caller:e,groupColumns:t})}triggerOnGroupChangedEvent(e){this._addonOptions&&"function"==typeof this._addonOptions.onGroupChanged&&this._addonOptions.onGroupChanged(new mn,e),this.onGroupChanged.notify(e)}}class po extends Nr{constructor(e,t,i){super(e,t,i),this.extensionUtility=e,this.pubSubService=t,this.sharedService=i,this._buttonElms=[],this._defaults={buttonCssClass:"slick-header-button"},this.pluginName="HeaderButtons",this._menuCssPrefix="slick-header-button",this._camelPluginName="headerButtons",this._bindEventService=new Ft,this._eventHandler=new vn,this.init(i.gridOptions.headerButton)}get addonOptions(){return this._addonOptions}set addonOptions(e){this._addonOptions=e}get eventHandler(){return this._eventHandler}get grid(){return this.sharedService.slickGrid}init(e){this._addonOptions={...this._defaults,...e},this._eventHandler.subscribe(this.grid.onHeaderCellRendered,this.handleHeaderCellRendered.bind(this)),this._eventHandler.subscribe(this.grid.onBeforeHeaderCellDestroy,this.handleBeforeHeaderCellDestroy.bind(this)),this.grid.setColumns(this.grid.getColumns())}dispose(){super.dispose(),this._buttonElms.forEach((e=>e.remove()))}handleHeaderCellRendered(e,t){const i=t.column;if(i.header?.buttons&&Array.isArray(i.header.buttons)){let e=i.header.buttons.length;for(;e--;){const n=i.header.buttons[e],s=this.populateSingleCommandOrOptionItem("command",this.addonOptions,null,n,t,this.handleButtonClick.bind(this));s&&n.handler&&!n.disabled&&this._bindEventService.bind(s,"click",(e=>n.handler.call(this,e))),s&&(this._buttonElms.push(s),t.node.appendChild(s))}}}handleBeforeHeaderCellDestroy(e,t){const i=t.column;if(i.header?.buttons&&this._addonOptions?.buttonCssClass){const e=(this._addonOptions?.buttonCssClass||"").replace(/(\s+)/g,".");e&&t.node.querySelectorAll(`.${e}`).forEach((e=>e.remove()))}}handleButtonClick(e,t,i,n,s){if(i.command&&!i.disabled){const t=i.command||"",n={grid:this.grid,column:s,button:i};t&&(n.command=t),"function"!=typeof i.action||i.disabled||i.action.call(this,e,n),null!==t&&!i.disabled&&this._addonOptions?.onCommand&&(this.pubSubService.publish("onHeaderButtonCommand",n),this._addonOptions.onCommand(e,n),s?.id&&this.grid.updateColumnHeader(s.id))}e.preventDefault(),e.stopPropagation()}}class fo extends Nr{constructor(e,t,i,n,s){super(e,i,n),this.extensionUtility=e,this.filterService=t,this.pubSubService=i,this.sharedService=n,this.sortService=s,this._subMenuParentId="",this._defaults={autoAlign:!0,autoAlignOffset:0,buttonCssClass:null,buttonImage:null,minWidth:100,hideColumnHideCommand:!1,hideSortCommands:!1,title:"",subMenuOpenByEvent:"mouseover"},this.pluginName="HeaderMenu",this._menuCssPrefix="slick-menu",this._menuPluginCssPrefix="slick-header-menu",this._camelPluginName="headerMenu",this.sharedService.gridOptions.headerMenu=this.addHeaderMenuCustomCommands(this.sharedService.columnDefinitions),this.init(n.gridOptions.headerMenu)}init(e){this._addonOptions={...this._defaults,...e},this._eventHandler.subscribe(this.grid.onBeforeSetColumns,((e,t)=>{this.sharedService.gridOptions.headerMenu=this.addHeaderMenuCustomCommands(t.newColumns)})),this._eventHandler.subscribe(this.grid.onHeaderCellRendered,this.handleHeaderCellRendered.bind(this)),this._eventHandler.subscribe(this.grid.onBeforeHeaderCellDestroy,this.handleBeforeHeaderCellDestroy.bind(this)),this._eventHandler.subscribe(this.grid.onClick,this.hideMenu.bind(this)),this.grid.setColumns(this.grid.getColumns()),this._bindEventService.bind(document.body,"mousedown",this.handleBodyMouseDown.bind(this))}dispose(){super.dispose(),this._menuElm=this._menuElm||document.body.querySelector(`.slick-header-menu${this.gridUidSelector}`),this._menuElm?.remove(),this._activeHeaderColumnElm=void 0}hideColumn(e){if(this.sharedService?.slickGrid?.getColumnIndex){const t=this.sharedService.slickGrid.getColumnIndex(e.id),i=this.sharedService.slickGrid.getColumns(),n=this.sharedService.gridOptions.frozenColumn??-1;n>=0&&n>=t&&(this.sharedService.gridOptions.frozenColumn=n-1,this.sharedService.slickGrid.setOptions({frozenColumn:this.sharedService.gridOptions.frozenColumn}));const s=Ee(i,t);this.sharedService.visibleColumns=s,this.sharedService.slickGrid.setColumns(s),this.pubSubService.publish("onHeaderMenuHideColumns",{columns:s,hiddenColumn:e})}}hideMenu(){this.disposeSubMenus(),this._menuElm?.remove(),this._menuElm=void 0}repositionSubMenu(e,t,i,n){const s=this.createCommandMenu(t.commandItems||[],n,i+1,t);document.body.appendChild(s),this.repositionMenu(e,s)}repositionMenu(e,t){const i=e.target,n=t.classList.contains("slick-submenu"),s=n?e.target.closest(".slick-menu-item"):i,r=ie(this.sharedService.gridContainerElement,i),o=this.grid.getGridPosition(),a=t.offsetWidth,l=ne(s);let c=n?l.left:r?.left??0,h=n?l.top:(r?.top??0)+(this.addonOptions?.menuOffsetTop??0)+i.clientHeight;if(n){const e=t?.clientHeight||0,{bottom:i,top:n}=X(s);"top"==(i<e&&n>i?"top":"bottom")?(t.classList.remove("dropdown"),t.classList.add("dropup"),h-=e-s.clientHeight):(t.classList.remove("dropup"),t.classList.add("dropdown"))}if(n&&s){const e=c+Number(a)+s.clientWidth,i=document.documentElement.clientWidth;"left"==(e>=o.width||e>=i?"left":"right")?(t.classList.remove("dropright"),t.classList.add("dropleft"),c-=a):(t.classList.remove("dropleft"),t.classList.add("dropright"),c+=s.offsetWidth)}else c=r?.left??0,this.addonOptions.autoAlign&&o?.width&&c+(t.clientWidth??0)>=o.width&&(c=c+i.clientWidth-t.clientWidth+(this.addonOptions?.autoAlignOffset||0));t.style.top=`${h}px`,t.style.left=`${c}px`}translateHeaderMenu(){this.sharedService.gridOptions?.headerMenu&&this.resetHeaderMenuTranslations(this.sharedService.visibleColumns)}handleHeaderCellRendered(e,t){const i=t.column,n=i.header?.menu;if(n&&t.node){if(!this.extensionUtility.runOverrideFunctionWhenExists(this.addonOptions.menuUsabilityOverride,t))return;const e=Z("div",{className:"slick-header-menu-button",ariaLabel:"Header Menu"},t.node);this.addonOptions.buttonCssClass&&e.classList.add(...Q(this.addonOptions.buttonCssClass)),this.addonOptions.tooltip&&(e.title=this.addonOptions.tooltip),this._bindEventService.bind(e,"click",(e=>{this.disposeAllMenus(),this.createParentMenu(e,t.column,n)}))}}handleBeforeHeaderCellDestroy(e,t){const i=t.column;i.header?.menu&&t.node.querySelectorAll(".slick-header-menu-button").forEach((e=>e.remove()))}handleBodyMouseDown(e){if(this.menuElement){let t=!1;const i=e.target.closest(`.${this.menuCssClass}`);(this.menuElement.contains(e.target)||i)&&(t=!0),(this._menuElm!==e.target&&!t&&!e.defaultPrevented||"close"===e.target.className&&i)&&this.hideMenu()}}handleMenuItemCommandClick(e,t,i,n=0,s){if("divider"!==i&&!i.disabled&&!i.divider)if(i.command&&!i.commandItems){const t={grid:this.grid,command:i.command,column:s,item:i};this.executeHeaderMenuInternalCommands(e,t),this.pubSubService.publish("onHeaderMenuCommand",t),"function"==typeof this.addonOptions?.onCommand&&this.addonOptions.onCommand(e,t),"function"==typeof i.action&&i.action.call(this,e,t),e.defaultPrevented||this.hideMenu(),e.preventDefault(),e.stopPropagation()}else i.commandItems&&this.repositionSubMenu(e,i,n,s)}handleMenuItemMouseOver(e,t,i,n=0,s){"divider"===i||i.disabled||i.divider||(i.commandItems?this.repositionSubMenu(e,i,n,s):0===n&&this.disposeSubMenus())}addHeaderMenuCustomCommands(e){const t=this.sharedService.gridOptions,i=t.headerMenu||{},n=B(t);return Array.isArray(e)&&t.enableHeaderMenu&&e.forEach((e=>{if(e&&!e.excludeFromHeaderMenu){e.header?e.header.menu||(e.header.menu={commandItems:[]}):e.header={menu:{commandItems:[]}};const s=e?.header?.menu?.commandItems??[];let r=!1;if(i&&!i.hideFreezeColumnsCommand&&(r=!0,s.some((e=>"divider"!==e&&"freeze-columns"===e?.command))||s.push({iconCssClass:i.iconFreezeColumns||"mdi mdi-pin-outline",titleKey:`${n}FREEZE_COLUMNS`,command:"freeze-columns",positionOrder:45})),i&&!i.hideColumnResizeByContentCommand&&this.sharedService.gridOptions.enableColumnResizeOnDoubleClick&&(r=!0,s.some((e=>"divider"!==e&&"column-resize-by-content"===e?.command))||s.push({iconCssClass:i.iconColumnResizeByContentCommand||"mdi mdi-arrow-expand-horizontal",titleKey:`${n}COLUMN_RESIZE_BY_CONTENT`,command:"column-resize-by-content",positionOrder:47})),r&&!s.some((e=>"divider"!==e&&48===e.positionOrder))&&s.push({divider:!0,command:"",positionOrder:48}),t.enableSorting&&e.sortable&&i&&!i.hideSortCommands&&(s.some((e=>"divider"!==e&&"sort-asc"===e?.command))||s.push({iconCssClass:i.iconSortAscCommand||"mdi mdi-sort-ascending",titleKey:`${n}SORT_ASCENDING`,command:"sort-asc",positionOrder:50}),s.some((e=>"divider"!==e&&"sort-desc"===e?.command))||s.push({iconCssClass:i.iconSortDescCommand||"mdi mdi-sort-descending",titleKey:`${n}SORT_DESCENDING`,command:"sort-desc",positionOrder:51}),s.some((e=>"divider"!==e&&52===e.positionOrder))||s.push({divider:!0,command:"",positionOrder:52}),i.hideClearSortCommand||s.some((e=>"divider"!==e&&"clear-sort"===e?.command))||s.push({iconCssClass:i.iconClearSortCommand||"mdi mdi-sort-variant-off",titleKey:`${n}REMOVE_SORT`,command:"clear-sort",positionOrder:58})),e.filter?.filterShortcuts&&!s.some((e=>"divider"!==e&&"filter-shortcuts-root-menu"===e?.command))){const t=[];e.filter.filterShortcuts.forEach((e=>{const i=e.title?Ve(e.title):(e.titleKey||"").toLowerCase().replaceAll("_","-");t.push({...e,command:i,action:(t,i)=>{const n=this.filterService.getFiltersMetadata().find((e=>e.columnDef.id===i.column.id));n?.setValues(e.searchTerms,e.operator,!0)}})}));const o=i.filterShortcutsPositionOrder??55;s.push({iconCssClass:i.iconFilterShortcutSubMenu||"mdi mdi-filter-outline",titleKey:`${n}FILTER_SHORTCUTS`,command:"filter-shortcuts-root-menu",positionOrder:o,commandItems:t}),r&&!s.some((e=>"divider"!==e&&e.positionOrder===o+1))&&s.push({divider:!0,command:"",positionOrder:o+1})}t.enableFiltering&&e.filterable&&i&&!i.hideFilterCommand&&(i.hideClearFilterCommand||s.some((e=>"divider"!==e&&"clear-filter"===e?.command))||s.push({iconCssClass:i.iconClearFilterCommand||"mdi mdi-filter-remove-outline",titleKey:`${n}REMOVE_FILTER`,command:"clear-filter",positionOrder:57})),!i||i.hideColumnHideCommand||s.some((e=>"divider"!==e&&"hide-column"===e?.command))||s.push({iconCssClass:i.iconColumnHideCommand||"mdi mdi-close",titleKey:`${n}HIDE_COLUMN`,command:"hide-column",positionOrder:59}),this.extensionUtility.translateMenuItemsFromTitleKey(s),this.extensionUtility.sortItems(s,"positionOrder")}})),i}clearColumnFilter(e,t){t?.column&&this.filterService.clearFilterByColumnId(e,t.column.id)}clearColumnSort(e,t){t?.column&&this.sharedService&&this.sortService.clearSortByColumnId(e,t.column.id)}executeHeaderMenuInternalCommands(e,t){if(t?.command)switch(t.command){case"hide-column":this.hideColumn(t.column),this.sharedService.gridOptions?.enableAutoSizeColumns&&this.sharedService.slickGrid.autosizeColumns();break;case"clear-filter":this.clearColumnFilter(e,t);break;case"clear-sort":this.clearColumnSort(e,t);break;case"column-resize-by-content":this.pubSubService.publish("onHeaderMenuColumnResizeByContent",{columnId:t.column.id});break;case"freeze-columns":const i=[...this.sharedService.visibleColumns],n={frozenColumn:i.findIndex((e=>e.id===t.column.id)),enableMouseWheelScrollHandler:!0},s=this.sharedService.slickGrid.getColumns();this.sharedService.slickGrid.setOptions(n,!1,!0),this.sharedService.gridOptions.frozenColumn=n.frozenColumn,this.sharedService.gridOptions.enableMouseWheelScrollHandler=n.enableMouseWheelScrollHandler,this.sharedService.frozenVisibleColumnId=t.column.id,this.sharedService.hasColumnsReordered||Array.isArray(i)&&Array.isArray(this.sharedService.allColumns)&&i.length!==this.sharedService.allColumns.length?this.sharedService.slickGrid.setColumns(i):this.sharedService.slickGrid.setColumns(s),this.sharedService.slickGrid.getOptions().enableAutoSizeColumns&&this.sharedService.slickGrid.autosizeColumns();break;case"sort-asc":case"sort-desc":const r="sort-asc"===t.command;this.sortColumn(e,t,r)}}createParentMenu(e,t,i){const n={grid:this.grid,column:t,menu:i};"function"==typeof e.stopPropagation&&(this.pubSubService.publish("onHeaderMenuBeforeMenuShow",n),"function"==typeof this.addonOptions?.onBeforeMenuShow&&!1===this.addonOptions?.onBeforeMenuShow(e,n))||(this._menuElm=this.createCommandMenu(i.commandItems,t),this.grid.getContainerNode()?.appendChild(this._menuElm),this.repositionMenu(e,this._menuElm),this.pubSubService.publish("onHeaderMenuAfterMenuShow",n),"function"==typeof this.addonOptions?.onAfterMenuShow&&!1===this.addonOptions?.onAfterMenuShow(e,n)||(e.preventDefault(),e.stopPropagation()))}createCommandMenu(e,t,i=0,n){const s=n?.command;let r=1===i&&s?s.replace(/\s/g,""):"";r&&(this._subMenuParentId=r),i>1&&(r=this._subMenuParentId);const o=`${this.menuCssClass} slick-menu-level-${i} ${this.gridUid}`,a=document.body.querySelector(`.${this.menuCssClass}.slick-menu-level-${i}${this.gridUidSelector}`);if(a){if(a.dataset.subMenuParent===r)return a;this.disposeSubMenus()}const l=Z("div",{ariaExpanded:"true",ariaLabel:i>1?"SubMenu":"Header Menu",role:"menu",className:o,style:{minWidth:`${this.addonOptions.minWidth}px`}});i>0&&(l.classList.add("slick-submenu"),r&&(l.dataset.subMenuParent=r),this.gridOptions?.darkMode&&l.classList.add("slick-dark-mode"));const c=Z("div",{className:`${this._menuCssPrefix}-command-list`,role:"menu"},l),h={grid:this.grid,column:t,level:i,menu:{commandItems:e}};return n&&i>0&&this.addSubMenuTitleWhenExists(n,c),this.populateCommandOrOptionItems("command",this.addonOptions,c,e,h,this.handleMenuItemCommandClick,this.handleMenuItemMouseOver),i++,l}resetHeaderMenuTranslations(e){e.forEach((e=>{if(e?.header?.menu?.commandItems&&!e.excludeFromHeaderMenu){const t=e.header.menu.commandItems||[];this.extensionUtility.translateMenuItemsFromTitleKey(t)}}))}sortColumn(e,t,i=!0){if(t?.column){const n=t.column,s=this.sharedService.gridOptions.multiColumnSort?this.sortService.getCurrentColumnSorts(n.id+""):[];let r=l.local;s.push({columnId:n.id,sortCol:n,sortAsc:i}),this.sharedService.gridOptions.backendServiceApi?(this.sortService.onBackendSortChanged(e,{multiColumnSort:!0,sortCols:s,grid:this.sharedService.slickGrid}),r=l.remote):this.sharedService.dataView?(this.sortService.onLocalSortChanged(this.sharedService.slickGrid,s),r=l.local):t.grid.onSort.notify(s);const o=s.map((e=>({columnId:e?.sortCol?.id??"",sortAsc:e?.sortAsc??!0})));if(this.sharedService.slickGrid.setSortColumns(o),r){const e=[];o.forEach((t=>{e.push({columnId:`${t.columnId}`,direction:t.sortAsc?"ASC":"DESC"})})),this.sortService.emitSortChanged(r,e)}}}}const mo="slick-rbe-editmode",go="slick-rbe-unsaved-highlight",vo="action-btns--delete",_o="action-btns--edit",bo="action-btns--update",yo="action-btns--cancel";class Co{constructor(e,t,i){this.extensionUtility=e,this.pubSubService=t,this.pluginName="RowBasedEdit",this._defaults={actionsColumnLabel:"Actions",allowMultipleRows:!1,columnId:"_slick_rowbasededit_action",columnIndexPosition:-1,reorderable:!1},this._editedRows=new Map,this._currentLang="en",this._translations={},this.onBeforeEditCellHandler=(e,t)=>this._editedRows.has(t.item?.[this.gridOptions.datasetIdPropertyName??"id"]),this._eventHandler=new vn,this._addonOptions=i}get addonOptions(){return this._addonOptions}get gridOptions(){return this._grid.getOptions()||{}}get eventHandler(){return this._eventHandler}init(e,t){this._grid=e,this._gridService=t,this._addonOptions={...this._defaults,...this.addonOptions};const i=this._grid.getData();if(this._eventHandler.subscribe(this._grid.onBeforeEditCell,this.onBeforeEditCellHandler),this.checkOptionsRequirements(this.gridOptions),this.gridOptions.autoEdit||(this._grid.setOptions({autoEdit:!0}),console.warn('[Slickgrid-Universal] The Row Based Edit Plugin works best with the gridOption "autoEdit" enabled, the option has now been set automatically for you.')),this._existingEditCommandHandler=this.gridOptions.editCommandHandler,this._grid.setOptions({editCommandHandler:this.rowBasedEditCommandHandler.bind(this)}),!0===this.gridOptions.enableExcelCopyBuffer){const e=this.gridOptions.excelCopyBufferOptions?.onBeforePasteCell;this._grid.setOptions({excelCopyBufferOptions:{...this.gridOptions.excelCopyBufferOptions,onBeforePasteCell:(t,n)=>{let s=!0;if(e&&(s=e(t,n),!1===s))return!1;const r=i.getItem(n.row),o=this.gridOptions.datasetIdPropertyName??"id";return!(!this._editedRows.has(r[o])||!0!==s)}}})}const n=i.getItemMetadata;i.getItemMetadata=this.updateItemMetadata(n?.bind?.(i)),this._eventHandler.subscribe(this._grid.onSetOptions,this.optionsUpdatedHandler.bind(this)),this._eventHandler.subscribe(i.onRowsOrCountChanged,this.handleAllRowRerender.bind(this)),this.translate()}destroy(){this.dispose()}dispose(){this._eventHandler?.unsubscribeAll(),this.pubSubService?.unsubscribeAll()}create(e,t){if(this._addonOptions={...this._defaults,...t.rowBasedEditOptions},Array.isArray(e)&&t){const i=this.getColumnDefinition();if(!e.some((e=>e.id===i.id))){const n=t?.rowBasedEditOptions?.columnIndexPosition??-1;-1===n?e.push(i):n>0&&n<e.length?e.splice(n,0,i):e.unshift(i),this.pubSubService.publish("onPluginColumnsChanged",{columns:e,pluginName:this.pluginName})}}return this}getColumnDefinition(){return{id:String(this._addonOptions?.columnId??this._defaults.columnId),name:this._addonOptions?.actionsColumnLabel,field:"action",minWidth:70,width:75,maxWidth:75,excludeFromExport:!0,reorderable:this._addonOptions?.reorderable,formatter:this.actionColumnFormatter.bind(this),onCellClick:this.onCellClickHandler.bind(this),...this._addonOptions?.actionColumnConfig??{}}}rowBasedEditCommandHandler(e,t,i){this._existingEditCommandHandler&&this._existingEditCommandHandler(e,t,i);const n=Array.isArray(i.prevSerializedValue)?i.prevSerializedValue:[i.prevSerializedValue],s=Array.isArray(i.serializedValue)?i.serializedValue:[i.serializedValue],r=this._gridService?.getAllColumnDefinitions().filter((e=>void 0!==e.editor)),o=[],a=this.gridOptions.datasetIdPropertyName??"id";n.forEach(((l,c)=>{const h=n[c],d=s[c];if(h!==d||""===d){const n=Array.isArray(i.prevSerializedValue)?r?.[c]:t;if(!n)return;this._grid.invalidate(),i.execute(),this.renderUnsavedCellStyling(e[a],n),o.push(n)}}));const l=this._editedRows.get(e[a]),c=[...l?.editCommands||[]];o.length>0&&c.push(i),this._editedRows.set(e[a],{columns:[...l?.columns||[],...o],editCommands:c,cssStyleKeys:l?.cssStyleKeys||[]})}translate(e=!1){return this._currentLang=this.extensionUtility.translaterService?.getCurrentLanguage()??"en",this._translations[this._currentLang]&&!e||(this._translations[this._currentLang]={btnUpdateTitle:this.getTitleOrDefault("updateButtonTitle","Update the row"),btnEditTitle:this.getTitleOrDefault("editButtonTitle","Edit the Row"),btnDeleteTitle:this.getTitleOrDefault("deleteButtonTitle","Delete the Row"),btnCancelTitle:this.getTitleOrDefault("cancelButtonTitle","Cancel changes of the Row")}),this._translations[this._currentLang]}checkOptionsRequirements(e){if(!e?.enableCellNavigation)throw new Error("[Slickgrid-Universal] Row Based Edit Plugin requires the gridOption cell navigation (enableCellNavigation = true)");if(!e?.editable)throw new Error("[Slickgrid-Universal] Row Based Edit Plugin requires the gridOption editable (editable = true)")}undoRowEdit(e){const t=this.gridOptions.datasetIdPropertyName??"id",i=this._editedRows.get(e[t]),n=this._grid.getData().getRowByItem(e);if(void 0!==n&&i?.editCommands&&i.editCommands.length||Sn.cancelCurrentEdit()){for(;i.editCommands.length>0;){const e=i.editCommands.pop();e&&e.undo()}i.columns.forEach((e=>{this.removeUnsavedStylingFromCell(e,n)})),i.columns=[],this._grid.invalidate()}}renderUnsavedCellStyling(e,t){if(t){const i=this._grid.getData()?.getRowById(e);if(void 0!==i&&i>=0){const n={[i]:{[t.id]:"slick-rbe-unsaved-cell"}},s=`${go}_${[t.id]}${i}`;this._grid.setCellCssStyles(s,n),this._editedRows.get(e)?.cssStyleKeys.push(s)}}}handleAllRowRerender(e,t){this._editedRows.forEach(((e,t)=>{e.cssStyleKeys.forEach((e=>{this._grid.removeCellCssStyles(e)})),e.cssStyleKeys=[],e.columns.forEach((e=>{this.renderUnsavedCellStyling(t,e)}))}))}removeUnsavedStylingFromCell(e,t){const i=`${go}_${[e.id]}${t}`;this._grid.removeCellCssStyles(i)}removeUnsavedStylingFromRow(e){this._grid.getColumns().forEach((t=>{this.removeUnsavedStylingFromCell(t,e)}))}optionsUpdatedHandler(e,t){this._addonOptions={...this._defaults,...t.optionsAfter.rowBasedEditOptions}}async onCellClickHandler(e,t){const i=t.dataContext,n=e.target,s=this.gridOptions.datasetIdPropertyName??"id",r=this._editedRows.get(i[s]);if((n.classList.contains(vo)||n.parentElement?.classList.contains(vo))&&this._gridService){if(this._addonOptions?.actionButtons?.deleteButtonPrompt&&!window.confirm(this._addonOptions.actionButtons.deleteButtonPrompt))return;this.toggleEditmode(i,!1),this._gridService.deleteItem(i)}else if(n.classList.contains(_o)||n.parentElement?.classList.contains(_o)){if(!this._addonOptions?.allowMultipleRows&&this._editedRows.size>0)return;"function"==typeof this._addonOptions?.onBeforeEditMode&&this._addonOptions.onBeforeEditMode(t),this.toggleEditmode(i,!0)}else if(n.classList.contains(bo)||n.parentElement?.classList.contains(bo)){if(this._addonOptions?.actionButtons?.updateButtonPrompt&&(r?.editCommands.length||0)>0&&!window.confirm(this._addonOptions.actionButtons.updateButtonPrompt))return;if(this._grid.getCellEditor()&&this._grid.getActiveCell()?.row===t.row&&this._grid.getEditController()?.commitCurrentEdit(),this._addonOptions?.onBeforeRowUpdated&&!0!==await this._addonOptions.onBeforeRowUpdated(t))return;this.removeUnsavedStylingFromRow(t.row),this.toggleEditmode(i,!1)}else if(n.classList.contains(yo)||n.parentElement?.classList.contains(yo)){if(this._addonOptions?.actionButtons?.cancelButtonPrompt&&(r?.editCommands.length||0)>0&&!window.confirm(this._addonOptions.actionButtons.cancelButtonPrompt))return;this.undoRowEdit(i),this.toggleEditmode(i,!1)}}actionColumnFormatter(e,t,i,n,s){const r=this.gridOptions,o=this._editedRows.has(s?.[r.datasetIdPropertyName??"id"]),a=this._translations[this._currentLang]??this.translate(),l=document.createDocumentFragment();return l.appendChild(Z("span",{className:`${r.rowBasedEditOptions?.actionButtons?.editButtonClassName||"button-style padding-1px mr-2"} action-btns `+_o,title:a.btnEditTitle,style:{display:o?"none":""}})).appendChild(Z("span",{className:r.rowBasedEditOptions?.actionButtons?.iconEditButtonClassName||"mdi mdi-table-edit text-color-primary"})),l.appendChild(Z("span",{className:`${r.rowBasedEditOptions?.actionButtons?.deleteButtonClassName||"button-style padding-1px"} action-btns `+vo,title:a.btnDeleteTitle,style:{display:o?"none":""}})).appendChild(Z("span",{className:r.rowBasedEditOptions?.actionButtons?.iconDeleteButtonClassName||"mdi mdi-close text-color-danger"})),l.appendChild(Z("span",{className:`${r.rowBasedEditOptions?.actionButtons?.updateButtonClassName||"button-style padding-1px mr-2"} action-btns `+bo,title:a.btnUpdateTitle,style:{display:o?"":"none"}})).appendChild(Z("span",{className:r.rowBasedEditOptions?.actionButtons?.iconUpdateButtonClassName||"mdi mdi-check-bold text-color-success"})),l.appendChild(Z("span",{className:`${r.rowBasedEditOptions?.actionButtons?.cancelButtonClassName||"button-style padding-1px"} action-btns `+yo,title:a.btnCancelTitle,style:{display:o?"":"none"}})).appendChild(Z("span",{className:r.rowBasedEditOptions?.actionButtons?.iconCancelButtonClassName||"mdi mdi-cancel text-color-danger"})),l}toggleEditmode(e,t){const i=this.gridOptions.datasetIdPropertyName??"id";t?this._editedRows.set(e[i],{columns:[],editCommands:[],cssStyleKeys:[]}):this._editedRows.delete(e[i]),this._grid.invalidate()}updateItemMetadata(e){return t=>{const i=this._grid.getData().getItem(t);let n={cssClasses:""};if("function"==typeof e){const i=e(t);i&&(n=i)}if(n&&i){const e=this.gridOptions.datasetIdPropertyName??"id";this._editedRows.has(i[e])&&!n.cssClasses.includes(mo)?n.cssClasses=(n.cssClasses||"")+" "+mo:!this._editedRows.has(i[e])&&n.cssClasses.includes(mo)&&(n.cssClasses=n.cssClasses.replace(mo,""))}return n}}getTitleOrDefault(e,t){const i=this.gridOptions.rowBasedEditOptions?.actionButtons;return i?.[e+"Key"]&&this.extensionUtility.translaterService?.translate?.(i?.[e+"Key"]||"")||i?.[e]||t}}class wo{constructor(e){this.pubSubService=e,this.pluginName="RowMoveManager",this._dragging=!1,this._defaults={autoScroll:!0,columnId:"_move",cssClass:"slick-row-move-column",cancelEditOnDrag:!1,disableRowSelection:!1,hideRowMoveShadow:!0,reorderable:!1,rowMoveShadowMarginTop:0,rowMoveShadowMarginLeft:0,rowMoveShadowOpacity:.9,rowMoveShadowScale:.75,singleRowMove:!1,width:40},this.onBeforeMoveRows=new gn("onBeforeMoveRows"),this.onMoveRows=new gn("onMoveRows"),this._eventHandler=new vn}get addonOptions(){return this._addonOptions}get eventHandler(){return this._eventHandler}get gridOptions(){return this._grid?.getOptions()??{}}init(e,t){this._addonOptions={...this._defaults,...t},this._grid=e,this._canvas=this._grid.getCanvasNode(),wn.addSlickEventPubSubWhenDefined(this.pubSubService,this),"function"==typeof this._addonOptions?.usabilityOverride&&this.usabilityOverride(this._addonOptions.usabilityOverride),this._eventHandler.subscribe(this._grid.onDragInit,this.handleDragInit.bind(this)).subscribe(this._grid.onDragStart,this.handleDragStart.bind(this)).subscribe(this._grid.onDrag,this.handleDrag.bind(this)).subscribe(this._grid.onDragEnd,this.handleDragEnd.bind(this))}dispose(){this._eventHandler?.unsubscribeAll()}create(e,t){if(this._addonOptions={...this._defaults,...t.rowMoveManager},Array.isArray(e)&&t){const i=this.getColumnDefinition();if(!e.some((e=>e.id===i.id))){const n=Array.isArray(e)&&e.find((e=>"selectAndMove"===e?.behavior))||i,s=t?.rowMoveManager?.columnIndexPosition??0;s>0?e.splice(s,0,n):e.unshift(n),this.pubSubService.publish("onPluginColumnsChanged",{columns:e,pluginName:this.pluginName})}}return this}getColumnDefinition(){const e=String(this._addonOptions?.columnId??this._defaults.columnId);return{id:e,name:"",behavior:"selectAndMove",excludeFromExport:!0,excludeFromColumnPicker:!0,excludeFromGridMenu:!0,excludeFromQuery:!0,excludeFromHeaderMenu:!0,field:e,reorderable:this._addonOptions.reorderable,resizable:!1,width:this._addonOptions.width||40,formatter:this.moveIconFormatter.bind(this)}}usabilityOverride(e){this._usabilityOverride=e}setOptions(e){this._addonOptions={...this._addonOptions,...e}}handleDragInit(e){e.stopImmediatePropagation()}handleDragEnd(e,t){if(this._dragging&&(this._dragging=!1,e.stopImmediatePropagation(),t.guide?.remove(),t.selectionProxy?.remove(),t.clonedSlickRow?.remove(),t.canMove)){const i={grid:this._grid,rows:t.selectedRows,insertBefore:t.insertBefore};"function"==typeof this._addonOptions.onMoveRows&&this._addonOptions.onMoveRows(e instanceof mn?e.getNativeEvent():e,i),this.onMoveRows.notify(i)}}handleDrag(e,t){if(this._dragging){e.stopImmediatePropagation();const i=e.getNativeEvent(),n=(i?.touches?.[0]??i).pageY-ne(this._canvas).top;t.selectionProxy.style.top=n-5+"px",t.selectionProxy.style.display="block",t.clonedSlickRow&&(t.clonedSlickRow.style.top=n-6+"px",t.clonedSlickRow.style.display="block");const s=Math.max(0,Math.min(Math.round(n/(this.gridOptions.rowHeight||0)),this._grid.getDataLength()));if(s!==t.insertBefore){const e={grid:this._grid,rows:t.selectedRows,insertBefore:s};if(!1===this._addonOptions?.onBeforeMoveRows?.(i,e)||!1===this.onBeforeMoveRows.notify(e).getReturnValue()?t.canMove=!1:t.canMove=!0,this._usabilityOverride&&t.canMove){const e=this._grid.getDataItem(s);t.canMove=this.checkUsabilityOverride(s,e,this._grid)}t.canMove?t.guide.style.top=s*(this.gridOptions.rowHeight||0)+"px":t.guide.style.top="-1000px",t.insertBefore=s}}}handleDragStart(e,t){const i=this._grid.getCellFromEvent(e)||{cell:-1,row:-1},n=i.row,s=this._grid.getDataItem(n);if(this.checkUsabilityOverride(n,s,this._grid)){if(this._addonOptions.cancelEditOnDrag&&this._grid.getEditorLock().isActive()&&this._grid.getEditorLock().cancelCurrentEdit(),this._grid.getEditorLock().isActive()||!/move|selectAndMove/.test(this._grid.getColumns()[i.cell].behavior||""))return!1;if(this._dragging=!0,e.stopImmediatePropagation(),!this.addonOptions.hideRowMoveShadow){const e=this._grid.getCellNode(i.row,i.cell)?.closest(".slick-row");e&&(t.clonedSlickRow=e.cloneNode(!0),t.clonedSlickRow.classList.add("slick-reorder-shadow-row"),t.clonedSlickRow.style.display="none",t.clonedSlickRow.style.marginLeft=ae(this._addonOptions?.rowMoveShadowMarginLeft,"0px"),t.clonedSlickRow.style.marginTop=ae(this._addonOptions?.rowMoveShadowMarginTop,"0px"),t.clonedSlickRow.style.opacity=`${this._addonOptions?.rowMoveShadowOpacity??.95}`,t.clonedSlickRow.style.transform=`scale(${this.addonOptions?.rowMoveShadowScale??.75})`,this._canvas.appendChild(t.clonedSlickRow))}let n=this._addonOptions.singleRowMove?[i.row]:this._grid.getSelectedRows();0!==n.length&&n.some((e=>e===i.row))||(n=[i.row],this._addonOptions.disableRowSelection||this._grid.setSelectedRows(n));const s=this.gridOptions.rowHeight;t.selectedRows=n,t.selectionProxy=Z("div",{className:"slick-reorder-proxy",style:{display:"none",position:"absolute",zIndex:"99999",width:`${this._canvas.clientWidth}px`,height:s*n.length+"px"}},this._canvas),t.guide=Z("div",{className:"slick-reorder-guide",style:{position:"absolute",zIndex:"99999",width:`${this._canvas.clientWidth}px`,top:"-1000px"}},this._canvas),t.insertBefore=-1}}checkUsabilityOverride(e,t,i){return"function"!=typeof this._usabilityOverride||this._usabilityOverride(e,t,i)}moveIconFormatter(e,t,i,n,s,r){return this.checkUsabilityOverride(e,s,r)?{addClasses:"cell-reorder dnd",html:Z("div",{className:this._addonOptions.cssClass||""})}:""}}class So{get extensionList(){return this._extensionList}get gridOptions(){return this.sharedService.gridOptions||{}}constructor(e,t,i,n,s,r,o,a){this.extensionUtility=e,this.filterService=t,this.pubSubService=i,this.sharedService=n,this.sortService=s,this.treeDataService=r,this.translaterService=o,this.lazyGridService=a,this._extensionCreatedList={},this._extensionList={},this._requireInitExternalExtensions=[]}dispose(){if(this.sharedService.visibleColumns=[],"object"==typeof this._extensionList){const e=Object.keys(this._extensionList);e.forEach((e=>{if(this._extensionList.hasOwnProperty(e)){const t=this._extensionList[e];"function"==typeof t?.instance?.dispose&&t.instance.dispose()}})),e.forEach((e=>{delete this._extensionList[e]}))}this._cellMenuPlugin=null,this._cellExcelCopyManagerPlugin=null,this._checkboxSelectColumn=null,this._contextMenuPlugin=null,this._columnPickerControl=null,this._draggleGroupingPlugin=null,this._gridMenuControl=null,this._groupItemMetadataProviderService=null,this._headerMenuPlugin=null,this._rowMoveManagerPlugin=null,this._rowSelectionModel=null,this._extensionCreatedList=null,this._extensionList={}}addExtensionToList(e,t){this._extensionList[e]=t}getAllColumns(){return this.sharedService.allColumns||[]}getVisibleColumns(){return this.sharedService.visibleColumns||[]}getCreatedExtensionByName(e){if(this._extensionCreatedList?.hasOwnProperty(e))return this._extensionCreatedList[e]}getExtensionByName(e){return this._extensionList?.[e]}getExtensionInstanceByName(e){return this.getExtensionByName(e)?.instance}autoResizeColumns(){this.sharedService.slickGrid.autosizeColumns()}bindDifferentExtensions(){if(this.gridOptions){if(this.gridOptions.enableTranslate&&this.translateItems(this.sharedService.allColumns,"nameKey","name"),this.gridOptions.enableRowBasedEdit){this._rowBasedEdit=this._rowBasedEdit||new Co(this.extensionUtility,this.pubSubService,this.gridOptions.rowBasedEditOptions);const e=this.lazyGridService?.();if(!e)throw new Error("[Slickgrid-Universal] the RowBasedEdit Plugin requires a GridService to be configured and available");this._rowBasedEdit.init(this.sharedService.slickGrid,e),this.gridOptions.rowBasedEditOptions?.onExtensionRegistered&&this.gridOptions.rowBasedEditOptions.onExtensionRegistered(this._rowBasedEdit),this._extensionList[_.rowBasedEdit]={name:_.rowBasedEdit,instance:this._rowBasedEdit}}if(this.gridOptions.enableAutoTooltip){const e=new jr(this.gridOptions?.autoTooltipOptions);this.sharedService.slickGrid.registerPlugin(e),this._extensionList[_.autoTooltip]={name:_.autoTooltip,instance:e}}if(this.gridOptions.enableExcelCopyBuffer&&(this._cellExcelCopyManagerPlugin=new Rr,this._cellExcelCopyManagerPlugin.init(this.sharedService.slickGrid,this.sharedService.gridOptions.excelCopyBufferOptions),this.gridOptions.excelCopyBufferOptions?.onExtensionRegistered&&this.gridOptions.excelCopyBufferOptions.onExtensionRegistered(this._cellExcelCopyManagerPlugin),this._extensionList[_.cellExternalCopyManager]={name:_.cellExternalCopyManager,instance:this._cellExcelCopyManagerPlugin}),this.gridOptions.enableCellMenu&&(this._cellMenuPlugin=new Hr(this.extensionUtility,this.pubSubService,this.sharedService),this.gridOptions.cellMenu?.onExtensionRegistered&&this.gridOptions.cellMenu.onExtensionRegistered(this._cellMenuPlugin),this._extensionList[_.cellMenu]={name:_.cellMenu,instance:this._cellMenuPlugin}),!this._rowSelectionModel&&(this.gridOptions.enableRowSelection||this.gridOptions.enableCheckboxSelector||this.gridOptions.enableRowDetailView||this.gridOptions.enableRowMoveManager)){if(!this._rowSelectionModel||!this.sharedService.slickGrid.getSelectionModel()){const e=this.gridOptions.rowSelectionOptions??{};this.gridOptions.enableRowMoveManager&&!1!==this.gridOptions.rowMoveManager?.dragToSelect&&(e.dragToSelect=!0),this._rowSelectionModel=new Wr(e),this.sharedService.slickGrid.setSelectionModel(this._rowSelectionModel)}this._extensionList[_.rowSelection]={name:_.rowSelection,instance:this._rowSelectionModel}}if(this.gridOptions.enableCheckboxSelector){this._checkboxSelectColumn=this._checkboxSelectColumn||new qr(this.pubSubService,this.gridOptions.checkboxSelector),this._checkboxSelectColumn.init(this.sharedService.slickGrid);const e=this.getCreatedExtensionByName(_.checkboxSelector),t=e?.instance;t&&(this.gridOptions.checkboxSelector?.onExtensionRegistered&&this.gridOptions.checkboxSelector.onExtensionRegistered(t),this._extensionList[_.checkboxSelector]={name:_.checkboxSelector,instance:this._checkboxSelectColumn})}if(this.gridOptions.enableColumnPicker&&(this._columnPickerControl=new no(this.extensionUtility,this.pubSubService,this.sharedService),this.gridOptions.columnPicker?.onExtensionRegistered&&this.gridOptions.columnPicker.onExtensionRegistered(this._columnPickerControl),this._extensionList[_.columnPicker]={name:_.columnPicker,instance:this._columnPickerControl}),this.gridOptions.enableContextMenu&&(this._contextMenuPlugin=new ho(this.extensionUtility,this.pubSubService,this.sharedService,this.treeDataService),this.gridOptions.contextMenu?.onExtensionRegistered&&this.gridOptions.contextMenu.onExtensionRegistered(this._contextMenuPlugin),this._extensionList[_.contextMenu]={name:_.contextMenu,instance:this._contextMenuPlugin}),this.gridOptions.enableDraggableGrouping&&(this._draggleGroupingPlugin&&(this._draggleGroupingPlugin.init(this.sharedService.slickGrid,this.gridOptions.draggableGrouping),this.gridOptions.draggableGrouping?.onExtensionRegistered&&this.gridOptions.draggableGrouping.onExtensionRegistered(this._draggleGroupingPlugin),this._extensionList[_.contextMenu]={name:_.contextMenu,instance:this._draggleGroupingPlugin}),this._extensionList[_.draggableGrouping]={name:_.draggableGrouping,instance:this._draggleGroupingPlugin}),this.gridOptions.enableGridMenu&&(this._gridMenuControl=new Gr(this.extensionUtility,this.filterService,this.pubSubService,this.sharedService,this.sortService),this.gridOptions.gridMenu?.onExtensionRegistered&&this.gridOptions.gridMenu.onExtensionRegistered(this._gridMenuControl),this._extensionList[_.gridMenu]={name:_.gridMenu,instance:this._gridMenuControl}),this.gridOptions.enableHeaderButton){const e=new po(this.extensionUtility,this.pubSubService,this.sharedService);this.gridOptions.headerButton?.onExtensionRegistered&&this.gridOptions.headerButton.onExtensionRegistered(e),this._extensionList[_.headerButton]={name:_.headerButton,instance:e}}if(this.gridOptions.enableHeaderMenu&&(this._headerMenuPlugin=new fo(this.extensionUtility,this.filterService,this.pubSubService,this.sharedService,this.sortService),this.gridOptions.headerMenu?.onExtensionRegistered&&this.gridOptions.headerMenu.onExtensionRegistered(this._headerMenuPlugin),this._extensionList[_.headerMenu]={name:_.headerMenu,instance:this._headerMenuPlugin}),this.gridOptions.enableRowMoveManager){this._rowMoveManagerPlugin=this._rowMoveManagerPlugin||new wo(this.pubSubService),this._rowMoveManagerPlugin.init(this.sharedService.slickGrid,this.gridOptions.rowMoveManager);const e=this.getCreatedExtensionByName(_.rowMoveManager),t=e?.instance;t&&(this._extensionList[_.rowMoveManager]={name:_.rowMoveManager,instance:this._rowMoveManagerPlugin})}this._requireInitExternalExtensions.length&&this._requireInitExternalExtensions.forEach((e=>{e.instance.init(this.sharedService.slickGrid,void 0)}))}}createExtensionsBeforeGridCreation(e,t){const i=[];t.enableCheckboxSelector&&(this.getCreatedExtensionByName(_.checkboxSelector)||(this._checkboxSelectColumn=new qr(this.pubSubService,this.sharedService.gridOptions.checkboxSelector),i.push({name:_.checkboxSelector,instance:this._checkboxSelectColumn,columnIndexPosition:t?.checkboxSelector?.columnIndexPosition??i.length}))),t.enableRowMoveManager&&(this.getCreatedExtensionByName(_.rowMoveManager)||(this._rowMoveManagerPlugin=new wo(this.pubSubService),i.push({name:_.rowMoveManager,instance:this._rowMoveManagerPlugin,columnIndexPosition:t?.rowMoveManager?.columnIndexPosition??i.length}))),t.enableRowBasedEdit&&(this.getCreatedExtensionByName(_.rowBasedEdit)||(this._rowBasedEdit=new Co(this.extensionUtility,this.pubSubService),i.push({name:_.rowBasedEdit,instance:this._rowBasedEdit,columnIndexPosition:t?.rowMoveManager?.columnIndexPosition??i.length}))),t.preRegisterExternalExtensions&&t.preRegisterExternalExtensions(this.pubSubService).forEach((e=>{i.push(e),this._requireInitExternalExtensions.push(e),this._extensionList[e.name]||this.addExtensionToList(e.name,e)})),this.createExtensionByTheirColumnIndex(i,e,t),t.enableDraggableGrouping&&(this.getCreatedExtensionByName(_.draggableGrouping)||(this._draggleGroupingPlugin=new uo(this.extensionUtility,this.pubSubService,this.sharedService),this._draggleGroupingPlugin&&(t.enableColumnReorder=this._draggleGroupingPlugin.setupColumnReorder.bind(this._draggleGroupingPlugin),this._extensionCreatedList[_.draggableGrouping]={name:_.draggableGrouping,instance:this._draggleGroupingPlugin})))}hideColumn(e){if("function"==typeof this.sharedService?.slickGrid?.getColumns){const t=this.sharedService.slickGrid.getColumnIndex(e.id);this.sharedService.visibleColumns=this.removeColumnByIndex(this.sharedService.slickGrid.getColumns(),t),this.sharedService.slickGrid.setColumns(this.sharedService.visibleColumns)}}refreshBackendDataset(e){this.extensionUtility.refreshBackendDataset(e)}removeColumnByIndex(e,t){return Array.isArray(e)?e.filter(((e,i)=>t!==i)):e}translateAllExtensions(e){this.translateCellMenu(),this.translateContextMenu(),this.translateHeaderMenu(),this.translateRowEditPlugin(),this.translateColumnHeaders(e)}translateCellMenu(){this._cellMenuPlugin?.translateCellMenu()}translateColumnPicker(){this._columnPickerControl?.translateColumnPicker()}translateContextMenu(){this._contextMenuPlugin?.translateContextMenu()}translateGridMenu(){this._gridMenuControl?.translateGridMenu()}translateHeaderMenu(){this._headerMenuPlugin?.translateHeaderMenu()}translateRowEditPlugin(){this._rowBasedEdit?.translate()}translateColumnHeaders(e,t){if(this.sharedService&&this.gridOptions&&this.gridOptions.enableTranslate&&(!this.translaterService||!this.translaterService.translate))throw new Error('[Slickgrid-Universal] requires a Translate Service to be installed and configured when the grid option "enableTranslate" is enabled.');e&&this.translaterService?.use&&this.translaterService.getCurrentLanguage()!==e&&this.translaterService.use(e);let i=t;i||(i=this.sharedService.columnDefinitions),this.translateItems(i,"nameKey","name"),this.translateItems(this.sharedService.allColumns,"nameKey","name"),this.translateItems(this.sharedService.allColumns,"columnGroupKey","columnGroup"),this.renderColumnHeaders(i,Array.isArray(t))}renderColumnHeaders(e,t=!1){let i=e;i||(i=this.sharedService.columnDefinitions),Array.isArray(i)&&this.sharedService.slickGrid?.setColumns&&((i.length>this.sharedService.allColumns.length||t)&&(this.sharedService.allColumns=i),this.sharedService.slickGrid.setColumns(i)),this.gridOptions.enableColumnPicker&&this._columnPickerControl&&(this._columnPickerControl.columns=this.sharedService.allColumns,this._columnPickerControl.translateColumnPicker()),this.gridOptions.enableGridMenu&&this._gridMenuControl&&(this._gridMenuControl.columns=this.sharedService.allColumns??[],this._gridMenuControl.recreateGridMenu(),this._gridMenuControl.translateGridMenu())}createExtensionByTheirColumnIndex(e,t,i){e.sort(((e,t)=>(e?.columnIndexPosition??0)-(t?.columnIndexPosition??0))),e.forEach((e=>{const n=e.instance.create(t,i);n&&(this._extensionCreatedList[e.name]={name:e.name,instance:n})}))}translateItems(e,t,i){if(this.gridOptions?.enableTranslate&&!this.translaterService?.translate)throw new Error('[Slickgrid-Universal] requires a Translate Service to be installed and configured when the grid option "enableTranslate" is enabled.');this.extensionUtility.translateItems(e,t,i)}}function Eo(e,t,i){if(i&&(e?.hasOwnProperty(i)||t?.hasOwnProperty(i)))return e[i]===t||e===t[i]||e[i]===t[i];if("object"==typeof e&&"object"==typeof t&&Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(e.hasOwnProperty(i)&&e[i]!==t[i])return!1;return!0}const xo=(e,t,i)=>{switch(e.toUpperCase()){case"<":case"LT":return t<i;case"<=":case"LE":return t<=i;case">":case"GT":return t>i;case">=":case"GE":return t>=i;case"!=":case"<>":case"NE":return t!==i;case"=":case"==":case"EQ":return t===i;case"IN":return!(!i||!Array.isArray(i))&&i.includes(t);case"NIN":case"NOT_IN":return!(!i||!Array.isArray(i)||i.includes(t));case"IN_CONTAINS":return!(!i||!Array.isArray(i)||"string"!=typeof t)&&i.some((e=>t.split(/[,]+/).map((e=>e.trim())).includes(e)));case"NIN_CONTAINS":case"NOT_IN_CONTAINS":return!(!i||!Array.isArray(i)||"string"!=typeof t||i.some((e=>t.split(/[,]+/).map((e=>e.trim())).includes(e))));case"IN_COLLECTION":return!!(t&&i&&Array.isArray(t)&&Array.isArray(i))&&i.some((e=>t.includes(e)));case"NOT_IN_COLLECTION":return!!(t&&i&&Array.isArray(t)&&Array.isArray(i))&&!i.some((e=>t.includes(e)))}return!0};function To(e,t,i,n){return"*"===e||e===S.endsWith||"*z"===e?t.endsWith(i):""===e&&"*"===n||e===S.startsWith||"a*"===e?t.startsWith(i):""===e||e===S.contains?t.indexOf(i)>-1:"<>"===e||e===S.notContains?-1===t.indexOf(i):xo(e||"==",t,i)}function Ao(e,t){let i;switch(Oo(t)){case"boolean":i=function(e){return Ne(Array.isArray(e)&&e[0]||!1)}(e);break;case"date":i=function(e,t){const i=Array.isArray(e)&&e||[],n=It(t||b.dateIso),s=[];if(2===i.length||"string"==typeof i[0]&&i[0].indexOf("..")>0){const e=2===i.length?i:i[0].split(".."),t=Array.isArray(e)&&e[0]||"",r=Array.isArray(e)&&e[1]||"",o=Dt(t,n,!0),a=Dt(r,n,!0);if(!o||!a)return[];s.push(o,a)}else{const e=Dt(i[0],n,!0);if(!e)return[];s.push(e)}return s}(e,t);break;case"number":i=function(e){const t=Array.isArray(e)&&e||[0],i=[];let n,s;if(2===t.length||"string"==typeof t[0]&&t[0].indexOf("..")>0){const e=2===t.length?t:t[0].split("..");n=parseFloat(Array.isArray(e)?e[0]:""),s=parseFloat(Array.isArray(e)?e[1]:"")}else n=parseFloat(t[0]);return Me(n,!0)&&Me(s,!0)?i.push(n,s):Me(n,!0)&&i.push(n),i}(e);break;case"object":i=function(e){return(Array.isArray(e)&&e.length>0?e[0]:"")||""}(e);break;case"string":i=function(e){let t=Array.isArray(e)&&e||[""];const i=[];let n,s;if(1===t.length&&"string"==typeof t[0]){const e=t[0];e.indexOf("..")>0?t=e.split(".."):e.indexOf("*")>0&&e.indexOf("*")<e.length-1&&(t=e.split("*"))}if(2===t.length)n=`${t[0]}`,s=`${t[1]}`;else{const t=Array.isArray(e)&&e.length>0?e[0]:"";n=null==t?"":`${t}`}return void 0!==n&&void 0!==s?i.push(n,s):void 0!==n&&i.push(n),i}(e)}return i}function Oo(e){if(V(e))return"date";switch(e){case b.boolean:return"boolean";case b.integer:case b.float:case b.number:return"number";case b.object:return"object";case b.string:case b.text:case b.password:case b.readonly:default:return"string"}}const Io=(e,t)=>{if(function(e){switch(e&&e.toUpperCase()||""){case"IN":case"NIN":case"NOT_IN":case"IN_CONTAINS":case"NIN_CONTAINS":case"NOT_IN_CONTAINS":case"IN_COLLECTION":case"NOT_IN_COLLECTION":return!0;default:return!1}}(e.operator))return(e=>{const t=e.operator;let i;return i=!Array.isArray(e.cellValue)||"IN_COLLECTION"!==t&&"NOT_IN_COLLECTION"!==t?void 0===e.cellValue||null===e.cellValue?"":`${e.cellValue}`:e.cellValue.length?e.cellValue.map((e=>`${e}`)):[],xo(t||"IN",i,e.searchTerms||[])})(e);switch(Oo(e.filterSearchType||e.fieldType)){case"boolean":return((e,t)=>Ne(e.cellValue)===Ne(t))(e,t);case"date":return function(e,t){const i=It(e&&(e.filterSearchType||e.fieldType)||b.dateIso),[n,s]=t,r=Dt(e.cellValue,i,!0);if(!n&&!s||!r)return!1;const o="ISO8601"===i||i.toLowerCase().includes("h")?r.valueOf():wt(new Date(r)).valueOf();if(n&&s){let t=e?.operator??e.defaultFilterRangeOperator;t!==S.rangeInclusive&&t!==S.rangeExclusive&&(t=e.defaultFilterRangeOperator);const i=t===S.rangeInclusive,r=xo(i?">=":">",o,n.valueOf()),a=xo(i?"<=":"<",o,s.valueOf());return r&&a}const a="ISO8601"===i||i.toLowerCase().includes("h")?n.valueOf():wt(new Date(n)).valueOf();return xo(e.operator||"==",o,a)}(e,t||[]);case"number":return((e,t)=>{const i=parseFloat(e.cellValue),[n,s]=t;if(void 0===n&&!e.operator)return!0;if(void 0!==n&&void 0!==s){let t=e?.operator??e.defaultFilterRangeOperator;t!==S.rangeInclusive&&t!==S.rangeExclusive&&(t=e.defaultFilterRangeOperator);const r=t===S.rangeInclusive,o=xo(r?">=":">",i,+n),a=xo(r?"<=":"<",i,+s);return o&&a}return xo(e.operator||"==",i,+n)})(e,t||[]);case"object":return((e,t)=>{if(void 0===t&&!e.operator)return!0;switch((e.operator||"").toUpperCase()){case"!=":case"<>":case"NE":return!Eo(e.cellValue,t,e.dataKey);default:return Eo(e.cellValue,t,e.dataKey)}})(e,t);default:return((e,t)=>{let[i,n]=t;if(void 0===i&&!e.operator)return!0;e.cellValue=void 0===e.cellValue||null===e.cellValue?"":e.cellValue.toString();const s=e?.ignoreAccentOnStringFilterAndSort?Fe(e.cellValue,!0):e.cellValue.toLowerCase();if("string"==typeof i&&(i=e?.ignoreAccentOnStringFilterAndSort?Fe(i,!0):i.toLowerCase()),"string"==typeof n&&(n=e?.ignoreAccentOnStringFilterAndSort?Fe(n,!0):n.toLowerCase()),e.operator===S.startsWithEndsWith&&void 0!==i&&void 0!==n)return function(e,[t,i]){return e.startsWith(t)&&e.endsWith(i)}(s,[i,n]);if(void 0!==i&&void 0!==n){let t=e?.operator??e.defaultFilterRangeOperator;t!==S.rangeInclusive&&t!==S.rangeExclusive&&(t=e.defaultFilterRangeOperator);const r=t===S.rangeInclusive,o=To(r?">=":">",s,i,e.searchInputLastChar),a=To(r?"<=":"<",s,n,e.searchInputLastChar);return o&&a}return To(e.operator,s,i,e.searchInputLastChar)})(e,t||[])}};class ko{constructor(e,t,i,n,s){this.filterFactory=e,this.pubSubService=t,this.sharedService=i,this.backendUtilities=n,this.rxjs=s,this._isFilterFirstRender=!0,this._firstColumnIdRendered="",this._filtersMetadata=[],this._columnFilters={},this._isTreePresetExecuted=!1,this._previousFilters=[],this._onSearchChange=new gn,this._eventHandler=new vn,this.rxjs&&(this.httpCancelRequests$=this.rxjs.createSubject())}get eventHandler(){return this._eventHandler}get isFilterFirstRender(){return this._isFilterFirstRender}get onSearchChange(){return this._onSearchChange}get _gridOptions(){return this._grid?.getOptions()??{}}get _columnDefinitions(){return this._grid?.getColumns()??[]}get _dataView(){return this._grid?.getData()??{}}addRxJsResource(e){this.rxjs=e}init(e){this._grid=e,this._gridOptions&&this._gridOptions.enableTreeData&&this._gridOptions.treeDataOptions&&this._grid.setSortColumns([{columnId:this._gridOptions.treeDataOptions.columnId,sortAsc:!0}])}dispose(){this._eventHandler.unsubscribeAll(),this.httpCancelRequests$&&this.rxjs?.isObservable(this.httpCancelRequests$)&&(this.httpCancelRequests$.next(),this.httpCancelRequests$.complete()),this.disposeColumnFilters(),this._onSearchChange=null}disposeColumnFilters(){if(this.removeAllColumnFiltersProperties(),Array.isArray(this._filtersMetadata)){let e=this._filtersMetadata.pop();for(;e;)"function"==typeof e?.destroy&&e.destroy(),e=this._filtersMetadata.pop()}}bindBackendOnFilter(e){this._filtersMetadata=[],this._eventHandler.subscribe(e.onHeaderRowCellRendered,((e,t)=>{t.column.id===this._firstColumnIdRendered&&(this._isFilterFirstRender=!1),this.addFilterTemplateToHeaderRow(t,this._isFilterFirstRender),""===this._firstColumnIdRendered&&(this._firstColumnIdRendered=t.column.id)})),this.subscribeToOnHeaderRowCellRendered(e),this._onSearchChange&&this._eventHandler.subscribe(this._onSearchChange,this.onBackendFilterChange.bind(this))}bindLocalOnFilter(e){this._filtersMetadata=[],this._dataView.setFilterArgs({columnFilters:this._columnFilters,grid:this._grid,dataView:this._dataView}),this._dataView.setFilter(this.customLocalFilter.bind(this)),this._onSearchChange&&this._eventHandler.subscribe(this._onSearchChange,(async(e,t)=>{const i=t?.clearFilterTriggered??!1;i||await this.emitFilterChanged(l.local,!0),!0===this._gridOptions.enableTreeData&&(this._tmpPreFilteredData=this.preFilterTreeData(this._dataView.getItems(),this._columnFilters)),i||await this.emitFilterChanged(l.local),null!==t.columnId&&this._dataView.refresh(),this._previousFilters=this.extractBasicFilterDetails(this._columnFilters)})),this._eventHandler.subscribe(e.onHeaderRowCellRendered,((e,t)=>{this.addFilterTemplateToHeaderRow(t)})),this.subscribeToOnHeaderRowCellRendered(e)}async clearFilterByColumnId(e,t){await this.pubSubService.publish("onBeforeFilterClear",{columnId:t},0);const i=this._gridOptions.backendServiceApi??!1,n=i?l.remote:l.local,s=Object.keys(this._columnFilters);let r;Array.isArray(s)&&(r=s.find((e=>e===`${t}`)));const o=this._filtersMetadata.find((e=>e.columnDef.id===t));return o?.clear&&o.clear(!0),i&&void 0!==r&&this.onBackendFilterChange(e,{grid:this._grid,columnFilters:this._columnFilters}),await this.emitFilterChanged(n),!0}async clearFilters(e=!0){e&&await this.pubSubService.publish("onBeforeFilterClear",!0,0),this._filtersMetadata.forEach((e=>{e?.clear&&e.clear(!1)})),this.removeAllColumnFiltersProperties(),Array.isArray(this._columnDefinitions)&&this._columnDefinitions.forEach((e=>{e.filter?.searchTerms&&delete e.filter.searchTerms})),this._dataView&&this._grid&&(this._dataView.refresh(),this._grid.invalidate());const t=this._gridOptions.backendServiceApi;if(t&&e){const i={clearFilterTriggered:!0,shouldTriggerQuery:e,grid:this._grid,columnFilters:this._columnFilters},n=t.service.processOnFilterChanged(void 0,i),s=this._gridOptions.pagination?.totalItems??0;this.backendUtilities?.executeBackendCallback(t,n,i,new Date,s,{errorCallback:this.resetToPreviousSearchFilters.bind(this),successCallback:e=>this._previousFilters=this.extractBasicFilterDetails(e.columnFilters),emitActionChangedCallback:this.emitFilterChanged.bind(this)})}else this._previousFilters=this.extractBasicFilterDetails(this._columnFilters);e&&this.pubSubService.publish("onFilterCleared",!0)}customLocalFilter(e,t){const i=t?.grid,n=t?.columnFilters??{},s=this._gridOptions.enableTreeData??!1,r=this._gridOptions.treeDataOptions;if(s&&r){const t=r.collapsedPropName??m.treeDataProperties.COLLAPSED_PROP,i=r.parentPropName??m.treeDataProperties.PARENT_PROP,n=r?.childrenPropName??m.treeDataProperties.CHILDREN_PROP,s=this._gridOptions.datasetIdPropertyName??"id",o=r.autoRecalcTotalsOnFilterChange??!1;let a=!1;if(null!==e[i]){let n=this._dataView.getItemById(e[i]);for(;n;){if(n[t]){if(!o)return!1;a=!0}n=this._dataView.getItemById(n[i])}}if(this._tmpPreFilteredData instanceof Set){const t=this._tmpPreFilteredData.has(e[s]);if(o){const i=M(this.sharedService.hierarchicalDataset,(t=>t[s]===e[s]),n);if(i&&(i.__filteredOut=!t),a)return!1}return t}}else if("object"==typeof n)for(const t of Object.keys(n)){const s=n[t],r=s.columnDef?.filter;if("function"==typeof r?.filterPredicate){if(!r.filterPredicate(e,s))return!1}else{const t=this.preProcessFilterConditionOnDataContext(e,s,i);if("boolean"==typeof t)return t;let n=s?.parsedSearchTerms;if(void 0===n&&(n=Ao(s.searchTerms,s.columnDef.type||b.string),void 0!==n&&(s.parsedSearchTerms=n)),!Io(t,n))return!1}}return!0}parseFormInputFilterConditions(e,t){const i=Ce(!0,[],e)||[];let n=Array.isArray(i)&&1===i.length?i[0]:"";const s=t.columnDef,r=s.filter?.type??s.type??b.string;let o=null;r!==b.object&&(n=null==n?"":`${n}`,o=!1!==(s.autoParseInputFilterOperator??this._gridOptions.autoParseInputFilterOperator)?n.match(/^((.*[^\\*\r\n])[*]{1}(.*[^*\r\n]))|^([<>!=*]{0,2})(.*[^<>!=*])([*]?)$/)||[]:[n,"","","","",n,""]);const a=o?.[2]||"",l=o?.[3]||"";let c=o?.[4]||t.operator,h=o?.[1]||o?.[5]||"";const d=o?.[6]||("*z"===c?"*":"");return"string"==typeof n&&(n=n.replace("'","''"),a&&l?(h=n,c=S.startsWithEndsWith):"*"===c||"*z"===c?c=S.endsWith:"a*"!==c&&"*"!==d||(c=S.startsWith)),Array.isArray(o)&&o.length>=1&&Array.isArray(i)&&1===i.length&&(i[0]=h.length>0&&" "===h.substring(0,1)?h.substring(1):h),{dataKey:s.dataKey,fieldType:r,searchTerms:i||[],operator:c,searchInputLastChar:d,filterSearchType:s.filterSearchType,defaultFilterRangeOperator:this._gridOptions.defaultFilterRangeOperator}}preProcessFilterConditionOnDataContext(e,t,i){const n=t.columnDef,s=t.columnId;let r=i.getColumnIndex(s);if(!n&&this.sharedService&&Array.isArray(this.sharedService.allColumns)&&(r=this.sharedService.allColumns.findIndex((e=>e.field===s))),!n)return!0;if(this._gridOptions.enableRowDetailView){const t=this._gridOptions.rowDetailView&&this._gridOptions.rowDetailView.keyPrefix||"__";e[`${t}isPadding`]&&e[`${t}parent`]&&(e=e[`${t}parent`])}let o=n.filter?.queryField||n.queryFieldFilter||n.queryField||n.field||"";"function"==typeof n.queryFieldNameGetterFn&&(o=n.queryFieldNameGetterFn(e));const a=n.filter?.type??n.type??b.string;let l=e[o];o?.indexOf(".")>=0&&(l=H(e,o));const c=t.operator,h=t.searchTerms||[];if(!h||Array.isArray(h)&&(0===h.length||1===h.length&&c===h[0]))return!0;if(h&&Array.isArray(h)&&a!==b.object)for(let e=0,t=h.length;e<t;e++)h[e]=(void 0===h[e]||null===h[e]?"":h[e])+"";if(!0===n?.params?.useFormatterOuputToFilter){const t=this._gridOptions.datasetIdPropertyName||"id",i=this._dataView&&"function"==typeof this._dataView.getIdxById?this._dataView.getIdxById(e[t]):0;l=Qe(n&&"function"==typeof n.formatter?n.formatter(i||0,r,l,n,e,this._grid):"")}return"number"==typeof l&&(l=l.toString()),{dataKey:n.dataKey,fieldType:a,searchTerms:h,cellValue:l,operator:c,searchInputLastChar:t.searchInputLastChar,filterSearchType:n.filterSearchType,ignoreAccentOnStringFilterAndSort:this._gridOptions.ignoreAccentOnStringFilterAndSort??!1,defaultFilterRangeOperator:this._gridOptions.defaultFilterRangeOperator}}preFilterTreeData(e,t){const i=this._gridOptions.treeDataOptions,n=i?.collapsedPropName??m.treeDataProperties.COLLAPSED_PROP,s=i?.parentPropName??m.treeDataProperties.PARENT_PROP,r=i?.hasChildrenPropName??m.treeDataProperties.HAS_CHILDREN_PROP,o=this._gridOptions.datasetIdPropertyName??"id",a=this._gridOptions.presets?.treeData?.toggledItems,l=this._gridOptions.treeDataOptions?.initiallyCollapsed??!1,c=this._gridOptions.treeDataOptions?.columnId,h=this._gridOptions.treeDataOptions?.excludeChildrenWhenFilteringTree,d=!h&&!0===this._gridOptions.treeDataOptions?.autoApproveParentItemWhenTreeColumnIsValid,u={},p=new Set,f=new Map;return Array.isArray(e)&&(e.forEach((e=>{u[e[o]]=e,delete u[e[o]].__used})),"object"==typeof t&&Object.keys(t).forEach((e=>{const i=t[e],n=i?.searchTerms?Ce(!0,[],i.searchTerms):[],s=this.parseFormInputFilterConditions(n,i),r=i.columnDef,o=r?.filter?.type??r?.type??b.string,a=Ao(s.searchTerms,o);void 0!==a&&(i.parsedSearchTerms=a)})),e.forEach((e=>{const i=e[r];let m=!0;for(const n of Object.keys(t)){const r=t[n],a=this.preProcessFilterConditionOnDataContext(e,r,this._grid);if(a){const t=r?.parsedSearchTerms,n="boolean"==typeof a?a:Io(a,t);if(n&&d&&i&&r.columnId===c){f.set(e[o],!0);break}if(n||!h&&!0===f.get(e[s])){if(i&&r.columnId===c&&f.set(e[o],!0),n||!h&&r.columnId===c)continue}else i&&!0!==f.get(e[s])&&r.columnId!==c&&f.set(e[o],!1)}m=!1}if(m){p.add(e[o]);let t=u[e[s]]??!1;const i=!l;for(!this._isTreePresetExecuted&&Array.isArray(a)&&a.some((e=>e.itemId===t.id&&e.isCollapsed===i))&&(t[n]=i);t;)t.__used??p.add(t[o]),u[t[o]].__used=!0,t=u[t[s]]??!1}}))),this._isTreePresetExecuted=!0,p}getColumnFilters(){return this._columnFilters}getPreviousFilters(){return this._previousFilters}getFiltersMetadata(){return this._filtersMetadata}getCurrentLocalFilters(){const e=[];if(this._columnFilters)for(const t of Object.keys(this._columnFilters)){const i=this._columnFilters[t],n={columnId:t||""},s=this.sharedService.allColumns.find((e=>e.id===n.columnId)),r=s?.filter?.emptySearchTermReturnAllValues??!0;i?.searchTerms&&(n.searchTerms=i.searchTerms),i.operator&&(n.operator=i.operator),i.targetSelector&&(n.targetSelector=i.targetSelector),Array.isArray(n.searchTerms)&&n.searchTerms.length>0&&(!r||""!==n.searchTerms[0])&&e.push(n)}return e}emitFilterChanged(e,t=!1){const i=t?"onBeforeFilterChange":"onFilterChanged";if(e===l.remote&&this._gridOptions.backendServiceApi){let e=[];const t=this._gridOptions.backendServiceApi.service;return t?.getCurrentFilters&&(e=t.getCurrentFilters()),this.pubSubService.publish(i,e)}if(e===l.local)return this.pubSubService.publish(i,this.getCurrentLocalFilters())}async onBackendFilterChange(e,t){const i=t?.shouldTriggerQuery;if(i&&await this.emitFilterChanged(l.remote,!0),!t||!t.grid)throw new Error('Something went wrong when trying to bind the "onBackendFilterChange(event, args)" function, it seems that "args" is not populated correctly');const n=this._gridOptions.backendServiceApi;if(!n||!n.process||!n.service)throw new Error('BackendServiceApi requires at least a "process" function and a "service" defined');const s=new Date;if(n.preProcess&&n.preProcess(),i){const i=await n.service.processOnFilterChanged(e,t),r=this._gridOptions.pagination?.totalItems??0;this.backendUtilities?.executeBackendCallback(n,i,t,s,r,{errorCallback:this.resetToPreviousSearchFilters.bind(this),successCallback:e=>this._previousFilters=this.extractBasicFilterDetails(e.columnFilters),emitActionChangedCallback:this.emitFilterChanged.bind(this),httpCancelRequestSubject:this.httpCancelRequests$})}}populateColumnFilterSearchTermPresets(e){return Array.isArray(e)&&(this._columnDefinitions.forEach((t=>{t.filter?.searchTerms&&delete t.filter.searchTerms;const i=e.find((e=>e.columnId===t.id));i&&Array.isArray(i?.searchTerms)&&(t.filter=t.filter||{},t.filter.operator=i.operator||t.filter.operator||"",t.filter.searchTerms=i.searchTerms)})),this._gridOptions.enableTreeData&&this.refreshTreeDataFilters(),this._previousFilters=this.extractBasicFilterDetails(this._columnFilters)),this._columnDefinitions}refreshTreeDataFilters(e){const t=e??this._dataView?.getItems()??[];this._dataView&&this._gridOptions.enableTreeData&&t.length>0?(this._tmpPreFilteredData=this.preFilterTreeData(t,this._columnFilters),this._dataView.refresh()):0===t.length&&Array.isArray(this.sharedService.hierarchicalDataset)&&this.sharedService.hierarchicalDataset.length>0&&queueMicrotask((()=>this.refreshTreeDataFilters()))}disableFilterFunctionality(e=!0,t=!0){const i=!this._gridOptions.enableFiltering;i!==e&&(t&&e&&this.clearFilters(),this.disableAllFilteringCommands(e),this._grid.setOptions({enableFiltering:i},!1,!0),this._grid.setHeaderRowVisibility(i),this._gridOptions.enableFiltering=!e,this.sharedService.gridOptions=this._gridOptions,this._grid.setColumns(this.sharedService.columnDefinitions))}resetToPreviousSearchFilters(){this.updateFilters(this._previousFilters,!1,!1,!1)}toggleFilterFunctionality(e=!0){const t=this._gridOptions.enableFiltering;this.disableFilterFunctionality(t,e)}toggleHeaderFilterRow(){let e=this._gridOptions.showHeaderRow??!1;e=!e,this._grid.setHeaderRowVisibility(e),!0===e&&this._grid.setColumns(this.sharedService.columnDefinitions)}setSortColumnIcons(e){this._grid&&Array.isArray(e)&&this._grid.setSortColumns(e)}async updateFilters(e,t=!0,i=!0,n=!1){if(!this._filtersMetadata||0===this._filtersMetadata.length||!this._gridOptions||!this._gridOptions.enableFiltering)throw new Error('[Slickgrid-Universal] in order to use "updateFilters" method, you need to have Filterable Columns defined in your grid and "enableFiltering" set in your Grid Options');if(Array.isArray(e)){this.clearFilters(!1),e.forEach((e=>{const t=this._filtersMetadata.find((t=>e.columnId===t.columnDef.id));if(e&&t){const i=e.operator||t.defaultOperator;this.updateColumnFilters(e.searchTerms,t.columnDef,i),t.setValues(e.searchTerms||[],i),(n||this._gridOptions.enableTreeData)&&this.callbackSearchEvent(void 0,{columnDef:t.columnDef,operator:i,searchTerms:e.searchTerms,shouldTriggerQuery:!0,forceOnSearchChangeEvent:!0})}}));const s=this._gridOptions.backendServiceApi,r=s?l.remote:l.local;if(t&&await this.emitFilterChanged(r,!0),this._dataView.refresh(),s){const t=s?.service;t?.updateFilters&&(t.updateFilters(e,!0),i&&this.backendUtilities?.refreshBackendDataset(this._gridOptions))}t&&await this.emitFilterChanged(r)}return!0}async updateSingleFilter(e,t=!0,i=!0){const n=this.sharedService.allColumns.find((t=>t.id===e.columnId));if(n&&e.columnId){this._columnFilters={};const s=n.filter?.emptySearchTermReturnAllValues??!0;Array.isArray(e.searchTerms)&&(e.searchTerms.length>1||1===e.searchTerms.length&&(!s||""!==e.searchTerms[0]))&&(this._columnFilters[e.columnId]={columnId:e.columnId,operator:e.operator,searchTerms:e.searchTerms,columnDef:n,type:n.type??b.string});const r=this._gridOptions.backendServiceApi,o=r?l.remote:l.local;if(t&&await this.emitFilterChanged(o,!0),r){const e=r?.service;e?.updateFilters&&(e.updateFilters(this._columnFilters,!0),i&&this.backendUtilities?.refreshBackendDataset(this._gridOptions))}else this._dataView.setFilterArgs({columnFilters:this._columnFilters,grid:this._grid}),this._gridOptions.enableTreeData&&this.refreshTreeDataFilters(),this._dataView.refresh();t&&await this.emitFilterChanged(o)}return!0}drawFilterTemplate(e,t){let i;if("string"==typeof t){if(i=document.querySelector(t),null===i)return null}else i=t;const n="string"==typeof e?this.sharedService.allColumns.find((t=>t.id===e)):e;if("selector"!==(n?.id??"")&&n?.filterable){let e,t;const s=this.filterFactory.createFilter(n.filter);t=n&&n.filter&&n.filter.operator||s&&s.operator,this._columnFilters[n.id]?(e=this._columnFilters[n.id].searchTerms||void 0,t=this._columnFilters[n.id].operator||void 0):n.filter&&(e=n.filter.searchTerms||void 0,this.updateColumnFilters(e,n,t));const r={grid:this._grid,operator:t,searchTerms:e,columnDef:n,filterContainerElm:i,callback:this.callbackSearchEvent.bind(this)};return s&&(s.init(r),e&&s.setValues&&s.setValues(e,t)),s}return null}addFilterTemplateToHeaderRow(e,t=!0){const i=e.column;if("selector"!==(i?.id??"")&&i?.filterable&&!i?.hidden){let n,s;const r=this.filterFactory.createFilter(i.filter);s=i&&i.filter&&i.filter.operator||r&&r.operator,this._columnFilters[i.id]?(n=this._columnFilters[i.id].searchTerms||void 0,s=this._columnFilters[i.id].operator||void 0):i.filter&&(n=i.filter.searchTerms||void 0,this.updateColumnFilters(n,i,s));const o={grid:this._grid,operator:s,searchTerms:n,columnDef:i,filterContainerElm:e.node,callback:this.callbackSearchEvent.bind(this)};if(r&&o.filterContainerElm){r.init(o,t);const e=this._filtersMetadata.findIndex((e=>r.columnDef.id===e.columnDef.id));-1===e?this._filtersMetadata.push(r):this._filtersMetadata[e]=r,n&&r.setValues&&r.setValues(n,s)}}}callbackSearchEvent(e,t){if(t){const i=e?.target?e.target.value:void 0,n=t.searchTerms&&Array.isArray(t.searchTerms)?t.searchTerms:i?[i]:void 0,s=t.columnDef||null,r=s?.id??"",o=s?.filter?.type??s?.type??b.string,a=t.operator||void 0,l=n&&Array.isArray(n),c=l&&n&&n.length,h={...this._columnFilters},d=s.filter?.emptySearchTermReturnAllValues??!0;let u;if(s&&r)if(!l||0===c||1===c&&Array.isArray(n)&&d&&""===n[0])delete this._columnFilters[r];else{const t=`${r}`,i={columnId:t,columnDef:s,parsedSearchTerms:[],type:o,targetSelector:this.getSelectorStringFromElement(e?.target)},l=this.parseFormInputFilterConditions(n,i);i.operator=a||l.operator||U(o),u=Ao(l.searchTerms,o),void 0!==u&&(i.parsedSearchTerms=u),i.searchTerms=l.searchTerms||[],this._columnFilters[t]=i}const p=e&&"function"!=typeof e.isPropagationStopped?Ce({},new mn,e):e,f=e?.key;if(this._onSearchChange&&(t.forceOnSearchChangeEvent||"Enter"===f||!Bt(h,this._columnFilters))){const i={clearFilterTriggered:t.clearFilterTriggered,shouldTriggerQuery:t.shouldTriggerQuery,columnId:r,columnDef:s,columnFilters:this._columnFilters,operator:a||U(o),searchTerms:n,parsedSearchTerms:u,grid:this._grid,target:e?.target};!1===this.pubSubService.publish("onBeforeSearchChange",i)?this._gridOptions.resetFilterSearchValueAfterOnBeforeCancellation&&this.resetToPreviousSearchFilters():this._onSearchChange.notify(i,p)}}}disableAllFilteringCommands(e=!0){const t=this._grid.getColumns();t.forEach((t=>{t?.header?.menu&&t.header.menu.commandItems?.forEach((t=>{t&&"string"!=typeof t&&"clear-filter"===t.command&&(t.hidden=e)}))}));const i=this._gridOptions.gridMenu?.commandItems;return i&&i.forEach((t=>{if(t&&"string"!=typeof t){const i=t.command;"clear-filter"!==i&&"toggle-filter"!==i||(t.hidden=e)}})),t}extractBasicFilterDetails(e){const t=[];if(e&&"object"==typeof e)for(const i of Object.keys(e)){const{operator:n,searchTerms:s}=e[`${i}`];t.push({columnId:i,operator:n,searchTerms:s})}return t}getSelectorStringFromElement(e){return e?.localName?e?.className?`${e.localName}.${Array.from(e.classList).join(".")}`:e.localName:""}removeAllColumnFiltersProperties(){"object"==typeof this._columnFilters&&Object.keys(this._columnFilters).forEach((e=>{e&&this._columnFilters[e]&&delete this._columnFilters[e]}))}subscribeToOnHeaderRowCellRendered(e){this._eventHandler.subscribe(e.onBeforeHeaderRowCellDestroy,((e,t)=>{const i=this._filtersMetadata.find((e=>e.columnDef.id===t.column.id));i?.destroy?.()}))}updateColumnFilters(e,t,i){const n=t.filter?.type??t.type??b.string,s=Ao(e,n);e&&t&&(this._columnFilters[t.id]={columnId:t.id,columnDef:t,searchTerms:e,operator:i,parsedSearchTerms:s,type:n})}}const Do={skipError:!1,triggerEvent:!0},jo={highlightRow:!0,resortGrid:!1,selectRow:!1,scrollRowIntoView:!0,skipError:!1,triggerEvent:!0},Ro={highlightRow:!1,selectRow:!1,scrollRowIntoView:!1,skipError:!1,triggerEvent:!0},Lo={autoResizeColumns:!0,triggerEvent:!0,hideFromColumnPicker:!1,hideFromGridMenu:!1};class Mo{constructor(e,t,i,n,s,r,o){this.gridStateService=e,this.filterService=t,this.pubSubService=i,this.paginationService=n,this.sharedService=s,this.sortService=r,this.treeDataService=o}get _dataView(){return this._grid?.getData()}get _gridOptions(){return this._grid?.getOptions()??{}}dispose(){this._rowSelectionPlugin?.dispose()}init(e){this._grid=e}clearAllFiltersAndSorts(){this.sortService&&this.sortService.clearSorting&&this.sortService.clearSorting(!1),this.filterService&&this.filterService.clearFilters&&this.filterService.clearFilters()}clearPinning(e=!0){const t=[...this.sharedService.visibleColumns];this.sharedService.slickGrid.setOptions({frozenColumn:-1,frozenRow:-1,frozenBottom:!1,enableMouseWheelScrollHandler:!1}),e&&Array.isArray(t)&&this.sharedService.slickGrid.setColumns(t)}setPinning(e,t=!0,i=!1,n=!0){Pe(e)?this.clearPinning():(this.sharedService.slickGrid.setOptions(e,i,n),this.sharedService.gridOptions={...this.sharedService.gridOptions,...e}),t&&this.sharedService.slickGrid.autosizeColumns()}getAllColumnDefinitions(){return this.sharedService.allColumns}getVisibleColumnDefinitions(){return this.sharedService.visibleColumns}getColumnFromEventArguments(e){if(!(e&&e.grid&&e.grid.getColumns&&e.grid.getDataItem))throw new Error("[Slickgrid-Universal] To get the column definition and data, we need to have these arguments passed as objects (row, cell, grid)");return{row:e.row,cell:e.cell,columnDef:e.grid.getColumns()[e.cell],dataContext:e.grid.getDataItem(e.row),dataView:this._dataView,grid:this._grid}}getDataItemByRowNumber(e){if(!this._grid||"function"!=typeof this._grid.getDataItem)throw new Error('[Slickgrid-Universal] We could not find SlickGrid Grid object or it\'s "getDataItem" method');return this._grid.getDataItem(e)}getDataItemByRowIndex(e){if(!this._grid||"function"!=typeof this._grid.getDataItem)throw new Error('[Slickgrid-Universal] We could not find SlickGrid Grid object and/or "getDataItem" method');return this._grid.getDataItem(e)}getDataItemByRowIndexes(e){if(!this._grid||"function"!=typeof this._grid.getDataItem)throw new Error('[Slickgrid-Universal] We could not find SlickGrid Grid object and/or "getDataItem" method');const t=[];return Array.isArray(e)&&e.forEach((e=>{t.push(this._grid.getDataItem(e))})),t}getSelectedRows(){if(!this._grid||"function"!=typeof this._grid.getSelectedRows)throw new Error('[Slickgrid-Universal] We could not find SlickGrid Grid object and/or "getSelectedRows" method');return this._grid.getSelectedRows()}getSelectedRowsDataItem(){if(!this._grid||"function"!=typeof this._grid.getSelectedRows)throw new Error('[Slickgrid-Universal] We could not find SlickGrid Grid object and/or "getSelectedRows" method');const e=this._grid.getSelectedRows();return this.getDataItemByRowIndexes(e)}hideColumnById(e,t){if(t={...Lo,...t},this._grid&&this._grid.getColumns&&this._grid.setColumns){const i=this._grid.getColumns(),n=i.findIndex((t=>t.id===e));if(n>=0){const s=Ee(i,n);this.sharedService.visibleColumns=s,this._grid.setColumns(s);const r=this.sharedService.allColumns.findIndex((t=>t.id===e));return r&&(t?.hideFromColumnPicker&&(this.sharedService.allColumns[r].excludeFromColumnPicker=!0),t?.hideFromGridMenu&&(this.sharedService.allColumns[r].excludeFromGridMenu=!0)),t?.autoResizeColumns&&this._grid.autosizeColumns(),t?.triggerEvent&&this.pubSubService.publish("onHeaderMenuHideColumns",{columns:s}),n}}return-1}hideColumnByIds(e,t){if(t={...Lo,...t},Array.isArray(e)){for(const i of e)this.hideColumnById(i,{...t,triggerEvent:!1,autoResizeColumns:!1});t?.autoResizeColumns&&this._grid.autosizeColumns(),t?.triggerEvent&&this.pubSubService.publish("onHeaderMenuHideColumns",{columns:this.sharedService.visibleColumns})}}highlightRow(e,t){this._grid.getSelectionModel()||(this._rowSelectionPlugin=new Wr(this._gridOptions.rowSelectionOptions),this._grid.setSelectionModel(this._rowSelectionPlugin)),t||=this._gridOptions.rowHighlightDuration,Array.isArray(e)?e.forEach((e=>this._grid.highlightRow(e))):this._grid.highlightRow(e,t)}setSelectedRow(e){this._grid?.setSelectedRows&&this._grid.setSelectedRows([e])}setSelectedRows(e){this._grid?.setSelectedRows&&this._grid.setSelectedRows(e)}renderGrid(){"function"==typeof this._grid?.invalidate&&this._grid.invalidate()}resetGrid(e){if(this.clearPinning(!1),this._grid){const t=this.sharedService.allColumns||[];Array.isArray(t)&&t.length>0&&(this._grid.setColumns(t),this._gridOptions?.enableAutoSizeColumns&&this._grid.autosizeColumns(),this.gridStateService.resetColumns(e))}"function"==typeof this.filterService?.clearFilters&&this.filterService.clearFilters(),"function"==typeof this.sortService?.clearSorting&&this.sortService.clearSorting()}addItem(e,t){const i={...jo,...t};if(!(i?.skipError||this._grid&&this._gridOptions&&this._dataView))throw new Error("[Slickgrid-Universal] We could not find SlickGrid Grid, DataView objects");const n=this._gridOptions.datasetIdPropertyName||"id";if(!(i?.skipError||e&&e.hasOwnProperty(n)))throw new Error(`[Slickgrid-Universal] Adding an item requires the item to include an "${n}" property`);if(this._gridOptions?.enableTreeData&&"top"===t?.position)throw new Error('[Slickgrid-Universal] Please note that `addItem({ position: "top" })` is not supported when used with Tree Data because of the extra complexity.');const s=i?.position;"bottom"===s||this._gridOptions?.enableTreeData?this._dataView.addItem(e):this._dataView.insertItem(0,e);let r=0;const o=e?.[n]??"";return this._gridOptions?.enableTreeData?(this.invalidateHierarchicalDataset(),r=this._dataView.getRowById(o),i.scrollRowIntoView&&this._grid.scrollRowIntoView(r??0,!1)):i.resortGrid?(this._dataView.reSort(),r=this._dataView.getRowById(o)):(r="bottom"===s?this._dataView.getRowById(o):0,i.scrollRowIntoView&&this._grid.scrollRowIntoView(r??0)),i.highlightRow&&void 0!==r&&this.highlightRow(r),void 0!==r&&i.selectRow&&this._gridOptions&&(this._gridOptions.enableCheckboxSelector||this._gridOptions.enableRowSelection)&&this.setSelectedRow(r),i.triggerEvent&&this.pubSubService.publish("onItemAdded",e),!this._gridOptions?.backendServiceApi&&this._gridOptions.enablePagination&&("bottom"===s?this.paginationService.goToLastPage():this.paginationService.goToFirstPage()),r}addItems(e,t){const i={...jo,...t},n=this._gridOptions.datasetIdPropertyName||"id",s=i?.position,r=[];if(!Array.isArray(e))return[this.addItem(e,i)||0];if(this._dataView.beginUpdate(!0),"bottom"===s||this._gridOptions?.enableTreeData?this._dataView.addItems(e):this._dataView.insertItems(0,e),this._dataView.endUpdate(),this._gridOptions?.enableTreeData){this.invalidateHierarchicalDataset();const t=e[0]?.[n]??"",s=this._dataView.getRowById(t);i.scrollRowIntoView&&this._grid.scrollRowIntoView(s??0,!1)}else i.resortGrid&&this._dataView.reSort();return s&&i.scrollRowIntoView&&!this._gridOptions?.enableTreeData&&("bottom"===s?this._grid.navigateBottom():this._grid.navigateTop()),e.forEach((e=>r.push(this._dataView.getRowById(e[n])))),i.highlightRow&&this.highlightRow(r),i.selectRow&&this._gridOptions&&(this._gridOptions.enableCheckboxSelector||this._gridOptions.enableRowSelection)&&this.setSelectedRows(r),i.triggerEvent&&this.pubSubService.publish("onItemAdded",e),r}deleteItem(e,t){t={...Do,...t};const i=this._gridOptions.datasetIdPropertyName||"id";if(!(t?.skipError||e&&e.hasOwnProperty(i)))throw new Error(`[Slickgrid-Universal] Deleting an item requires the item to include an "${i}" property`);return this.deleteItemById(e[i],t)}deleteItems(e,t){t={...Do,...t};const i=this._gridOptions.datasetIdPropertyName||"id";if(!Array.isArray(e))return this.deleteItem(e,t),[e[i]];this._dataView.beginUpdate(!0);const n=[];return e.forEach((e=>{void 0!==e?.[i]&&n.push(e[i])})),this._dataView.deleteItems(n),this._dataView.endUpdate(),t.triggerEvent&&this.pubSubService.publish("onItemDeleted",e),n}deleteItemById(e,t){if(t={...Do,...t},!t?.skipError&&null==e)throw new Error('[Slickgrid-Universal] Cannot delete a row without a valid "id"');return!(this.gridStateService&&this.gridStateService.needToPreserveRowSelection())&&this._grid&&this._gridOptions&&(this._gridOptions.enableCheckboxSelector||this._gridOptions.enableRowSelection)&&this.setSelectedRows([]),this._dataView.deleteItem(e),t.triggerEvent&&this.pubSubService.publish("onItemDeleted",e),e}deleteItemByIds(e,t){if(t={...Do,...t},Array.isArray(e)){this._dataView.beginUpdate(!0);for(let t=0;t<e.length;t++)null!==e[t]&&this.deleteItemById(e[t],{triggerEvent:!1});return this._dataView.endUpdate(),t.triggerEvent&&this.pubSubService.publish("onItemDeleted",e),e}return[]}updateItem(e,t){t={...Ro,...t};const i=this._gridOptions.datasetIdPropertyName||"id",n=e&&e.hasOwnProperty(i)?e[i]:void 0;if(!t?.skipError&&void 0===n)throw new Error(`[Slickgrid-Universal] Calling Update of an item requires the item to include an "${i}" property`);return this.updateItemById(n,e,t)}updateItems(e,t){t={...Ro,...t};const i=this._gridOptions.datasetIdPropertyName||"id";if(!Array.isArray(e))return[this.updateItem(e,t)];this._dataView.beginUpdate(!0);const n=[],s=[];return e.forEach((e=>{const t=e&&e.hasOwnProperty(i)?e[i]:void 0;if(s.push(t),void 0!==this._dataView.getIdxById(t)){const e=this._dataView.getRowById(t);void 0!==e&&(n.push(e),this._grid.updateRow(e))}})),this._dataView.updateItems(s,e),this._dataView.endUpdate(),this._gridOptions?.enableTreeData&&this.invalidateHierarchicalDataset(),t.highlightRow&&this.highlightRow(n),t.selectRow&&this._gridOptions&&(this._gridOptions.enableCheckboxSelector||this._gridOptions.enableRowSelection)&&this.setSelectedRows(n),t.triggerEvent&&this.pubSubService.publish("onItemUpdated",e),n}updateItemById(e,t,i){if(i={...Ro,...i},!i?.skipError&&void 0===e)throw new Error('[Slickgrid-Universal] Cannot update a row without a valid "id"');const n=this._dataView.getRowById(e);if(!i?.skipError&&!t&&!this._gridOptions.enablePagination)throw new Error(`[Slickgrid-Universal] The item to update in the grid was not found with id: ${e}`);return void 0!==this._dataView.getIdxById(e)&&(this._dataView.updateItem(e,t),void 0!==n&&this._grid.updateRow(n),this._gridOptions?.enableTreeData&&this.invalidateHierarchicalDataset(),i.scrollRowIntoView&&void 0!==n&&this._grid.scrollRowIntoView(n),i.highlightRow&&void 0!==n&&this.highlightRow(n),void 0!==n&&i.selectRow&&this._gridOptions&&(this._gridOptions.enableCheckboxSelector||this._gridOptions.enableRowSelection)&&this.setSelectedRow(n),i.triggerEvent&&this.pubSubService.publish("onItemUpdated",t)),n}upsertItem(e,t){t={...jo,...t};const i=this._gridOptions.datasetIdPropertyName||"id",n=e&&e.hasOwnProperty(i)?e[i]:void 0;if(!t?.skipError&&void 0===n)throw new Error(`[Slickgrid-Universal] Calling Upsert of an item requires the item to include an "${i}" property`);return this.upsertItemById(n,e,t)}upsertItems(e,t){if(t={...jo,...t},!Array.isArray(e))return[this.upsertItem(e,t)];this._dataView.beginUpdate(!0);const i=[];e.forEach((e=>{i.push(this.upsertItem(e,{...t,highlightRow:!1,resortGrid:!1,selectRow:!1,triggerEvent:!1}))})),this._dataView.endUpdate();const n=i.map((e=>void 0!==e.added?e.added:e.updated));if(t.highlightRow&&this.highlightRow(n),t.selectRow&&this._gridOptions&&(this._gridOptions.enableCheckboxSelector||this._gridOptions.enableRowSelection)&&this.setSelectedRows(n),t.triggerEvent){this.pubSubService.publish("onItemUpserted",e);const t=i.filter((e=>void 0!==e.added));Array.isArray(t)&&t.length>0&&this.pubSubService.publish("onItemAdded",t);const n=i.filter((e=>void 0!==e.updated));Array.isArray(n)&&n.length>0&&this.pubSubService.publish("onItemUpdated",n)}return i}upsertItemById(e,t,i){let n,s,r=!1;if(i={...jo,...i},!i?.skipError&&void 0===e&&!this.hasRowSelectionEnabled())throw new Error('[Slickgrid-Universal] Calling Upsert of an item requires the item to include a valid and unique "id" property');return void 0===this._dataView.getRowById(e)?(n=this.addItem(t,i),r=!0):(s=this.updateItem(t,{highlightRow:i.highlightRow,selectRow:i.selectRow,triggerEvent:i.triggerEvent}),r=!1),i.triggerEvent&&(this.pubSubService.publish("onItemUpserted",t),r?this.pubSubService.publish("onItemAdded",t):this.pubSubService.publish("onItemUpdated",t)),{added:n,updated:s}}invalidateHierarchicalDataset(e){if(this._gridOptions?.enableTreeData&&this.treeDataService){const t=e??this._dataView.getItems(),i=this.sortService.getCurrentColumnSorts(),n=this.treeDataService.convertFlatParentChildToTreeDatasetAndSort(t||[],this.sharedService.allColumns,this._gridOptions,i);this.sharedService.hierarchicalDataset=n.hierarchical,this.filterService.refreshTreeDataFilters(e),this._dataView.setItems(n.flat),this._grid.invalidate()}}hasRowSelectionEnabled(){const e=this._grid.getSelectionModel();return!(!this._gridOptions.enableRowSelection&&!this._gridOptions.enableCheckboxSelector||!e)}}class Po{get eventHandler(){return this._eventHandler}constructor(){this._eventHandler=new vn}dispose(){this._eventHandler.unsubscribeAll()}bindOnBeforeEditCell(e){const t=e?.getData();this._eventHandler.subscribe(e.onBeforeEditCell,((i,n)=>{if(!(i&&n&&e&&void 0!==n.cell&&e.getColumns&&e.getDataItem))return;const s=e.getColumns()[n.cell];if("function"==typeof s.onBeforeEditCell){const r={row:n.row,cell:n.cell,dataView:t,grid:e,columnDef:s,dataContext:e.getDataItem(n.row)};s.onBeforeEditCell(i instanceof mn?i.getNativeEvent():i,r)}}))}bindOnCellChange(e){const t=e?.getData();this._eventHandler.subscribe(e.onCellChange,((i,n)=>{if(!(i&&n&&e&&void 0!==n.cell&&e.getColumns&&e.getDataItem))return;const s=e.getColumns()[n.cell];if("function"==typeof s.onCellChange){const r={row:n.row,cell:n.cell,dataView:t,grid:e,columnDef:s,dataContext:e.getDataItem(n.row)};s.onCellChange(i instanceof mn?i.getNativeEvent():i,r)}}))}bindOnClick(e){const t=e?.getData();this._eventHandler.subscribe(e.onClick,((i,n)=>{if(!(i&&n&&e&&void 0!==n.cell&&e.getColumns&&e.getDataItem))return;const s=e.getColumns()[n.cell];if("function"==typeof s.onCellClick){const r={row:n.row,cell:n.cell,dataView:t,grid:e,columnDef:s,dataContext:e.getDataItem(n.row)};s.onCellClick(i instanceof mn?i.getNativeEvent():i,r)}}))}}class No{constructor(e,t,i,n,s,r){this.extensionService=e,this.filterService=t,this.pubSubService=i,this.sharedService=n,this.sortService=s,this.treeDataService=r,this._columns=[],this._subscriptions=[],this._selectedRowIndexes=[],this._selectedRowDataContextIds=[],this._wasRecheckedAfterPageChange=!0,this._eventHandler=new vn}get _dataView(){return this._grid?.getData()??{}}get _gridOptions(){return this._grid?.getOptions()??{}}get selectedRowDataContextIds(){return this._selectedRowDataContextIds}set selectedRowDataContextIds(e){this._selectedRowDataContextIds=e}init(e){this._grid=e,this.subscribeToAllGridChanges(e)}dispose(){this._columns=[],this._eventHandler.unsubscribeAll(),this.pubSubService.unsubscribeAll(this._subscriptions)}changeColumnsArrangement(e,t=!0,i=!1){if(Array.isArray(e)&&e.length>0){const n=this.getAssociatedGridColumns(this._grid,e);if(n&&Array.isArray(n)&&n.length>0){if(Array.isArray(this.sharedService.allColumns)){const e=[];if(this._gridOptions.enableCheckboxSelector){const t=this._gridOptions?.checkboxSelector?.columnIndexPosition??0;e.push({columnId:"_checkbox_selector",columnIndexPosition:t})}if(this._gridOptions.enableRowDetailView){const t=this._gridOptions?.rowDetailView?.columnIndexPosition??0;e.push({columnId:"_detail_selector",columnIndexPosition:t})}if(this._gridOptions.enableRowMoveManager){const t=this._gridOptions?.rowMoveManager?.columnIndexPosition??0;e.push({columnId:"_move",columnIndexPosition:t})}this.addColumnDynamicWhenFeatureEnabled(e,this.sharedService.allColumns,n)}n.forEach((e=>e.originalWidth=e.width||e.originalWidth)),this._grid.setColumns(n),this.sharedService.visibleColumns=n,t?this._grid.autosizeColumns():(i||this._gridOptions.enableAutoResizeColumnsByCellContent&&!this._gridOptions.autosizeColumnsByCellContentOnFirstLoad)&&this.pubSubService.publish("onFullResizeByContentRequested",{caller:"GridStateService"})}}}getCurrentGridState(){const{frozenColumn:e,frozenRow:t,frozenBottom:i}=this.sharedService.gridOptions,n={columns:this.getCurrentColumns(),filters:this.getCurrentFilters(),sorters:this.getCurrentSorters(),pinning:{frozenColumn:e,frozenRow:t,frozenBottom:i}},s=this.getCurrentPagination();if(s&&(n.pagination=s),this.hasRowSelectionEnabled()){const e=this.getCurrentRowSelections();e&&(n.rowSelection=e)}if(this._gridOptions?.enableTreeData){const e=this.getCurrentTreeDataToggleState();e&&(n.treeData=e)}return n}getColumns(){return this._columns}getAssociatedCurrentColumns(e){const t=[];return e&&Array.isArray(e)&&e.forEach((e=>{e?.id&&t.push({columnId:e.id,cssClass:e.cssClass||"",headerCssClass:e.headerCssClass||"",width:e.width||0})})),t}getAssociatedGridColumns(e,t){const i=[],n=this.sharedService.allColumns||e.getColumns();return t&&Array.isArray(t)&&t.forEach((e=>{const t=n.find((t=>t.id===e.columnId));t?.id&&i.push({...t,cssClass:e.cssClass||t.cssClass,headerCssClass:e.headerCssClass||t.headerCssClass,width:e.width})})),this._columns=i,i}getCurrentColumns(){return this.getAssociatedCurrentColumns(this._grid.getColumns()||[])}getCurrentFilters(){if(this._gridOptions?.backendServiceApi){const e=this._gridOptions.backendServiceApi.service;if(e?.getCurrentFilters)return e.getCurrentFilters()}else if(this.filterService?.getCurrentLocalFilters)return this.filterService.getCurrentLocalFilters();return null}getCurrentPagination(){if(this._gridOptions?.enablePagination){if(!this._gridOptions.backendServiceApi)return this.sharedService.currentPagination;{const e=this._gridOptions.backendServiceApi.service;if(e?.getCurrentPagination)return e.getCurrentPagination()}}return null}getCurrentRowSelections(){return this._grid&&this._dataView&&this.hasRowSelectionEnabled()?{gridRowIndexes:this._grid.getSelectedRows()||[],dataContextIds:this._dataView.getAllSelectedIds()||[],filteredDataContextIds:this._dataView.getAllSelectedFilteredIds()||[]}:null}getCurrentSorters(){if(this._gridOptions?.backendServiceApi){const e=this._gridOptions.backendServiceApi.service;if(e?.getCurrentSorters)return e.getCurrentSorters()}else if(this.sortService?.getCurrentLocalSorters)return this.sortService.getCurrentLocalSorters();return null}getCurrentTreeDataToggleState(){return this._gridOptions?.enableTreeData&&this.treeDataService?this.treeDataService.getCurrentToggleState():null}needToPreserveRowSelection(){let e=!1;if(this._gridOptions?.dataView&&this._gridOptions.dataView.hasOwnProperty("syncGridSelection")){const t=this._gridOptions.dataView.syncGridSelection;"boolean"==typeof t?e=this._gridOptions.dataView.syncGridSelection:"object"==typeof t&&(e=t.preserveHidden||t.preserveHiddenOnSelectionChange),e&&this._gridOptions.backendServiceApi&&this._gridOptions.dataView.hasOwnProperty("syncGridSelectionWithBackendService")&&(e=this._gridOptions.dataView.syncGridSelectionWithBackendService)}return e}resetColumns(e){const t=e||this._columns,i=this.getAssociatedCurrentColumns(t);this.pubSubService.publish("onGridStateChanged",{change:{newValues:i,type:w.columns},gridState:this.getCurrentGridState()})}resetToOriginalColumns(e=!0){this._grid.setColumns(this.sharedService.allColumns),this.sharedService.visibleColumns=this.sharedService.allColumns,e&&this._grid.autosizeColumns()}resetRowSelectionWhenRequired(){if(!this.needToPreserveRowSelection()&&(this._gridOptions.enableRowSelection||this._gridOptions.enableCheckboxSelector)){const e=this.extensionService?.getExtensionByName?.(_.rowSelection);e?.instance&&this._grid.setSelectedRows([])}}subscribeToAllGridChanges(e){this._subscriptions.push(this.pubSubService.subscribe("onFilterChanged",(e=>{this.resetRowSelectionWhenRequired(),this.pubSubService.publish("onGridStateChanged",{change:{newValues:e,type:w.filter},gridState:this.getCurrentGridState()})}))),this._subscriptions.push(this.pubSubService.subscribe("onFilterCleared",(()=>{this.resetRowSelectionWhenRequired(),this.pubSubService.publish("onGridStateChanged",{change:{newValues:[],type:w.filter},gridState:this.getCurrentGridState()})}))),this._subscriptions.push(this.pubSubService.subscribe("onSortChanged",(e=>{this.resetRowSelectionWhenRequired(),this.pubSubService.publish("onGridStateChanged",{change:{newValues:e,type:w.sorter},gridState:this.getCurrentGridState()})}))),this._subscriptions.push(this.pubSubService.subscribe("onSortCleared",(()=>{this.resetRowSelectionWhenRequired(),this.pubSubService.publish("onGridStateChanged",{change:{newValues:[],type:w.sorter},gridState:this.getCurrentGridState()})}))),this.bindExtensionAddonEventToGridStateChange(_.columnPicker,"onColumnsChanged"),this.bindExtensionAddonEventToGridStateChange(_.gridMenu,"onColumnsChanged"),this.bindSlickGridColumnChangeEventToGridStateChange("onColumnsReordered",e),this.bindSlickGridColumnChangeEventToGridStateChange("onColumnsResized",e),this.bindSlickGridOnSetOptionsEventToGridStateChange(e),(this._gridOptions.enableRowSelection||this._gridOptions.enableCheckboxSelector)&&this._eventHandler.subscribe(this._dataView.onSelectedRowIdsChanged,((e,t)=>{const i=(this._selectedRowIndexes||[]).slice(),n=(this.selectedRowDataContextIds||[]).slice();if(this.selectedRowDataContextIds=t.filteredIds,this._selectedRowIndexes=t.rows,!Bt(this.selectedRowDataContextIds,n)||!Bt(this._selectedRowIndexes,i)){const e={gridRowIndexes:this._selectedRowIndexes||[],dataContextIds:t.selectedRowIds,filteredDataContextIds:t.filteredIds};this.pubSubService.publish("onGridStateChanged",{change:{newValues:e,type:w.rowSelection},gridState:this.getCurrentGridState()})}})),this._subscriptions.push(this.pubSubService.subscribe("onHeaderMenuHideColumns",(e=>{const t=this.getAssociatedCurrentColumns(e);this.pubSubService.publish("onGridStateChanged",{change:{newValues:t,type:w.columns},gridState:this.getCurrentGridState()})}))),this._subscriptions.push(this.pubSubService.subscribe("onTreeItemToggled",(e=>{this.pubSubService.publish("onGridStateChanged",{change:{newValues:e,type:w.treeData},gridState:this.getCurrentGridState()})}))),this._subscriptions.push(this.pubSubService.subscribe("onTreeFullToggleEnd",(e=>{this.pubSubService.publish("onGridStateChanged",{change:{newValues:e,type:w.treeData},gridState:this.getCurrentGridState()})})))}addColumnDynamicWhenFeatureEnabled(e,t,i){e.sort(((e,t)=>e.columnIndexPosition-t.columnIndexPosition)),e.forEach((e=>{const n=t.findIndex((t=>t.id===e.columnId)),s=i.findIndex((t=>t.id===e.columnId));if(n>=0&&-1===s){const e=t[n];0===n?i.unshift(e):i.splice(n,0,e)}}))}bindExtensionAddonEventToGridStateChange(e,t){const i=this.extensionService?.getExtensionByName?.(e),n=i?.instance?.[t];n&&"function"==typeof n.subscribe&&this._eventHandler.subscribe(n,((e,t)=>{const i=t?.columns,n=this.getAssociatedCurrentColumns(i);this.pubSubService.publish("onGridStateChanged",{change:{newValues:n,type:w.columns},gridState:this.getCurrentGridState()})}))}bindSlickGridColumnChangeEventToGridStateChange(e,t){const i=t?.[e];i&&"function"==typeof i.subscribe&&this._eventHandler.subscribe(i,(()=>{const e=t.getColumns(),i=this.getAssociatedCurrentColumns(e);this.pubSubService.publish("onGridStateChanged",{change:{newValues:i,type:w.columns},gridState:this.getCurrentGridState()})}))}bindSlickGridOnSetOptionsEventToGridStateChange(e){const t=e.onSetOptions;this._eventHandler.subscribe(t,((e,t)=>{const{frozenBottom:i,frozenColumn:n,frozenRow:s}=t.optionsBefore,{frozenBottom:r,frozenColumn:o,frozenRow:a}=t.optionsAfter;if(i!==r||n!==o||s!==a){const e={frozenBottom:r,frozenColumn:o,frozenRow:a},t=this.getCurrentGridState();this.pubSubService.publish("onGridStateChanged",{change:{newValues:e,type:w.pinning},gridState:t})}}))}hasRowSelectionEnabled(){const e=this._grid.getSelectionModel();return!(!this._gridOptions.enableRowSelection&&!this._gridOptions.enableCheckboxSelector||!e)}}class Fo{constructor(e){this.extensionUtility=e,this._subscriptions=[],this._eventHandler=new vn}get _dataView(){return this._grid?.getData()??{}}get eventHandler(){return this._eventHandler}get _gridOptions(){return this._grid?.getOptions()??{}}get _columnDefinitions(){return this._grid?.getColumns()??[]}init(e){this._grid=e,e&&this._gridOptions&&this._gridOptions.createPreHeaderPanel&&(this._gridOptions.enableTranslate&&this.translateHeaderGrouping(),this._eventHandler.subscribe(e.onRendered,(()=>this.renderPreHeaderRowGroupingTitles())),this._eventHandler.subscribe(e.onAutosizeColumns,(()=>this.renderPreHeaderRowGroupingTitles())),this._eventHandler.subscribe(this._dataView.onRowCountChanged,(()=>this.delayRenderPreHeaderRowGroupingTitles(0))),this._eventHandler.subscribe(e.onSetOptions,((e,t)=>{t?.optionsBefore?.frozenColumn!==t?.optionsAfter?.frozenColumn&&this.delayRenderPreHeaderRowGroupingTitles(0)})),this.delayRenderPreHeaderRowGroupingTitles(75))}dispose(){this._eventHandler.unsubscribeAll()}delayRenderPreHeaderRowGroupingTitles(e=0){window.setTimeout((()=>this.renderPreHeaderRowGroupingTitles()),e)}renderPreHeaderRowGroupingTitles(){const e=this._columnDefinitions.length;if(void 0!==this._gridOptions?.frozenColumn&&this._gridOptions.frozenColumn>=0){const t=this._gridOptions.frozenColumn;this.renderHeaderGroups(this._grid.getPreHeaderPanelLeft(),0,t+1),this.renderHeaderGroups(this._grid.getPreHeaderPanelRight(),t+1,e)}else this.renderHeaderGroups(this._grid.getPreHeaderPanel(),0,e)}renderHeaderGroups(e,t,i){ee(e),e.className="slick-header-columns",e.style.left="-1000px",e.style.width=`${this._grid.getHeadersWidth()}px`,e.parentElement?.classList.add("slick-header");const n=this._grid.getHeaderColumnWidthDiff();let s,r=null,o="",a=0;const l=this._gridOptions?.frozenHeaderWidthCalcDifferential??0,c=void 0!==this._gridOptions?.frozenColumn&&this._gridOptions.frozenColumn>=0;for(let h=t;h<i;h++)s=this._columnDefinitions[h],s&&(o===s.columnGroup&&h>0?(a+=s.width||0,r?.style&&(r.style.width=a-n-l+"px")):(a=s.width||0,r=Z("div",{className:"slick-state-default slick-header-column "+(c?"frozen":""),dataset:{group:s.columnGroup},style:{width:a-n+"px"}}),Z("span",{className:"slick-column-name",textContent:s.columnGroup||""},r),e.appendChild(r)),o=s.columnGroup||"")}translateHeaderGrouping(){const e=this._grid.getColumns();this.extensionUtility.translateItems(e,"columnGroupKey","columnGroup"),this._grid.setColumns(e),this.renderPreHeaderRowGroupingTitles()}}class Ho{constructor(e,t,i,n){this.pubSubService=e,this.sharedService=t,this.backendUtilities=i,this.rxjs=n,this._initialized=!1,this._isLocalGrid=!0,this._dataFrom=1,this._dataTo=1,this._itemsPerPage=0,this._pageCount=1,this._pageNumber=1,this._totalItems=0,this._availablePageSizes=[],this._subscriptions=[],this._isCursorBased=!1,this._eventHandler=new vn}get dataView(){return this.grid?.getData()??{}}set paginationOptions(e){this._paginationOptions=e}get paginationOptions(){return this._paginationOptions}get availablePageSizes(){return this._availablePageSizes}get dataFrom(){return this._dataFrom}get dataTo(){return this._dataTo}get itemsPerPage(){return this._itemsPerPage}get pageCount(){return this._pageCount}get pageNumber(){return this._pageNumber}get totalItems(){return this._totalItems}set totalItems(e){this._totalItems=e,this._initialized&&this.refreshPagination()}get isCursorBased(){return this._isCursorBased}addRxJsResource(e){this.rxjs=e}init(e,t,i){if(this._availablePageSizes=t.pageSizes||[],this.grid=e,this._backendServiceApi=i,this._paginationOptions=t,this._isLocalGrid=!i,this._pageNumber=t.pageNumber||1,this._isCursorBased=i?.options?.useCursor??!1,i&&(!i.service||!i.process))throw new Error('BackendServiceApi requires the following 2 properties "process" and "service" to be defined.');this._isLocalGrid&&this.dataView&&(this._eventHandler.subscribe(this.dataView.onPagingInfoChanged,((e,t)=>{this._totalItems!==t.totalRows&&(this.updateTotalItems(t.totalRows),this._previousPagination={pageNumber:t.pageNum,pageSize:t.pageSize,pageSizes:this.availablePageSizes,totalItems:t.totalRows})})),queueMicrotask((()=>{this.dataView&&(this.dataView.setRefreshHints({isFilterUnchanged:!0}),this.dataView.setPagingOptions({pageSize:this.paginationOptions.pageSize,pageNum:this._pageNumber-1}))}))),this._subscriptions.push(this.pubSubService.subscribe(["onFilterChanged","onFilterCleared"],(()=>this.resetPagination()))),i?.options?.infiniteScroll&&this._subscriptions.push(this.pubSubService.subscribe("onSortChanged",(()=>this.resetPagination()))),this.dataView&&(this._subscriptions.push(this.pubSubService.subscribe("onItemAdded",(e=>this.processOnItemAddedOrRemoved(e,!0)))),this._subscriptions.push(this.pubSubService.subscribe("onItemDeleted",(e=>this.processOnItemAddedOrRemoved(e,!1))))),this.refreshPagination(!1,!1,!0);const n=this.getFullPagination();this._previousPagination={pageNumber:n.pageNumber,pageSize:n.pageSize,pageSizes:n.pageSizes,totalItems:this.totalItems},this._initialized=!0,p(t,"totalItems",(e=>this._totalItems=e))}dispose(){this._initialized=!1,this._eventHandler.unsubscribeAll(),this.pubSubService.unsubscribeAll(this._subscriptions)}getCurrentPagination(){return{pageNumber:this._pageNumber,pageSize:this._itemsPerPage,pageSizes:this._availablePageSizes}}getFullPagination(){return{pageCount:this._pageCount,pageNumber:this._pageNumber,pageSize:this._itemsPerPage,pageSizes:this._availablePageSizes,totalItems:this._totalItems,dataFrom:this._dataFrom,dataTo:this._dataTo}}getCurrentPageNumber(){return this._pageNumber}getCurrentItemPerPage(){return this._itemsPerPage}changeItemPerPage(e,t,i=!0){return this._pageNumber=1,this._pageCount=Math.ceil(this._totalItems/e),this._itemsPerPage=e,i?this.processOnPageChanged(this._pageNumber,t):Promise.resolve(this.getFullPagination())}goToFirstPage(e,t=!0){return this._pageNumber=1,t?this.isCursorBased&&this._cursorPageInfo?this.processOnPageChanged(this._pageNumber,e,{newPage:this._pageNumber,pageSize:this._itemsPerPage,first:this._itemsPerPage}):this.processOnPageChanged(this._pageNumber,e):Promise.resolve(this.getFullPagination())}goToLastPage(e,t=!0){return this._pageNumber=this._pageCount||1,t?this.isCursorBased&&this._cursorPageInfo?this.processOnPageChanged(this._pageNumber,e,{newPage:this._pageNumber,pageSize:this._itemsPerPage,last:this._itemsPerPage}):this.processOnPageChanged(this._pageNumber,e):Promise.resolve(this.getFullPagination())}goToNextPage(e,t=!0){return this._pageNumber<this._pageCount?(this._pageNumber++,t?this.isCursorBased&&this._cursorPageInfo?this.processOnPageChanged(this._pageNumber,e,{newPage:this._pageNumber,pageSize:this._itemsPerPage,first:this._itemsPerPage,after:this._cursorPageInfo.endCursor}):this.processOnPageChanged(this._pageNumber,e):Promise.resolve(this.getFullPagination())):Promise.resolve(!1)}goToPageNumber(e,t,i=!0){if(this.isCursorBased)return console.assert(!0,"Cursor based navigation cannot navigate to arbitrary page"),Promise.resolve(!1);const n=this._pageNumber;return e<1?this._pageNumber=1:e>this._pageCount?this._pageNumber=this._pageCount:this._pageNumber=e,this._pageNumber!==n?i?this.processOnPageChanged(this._pageNumber,t):Promise.resolve(this.getFullPagination()):Promise.resolve(!1)}goToPreviousPage(e,t=!0){return this._pageNumber>1?(this._pageNumber--,t?this.isCursorBased&&this._cursorPageInfo?this.processOnPageChanged(this._pageNumber,e,{newPage:this._pageNumber,pageSize:this._itemsPerPage,last:this._itemsPerPage,before:this._cursorPageInfo.startCursor}):this.processOnPageChanged(this._pageNumber,e):Promise.resolve(this.getFullPagination())):Promise.resolve(!1)}refreshPagination(e=!1,t=!0,i=!1){const n={...this.getFullPagination()};if(this._paginationOptions){const t=this._paginationOptions;this._itemsPerPage||(this._isLocalGrid?this._itemsPerPage=t.pageSize:this._itemsPerPage=+(this._backendServiceApi?.options?.paginationOptions?.first?this._backendServiceApi.options.paginationOptions.first:t.pageSize)),(e||this._totalItems!==t.totalItems)&&(e?(this._pageNumber=1,this.paginationOptions.pageNumber=1):!this._initialized&&t.pageNumber&&t.pageNumber>1&&(this._pageNumber=t.pageNumber||1),1===this._pageNumber&&this._backendServiceApi&&this._backendServiceApi.service.resetPaginationOptions()),this._availablePageSizes=t.pageSizes||[],!this._totalItems&&t.totalItems&&(this._totalItems=t.totalItems),this.recalculateFromToIndexes()}this._pageCount=Math.ceil(this._totalItems/this._itemsPerPage),this.sharedService.currentPagination=this.getCurrentPagination(),this.pubSubService.publish("onPaginationRefreshed",this.getFullPagination()),t&&!Bt(n,this.getFullPagination())&&this.pubSubService.publish("onPaginationChanged",this.getFullPagination()),i&&!Bt(n,this.getFullPagination())&&this.pubSubService.publish("onPaginationPresetsInitialized",this.getFullPagination());const s=this.getFullPagination();this._previousPagination={pageNumber:s.pageNumber,pageSize:s.pageSize,pageSizes:s.pageSizes,totalItems:this.totalItems}}resetPagination(e=!0,t=!0){this._isLocalGrid&&this.dataView&&this.sharedService?.gridOptions?.enablePagination&&this.dataView.setPagingOptions({pageSize:this._itemsPerPage,pageNum:0}),this._cursorPageInfo=void 0,this.refreshPagination(!0,e),t&&this.grid.scrollTo(0)}togglePaginationVisibility(e){if(this.grid&&this.sharedService?.gridOptions){const t=void 0!==e?e:!this.sharedService.gridOptions.enablePagination;if(t&&this.goToFirstPage(),this._isLocalGrid&&this.dataView){const t=e?this._itemsPerPage:0;this.dataView.setPagingOptions({pageSize:t,pageNum:0})}this.sharedService.gridOptions.enablePagination=t,this.pubSubService.publish("onPaginationVisibilityChanged",{visible:t})}}processOnPageChanged(e,t,i){return console.assert(!this.isCursorBased||i,"Configured for cursor based pagination - cursorArgs expected"),!1===this.pubSubService.publish("onBeforePaginationChange",this.getFullPagination())?(this.resetToPreviousPagination(),Promise.resolve(this.getFullPagination())):new Promise(((n,s)=>{if(this.recalculateFromToIndexes(),this._isLocalGrid&&this.dataView)this.dataView.setPagingOptions({pageSize:this._itemsPerPage,pageNum:e-1}),this.pubSubService.publish("onPaginationChanged",this.getFullPagination()),this.pubSubService.publish("onPaginationRefreshed",this.getFullPagination()),n(this.getFullPagination());else{const r=+this._itemsPerPage,o=new Date;if(this._backendServiceApi?.preProcess&&this._backendServiceApi.preProcess(),this._backendServiceApi?.process){const a=this.isCursorBased&&i?this._backendServiceApi.service.processOnPaginationChanged(t,i):this._backendServiceApi.service.processOnPaginationChanged(t,{newPage:e,pageSize:r}),l=this._backendServiceApi.process(a);l instanceof Promise?l.then((e=>{this.backendUtilities?.executeBackendProcessesCallback(o,e,this._backendServiceApi,this._totalItems);const t=this.getFullPagination();this._previousPagination={pageNumber:t.pageNumber,pageSize:t.pageSize,pageSizes:t.pageSizes,totalItems:this.totalItems},n(this.getFullPagination())})).catch((e=>{this.resetToPreviousPagination(),this.backendUtilities?.onBackendError(e,this._backendServiceApi),this._backendServiceApi?.onError&&this.backendUtilities?.onBackendError||s(l)})):this.rxjs?.isObservable(l)&&this._subscriptions.push(l.subscribe((e=>{const t=this.getFullPagination();this._previousPagination={pageNumber:t.pageNumber,pageSize:t.pageSize,pageSizes:t.pageSizes,totalItems:this.totalItems},n(this.backendUtilities?.executeBackendProcessesCallback(o,e,this._backendServiceApi,this._totalItems))}),(e=>{this.resetToPreviousPagination(),this.backendUtilities?.onBackendError(e,this._backendServiceApi),this._backendServiceApi?.onError&&this.backendUtilities?.onBackendError||s(l)}))),this.pubSubService.publish("onPaginationRefreshed",this.getFullPagination()),this.pubSubService.publish("onPaginationChanged",this.getFullPagination())}}}))}recalculateFromToIndexes(){((this._pageNumber-1)*this._itemsPerPage>this._totalItems||this._totalItems>0&&0===this._pageNumber)&&(this._pageNumber=1),0===this._totalItems?(this._dataFrom=0,this._dataTo=1,this._pageNumber=0):(this._dataFrom=this._pageNumber>1?this._pageNumber*this._itemsPerPage-this._itemsPerPage+1:1,this._dataTo=this._totalItems<this._itemsPerPage?this._totalItems:(this._pageNumber||1)*this._itemsPerPage,this._dataTo>this._totalItems&&(this._dataTo=this._totalItems)),(this._dataTo>this._totalItems||this._totalItems<this._itemsPerPage)&&(this._dataTo=this._totalItems)}resetToPreviousPagination(){const e=this._previousPagination?.pageNumber!==this.getFullPagination().pageNumber,t=this._previousPagination?.pageSize!==this.getFullPagination().pageSize;t&&this.changeItemPerPage(this._previousPagination?.pageSize??0,null,!1),e&&this.goToPageNumber(this._previousPagination?.pageNumber??0,null,!1),(e||t)&&(this.refreshPagination(),this._backendServiceApi?.service?.updatePagination?.(this._previousPagination?.pageNumber??0,this._previousPagination?.pageSize??0))}setCursorBased(e){this._isCursorBased=e,e&&this.setCursorPageInfo({startCursor:"",endCursor:"",hasNextPage:!1,hasPreviousPage:!1}),this.goToFirstPage(),this.pubSubService.publish("onPaginationSetCursorBased",{isCursorBased:e})}setCursorPageInfo(e){this._cursorPageInfo=e}updateTotalItems(e,t=!1){this._totalItems=e,this._paginationOptions&&(this._paginationOptions.totalItems=e,this.refreshPagination(!1,t))}processOnItemAddedOrRemoved(e,t=!0){if(null!==e){const i=this._dataTo,n=Array.isArray(e)?e.length:1,s=t?+n:-n;this._totalItems+=s,this.recalculateFromToIndexes(),this._dataTo=i+s,this.pubSubService.publish("onPaginationChanged",this.getFullPagination())}}}class Bo{get eventHandler(){return this._eventHandler}get gridOptions(){return this._grid?.getOptions()??{}}get dataView(){return this._grid?.getData()}get gridUid(){return this._grid?.getUID()??""}get gridUidSelector(){return this.gridUid?`.${this.gridUid}`:""}get intervalRetryDelay(){return this._intervalRetryDelay}set intervalRetryDelay(e){this._intervalRetryDelay=e}get resizeByContentOptions(){return this.gridOptions?.resizeByContentOptions??{}}constructor(e){this.pubSubService=e,this._intervalRetryDelay=200,this._isStopResizeIntervalRequested=!1,this._hasResizedByContentAtLeastOnce=!1,this._totalColumnsWidthByContent=0,this._resizePaused=!1,this._subscriptions=[],this._eventHandler=new vn,this._bindingEventService=new Ft}dispose(){this._eventHandler?.unsubscribeAll(),this.pubSubService.unsubscribeAll(this._subscriptions),window.clearInterval(this._intervalId),window.clearTimeout(this._timer),"container"===this.gridOptions.autoResize?.resizeDetection&&this._resizeObserver&&this._resizeObserver.disconnect(),this._bindingEventService.unbindAll()}init(e,t){if(!e||!this.gridOptions||!t)throw new Error('\n      [Slickgrid-Universal] Resizer Service requires a valid Grid object and DOM Element Container to be provided.\n      You can fix this by setting your gridOption to use "enableAutoResize" or create an instance of the ResizerService by calling bindAutoResizeDataGrid() once.');this._grid=e,this._gridContainerElm=t;const i=this.gridOptions?.gridHeight||this.gridOptions?.gridWidth?{height:this.gridOptions?.gridHeight,width:this.gridOptions?.gridWidth}:void 0;this._autoResizeOptions=this.gridOptions?.autoResize??{container:"grid1",bottomPadding:0},i?.width&&t?.style&&(t.style.width="string"==typeof i.width?i.width:`${i.width}px`),this._gridDomElm=e.getContainerNode(),"string"==typeof this._autoResizeOptions.container?this._pageContainerElm="string"==typeof this._autoResizeOptions.container?document.querySelector(this._autoResizeOptions.container):this._autoResizeOptions.container:this._pageContainerElm=this._autoResizeOptions.container,i&&(this._fixedHeight=i.height,this._fixedWidth=i.width),this.gridOptions.enableAutoResize&&this.bindAutoResizeDataGrid(),this.gridOptions.autoResize&&this._subscriptions.push(this.pubSubService.subscribe("onFullResizeByContentRequested",(()=>this.resizeColumnsByCellContent(!0)))),this.gridOptions.enableColumnResizeOnDoubleClick&&(this._subscriptions.push(this.pubSubService.subscribe("onHeaderMenuColumnResizeByContent",(e=>{this.handleSingleColumnResizeByContent(e.columnId)}))),this._eventHandler.subscribe(this._grid.onColumnsResizeDblClick,((e,t)=>{this.handleSingleColumnResizeByContent(t.triggeredByColumn)})))}bindAutoResizeDataGrid(e){if("container"===this.gridOptions.autoResize?.resizeDetection){if(!this._pageContainerElm||!this._pageContainerElm)throw new Error('\n          [Slickgrid-Universal] Resizer Service requires a container when gridOption.autoResize.resizeDetection="container"\n          You can fix this by setting your gridOption.autoResize.container');this._resizeObserver||(this._resizeObserver=new ResizeObserver((()=>this.resizeObserverCallback()))),this._resizeObserver.observe(this._pageContainerElm)}else{if(void 0===this._gridDomElm)return null;this.resizeGrid().then((()=>this.resizeGridWhenStylingIsBrokenUntilCorrected())).catch((e=>console.log("Error:",e))),this.resizeGrid(10,e),this._bindingEventService.bind(window,"resize",(()=>{this.handleResizeGrid(e)}))}}handleResizeGrid(e){this.pubSubService.publish("onGridBeforeResize"),this._resizePaused||(this.resizeGrid(0,e),this.resizeGrid(0,e))}resizeObserverCallback(){this._resizePaused||this.resizeGrid()}calculateGridNewDimensions(e){const t=e?.autoResize??{},i=ne(this._gridDomElm);if(!window||!this._gridDomElm)return null;let n=void 0!==t?.bottomPadding?t.bottomPadding:20;if(n&&e.enablePagination&&(n+=35),n&&e.showCustomFooter){const e=this.gridOptions?.customFooterOptions?.footerHeight??25;n+=parseInt(`${e}`,10)}let s=0,r=0;"container"===t.calculateAvailableSizeBy?s=se(this._pageContainerElm,"height")||0:(s=window.innerHeight||0,r=i.top);const o=s-r-n,a=se(this._pageContainerElm,"width")||window.innerWidth||0,l=t?.maxHeight,c=t?.minHeight??180,h=t?.maxWidth,d=t?.minWidth??300;let u=o,p=t?.rightPadding?a-t.rightPadding:a;return u<c&&(u=c),l&&u>l&&(u=l),p<d&&(p=d),h&&p>h&&(p=h),{height:this._fixedHeight||u,width:this._fixedWidth||p}}getLastResizeDimensions(){return this._lastDimensions}pauseResizer(e){this._resizePaused=e}resizeGrid(e,t){return new Promise((i=>{(e=e||0)>0?(window.clearTimeout(this._timer),this._timer=window.setTimeout((()=>i(this.resizeGridCallback(t))),e)):i(this.resizeGridCallback(t))}))}resizeGridCallback(e){const t=this.resizeGridWithDimensions(e);return this.pubSubService.publish("onGridAfterResize",t),!this.gridOptions.enableAutoResizeColumnsByCellContent||this._lastDimensions?.width&&t?.width===this._lastDimensions?.width||this.resizeColumnsByCellContent(!1),this._lastDimensions=t,t}resizeGridWithDimensions(e){const t=this.calculateGridNewDimensions(this.gridOptions);if((e||t)&&this._gridDomElm){const i=e?.height?e.height:t?.height,n=e?.width?e.width:t?.width;this.gridOptions.autoHeight||(this._gridDomElm.style.height=`${i}px`),this._gridDomElm.style.width=`${n}px`,this._gridContainerElm&&(this._gridContainerElm.style.width=`${n}px`),this._grid?.resizeCanvas&&this._gridContainerElm&&this._grid.resizeCanvas(),this._grid&&this.gridOptions?.enableAutoSizeColumns?this.gridUid&&document.querySelector(this.gridUidSelector)&&(this._lastDimensions&&this._lastDimensions.height===i&&this._lastDimensions.width===n||this._grid.autosizeColumns()):!this.gridOptions.enableAutoResizeColumnsByCellContent||this._lastDimensions?.width&&n===this._lastDimensions?.width||this.resizeColumnsByCellContent(!1),this._lastDimensions={height:i||0,width:n||0}}return this._lastDimensions}requestStopOfAutoFixResizeGrid(e=!0){this._isStopResizeIntervalRequested=e}resizeColumnsByCellContent(e=!1){const t=this._grid.getColumns(),i=this.dataView.getItems(),n={};let s=!1,r=0;const o=this._gridContainerElm?.offsetWidth??0;if(!Array.isArray(i)||0===i.length||!e&&this._totalColumnsWidthByContent>0&&this._totalColumnsWidthByContent<o)return void this._grid.autosizeColumns();if(this._hasResizedByContentAtLeastOnce&&this.gridOptions?.resizeByContentOnlyOnFirstLoad&&!e)return;if(this.pubSubService.publish("onBeforeResizeByContent",void 0,0),0===this._totalColumnsWidthByContent||e){for(const e of t)n[e.id]=e.originalWidth??e.minWidth??0;r=this.calculateCellWidthByReadingDataset(t,n,this.resizeByContentOptions.maxItemToInspectCellContentWidth);let e=0;for(const i of t){const t=i.resizeAlwaysRecalculateWidth??this.resizeByContentOptions.alwaysRecalculateColumnWidth??!1;i.originalWidth&&!t?i.width=i.originalWidth:void 0!==n[i.id]&&(i.rerenderOnResize&&(s=!0),this.applyNewCalculatedColumnWidthByReference(i,n[i.id])),e+=i.width||0,this._totalColumnsWidthByContent=e}}this._grid.setColumns(t),this._hasResizedByContentAtLeastOnce=!0;const a={};for(const e of t)a[e.id]=e.width;this._totalColumnsWidthByContent>o?this._grid.reRenderColumns(s):this._grid.autosizeColumns(),this.pubSubService.publish("onAfterResizeByContent",{readItemCount:r,calculateColumnWidths:a})}calculateCellWidthByReadingDataset(e,t,i=1e3,n){const s=Array.isArray(e)?e:[e],r=this.dataView.getItems();let o=0;for(const[e,a]of r.entries()){if(e>i)break;Array.isArray(s)&&"object"==typeof t&&s.forEach(((i,s)=>{const r=this.calculateCellWidthByContent(a,i,e,n??s,t[i.id]);void 0!==r&&(t[i.id]=r)})),o=e+1}return o}calculateCellWidthByContent(e,t,i,n,s){const r=this.resizeByContentOptions.cellCharWidthInPx??7;if(!t.originalWidth){const o=t?.resizeCharWidthInPx??r,a=co(t?.formatter,i,n,t,e,this._grid),l=Le(a)?Qe(a):"",c=Math.ceil(l.length*o),h=t.resizeMaxWidthThreshold;t&&(void 0===s||c>s)&&(s=void 0!==h&&c>h?h:void 0!==t.maxWidth&&c>t.maxWidth?t.maxWidth:c)}return s}applyNewCalculatedColumnWidthByReference(e,t){const i=this.resizeByContentOptions.cellPaddingWidthInPx??6,n=this.resizeByContentOptions.formatterPaddingWidthInPx??6,s=e?.filter?.type??e?.type??b.string;let r=t;const o=e?.resizeCalcWidthRatio??this.resizeByContentOptions.defaultRatioForStringType??.9;r*="string"===s?o:1,r+=i,e.resizeExtraWidthPadding&&(r+=e.resizeExtraWidthPadding),e.editor&&this.gridOptions.editable&&(r+=n),void 0!==e.maxWidth&&r>e.maxWidth&&(r=e.maxWidth),void 0!==e.resizeMaxWidthThreshold&&r>e.resizeMaxWidthThreshold&&(r=e.resizeMaxWidthThreshold),r=Math.ceil(r),void 0!==e.originalWidth&&!0!==e.resizeAlwaysRecalculateWidth&&!0!==this.resizeByContentOptions.alwaysRecalculateColumnWidth||(e.width=this.readjustNewColumnWidthWhenOverLimit(e,r))}handleSingleColumnResizeByContent(e){const t=this._grid.getColumns(),i=t.findIndex((t=>t.id===e));if(i>=0){const n=t[i],s={[e]:n.originalWidth??n.minWidth??0};n.originalWidth=void 0,this.calculateCellWidthByReadingDataset(n,s,this.resizeByContentOptions.maxItemToInspectSingleColumnWidthByContent,i),this.applyNewCalculatedColumnWidthByReference(n,s[e]),this._grid.reRenderColumns(n?.rerenderOnResize??!1)}}readjustNewColumnWidthWhenOverLimit(e,t){const i=this.gridOptions.frozenColumn??-1,n=this._grid.getColumns().findIndex((t=>t.id===e.id))??0;let s=t;if(i>=0&&n<=i){const i=Array.from(this._grid.getViewports());if(i){const n=i.find((e=>e.classList.contains("slick-viewport-left")))?.clientWidth??0,r=i.find((e=>e.classList.contains("slick-viewport-right")))?.clientWidth??0,o=n+r,a=n-(e.width??0);a+t>o&&(s=n-a+r-(this.resizeByContentOptions.widthToRemoveFromExceededWidthReadjustment??50))}}return Math.ceil(s)}checkIsGridShown(){return!!document.querySelector(`${this.gridUidSelector}`)?.offsetParent}resizeGridWhenStylingIsBrokenUntilCorrected(){const e=this.gridOptions?.autoFixResizeTimeout??18e3,t=this.gridOptions?.autoFixResizeRequiredGoodCount??5,i=this._gridContainerElm.querySelector(`${this.gridUidSelector} .slick-header`),n=this._gridContainerElm.querySelector(`${this.gridUidSelector} .slick-viewport`);let s=0,r=0;if(i&&n&&this.gridOptions.autoFixResizeWhenBrokenStyleDetected){const o=this.dataView.getItemCount(),a=this._grid.getColumns()||[];this._intervalId=window.setInterval((async()=>{const l=ne(i);let c=l.top;this.gridOptions?.enableFiltering&&this.gridOptions.headerRowHeight&&(c+=this.gridOptions.headerRowHeight),this.gridOptions?.createPreHeaderPanel&&this.gridOptions.showPreHeaderPanel&&this.gridOptions.preHeaderPanelHeight&&(c+=this.gridOptions.preHeaderPanelHeight),c+=44;const h=ne(n).top,d=ne(this._gridContainerElm);let u=0===l?.top||c-h>2||0===d.left&&0===d.top;const p=this._grid.getRenderedRange()?.rightPx??0;!u&&o>0&&0===p&&a.length>1&&(u=!0),this._isStopResizeIntervalRequested&&(u=!1,s=e),this.checkIsGridShown()&&(u||0===d.left||0===d.top)&&(await this.resizeGrid(),r<5&&this._grid.updateColumns(),this.checkIsGridShown()&&(u=!1)),this.checkIsGridShown()&&r++,this.checkIsGridShown()&&!u&&(r>=t||s++>=e)&&window.clearInterval(this._intervalId)}),this.intervalRetryDelay)}}}class zo{constructor(){this.currentPagination=null,this.isItemsDateParsed=!1,this.frozenVisibleColumnId="",this.hasColumnsReordered=!1,this.hideHeaderRowAfterPageLoad=!1}get allColumns(){return this._allColumns}set allColumns(e){this._allColumns=e}get columnDefinitions(){return this.slickGrid?.getColumns()??[]}get gridOptions(){return this._gridOptions||this.slickGrid?.getOptions()||{}}set gridOptions(e){this._gridOptions=e}get externalRegisteredResources(){return this._externalRegisteredResources}set externalRegisteredResources(e){this._externalRegisteredResources=e}get visibleColumns(){return this._visibleColumns}set visibleColumns(e){this._visibleColumns=e}get hierarchicalDataset(){return this._hierarchicalDataset}set hierarchicalDataset(e){this._hierarchicalDataset=e}}class Vo{constructor(e,t,i,n,s){this.collectionService=e,this.sharedService=t,this.pubSubService=i,this.backendUtilities=n,this.rxjs=s,this._currentLocalSorters=[],this._isBackendGrid=!1,this._eventHandler=new vn,this.rxjs&&(this.httpCancelRequests$=this.rxjs.createSubject())}get eventHandler(){return this._eventHandler}get _gridOptions(){return this._grid?.getOptions()??{}}get _columnDefinitions(){return this._grid?.getColumns()??[]}dispose(){this._eventHandler?.unsubscribeAll&&this._eventHandler.unsubscribeAll(),this.httpCancelRequests$&&this.rxjs?.isObservable(this.httpCancelRequests$)&&(this.httpCancelRequests$.next(),this.httpCancelRequests$.complete())}addRxJsResource(e){this.rxjs=e}bindBackendOnSort(e){this._isBackendGrid=!0,this._grid=e,this._dataView=e?.getData(),this._eventHandler.subscribe(e.onSort,this.onBackendSortChanged.bind(this))}bindLocalOnSort(e){this._isBackendGrid=!1,this._grid=e,this._dataView=e?.getData(),this.processTreeDataInitialSort(),this._eventHandler.subscribe(e.onSort,this.handleLocalOnSort.bind(this)),this._gridOptions.preParseDateColumns&&(this._eventHandler.subscribe(e.onCellChange,((e,t)=>this.preParseSingleDateItem(t.item))),this.pubSubService.subscribe(["onItemAdded","onItemUpdated"],(e=>this.preParseSingleDateItem(e))))}preParseSingleDateItem(e){this._gridOptions.preParseDateColumns&&(Array.isArray(e)?e:[e]).forEach((e=>this.collectionService.parseSingleDateItem(e,this._grid,this._gridOptions.preParseDateColumns)))}preParseAllDateItems(){if(this._gridOptions.preParseDateColumns){const e=this._dataView?.getItems()||[];this.collectionService.preParseByMutationDateItems(e,this._grid,this._gridOptions.preParseDateColumns),this.sharedService.isItemsDateParsed=!0}}handleLocalOnSort(e,t){const i=t.multiColumnSort?t.sortCols:new Array({columnId:t.sortCol?.id??"",sortAsc:t.sortAsc,sortCol:t.sortCol});this._currentLocalSorters=[],Array.isArray(i)&&i.forEach((e=>{e.sortCol&&this._currentLocalSorters.push({columnId:e.sortCol.id,direction:e.sortAsc?E.ASC:E.DESC})})),this.onLocalSortChanged(this._grid,i),this.emitSortChanged(l.local)}clearSortByColumnId(e,t){const i=this.getCurrentColumnSorts(),n=this.getCurrentColumnSorts(`${t}`);if(Array.isArray(i)&&Array.isArray(n)&&i.length!==n.length){if(this._gridOptions.backendServiceApi)this.onBackendSortChanged(e,{multiColumnSort:!0,sortCols:n,grid:this._grid});else if(this._dataView)this.onLocalSortChanged(this._grid,n,!0,!0);else{const e=this._gridOptions.multiColumnSort?n:n[0];this._grid.onSort.notify(e)}const t=n.map((e=>({columnId:e?.sortCol?.id??"",sortAsc:e?.sortAsc,sortCol:e?.sortCol})));this._grid.setSortColumns(t)}Array.isArray(n)&&0===n.length&&this.sortLocalGridByDefaultSortFieldId()}clearSorting(e=!0){if(this._grid&&this._gridOptions&&this._dataView)if(this._grid.setSortColumns([]),e)this._isBackendGrid?this.onBackendSortChanged(void 0,{grid:this._grid,multiColumnSort:!0,sortCols:[],clearSortTriggered:!0}):this._columnDefinitions&&Array.isArray(this._columnDefinitions)&&this._columnDefinitions.length>0&&this.sortLocalGridByDefaultSortFieldId();else if(this._isBackendGrid){const e=this._gridOptions.backendServiceApi?.service;e?.clearSorters&&e.clearSorters()}this._currentLocalSorters=[],this.pubSubService.publish("onSortCleared",!0)}disableSortFunctionality(e=!0,t=!0){const i=!this._gridOptions.enableSorting;let n;this._gridOptions.enableSorting=i,e?(t&&this.clearSorting(),this._eventHandler.unsubscribeAll(),n=this.disableAllSortingCommands(!0)):(n=this.disableAllSortingCommands(!1),this._eventHandler.subscribe(this._grid.onSort,((e,t)=>this.handleLocalOnSort(e,t)))),this._grid.setOptions({enableSorting:this._gridOptions.enableSorting},!1,!0),this.sharedService.gridOptions=this._gridOptions,this._grid.setColumns(n)}toggleSortFunctionality(e=!0){const t=this._gridOptions.enableSorting;this.disableSortFunctionality(t,e)}emitSortChanged(e,t){if(e===l.remote&&this._gridOptions.backendServiceApi){let e=[];const t=this._gridOptions.backendServiceApi.service;t?.getCurrentSorters&&(e=t.getCurrentSorters()),this.pubSubService.publish("onSortChanged",e)}else e===l.local&&(t&&(this._currentLocalSorters=t),this.pubSubService.publish("onSortChanged",this.getCurrentLocalSorters()))}getCurrentLocalSorters(){return this._currentLocalSorters}getCurrentColumnSorts(e){if(this._grid){const t=this._grid.getSortColumns();if(Array.isArray(t))return t.reduce(((t,i)=>(!i||e&&i.columnId===e||t.push({columnId:i.columnId||"",sortCol:this._columnDefinitions[this._grid.getColumnIndex(i.columnId||"")],sortAsc:i.sortAsc}),t)),[])}return[]}loadGridSorters(e){this._currentLocalSorters=[];const t=[];return Array.isArray(e)&&((this._gridOptions.multiColumnSort?e:e.slice(0,1)).forEach((e=>{const i=this._columnDefinitions.find((t=>t.id===e.columnId));if(i){if(!i.sortable){let e="[Slickgrid-Universal] Cannot add sort icon to a column that is not sortable, please add `sortable: true` to your column or remove it from your list of columns to sort.";throw this._gridOptions.enableTreeData&&(e+=" Also note that TreeData feature requires the column holding the tree (expand/collapse icons) to be sortable."),new Error(e)}t.push({columnId:i.id,sortAsc:e.direction.toUpperCase()===E.ASC,sortCol:i}),this._currentLocalSorters.push({columnId:String(i.id),direction:e.direction.toUpperCase()})}})),this.onLocalSortChanged(this._grid,t),this._grid.setSortColumns(t.map((e=>({columnId:e.columnId,sortAsc:e.sortAsc}))))),t}processTreeDataInitialSort(){if(this._gridOptions.enableTreeData&&this._gridOptions.treeDataOptions){const e=this._gridOptions.treeDataOptions,t=this._columnDefinitions.find((t=>t.id===e.columnId));if(t){let i=E.ASC,n={columnId:e.columnId,sortCol:t,sortAsc:!0};if(e?.initialSort?.columnId){const t=e.initialSort.columnId,s=this._columnDefinitions.find((e=>e.id===t));i=(e.initialSort.direction||E.ASC).toUpperCase(),n={columnId:t,sortCol:s,sortAsc:i===E.ASC}}n?.columnId&&this.sharedService?.hierarchicalDataset&&this.updateSorting([{columnId:n.columnId||"",direction:i}])}}}onBackendSortChanged(e,t){if(!t||!t.grid)throw new Error('Something went wrong when trying to bind the "onBackendSortChanged(event, args)" function, it seems that "args" is not populated correctly');const i=t.grid?.getOptions()??{},n=i.backendServiceApi;if(!n||!n.process||!n.service)throw new Error('BackendServiceApi requires at least a "process" function and a "service" defined');const s=new Date;n.preProcess&&n.preProcess();const r=n.service.processOnSortChanged(e,t),o=i?.pagination?.totalItems||0;this.backendUtilities?.executeBackendCallback(n,r,t,s,o,{emitActionChangedCallback:this.emitSortChanged.bind(this),errorCallback:()=>{this._grid.setSortColumns(t.previousSortColumns||[]);const e=t.previousSortColumns?.map((e=>({columnId:e.columnId,sortAsc:e.sortAsc,sortCol:this._columnDefinitions.find((t=>t.id===e.columnId))})));n?.service?.updateSorters?.(e||[])},httpCancelRequestSubject:this.httpCancelRequests$})}async onLocalSortChanged(e,t,i=!1,n=!1){const s=this._gridOptions.datasetIdPropertyName||"id",r=this._gridOptions.enableTreeData||!1,o=e.getData();if(await this.pubSubService.publish("onBeforeSortChange",{sortColumns:t},0),e&&o){if(this._gridOptions.preParseDateColumns&&!this.sharedService.isItemsDateParsed&&t.some((e=>V(e.sortCol?.type)))&&this.preParseAllDateItems(),i&&!r&&o.reSort(),r&&this._dataView&&this.sharedService&&Array.isArray(this.sharedService.hierarchicalDataset)){const e=this.sortHierarchicalDataset(this.sharedService.hierarchicalDataset,t);this._dataView.setItems(e.flat,s),this._dataView.onRowCountChanged.notify({previous:this._dataView.getFilteredItemCount(),current:this._dataView.getLength(),itemCount:this._dataView.getItemCount(),dataView:this._dataView,callingOnRowsChanged:!0})}else o.sort(this.sortComparers.bind(this,t));e.invalidate(),n&&this.emitSortChanged(l.local,t.map((e=>({columnId:e.sortCol?.id??"id",direction:e.sortAsc?E.ASC:E.DESC}))))}}sortHierarchicalDataset(e,t,i=!1){this.sortTreeData(e,t);const n=this._gridOptions.datasetIdPropertyName||"id",s=this._gridOptions.treeDataOptions||{columnId:""},r=j(e,{...s,identifierPropName:s.identifierPropName??n,shouldAddTreeLevelNumber:!0});if(i){this._currentLocalSorters=[],t.forEach((e=>{this._currentLocalSorters.push({columnId:e.columnId,direction:e.sortAsc?"ASC":"DESC"})}));const e=this._gridOptions.backendServiceApi?l.remote:l.local;this.emitSortChanged(e)}return{hierarchical:e,flat:r}}sortLocalGridByDefaultSortFieldId(){const e=this._gridOptions&&this._gridOptions.defaultColumnSortFieldId||this._gridOptions.datasetIdPropertyName||"id",t={id:e,field:e};this.onLocalSortChanged(this._grid,new Array({columnId:t.id,sortAsc:!0,sortCol:t,clearSortTriggered:!0}),!1,!0)}sortComparers(e,t,i){if(Array.isArray(e))for(const n of e){const e=this.sortComparer(n,t,i);if(void 0!==e)return e}return x.neutral}sortComparer(e,t,i,n){if(e?.sortCol){const s=e.sortCol,r=s.type||b.string,o=e.sortAsc?x.asc:x.desc;let a=n||s.queryFieldSorter||s.queryField||s.field;this._gridOptions.preParseDateColumns&&V(r)&&e?.columnId&&(a="string"==typeof this._gridOptions.preParseDateColumns?`${this._gridOptions.preParseDateColumns}${e.columnId}`:`${e.columnId}`);let l=a;"function"==typeof s.queryFieldNameGetterFn&&(a=s.queryFieldNameGetterFn(t),l=s.queryFieldNameGetterFn(i));let c=t[a],h=i[l];if(a?.indexOf(".")>=0&&(c=H(t,a)),l?.indexOf(".")>=0&&(h=H(i,l)),s.sortComparer){const e=s.sortComparer(c,h,o,s,this._gridOptions);if(e!==x.neutral)return e}else{const e=Lt(r,c,h,o,s,this._gridOptions);if(e!==x.neutral)return e}}}sortTreeData(e,t){Array.isArray(t)&&t.forEach((t=>{this.sortTreeChildren(e,t,0)}))}sortTreeChildren(e,t,i){const n=this._gridOptions.treeDataOptions?.childrenPropName??"children";e.sort(((e,i)=>this.sortComparer(t,e,i)??x.neutral)),e.forEach((e=>{e&&e.hasOwnProperty(n)&&Array.isArray(e[n])&&(i++,this.sortTreeChildren(e[n],t,i),i--)}))}updateSorting(e,t=!0,i=!0){if(!this._gridOptions||!this._gridOptions.enableSorting)throw new Error('[Slickgrid-Universal] in order to use "updateSorting" method, you need to have Sortable Columns defined in your grid and "enableSorting" set in your Grid Options');if(Array.isArray(e)){const n=this._gridOptions.backendServiceApi;if(n){const t=n?.service;t?.updateSorters&&(t.updateSorters(void 0,e),i&&this.backendUtilities?.refreshBackendDataset(this._gridOptions))}else this.loadGridSorters(e);if(t){const e=n?l.remote:l.local;this.emitSortChanged(e)}}}disableAllSortingCommands(e=!0){const t=this._grid.getColumns();t.forEach((t=>{void 0!==t.sortable&&(t.sortable=!e),t?.header?.menu&&t.header.menu.commandItems?.forEach((t=>{if(t&&"string"!=typeof t){const i=t.command;"sort-asc"!==i&&"sort-desc"!==i&&"clear-sort"!==i||(t.hidden=e)}}))}));const i=this._gridOptions.gridMenu?.commandItems;return i&&i.forEach((t=>{t&&"string"!=typeof t&&"clear-sorting"===t.command&&(t.hidden=e)})),t}}class Wo{constructor(e,t,i){this.pubSubService=e,this.sharedService=t,this.sortService=i,this._currentToggledItems=[],this._isLastFullToggleCollapsed=!1,this._isOneCpuCyclePassed=!1,this._isTreeDataEnabled=!1,this._subscriptions=[],this._treeDataRecalcHandler=null,this._eventHandler=new vn,window.setTimeout((()=>this._isOneCpuCyclePassed=!0))}set currentToggledItems(e){this._currentToggledItems=e}get dataset(){return this.dataView?.getItems()}get datasetHierarchical(){return this.sharedService.hierarchicalDataset}get dataView(){return this._grid?.getData()}get eventHandler(){return this._eventHandler}get gridOptions(){return this._grid?.getOptions()??{}}get treeDataOptions(){return this.gridOptions.treeDataOptions}dispose(){this._eventHandler.unsubscribeAll(),this.pubSubService.unsubscribeAll(this._subscriptions)}init(e){if(this._grid=e,this._isTreeDataEnabled=this.gridOptions?.enableTreeData??!1,this._isLastFullToggleCollapsed=this.treeDataOptions?.initiallyCollapsed??!1,this._currentToggledItems=this.gridOptions.presets?.treeData?.toggledItems??[],this._lastToggleStateChange={type:this._isLastFullToggleCollapsed?"full-collapse":"full-expand",previousFullToggleType:this._isLastFullToggleCollapsed?"full-collapse":"full-expand",toggledItems:this._currentToggledItems},this._isTreeDataEnabled){if(this.gridOptions?.multiColumnSort)throw new Error('[Slickgrid-Universal] It looks like you are trying to use Tree Data with multi-column sorting, unfortunately it is not supported because of its complexity, you can disable it via "multiColumnSort: false" grid option and/or help in providing support for this feature.');if(!this.gridOptions?.enableFiltering)throw new Error('[Slickgrid-Universal] It looks like you are trying to use Tree Data without using the filtering option, unfortunately that is not possible with Tree Data since it relies heavily on the filters to expand/collapse the tree. You need to enable it via "enableFiltering: true"');if(this.gridOptions?.backendServiceApi||this.gridOptions?.enablePagination)throw new Error("[Slickgrid-Universal] It looks like you are trying to use Tree Data with Pagination and/or a Backend Service (OData, GraphQL) but unfortunately that is simply not supported because of its complexity.");if(!this.gridOptions.treeDataOptions||!this.gridOptions.treeDataOptions.columnId)throw new Error('[Slickgrid-Universal] When enabling tree data, you must also provide the "treeDataOption" property in your Grid Options with "childrenPropName" or "parentPropName" (depending if your array is hierarchical or flat) for the Tree Data to work properly.')}this._eventHandler.subscribe(e.onClick,this.handleOnCellClick.bind(this)),this._subscriptions.push(this.pubSubService.subscribe("onGridMenuClearAllSorting",this.clearSorting.bind(this))),this._treeDataRecalcHandler=this.setAutoRecalcTotalsCallbackWhenFeatEnabled(this.gridOptions),this._eventHandler.subscribe(this.dataView.onRowCountChanged,(()=>{"function"==typeof this._treeDataRecalcHandler&&this._isOneCpuCyclePassed&&(window.clearTimeout(this._timer),this._timer=window.setTimeout((()=>this._treeDataRecalcHandler?.()),this.treeDataOptions?.autoRecalcTotalsDebounce??0))}))}applyToggledItemStateChanges(e,t,i=!0,n=!1){if(Array.isArray(e)){const s=R(this.treeDataOptions,"collapsedPropName"),r=R(this.treeDataOptions,"hasChildrenPropName");this.dataView.beginUpdate(!0);const o="full-collapse"===(t??this._lastToggleStateChange.previousFullToggleType);t&&(this._lastToggleStateChange.previousFullToggleType=t),i&&(this.dataView.getItems()||[]).forEach((e=>{e[r]&&(e[s]=o)})),this.dynamicallyToggleItemState(e,n)}}dynamicallyToggleItemState(e,t=!0){Array.isArray(e)&&(this.dataView.beginUpdate(!0),e.forEach((e=>{const i=this.dataView.getItemById(e.itemId);if(this.updateToggledItem(i,e.isCollapsed,!0),t){const t=this._currentToggledItems.findIndex((t=>t.itemId===e.itemId));t>=0?this._currentToggledItems[t].isCollapsed=e.isCollapsed:this._currentToggledItems.push({itemId:e.itemId,isCollapsed:e.isCollapsed}),this.pubSubService.publish("onTreeItemToggled",{...this._lastToggleStateChange,fromItemId:e.itemId,toggledItems:this._currentToggledItems,type:e.isCollapsed?T.toggleCollapse:T.toggleExpand})}})),this.dataView.endUpdate(),this.dataView.refresh())}getCurrentToggleState(){return this._lastToggleStateChange}getInitialSort(e,t){const i=t?.treeDataOptions,n=i?.initialSort??{columnId:i?.columnId??"",direction:"ASC"},s=e.find((e=>e.id===n.columnId));return{columnId:n.columnId,sortAsc:"DESC"!==n?.direction?.toUpperCase(),sortCol:s}}getItemCount(e){if(void 0!==e){const t=R(this.treeDataOptions,"levelPropName");return this.dataView.getItems().filter((i=>i[t]===e)).length}return this.dataView.getItemCount()}getToggledItems(){return this._currentToggledItems}clearSorting(){const e=this.getInitialSort(this.sharedService.columnDefinitions,this.sharedService.gridOptions);this.sortService.loadGridSorters([{columnId:e.columnId,direction:e.sortAsc?"ASC":"DESC"}])}convertFlatParentChildToTreeDatasetAndSort(e,t,i,n){const s=this.convertFlatParentChildToTreeDataset(e,i),r=Array.isArray(n)&&n.length?n[0]:this.getInitialSort(t,i),o=this.sortService.sortHierarchicalDataset(s,[r],!0);return this._grid?.setSortColumns([r]),o}convertFlatParentChildToTreeDataset(e,t){const i=t?.datasetIdPropertyName??"id",n=t?.treeDataOptions??{columnId:"id"};return L(e,{...n,identifierPropName:n.identifierPropName??i,initiallyCollapsed:this._isLastFullToggleCollapsed})}enableAutoRecalcTotalsFeature(e=!0){e&&this._isTreeDataEnabled?this._treeDataRecalcHandler=this.recalculateTreeTotals.bind(this,this.gridOptions):this._treeDataRecalcHandler=null}recalculateTreeTotals(e){const t=e.treeDataOptions,i=t?.childrenPropName??m.treeDataProperties.CHILDREN_PROP,n=t?.levelPropName??m.treeDataProperties.TREE_LEVEL_PROP;t?.aggregators&&(t.aggregators.forEach((e=>{D(this.sharedService.hierarchicalDataset||[],{childrenPropName:i,levelPropName:n,aggregator:e})})),this._grid.invalidate())}sortHierarchicalDataset(e,t){const i=t??this.getInitialSort(this.sharedService.allColumns,this.gridOptions),n=Array.isArray(i)?i:[i];return this.sortService.sortHierarchicalDataset(e,n)}async toggleTreeDataCollapse(e,t=!0){if(this.gridOptions?.enableTreeData){const i=R(this.treeDataOptions,"hasChildrenPropName");t&&await this.pubSubService.publish("onTreeFullToggleStart",{collapsing:e}),this.dataView.beginUpdate(!0);const n=this.dataView.getItems()||[];n.forEach((t=>{t[i]&&this.updateToggledItem(t,e,!1)})),this.sharedService.hierarchicalDataset=this.convertFlatParentChildToTreeDataset(n,this.gridOptions),this.dataView.endUpdate(),this.dataView.refresh(),this._isLastFullToggleCollapsed=e}const i=e?T.fullCollapse:T.fullExpand;this._lastToggleStateChange={type:i,previousFullToggleType:i,toggledItems:null},t&&this.pubSubService.publish("onTreeFullToggleEnd",this._lastToggleStateChange)}handleOnCellClick(e,t){if(e&&t){const i=e.target||{},n=this.gridOptions.datasetIdPropertyName??"id",s=R(this.treeDataOptions,"collapsedPropName"),r=R(this.treeDataOptions,"childrenPropName");if("string"==typeof i?.className&&i.className.indexOf("toggle")>=0){const i=this.dataView.getItem(t.row);if(i){i[s]=!i[s];const e=i[s],t=i[n],o=this._currentToggledItems.findIndex((e=>e.itemId===t));o>=0?this._currentToggledItems[o].isCollapsed=e:this._currentToggledItems.push({itemId:t,isCollapsed:e}),this.dataView.updateItem(t,i);const a=e=>e[n]===t,l=M(this.sharedService.hierarchicalDataset||[],a,r);l&&(l[s]=e),this._grid.invalidate(),this._lastToggleStateChange={type:e?T.toggleCollapse:T.toggleExpand,previousFullToggleType:this._isLastFullToggleCollapsed?"full-collapse":"full-expand",toggledItems:this._currentToggledItems},this.pubSubService.publish("onTreeItemToggled",{...this._lastToggleStateChange,fromItemId:t})}e.stopImmediatePropagation()}}}updateToggledItem(e,t,i){const n=this.gridOptions?.datasetIdPropertyName??"id",s=R(this.treeDataOptions,"childrenPropName"),r=R(this.treeDataOptions,"collapsedPropName");if(e&&(e[r]=t,this.dataView.updateItem(e[n],e),i)){const i=t=>t[n]===e[n],o=M(this.sharedService.hierarchicalDataset||[],i,s);o&&(o[r]=t)}}setAutoRecalcTotalsCallbackWhenFeatEnabled(e){return e?.enableTreeData&&e?.treeDataOptions?.autoRecalcTotalsOnFilterChange&&e?.treeDataOptions?.aggregators?this.recalculateTreeTotals.bind(this,e):null}}class $o{constructor(e){this.translaterService=e,this._debounceTypingDelay=0,this._shouldTriggerQuery=!0,this._inputType="text",this.inputFilterType="single",this.searchTerms=[],this._bindEventService=new Ft}get columnFilter(){return this.columnDef?.filter??{}}get defaultOperator(){return S.empty}get inputType(){return this._inputType}set inputType(e){this._inputType=e}get operator(){return this.columnFilter?.operator??this.defaultOperator}set operator(e){this.columnFilter&&(this.columnFilter.operator=e)}get gridOptions(){return this.grid?.getOptions()??{}}init(e){if(!e)throw new Error('[Slickgrid-Universal] A filter must always have an "init()" with valid arguments.');this.grid=e.grid,this.callback=e.callback,this.columnDef=e.columnDef,"compound"===this.inputFilterType&&(this.operator=e.operator||""),this.searchTerms=e?.searchTerms??[],this._cellContainerElm=e.filterContainerElm;const t=this.gridOptions?.backendServiceApi;this._debounceTypingDelay=(t?t?.filterTypingDebounce??this.gridOptions?.defaultBackendServiceFilterTypingDebounce:this.gridOptions?.filterTypingDebounce)??0;const i=Array.isArray(this.searchTerms)&&this.searchTerms.length>=0?this.searchTerms[0]:"";this.createDomFilterElement(i),this._bindEventService.bind(this._filterInputElm,["keyup","blur","change"],this.onTriggerEvent.bind(this)),this._bindEventService.bind(this._filterInputElm,"wheel",this.onTriggerEvent.bind(this),{passive:!0}),"compound"===this.inputFilterType&&this._selectOperatorElm&&this._bindEventService.bind(this._selectOperatorElm,"change",this.onTriggerEvent.bind(this))}clear(e=!0){this._filterInputElm&&(this._shouldTriggerQuery=e,this.searchTerms=[],this._filterInputElm.value="",this._currentValue=void 0,this.updateFilterStyle(!1),"compound"===this.inputFilterType&&this._selectOperatorElm&&(this._selectOperatorElm.selectedIndex=0),this.onTriggerEvent(void 0,!0))}destroy(){this._bindEventService.unbindAll(),this._selectOperatorElm?.remove?.(),this._filterInputElm?.remove?.()}getValues(){return this._filterInputElm.value}setValues(e,t,i=!1){const n=Array.isArray(e)?e:[e];let s="";for(const e of n)s="single"===this.inputFilterType?t?this.addOptionalOperatorIntoSearchString(e,t):e:`${e}`,this._filterInputElm.value=`${s??""}`,this._currentValue=this._filterInputElm.value;if(this.updateFilterStyle(""!==this.getValues()),this.operator=t||this.defaultOperator,t&&this._selectOperatorElm){const e=$(this.operator);this._selectOperatorElm.value=e}i&&this.onTriggerEvent(void 0,!1)}addOptionalOperatorIntoSearchString(e,t){let i="",n="",s=null==e?"":`${e}`;if(t&&s){switch(t){case"<>":case"!=":case"=":case"==":case">":case">=":case"<":case"<=":i=t;break;case"EndsWith":case"*z":i="*";break;case"StartsWith":case"a*":n="*"}s=`${i}${s}${n}`}return s}getCompoundOperatorOptionValues(){const e=this.columnDef.type&&this.columnDef.type?this.columnDef.type:b.string;let t,i="text";if(this.columnFilter?.compoundOperatorList)t=this.columnFilter.compoundOperatorList;else switch(e){case b.string:case b.text:case b.readonly:case b.password:i="text",t=[{operator:"",desc:Ut("CONTAINS","TEXT_CONTAINS","Contains",n=this.gridOptions,s=this.translaterService)},{operator:"<>",desc:Ut("NOT_CONTAINS","TEXT_NOT_CONTAINS","Not Contains",n,s)},{operator:"=",desc:Ut("EQUALS","TEXT_EQUALS","Equals",n,s)},{operator:"!=",desc:Ut("NOT_EQUAL_TO","TEXT_NOT_EQUAL_TO","Not equal to",n,s)},{operator:"a*",desc:Ut("STARTS_WITH","TEXT_STARTS_WITH","Starts with",n,s)},{operator:"*z",desc:Ut("ENDS_WITH","TEXT_ENDS_WITH","Ends with",n,s)}];break;default:i="numeric",t=qt(this.gridOptions,this.translaterService)}var n,s;return Gt(this.gridOptions,t,i),t}createDomFilterElement(e){const t=this.columnDef?.id??"";ee(this._cellContainerElm);let i=this.gridOptions?.defaultFilterPlaceholder??"";this.columnFilter?.placeholder&&(i=this.columnFilter.placeholder);const n=`${e??""}`;if(this._filterInputElm=Z("input",{type:this._inputType||"text",autocomplete:"off",ariaAutoComplete:"none",placeholder:i,ariaLabel:this.columnFilter?.ariaLabel??`${We(t+"")} Search Filter`,className:`form-control filter-${t}`,value:n,dataset:{columnid:`${t}`}}),this.updateFilterStyle(!!e),void 0!==e&&(this._currentValue=n),"single"===this.inputFilterType)this._filterContainerElm=this._filterInputElm,this._filterInputElm.classList.add("search-filter"),this._cellContainerElm.appendChild(this._filterInputElm),this._cellContainerElm.appendChild(document.createElement("span"));else{this._filterInputElm.classList.add("compound-input"),this._selectOperatorElm=Wt(this.getCompoundOperatorOptionValues(),this.grid),this._filterContainerElm=Z("div",{className:`form-group search-filter filter-${t}`});const e=Z("div",{className:"input-group"},this._filterContainerElm);Z("div",{className:"input-group-addon input-group-prepend operator"},e).appendChild(this._selectOperatorElm),e.appendChild(this._filterInputElm),e.appendChild(Z("span")),this.operator&&(this._selectOperatorElm.value=$(this.operator)),this._filterContainerElm&&this._cellContainerElm.appendChild(this._filterContainerElm)}}onTriggerEvent(e,t=!1){if(t)this.callback(e,{columnDef:this.columnDef,clearFilterTriggered:t,shouldTriggerQuery:this._shouldTriggerQuery}),this.updateFilterStyle(!1);else{const t=e?.type??"",i=this._selectOperatorElm?.value??this.operator;let n=this._filterInputElm.value;const s=this.gridOptions.enableFilterTrimWhiteSpace||this.columnFilter.enableTrimWhiteSpace;"string"==typeof n&&s&&(n=n.trim()),"select"!==e?.target?.tagName.toLowerCase()&&(this._currentValue=n),this.updateFilterStyle(""!==n);const r={columnDef:this.columnDef,operator:i,searchTerms:n?[n]:null,shouldTriggerQuery:this._shouldTriggerQuery},o="keyup"===t&&"Enter"!==e?.key?this._debounceTypingDelay:0,a=this.columnFilter.skipCompoundOperatorFilterWithNullInput??this.gridOptions.skipCompoundOperatorFilterWithNullInput,l=a&&ke(this._currentValue)||""===this._currentValue&&ke(this._lastSearchValue);"single"!==this.inputFilterType&&a&&!l||(o>0?(window.clearTimeout(this._timer),this._timer=window.setTimeout((()=>this.callback(e,r)),o)):this.callback(e,r)),this._lastSearchValue=n}this._shouldTriggerQuery=!0}updateFilterStyle(e){e?(this._filterContainerElm?.classList.add("filled"),this._filterInputElm.classList.add("filled")):(this._filterContainerElm?.classList.remove("filled"),this._filterInputElm.classList.remove("filled"))}}class Uo extends $o{constructor(e){super(e),this.translaterService=e,this.inputType="text",this.inputFilterType="compound"}}const qo="#86bff8";class Go{constructor(e){this.translaterService=e,this._clearFilterTriggered=!1,this._shouldTriggerQuery=!0,this._sliderTrackFilledColor=qo,this.sliderType="double",this.searchTerms=[],this._bindEventService=new Ft}get columnFilter(){return this.columnDef?.filter??{}}get currentValue(){return this._currentValue}get currentValues(){return this._currentValues}get defaultOperator(){return"compound"===this.sliderType?S.empty:"single"===this.sliderType?S.greaterThanOrEqual:this.gridOptions.defaultFilterRangeOperator||S.rangeInclusive}get filterOptions(){return{...this.gridOptions.defaultFilterOptions?.slider,...this.columnFilter?.filterOptions}}get gridOptions(){return this.grid?.getOptions()??{}}get sliderOptions(){return this._sliderOptions}get operator(){return this._operator||(this.columnFilter.operator??this.defaultOperator)}set operator(e){this._operator=e}init(e){if(!e)throw new Error('[Slickgrid-Universal] A filter must always have an "init()" with valid arguments.');this.grid=e.grid,this.callback=e.callback,this.columnDef=e.columnDef,this.operator=e.operator||"",this.searchTerms=e?.searchTerms??[],this._argFilterContainerElm=e.filterContainerElm,this._sliderTrackFilledColor=window.getComputedStyle(document.documentElement).getPropertyValue("--slick-slider-filter-filled-track-color")||qo,this._filterElm=this.createDomFilterElement(this.searchTerms)}clear(e=!0){if(this._filterElm){this._clearFilterTriggered=!0,this._shouldTriggerQuery=e,this.searchTerms=[];const t=+(this.filterOptions?.sliderStartValue??m.SLIDER_DEFAULT_MIN_VALUE),i=+(this.filterOptions?.sliderEndValue??m.SLIDER_DEFAULT_MAX_VALUE);"double"===this.sliderType?(this._sliderLeftInputElm&&(this._sliderLeftInputElm.value=`${t}`),this._sliderRightInputElm&&(this._sliderRightInputElm.value=`${i}`),this._currentValues=[t,i],this._sliderLeftInputElm?.dispatchEvent(new Event("change")),this._sliderRightInputElm?.dispatchEvent(new Event("change"))):(this._sliderRightInputElm&&(this._sliderRightInputElm.value=`${t}`),this._selectOperatorElm&&(this._selectOperatorElm.selectedIndex=0),this._currentValue=t,this._sliderRightInputElm?.dispatchEvent(new Event("change"))),(this.filterOptions?.hideSliderNumber??this.filterOptions?.hideSliderNumbers)||("double"===this.sliderType?this.renderSliderValues(t,i):this.renderSliderValues(void 0,t)),this.updateFilterStyle(!1),this.callback(void 0,{columnDef:this.columnDef,clearFilterTriggered:!0,shouldTriggerQuery:e,searchTerms:[]})}}destroy(){this._bindEventService.unbindAll(),this._sliderTrackElm?.remove(),this._sliderLeftInputElm?.remove(),this._sliderRightInputElm?.remove()}renderSliderValues(e,t,i=!0){const n=e?.toString()||"",s=t?.toString()||"";this._leftSliderNumberElm?.textContent&&(this._leftSliderNumberElm.textContent=n),this._rightSliderNumberElm?.textContent&&(this._rightSliderNumberElm.textContent=s),this._sliderRangeContainElm.title="double"===this.sliderType?`${n} - ${s}`:`${s}`,i&&this.grid.onHeaderRowMouseLeave.notify({column:this.columnDef,grid:this.grid})}getValues(){return"double"===this.sliderType?this._currentValues:this._currentValue}setValues(e,t,i=!1){if(e){let t=[];const i=Array.isArray(e)?e?.[0]:e;if(Array.isArray(e)&&2===e.length?t=e:"string"==typeof i&&i.indexOf("..")>0?(t=i.split(".."),this._currentValue=+(t?.[0]??0)):(ke(i)||""===i)&&(this._currentValue=null===i?void 0:+i,t=[i]),"double"!==this.sliderType&&this._sliderRightInputElm)this._sliderRightInputElm.value="string"==typeof e?e:`${i}`,this.renderSliderValues(void 0,this._sliderRightInputElm.value);else if(Array.isArray(t)&&2===t.length&&!this.filterOptions?.hideSliderNumbers){const[e,i]=t;this._sliderLeftInputElm&&(this._sliderLeftInputElm.value=String(e??m.SLIDER_DEFAULT_MIN_VALUE)),this._sliderRightInputElm&&(this._sliderRightInputElm.value=String(i??m.SLIDER_DEFAULT_MAX_VALUE)),this.renderSliderValues(...t)}}else this._currentValue=void 0,this._currentValues=void 0;const n=this.getValues(),s=void 0===n?[]:Array.isArray(n)?n:[n];if(this.updateFilterStyle(s.length>0),void 0!==t&&(this.operator=t),this.operator&&this._selectOperatorElm){const e=$(this.operator);this._selectOperatorElm.value=e}i&&this.callback(void 0,{columnDef:this.columnDef,operator:this.operator,searchTerms:s,shouldTriggerQuery:!0})}createDomFilterElement(e){const t=this.columnDef?.id??"",i=+(this.columnFilter.minValue??m.SLIDER_DEFAULT_MIN_VALUE),n=+(this.columnFilter.maxValue??m.SLIDER_DEFAULT_MAX_VALUE),s=+(this.columnFilter.valueStep??m.SLIDER_DEFAULT_STEP);ee(this._argFilterContainerElm);const r=+((Array.isArray(e)&&e?.[0])??this.filterOptions?.sliderStartValue??i),o=+((Array.isArray(e)&&e?.[1])??this.filterOptions?.sliderEndValue??n);if(this._sliderRangeContainElm=Z("div",{className:`filter-input filter-${t} slider-input-container slider-values`,title:"double"===this.sliderType?`${r} - ${o}`:`${r}`}),this._sliderTrackElm=Z("div",{className:"slider-track"}),"compound"===this.sliderType){const e=Z("span",{className:"input-group-addon input-group-prepend operator"});this._selectOperatorElm=Wt(this.getOperatorOptionValues(),this.grid),e.appendChild(this._selectOperatorElm)}"double"===this.sliderType&&(this._sliderLeftInputElm=Z("input",{type:"range",className:"slider-filter-input",ariaLabel:this.columnFilter.ariaLabel??`${We(t+"")} Search Filter`,defaultValue:`${r}`,value:`${r}`,min:`${i}`,max:`${n}`,step:`${s}`}));const a="double"===this.sliderType?o:r;this._sliderRightInputElm=Z("input",{type:"range",className:"slider-filter-input",ariaLabel:this.columnFilter.ariaLabel??`${We(t+"")} Search Filter`,defaultValue:`${a}`,value:`${a}`,min:`${i}`,max:`${n}`,step:`${s}`});const l=this.filterOptions?.hideSliderNumber??this.filterOptions?.hideSliderNumbers,c=l?"":"input-group";if(this._divContainerFilterElm=Z("div",{className:`${c} search-filter slider-container slider-values filter-${t}`.trim()}),this._sliderRangeContainElm.appendChild(this._sliderTrackElm),"double"===this.sliderType&&this._sliderLeftInputElm&&this._sliderRangeContainElm.appendChild(this._sliderLeftInputElm),this._sliderRangeContainElm.appendChild(this._sliderRightInputElm),l)this._divContainerFilterElm.appendChild(this._sliderRangeContainElm);else{let e;"compound"===this.sliderType&&this._selectOperatorElm?(e=Z("span",{className:"input-group-addon input-group-prepend operator"}),e.appendChild(this._selectOperatorElm)):"double"===this.sliderType&&(e=Z("div",{className:"input-group-addon input-group-prepend slider-range-value"}),this._leftSliderNumberElm=Z("span",{className:`input-group-text lowest-range-${t}`,textContent:`${r}`}),e.appendChild(this._leftSliderNumberElm));const i=Z("div",{className:"input-group-addon input-group-append slider-range-value"});this._rightSliderNumberElm=Z("span",{className:`input-group-text highest-range-${t}`,textContent:`${a}`},i),e&&this._divContainerFilterElm.appendChild(e),this._divContainerFilterElm.appendChild(this._sliderRangeContainElm),this._divContainerFilterElm.appendChild(i)}return this._sliderOptions={minValue:i,maxValue:n,step:s},this._currentValues=[r,o],Array.isArray(e)&&e.length>0&&""!==e[0]&&(this.updateFilterStyle(!0),this._currentValue=r),void 0===this.filterOptions.sliderStartValue&&void 0===this.columnFilter.minValue||(this._currentValue=r),this._argFilterContainerElm.appendChild(this._divContainerFilterElm),this.updateTrackFilledColorWhenEnabled(),this._bindEventService.bind(this._sliderTrackElm,"click",this.sliderTrackClicked.bind(this)),this._bindEventService.bind(this._sliderRightInputElm,["input","change"],this.slideRightInputChanged.bind(this)),this._bindEventService.bind(this._sliderRightInputElm,["change","mouseup","touchend"],this.onValueChanged.bind(this)),"compound"===this.sliderType&&this._selectOperatorElm?this._bindEventService.bind(this._selectOperatorElm,["change"],this.onValueChanged.bind(this)):"double"===this.sliderType&&this._sliderLeftInputElm&&(this._bindEventService.bind(this._sliderLeftInputElm,["input","change"],this.slideLeftInputChanged.bind(this)),this._bindEventService.bind(this._sliderLeftInputElm,["change","mouseup","touchend"],this.onValueChanged.bind(this))),this._divContainerFilterElm}getOperatorOptionValues(){let e;return e=this.columnFilter.compoundOperatorList?this.columnFilter.compoundOperatorList:qt(this.gridOptions,this.translaterService),Gt(this.gridOptions,e,"numeric"),e}onValueChanged(e){const t=parseInt(this._sliderRightInputElm?.value??"",10);let i,n;if("compound"===this.sliderType||"single"===this.sliderType)"select"!==e?.target?.tagName?.toLowerCase()&&(this._currentValue=+t),i=this._currentValue,n=[i||"0"];else if("double"===this.sliderType){const e=[parseInt(this._sliderLeftInputElm?.value??"",10),t];i=e.join(".."),n=e}if(this._clearFilterTriggered)this.updateFilterStyle(!1),this.callback(e,{columnDef:this.columnDef,clearFilterTriggered:this._clearFilterTriggered,searchTerms:[],shouldTriggerQuery:this._shouldTriggerQuery});else{const t=this._selectOperatorElm?.value??this.operator;this.updateFilterStyle(""!==i);const s=this.columnFilter.skipCompoundOperatorFilterWithNullInput??this.gridOptions.skipCompoundOperatorFilterWithNullInput,r=s&&ke(this._currentValue)||!ke(this._currentValue)&&ke(this._lastSearchValue);"compound"===this.sliderType&&s&&!r||this.callback(e,{columnDef:this.columnDef,operator:t||"",searchTerms:n,shouldTriggerQuery:this._shouldTriggerQuery})}this._clearFilterTriggered=!1,this._shouldTriggerQuery=!0,this.changeBothSliderFocuses(!1),this.grid.onHeaderRowMouseEnter.notify({column:this.columnDef,grid:this.grid},new mn(e)),this._lastSearchValue=i}changeBothSliderFocuses(e){const t=e?"add":"remove";this._sliderLeftInputElm?.classList[t]("focus"),this._sliderRightInputElm?.classList[t]("focus")}slideLeftInputChanged(e){const t=parseInt(this._sliderLeftInputElm?.value??"",10),i=parseInt(this._sliderRightInputElm?.value??"",10);this._sliderLeftInputElm&&i-t<=(this.filterOptions?.stopGapBetweenSliderHandles??0)&&(this._sliderLeftInputElm.value=String(t-(this.filterOptions?.stopGapBetweenSliderHandles??0))),this._sliderLeftInputElm&&this._sliderRightInputElm&&(+this._sliderLeftInputElm.value>=+this._sliderRightInputElm.value-20?(this._sliderLeftInputElm.style.zIndex="1",this._sliderRightInputElm.style.zIndex="0"):(this._sliderLeftInputElm.style.zIndex="0",this._sliderRightInputElm.style.zIndex="1")),this.sliderLeftOrRightChanged(e,"left",t,i)}slideRightInputChanged(e){const t=parseInt(this._sliderLeftInputElm?.value??"",10),i=parseInt(this._sliderRightInputElm?.value??"",10);"double"===this.sliderType&&this._sliderRightInputElm&&i-t<=(this.filterOptions?.stopGapBetweenSliderHandles??0)&&(this._sliderRightInputElm.value=String(t+(this.filterOptions?.stopGapBetweenSliderHandles??0))),this.sliderLeftOrRightChanged(e,"right",t,i)}sliderLeftOrRightChanged(e,t,i,n){let s=!0;this.updateTrackFilledColorWhenEnabled(),this.changeBothSliderFocuses(!0),this._sliderRangeContainElm.title="double"===this.sliderType?`${i} - ${n}`:`${n}`,"double"===this.sliderType&&this._sliderLeftInputElm&&this._sliderRightInputElm&&("left"===t&&i>n?(this._sliderLeftInputElm.value=`${n}`,s=!1):"right"===t&&i>n&&(this._sliderRightInputElm.value=`${i}`,s=!1)),(this.filterOptions?.hideSliderNumber??this.filterOptions?.hideSliderNumbers)||(this._leftSliderNumberElm?.textContent&&(this._leftSliderNumberElm.textContent=this._sliderLeftInputElm?.value??""),this._rightSliderNumberElm?.textContent&&(this._rightSliderNumberElm.textContent=this._sliderRightInputElm?.value??"")),s&&this.grid.onHeaderRowMouseEnter.notify({column:this.columnDef,grid:this.grid},new mn(e))}sliderTrackClicked(e){e.preventDefault();const t=100*(e.offsetX+0)/this._sliderTrackElm.offsetWidth;this._sliderRightInputElm&&"double"!==this.sliderType?(this._sliderRightInputElm.value=`${t}`,this._sliderRightInputElm.dispatchEvent(new Event("change"))):this._sliderLeftInputElm&&this._sliderRightInputElm&&(t<=50?(this._sliderLeftInputElm.value=`${t}`,this._sliderLeftInputElm.dispatchEvent(new Event("change"))):(this._sliderRightInputElm.value=`${t}`,this._sliderRightInputElm.dispatchEvent(new Event("change"))))}updateTrackFilledColorWhenEnabled(){if(this.filterOptions?.enableSliderTrackColoring&&this._sliderRightInputElm){let e=0;this._sliderLeftInputElm&&(e=(+this._sliderLeftInputElm.value-+this._sliderLeftInputElm.min)/(this.sliderOptions?.maxValue??0-+this._sliderLeftInputElm.min)*100);const t=(+this._sliderRightInputElm.value-+this._sliderRightInputElm.min)/(this.sliderOptions?.maxValue??0-+this._sliderRightInputElm.min)*100,i="linear-gradient(to right, %b %p1, %c %p1, %c %p2, %b %p2)".replace(/%b/g,"#eee").replace(/%c/g,this.filterOptions?.sliderTrackFilledColor||this._sliderTrackFilledColor||qo).replace(/%p1/g,`${e}%`).replace(/%p2/g,`${t}%`);this._sliderTrackElm.style.background=i,this._sliderOptions.sliderTrackBackground=i}}updateFilterStyle(e){e?(this._divContainerFilterElm.classList.add("filled"),this._filterElm?.classList.add("filled")):(this._divContainerFilterElm.classList.remove("filled"),this._filterElm?.classList.remove("filled"))}}var Ko=Object.defineProperty,Yo=(e,t,i)=>((e,t,i)=>t in e?Ko(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i)(e,"symbol"!=typeof t?t+"":t,i),Xo=class{constructor(e){Yo(this,"_distinctEvent"),Yo(this,"_boundedEvents",[]),this._distinctEvent=e?.distinctEvent??!1}get boundedEvents(){return this._boundedEvents}dispose(){this.unbindAll(),this._boundedEvents=[]}bind(e,t,i,n,s=""){let r=Array.isArray(t)?t:[t];if("function"==typeof e?.forEach)e.forEach((e=>{for(let t of r)(!this._distinctEvent||this._distinctEvent&&!this.hasBinding(e,t))&&(e.addEventListener(t,i,n),this._boundedEvents.push({element:e,eventName:t,listener:i,groupName:s}))}));else for(let t of r)(!this._distinctEvent||this._distinctEvent&&!this.hasBinding(e,t))&&(e.addEventListener(t,i,n),this._boundedEvents.push({element:e,eventName:t,listener:i,groupName:s}))}hasBinding(e,t){return this._boundedEvents.some((i=>i.element===e&&(!t||i.eventName===t)))}unbind(e,t,i){if(e){let n=Array.isArray(e)?e:[e],s=Array.isArray(t)?t||"":[t||""];for(let e of n){i||(i=this._boundedEvents.find((i=>{if(i.element===e&&(!t||i.eventName===t))return i.listener})));for(let t of s)e?.removeEventListener?.(t,i)}}}unbindAll(e){if(e){let t=Array.isArray(e)?e:[e];for(let e=this._boundedEvents.length-1;e>=0;--e){let i=this._boundedEvents[e];if(t.some((e=>e===i.groupName))){let{element:t,eventName:n,listener:s}=i;this.unbind(t,n,s),this._boundedEvents.splice(e,1)}}}else for(;this._boundedEvents.length>0;){let e=this._boundedEvents.pop(),{element:t,eventName:i,listener:n}=e;this.unbind(t,i,n)}}},Zo=typeof window<"u"&&void 0!==window.multipleSelect?window.multipleSelect:{locales:{}};Zo.locales["en-US"]={formatSelectAll:()=>"[Select all]",formatAllSelected:()=>"All selected",formatCountSelected:(e,t)=>`${e} of ${t} selected`,formatNoMatchesFound:()=>"No matches found",formatOkButton:()=>"OK"};var Qo=Zo.locales,Jo={name:"",placeholder:"",classes:"",classPrefix:"",data:void 0,locale:void 0,selectAll:!0,single:void 0,singleRadio:!1,multiple:!1,hideOptgroupCheckboxes:!1,multipleWidth:80,width:void 0,dropWidth:void 0,maxHeight:250,maxHeightUnit:"px",position:"bottom",displayValues:!1,displayTitle:!1,displayDelimiter:", ",minimumCountSelected:3,ellipsis:!1,isOpen:!1,keepOpen:!1,openOnHover:!1,container:null,filter:!1,filterGroup:!1,filterPlaceholder:"",filterAcceptOnEnter:!1,filterByDataLength:void 0,customFilter(e){let{text:t,label:i,search:n}=e;return(i||t||"").includes(n)},showClear:!1,autoAdjustDropHeight:!1,autoAdjustDropPosition:!1,autoAdjustDropWidthByTextSize:!1,adjustedHeightPadding:10,useSelectOptionLabel:!1,useSelectOptionLabelToHtml:!1,navigationHighlight:!0,infiniteScroll:!1,virtualScroll:!0,cssStyler:()=>null,textTemplate:e=>e.innerHTML.trim(),labelTemplate:e=>e.label,onOpen:()=>!1,onClose:()=>!1,onCheckAll:()=>!1,onUncheckAll:()=>!1,onFocus:()=>!1,onBlur:()=>!1,onOptgroupClick:()=>!1,onBeforeClick:()=>!0,onClick:()=>!1,onFilter:()=>!1,onFilterClear:()=>!1,onClear:()=>!1,onAfterCreate:()=>!1,onDestroy:()=>!1,onAfterDestroy:()=>!1,onDestroyed:()=>!1};Object.assign(Jo,Qo["en-US"]);var ea={BLOCK_ROWS:50,CLUSTER_BLOCKS:4,DEFAULTS:Jo,METHODS:["init","getOptions","refreshOptions","getSelects","setSelects","enable","disable","open","close","check","uncheck","checkAll","uncheckAll","checkInvert","focus","blur","refresh","destroy"]};function ta(e){let t=Object.prototype.toString.call(e).slice(8,-1).toLowerCase();return"object"===t?(()=>{let t={};for(let i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=ta(e[i]));return t})():"array"===t?e.map((e=>ta(e))):e}function ia(e){return null!=e&&""!==e}function na(e,t,i){if(Array.isArray(e))for(let n of e){if(n[t]===i||n[t]===""+ +n[t]&&+n[t]===i)return n;if("optgroup"===n.type)for(let e of n.children)if(e&&(e[t]===i||e[t]===""+ +e[t]&&+e[t]===i))return e}}function sa(e){return Object.keys(e).forEach((t=>void 0===e[t]?delete e[t]:"")),e}function ra(e,t){if("string"!=typeof e)return e;if("function"==typeof t)return t(e);if("function"==typeof e.normalize)return e.normalize("NFD").replace(/[\u0300-\u036F]/g,"");throw new Error("[Multiple-Select-Vanilla] `normalize()` function is not defined, you can optionally provide a custom parser via the `diacriticParser` option.")}function oa(e){let t=0,i=0,n=0,s=0,r=window.innerHeight??0,o=window.innerWidth??0,a={left:window.pageXOffset||document.documentElement.scrollLeft||0,top:window.pageYOffset||document.documentElement.scrollTop||0},l=a.top,c=a.left,h=ua(e);if(h){let e=h.top??0,a=h.left??0;i=e-l,t=r-(e-l),n=a-c,s=o-(a-c)}return{top:i,bottom:t,left:n,right:s}}function aa(e=""){return e.split(" ").filter((e=>e))}function la(e,t,i){let n=document.createElement(e);return t&&Object.keys(t).forEach((e=>{let i=t[e];"object"==typeof i?Object.assign(n[e],i):n[e]=t[e]})),i?.appendChild&&i.appendChild(n),n}function ca(e,t,i){let n=e.props?.innerHTML?function(e,t){let{[t]:i,...n}=e;return n}(e.props,"innerHTML"):e.props,s=la(e.tagName,function(e,t){return"object"==typeof e?Object.fromEntries(t?Object.entries(e).filter((([e,i])=>!ia(i)&&!t.includes(e)||ia(i))):Object.entries(e).filter((([e,t])=>ia(t)))):e}(n,["className","title","style"]),t),r=i;if(r||(r=s),e.props.innerHTML&&(s.innerHTML=e.props.innerHTML),e.attrs)for(let t of Object.keys(e.attrs))s.setAttribute(t,e.attrs[t]);if(e.children)for(let t of e.children)ca(t,s,r);return t?.appendChild(s),s}function ha(e){return e.hasOwnProperty("tagName")?ca(e):document.createElement("li")}function da(e){for(;e?.firstChild;)e.lastChild&&e.removeChild(e.lastChild);return e}function ua(e){if(!e)return;let t=e?.getBoundingClientRect?.(),i=0,n=0,s=0,r=0;return void 0!==t?.top&&void 0!==t.left&&(i=t.top+window.pageYOffset,n=t.left+window.pageXOffset,r=t.right,s=t.bottom),{top:i,left:n,bottom:s,right:r}}function pa(e,t,i){if(!e)return 0;let n=Number.parseFloat(e.style[i]);if(!n||Number.isNaN(n)){switch(t){case"outer":n=e["width"===i?"offsetWidth":"offsetHeight"];break;case"scroll":n=e["width"===i?"scrollWidth":"scrollHeight"];break;default:n=e["width"===i?"clientWidth":"clientHeight"]}n=e.getBoundingClientRect()[i]}if(!n||Number.isNaN(n)){let t=e.style.display,s=e.style.position;e.style.display="block",e.style.position="absolute";let r=window.getComputedStyle(e)[i];n=Number.parseFloat(r),Number.isNaN(n)&&(n=0),e.style.display=t,e.style.position=s}return n||0}function fa(e,t){let i=null,n=e?.parentElement;for(;n;){let[e,s,r,o]=t.match(/^([a-z]*)([#.]{1})([a-z\-]+)$/i)||[];if(r&&o)for(let e of o.replace(r,"").split(" "))n.classList.contains(e)&&(s?n?.tagName.toLowerCase()===s&&(i=n):i=n);n=n.parentElement}return i}function ma(e,t){e?.style&&(e.style.display="none"===e.style.display&&!1!==t||!0===t?"block":"none")}var ga=class{constructor(e){Yo(this,"clusterRows"),Yo(this,"cache"),Yo(this,"scrollEl"),Yo(this,"blockHeight"),Yo(this,"clusterHeight"),Yo(this,"contentEl"),Yo(this,"parentEl"),Yo(this,"itemHeight"),Yo(this,"lastCluster"),Yo(this,"scrollTop"),Yo(this,"dataStart"),Yo(this,"dataEnd"),Yo(this,"rows"),Yo(this,"destroy"),Yo(this,"callback"),Yo(this,"sanitizer"),this.rows=e.rows,this.scrollEl=e.scrollEl,this.contentEl=e.contentEl,this.parentEl=e.contentEl?.parentElement,this.callback=e.callback,this.cache={},this.scrollTop=this.scrollEl.scrollTop,this.initDOM(this.rows),this.scrollEl.scrollTop=this.scrollTop,this.lastCluster=0;let t=()=>{this.lastCluster!==(this.lastCluster=this.getNum())&&(this.initDOM(this.rows),this.callback())};this.scrollEl.addEventListener("scroll",t,!1),this.destroy=()=>{this.scrollEl.removeEventListener("scroll",t,!1),da(this.contentEl)}}reset(e){this.lastCluster=0,this.cache={},da(this.contentEl),this.initDOM(e)}initDOM(e){if(typeof this.clusterHeight>"u"){this.cache.scrollTop=this.scrollEl.scrollTop;let t=ha(e[0]);this.contentEl.appendChild(t),this.contentEl.appendChild(t),this.contentEl.appendChild(t),this.cache.data=[e[0]],this.getRowsHeight()}let t=this.initData(e,this.getNum()),i=this.checkChanges("data",t.rows),n=this.checkChanges("top",t.topOffset),s=this.checkChanges("bottom",t.bottomOffset);da(this.contentEl),i&&n?(t.topOffset&&this.contentEl.appendChild(this.getExtra("top",t.topOffset)),t.rows.forEach((e=>this.contentEl.appendChild(ha(e)))),t.bottomOffset&&this.contentEl.appendChild(this.getExtra("bottom",t.bottomOffset))):s&&this.contentEl.lastChild&&(this.contentEl.lastChild.style.height=`${t.bottomOffset}px`)}getRowsHeight(){if(typeof this.itemHeight>"u"){let e=this.parentEl?.style.display||"";this.parentEl&&(""===e||"none"===e)&&(this.parentEl.style.display="block");let t=this.contentEl.children,i=t[Math.floor(t.length/2)];this.itemHeight=i.offsetHeight,this.parentEl&&(this.parentEl.style.display=e)}this.blockHeight=this.itemHeight*ea.BLOCK_ROWS,this.clusterRows=ea.BLOCK_ROWS*ea.CLUSTER_BLOCKS,this.clusterHeight=this.blockHeight*ea.CLUSTER_BLOCKS}getNum(){this.scrollTop=this.scrollEl.scrollTop;let e=(this.clusterHeight||0)-(this.blockHeight||0);return e&&Math.floor(this.scrollTop/e)||0}initData(e,t){if(e.length<ea.BLOCK_ROWS)return{topOffset:0,bottomOffset:0,rowsAbove:0,rows:e};let i=Math.max((this.clusterRows-ea.BLOCK_ROWS)*t,0),n=i+this.clusterRows,s=Math.max(i*this.itemHeight,0),r=Math.max((e.length-n)*this.itemHeight,0),o=[],a=i;s<1&&a++;for(let t=i;t<n;t++)e[t]&&o.push(e[t]);return this.dataStart=i,this.dataEnd=n,{topOffset:s,bottomOffset:r,rowsAbove:a,rows:o}}checkChanges(e,t){let i=t!==this.cache[e];return this.cache[e]=t,i}getExtra(e,t){let i=document.createElement("li");return i.className=`virtual-scroll-${e}`,t&&(i.style.height=`${t}px`),i}},va=".ms-select-all, ul li[data-key]",_a=class{constructor(e,t){this.elm=e,Yo(this,"_bindEventService"),Yo(this,"isAllSelected",!1),Yo(this,"isPartiallyAllSelected",!1),Yo(this,"fromHtml",!1),Yo(this,"choiceElm"),Yo(this,"selectClearElm"),Yo(this,"closeElm"),Yo(this,"clearSearchIconElm"),Yo(this,"filterText",""),Yo(this,"updateData",[]),Yo(this,"data",[]),Yo(this,"dataTotal"),Yo(this,"dropElm"),Yo(this,"okButtonElm"),Yo(this,"filterParentElm"),Yo(this,"lastFocusedItemKey",""),Yo(this,"lastMouseOverPosition",""),Yo(this,"ulElm"),Yo(this,"parentElm"),Yo(this,"labelElm"),Yo(this,"selectAllParentElm"),Yo(this,"selectAllElm"),Yo(this,"searchInputElm"),Yo(this,"selectGroupElms"),Yo(this,"selectItemElms"),Yo(this,"noResultsElm"),Yo(this,"options"),Yo(this,"selectAllName",""),Yo(this,"selectGroupName",""),Yo(this,"selectItemName",""),Yo(this,"scrolledByMouse",!1),Yo(this,"openDelayTimer"),Yo(this,"updateDataStart"),Yo(this,"updateDataEnd"),Yo(this,"virtualScroll"),Yo(this,"_currentHighlightIndex",-1),Yo(this,"_currentSelectedElm"),Yo(this,"isMoveUpRecalcRequired",!1),Yo(this,"locales",{}),this.options=Object.assign({},ea.DEFAULTS,this.elm.dataset,t),this._bindEventService=new Xo({distinctEvent:!0})}get isRenderAsHtml(){return this.options.renderOptionLabelAsHtml||this.options.useSelectOptionLabelToHtml}init(){this.initLocale(),this.initContainer(),this.initData(),this.initSelected(!0),this.initFilter(),this.initDrop(),this.initView(),this.options.onAfterCreate()}destroy(e=!0){this.elm&&this.parentElm&&(this.options.onDestroy({hardDestroy:e}),e&&this.options.onHardDestroy(),this.elm.parentElement&&this.parentElm.parentElement&&this.elm.parentElement.insertBefore(this.elm,this.parentElm.parentElement.firstChild),this.elm.classList.remove("ms-offscreen"),this._bindEventService.unbindAll(),this.virtualScroll?.destroy(),this.dropElm?.remove(),this.dropElm=void 0,this.parentElm.parentNode?.removeChild(this.parentElm),this.fromHtml&&(delete this.options.data,this.fromHtml=!1),this.options.onAfterDestroy({hardDestroy:e}),e&&(this.options.onAfterHardDestroy?.(),Object.keys(this.options).forEach((e=>delete this[e]))))}initLocale(){if(this.options.locale){if("object"==typeof this.options.locale)return void Object.assign(this.options,this.options.locale);let e=window.multipleSelect.locales,t=this.options.locale.split(/-|_/);if(t[0]=t[0].toLowerCase(),t[1]&&(t[1]=t[1].toUpperCase()),e[this.options.locale])Object.assign(this.options,e[this.options.locale]);else if(e[t.join("-")])Object.assign(this.options,e[t.join("-")]);else{if(!e[t[0]])throw new Error(`[multiple-select-vanilla] invalid locales "${this.options.locale}", make sure to import it before using it`);Object.assign(this.options,e[t[0]])}}}initContainer(){let e=this.elm.getAttribute("name")||this.options.name||"";this.options.classes&&this.elm.classList.add(this.options.classes),this.options.classPrefix&&(this.elm.classList.add(this.options.classPrefix),this.options.size&&this.elm.classList.add(`${this.options.classPrefix}-${this.options.size}`)),this.elm.style.display="none",this.labelElm=this.elm.closest("label"),!this.labelElm&&this.elm.id&&(this.labelElm=document.createElement("label"),this.labelElm.htmlFor=this.elm.id),this.labelElm?.querySelector("input")&&(this.labelElm=null),typeof this.options.single>"u"&&(this.options.single=!this.elm.multiple),this.parentElm=la("div",{className:aa(`ms-parent ${this.elm.className||""} ${this.options.classes}`).join(" "),dataset:{test:"sel"}}),this.options.darkMode&&this.parentElm.classList.add("ms-dark-mode");let t=this.elm.getAttribute("title")||"";t&&(this.parentElm.title=t),this.options.placeholder=this.options.placeholder||this.elm.getAttribute("placeholder")||"",this.choiceElm=la("button",{className:"ms-choice",type:"button"},this.parentElm),this.options.labelId&&(this.choiceElm.id=this.options.labelId,this.choiceElm.setAttribute("aria-labelledby",this.options.labelId)),this.choiceElm.appendChild(la("span",{className:"ms-placeholder",textContent:this.options.placeholder})),this.options.showClear&&(this.selectClearElm=la("div",{className:"ms-icon ms-icon-close"}),this.selectClearElm.style.display="none",this.choiceElm.appendChild(this.selectClearElm)),this.choiceElm.appendChild(la("div",{className:"ms-icon ms-icon-caret"})),this.dropElm=la("div",{className:`ms-drop ${this.options.position}`,ariaExpanded:"false"},this.parentElm),this.options.darkMode&&this.dropElm.classList.add("ms-dark-mode"),e&&(this.dropElm.dataset.name=e);let i=this.elm.getAttribute("data-test")||this.options.dataTest;i&&(this.parentElm.dataset.test=i,this.dropElm.dataset.test=i),this.closeElm=this.choiceElm.querySelector(".ms-icon-close"),this.options.dropWidth&&(this.dropElm.style.width="string"==typeof this.options.dropWidth?this.options.dropWidth:`${this.options.dropWidth}px`),function(e,t){e.parentNode?.insertBefore(t,e.nextSibling)}(this.elm,this.parentElm),this.elm.disabled&&(this.choiceElm.classList.add("disabled"),this.choiceElm.disabled=!0),this.selectAllName=`selectAll${e}`,this.selectGroupName=`selectGroup${e}`,this.selectItemName=`selectItem${e}`,this.options.keepOpen||(this._bindEventService.unbindAll("body-click"),this._bindEventService.bind(document.body,"click",(e=>{this.getEventTarget(e)===this.choiceElm||fa(this.getEventTarget(e),".ms-choice")===this.choiceElm||(this.getEventTarget(e)===this.dropElm||fa(this.getEventTarget(e),".ms-drop")!==this.dropElm&&this.getEventTarget(e)!==this.elm)&&this.options.isOpen&&this.close("body.click")}),void 0,"body-click"))}initData(){let e=[];if(this.options.data){if(Array.isArray(this.options.data))this.data=this.options.data.map((e=>"string"==typeof e||"number"==typeof e?{text:e,value:e}:e));else if("object"==typeof this.options.data){for(let[t,i]of Object.entries(this.options.data))e.push({value:t,text:`${i}`});this.data=e}}else this.elm.childNodes.forEach((t=>{let i=this.initRow(t);i&&e.push(i)})),this.options.data=e,this.data=e,this.fromHtml=!0;this.dataTotal=function(e){let t=0;return e.forEach(((e,i)=>{"optgroup"===e.type?(e._key=`group_${i}`,e.visible=typeof e.visible>"u"||e.visible,e.children.forEach(((e,n)=>{e&&(e.visible=typeof e?.visible>"u"||e.visible,e.divider||(e._key=`option_${i}_${n}`,t+=1))}))):(e.visible=typeof e.visible>"u"||e.visible,e.divider||(e._key=`option_${i}`,t+=1))})),t}(this.data||[])}initRow(e,t){let i={};return"option"===e.tagName?.toLowerCase()?(i.type="option",i.text=this.options.textTemplate(e),i.value=e.value,i.visible=!0,i.selected=!!e.selected,i.disabled=t||e.disabled,i.classes=e.getAttribute("class")||"",i.title=e.getAttribute("title")||"",e.dataset.value&&(i._value=e.dataset.value),Object.keys(e.dataset).length&&(i._data=e.dataset,i._data.divider&&(i.divider=i._data.divider)),i):"optgroup"===e.tagName?.toLowerCase()?(i.type="optgroup",i.label=this.options.labelTemplate(e),i.visible=!0,i.selected=!!e.selected,i.disabled=e.disabled,i.children=[],Object.keys(e.dataset).length&&(i._data=e.dataset),e.childNodes.forEach((e=>{i.children.push(this.initRow(e,i.disabled))})),i):null}initDrop(){this.initList(),this.update(!0),this.options.isOpen&&this.open(10),this.options.openOnHover&&this.parentElm&&(this._bindEventService.bind(this.parentElm,"mouseover",(()=>this.open(null))),this._bindEventService.bind(this.parentElm,"mouseout",(()=>this.close("hover.mouseout"))))}initFilter(){if(this.filterText="",this.options.filter||!this.options.filterByDataLength)return;let e=0;for(let t of this.data||[])"optgroup"===t.type?e+=t.children.length:e+=1;this.options.filter=e>this.options.filterByDataLength}initList(){if(this.options.filter&&(this.filterParentElm=la("div",{className:"ms-search"},this.dropElm),this.filterParentElm.appendChild(la("input",{autocomplete:"off",autocapitalize:"off",spellcheck:!1,type:"text",placeholder:this.options.filterPlaceholder||"ðï¸"})),this.options.showSearchClear&&this.filterParentElm.appendChild(la("span",{className:"ms-icon ms-icon-close"}))),this.options.selectAll&&!this.options.single){let e=this.elm.getAttribute("name")||this.options.name||"";this.selectAllParentElm=la("div",{className:"ms-select-all",dataset:{key:"select_all"}});let t=document.createElement("label"),i="ms-icon "+(this.isAllSelected?"ms-icon-check":this.isPartiallyAllSelected?"ms-icon-minus":"ms-icon-uncheck"),n=la("div",{className:"icon-checkbox-container"},t);la("input",{type:"checkbox",ariaChecked:String(this.isAllSelected),checked:this.isAllSelected,dataset:{name:`selectAll${e}`}},n),la("div",{className:i},n),t.appendChild(la("span",{textContent:this.formatSelectAll()})),this.selectAllParentElm.appendChild(t),this.dropElm?.appendChild(this.selectAllParentElm)}this.ulElm=document.createElement("ul"),this.ulElm.role="combobox",this.ulElm.ariaExpanded="false",this.ulElm.ariaMultiSelectable=String(!this.options.single),this.dropElm?.appendChild(this.ulElm),this.options.showOkButton&&!this.options.single&&(this.okButtonElm=la("button",{className:"ms-ok-button",type:"button",textContent:this.formatOkButton()},this.dropElm)),this.initListItems()}initListItems(){let e=0,t=this.getListRows();if(this.options.selectAll&&!this.options.single&&(e=-1),t.length>ea.BLOCK_ROWS*ea.CLUSTER_BLOCKS){let i=this.dropElm&&"none"!==this.dropElm?.style.display;!i&&this.dropElm&&(this.dropElm.style.left="-10000",this.dropElm.style.display="block",this.dropElm.ariaExpanded="true");let n=()=>{if(this.virtualScroll){this._currentHighlightIndex=0,this.updateDataStart=this.virtualScroll.dataStart+e,this.updateDataEnd=this.virtualScroll.dataEnd+e,this.updateDataStart<0&&(this.updateDataStart=0,this._currentHighlightIndex=0);let t=this.getDataLength();this.updateDataEnd>t&&(this.updateDataEnd=t),this.ulElm&&(this.isMoveUpRecalcRequired?this.recalculateArrowMove("up"):this.virtualScroll.dataStart>this.updateDataStart&&this.recalculateArrowMove("down"))}};this.ulElm&&(this.virtualScroll?this.virtualScroll.reset(t):this.virtualScroll=new ga({rows:t,scrollEl:this.ulElm,contentEl:this.ulElm,sanitizer:this.options.sanitizer,callback:()=>{n(),this.events()}})),n(),!i&&this.dropElm&&(this.dropElm.style.left="0",this.dropElm.style.display="none",this.dropElm.ariaExpanded="false")}else this.ulElm&&(da(this.ulElm),t.forEach((e=>this.ulElm.appendChild(ha(e))))),this.updateDataStart=0,this.updateDataEnd=this.updateData.length;return this.events(),t}getEventTarget(e){return e.composedPath?e.composedPath()[0]:e.target}getListRows(){let e=[];return this.updateData=[],this.data?.forEach((t=>e.push(...this.initListItem(t)))),this.options.infiniteScroll&&e.push({tagName:"li",props:{className:"ms-infinite-option",role:"option"}}),e.push({tagName:"li",props:{className:"ms-no-results",textContent:this.formatNoMatchesFound()}}),e}initListItem(e,t=0){let i=e?.title||"",n=this.options.multiple?"multiple":"",s=this.options.single?"radio":"checkbox",r=!!e?.selected,o=this.options.single&&!this.options.singleRadio,a="";if(!e?.visible)return[];if(this.updateData.push(e),o&&(a="hide-radio "),e.selected&&(a+="selected "),"optgroup"===e.type){let t,i=[];if(this.options.hideOptgroupCheckboxes||this.options.single)t={tagName:"span",props:{dataset:{name:this.selectGroupName,key:e._key}}};else{let i={tagName:"input",props:{type:"checkbox",dataset:{name:this.selectGroupName,key:e._key},checked:r,disabled:e.disabled}};t=o?i:{tagName:"div",props:{className:"icon-checkbox-container"+("radio"===s?" radio":"")},children:[i,{tagName:"div",props:{className:"ms-icon "+(r?"radio"===s?"ms-icon-radio":"ms-icon-check":"ms-icon-uncheck")}}]}}!a.includes("hide-radio")&&(this.options.hideOptgroupCheckboxes||this.options.single)&&(a+="hide-radio ");let n={tagName:"span",props:{}};this.applyAsTextOrHtmlWhenEnabled(n.props,e.label);let l={tagName:"li",props:{className:aa(`group${this.options.single||e.disabled?" disabled":""} ${a}`).join(" "),role:"option",ariaSelected:String(r),dataset:{key:e._key}},children:[{tagName:"label",props:{className:aa("optgroup"+(this.options.single||e.disabled?" disabled":"")).join(" ")},children:[t,n]}]},c=this.options.cssStyler(e);return c&&(l.props.style=c),i.push(l),e.children.forEach((e=>i.push(...this.initListItem(e,1)))),i}if(a+=e.classes||"",t&&this.options.single&&(a+=`option-level-${t} `),e.divider)return[{tagName:"li",props:{className:"option-divider"}}];let l=n||a?(n+a).trim():"";e.disabled&&(l+=" disabled");let c=e.disabled?"disabled":"",h={tagName:"span",props:{}};this.applyAsTextOrHtmlWhenEnabled(h.props,e.text);let d={tagName:"input",props:{type:s,value:encodeURI(e.value),dataset:{key:e._key,name:this.selectItemName},checked:r,disabled:!!e.disabled}};e.selected&&(d.attrs={checked:"checked"});let u={tagName:"div",props:{className:"icon-checkbox-container"+("radio"===s?" radio":"")},children:[d,{tagName:"div",props:{className:"ms-icon "+(d.props.checked?"radio"===s?"ms-icon-radio":"ms-icon-check":"ms-icon-uncheck")}}]},p={tagName:"li",props:{role:"option",title:i,ariaSelected:String(r),dataset:{key:e._key}},children:[{tagName:"label",props:{className:c},children:[o?d:u,h]}]};l&&(p.props.className=l);let f=this.options.cssStyler(e);return f&&(p.props.style=f),[p]}initSelected(e=!1){let t=0;for(let e of this.data||[])if("optgroup"===e.type){let i=e.children.filter((e=>e?.selected&&!e.disabled&&e.visible)).length;e.children.length&&(e.selected=!this.options.single&&i&&i===e.children.filter((e=>e&&!e.disabled&&e.visible&&!e.divider)).length),t+=i}else t+=e.selected&&!e.disabled&&e.visible?1:0;this.isAllSelected=this.data?.filter((e=>e.selected&&!e.disabled&&e.visible)).length===this.data?.filter((e=>!e.disabled&&e.visible&&!e.divider)).length,this.isPartiallyAllSelected=!this.isAllSelected&&t>0,e||(this.isAllSelected?this.options.onCheckAll():0===t&&this.options.onUncheckAll())}initView(){let e;window.getComputedStyle?(e=window.getComputedStyle(this.elm).width,"auto"===e&&(e=pa(this.dropElm,"outer","width")+20)):e=pa(this.elm,"outer","width")+20,this.parentElm.style.width=`${this.options.width||e}px`,this.elm.classList.add("ms-offscreen")}events(){this._bindEventService.unbindAll(["ok-button","search-input","select-all-checkbox","input-checkbox-list","group-checkbox-list","hover-highlight","arrow-highlight","option-list-scroll"]),this.clearSearchIconElm=this.filterParentElm?.querySelector(".ms-icon-close"),this.searchInputElm=this.dropElm?.querySelector(".ms-search input"),this.selectAllElm=this.dropElm?.querySelector(`input[data-name="${this.selectAllName}"]`),this.selectGroupElms=this.dropElm?.querySelectorAll(`input[data-name="${this.selectGroupName}"],span[data-name="${this.selectGroupName}"]`),this.selectItemElms=this.dropElm?.querySelectorAll(`input[data-name="${this.selectItemName}"]:enabled`),this.noResultsElm=this.dropElm?.querySelector(".ms-no-results");let e=e=>{e.preventDefault(),!this.getEventTarget(e).classList.contains("ms-icon-close")&&(this.options.isOpen?this.close("toggle.close"):this.open())};this.labelElm&&this._bindEventService.bind(this.labelElm,"click",(t=>{"label"===this.getEventTarget(t).nodeName.toLowerCase()&&(e(t),(!this.options.filter||!this.options.isOpen)&&this.focus(),t.stopPropagation())})),this._bindEventService.bind(this.choiceElm,"click",e),this.options.onFocus&&this._bindEventService.bind(this.choiceElm,"focus",this.options.onFocus),this.options.onBlur&&this._bindEventService.bind(this.choiceElm,"blur",this.options.onBlur),this._bindEventService.bind(this.parentElm,"keydown",(e=>{"Escape"===e.code&&this.handleEscapeKey()})),this.closeElm&&this._bindEventService.bind(this.closeElm,"click",(e=>{e.preventDefault(),this._checkAll(!1,!0),this.initSelected(!1),this.updateSelected(),this.update(),this.options.onClear()})),this.clearSearchIconElm&&this._bindEventService.bind(this.clearSearchIconElm,"click",(e=>{e.preventDefault(),this.searchInputElm&&(this.searchInputElm.value="",this.searchInputElm.focus()),this._currentHighlightIndex=-1,this.moveHighlightDown(),this.filter(),this.options.onFilterClear()})),this.searchInputElm&&(this._bindEventService.bind(this.searchInputElm,"keydown",(e=>{"Tab"===e.code&&e.shiftKey&&this.close("key.shift+tab")}),void 0,"search-input"),this._bindEventService.bind(this.searchInputElm,"keyup",(e=>{if(this.options.filterAcceptOnEnter&&["Enter","Space"].includes(e.code)&&this.searchInputElm?.value){if(this.options.single){let e=[];this.selectItemElms?.forEach((t=>{"none"!==t.closest("li")?.style.display&&e.push(t)})),e.length&&e[0].hasAttribute("data-name")&&this.setSelects([e[0].value])}else this.selectAllElm?.click();return this.close(`key.${e.code.toLowerCase()}`),void this.focus()}this.filter()}),void 0,"search-input")),this.selectAllElm&&this._bindEventService.bind(this.selectAllElm,"click",(e=>this._checkAll(e.currentTarget?.checked)),void 0,"select-all-checkbox"),this.okButtonElm&&this._bindEventService.bind(this.okButtonElm,"click",(t=>{e(t),t.stopPropagation()}),void 0,"ok-button"),this.selectGroupElms&&this._bindEventService.bind(this.selectGroupElms,"click",(e=>{let t=e.currentTarget,i=t.checked,n=na(this.data,"_key",t.dataset.key);this._checkGroup(n,i),this.options.onOptgroupClick(sa({label:n.label,selected:n.selected,data:n._data,children:n.children.map((e=>{if(e)return sa({text:e.text,value:e.value,selected:e.selected,disabled:e.disabled,data:e._data})}))}))}),void 0,"group-checkbox-list"),this.selectItemElms&&this._bindEventService.bind(this.selectItemElms,"click",(e=>{let t=e.currentTarget,i=t.checked,n=na(this.data,"_key",t.dataset.key),s=()=>{this.options.single&&this.options.isOpen&&!this.options.keepOpen&&this.close("selection")};!1!==this.options.onBeforeClick(n)?(this._check(n,i),this.options.onClick(sa({text:n.text,value:n.value,selected:n.selected,data:n._data})),s()):s()}),void 0,"input-checkbox-list"),this.lastFocusedItemKey&&this.dropElm&&this.dropElm.querySelector(`li[data-key=${this.lastFocusedItemKey}]`)?.focus(),this.options.navigationHighlight&&this.dropElm&&(this._bindEventService.bind(this.dropElm,"mouseover",(e=>{let t=this.getEventTarget(e).closest(".ms-select-all")||this.getEventTarget(e).closest("li");if(this.dropElm?.contains(t)&&this.lastMouseOverPosition!==`${e.clientX}:${e.clientY}`){let e=this.dropElm?.querySelectorAll(va)||[],i=Array.from(e).findIndex((e=>e.dataset.key===t.dataset.key));this._currentHighlightIndex!==i&&!t.classList.contains("disabled")&&(this._currentSelectedElm=t,this._currentHighlightIndex=i,this.changeCurrentOptionHighlight(t))}this.lastMouseOverPosition=`${e.clientX}:${e.clientY}`}),void 0,"hover-highlight"),this._bindEventService.bind(this.dropElm,"keydown",(e=>{switch(e.key){case"ArrowUp":e.preventDefault(),this.moveHighlightUp();break;case"ArrowDown":e.preventDefault(),this.moveHighlightDown();break;case"Escape":this.handleEscapeKey();break;case"Enter":case" ":if(document.activeElement!==this.okButtonElm){let t=this.getEventTarget(e).closest(".ms-select-all")||this.getEventTarget(e).closest("li");if(" "===e.key&&this.options.filter||this.options.filterAcceptOnEnter&&!t)return;e.preventDefault(),this._currentSelectedElm?.querySelector("input")?.click(),this.options.single&&(this.choiceElm.focus(),this.lastFocusedItemKey=this.choiceElm?.dataset.key||"")}break;case"Tab":e.preventDefault(),e.shiftKey?document.activeElement===this.okButtonElm?(this.focusSelectAllOrList(),this.highlightCurrentOption()):(this.close("key.shift+tab"),this.choiceElm.focus()):(this.changeCurrentOptionHighlight(),this.okButtonElm?.focus())}}),void 0,"arrow-highlight")),this.ulElm&&this.options.infiniteScroll&&this._bindEventService.bind(this.ulElm,"scroll",this.infiniteScrollHandler.bind(this),void 0,"option-list-scroll")}handleEscapeKey(){this.options.keepOpen||(this.close("key.escape"),this.choiceElm.focus())}infiniteScrollHandler(e,t,i){let n=!1;e&&this.getEventTarget(e)&&this.ulElm&&this.scrolledByMouse?this.getEventTarget(e).scrollTop+this.getEventTarget(e).clientHeight===this.ulElm.scrollHeight&&(n=!0):void 0!==t&&t+1===i&&(n=!0),n&&this.ulElm&&(this.virtualScroll?this.initListItems():this.ulElm.scrollTop=0,this._currentHighlightIndex=0,this.highlightCurrentOption())}open(e=0){return new Promise((t=>{null!==e&&e>=0?(window.clearTimeout(this.openDelayTimer),this.openDelayTimer=window.setTimeout((()=>{this.openDrop(),t()}),e)):(this.openDrop(),t())}))}openDrop(){if(!this.dropElm||this.choiceElm?.classList.contains("disabled"))return;if(this.options.isOpen=!0,this.parentElm.classList.add("ms-parent-open"),this.choiceElm?.querySelector("div.ms-icon-caret")?.classList.add("open"),this.dropElm.style.display="block",this.dropElm.ariaExpanded="true",this.selectAllElm?.parentElement&&(this.selectAllElm.parentElement.style.display="inline-flex"),this.noResultsElm&&(this.noResultsElm.style.display="none"),this.getDataLength()||(this.selectAllElm?.parentElement&&(this.selectAllElm.parentElement.style.display="none"),this.noResultsElm&&(this.noResultsElm.style.display="block")),this.options.container){let e,t=ua(this.dropElm);this.options.container instanceof Node?e=this.options.container:"string"==typeof this.options.container&&(e="body"===this.options.container?document.body:document.querySelector(this.options.container)),e.appendChild(this.dropElm),this.dropElm.style.top=`${t?.top??0}px`,this.dropElm.style.left=`${t?.left??0}px`,this.dropElm.style.minWidth="auto",this.dropElm.style.width=`${pa(this.parentElm,"outer","width")}px`}let e=this.options.minHeight,t=this.options.maxHeight;"row"===this.options.maxHeightUnit&&(t=pa(this.dropElm.querySelector("ul>li"),"outer","height")*this.options.maxHeight),this.ulElm??=this.dropElm.querySelector("ul"),this.ulElm&&(e&&(this.ulElm.style.minHeight=`${e}px`),this.ulElm.style.maxHeight=`${t}px`),this.dropElm.querySelectorAll(".multiple").forEach((e=>{e.style.width=`${this.options.multipleWidth}px`})),this.getDataLength()&&this.options.filter?(this.searchInputElm&&(this.searchInputElm.value="",this.searchInputElm.focus()),this.filter(!0)):this.focusSelectAllOrList(),this._currentHighlightIndex<0?this.moveHighlightDown():this.highlightCurrentOption(),this.options.autoAdjustDropWidthByTextSize&&this.adjustDropWidthByText();let i=this.options.position;if(this.options.autoAdjustDropHeight){if(this.options.autoAdjustDropPosition){let{bottom:e,top:t}=oa(this.dropElm);i=e<this.dropElm.getBoundingClientRect().height&&t>e?"top":"bottom"}this.adjustDropHeight(i)}this.options.autoAdjustDropPosition&&this.adjustDropPosition(!0),this.options.onOpen()}focusSelectAllOrList(){this.selectAllElm?this.selectAllElm.focus():this.ulElm&&(this.ulElm.tabIndex=0,this.ulElm.focus())}highlightCurrentOption(){let e=this.dropElm?.querySelectorAll(va)||[];if(this._currentHighlightIndex<=e.length){let t=e[this._currentHighlightIndex];t&&(this.lastFocusedItemKey=t.dataset.key||"",this._currentSelectedElm=t,this.scrolledByMouse=!1,t.scrollIntoView({block:"nearest"}),this.changeCurrentOptionHighlight(t),window.setTimeout((()=>this.scrolledByMouse=!0),10))}}changeCurrentOptionHighlight(e){e?.classList.add("highlighted"),(this.dropElm?.querySelectorAll(".ms-select-all.highlighted, ul li[data-key].highlighted")||[]).forEach((t=>{t!==e&&t.classList.remove("highlighted")}))}moveHighlightDown(){let e=this.dropElm?.querySelectorAll(va)||[],t=e.length;this._currentHighlightIndex<t-1?(this._currentHighlightIndex++,e[this._currentHighlightIndex]?.classList.contains("disabled")&&this.moveHighlightDown()):this.options.infiniteScroll&&this.infiniteScrollHandler(null,this._currentHighlightIndex,t),this.highlightCurrentOption()}moveHighlightUp(){let e=this.dropElm?.querySelectorAll(va)||[],t=this.options.single?0:1;if(this.virtualScroll&&this._currentHighlightIndex<=t&&this.updateDataStart>0&&this.ulElm){let t=e[this._currentHighlightIndex+(this.options.single?0:1)],i=t?.dataset.key;return this.lastFocusedItemKey=i,this.ulElm.scrollTop=this.ulElm.scrollTop-t?.getBoundingClientRect().height||10,void(this.isMoveUpRecalcRequired=!0)}this._currentHighlightIndex>0&&(this._currentHighlightIndex--,e[this._currentHighlightIndex]?.classList.contains("disabled")&&this.moveHighlightUp()),this.highlightCurrentOption()}recalculateArrowMove(e){let t=this.dropElm?.querySelectorAll(va)||[],i=Array.from(t).findIndex((e=>e.dataset.key===this.lastFocusedItemKey));this._currentHighlightIndex=i-1,"down"===e?this.moveHighlightDown():"up"===e&&(this.moveHighlightUp(),this.isMoveUpRecalcRequired=!1)}close(e){this.options.isOpen=!1,this.parentElm.classList.remove("ms-parent-open"),this.choiceElm?.querySelector("div.ms-icon-caret")?.classList.remove("open"),this.dropElm&&(this.dropElm.style.display="none",this.dropElm.ariaExpanded="false",this.options.container&&(this.parentElm.appendChild(this.dropElm),this.dropElm.style.top="auto",this.dropElm.style.left="auto")),this.options.onClose(e)}applyAsTextOrHtmlWhenEnabled(e,t){e||(e={}),this.isRenderAsHtml?e.innerHTML="function"==typeof this.options.sanitizer?this.options.sanitizer(t):t:e.textContent=t}update(e=!1){let t=this.getSelects(),i=this.getSelects("text");this.options.displayValues&&(i=t);let n=this.choiceElm?.querySelector("span"),s=t.length,r=null,o=()=>{if(this.options.useSelectOptionLabel||this.options.useSelectOptionLabelToHtml){let e=t.join(this.options.displayDelimiter);return this.options.useSelectOptionLabelToHtml?e.replace(/(\b)(on[a-z]+)(\s*)=([^>]*)|javascript:([^>]*)[^>]*|(<\s*)(\/*)script([<>]*).*(<\s*)(\/*)script(>*)|(&lt;|&#60;)(\/*)(script|script defer)(.*)(&#62;|&gt;|&gt;">)/gi,""):e}return i.join(this.options.displayDelimiter)};if(n){if(0===s){let e=this.options.placeholder||"";n.classList.add("ms-placeholder"),this.applyAsTextOrHtmlWhenEnabled(n,e)}else r=s<this.options.minimumCountSelected?o():this.formatAllSelected()&&s===this.dataTotal?this.formatAllSelected():this.options.ellipsis&&s>this.options.minimumCountSelected?`${i.slice(0,this.options.minimumCountSelected).join(this.options.displayDelimiter)}...`:this.formatCountSelected(s,this.dataTotal)&&s>this.options.minimumCountSelected?this.formatCountSelected(s,this.dataTotal):o();if(null!==r&&(n?.classList.remove("ms-placeholder"),this.applyAsTextOrHtmlWhenEnabled(n,r)),this.options.showClear&&this.selectClearElm){let e=r?"block":"none";this.selectClearElm.style.display=e}if(this.options.displayTitle){let e=this.options.useSelectOptionLabel||this.options.useSelectOptionLabelToHtml?"value":"text";n.title=this.getSelects(e).join(this.options.displayDelimiter)}}let a=this.getSelects();this.options.single?this.elm.value=a.length?a[0]:"":Array.from(this.elm.options).forEach((e=>{e.selected=a.some((t=>t===e.value))})),e||this.elm.dispatchEvent(new Event("change"))}updateSelected(e){for(let e=this.updateDataStart;e<this.updateDataEnd;e++){let t=this.updateData[e],i=this.dropElm?.querySelector(`input[data-key=${t._key}]`);if(i){i.checked=t.selected;let e=i.closest("li"),n=e?.querySelector(".icon-checkbox-container div");e&&(t.selected&&!e.classList.contains("selected")?(e.classList.add("selected"),e.ariaSelected="true",n&&(n.className="ms-icon ms-icon-"+("radio"===i.type?"radio":"check"))):t.selected||(e.classList.remove("selected"),e.ariaSelected="false",n&&(n.className="ms-icon ms-icon-uncheck")))}}let t=0===this.data?.filter((e=>e.visible)).length;if(this.selectAllElm){this.selectAllElm.ariaChecked=String(this.isAllSelected);let e=this.dropElm?.querySelector(".ms-select-all .icon-checkbox-container div");if(e){let t="";t=this.isAllSelected?"ms-icon-check":this.isPartiallyAllSelected?"ms-icon-minus":"ms-icon-uncheck",e.className=`ms-icon ${t}`}this.selectAllElm.checked=this.isAllSelected,ma(this.selectAllElm.closest("li"),!t)}ma(this.noResultsElm,t),this.virtualScroll&&(this.virtualScroll.rows=e??this.getListRows())}getData(){return this.options.data}getDataLength(){return this.data?.length??0}getOptions(e=!0){let t=Object.assign({},this.options);return delete t.data,e?ta(t):this.options}refreshOptions(e){(function(e,t,i=!1){let n=Object.keys(e),s=Object.keys(t);if(i&&n.length!==s.length)return!1;for(let i of n)if(s.includes(i)&&e[i]!==t[i])return!1;return!0})(this.options,e,!0)||(this.options=Object.assign(this.options,e),this.destroy(!1),this.init())}getDropElement(){return this.dropElm}getParentElement(){return this.parentElm}getSelects(e="value"){let t=[];for(let i of this.data||[])if("optgroup"===i.type){let n=i.children.filter((e=>e?.selected));if(!n.length)continue;if("value"===e||this.options.single)t.push(...n.map((t=>"value"===e&&t._value||t[e])));else{let s=[];s.push("["),s.push(i.label),s.push(`: ${n.map((t=>t[e])).join(", ")}`),s.push("]"),t.push(s.join(""))}}else i.selected&&t.push("value"===e&&i._value||i[e]);return t}setSelects(e,t="value",i=!1){let n=!1,s=i=>{for(let s of i){let i=!1;if("text"===t){let t=document.createElement("div");this.applyAsTextOrHtmlWhenEnabled(t,s.text),i=e.includes(t.textContent?.trim()??"")}else i=e.includes(s._value||s.value),!i&&s.value===""+ +s.value&&(i=e.includes(+s.value));s.selected!==i&&(n=!0),s.selected=i}};for(let e of this.data||[])"optgroup"===e.type?s(e.children):s([e]);n&&(this.initSelected(i),this.updateSelected(),this.update(i))}enable(){this.choiceElm&&(this.choiceElm.classList.remove("disabled"),this.choiceElm.disabled=!1)}disable(){this.choiceElm&&(this.choiceElm?.classList.add("disabled"),this.choiceElm.disabled=!0)}check(e){let t=na(this.data,"value",e);t&&this._check(t,!0)}uncheck(e){let t=na(this.data,"value",e);t&&this._check(t,!1)}_check(e,t){this.options.single&&this._checkAll(!1,!0),e.selected=t,this.initSelected(),this.updateSelected(),this.update()}checkAll(){this._checkAll(!0)}uncheckAll(){this._checkAll(!1)}_checkAll(e,t){for(let i of this.data||[])"optgroup"===i.type?this._checkGroup(i,e,!0):!i.disabled&&!i.divider&&(t||i.visible)&&(i.selected=e);t||(this.initSelected(),this.updateSelected(),this.update())}_checkGroup(e,t,i){e.selected=t,e.children.forEach((e=>{e&&!e.disabled&&!e.divider&&(i||e.visible)&&(e.selected=t)})),i||(this.initSelected(),this.updateSelected(),this.update())}checkInvert(){if(!this.options.single){for(let e of this.data||[])if("optgroup"===e.type)for(let t of e.children)t&&(t.divider||(t.selected=!t.selected));else e&&!e.divider&&(e.selected=!e.selected);this.initSelected(),this.updateSelected(),this.update()}}focus(){this.choiceElm?.focus(),this.options.onFocus()}blur(){this.choiceElm?.blur(),this.options.onBlur()}refresh(){this.destroy(!1),this.init()}filter(e){let t=this.searchInputElm?.value.trim()??"",i=t.toLowerCase();if(this.filterText===i)return;this.filterText=i;for(let e of this.data||[])if("optgroup"===e.type)if(this.options.filterGroup){let n=`${e?.label??""}`;if(null!=e){let s=this.options.customFilter({label:ra(n.toString().toLowerCase(),this.options.diacriticParser),search:ra(i,this.options.diacriticParser),originalLabel:n,originalSearch:t,row:e});e.visible=s;for(let t of e.children)t&&(t.visible=s)}}else{for(let n of e.children)if(null!=n){let s=`${n?.text??""}`;n.visible=this.options.customFilter({text:ra(s.toString().toLowerCase(),this.options.diacriticParser),search:ra(i,this.options.diacriticParser),originalText:s,originalSearch:t,row:n,parent:e})}e.visible=e.children.filter((e=>e?.visible)).length>0}else{let n=`${e?.text??""}`;e.visible=this.options.customFilter({text:ra(n.toString().toLowerCase(),this.options.diacriticParser),search:ra(i,this.options.diacriticParser),originalText:n,originalSearch:t,row:e})}let n=this.initListItems();this.initSelected(e),this.updateSelected(n),e||this.options.onFilter(t)}adjustDropHeight(e){let t="top"!==e,i=(this.filterParentElm?.getBoundingClientRect().height??0)+(this.okButtonElm?.getBoundingClientRect().height??0)+(this.options.single?0:this.selectAllParentElm?.getBoundingClientRect().height??0)+5,{bottom:n,top:s}=oa(this.parentElm),r=this.options.maxHeight;if(r=t?n-i-this.options.adjustedHeightPadding:s-i-this.options.adjustedHeightPadding,!this.options.maxHeight||this.options.maxHeight&&r<this.options.maxHeight){let e=this.dropElm?.querySelector("ul");return e&&(e.style.maxHeight=`${r}px`),!0}return!1}adjustDropPosition(e){let t="bottom";if(this.dropElm&&this.parentElm){let{bottom:i,top:n}=oa(this.dropElm),{top:s,left:r}=ua(this.parentElm),o=this.dropElm.getBoundingClientRect().height,a=this.dropElm.getBoundingClientRect().width,l=document.body.offsetWidth||window.innerWidth,c=this.parentElm.getBoundingClientRect().width;if(i>o)t="bottom";else if(o>i&&n>i){if(this.options.container){let i=s-o;i<0&&(i=0),(i>0||e)&&(t="top",this.dropElm.style.top=`${i<0?0:i}px`)}else t="top",this.dropElm.classList.add(t);this.dropElm.classList.remove("bottom")}l-a<r&&(this.dropElm.style.left=r-(a-c)+"px")}return t}adjustDropWidthByText(){if(this.dropElm){let e=this.parentElm.scrollWidth;(this.options.dropWidth||this.options.width)&&(e=this.options.dropWidth||this.options.width||0);let t=this.dropElm.querySelector(".ms-select-all span"),i=this.dropElm.querySelector("ul"),n=26,s=t?.clientWidth??0+n,r=i.scrollHeight>i.clientHeight?this.getScrollbarWidth():0,o=0;this.dropElm.querySelectorAll("li label").forEach((e=>{e.scrollWidth>o&&(o=e.scrollWidth)})),o+=n+r,o<s&&(o=s),this.options.maxWidth&&o>this.options.maxWidth&&(o=this.options.maxWidth),this.options.minWidth&&o<this.options.minWidth&&(o=this.options.minWidth),("100%"===e||+e<o)&&(this.dropElm.style.width=`${o}px`,this.dropElm.style.maxWidth=`${o}px`)}}getScrollbarWidth(){let e=document.createElement("div");e.style.visibility="hidden",e.style.width="100px",document.body.appendChild(e);let t=e.offsetWidth;e.style.overflow="scroll";let i=document.createElement("div");i.style.width="100%",e.appendChild(i);let n=i.offsetWidth;return e.parentNode?.removeChild(e),t-n}formatAllSelected(){return this.options.allSelectedText||this.options.formatAllSelected()}formatCountSelected(e,t){return this.options.countSelectedText?this.options.countSelectedText.replace("#",`${e}`).replace("%",`${t}`):this.options.formatCountSelected(e,t)}formatNoMatchesFound(){return this.options.noMatchesFoundText||this.options.formatNoMatchesFound()}formatOkButton(){return this.options.okButtonText||this.options.formatOkButton()}formatSelectAll(){return this.options.selectAllText||this.options.formatSelectAll()}},ba=(e,t)=>"string"==typeof e?ya(document.querySelectorAll(e),t):e instanceof Node?ya([e],t):ya(e,t);function ya(e,t){let i=Array.from(e),n=[];for(let e=0;e<i.length;e++){let s=i[e];try{void 0!==s._multipleSelect&&(s._multipleSelect.destroy(),delete s._multipleSelect),s._multipleSelect=new _a(s,t||{}),s._multipleSelect.init();let i=s._multipleSelect.getOptions(!1);i.onHardDestroy=()=>delete s._multipleSelect,i.onAfterHardDestroyed=()=>n[e]=null,n.push(s._multipleSelect)}catch(e){console.error(e)}}return 1===n.length?n[0]:n}ba.defaults=ea.DEFAULTS,ba.locales={...Qo},ba.methods=ea.METHODS,typeof window<"u"&&(window.multipleSelect=ba);class Ca{constructor(e,t,i,n=!0){this.translaterService=e,this.collectionService=t,this.rxjs=i,this._isMultipleSelect=!0,this._collectionLength=0,this._shouldTriggerQuery=!0,this.isFilled=!1,this.enableTranslateLabel=!1,this.subscriptions=[],this._isMultipleSelect=n}get collectionOptions(){return this.columnDef?.filter?.collectionOptions??{}}get columnFilter(){return this.columnDef?.filter??{}}get customStructure(){return this.columnDef?.filter?.customStructure}get gridOptions(){return this.grid?.getOptions()??{}}get defaultOperator(){return this.isMultipleSelect?S.in:S.equal}get filterOptions(){return{...this.gridOptions.defaultFilterOptions?.select,...this.columnFilter?.filterOptions}}get isMultipleSelect(){return this._isMultipleSelect}get msInstance(){return this._msInstance}get selectOptions(){return this.defaultOptions}get operator(){return this.columnFilter?.operator??this.defaultOperator}set operator(e){this.columnFilter&&(this.columnFilter.operator=e)}init(e){if(!e)throw new Error('[Slickgrid-Universal] A filter must always have an "init()" with valid arguments.');if(this.grid=e.grid,this.callback=e.callback,this.columnDef=e.columnDef,this.searchTerms=(e.hasOwnProperty("searchTerms")?e.searchTerms:[])||[],this.filterContainerElm=e.filterContainerElm,!this.grid||!this.columnDef||!this.columnFilter||!this.columnFilter.collection&&!this.columnFilter.collectionAsync)throw new Error("[Slickgrid-Universal] You need to pass a \"collection\" (or \"collectionAsync\") for the MultipleSelect/SingleSelect Filter to work correctly. Also each option should include a value/label pair (or value/labelKey when using Locale). For example:: { filter: model: Filters.multipleSelect, collection: [{ value: true, label: 'True' }, { value: false, label: 'False'}] }");if(this.enableTranslateLabel=this.columnFilter?.enableTranslateLabel??!1,this.labelName=this.customStructure?.label??"label",this.labelPrefixName=this.customStructure?.labelPrefix??"labelPrefix",this.labelSuffixName=this.customStructure?.labelSuffix??"labelSuffix",this.optionLabel=this.customStructure?.optionLabel??"value",this.valueName=this.customStructure?.value??"value",this.enableTranslateLabel&&(!this.translaterService||"function"!=typeof this.translaterService.translate))throw new Error('[select-filter] The Translate Service is required for the Select Filter to work correctly when "enableTranslateLabel" is set.');this._locales=this.gridOptions?.locales??m.locales,this.initMultipleSelectTemplate();let t=this.gridOptions?.defaultFilterPlaceholder||"";this.columnFilter?.placeholder&&(t=this.columnFilter.placeholder),this.defaultOptions.placeholder=t||"",this._isMultipleSelect&&this.columnDef?.filter&&(this.columnDef.filter.emptySearchTermReturnAllValues=this.columnDef.filter?.emptySearchTermReturnAllValues??!1);const i=this.columnFilter.collection||[];return new Promise((async(e,t)=>{try{let t;this.columnFilter.collectionAsync&&!this.columnFilter.collection?(t=$t(this.columnFilter.collectionAsync,this.columnDef,this.renderDomElement.bind(this),this.rxjs,this.subscriptions),e(t)):(t=i,this.renderDomElement(i),e(i)),(this.columnFilter.collectionAsync||this.columnFilter.enableCollectionWatch)&&(await(t??this.columnFilter.collectionAsync),this.watchCollectionChanges())}catch(e){t(e)}}))}clear(e=!0){this._msInstance&&this._collectionLength>0&&(this._msInstance.setSelects([]),this.updateFilterStyle(!1),this.searchTerms=[],this._shouldTriggerQuery=e,this.callback(void 0,{columnDef:this.columnDef,clearFilterTriggered:!0,shouldTriggerQuery:this._shouldTriggerQuery}),this._shouldTriggerQuery=!0)}destroy(){"function"==typeof this._msInstance?.destroy&&this._msInstance.destroy(),this.filterElm?.remove(),Y(this.subscriptions)}getValues(){return this._msInstance?.getSelects()??[]}setValues(e,t,i=!1){void 0!==e&&this._msInstance&&(e=Array.isArray(e)?e.every((e=>Re(e)))?e.map(String):e:[e],this._msInstance.setSelects(e)),this.updateFilterStyle(this.getValues().length>0),this.operator=t||this.defaultOperator,i&&this.onTriggerEvent()}filterCollection(e){let t=e;if(this.columnFilter&&this.columnFilter.collectionFilterBy){const e=this.columnFilter.collectionFilterBy,i=this.columnFilter.collectionOptions?.filterResultAfterEachPass||null;t=this.collectionService?.filterCollection(t,e,i)||[]}return t}sortCollection(e){let t=e;if(this.columnFilter&&this.columnFilter.collectionSortBy){const e=this.columnFilter.collectionSortBy;t=this.collectionService?.sortCollection(this.columnDef,t,e,this.enableTranslateLabel)||[]}return t}watchCollectionChanges(){this.columnFilter?.collection&&(u(this.columnFilter.collection,this.watchCallback.bind(this)),p(this.columnFilter,"collection",this.propertyObserverCallback.bind(this)))}propertyObserverCallback(e){this.renderDomElement(e||[]),this.columnFilter.collection&&u(this.columnFilter.collection,this.watchCallback.bind(this))}watchCallback(e){this.renderDomElement(this.columnFilter.collection||e||[])}renderDomElement(e){if(!Array.isArray(e)&&this.collectionOptions?.collectionInsideObjectProperty&&(e=H(e,this.collectionOptions.collectionInsideObjectProperty||"")),!Array.isArray(e))throw new Error('The "collection" passed to the Select Filter is not a valid array.');let t=[];e.length>0&&(t=[...e]),this.collectionOptions?.addBlankEntry&&Array.isArray(t)&&t.length>0&&""!==t[0][this.valueName]&&t.unshift(this.createBlankEntry()),this.collectionOptions?.addCustomFirstEntry&&Array.isArray(t)&&t.length>0&&t[0][this.valueName]!==this.collectionOptions.addCustomFirstEntry[this.valueName]&&t.unshift(this.collectionOptions.addCustomFirstEntry),this.collectionOptions?.addCustomLastEntry&&Array.isArray(t)&&t.length>0&&t[t.length-1][this.valueName]!==this.collectionOptions.addCustomLastEntry[this.valueName]&&t.push(this.collectionOptions.addCustomLastEntry);let i=t;i=this.filterCollection(i),i=this.sortCollection(i);const n=pn("filter",i,this.columnDef,this.grid,this.isMultipleSelect,this.translaterService,this.searchTerms||[]);this.isFilled=n.hasFoundSearchTerm,this.createFilterElement(n.selectElement,n.dataCollection),this._collectionLength=i.length}createBlankEntry(){const e={[this.labelName]:"",[this.valueName]:""};return this.labelPrefixName&&(e[this.labelPrefixName]=""),this.labelSuffixName&&(e[this.labelSuffixName]=""),e}createFilterElement(e,t){const i=this.columnDef?.id??"";this.elementName=`filter-${i}`,this.defaultOptions.name=this.elementName,ee(this.filterContainerElm),this.filterElm=e,this.filterElm.dataset.columnId=`${i}`,this.updateFilterStyle(this.isFilled),this.filterContainerElm.appendChild(e),this.filterElmOptions={...this.defaultOptions,...this.filterOptions,data:t},this._msInstance=ba(e,this.filterElmOptions)}initMultipleSelectTemplate(){const e=this.gridOptions?.enableTranslate??!1,t={autoAdjustDropHeight:!0,autoAdjustDropPosition:!0,autoAdjustDropWidthByTextSize:!0,name:`${this.columnDef?.id??""}`,container:"body",darkMode:!!this.gridOptions.darkMode,filter:!1,maxHeight:275,single:!0,singleRadio:!0,showSearchClear:!0,renderOptionLabelAsHtml:this.columnFilter?.enableRenderHtml??!1,sanitizer:e=>this.grid.sanitizeHtmlString(e),onClose:()=>this.onTriggerEvent(),onClear:()=>this.clear()};if(this._isMultipleSelect){t.single=!1,t.singleRadio=!1,t.showOkButton=!0,t.displayTitle=!0;const i=B(this.gridOptions);t.countSelectedText=e&&this.translaterService?.translate?this.translaterService.translate(`${i}X_OF_Y_SELECTED`):this._locales?.TEXT_X_OF_Y_SELECTED,t.allSelectedText=e&&this.translaterService?.translate?this.translaterService.translate(`${i}ALL_SELECTED`):this._locales?.TEXT_ALL_SELECTED,t.noMatchesFoundText=e&&this.translaterService?.translate?this.translaterService.translate(`${i}NO_MATCHES_FOUND`):this._locales?.TEXT_NO_MATCHES_FOUND,t.okButtonText=e&&this.translaterService?.translate?this.translaterService.translate(`${i}OK`):this._locales?.TEXT_OK,t.selectAllText=e&&this.translaterService?.translate?this.translaterService.translate(`${i}SELECT_ALL`):this._locales?.TEXT_SELECT_ALL}this.defaultOptions=t}onTriggerEvent(){if(this._msInstance){const e=this.getValues();this.updateFilterStyle(Array.isArray(e)&&e.length>1||1===e.length&&""!==e[0]),this.searchTerms=e,this.callback(void 0,{columnDef:this.columnDef,operator:this.operator,searchTerms:e,shouldTriggerQuery:this._shouldTriggerQuery}),this._shouldTriggerQuery=!0}}updateFilterStyle(e){e?(this.isFilled=!0,this.filterElm?.classList.add("filled"),this._msInstance?.getParentElement()?.classList.add("filled")):(this.isFilled=!1,this.filterElm?.classList.remove("filled"),this._msInstance?.getParentElement()?.classList.remove("filled"))}}const wa={autocompleter:class{constructor(e,t,i){this.translaterService=e,this.collectionService=t,this.rxjs=i,this._clearFilterTriggered=!1,this._shouldTriggerQuery=!0,this.searchTerms=[],this.isFilled=!1,this.isItemSelected=!1,this.valueName="label",this.enableTranslateLabel=!1,this.subscriptions=[],this._bindEventService=new Ft}get autocompleterOptions(){return this._autocompleterOptions||{}}get collectionOptions(){return this.columnDef?.filter?.collectionOptions??{}}get collection(){return this._collection}get columnFilter(){return this.columnDef?.filter||{}}get filterDomElement(){return this._filterElm}get filterOptions(){return{...this.gridOptions.defaultFilterOptions?.autocompleter,...this.columnFilter?.filterOptions}}get customStructure(){let e=this.columnFilter?.customStructure;const t=this.columnFilter?.type??this.columnDef?.type;return!e&&t===b.object&&this.columnDef?.dataKey&&this.columnDef?.labelKey&&(e={label:this.columnDef.labelKey,value:this.columnDef.dataKey}),e}get defaultOperator(){return S.equal}get gridOptions(){return this.grid?.getOptions()??{}}get instance(){return this._instance}get operator(){return this.columnFilter?.operator??this.defaultOperator}set operator(e){this.columnFilter&&(this.columnFilter.operator=e)}init(e){if(!e)throw new Error('[Slickgrid-Universal] A filter must always have an "init()" with valid arguments.');if(this.grid=e.grid,this.callback=e.callback,this.columnDef=e.columnDef,this.searchTerms=(e.hasOwnProperty("searchTerms")?e.searchTerms:[])||[],this.filterContainerElm=e.filterContainerElm,!(this.grid&&this.columnDef&&this.columnFilter&&(this.columnFilter.collection||this.columnFilter.collectionAsync||this.columnFilter.filterOptions)))throw new Error("[Slickgrid-Universal] You need to pass a \"collection\" (or \"collectionAsync\") for the AutoComplete Filter to work correctly. Also each option should include a value/label pair (or value/labelKey when using Locale). For example:: { filter: model: Filters.autocompleter, collection: [{ value: true, label: 'True' }, { value: false, label: 'False'}] }");this.enableTranslateLabel=this.columnFilter?.enableTranslateLabel??!1,this.labelName=this.customStructure?.label??"label",this.valueName=this.customStructure?.value??"value",this.labelPrefixName=this.customStructure?.labelPrefix??"labelPrefix",this.labelSuffixName=this.customStructure?.labelSuffix??"labelSuffix",this._locales=this.gridOptions?.locales??m.locales;const t=this.columnFilter.collection;return this._collection=t,this.renderDomElement(t),new Promise((async(e,i)=>{try{const i=this.columnFilter.collectionAsync;let n;i&&!this.columnFilter.collection?(n=$t(i,this.columnDef,this.renderDomElement.bind(this),this.rxjs,this.subscriptions),e(n)):(n=t,e(t)),(i||this.columnFilter.enableCollectionWatch)&&(await(n??i),this.watchCollectionChanges())}catch(e){i(e)}}))}clear(e=!0){this._filterElm&&(this._clearFilterTriggered=!0,this._shouldTriggerQuery=e,this.searchTerms=[],this._filterElm.value="",this._filterElm.dispatchEvent(new CustomEvent("input")),this.updateFilterStyle(!1))}destroy(){"function"==typeof this._instance?.destroy&&this._instance.destroy(),this._filterElm,this._filterElm?.remove?.(),this._collection=void 0,this._bindEventService.unbindAll(),Y(this.subscriptions)}getValues(){return this._filterElm?.value||""}setValues(e,t,i=!1){e&&this._filterElm&&(this._filterElm.value=e),this.updateFilterStyle(""!==this.getValues()),this.operator=t||this.defaultOperator,i&&this.callback(void 0,{columnDef:this.columnDef,operator:this.operator,searchTerms:[this.getValues()],shouldTriggerQuery:!0})}filterCollection(e){let t=e;if(this.columnFilter&&this.columnFilter.collectionFilterBy){const e=this.columnFilter.collectionFilterBy,i=this.columnFilter.collectionOptions&&this.columnFilter.collectionOptions.filterResultAfterEachPass||null;t=this.collectionService?.filterCollection(t,e,i)||[]}return t}sortCollection(e){let t=e;if(this.columnFilter&&this.columnFilter.collectionSortBy){const e=this.columnFilter.collectionSortBy;t=this.collectionService?.sortCollection(this.columnDef,t,e,this.enableTranslateLabel)||[]}return t}watchCollectionChanges(){this.columnFilter?.collection&&(u(this.columnFilter.collection,(e=>{this.renderDomElement(this.columnFilter.collection||e||[])})),p(this.columnFilter,"collection",(e=>{this.renderDomElement(e||[]),this.columnFilter.collection&&u(this.columnFilter.collection,(e=>{this.renderDomElement(this.columnFilter.collection||e||[])}))})))}renderDomElement(e){!Array.isArray(e)&&this.collectionOptions?.collectionInsideObjectProperty&&(e=H(e,this.collectionOptions.collectionInsideObjectProperty||""));let t=e;t&&(t=this.filterCollection(t),t=this.sortCollection(t));const i=Array.isArray(this.searchTerms)&&this.searchTerms.length>=0?this.searchTerms[0]:"";this._collection=t,this._filterElm=this.createFilterElement(t,i),this._bindEventService.bind(this._filterElm,"input",this.handleOnInputChange.bind(this)),this._bindEventService.bind(this._filterElm,"blur",(()=>{this.isItemSelected||this.clear()}))}createFilterElement(e,t){this._collection=e;const i=this.columnDef?.id??"";ee(this.filterContainerElm);let n=this.gridOptions?.defaultFilterPlaceholder??"";this.columnFilter?.placeholder&&(n=this.columnFilter.placeholder),this._filterElm=Z("input",{type:"text",ariaLabel:this.columnFilter?.ariaLabel??`${We(i+"")} Search Filter`,autocomplete:"off",ariaAutoComplete:"none",placeholder:n,className:`form-control search-filter filter-${i} slick-autocomplete-container`,value:t??"",dataset:{columnid:`${i}`}});const s=t;Array.isArray(e)&&(e=e.every((e=>Re(e)))?e.map((e=>({label:e,value:e}))):e.map((e=>({label:e?.[this.labelName],value:e?.[this.valueName],labelPrefix:e?.[this.labelPrefixName]??"",labelSuffix:e?.[this.labelSuffixName]??""})))),this._autocompleterOptions={input:this._filterElm,debounceWaitMs:200,className:`slick-autocomplete ${this.filterOptions?.className??""}`.trim(),emptyMsg:this.gridOptions.enableTranslate&&this.translaterService?.translate?this.translaterService.translate("NO_ELEMENTS_FOUND"):this._locales?.TEXT_NO_ELEMENTS_FOUND??"No elements found",customize:(e,t,i)=>{i.style.width=""},onSelect:e=>{this.isItemSelected=!0,this.handleSelect(e)},...this.filterOptions},this.gridOptions?.darkMode&&(this._autocompleterOptions.className+=" slick-dark-mode"),this.autocompleterOptions.className=Q(this.autocompleterOptions.className).join(" "),this._autocompleterOptions.renderItem?.layout?(this._autocompleterOptions.className+=` autocomplete-custom-${Ve(this._autocompleterOptions.renderItem.layout)}`,this._autocompleterOptions.render=this.renderCustomItem.bind(this)):Array.isArray(e)?this._autocompleterOptions.render=this._autocompleterOptions.render?.bind(this)??this.renderCollectionItem.bind(this):this._autocompleterOptions.render||(this._autocompleterOptions.render=this.renderRegularItem.bind(this)),this.filterOptions?.fetch?(zt(this._filterElm,this._autocompleterOptions),this._instance=Nt(this._autocompleterOptions)):this._instance=Nt({...this._autocompleterOptions,fetch:(t,i)=>{e&&i(e.filter((e=>(("string"==typeof e?e:e?.label)||"").toLowerCase().includes(t.toLowerCase()))))}}),this._filterElm.value=s??"";const r=Z("div",{className:"autocomplete-filter-container"});return r.appendChild(this._filterElm),r.appendChild(Z("span")),t&&this._filterElm.classList.add("filled"),this.filterContainerElm.appendChild(r),this.filterContainerElm.appendChild(document.createElement("span")),this._filterElm}handleSelect(e){if(void 0!==e){const t=void 0,i=this.filterOptions?.renderItem??!1,n="string"==typeof e?e:i?e[this.labelName]:e.label;let s="string"==typeof e?e:i?e[this.valueName]:e.value;s=this.trimWhitespaceWhenEnabled(s),this.updateFilterStyle(""!==s),this.setValues(n),this.callback(t,{columnDef:this.columnDef,operator:this.operator,searchTerms:[s],shouldTriggerQuery:this._shouldTriggerQuery}),this._clearFilterTriggered=!1,this._shouldTriggerQuery=!0}return!1}handleOnInputChange(e){let t=e?.target?.value??"";const i=this.filterOptions.triggerOnEveryKeyStroke??!1;if(t=this.trimWhitespaceWhenEnabled(t),this._clearFilterTriggered||""===t||i){const i={columnDef:this.columnDef,shouldTriggerQuery:this._shouldTriggerQuery};this._clearFilterTriggered?i.clearFilterTriggered=this._clearFilterTriggered:(i.operator=this.operator,i.searchTerms=[t]),this.updateFilterStyle(""!==t),this.callback(e,i)}this._clearFilterTriggered=!1,this._shouldTriggerQuery=!0}renderRegularItem(e){return Z("div",{textContent:("string"==typeof e?e:e?.label??"")||""})}renderCustomItem(e){const t=this._autocompleterOptions?.renderItem?.templateCallback(e)??"",i=document.createElement("div");return this.grid.applyHtmlCode(i,t),i}renderCollectionItem(e){const t=this.columnFilter?.enableRenderHtml??!1,i=(e.labelPrefix||"")+(e.label||"")+(e.labelSuffix||""),n=this.grid.sanitizeHtmlString(i)||"",s=document.createElement("div");return s[t?"innerHTML":"textContent"]=n,s}trimWhitespaceWhenEnabled(e){let t=e;const i=this.gridOptions.enableFilterTrimWhiteSpace||this.columnFilter.enableTrimWhiteSpace;return"string"==typeof e&&i&&(t=e.trim()),t}updateFilterStyle(e){this.isItemSelected=e,e?this._filterElm.classList.add("filled"):this._filterElm.classList.remove("filled")}},compoundDate:class extends dn{constructor(e){super(e),this.translaterService=e,this.inputFilterType="compound"}},compoundInput:Uo,compoundInputNumber:class extends $o{constructor(e){super(e),this.translaterService=e,this.inputType="number",this.inputFilterType="compound"}},compoundInputPassword:class extends $o{constructor(e){super(e),this.translaterService=e,this.inputType="password",this.inputFilterType="compound"}},compoundInputText:Uo,compoundSlider:class extends Go{constructor(e){super(e),this.translaterService=e,this.sliderType="compound"}},dateRange:class extends dn{constructor(e){super(e),this.translaterService=e,this.inputFilterType="range"}},input:$o,inputMask:class extends $o{constructor(e){super(e),this.translaterService=e,this._inputMask="",this.inputType="text"}get inputMask(){return this._inputMask}init(e){if(!e)throw new Error('[Slickgrid-Universal] A filter must always have an "init()" with valid arguments.');if(this.grid=e.grid,this.callback=e.callback,this.columnDef=e.columnDef,this.searchTerms=(e.hasOwnProperty("searchTerms")?e.searchTerms:[])||[],this._cellContainerElm=e.filterContainerElm,this.columnDef?.params?.mask?this._inputMask=this.columnDef.params.mask:this.columnFilter?.params?.mask&&(this._inputMask=this.columnFilter.params.mask),!this._inputMask)throw new Error("[Slickgrid-Universal] The Filters.inputMask requires the mask to be passed in the filter params or the column definition params\n        for example:: this.columnDefinitions: [{ id: 'phone', field: 'phone', filter: { model: Filters.inputMask, params: { mask: '000-000-0000' }}}]");const t=Array.isArray(this.searchTerms)&&this.searchTerms.length>=0?this.searchTerms[0]:"";this.createDomFilterElement(t),this._bindEventService.bind(this._filterInputElm,["keyup","blur","change"],this.onTriggerEvent.bind(this))}onTriggerEvent(e,t=!1){let i="";if(e?.target?.value){let t=e?.target?.value??"";const n=this.gridOptions.enableFilterTrimWhiteSpace||this.columnFilter.enableTrimWhiteSpace;"string"==typeof t&&n&&(t=t.trim());const s=this.unmaskValue(t),r=this.maskValue(s);i=s,e?.keyCode>=48&&(this._filterInputElm.value=r,e.preventDefault())}t?(this.callback(e,{columnDef:this.columnDef,clearFilterTriggered:t,shouldTriggerQuery:this._shouldTriggerQuery}),this._filterInputElm.classList.remove("filled")):(this._filterInputElm.classList.add("filled"),this.callback(e,{columnDef:this.columnDef,operator:this.operator,searchTerms:[i],shouldTriggerQuery:this._shouldTriggerQuery})),this._shouldTriggerQuery=!0}maskValue(e){let t=0,i="";return this._inputMask&&(i=this._inputMask.replace(/[09A]/gi,(i=>(("0"===i||"9"===i)&&/\d+/g.test(e[t])||"A"===i.toUpperCase()&&/[^\d]+/gi.test(e[t]))&&e[t++]||""))),i}unmaskValue(e){const t=e.replace(/[^0-9a-z]*/gi,""),i=this._inputMask.replace(/[^0-9a-z]*/gi,"");let n="";for(let e=0;e<i.length;e++)t[e]&&(("0"===i[e]||"9"===i[e])&&/\d+/g.test(t[e])||"A"===i[e].toUpperCase()&&/[^\d]+/gi.test(t[e]))&&(n+=t[e]);return n}},inputNumber:class extends $o{constructor(e){super(e),this.translaterService=e,this.inputType="number"}},inputPassword:class extends $o{constructor(e){super(e),this.translaterService=e,this.inputType="password"}},inputText:$o,multipleSelect:class extends Ca{constructor(e,t,i){super(e,t,i,!0),this.translaterService=e,this.collectionService=t,this.rxjs=i}},singleSelect:class extends Ca{constructor(e,t,i){super(e,t,i,!1),this.translaterService=e,this.collectionService=t,this.rxjs=i}},slider:class extends Go{constructor(e){super(e),this.translaterService=e,this.sliderType="single"}},sliderRange:class extends Go{constructor(e){super(e),this.translaterService=e,this.sliderType="double"}}};class Sa{constructor(e,t,i,n){this.config=e,this.translaterService=t,this.collectionService=i,this.rxjs=n,this._options=this.config?.options??{}}addRxJsResource(e){this.rxjs=e}createFilter(e){let t;return e?.model&&(t="function"==typeof e.model?new e.model(this.translaterService,this.collectionService,this.rxjs):e.model),!t&&this._options.defaultFilter&&(t=new this._options.defaultFilter(this.translaterService,this.collectionService,this.rxjs)),t}}const Ea={alwaysShowVerticalScroll:!0,autoEdit:!1,asyncEditorLoading:!1,autoFitColumnsOnFirstLoad:!0,autoFixResizeTimeout:1500,autoFixResizeRequiredGoodCount:2,autoFixResizeWhenBrokenStyleDetected:!1,autoParseInputFilterOperator:!0,autoResize:{applyResizeToContainer:!0,calculateAvailableSizeBy:"window",bottomPadding:20,minHeight:180,minWidth:300,rightPadding:0},cellHighlightCssClass:"slick-cell-modified",checkboxSelector:{cssClass:"slick-cell-checkboxsel",width:40},columnGroupSeparator:" - ",columnPicker:{hideForceFitButton:!1,hideSyncResizeButton:!0,headerColumnValueExtractor:xa},cellMenu:{autoAdjustDrop:!0,autoAlignSide:!0,hideCloseButton:!0,hideCommandSection:!1,hideOptionSection:!1,showBulletWhenIconMissing:!0,subItemChevronClass:"mdi mdi-chevron-down mdi-rotate-270"},compositeEditorOptions:{labels:{cancelButtonKey:"CANCEL",cloneButtonKey:"CLONE",resetEditorButtonTooltipKey:"RESET_INPUT_VALUE",resetFormButtonKey:"RESET_FORM",massSelectionButtonKey:"APPLY_TO_SELECTION",massSelectionStatusKey:"X_OF_Y_MASS_SELECTED",massUpdateButtonKey:"APPLY_MASS_UPDATE",massUpdateStatusKey:"ALL_X_RECORDS_SELECTED",saveButtonKey:"SAVE"}},contextMenu:{autoAdjustDrop:!0,autoAlignSide:!0,hideCloseButton:!0,hideClearAllGrouping:!1,hideCollapseAllGroups:!1,hideCommandSection:!1,hideCopyCellValueCommand:!1,hideExpandAllGroups:!1,hideExportCsvCommand:!1,hideExportExcelCommand:!1,hideExportTextDelimitedCommand:!0,hideMenuOnScroll:!0,hideOptionSection:!1,iconCollapseAllGroupsCommand:"mdi mdi-arrow-collapse",iconExpandAllGroupsCommand:"mdi mdi-arrow-expand",iconClearGroupingCommand:"mdi mdi-close",iconCopyCellValueCommand:"mdi mdi-content-copy",iconExportCsvCommand:"mdi mdi-download",iconExportExcelCommand:"mdi mdi-file-excel-outline",iconExportTextDelimitedCommand:"mdi mdi-download",showBulletWhenIconMissing:!0,subItemChevronClass:"mdi mdi-chevron-down mdi-rotate-270"},customFooterOptions:{dateFormat:"YYYY-MM-DD, hh:mm a",hideRowSelectionCount:!1,hideTotalItemCount:!1,hideLastUpdateTimestamp:!0,footerHeight:25,leftContainerClass:"col-xs-12 col-sm-5",rightContainerClass:"col-xs-6 col-sm-7",metricSeparator:"|",metricTexts:{itemsKey:"ITEMS",ofKey:"OF",itemsSelectedKey:"ITEMS_SELECTED"}},customTooltip:{tooltipTextMaxLength:700,maxWidth:500},dataView:{syncGridSelection:{preserveHidden:!1,preserveHiddenOnSelectionChange:!0},syncGridSelectionWithBackendService:!1},datasetIdPropertyName:"id",defaultFilter:wa.input,defaultBackendServiceFilterTypingDebounce:500,enableFilterTrimWhiteSpace:!1,defaultFilterPlaceholder:"ðï¸",defaultFilterRangeOperator:S.rangeInclusive,defaultColumnSortFieldId:"id",draggableGrouping:{hideToggleAllButton:!1,toggleAllButtonText:"",dropPlaceHolderTextKey:"DROP_COLUMN_HEADER_TO_GROUP_BY"},editable:!1,editorTypingDebounce:450,filterTypingDebounce:0,enableEmptyDataWarningMessage:!0,emptyDataWarning:{className:"slick-empty-data-warning",messageKey:"EMPTY_DATA_WARNING_MESSAGE",hideFrozenLeftWarning:!1,hideFrozenRightWarning:!1,leftViewportMarginLeft:"40%",rightViewportMarginLeft:"40%",frozenLeftViewportMarginLeft:"0px",frozenRightViewportMarginLeft:"40%"},enableAutoResize:!0,enableAutoSizeColumns:!0,enableCellNavigation:!1,enableColumnPicker:!0,enableColumnReorder:!0,enableColumnResizeOnDoubleClick:!0,enableContextMenu:!0,enableExcelExport:!1,enableTextExport:!1,enableGridMenu:!0,enableHeaderMenu:!0,enableMouseHoverHighlightRow:!0,enableSorting:!0,enableTextSelectionOnCells:!0,explicitInitialization:!0,excelExportOptions:{addGroupIndentation:!0,autoDetectCellFormat:!0,exportWithFormatter:!1,filename:"export",format:y.xlsx,groupingColumnHeaderTitle:"Group By",groupCollapsedSymbol:"â®",groupExpandedSymbol:"â®",groupingAggregatorRowText:"",sanitizeDataExport:!0},textExportOptions:{delimiter:v.comma,exportWithFormatter:!1,filename:"export",format:y.csv,groupingColumnHeaderTitle:"Group By",groupingAggregatorRowText:"",sanitizeDataExport:!0,useUtf8WithBom:!0},eventNamingStyle:Mt.lowerCase,forceFitColumns:!1,frozenHeaderWidthCalcDifferential:1,gridMenu:{dropSide:"left",commandLabels:{clearAllFiltersCommandKey:"CLEAR_ALL_FILTERS",clearAllSortingCommandKey:"CLEAR_ALL_SORTING",clearFrozenColumnsCommandKey:"CLEAR_PINNING",exportCsvCommandKey:"EXPORT_TO_CSV",exportExcelCommandKey:"EXPORT_TO_EXCEL",exportTextDelimitedCommandKey:"EXPORT_TO_TAB_DELIMITED",refreshDatasetCommandKey:"REFRESH_DATASET",toggleDarkModeCommandKey:"TOGGLE_DARK_MODE",toggleFilterCommandKey:"TOGGLE_FILTER_ROW",togglePreHeaderCommandKey:"TOGGLE_PRE_HEADER_ROW"},hideClearAllFiltersCommand:!1,hideClearAllSortingCommand:!1,hideClearFrozenColumnsCommand:!0,hideExportCsvCommand:!1,hideExportExcelCommand:!1,hideExportTextDelimitedCommand:!0,hideForceFitButton:!1,hideRefreshDatasetCommand:!1,hideSyncResizeButton:!0,hideToggleFilterCommand:!1,hideToggleDarkModeCommand:!0,hideTogglePreHeaderCommand:!1,iconCssClass:"mdi mdi-menu",iconClearAllFiltersCommand:"mdi mdi-filter-remove-outline",iconClearAllSortingCommand:"mdi mdi-sort-variant-off",iconClearFrozenColumnsCommand:"mdi mdi-pin-off-outline",iconExportCsvCommand:"mdi mdi-download",iconExportExcelCommand:"mdi mdi-file-excel-outline",iconExportTextDelimitedCommand:"mdi mdi-download",iconRefreshDatasetCommand:"mdi mdi-sync",iconToggleDarkModeCommand:"mdi mdi-brightness-4",iconToggleFilterCommand:"mdi mdi-flip-vertical",iconTogglePreHeaderCommand:"mdi mdi-flip-vertical",menuWidth:16,resizeOnShowHeaderRow:!0,showBulletWhenIconMissing:!0,subItemChevronClass:"mdi mdi-chevron-down mdi-rotate-270",headerColumnValueExtractor:xa},headerMenu:{autoAlign:!0,autoAlignOffset:4,minWidth:140,iconClearFilterCommand:"mdi mdi-filter-remove-outline",iconClearSortCommand:"mdi mdi-sort-variant-off",iconFilterShortcutSubMenu:"mdi mdi-filter-outline",iconFreezeColumns:"mdi mdi-pin-outline",iconSortAscCommand:"mdi mdi-sort-ascending",iconSortDescCommand:"mdi mdi-sort-descending",iconColumnHideCommand:"mdi mdi-close",iconColumnResizeByContentCommand:"mdi mdi-arrow-expand-horizontal",hideColumnResizeByContentCommand:!1,hideColumnHideCommand:!1,hideClearFilterCommand:!1,hideClearSortCommand:!1,hideFreezeColumnsCommand:!0,hideSortCommands:!1,subItemChevronClass:"mdi mdi-chevron-down mdi-rotate-270"},ignoreAccentOnStringFilterAndSort:!1,multiColumnSort:!0,numberedMultiColumnSort:!0,tristateMultiColumnSort:!1,sortColNumberInSeparateSpan:!0,suppressActiveCellChangeOnEdit:!1,pagination:{pageSizes:[10,15,20,25,30,40,50,75,100],pageSize:25,totalItems:0},headerRowHeight:35,rowHeight:35,topPanelHeight:30,translationNamespaceSeparator:":",resetFilterSearchValueAfterOnBeforeCancellation:!0,resizeByContentOnlyOnFirstLoad:!0,resizeByContentOptions:{alwaysRecalculateColumnWidth:!1,cellCharWidthInPx:7.8,cellPaddingWidthInPx:14,defaultRatioForStringType:.88,formatterPaddingWidthInPx:0,maxItemToInspectCellContentWidth:1e3,maxItemToInspectSingleColumnWidthByContent:5e3,widthToRemoveFromExceededWidthReadjustment:50},treeDataOptions:{exportIndentMarginLeft:5,exportIndentationLeadingChar:"ÍÍÍÍÍÍÍÍÍÂ·"}};function xa(e,t){let i=e?.columnPickerLabel??e?.name??"";(i instanceof HTMLElement||i instanceof DocumentFragment)&&(i=i.textContent||"");const n=e?.columnGroup||"";return n?n+(t?.columnGroupSeparator??" - ")+i:i}const Ta={Avg:class{constructor(e){this._isInitialized=!1,this._isTreeAggregator=!1,this._nonNullCount=0,this._sum=0,this._type="avg",this._field=e}get field(){return this._field}get isInitialized(){return this._isInitialized}get type(){return this._type}init(e,t=!1){this._sum=0,this._nonNullCount=0,this._isInitialized=!0,this._isTreeAggregator=t,t&&(e.__treeTotals||(e.__treeTotals={}),void 0===e.__treeTotals[this._type]&&(e.__treeTotals[this._type]={},e.__treeTotals.sum={},e.__treeTotals.count={}),e.__treeTotals[this._type][this._field]=0,e.__treeTotals.count[this._field]=0,e.__treeTotals.sum[this._field]=0)}accumulate(e,t=!1){const i=e?.hasOwnProperty(this._field)?e[this._field]:null;this._isTreeAggregator?t?(e.__treeTotals||(e.__treeTotals={}),this.addGroupTotalPropertiesWhenNotExist(e.__treeTotals),this._sum=parseFloat(e.__treeTotals.sum[this._field]??0),this._nonNullCount=e.__treeTotals.count[this._field]??0):Me(i)&&(this._sum=parseFloat(i),this._nonNullCount=1):Me(i)&&(this._nonNullCount++,this._sum+=parseFloat(i))}storeResult(e){let t=this._sum,i=this._nonNullCount;this.addGroupTotalPropertiesWhenNotExist(e),this._isTreeAggregator&&(t+=e.sum[this._field],i+=e.count[this._field],e.sum[this._field]=t,e.count[this._field]=i),0!==i&&(e[this._type][this._field]=0===i?t:t/i)}addGroupTotalPropertiesWhenNotExist(e){void 0===e[this._type]&&(e[this._type]={}),this._isTreeAggregator&&void 0===e.sum&&(e.sum={}),this._isTreeAggregator&&void 0===e.count&&(e.count={})}},Clone:class{constructor(e){this._isInitialized=!1,this._data="",this._type="clone",this._field=e}get field(){return this._field}get isInitialized(){return this._isInitialized}get type(){return this._type}init(e,t=!1){if(this._data="",this._isInitialized=!0,t)throw new Error("[Slickgrid-Universal] CloneAggregator is not currently supported for use with Tree Data")}accumulate(e){const t=e&&e.hasOwnProperty(this._field)?e[this._field]:null;null!==t&&""!==t&&(this._data=t)}storeResult(e){e&&void 0!==e[this._type]||(e[this._type]={}),e[this._type][this._field]=this._data}},Count:class{constructor(e){this._isInitialized=!1,this._isTreeAggregator=!1,this._count=0,this._type="count",this._field=e}get field(){return this._field}get isInitialized(){return this._isInitialized}get type(){return this._type}init(e,t=!1){this._count=0,this._isInitialized=!0,this._isTreeAggregator=t,t&&(e.__treeTotals||(e.__treeTotals={}),void 0===e.__treeTotals[this._type]&&(e.__treeTotals[this._type]={}),e.__treeTotals[this._type][this._field]=0)}accumulate(e,t=!1){const i=e?.hasOwnProperty(this._field)?e[this._field]:null;this._isTreeAggregator&&(t?(e.__treeTotals||(e.__treeTotals={}),void 0===e.__treeTotals[this._type]&&(e.__treeTotals[this._type]={}),this._count=e.__treeTotals[this._type][this._field]??0):Me(i)&&(this._count=1))}storeResult(e){e&&void 0!==e[this._type]||(e[this._type]={});let t=this._count;this._isTreeAggregator?t+=e[this._type][this._field]:t=e.group?.rows?.length??0,e[this._type][this._field]=t}},Distinct:class{constructor(e){this._isInitialized=!1,this._distinctValues=[],this._type="distinct",this._field=e}get field(){return this._field}get isInitialized(){return this._isInitialized}get type(){return this._type}init(e,t=!1){if(this._distinctValues=[],this._isInitialized=!0,t)throw new Error("[Slickgrid-Universal] CloneAggregator is not currently supported for use with Tree Data")}accumulate(e){const t=e&&e.hasOwnProperty(this._field)?e[this._field]:void 0;-1===this._distinctValues.indexOf(t)&&void 0!==t&&this._distinctValues.push(t)}storeResult(e){e&&void 0!==e[this._type]||(e[this._type]={}),e[this._type][this._field]=this._distinctValues}},Min:class{constructor(e){this._isInitialized=!1,this._isTreeAggregator=!1,this._min=null,this._type="min",this._field=e}get field(){return this._field}get isInitialized(){return this._isInitialized}get type(){return this._type}init(e,t=!1){this._min=null,this._isInitialized=!0,this._isTreeAggregator=t,t&&(e.__treeTotals||(e.__treeTotals={}),void 0===e.__treeTotals[this._type]&&(e.__treeTotals[this._type]={}),e.__treeTotals[this._type][this._field]=null)}accumulate(e,t=!1){const i=e?.hasOwnProperty(this._field)?e[this._field]:null;if(this._isTreeAggregator)if(t){e.__treeTotals||(e.__treeTotals={}),this.addGroupTotalPropertiesWhenNotExist(e.__treeTotals);const t=null!==e.__treeTotals[this._type][this._field]?parseFloat(e.__treeTotals[this._type][this._field]):null;null!==t&&Me(t)&&(null===this._min||t<this._min)&&(this._min=t)}else Me(i)&&this.keepMinValueWhenFound(i);else this.keepMinValueWhenFound(i)}storeResult(e){let t=this._min;if(this.addGroupTotalPropertiesWhenNotExist(e),this._isTreeAggregator&&null!==t){const i=e[this._type][this._field];Me(i)&&i<t&&(t=i)}e[this._type][this._field]=t}addGroupTotalPropertiesWhenNotExist(e){void 0===e[this._type]&&(e[this._type]={})}keepMinValueWhenFound(e){Me(e)&&(null===this._min||e<this._min)&&(this._min=parseFloat(e))}},Max:class{constructor(e){this._isInitialized=!1,this._isTreeAggregator=!1,this._max=null,this._type="max",this._field=e}get field(){return this._field}get isInitialized(){return this._isInitialized}get type(){return this._type}init(e,t=!1){this._max=null,this._isInitialized=!0,this._isTreeAggregator=t,t&&(e.__treeTotals||(e.__treeTotals={}),void 0===e.__treeTotals[this._type]&&(e.__treeTotals[this._type]={}),e.__treeTotals[this._type][this._field]=null)}accumulate(e,t=!1){const i=e?.hasOwnProperty(this._field)?e[this._field]:null;if(this._isTreeAggregator)if(t){e.__treeTotals||(e.__treeTotals={}),this.addGroupTotalPropertiesWhenNotExist(e.__treeTotals);const t=null!==e.__treeTotals[this._type][this._field]?parseFloat(e.__treeTotals[this._type][this._field]):null;null!==t&&Me(t)&&(null===this._max||t>this._max)&&(this._max=t)}else Me(i)&&this.keepMaxValueWhenFound(i);else this.keepMaxValueWhenFound(i)}storeResult(e){let t=this._max;if(this.addGroupTotalPropertiesWhenNotExist(e),this._isTreeAggregator&&null!==t){const i=e[this._type][this._field];Me(i)&&i>t&&(t=i)}e[this._type][this._field]=t}addGroupTotalPropertiesWhenNotExist(e){void 0===e[this._type]&&(e[this._type]={})}keepMaxValueWhenFound(e){Me(e)&&(null===this._max||e>this._max)&&(this._max=parseFloat(e))}},Sum:class{constructor(e){this._isInitialized=!1,this._isTreeAggregator=!1,this._sum=0,this._itemCount=0,this._type="sum",this._field=e}get field(){return this._field}get isInitialized(){return this._isInitialized}get type(){return this._type}init(e,t=!1){this._isTreeAggregator=t,this._isInitialized=!0,this._sum=0,this._itemCount=0,t&&(e.__treeTotals||(e.__treeTotals={}),void 0===e.__treeTotals[this._type]&&(e.__treeTotals[this._type]={},e.__treeTotals.count={}),e.__treeTotals.count[this._field]=0,e.__treeTotals[this._type][this._field]=0)}accumulate(e,t=!1){const i=e?.hasOwnProperty(this._field)?e[this._field]:null;this._isTreeAggregator?t?(e.__treeTotals||(e.__treeTotals={}),this.addGroupTotalPropertiesWhenNotExist(e.__treeTotals),this._sum=parseFloat(e.__treeTotals[this._type][this._field]??0),this._itemCount=e.__treeTotals.count[this._field]??0):Me(i)&&(this._sum=parseFloat(i),this._itemCount=1):Me(i)&&(this._sum+=parseFloat(i))}storeResult(e){e&&void 0!==e[this._type]||(e[this._type]={}),this.addGroupTotalPropertiesWhenNotExist(e);let t=this._sum,i=this._itemCount;this._isTreeAggregator&&(t+=e[this._type][this._field],i+=e.count[this._field],e.count[this._field]=i),e[this._type][this._field]=t}addGroupTotalPropertiesWhenNotExist(e){void 0===e[this._type]&&(e[this._type]={}),this._isTreeAggregator&&void 0===e.count&&(e.count={})}}};function Aa(e,t){const i=t.errorMessage,n=t.required,s=t.minLength,r=t.maxLength,o=t.operatorConditionalType||"inclusive",a={"{{minLength}}":s,"{{maxLength}}":r};let l=!0,c="";const h=e?.length??0;if(t.validator)return t.validator(e,t.editorArgs);if(n&&""===e)l=!1,c=i||m.VALIDATION_REQUIRED_FIELD;else if(void 0!==s&&void 0!==r&&("exclusive"===o&&(h<=s||h>=r)||"inclusive"===o&&(h<s||h>r)))l=!1,c=i||m.VALIDATION_EDITOR_TEXT_LENGTH_BETWEEN.replace(/{{minLength}}|{{maxLength}}/gi,(e=>a[e]));else if(void 0!==s&&null!==h&&("exclusive"===o&&h<=s||"inclusive"===o&&null!==h&&h<s)){l=!1;const e="inclusive"===o?m.VALIDATION_EDITOR_TEXT_MIN_LENGTH_INCLUSIVE:m.VALIDATION_EDITOR_TEXT_MIN_LENGTH;c=i||e.replace(/{{minLength}}/gi,(e=>a[e]))}else if(void 0!==r&&null!==h&&("exclusive"===o&&h>=r||"inclusive"===o&&null!==h&&h>r)){l=!1;const e="inclusive"===o?m.VALIDATION_EDITOR_TEXT_MAX_LENGTH_INCLUSIVE:m.VALIDATION_EDITOR_TEXT_MAX_LENGTH;c=i||e.replace(/{{maxLength}}/gi,(e=>a[e]))}return{valid:l,msg:c}}function Oa(e,t){const i=isNaN(e)?null:parseFloat(e),n=t.decimal||0,s=t.required,r=t.minValue,o=t.maxValue,a=t.operatorConditionalType||"inclusive",l=t.errorMessage,c={"{{minValue}}":r,"{{maxValue}}":o,"{{minDecimal}}":0,"{{maxDecimal}}":n};let h=!0,d="";if("function"==typeof t.validator)return t.validator(e,t.editorArgs);if(s&&""===e)h=!1,d=l||m.VALIDATION_REQUIRED_FIELD;else if(""!==e&&(isNaN(e)||0===n&&!/^[-+]?(\d*(\.)?(\d)*)$/.test(e)))h=!1,d=l||m.VALIDATION_EDITOR_VALID_NUMBER;else if(void 0!==r&&void 0!==o&&null!==i&&("exclusive"===a&&(i<=+r||i>=+o)||"inclusive"===a&&(i<+r||i>+o)))h=!1,d=l||m.VALIDATION_EDITOR_NUMBER_BETWEEN.replace(/{{minValue}}|{{maxValue}}/gi,(e=>c[e]));else if(void 0!==r&&null!==i&&("exclusive"===a&&i<=+r||"inclusive"===a&&i<+r)){h=!1;const e="inclusive"===a?m.VALIDATION_EDITOR_NUMBER_MIN_INCLUSIVE:m.VALIDATION_EDITOR_NUMBER_MIN;d=l||e.replace(/{{minValue}}/gi,(e=>c[e]))}else if(void 0!==o&&null!==i&&("exclusive"===a&&i>=+o||"inclusive"===a&&i>+o)){h=!1;const e="inclusive"===a?m.VALIDATION_EDITOR_NUMBER_MAX_INCLUSIVE:m.VALIDATION_EDITOR_NUMBER_MAX;d=l||e.replace(/{{maxValue}}/gi,(e=>c[e]))}else n>0&&!new RegExp(`^[-+]?(\\d*(\\.)?(\\d){0,${n}})$`).test(e)&&(h=!1,d=l||m.VALIDATION_EDITOR_DECIMAL_BETWEEN.replace(/{{minDecimal}}|{{maxDecimal}}/gi,(e=>c[e])));return{valid:h,msg:d}}function Ia(e,t){let i=isNaN(e)?null:parseInt(e,10);null!==i&&isNaN(i)&&(i=null);const n=t.errorMessage,s=t.required,r=t.minValue,o=t.maxValue,a=t.operatorConditionalType||"inclusive",l={"{{minValue}}":r,"{{maxValue}}":o};let c=!0,h="";if(t.validator)return t.validator(e,t.editorArgs);if(s&&""===e)c=!1,h=n||m.VALIDATION_REQUIRED_FIELD;else if(""===e||!isNaN(e)&&/^[+-]?\d+$/.test(e)){if(void 0!==r&&void 0!==o&&null!==i&&("exclusive"===a&&(i<=+r||i>=+o)||"inclusive"===a&&(i<+r||i>+o)))c=!1,h=n||m.VALIDATION_EDITOR_INTEGER_BETWEEN.replace(/{{minValue}}|{{maxValue}}/gi,(e=>l[e]));else if(void 0!==r&&null!==i&&("exclusive"===a&&i<=+r||"inclusive"===a&&null!==i&&i<+r)){c=!1;const e="inclusive"===a?m.VALIDATION_EDITOR_INTEGER_MIN_INCLUSIVE:m.VALIDATION_EDITOR_INTEGER_MIN;h=n||e.replace(/{{minValue}}/gi,(e=>l[e]))}else if(void 0!==o&&null!==i&&("exclusive"===a&&i>=+o||"inclusive"===a&&null!==i&&i>+o)){c=!1;const e="inclusive"===a?m.VALIDATION_EDITOR_INTEGER_MAX_INCLUSIVE:m.VALIDATION_EDITOR_INTEGER_MAX;h=n||e.replace(/{{maxValue}}/gi,(e=>l[e]))}}else c=!1,h=n||m.VALIDATION_EDITOR_VALID_INTEGER;return{valid:c,msg:h}}class ka{constructor(e,t="text"){if(this.args=e,this._inputType="text",this._isValueTouched=!1,this.disabled=!1,!e)throw new Error("[Slickgrid-Universal] Something is wrong with this grid, an Editor must always have valid arguments.");this.grid=e.grid,this.gridOptions=e.grid?.getOptions(),this._bindEventService=new Ft,this.inputType=t,this.init()}get columnDef(){return this.args.column}get columnEditor(){return this.columnDef?.editor||{}}get dataContext(){return this.args.item}get editorDomElement(){return this._input}get hasAutoCommitEdit(){return this.gridOptions.autoCommitEdit??!1}get inputType(){return this._inputType}set inputType(e){this._inputType=e}get validator(){return this.columnEditor?.validator??this.columnDef?.validator}init(){const e=this.columnDef?.id??"",t=this.args.compositeEditorOptions;this._input=Z("input",{type:this._inputType||"text",autocomplete:"off",ariaAutoComplete:"none",ariaLabel:this.columnEditor?.ariaLabel??`${We(e+"")} Input Editor`,className:`editor-text editor-${e}`,placeholder:this.columnEditor?.placeholder??"",title:this.columnEditor?.title??""}),"number"===this.inputType&&(this._input.step=`${void 0!==this.columnEditor.valueStep?this.columnEditor.valueStep:this.getInputDecimalSteps()}`);const i=this.args.container;i&&"function"==typeof i.appendChild&&i.appendChild(this._input),this._bindEventService.bind(this._input,"focus",(()=>this._input?.select())),this._bindEventService.bind(this._input,"keydown",(e=>{this._isValueTouched=!0,this._lastInputKeyEvent=e,"ArrowLeft"!==e.key&&"ArrowRight"!==e.key&&"Home"!==e.key&&"End"!==e.key||e.stopImmediatePropagation()})),this.hasAutoCommitEdit&&!t&&this._bindEventService.bind(this._input,["focusout","blur"],(()=>{this._isValueTouched=!0,this.save()})),t&&(this._bindEventService.bind(this._input,["input","paste"],this.handleOnInputChange.bind(this)),"number"===this.inputType&&this._bindEventService.bind(this._input,"wheel",this.handleOnMouseWheel.bind(this),{passive:!0}))}destroy(){this._bindEventService.unbindAll(),this._input?.remove?.()}disable(e=!0){const t=this.disabled;if(this.disabled=e,this._input)if(e){this._input.setAttribute("disabled","disabled");const i=this.getValue();t!==e&&this.args?.compositeEditorOptions&&""!==i&&this.reset("",!0,!0)}else this._input.removeAttribute("disabled")}focus(){this.grid.focus(),this._input?.focus()}getDecimalPlaces(){let e=this.columnEditor?.decimal??this.columnEditor?.params?.decimalPlaces??void 0;return void 0===e&&(e=0),e||0===e?e:null}getInputDecimalSteps(){const e=this.getDecimalPlaces();let t="";for(let i=1;i<e;i++)t+="0";return e>0?`0.${t}1`:"1"}show(){this.args?.compositeEditorOptions&&this.applyInputUsabilityState()}getValue(){return this._input?.value||""}setValue(e,t=!1,i=!0){if(this._input&&(this._input.value=`${e}`,t)){this.applyValue(this.args.item,this.serializeValue());const e=this.args.compositeEditorOptions;e&&i&&this.handleChangeOnCompositeEditor(null,e,"system")}}applyValue(e,t){const i=this.columnDef&&this.columnDef.field;if(void 0!==i){const n=i?.indexOf(".")>0,s=this.validate(null,t),r=s?.valid?t:"";n?He(e,this.columnEditor?.complexObjectPath??i??"",r):i&&(e[i]=r)}}isValueChanged(){const e=this._input?.value,t=this._lastInputKeyEvent?.key;return!(!this.columnEditor?.alwaysSaveOnEnterKey||"Enter"!==t)||!(""===e&&(null===this._originalValue||void 0===this._originalValue))&&e!==this._originalValue}isValueTouched(){return this._isValueTouched}loadValue(e){const t=this.columnDef?.field;if(e&&void 0!==t&&this._input){const i=t?.indexOf(".")>0?H(e,t):e.hasOwnProperty(t)&&e[t]||"";this._originalValue=i,this._input.value=this._originalValue,this._input.select()}}reset(e,t=!0,i=!1){const n=e??this._originalValue??"";this._input&&(this._originalValue=n,this._input.value=`${n}`),this._isValueTouched=!1;const s=this.args.compositeEditorOptions;if(s&&t){const e=!i;this.handleChangeOnCompositeEditor(null,s,"user",e)}}save(){const e=this.validate(),t=e&&e.valid||!1;this.hasAutoCommitEdit&&t?this.grid.getEditorLock().commitCurrentEdit():this.args.commitChanges()}serializeValue(){return this._input?.value??""}validate(e,t){return this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled?{valid:!0,msg:""}:Aa(void 0!==t?t:this._input&&this._input.value,{editorArgs:this.args,errorMessage:this.columnEditor.errorMessage,minLength:this.columnEditor.minLength,maxLength:this.columnEditor.maxLength,operatorConditionalType:this.columnEditor.operatorConditionalType,required:!this.args?.compositeEditorOptions&&this.columnEditor.required,validator:this.validator})}applyInputUsabilityState(){const e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(!1===t)}handleChangeOnCompositeEditor(e,t,i="user",n=!1){const s=this.grid.getActiveCell(),r=this.args.column,o=this.columnDef?.id??"",a=this.dataContext,l=this.grid,c=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,c),this.applyValue(t.formValues,c);const h=this.gridOptions?.compositeEditorOptions?.excludeDisabledFieldFormValues??!1;(n||this.disabled&&h&&t.formValues.hasOwnProperty(o))&&delete t.formValues[o],l.onCompositeEditorChange.notify({...s,item:a,grid:l,column:r,formValues:t.formValues,editors:t.editors,triggeredBy:i},new mn(e))}handleOnInputChange(e){this._isValueTouched=!0;const t=this.args.compositeEditorOptions;if(t){const i=this.gridOptions?.editorTypingDebounce??500;window.clearTimeout(this._timer),this._timer=window.setTimeout((()=>this.handleChangeOnCompositeEditor(e,t)),i)}}handleOnMouseWheel(e){this._isValueTouched=!0;const t=this.args.compositeEditorOptions;t&&this.handleChangeOnCompositeEditor(e,t)}}class Da{constructor(e,t,i=-1){if(this.args=e,this.isMultipleSelect=t,this.delayOpening=i,this._isValueTouched=!1,this._isDisposingOrCallingSave=!1,this.disabled=!1,this.enableTranslateLabel=!1,this.finalCollection=[],!e)throw new Error("[Slickgrid-Universal] Something is wrong with this grid, an Editor must always have valid arguments.");this.grid=e.grid,this.gridOptions=this.grid.getOptions()||{},this.gridOptions?.translater&&(this._translaterService=this.gridOptions.translater),this._locales=this.gridOptions.locales||m.locales;const n=this.columnDef?.id??"";this.elementName=`editor-${n}`;const s=this.args.compositeEditorOptions,r={autoAdjustDropHeight:!0,autoAdjustDropPosition:!0,autoAdjustDropWidthByTextSize:!0,container:"body",darkMode:!!this.gridOptions.darkMode,filter:!1,maxHeight:275,minHeight:25,name:this.elementName,single:!0,singleRadio:!0,renderOptionLabelAsHtml:this.columnEditor?.enableRenderHtml??!1,sanitizer:e=>this.grid.sanitizeHtmlString(e),onClick:()=>this._isValueTouched=!0,onCheckAll:()=>this._isValueTouched=!0,onUncheckAll:()=>this._isValueTouched=!0,onClose:e=>{"key.escape"!==e&&"body.click"!==e&&(this.hasAutoCommitEdit||this.isValueChanged())?s?this.handleChangeOnCompositeEditor(s):(this._isDisposingOrCallingSave=!0,this.save(this.hasAutoCommitEdit)):"key.escape"===e&&this.cancel()}};if(t)if(r.single=!1,r.singleRadio=!1,r.displayTitle=!0,r.showOkButton=!0,this._translaterService?.getCurrentLanguage()){const e=B(this.gridOptions);r.countSelectedText=this._translaterService.translate(`${e}X_OF_Y_SELECTED`),r.allSelectedText=this._translaterService.translate(`${e}ALL_SELECTED`),r.selectAllText=this._translaterService.translate(`${e}SELECT_ALL`),r.okButtonText=this._translaterService.translate(`${e}OK`),r.noMatchesFoundText=this._translaterService.translate(`${e}NO_MATCHES_FOUND`)}else r.countSelectedText=this._locales?.TEXT_X_OF_Y_SELECTED,r.allSelectedText=this._locales?.TEXT_ALL_SELECTED,r.selectAllText=this._locales?.TEXT_SELECT_ALL,r.okButtonText=this._locales?.TEXT_OK,r.noMatchesFoundText=this._locales?.TEXT_NO_MATCHES_FOUND;this.defaultOptions=r,this.init()}get collection(){return this.columnEditor?.collection??[]}get collectionOptions(){return this.columnEditor?.collectionOptions}get columnDef(){return this.args.column}get columnEditor(){return this.columnDef?.editor??{}}get dataContext(){return this.args.item}get editorOptions(){return{...this.gridOptions.defaultEditorOptions?.select,...this.columnEditor?.editorOptions}}get isCompositeEditor(){return!!this.args?.compositeEditorOptions}get customStructure(){return this.columnDef?.editor?.customStructure}get hasAutoCommitEdit(){return this.gridOptions.autoCommitEdit??!1}get msInstance(){return this._msInstance}get selectOptions(){return this.defaultOptions}get currentValues(){const e=new Set;if((this._msInstance?.getSelects("value")??[]).forEach((t=>e.add(t.toString()))),this.collection.every((e=>"number"==typeof e||"string"==typeof e)))return this.collection.filter((t=>e.has(t?.toString())));const t=this.collectionOptions?.separatorBetweenTextLabels??"",i=this.collectionOptions?.includePrefixSuffixToSelectedValues??!1;return this.collection.filter((t=>e.has(t?.[this.valueName]?.toString()))).map((e=>{const n=e[this.valueName];let s=e[this.labelPrefixName]||"",r=e[this.labelSuffixName]||"";const o=this.columnDef?.field??"",a=o?.indexOf(".")>0,l=this.columnEditor?.serializeComplexValueFormat??"object";return a&&"object"==typeof e&&"object"===l?e:(s=this.enableTranslateLabel&&this._translaterService&&s&&"string"==typeof s?this._translaterService.translate(s||" "):s,r=this.enableTranslateLabel&&this._translaterService&&r&&"string"==typeof r?this._translaterService.translate(r||" "):r,i?[s,n,r].filter((e=>e)).join(t):n)}))}get currentValue(){const e=this._msInstance?.getSelects()??[],t=e.length?e[0]:"",i=this.columnDef?.field;if(void 0!==i){if(this.collection.every((e=>"number"==typeof e||"string"==typeof e)))return K(this.collection,(e=>e?.toString?.()===`${t}`));const e=this.collectionOptions?.separatorBetweenTextLabels??"",n=this.collectionOptions?.includePrefixSuffixToSelectedValues??!1,s=K(this.collection,(e=>e.hasOwnProperty(this.valueName)&&e[this.valueName]?.toString()===`${t}`)),r=i?.indexOf(".")>0,o=this.columnEditor?.serializeComplexValueFormat??"object";if(r&&"object"==typeof s&&"object"===o)return s;if(s&&s.hasOwnProperty(this.valueName)){const t=s[this.valueName];if(n){let i=s[this.labelPrefixName]||"",n=s[this.labelSuffixName]||"";return i=this.enableTranslateLabel&&this._translaterService&&i&&"string"==typeof i?this._translaterService.translate(i||" "):i,n=this.enableTranslateLabel&&this._translaterService&&n&&"string"==typeof n?this._translaterService.translate(n||" "):n,[i,t,n].filter((e=>e)).join(e)}return t}}return""}get validator(){return this.columnEditor?.validator??this.columnDef?.validator}init(){if(!this.columnDef||!this.columnDef.editor||!this.columnDef.editor.collection&&!this.columnDef.editor.collectionAsync)throw new Error("[Slickgrid-Universal] You need to pass a \"collection\" (or \"collectionAsync\") inside Column Definition Editor for the MultipleSelect/SingleSelect Editor to work correctly.\n      Also each option should include a value/label pair (or value/labelKey when using Locale).\n      For example: { editor: { collection: [{ value: true, label: 'True' },{ value: false, label: 'False'}] } }");if(this._collectionService=new un(this._translaterService),this.enableTranslateLabel=this.columnEditor?.enableTranslateLabel??!1,this.labelName=this.customStructure?.label??"label",this.labelPrefixName=this.customStructure?.labelPrefix??"labelPrefix",this.labelSuffixName=this.customStructure?.labelSuffix??"labelSuffix",this.optionLabel=this.customStructure?.optionLabel??"value",this.valueName=this.customStructure?.value??"value",this.enableTranslateLabel&&(!this._translaterService||"function"!=typeof this._translaterService.translate))throw new Error('[Slickgrid-Universal] requires a Translate Service to be installed and configured when the grid option "enableTranslate" is enabled.');this.renderDomElement(this.collection),(this.disabled||this.columnEditor?.collectionAsync&&Array.isArray(this.collection)&&0===this.collection.length)&&this.disable(!0)}getValue(){return this.isMultipleSelect?this.currentValues:this.currentValue}setValue(e,t=!1,i=!0){if(this.isMultipleSelect&&Array.isArray(e)?this.loadMultipleValues(e):this.loadSingleValue(e),t){this.applyValue(this.args.item,this.serializeValue());const e=this.args.compositeEditorOptions;e&&i&&this.handleChangeOnCompositeEditor(e,"system")}}cancel(){this.args?.cancelChanges&&this.args.cancelChanges()}hide(){this._msInstance&&this._msInstance.close()}show(e){!this.isCompositeEditor&&this._msInstance?this._msInstance.open(e):this.isCompositeEditor&&this.applyInputUsabilityState()}applyValue(e,t){const i=this.columnDef?.field,n=this.columnDef?.type;let s=t;if(void 0!==i){n!==b.number&&n!==b.integer&&n!==b.boolean||isNaN(parseFloat(t))||(s=parseFloat(t)),this.isMultipleSelect&&"string"==typeof t&&t.indexOf(",")>=0&&(s=t.split(","));const r=i?.indexOf(".")>0,o=this.validate(null,s);s=o?.valid?s:"",r?He(e,this.columnEditor?.complexObjectPath??i??"",s):e[i]=s}}destroy(){this._msInstance&&this.hasAutoCommitEdit&&this.isValueChanged()&&!this._isDisposingOrCallingSave&&!this.isCompositeEditor&&(this._isDisposingOrCallingSave=!0,this.save(!0)),this._isDisposingOrCallingSave=!0,"function"==typeof this._msInstance?.destroy&&this._msInstance.destroy(),this.editorElm?.remove(),this._msInstance=void 0}loadValue(e){const t=this.columnDef?.field,i=void 0!==t&&t?.indexOf(".")>0;if(e&&void 0!==t){const n=this.columnEditor?.complexObjectPath??t,s=i?H(e,n):e.hasOwnProperty(t)&&e[t],r=i&&s?.hasOwnProperty(this.valueName)?s[this.valueName]:s;this.isMultipleSelect&&Array.isArray(r)?this.loadMultipleValues(r):this.loadSingleValue(r)}}loadMultipleValues(e){if(Array.isArray(e)){this.originalValue=e.map((e=>"number"==typeof e||"boolean"==typeof e?`${e}`:e)),this._msInstance?.setSelects(this.originalValue);const t=this.args.compositeEditorOptions;t&&this.handleChangeOnCompositeEditor(t)}}loadSingleValue(e){this.originalValue="number"==typeof e||"boolean"==typeof e?`${e}`:e,this._msInstance?.setSelects([this.originalValue])}serializeValue(){return this.isMultipleSelect?this.currentValues:this.currentValue}changeEditorOption(e,t){this.columnEditor&&(this.columnEditor.editorOptions||(this.columnEditor.editorOptions={}),this.columnEditor.editorOptions[e]=t,this.editorElmOptions={...this.editorElmOptions,[e]:t},this._msInstance?.refreshOptions(this.editorElmOptions))}disable(e=!0){const t=this.disabled;if(this.disabled=e,this._msInstance)if(e){this._msInstance.disable();const i=this.getValue(),n=Array.isArray(i)&&this.isMultipleSelect?""===i?.[0]:""===i;t!==e&&this.isCompositeEditor&&!n&&this.reset("",!0,!0)}else this._msInstance.enable()}focus(){this.grid.focus(),this._msInstance?.focus()}isValueChanged(){const e=this._msInstance?.getSelects();if(this.isMultipleSelect)return!Bt(e,this.originalValue);const t=Array.isArray(e)&&e.length>0?e[0]:void 0;return void 0!==t&&t!==this.originalValue}isValueTouched(){return this._isValueTouched}reset(e,t=!0,i=!1){const n=e??this.originalValue;if(this._msInstance){this.originalValue=this.isMultipleSelect?void 0!==n?[n]:[]:n;const e=void 0===this.originalValue?[]:[this.originalValue];this._msInstance.setSelects(e)}this._isValueTouched=!1;const s=this.args.compositeEditorOptions;if(s&&t){const e=!i;this.handleChangeOnCompositeEditor(s,"user",e)}}save(e=!1){const t=this.validate(),i=t?.valid??!1;(!this._isDisposingOrCallingSave||e)&&this.hasAutoCommitEdit&&i?this.grid.getEditorLock().commitCurrentEdit():this.args.commitChanges()}validate(e,t){const i=!this.isCompositeEditor&&this.columnEditor?.required,n=void 0!==t?t:this._msInstance?.getSelects(),s=this.columnEditor&&this.columnEditor.errorMessage;if(this.isCompositeEditor&&this.applyInputUsabilityState(),this.disabled)return{valid:!0,msg:""};if(this.validator){const e=void 0!==t?t:this.isMultipleSelect?this.currentValues:this.currentValue;return this.validator(e,this.args)}return i&&(""===n||Array.isArray(n)&&0===n.length)?{valid:!1,msg:s||m.VALIDATION_REQUIRED_FIELD}:{valid:!0,msg:null}}applyInputUsabilityState(){const e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(!1===t)}filterCollection(e){let t=e;if(this.columnEditor&&this.columnEditor.collectionFilterBy){const e=this.columnEditor.collectionFilterBy,i=this.columnEditor.collectionOptions?.filterResultAfterEachPass??null;t=this._collectionService.filterCollection(t,e,i)}return t}sortCollection(e){let t=e;if(this.columnDef&&this.columnEditor&&this.columnEditor.collectionSortBy){const e=this.columnEditor.collectionSortBy;t=this._collectionService.sortCollection(this.columnDef,t,e,this.enableTranslateLabel)}return t}renderDomElement(e){if(!Array.isArray(e)&&this.collectionOptions?.collectionInsideObjectProperty&&(e=H(e,this.collectionOptions.collectionInsideObjectProperty)),!Array.isArray(e))throw new Error('The "collection" passed to the Select Editor is not a valid array.');let t=[];e.length>0&&(t=[...e]),this.collectionOptions?.addBlankEntry&&Array.isArray(t)&&t.length>0&&""!==t[0][this.valueName]&&(t.unshift(this.createBlankEntry()),this.collection.unshift(this.createBlankEntry())),this.collectionOptions?.addCustomFirstEntry&&Array.isArray(t)&&t.length>0&&t[0][this.valueName]!==this.collectionOptions.addCustomFirstEntry[this.valueName]&&(t.unshift(this.collectionOptions.addCustomFirstEntry),this.collection.unshift(this.collectionOptions.addCustomFirstEntry)),this.collectionOptions?.addCustomLastEntry&&Array.isArray(t)&&t.length>0&&t[t.length-1][this.valueName]!==this.collectionOptions.addCustomLastEntry[this.valueName]&&t.push(this.collectionOptions.addCustomLastEntry);let i=t;if(i=this.filterCollection(i),i=this.sortCollection(i),this.columnEditor?.collectionOverride){const e={column:this.columnDef,dataContext:this.dataContext,grid:this.grid,originalCollections:this.collection};if(this.args.compositeEditorOptions){const{formValues:t,modalType:i}=this.args.compositeEditorOptions;e.compositeEditorOptions={formValues:t,modalType:i}}i=this.columnEditor.collectionOverride(i,e)}this.finalCollection=i;const n=pn("editor",i,this.columnDef,this.grid,this.isMultipleSelect,this._translaterService);this.createDomElement(n.selectElement,n.dataCollection)}createBlankEntry(){const e={[this.labelName]:"",[this.valueName]:""};return this.labelPrefixName&&(e[this.labelPrefixName]=""),this.labelSuffixName&&(e[this.labelSuffixName]=""),e}createDomElement(e,t){const i=this.args.container;e&&i&&"function"==typeof i.appendChild&&(ee(i),i.appendChild(e));const n=this.columnEditor?.placeholder??"";this.defaultOptions.placeholder=n||"",this.editorElmOptions={...this.defaultOptions,...this.editorOptions,data:t},this._msInstance=ba(e,this.editorElmOptions),this.editorElm=this._msInstance.getParentElement(),this.isCompositeEditor||this.show(this.delayOpening)}handleChangeOnCompositeEditor(e,t="user",i=!1){const n=this.grid.getActiveCell(),s=this.args.column,r=this.columnDef?.id??"",o=this.dataContext,a=this.grid,l=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,l),this.applyValue(e.formValues,l);const c=this.gridOptions?.compositeEditorOptions?.excludeDisabledFieldFormValues??!1;(i||this.disabled&&c&&e.formValues.hasOwnProperty(r))&&delete e.formValues[r],a.onCompositeEditorChange.notify({...n,item:o,grid:a,column:s,formValues:e.formValues,editors:e.editors,triggeredBy:t},new mn)}}const ja={autocompleter:class{constructor(e){if(this.args=e,this._isValueTouched=!1,this._lastTriggeredByClearInput=!1,this.disabled=!1,this.forceUserInput=!1,this.finalCollection=[],!e)throw new Error("[Slickgrid-Universal] Something is wrong with this grid, an Editor must always have valid arguments.");this.grid=e.grid,this._bindEventService=new Ft,this.gridOptions?.translater&&(this._translater=this.gridOptions.translater),this._locales=this.gridOptions&&this.gridOptions.locales||m.locales,this.init()}get autocompleterOptions(){return this._autocompleterOptions||{}}get collection(){return this.columnEditor?.collection??[]}get editorDomElement(){return this._inputElm}get elementCollection(){return this._elementCollection}get columnDef(){return this.args.column}get columnEditor(){return this.columnDef?.editor||{}}get customStructure(){let e=this.columnEditor?.customStructure;const t=this.columnEditor?.type??this.columnDef?.type;return!e&&t===b.object&&this.columnDef?.dataKey&&this.columnDef?.labelKey&&(e={label:this.columnDef.labelKey,value:this.columnDef.dataKey}),e}get dataContext(){return this.args.item}get editorOptions(){return{...this.gridOptions.defaultEditorOptions?.autocompleter,...this.columnEditor?.editorOptions}}get gridOptions(){return this.grid?.getOptions()??{}}get instance(){return this._instance}get hasAutoCommitEdit(){return this.gridOptions.autoCommitEdit??!1}get validator(){return this.columnEditor?.validator??this.columnDef?.validator}init(){this.labelName=this.customStructure?.label??"label",this.valueName=this.customStructure?.value??"value",this.labelPrefixName=this.customStructure?.labelPrefix??"labelPrefix",this.labelSuffixName=this.customStructure?.labelSuffix??"labelSuffix";let e=this.columnEditor.collection;this.columnEditor?.collectionAsync&&!e&&(e=[]),this.renderDomElement(e),(this.disabled||this.columnEditor?.collectionAsync&&Array.isArray(e)&&0===e.length)&&this.disable(!0)}destroy(){this._bindEventService.unbindAll(),"function"==typeof this._instance?.destroy&&this._instance.destroy(),this._inputElm?.remove?.(),this._elementCollection=null}disable(e=!0){const t=this.disabled;if(this.disabled=e,this._inputElm)if(e){this._inputElm.disabled=!0;const i=this.getValue();t!==e&&this.args?.compositeEditorOptions&&""!==i&&this.clear(!0)}else this._inputElm.disabled=!1}focus(){this.grid.focus(),this._inputElm&&(this._inputElm.focus(),this._inputElm.select())}show(){this.args?.compositeEditorOptions&&this.applyInputUsabilityState()}getValue(){return this._inputElm.value}setValue(e,t=!1,i=!0){if(this._inputElm.value=e?.hasOwnProperty(this.labelName)?e[this.labelName]:e,t){this._currentValue=e,this._defaultTextValue="string"==typeof e?e:e?.[this.labelName]??"",this.applyValue(this.args.item,this.serializeValue());const t=this.args.compositeEditorOptions;t&&i&&this.handleChangeOnCompositeEditor(null,t,"system")}}applyValue(e,t){let i=t;const n=this.columnDef?.field;if(void 0!==n){Array.isArray(this.collection)&&this.collection.length>0&&(i=K(this.collection,(e=>e&&je(t)&&e.hasOwnProperty(this.valueName)?e[this.valueName].toString()===(t.hasOwnProperty(this.valueName)&&t[this.valueName].toString()):e&&"string"==typeof t&&e.hasOwnProperty(this.valueName)?e[this.valueName].toString()===t:e?.toString()===t),""));const s=n?.indexOf(".")>0,r=this.validate(null,i);i=r?.valid?i:"",s?He(e,this.columnEditor?.complexObjectPath??n??"",i):e[n]=i}}isValueChanged(){const e=this._inputElm.value,t=this._lastInputKeyEvent?.key;if(this.columnEditor?.alwaysSaveOnEnterKey&&"Enter"===t)return!0;const i=!(""===e&&(null===this._defaultTextValue||void 0===this._defaultTextValue))&&e!==this._defaultTextValue;return this._lastTriggeredByClearInput||i}isValueTouched(){return this._isValueTouched}loadValue(e){const t=this.columnDef?.field;if(e&&void 0!==t){const i=t?.indexOf(".")>0?H(e,t):e[t];this._currentValue=i,this._originalValue=i,this._defaultTextValue="string"==typeof i?i:i?.[this.labelName]??"",this._inputElm.value=this._defaultTextValue,this._inputElm.select()}}clear(e=!1){this._inputElm&&(this._currentValue="",this._defaultTextValue="",this.setValue("",!0)),this._isValueTouched=!0,this._lastTriggeredByClearInput=!0;const t=this.args.compositeEditorOptions;if(t){const i=!e;this.handleChangeOnCompositeEditor(null,t,"user",i)}else this.save()}reset(e,t=!0,i=!1){const n=e??this._originalValue??"";this._inputElm&&(this._currentValue=n,this._defaultTextValue="string"==typeof n?n:n?.[this.labelName]??"",this._inputElm.value=this._defaultTextValue),this._isValueTouched=!1;const s=this.args.compositeEditorOptions;if(s&&t){const e=!i;this.handleChangeOnCompositeEditor(null,s,"user",e)}}save(){const e=this.validate(),t=e?.valid??!1;if(this.hasAutoCommitEdit&&t)this.grid.getEditorLock().commitCurrentEdit();else{const e="Enter"!==this._lastInputKeyEvent?.key;this.args.commitChanges(e)}}serializeValue(){if(this._inputElm&&this.editorOptions.forceUserInput){const e=this.editorOptions?.minLength??3;this._currentValue=this._inputElm.value.length>e?this._inputElm.value:this._currentValue}return this.customStructure&&this._currentValue&&this._currentValue.hasOwnProperty(this.valueName)&&this.columnDef?.type!==b.object&&this.columnEditor?.type!==b.object?this._currentValue[this.valueName]:this._currentValue&&void 0!==this._currentValue.value?this.columnDef?.type===b.object||this.columnEditor?.type===b.object?{[this.labelName]:this._currentValue.label,[this.valueName]:this._currentValue.value}:this._currentValue.value:this._currentValue}validate(e,t){return this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled?{valid:!0,msg:""}:Aa(void 0!==t?t:this._inputElm?.value,{editorArgs:this.args,errorMessage:this.columnEditor.errorMessage,minLength:this.columnEditor.minLength,maxLength:this.columnEditor.maxLength,operatorConditionalType:this.columnEditor.operatorConditionalType,required:!this.args?.compositeEditorOptions&&this.columnEditor.required,validator:this.validator})}applyInputUsabilityState(){const e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(!1===t)}handleChangeOnCompositeEditor(e,t,i="user",n=!1){const s=this.grid.getActiveCell(),r=this.args.column,o=this.columnDef?.id??"",a=this.dataContext,l=this.grid,c=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,c),this.applyValue(t.formValues,c);const h=this.gridOptions?.compositeEditorOptions?.excludeDisabledFieldFormValues??!1;(n||this.disabled&&h&&t.formValues.hasOwnProperty(o))&&delete t.formValues[o],l.onCompositeEditorChange.notify({...s,item:a,grid:l,column:r,formValues:t.formValues,editors:t.editors,triggeredBy:i},new mn(e))}handleSelect(e){if(void 0!==e){const t=e;this._currentValue=t,this._isValueTouched=!0;const i=this.args.compositeEditorOptions,n=this.editorOptions?.renderItem??!1,s="string"==typeof t?t:n?t[this.labelName]:t.label;if(this.setValue(s),i?this.handleChangeOnCompositeEditor(null,i):this.save(),"function"==typeof this.editorOptions.onSelectItem){const{row:t,cell:i}=this.grid.getActiveCell()||{};this.editorOptions.onSelectItem(e,t,i,this.args.column,this.args.item)}window.setTimeout((()=>this._lastTriggeredByClearInput=!1))}return!1}renderRegularItem(e){return Z("div",{textContent:("string"==typeof e?e:e?.label??"")||""})}renderCustomItem(e){const t=this._autocompleterOptions?.renderItem?.templateCallback(e)??"",i=document.createElement("div");return this.grid.applyHtmlCode(i,t),i}renderCollectionItem(e){const t=this.columnEditor?.enableRenderHtml??!1,i=(e.labelPrefix||"")+(e.label||"")+(e.labelSuffix||""),n=this.grid.sanitizeHtmlString(i)||"",s=document.createElement("div");return s[t?"innerHTML":"textContent"]=n,s}renderDomElement(e){const t=this.columnDef?.id??"",i=this.columnEditor?.placeholder??"",n=this.columnEditor?.title??"";this._editorInputGroupElm=Z("div",{className:"autocomplete-container input-group"});const s=Z("span",{className:"input-group-btn input-group-append",dataset:{clear:""}});this._clearButtonElm=Z("button",{type:"button",className:"btn btn-default btn-clear"}),this._clearButtonElm.appendChild(Z("i",{className:"icon-clear"})),this._inputElm=Z("input",{type:"text",placeholder:i,title:n,autocomplete:"off",ariaAutoComplete:"none",className:`autocomplete form-control editor-text input-group-editor editor-${t}`,dataset:{input:""}},this._editorInputGroupElm),this._editorInputGroupElm.appendChild(document.createElement("span")),this.editorOptions?.hideClearButton||(s.appendChild(this._clearButtonElm),this._editorInputGroupElm.appendChild(s),this._bindEventService.bind(this._clearButtonElm,"click",(()=>this.clear()))),this._bindEventService.bind(this._inputElm,"focus",(()=>this._inputElm?.select())),this._bindEventService.bind(this._inputElm,"keydown",(e=>{this._lastInputKeyEvent=e,"ArrowLeft"!==e.key&&"ArrowRight"!==e.key&&"Home"!==e.key&&"End"!==e.key||e.stopImmediatePropagation(),"Enter"===e.key&&""===e.target.value&&this.columnEditor.alwaysSaveOnEnterKey&&(this._currentValue=null)}));let r=e;if(r&&this.columnEditor?.collectionOverride){const e={column:this.columnDef,dataContext:this.dataContext,grid:this.grid,originalCollections:this.collection};if(this.args.compositeEditorOptions){const{formValues:t,modalType:i}=this.args.compositeEditorOptions;e.compositeEditorOptions={formValues:t,modalType:i}}r=this.columnEditor.collectionOverride(r,e)}r&&(this.finalCollection=r),Array.isArray(r)&&(r=this.collection.every((e=>Re(e)))?r.map((e=>({label:e,value:e}))):r.map((e=>({label:e?.[this.labelName],value:e?.[this.valueName],labelPrefix:e?.[this.labelPrefixName]??"",labelSuffix:e?.[this.labelSuffixName]??""}))),this._elementCollection=r),this._autocompleterOptions={input:this._inputElm,debounceWaitMs:200,className:`slick-autocomplete ${this.editorOptions?.className??""}`.trim(),emptyMsg:this.gridOptions.enableTranslate&&this._translater?.translate?this._translater.translate("NO_ELEMENTS_FOUND"):this._locales?.TEXT_NO_ELEMENTS_FOUND??"No elements found",customize:(e,t,i)=>{i.style.width=""},onSelect:this.handleSelect.bind(this),...this.editorOptions},this.gridOptions?.darkMode&&(this._autocompleterOptions.className+=" slick-dark-mode"),this.autocompleterOptions.className=Q(this.autocompleterOptions.className).join(" "),this._autocompleterOptions.renderItem?.layout?(this._autocompleterOptions.className+=` autocomplete-custom-${Ve(this._autocompleterOptions.renderItem.layout)}`,this._autocompleterOptions.render=this.renderCustomItem.bind(this)):Array.isArray(e)?this._autocompleterOptions.render=this._autocompleterOptions.render?.bind(this)??this.renderCollectionItem.bind(this):this._autocompleterOptions.render||(this._autocompleterOptions.render=this.renderRegularItem.bind(this)),this._autocompleterOptions?.fetch?(zt(this._inputElm,this._autocompleterOptions),this._instance=Nt(this._autocompleterOptions)):this._instance=Nt({...this._autocompleterOptions,fetch:(e,t)=>{r&&t(r.filter((t=>(("string"==typeof t?t:t?.label)||"").toLowerCase().includes(e.toLowerCase()))))}}),this.args.container.appendChild(this._editorInputGroupElm),this.args.compositeEditorOptions||window.setTimeout((()=>this.focus()),50)}},checkbox:class{constructor(e){if(this.args=e,this._isValueTouched=!1,this.disabled=!1,!e)throw new Error("[Slickgrid-Universal] Something is wrong with this grid, an Editor must always have valid arguments.");this.grid=e.grid,this.gridOptions=this.grid.getOptions()||{},this._bindEventService=new Ft,this.init()}get columnDef(){return this.args.column}get columnEditor(){return this.columnDef?.editor||{}}get dataContext(){return this.args.item}get editorDomElement(){return this._input}get hasAutoCommitEdit(){return this.gridOptions.autoCommitEdit??!1}get validator(){return this.columnEditor?.validator??this.columnDef?.validator}init(){const e=this.columnDef?.id??"",t=this.args.compositeEditorOptions;this._checkboxContainerElm=Z("div",{className:`checkbox-editor-container editor-${e}`}),this._input=Z("input",{type:"checkbox",value:"true",ariaLabel:this.columnEditor?.ariaLabel??`${We(e+"")} Checkbox Editor`,className:`editor-checkbox editor-${e}`,title:this.columnEditor?.title??""});const i=this.args?.container;i&&"function"==typeof i.appendChild&&(t?(this._checkboxContainerElm.appendChild(this._input),i.appendChild(this._checkboxContainerElm)):i.appendChild(this._input)),this.hasAutoCommitEdit&&!t&&this._bindEventService.bind(this._input,"click",(()=>{this._isValueTouched=!0,this.save()})),t?this._bindEventService.bind(this._input,"change",(e=>{this._isValueTouched=!0,this.handleChangeOnCompositeEditor(e,t)})):this.focus()}destroy(){this._bindEventService.unbindAll(),this._input?.remove?.()}disable(e=!0){const t=this.disabled;if(this.disabled=e,this._input)if(e){this._input.setAttribute("disabled","disabled"),this._checkboxContainerElm.classList.add("disabled");const i=this.getValue();t!==e&&this.args?.compositeEditorOptions&&!1!==i&&this.reset(!1,!0,!0)}else this._input.removeAttribute("disabled"),this._checkboxContainerElm.classList.remove("disabled")}focus(){this.grid.focus(),this._input?.focus()}preClick(){this._input&&(this._input.checked=!this._input.checked)}show(){this.args?.compositeEditorOptions&&this.applyInputUsabilityState()}getValue(){return this._input?.checked??!1}setValue(e,t=!1,i=!0){const n=!!e;if(this._input&&(this._input.checked=n),t){this.applyValue(this.args.item,this.serializeValue());const e=this.args.compositeEditorOptions;e&&i&&this.handleChangeOnCompositeEditor(null,e,"system")}}applyValue(e,t){const i=this.columnDef&&this.columnDef.field;if(void 0!==i){const n=i?.indexOf(".")>0,s=this.validate(null,t),r=s&&s.valid?t:"";n?He(e,this.columnEditor?.complexObjectPath??i??"",r):e[i]=r}}isValueChanged(){return this.serializeValue()!==this._originalValue}isValueTouched(){return this._isValueTouched}loadValue(e){const t=this.columnDef&&this.columnDef.field;if(e&&void 0!==t&&this._input){const i=t?.indexOf(".")>0?H(e,t):e[t];this._originalValue=i,this._input.checked=!!this._originalValue}}reset(e,t=!0,i=!1){const n=e??this._originalValue??!1;this._input&&(this._originalValue=n,this._input.checked=!!n),this._isValueTouched=!1;const s=this.args.compositeEditorOptions;if(s&&t){const e=!i;this.handleChangeOnCompositeEditor(null,s,"user",e)}}save(){const e=this.validate(),t=e&&e.valid||!1;this.hasAutoCommitEdit&&t?this.grid.getEditorLock().commitCurrentEdit():this.args.commitChanges()}serializeValue(){return this._input?.checked??!1}validate(e,t){const i=!this.args?.compositeEditorOptions&&this.columnEditor.required,n=void 0!==t?t:this._input?.checked,s=this.columnEditor.errorMessage;return this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled?{valid:!0,msg:""}:this.validator?this.validator(n,this.args):i&&!n?{valid:!1,msg:s||m.VALIDATION_REQUIRED_FIELD}:{valid:!0,msg:null}}applyInputUsabilityState(){const e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(!1===t)}handleChangeOnCompositeEditor(e,t,i="user",n=!1){const s=this.grid.getActiveCell(),r=this.args.column,o=this.columnDef?.id??"",a=this.dataContext,l=this.grid,c=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,c),this.applyValue(t.formValues,c);const h=this.gridOptions?.compositeEditorOptions?.excludeDisabledFieldFormValues??!1;(n||this.disabled&&h&&t.formValues.hasOwnProperty(o))&&delete t.formValues[o],l.onCompositeEditorChange.notify({...s,item:a,grid:l,column:r,formValues:t.formValues,editors:t.editors,triggeredBy:i},new mn(e))}},date:class{constructor(e){if(this.args=e,this._isValueTouched=!1,this._lastClickIsDate=!1,this._lastTriggeredByClearDate=!1,this.hasTimePicker=!1,this.disabled=!1,!e)throw new Error("[Slickgrid-Universal] Something is wrong with this grid, an Editor must always have valid arguments.");this.grid=e.grid,this.gridOptions=this.grid.getOptions()||{},this.gridOptions?.translater&&(this._translaterService=this.gridOptions.translater),this._bindEventService=new Ft,this.init()}get columnDef(){return this.args.column}get columnEditor(){return this.columnDef?.editor||{}}get dataContext(){return this.args.item}get editorDomElement(){return this._inputElm}get editorOptions(){return{...this.gridOptions.defaultEditorOptions?.date,...this.columnEditor?.editorOptions}}get hasAutoCommitEdit(){return this.gridOptions.autoCommitEdit??!1}get pickerOptions(){return this._pickerMergedOptions}get validator(){return this.columnEditor?.validator??this.columnDef?.validator}async init(){if(this.args&&this.columnDef){const e=this.args.compositeEditorOptions,t=this.columnDef?.id??"",i=this.args.grid.getOptions()||{};this.defaultDate=this.args.item?.[this.columnDef.field];const n=this.columnDef.outputType||this.columnEditor.type||this.columnDef.type||b.dateUtc,s=It(n),r=this._translaterService?.getCurrentLanguage?.()||i.locale||"en";s&&("ISO8601"===s||s.toLowerCase().includes("h"))&&(this.hasTimePicker=!0);const o=It(this.hasTimePicker?b.dateTimeIsoAM_PM:b.dateIso),a={input:!0,jumpToSelectedDate:!0,sanitizer:e=>this.grid.sanitizeHtmlString(e),toggleSelected:!1,actions:{clickDay:()=>{this._lastClickIsDate=!0},changeToInput:(e,t)=>{if(t.HTMLInputElement){let e="";if(t.selectedDates[0]?(e=t.selectedDates[0],t.HTMLInputElement.value=kt(t.selectedDates[0],void 0,n)):t.HTMLInputElement.value="",e&&this.hasTimePicker){const i=Ot(e,o);i.setHours(+(t.selectedHours||0)),i.setMinutes(+(t.selectedMinutes||0)),t.HTMLInputElement.value=kt(i,void 0,n)}this._lastClickIsDate&&(this.handleOnDateChange(),t.hide())}}},settings:{lang:r,iso8601:!1,visibility:{theme:this.gridOptions?.darkMode?"dark":"light",positionToInput:"auto",weekend:!1}}};this.hasTimePicker&&(a.settings.selection={time:24}),this._pickerMergedOptions=Ce(!0,{},a,{settings:this.editorOptions,type:"default"});const l=`.editor-text.date-picker.editor-${t}.form-control.input-group-editor`;this._editorInputGroupElm=Z("div",{className:"vanilla-picker input-group"});const c=Z("span",{className:"input-group-btn input-group-append",dataset:{clear:""}});this._clearButtonElm=Z("button",{type:"button",className:"btn btn-default btn-clear"}),this._clearButtonElm.appendChild(Z("i",{className:"icon-clear"})),this._inputElm=Z("input",{placeholder:this.columnEditor?.placeholder??"",title:this.columnEditor&&this.columnEditor.title||"",className:l.replace(/\./g," "),dataset:{input:"",defaultdate:this.defaultDate},readOnly:!0!==this.columnEditor.editorOptions?.allowInput},this._editorInputGroupElm),this.args.container.appendChild(this._editorInputGroupElm),this.columnEditor.editorOptions?.hideClearButton||(c.appendChild(this._clearButtonElm),this._editorInputGroupElm.appendChild(c),this._bindEventService.bind(this._clearButtonElm,"click",(()=>{this.clear(),this.handleOnDateChange()}))),this._bindEventService.bind(this._inputElm,"keydown",(e=>{!0===this.columnEditor.editorOptions?.allowInput&&(this._isValueTouched=!0,this._lastInputKeyEvent=e,"ArrowLeft"!==e.key&&"ArrowRight"!==e.key&&"Home"!==e.key&&"End"!==e.key||e.stopImmediatePropagation())})),queueMicrotask((()=>{this.calendarInstance=new hn(this._inputElm,this._pickerMergedOptions),this.calendarInstance.init(),e||(this.show(),this.focus()),this.calendarInstance&&Vt(this.columnEditor,this._inputElm,this.calendarInstance,{columnDef:this.columnDef,newVal:this.defaultDate,updatePickerUI:!0})}))}}destroy(){queueMicrotask((()=>{this.hide(),this.calendarInstance?.destroy(),ee(this._editorInputGroupElm),ee(this._inputElm),this._editorInputGroupElm?.remove(),this._inputElm?.remove()})),this._bindEventService.unbindAll()}clear(){this._lastTriggeredByClearDate=!0,this.calendarInstance&&(this.calendarInstance.settings.selected.dates=[],this._inputElm.value="")}disable(e=!0){const t=this.disabled;if(this.disabled=e,this._inputElm)if(e){this._inputElm.setAttribute("disabled","disabled"),this._clearButtonElm.disabled=!0;const i=this.getValue();t!==e&&this.args?.compositeEditorOptions&&""!==i&&this.reset("",!0,!0)}else this._inputElm.removeAttribute("disabled"),this._clearButtonElm.disabled=!1}changeEditorOption(e,t){this.columnEditor.editorOptions||(this.columnEditor.editorOptions={}),this.columnEditor.editorOptions[e]=t,this._pickerMergedOptions=Ce(!0,{},this._pickerMergedOptions,{settings:{[e]:t}})}focus(){this.grid.focus(),this.show(),this._inputElm?.focus()}hide(){this.calendarInstance?.hide()}show(){const e=!!this.args?.compositeEditorOptions;!e&&this.calendarInstance?this.calendarInstance.show():e&&this.applyInputUsabilityState()}getValue(){return this._inputElm.value}setValue(e,t=!1,i=!0){if(this.calendarInstance&&Vt(this.columnEditor,this._inputElm,this.calendarInstance,{columnDef:this.columnDef,newVal:e,updatePickerUI:!0}),t){this.applyValue(this.args.item,this.serializeValue());const e=this.args.compositeEditorOptions;e&&i&&this.handleChangeOnCompositeEditor(e,"system")}}applyValue(e,t){const i=this.columnDef?.field;if(this.columnDef&&void 0!==i){const n=this.columnDef.saveOutputType||this.columnDef.outputType||this.columnEditor.type||this.columnDef.type||b.dateUtc,s=this.columnDef.outputType||this.columnEditor.type||this.columnDef.type||b.dateUtc,r=i.indexOf(".")>0,o=this.validate(null,t),a=t&&o?.valid?kt(t,s,n):"";r?He(e,this.columnEditor?.complexObjectPath??i,a):e[i]=a}}isValueChanged(){let e=!1;const t=this.getValue(),i=this._lastInputKeyEvent?.key;return!(!0!==this.columnEditor.editorOptions?.allowInput||!this.columnEditor?.alwaysSaveOnEnterKey||"Enter"!==i)||(this.columnDef&&(e=this._lastTriggeredByClearDate||!(""===t&&""===this._originalDate)&&t!==this._originalDate),e)}isValueTouched(){return this._isValueTouched}loadValue(e){const t=this.columnDef?.field;if(e&&this.columnDef&&void 0!==t){const i=t?.indexOf(".")>0?H(e,t):e[t],n=this.columnEditor.type||this.columnDef?.type||b.dateIso,s=this.columnDef.outputType||this.columnEditor.type||this.columnDef.type||b.dateIso;this._originalDate=kt(i,n,s),this._inputElm.value=this._originalDate}}reset(e,t=!0,i=!1){const n=e??this._originalDate??"";this.calendarInstance&&(this._originalDate=n,this.calendarInstance.settings.selected.dates=[n],n||(this.calendarInstance.settings.selected.dates=[],this._inputElm.value="")),this._isValueTouched=!1;const s=this.args.compositeEditorOptions;if(s&&t){const e=!i;this.handleChangeOnCompositeEditor(s,"user",e)}}save(){const e=this.validate(),t=e?.valid??!1;this.hasAutoCommitEdit&&t?this.grid.getEditorLock().commitCurrentEdit():this.args.commitChanges()}serializeValue(){return this.getValue()||""}validate(e,t){const i=!this.args?.compositeEditorOptions&&this.columnEditor.required,n=t??this._inputElm?.value,s=this.columnEditor.errorMessage;return this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled?{valid:!0,msg:""}:this.validator?this.validator(n,this.args):i&&""===n?{valid:!1,msg:s||m.VALIDATION_REQUIRED_FIELD}:{valid:!0,msg:null}}applyInputUsabilityState(){const e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(!1===t)}handleOnDateChange(){if(this._isValueTouched=!0,this.args){const e=this.args.compositeEditorOptions;e?this.handleChangeOnCompositeEditor(e):this.save()}window.setTimeout((()=>this._lastTriggeredByClearDate=!1))}handleChangeOnCompositeEditor(e,t="user",i=!1){const n=this.grid.getActiveCell(),s=this.args.column,r=this.columnDef?.id??"",o=this.dataContext,a=this.grid,l=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,l),this.applyValue(e.formValues,l);const c=this.gridOptions?.compositeEditorOptions?.excludeDisabledFieldFormValues??!1;(i||this.disabled&&c&&e.formValues.hasOwnProperty(r))&&delete e.formValues[r],a.onCompositeEditorChange.notify({...n,item:o,grid:a,column:s,formValues:e.formValues,editors:e.editors,triggeredBy:t},new mn)}},dualInput:class{constructor(e){if(this.args=e,this._isValueSaveCalled=!1,this._isLeftValueTouched=!1,this._isRightValueTouched=!1,this.disabled=!1,!e)throw new Error("[Slickgrid-Universal] Something is wrong with this grid, an Editor must always have valid arguments.");this.grid=e.grid,this.gridOptions=this.grid.getOptions()||{},this._eventHandler=new vn,this._bindEventService=new Ft,this.init(),this._eventHandler.subscribe(this.grid.onValidationError,(()=>this._isValueSaveCalled=!0))}get columnDef(){return this.args.column}get columnEditor(){return this.columnDef?.editor||{}}get dataContext(){return this.args.item}get editorDomElement(){return{leftInput:this._leftInput,rightInput:this._rightInput}}get editorParams(){return this.columnEditor.params||{}}get eventHandler(){return this._eventHandler}get hasAutoCommitEdit(){return this.gridOptions.autoCommitEdit??!1}get isValueSaveCalled(){return this._isValueSaveCalled}get validator(){return this.columnEditor?.validator??this.columnDef?.validator}init(){if(!(this.editorParams&&this.editorParams.leftInput&&this.editorParams.leftInput.field&&this.editorParams.rightInput&&this.editorParams.rightInput.field))throw new Error("[Slickgrid-Universal] Please make sure that your Combo Input Editor has params defined with \"leftInput\" and \"rightInput\" (example: { editor: { model: Editors.comboInput, params: { leftInput: { field: 'firstName' }, { rightSide: { field: 'lastName' } }}}");this._leftFieldName=this.editorParams.leftInput?.field,this._rightFieldName=this.editorParams.rightInput?.field,this._leftInput=this.createInput("leftInput"),this._rightInput=this.createInput("rightInput");const e=this.args?.container;e&&"function"==typeof e.appendChild&&(e.appendChild(this._leftInput),e.appendChild(this._rightInput)),this._bindEventService.bind(this._leftInput,"keydown",(e=>this.handleKeyDown(e,"leftInput"))),this._bindEventService.bind(this._rightInput,"keydown",(e=>this.handleKeyDown(e,"rightInput"))),this.hasAutoCommitEdit&&(this._bindEventService.bind(this._leftInput,"focusout",(e=>this.handleFocusOut(e,"leftInput"))),this._bindEventService.bind(this._rightInput,"focusout",(e=>this.handleFocusOut(e,"rightInput"))));const t=this.args?.compositeEditorOptions;t?(this._bindEventService.bind(this._leftInput,"input",this.handleChangeOnCompositeEditorDebounce.bind(this)),this._bindEventService.bind(this._rightInput,"input",this.handleChangeOnCompositeEditorDebounce.bind(this))):window.setTimeout((()=>this._leftInput.select()),50)}handleFocusOut(e,t){const i=e.relatedTarget?.className||"";this.args.compositeEditorOptions||-1!==i.indexOf("dual-editor")||"focusout-right"===this._lastEventType||("rightInput"===t||"leftInput"===t&&"focusout-left"!==this._lastEventType)&&("leftInput"===t?this._isLeftValueTouched=!0:this._isRightValueTouched=!0,this.save());const n="leftInput"===t?"left":"right";this._lastEventType=`${e?.type}-${n}`}handleKeyDown(e,t){"leftInput"===t?this._isLeftValueTouched=!0:this._isRightValueTouched=!0,this._lastInputKeyEvent=e,"ArrowLeft"!==e.key&&"ArrowRight"!==e.key&&"Home"!==e.key&&"End"!==e.key&&"Tab"!==e.key||e.stopImmediatePropagation()}destroy(){this._eventHandler.unsubscribeAll(),this._bindEventService.unbindAll(),this._leftInput?.remove?.(),this._rightInput?.remove?.()}createInput(e){const t=this.editorParams[e],i=this.columnDef?.id??"",n=this.gridOptions.datasetIdPropertyName||"id",s=this.args?.item?.[n]??"";let r=t.type||"text";"float"!==r&&"integer"!==r||(r="number");const o=Z("input",{type:r||"text",id:`item-${s}-${e}`,ariaLabel:this.columnEditor?.ariaLabel??`${We(i+"")} Input Editor`,className:`dual-editor-text editor-${i} ${e.replace(/input/gi,"")}`,autocomplete:"off",ariaAutoComplete:"none",placeholder:t.placeholder||"",title:t.title||""});return"readonly"===r&&(o.readOnly=!0,r="text"),"number"===r&&(o.step=this.getInputDecimalSteps(e)),o}disable(e=!0){const t=this.disabled;this.disabled=e,this._leftInput&&this._rightInput&&(e?(this._leftInput.setAttribute("disabled","disabled"),this._rightInput.setAttribute("disabled","disabled"),t!==e&&this.args?.compositeEditorOptions&&this.reset("",!0,!0)):(this._leftInput.removeAttribute("disabled"),this._rightInput.removeAttribute("disabled")))}focus(){this.grid.focus()}show(){this.args?.compositeEditorOptions&&this.applyInputUsabilityState()}getValues(){const e={},t=this._leftInput.value,i=this._rightInput.value,n=this.editorParams.leftInput&&("float"===this.editorParams.leftInput.type||"integer"===this.editorParams.leftInput.type),s=this.editorParams.rightInput&&("float"===this.editorParams.rightInput.type||"integer"===this.editorParams.rightInput.type),r=""!==t&&n?+this._leftInput.value:t||"",o=""!==i&&s?+this._rightInput.value:i||"";return He(e,this._leftFieldName,r),He(e,this._rightFieldName,o),e}setValues(e){Array.isArray(e)&&2===e.length&&(this._leftInput.value=`${e[0]}`,this._rightInput.value=`${e[1]}`)}applyValue(e,t){this.applyValueByPosition(e,t,"leftInput"),this.applyValueByPosition(e,t,"rightInput")}applyValueByPosition(e,t,i){const n="leftInput"===i?this._leftFieldName:this._rightFieldName;if(void 0!==n){const s=n?.indexOf(".")>0;let r=n;if(s){const e=n.split(/\.(.*)/);r=e.length>1?e[1]:e}const o=s?H(t,r):t[n],a=this.validate(null,{position:i,inputValue:o});if(s){const i=H(t,r),s=a&&a.valid?i:"";He(e,this.columnEditor?.complexObjectPath??n??"",s)}else n&&(e[n]=a&&a.valid?t[n]:"")}}isValueChanged(){const e=this._leftInput.value,t=this._rightInput.value,i=this.editorParams?.leftInput,n=this.editorParams?.rightInput,s=this._lastInputKeyEvent?.key;if((i&&i.alwaysSaveOnEnterKey||n&&n.alwaysSaveOnEnterKey)&&"Enter"===s)return!0;const r=!(""===e&&(null===this._originalLeftValue||void 0===this._originalLeftValue))&&e!==this._originalLeftValue,o=!(""===t&&(null===this._originalRightValue||void 0===this._originalRightValue))&&t!==this._originalRightValue;return r||o}isValueTouched(){return this._isLeftValueTouched||this._isRightValueTouched}loadValue(e){this.loadValueByPosition(e,"leftInput"),this.loadValueByPosition(e,"rightInput"),this._leftInput.select()}loadValueByPosition(e,t){const i="leftInput"===t?this._leftFieldName:this._rightFieldName,n="leftInput"===t?"_originalLeftValue":"_originalRightValue",s="leftInput"===t?"_leftInput":"_rightInput";if(e&&void 0!==i){const r=i?.indexOf(".")>0?H(e,i):e.hasOwnProperty(i)?e[i]:"";if(this[n]=r,"float"===this.editorParams[t].type){const e=this.getDecimalPlaces(t);null===e||!this[n]&&0!==this[n]||void 0===this[n]||(this[n]=(+this[n]).toFixed(e))}this[s]&&(this[s].value=`${this[n]}`)}}reset(e,t=!0,i=!1){const n=e??this._originalLeftValue??"",s=e??this._originalRightValue??"";this._leftInput&&this._rightInput&&(this._originalLeftValue=n,this._originalRightValue=s,this._leftInput.value=`${n}`,this._rightInput.value=`${s}`),this._isLeftValueTouched=!1,this._isRightValueTouched=!1;const r=this.args.compositeEditorOptions;if(r&&t){const e=!i;this.handleChangeOnCompositeEditor(null,r,"user",e)}}save(){const e=this.validate(),t=e&&e.valid||!1;this._isValueSaveCalled||(this.hasAutoCommitEdit&&t?this.grid.getEditorLock().commitCurrentEdit():this.args.commitChanges(),this._isValueSaveCalled=!0)}serializeValue(){const e={},t=this.serializeValueByPosition("leftInput"),i=this.serializeValueByPosition("rightInput");return He(e,this._leftFieldName,t),He(e,this._rightFieldName,i),e}serializeValueByPosition(e){const t="leftInput"===e?this._leftInput.value:this._rightInput.value;if(""===t||isNaN(+t))return t;let i=parseFloat(t);const n=this.getDecimalPlaces(e);return null!==n&&(i||0===i)&&i.toFixed&&(i=parseFloat(i.toFixed(n))),i}getDecimalPlaces(e){const t="leftInput"===e?"leftInput":"rightInput",i=this.editorParams[t],n=i?.decimal;return void 0===n?0:n}getInputDecimalSteps(e){const t=this.getDecimalPlaces(e);let i="";for(let e=1;e<t;e++)i+="0";return t>0?`0.${i}1`:"1"}validate(e,t){if(this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled)return{valid:!0,msg:""};if(t){const e=this.validateByPosition(t.position,t.inputValue);if(!e.valid)return"leftInput"===t.position?this._leftInput.select():this._rightInput.select(),e}else{const e=this.validateByPosition("leftInput"),t=this.validateByPosition("rightInput");if(!e.valid)return this._leftInput.select(),e;if(!t.valid)return this._rightInput.select(),t}return{valid:!0,msg:""}}validateByPosition(e,t){const i=this.editorParams[e];let n="";if(t)n=t;else{const t="leftInput"===e?this._leftInput:this._rightInput;n=t&&t.value}const s=this.validator;n="function"==typeof s?this.getValues():n;const r={editorArgs:this.args,errorMessage:i.errorMessage,required:!this.args?.compositeEditorOptions&&i.required,validator:"function"==typeof s?s:i.validator};switch(i.type){case"float":return Oa(n,{...r,decimal:this.getDecimalPlaces(e),minValue:i.minValue,maxValue:i.maxValue,operatorConditionalType:i.operatorConditionalType});case"integer":return Ia(n,{...r,minValue:i.minValue,maxValue:i.maxValue,operatorConditionalType:i.operatorConditionalType});default:return Aa(n,r)}}applyInputUsabilityState(){const e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(!1===t)}handleChangeOnCompositeEditor(e,t,i="user",n=!1){const s=this.grid.getActiveCell(),r=this.args.column,o=this.columnEditor.params?.leftInput?.field??"",a=this.columnEditor.params?.rightInput?.field??"",l=this.dataContext,c=this.grid,h=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,h),this.applyValue(t.formValues,h);const d=this.gridOptions?.compositeEditorOptions?.excludeDisabledFieldFormValues??!1;(n||this.disabled&&d&&t.formValues.hasOwnProperty(o))&&delete t.formValues[o],(n||this.disabled&&d&&t.formValues.hasOwnProperty(a))&&delete t.formValues[a],c.onCompositeEditorChange.notify({...s,item:l,grid:c,column:r,formValues:t.formValues,editors:t.editors,triggeredBy:i},new mn(e))}handleChangeOnCompositeEditorDebounce(e){const t=this.args?.compositeEditorOptions;if(t){const i=this.gridOptions?.editorTypingDebounce??500;window.clearTimeout(this._timer),this._timer=window.setTimeout((()=>this.handleChangeOnCompositeEditor(e,t)),i)}}},float:class extends ka{constructor(e){super(e,"number"),this.args=e}loadValue(e){const t=this.columnDef&&this.columnDef.field;if(void 0!==t&&e&&void 0!==t&&this._input){const i=t?.indexOf(".")>0?H(e,t):e[t];this._originalValue=i;const n=this.getDecimalPlaces();null===n||!this._originalValue&&0!==this._originalValue||void 0===this._originalValue||(this._originalValue=(+this._originalValue).toFixed(n)),this._input.value=`${this._originalValue}`,this._input.select()}}serializeValue(){const e=this._input?.value;if(void 0===e||""===e||isNaN(+e))return e;let t=parseFloat(e);const i=this.getDecimalPlaces();return null!==i&&(t||0===t)&&t.toFixed&&(t=parseFloat(t.toFixed(i))),t}validate(e,t){return this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled?{valid:!0,msg:""}:Oa(void 0!==t?t:this._input?.value,{editorArgs:this.args,errorMessage:this.columnEditor.errorMessage,decimal:this.getDecimalPlaces(),minValue:this.columnEditor.minValue,maxValue:this.columnEditor.maxValue,operatorConditionalType:this.columnEditor.operatorConditionalType,required:!this.args?.compositeEditorOptions&&this.columnEditor.required,validator:this.validator})}},integer:class extends ka{constructor(e){super(e,"number"),this.args=e}loadValue(e){const t=this.columnDef?.field;if(void 0!==t&&e&&void 0!==t&&this._input){const i=t?.indexOf(".")>0?H(e,t):e[t];this._originalValue=isNaN(i)||null==i?i:`${i}`,this._input.value=`${this._originalValue}`,this._input.select()}}serializeValue(){const e=this._input?.value;if(void 0===e||""===e||isNaN(+e))return e;const t=isNaN(+e)?e:parseInt(e,10);return isNaN(+t)?e:t}validate(e,t){return this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled?{valid:!0,msg:""}:Ia(void 0!==t?t:this.getValue(),{editorArgs:this.args,errorMessage:this.columnEditor.errorMessage,minValue:this.columnEditor.minValue,maxValue:this.columnEditor.maxValue,operatorConditionalType:this.columnEditor.operatorConditionalType,required:!this.args?.compositeEditorOptions&&this.columnEditor.required,validator:this.validator})}handleOnMouseWheel(e){this._isValueTouched=!0;const t=this.args.compositeEditorOptions;t&&this.handleChangeOnCompositeEditor(e,t)}},longText:class{constructor(e){if(this.args=e,this._isValueTouched=!1,this.disabled=!1,!e)throw new Error("[Slickgrid-Universal] Something is wrong with this grid, an Editor must always have valid arguments.");this.grid=e.grid,this.gridOptions=e.grid?.getOptions();const t=this.gridOptions||this.args.column.params||{};t?.translater&&(this._translater=t.translater),this._locales=this.gridOptions?.locales||m.locales,this._bindEventService=new Ft,this.init()}get columnDef(){return this.args.column}get columnEditor(){return this.columnDef?.editor??{}}get dataContext(){return this.args.item}get editorDomElement(){return this._textareaElm}get editorOptions(){return{...this.gridOptions.defaultEditorOptions?.longText,...this.columnEditor?.editorOptions}}get hasAutoCommitEdit(){return this.gridOptions?.autoCommitEdit??!1}get validator(){return this.columnEditor?.validator??this.columnDef?.validator}init(){let e="",t="";if(this._translater&&this._translater.translate&&this.gridOptions.enableTranslate){const i=B(this.gridOptions),n=this.editorOptions.buttonTexts?.cancelKey??`${i}CANCEL`,s=this.editorOptions.buttonTexts?.saveKey??`${i}SAVE`;e=this._translater.translate(`${i}${n}`),t=this._translater.translate(`${i}${s}`)}else e=this.editorOptions.buttonTexts?.cancel??this._locales?.TEXT_CANCEL??"Cancel",t=this.editorOptions.buttonTexts?.save??this._locales?.TEXT_SAVE??"Save";const i=this.args.compositeEditorOptions,n=this.columnDef?.id??"",s=this.columnEditor?.maxLength,r=this.editorOptions?.rows??4,o=i?this.args.container:document.body;this._wrapperElm=Z("div",{className:`slick-large-editor-text editor-${n}`,style:{position:i?"relative":"absolute"}}),this.gridOptions?.darkMode&&this._wrapperElm.classList.add("slick-dark-mode"),o.appendChild(this._wrapperElm),this._textareaElm=Z("textarea",{ariaLabel:this.columnEditor?.ariaLabel??`${We(n+"")} Text Editor`,cols:this.editorOptions?.cols??40,rows:i&&r>3?3:r,placeholder:this.columnEditor?.placeholder??"",title:this.columnEditor?.title??""},this._wrapperElm);const a=Z("div",{className:"editor-footer"}),l=Z("span",{className:"counter"});if(this._currentLengthElm=Z("span",{className:"text-length",textContent:"0"}),l.appendChild(this._currentLengthElm),void 0!==s&&(l.appendChild(Z("span",{className:"separator",textContent:"/"})),l.appendChild(Z("span",{className:"max-length",textContent:`${s}`}))),a.appendChild(l),!i){const i=Z("button",{className:"btn btn-cancel btn-default btn-xs",textContent:e},a),n=Z("button",{className:"btn btn-save btn-primary btn-xs",textContent:t},a);this._bindEventService.bind(i,"click",this.cancel.bind(this)),this._bindEventService.bind(n,"click",this.save.bind(this)),this.position(this.args?.position),this._textareaElm.focus(),this._textareaElm.select()}this._wrapperElm.appendChild(a),this._bindEventService.bind(this._textareaElm,"keydown",this.handleKeyDown.bind(this)),this._bindEventService.bind(this._textareaElm,"input",this.handleOnInputChange.bind(this)),this._bindEventService.bind(this._textareaElm,"paste",this.handleOnInputChange.bind(this))}cancel(){const e=this._defaultTextValue||"";this._textareaElm.value=e,this._currentLengthElm.textContent=`${e.length}`,this.args?.cancelChanges&&this.args.cancelChanges()}hide(){this._wrapperElm.style.display="none"}show(){this.args?.compositeEditorOptions?this.applyInputUsabilityState():this._wrapperElm.style.display="block"}destroy(){this._bindEventService.unbindAll(),this._wrapperElm?.remove?.()}disable(e=!0){const t=this.disabled;if(this.disabled=e,this._textareaElm&&this._wrapperElm)if(e){this._textareaElm.disabled=!0,this._wrapperElm.classList.add("disabled");const i=this.getValue();t!==e&&this.args?.compositeEditorOptions&&""!==i&&this.reset("",!0,!0)}else this._textareaElm.disabled=!1,this._wrapperElm.classList.remove("disabled")}focus(){this.grid.focus(),this._textareaElm&&(this._textareaElm.focus(),this._textareaElm.select())}getValue(){return this._textareaElm.value}setValue(e,t=!1,i=!0){if(this._textareaElm.value=e,this._currentLengthElm.textContent=`${e.length}`,t){this.applyValue(this.args.item,this.serializeValue());const e=this.args.compositeEditorOptions;e&&i&&this.handleChangeOnCompositeEditor(null,e,"system")}}applyValue(e,t){const i=this.columnDef?.field;if(void 0!==i){const n=i?.indexOf(".")>0,s=this.validate(void 0,t),r=s?.valid?t:"";n?He(e,this.columnEditor?.complexObjectPath??i??"",r):e[i]=r}}isValueChanged(){const e=this._textareaElm.value;return!(""===e&&(null===this._defaultTextValue||void 0===this._defaultTextValue))&&e!==this._defaultTextValue}isValueTouched(){return this._isValueTouched}loadValue(e){const t=this.columnDef?.field;if(e&&void 0!==t){const i=t?.indexOf(".")>0?H(e,t):e[t];this._defaultTextValue=i||"",this._textareaElm.value=this._defaultTextValue,this._currentLengthElm.textContent=this._defaultTextValue.length,this._textareaElm.defaultValue=this._defaultTextValue,this._textareaElm.select()}}position(e){const t=ne(this.args.container),i=this.args.container.offsetHeight,n=this.args.container.offsetWidth,s=this._wrapperElm.getBoundingClientRect().height||this.args.position.height,r=this._wrapperElm.getBoundingClientRect().width||this.args.position.width,o=document.body.offsetHeight||window.innerHeight,a=document.body.offsetWidth||window.innerWidth;let l=this.args.container?t.top:e.top??0,c=this.args.container?t.left:e.left??0;const h=this.editorOptions?.position??"auto";("left"===h||"auto"===h&&c+r>a)&&(c-=r-n+(this.editorOptions?.marginRight??0)),("top"===h||"auto"===h&&l+s>o)&&(l-=s-i),this._wrapperElm.style.top=`${l}px`,this._wrapperElm.style.left=`${c}px`}reset(e,t=!0,i=!1){const n=e??this._defaultTextValue??"";this._textareaElm&&(this._defaultTextValue=n,this._textareaElm.value=n,this._currentLengthElm.textContent=n.length),this._isValueTouched=!1;const s=this.args.compositeEditorOptions;if(s&&t){const e=!i;this.handleChangeOnCompositeEditor(null,s,"user",e)}}save(){const e=this.validate(),t=e?.valid??!1;this.hasAutoCommitEdit&&t?this.grid.getEditorLock().commitCurrentEdit():this.args.commitChanges()}serializeValue(){return this._textareaElm.value}validate(e,t){return this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled?{valid:!0,msg:""}:Aa(void 0!==t?t:this._textareaElm?.value,{editorArgs:this.args,errorMessage:this.columnEditor.errorMessage,minLength:this.columnEditor.minLength,maxLength:this.columnEditor.maxLength,operatorConditionalType:this.columnEditor.operatorConditionalType,required:!this.args?.compositeEditorOptions&&this.columnEditor.required,validator:this.validator})}applyInputUsabilityState(){const e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(!1===t)}handleKeyDown(e){const t=e.key;this._isValueTouched=!0,this.args.compositeEditorOptions||("Enter"===t&&e.ctrlKey||e.ctrlKey&&"S"===e.key.toUpperCase()?(e.preventDefault(),this.save()):"Escape"===t?(e.preventDefault(),this.cancel()):"Tab"===t&&e.shiftKey?(e.preventDefault(),this.args&&this.grid&&this.grid.navigatePrev()):"Tab"===t&&(e.preventDefault(),this.args&&this.grid&&this.grid.navigateNext()))}handleOnInputChange(e){const t=this.args.compositeEditorOptions,i=this.columnEditor?.maxLength;let n=!1;if(i&&(n=this.truncateText(this._textareaElm,i)),n)this._currentLengthElm.textContent=`${i}`;else{const t="paste"===e.type?e.clipboardData.getData("text"):e.target.value;this._currentLengthElm.textContent=`${t.length}`}if(t){const i=this.gridOptions?.editorTypingDebounce??500;window.clearTimeout(this._timer),this._timer=window.setTimeout((()=>this.handleChangeOnCompositeEditor(e,t)),i)}}handleChangeOnCompositeEditor(e,t,i="user",n=!1){const s=this.grid.getActiveCell(),r=this.args.column,o=this.columnDef?.id??"",a=this.dataContext,l=this.grid,c=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,c),this.applyValue(t.formValues,c);const h=this.gridOptions?.compositeEditorOptions?.excludeDisabledFieldFormValues??!1;(n||this.disabled&&h&&t.formValues.hasOwnProperty(o))&&delete t.formValues[o],l.onCompositeEditorChange.notify({...s,item:a,grid:l,column:r,formValues:t.formValues,editors:t.editors,triggeredBy:i},new mn(e))}truncateText(e,t){const i=e.value+"";return i.length>t&&(e.value=i.substring(0,t),!0)}},multipleSelect:class extends Da{constructor(e,t=0){super(e,!0,t),this.args=e,this.delayOpening=t}},password:class extends ka{constructor(e){super(e,"password"),this.args=e}},singleSelect:class extends Da{constructor(e,t=0){super(e,!1,t),this.args=e,this.delayOpening=t}},slider:class{constructor(e){if(this.args=e,this._defaultValue=0,this._isValueTouched=!1,this._sliderNumberElm=null,this.disabled=!1,!e)throw new Error("[Slickgrid-Universal] Something is wrong with this grid, an Editor must always have valid arguments.");this.grid=e.grid,this.gridOptions=this.grid.getOptions()||{},this._bindEventService=new Ft,this.init()}get columnDef(){return this.args.column}get columnEditor(){return this.columnDef?.editor??{}}get dataContext(){return this.args.item}get editorDomElement(){return this._editorElm}get editorInputDomElement(){return this._inputElm}get editorOptions(){return{...this.gridOptions.defaultEditorOptions?.slider,...this.columnEditor?.editorOptions}}get hasAutoCommitEdit(){return this.gridOptions.autoCommitEdit??!1}get sliderOptions(){return this._sliderOptions}get validator(){return this.columnEditor.validator??this.columnDef?.validator}init(){if(this._cellContainerElm=this.args?.container,this._cellContainerElm&&this.columnDef){const e=this.args.compositeEditorOptions;this._editorElm=this.buildDomElement(),e||this.focus(),this._cellContainerElm.appendChild(this._editorElm),this._bindEventService.bind(this._sliderTrackElm,["click","mouseup"],this.sliderTrackClicked.bind(this)),this._bindEventService.bind(this._inputElm,["change","mouseup","touchend"],this.handleChangeEvent.bind(this)),this._bindEventService.bind(this._inputElm,["input","change"],this.handleChangeSliderNumber.bind(this))}}cancel(){this._inputElm&&(this._inputElm.value=`${this._originalValue}`),this.args.cancelChanges()}destroy(){this._bindEventService.unbindAll(),this._inputElm?.remove(),this._editorElm?.remove(),this._sliderTrackElm?.remove()}disable(e=!0){const t=this.disabled;if(this.disabled=e,this._inputElm)if(e){this._inputElm.disabled=!0;const i=this.getValue();t!==e&&this.args?.compositeEditorOptions&&""!==i&&this.reset(0,!0,!0)}else this._inputElm.disabled=!1}focus(){this.grid.focus(),this._inputElm?.focus()}show(){this.args?.compositeEditorOptions&&this.applyInputUsabilityState()}getValue(){return this._inputElm?.value??""}setValue(e,t=!1,i=!0){if(this._inputElm&&(this._inputElm.value=`${e}`),this._sliderNumberElm&&(this._sliderNumberElm.textContent=`${e}`),t){this.applyValue(this.args.item,this.serializeValue());const e=this.args.compositeEditorOptions;e&&i&&this.handleChangeOnCompositeEditor(null,e,"system")}}applyValue(e,t){const i=this.columnDef?.field??"";if(void 0!==i){const n=i?.indexOf(".")>0,s=this.validate(void 0,t),r=s&&s.valid?t:"";n?He(e,this.columnEditor.complexObjectPath??i??"",r):e&&(e[i]=r)}}isValueChanged(){const e=this._inputElm?.value??"";return!(""===e&&void 0===this._originalValue)&&+e!==this._originalValue}isValueTouched(){return this._isValueTouched}loadValue(e){const t=this.columnDef?.field??"";if(e&&void 0!==t){let i=t?.indexOf(".")>0?H(e,t):e.hasOwnProperty(t)?e[t]:this._defaultValue;""!==i&&null!=i||(i=this._defaultValue),this._originalValue=+i,this._inputElm&&(this._inputElm.value=`${i}`,this._inputElm.title=`${i}`),this._sliderNumberElm&&(this._sliderNumberElm.textContent=`${i}`)}this.updateTrackFilledColorWhenEnabled()}reset(e,t=!0,i=!1){const n=e??this._originalValue??0;this._inputElm&&(this._inputElm.value=`${n}`),this._sliderNumberElm&&(this._sliderNumberElm.textContent=`${n}`),this._isValueTouched=!1;const s=this.args.compositeEditorOptions;if(s&&t){const e=!i;this.handleChangeOnCompositeEditor(null,s,"user",e)}}save(){const e=this.validate(),t=e&&e.valid||!1;this.hasAutoCommitEdit&&t?this.grid.getEditorLock().commitCurrentEdit():this.args.commitChanges()}serializeValue(){const e=this._inputElm?.value??"";return""!==e?parseInt(e,10):this._originalValue}validate(e,t){return this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled?{valid:!0,msg:""}:function(e,t){const i=t.required,n=t.minValue,s=t.maxValue,r=t.errorMessage,o={"{{minValue}}":n,"{{maxValue}}":s};return t.validator?t.validator(e,t.editorArgs):i&&""===e?{valid:!1,msg:r||m.VALIDATION_REQUIRED_FIELD}:void 0!==n&&void 0!==s&&null!==e&&(e<n||e>s)?{valid:!1,msg:r||m.VALIDATION_EDITOR_NUMBER_BETWEEN.replace(/{{minValue}}|{{maxValue}}/gi,(e=>o[e]))}:{valid:!0,msg:null}}(void 0!==t?t:this._inputElm?.value,{editorArgs:this.args,errorMessage:this.columnEditor.errorMessage,minValue:this.columnEditor.minValue,maxValue:this.columnEditor.maxValue,required:!this.args?.compositeEditorOptions&&this.columnEditor.required,validator:this.validator})}buildDomElement(){const e=this.columnDef?.id??"",t=this.columnEditor.title??"",i=+(this.columnEditor.minValue??m.SLIDER_DEFAULT_MIN_VALUE),n=+(this.columnEditor.maxValue??m.SLIDER_DEFAULT_MAX_VALUE),s=+(this.columnEditor.valueStep??m.SLIDER_DEFAULT_STEP),r=this.editorOptions.sliderStartValue??i;this._defaultValue=+r,this._sliderTrackElm=Z("div",{className:"slider-track"}),this._inputElm=Z("input",{type:"range",title:t,defaultValue:`${r}`,value:`${r}`,min:`${i}`,max:`${n}`,step:`${this.columnEditor.valueStep??m.SLIDER_DEFAULT_STEP}`,ariaLabel:this.columnEditor.ariaLabel??`${We(e+"")} Slider Editor`,className:`slider-editor-input editor-${e}`});const o=Z("div",{className:"slider-container slider-editor"}),a=Z("div",{className:"slider-input-container slider-editor"});if(a.appendChild(this._sliderTrackElm),a.appendChild(this._inputElm),o.appendChild(a),!this.editorOptions.hideSliderNumber){o.classList.add("input-group");const e=Z("div",{className:"input-group-addon input-group-append slider-value"});this._sliderNumberElm=Z("span",{className:"input-group-text",textContent:`${r}`}),e.appendChild(this._sliderNumberElm),o.appendChild(e)}return this._sliderOptions={minValue:i,maxValue:n,step:s},o}applyInputUsabilityState(){const e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(!1===t)}handleChangeEvent(e){this._isValueTouched=!0;const t=this.args.compositeEditorOptions;t?this.handleChangeOnCompositeEditor(e,t):this.save()}handleChangeSliderNumber(e){const t=e.target?.value??"";""!==t&&(!this.editorOptions.hideSliderNumber&&this._sliderNumberElm&&(this._sliderNumberElm.textContent=t),this._inputElm.title=t,this.args?.compositeEditorOptions||this.grid.onMouseEnter.notify({column:this.columnDef,grid:this.grid},new mn(e))),this.updateTrackFilledColorWhenEnabled()}handleChangeOnCompositeEditor(e,t,i="user",n=!1){const s=this.grid.getActiveCell(),r=this.args.column,o=this.columnDef?.id??"",a=this.dataContext,l=this.grid,c=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,c),this.applyValue(t.formValues,c);const h=this.gridOptions?.compositeEditorOptions?.excludeDisabledFieldFormValues??!1;(n||this.disabled&&h&&t.formValues.hasOwnProperty(o))&&delete t.formValues[o],l.onCompositeEditorChange.notify({...s,item:a,grid:l,column:r,formValues:t.formValues,editors:t.editors,triggeredBy:i},new mn(e))}sliderTrackClicked(e){e.preventDefault();const t=100*(e.offsetX+0)/this._sliderTrackElm.offsetWidth;this._inputElm&&(this._inputElm.value=`${t}`,this._inputElm.dispatchEvent(new Event("change")))}updateTrackFilledColorWhenEnabled(){if(this.editorOptions.enableSliderTrackColoring&&this._inputElm){const e=0,t=(+this.getValue()-+this._inputElm.min)/(this.sliderOptions?.maxValue??0-+this._inputElm.min)*100,i="linear-gradient(to right, %b %p1, %c %p1, %c %p2, %b %p2)".replace(/%b/g,"#eee").replace(/%c/g,this.editorOptions?.sliderTrackFilledColor??"var(--slick-slider-filter-thumb-color, #86bff8)").replace(/%p1/g,`${e}%`).replace(/%p2/g,`${t}%`);this._sliderTrackElm.style.background=i,this._sliderOptions.sliderTrackBackground=i}}},text:ka},Ra=(e,t,i)=>{if(Array.isArray(i)&&i.length>0){const e=i.join(", ");return Z("span",{title:e,textContent:e})}return i},La=(e,t,i,n,s)=>{if(!n)return"";const r=n.params||{},o=r?.complexField??r?.complexFieldLabel??n.field;if(!o)throw new Error("For the Formatters.complexObject to work properly, you need to tell it which property of the complex object to use.\n      There are 3 ways to provide it:\n      1- via the generic \"params\" with a \"complexField\" property on your Column Definition, example: this.columnDefs = [{ id: 'user', field: 'user', params: { complexField: 'user.firstName' } }]\n      2- via the generic \"params\" with a \"complexField\" and a \"labelKey\" property on your Column Definition, example: this.columnDefs = [{ id: 'user', field: 'user', labelKey: 'firstName', params: { complexField: 'user' } }]\n      3- via the field name that includes a dot notation, example: this.columnDefs = [{ id: 'user', field: 'user.firstName'}] ");if(n.labelKey&&s.hasOwnProperty(o))return s[o]?.[n.labelKey];if("string"==typeof o&&o.indexOf(".")>0){let e=o.split(".").reduce(((e,t)=>e?.hasOwnProperty(t)?e[t]:""),s);return null!=e&&("object"!=typeof e||0!==Object.entries(e).length||e instanceof Date)||(e=""),e}return i},Ma={arrayObjectToCsv:(e,t,i,n,s)=>{const r=n&&n.params||{},o=r.propertyNames,a=r?.includeTitle??!0;let l=r.dataContextProperty;if(l||(l=n?.field?.split(".")[0]||""),!o||!Array.isArray(o)||!l)throw new Error('Formatters.arrayObjectToCsv requires you to pass an array of "propertyNames" (declared in "params") that you want to pull the data from.\n      For example, if we have an array of user objects that have the property of firstName & lastName then we need to pass in your column definition:: { params: { propertyNames: [\'firtName\'] }}.\n      Optionally, you can also pass the "dataContextProperty" if you wish to run this on another completely different field of the dataContext object.');if(s[l]&&Array.isArray(s[l])&&Array.isArray(s[l])&&s[l].length>0){const e=[];s[l].forEach((t=>{const i=[];o.forEach((e=>{i.push(t[e])})),e.push(i.join(" "))}));const t=e.join(", "),i=Z("span",{textContent:t});return a&&(i.title=t),i}return i},arrayToCsv:Ra,checkmarkMaterial:(e,t,i)=>{let n=!1;const s=Me(i);return s&&(i=+i),(!0===i||s&&+i>0||"string"==typeof i&&i.length>0&&"false"!==i.toLowerCase()&&"0"!==i)&&(n=!0),n?Z("i",{className:"mdi mdi-18px mdi-check checkmark-icon",ariaHidden:"true"}):""},complex:La,complexObject:La,collection:(e,t,i,n,s,r)=>{if(!(i&&n&&n.params&&n.params.collection&&n.params.collection.length))return i;const{params:o,params:{collection:a}}=n,l=o.customStructure?o.customStructure.label:"label",c=o.customStructure?o.customStructure.value:"value";return Array.isArray(i)?Ra(0,0,i.map((e=>K(a,(t=>t[c]===e))[l]))):K(a,(e=>e[c]===i))[l]||""},collectionEditor:(e,t,i,n,s,r)=>{if(!(i&&n&&n.editor&&n.editor.collection&&n.editor.collection.length))return i;const{editor:o,editor:{collection:a}}=n,l=o.customStructure?o.customStructure.label:"label",c=o.customStructure?o.customStructure.value:"value";return Array.isArray(i)?a.every((e=>"string"==typeof e))?Ra(0,0,i.map((e=>K(a,(t=>t===e))))):Ra(0,0,i.map((e=>K(a,(t=>t[c]===e))[l]))):K(a,(e=>e[c]===i))[l]||""},currency:(e,t,i,n,s,r)=>{const{currencyPrefix:o,currencySuffix:a,minDecimal:l,maxDecimal:c,numberPrefix:h,numberSuffix:d,decimalSeparator:u,thousandSeparator:p,wrapNegativeNumber:f}=oo(n,r,"decimal","cell");return Me(i)?`${h}${N(i,l,c,f,o,a,u,p)}${d}`:i},dateIso:lo(b.dateIso,"-"),dateTimeIso:lo(b.dateTimeIso,"-"),dateTimeShortIso:lo(b.dateTimeShortIso,"-"),dateTimeIsoAmPm:lo(b.dateTimeIsoAmPm,"-"),dateTimeIsoAM_PM:lo(b.dateTimeIsoAM_PM,"-"),dateEuro:lo(b.dateEuro,"/"),dateEuroShort:lo(b.dateEuroShort,"/"),dateTimeEuro:lo(b.dateTimeEuro,"/"),dateTimeEuroShort:lo(b.dateTimeEuroShort,"/"),dateTimeShortEuro:lo(b.dateTimeShortEuro,"/"),dateTimeEuroAmPm:lo(b.dateTimeEuroAmPm,"/"),dateTimeEuroAM_PM:lo(b.dateTimeEuroAM_PM,"/"),dateTimeEuroShortAmPm:lo(b.dateTimeEuroShortAmPm,"/"),dateTimeEuroShortAM_PM:lo(b.dateTimeEuroShortAM_PM,"/"),dateUs:lo(b.dateUs,"/"),dateTimeUs:lo(b.dateTimeUs,"/"),dateTimeShortUs:lo(b.dateTimeShortUs,"/"),dateTimeUsAmPm:lo(b.dateTimeUsAmPm,"/"),dateTimeUsAM_PM:lo(b.dateTimeUsAM_PM,"/"),dateTimeUsShort:lo(b.dateTimeUsShort,"/"),dateTimeUsShortAmPm:lo(b.dateTimeUsShortAmPm,"/"),dateTimeUsShortAM_PM:lo(b.dateTimeUsShortAM_PM,"/"),dateUsShort:lo(b.dateUsShort,"/"),dateUtc:lo(b.dateUtc,"-"),decimal:(e,t,i,n,s,r)=>{const{minDecimal:o,maxDecimal:a,numberPrefix:l,numberSuffix:c,decimalSeparator:h,thousandSeparator:d,wrapNegativeNumber:u}=oo(n,r,"decimal","cell");return Me(i)?N(i,o,a,u,l,c,h,d):i},dollar:(e,t,i,n,s,r)=>{const{minDecimal:o,maxDecimal:a,decimalSeparator:l,thousandSeparator:c,wrapNegativeNumber:h}=oo(n,r,"currency","cell");return Me(i)?N(i,o,a,h,"$","",l,c):i},dollarColored:(e,t,i,n,s,r)=>{const{minDecimal:o,maxDecimal:a,decimalSeparator:l,thousandSeparator:c,wrapNegativeNumber:h}=oo(n,r,"currency","cell");if(Me(i)){const e=i>=0?"green":"red",t=Z("span",{ariaHidden:"true",textContent:N(i,o,a,h,"$","",l,c)});return t.style.color=e,t}return i},dollarColoredBold:(e,t,i,n,s,r)=>{const{minDecimal:o,maxDecimal:a,decimalSeparator:l,thousandSeparator:c,wrapNegativeNumber:h}=oo(n,r,"currency","cell");if(Me(i)){const e=i>=0?"green":"red",t=Z("span",{ariaHidden:"true",textContent:N(i,o,a,h,"$","",l,c)});return t.style.color=e,t.style.fontWeight="bold",t}return i},hyperlink:(e,t,i,n,s,r)=>{const o=n&&n.params||{};let a=o.hyperlinkText?o.hyperlinkText:i;a=r.sanitizeHtmlString(a);let l=o.hyperlinkUrl?o.hyperlinkUrl:i;l=r.sanitizeHtmlString(l);const c=l.match(/^(http|ftp|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-.,@?^=%&amp;:/~+#]*[\w\-@?^=%&amp;/~+#])?/i);return c&&Array.isArray(c)&&c.length>0?Z("a",{href:c[0],textContent:a}):i},icon:(e,t,i,n)=>{const s=n?.params??{},r=s.iconCssClass||s.icon||s.formatterIcon;if(!r)throw new Error('[Slickgrid-Universal] When using `Formatters.icon`, you must provide the "iconCssClass" via the generic "params". (e.g.: `{ formatter: Formatters.icon, params: { iconCssClass: "mdi mdi-magnify" }}`');return Z("i",{className:r,ariaHidden:"true",title:s.title||null})},iconBoolean:(e,t,i,n)=>{const s=(n?.params||{}).cssClass;if(!s)throw new Error('[Slickgrid-Universal] When using `Formatters.iconBoolean`, you must provide You must provide the "cssClass", e.g.: { formatter: Formatters.iconBoolean, params: { cssClass: "mdi mdi-check" }}');let r=!1;const o=!isNaN(i);return(!0===i||o&&parseFloat(i)>0||!o&&"string"==typeof i&&"false"!==i.toLowerCase()&&"0"!==i)&&(r=!0),r?Z("i",{className:s,ariaHidden:"true"}):""},mask:(e,t,i,n,s,r)=>{const o=(n.params||{}).mask;if(!o)throw new Error('You must provide a "mask" via the generic "params" options (e.g.: { formatter: Formatters.mask, params: { mask: \'000-000\' }}');if(i){let e=0;const t=i.toString(),n=r.getOptions()||{},s=n?.preventDocumentFragmentUsage?document.createElement("span"):new DocumentFragment;return s.textContent=o.replace(/[09A]/gi,(()=>t[e++]||"")),s}return i},multiple:so,percent:(e,t,i,n,s,r)=>{const{minDecimal:o,maxDecimal:a,decimalSeparator:l,thousandSeparator:c,wrapNegativeNumber:h}=oo(n,r,"percent","cell");return Me(i)?N(100*i,o,a,h,"","%",l,c):i},percentComplete:(e,t,i,n,s,r)=>{const{minDecimal:o,maxDecimal:a,decimalSeparator:l,thousandSeparator:c,wrapNegativeNumber:h}=oo(n,r,"percent","cell");if(Me(i)){const e=i<50?"red":"green",t=N(i,o,a,h,"","%",l,c);return Z("span",{textContent:i>100?"100%":t,style:{color:e}})}return i},percentCompleteBar:(e,t,i)=>{if(!Me(i))return"";let n="",s=parseFloat(i);return s>100&&(s=100),n=s<30?"red":s<70?"silver":"green",Z("span",{className:"percent-complete-bar",title:`${s}%`,style:{background:n,width:`${s}%`}})},percentCompleteBarWithText:(e,t,i)=>{if(!Me(i))return"";let n="",s=parseFloat(i);return s>100&&(s=100),n=s<30?"red":s<70?"silver":"green",Z("div",{className:"percent-complete-bar-with-text",title:`${s}%`,textContent:`${s}%`,style:{background:n,width:`${s}%`}})},percentSymbol:(e,t,i,n,s,r)=>{const{minDecimal:o,maxDecimal:a,decimalSeparator:l,thousandSeparator:c,wrapNegativeNumber:h}=oo(n,r,"percent","cell");return Me(i)?N(i,o,a,h,"","%",l,c):i},progressBar:(e,t,i)=>{if(!Me(i))return"";let n="",s=parseFloat(i);s>100&&(s=100),n=s<30?"danger":s<70?"warning":"success";const r=Z("div",{className:"progress"});return r.appendChild(Z("div",{className:`progress-bar progress-bar-${n} bg-${n}`,role:"progressbar",ariaValueNow:String(s),ariaValueMin:"0",ariaValueMax:"100",textContent:`${s}%`,style:{minWidth:"2em",width:`${s}%`}})),r},translate:(e,t,i,n,s,r)=>{const o=(r?.getOptions()??{}).translater||n&&n.params&&n.params.translater;if(!o||"function"!=typeof o.translate)throw new Error('"Formatters.translate" requires the Translate Service to be provided as a Grid Options "translater" (or "i18n" depending on which framework you use).\n    For example: this.gridOptions = { enableTranslate: true, translater: this.translateService }');return null!=i&&"string"!=typeof i&&(i+=""),i?o.translate(i):""},translateBoolean:(e,t,i,n,s,r)=>{const o=(r?.getOptions()??{}).translater||n&&n.params&&n.params.translater;if(!o||"function"!=typeof o.translate)throw new Error('"Formatters.translateBoolean" requires the Translate Service to be provided as a Grid Options "translater" (or "i18n" depending on which framework you use).\n    For example: this.gridOptions = { enableTranslate: true, translater: this.translateService }');return null!=i&&"string"!=typeof i&&(i+=""),i?o.translate(i.toUpperCase()):""},tree:(e,t,i,n,s,r)=>{const o=r.getOptions(),a=o?.treeDataOptions,l=a?.indentMarginLeft??15,c=a?.collapsedPropName??m.treeDataProperties.COLLAPSED_PROP,h=a?.hasChildrenPropName??m.treeDataProperties.HAS_CHILDREN_PROP,d=a?.levelPropName??m.treeDataProperties.TREE_LEVEL_PROP;let u=i;if(u=F(n,s,i),null==u||void 0===s)return"";if(!s.hasOwnProperty(d))throw new Error('[Slickgrid-Universal] You must provide valid "treeDataOptions" in your Grid Options, however it seems that we could not find any tree level info on the current item datacontext row.');const p=s?.[d]??0,f=document.createElement("span");f.style.display="inline-block",f.style.width=l*p+"px";const g=`slick-tree-level-${p}`;let v="";s[h]&&(v=s?.[c]?"collapsed":"expanded"),a?.titleFormatter&&(u=co(a.titleFormatter,e,t,n,s,r));const _=Z("div",{className:`slick-group-toggle ${v}`.trim(),ariaExpanded:String("expanded"===v)}),b=Z("span",{className:"slick-tree-title"});r.applyHtmlCode(b,u),b.setAttribute("level",p);const y=o?.preventDocumentFragmentUsage?document.createElement("span"):new DocumentFragment;return y.appendChild(f),y.appendChild(_),y.appendChild(b),{addClasses:g,html:y}},treeParseTotals:(e,t,i,n,s,r)=>{const o=r.getOptions(),a=o?.treeDataOptions?.hasChildrenPropName??m.treeDataProperties.HAS_CHILDREN_PROP,{groupTotalsFormatter:l,treeTotalsFormatter:c,params:h}=n;if(!l&&!c)throw new Error('[Slickgrid-Universal] When using Formatters.treeParseTotals, you must provide a total formatter via "groupTotalsFormatter" or "treeTotalsFormatter".');if(s[a]&&s?.__treeTotals&&(l||c))return(c??l)(s?.__treeTotals,n,r);if(h.formatters){let o=i;for(const l of h.formatters)s[a]||s?.__treeTotals||"function"!=typeof l||(o=l(e,t,o,n,s,r)||i);return o}return i},treeExport:(e,t,i,n,s,r)=>{const o=r.getOptions(),a=o?.treeDataOptions,l=a?.collapsedPropName??m.treeDataProperties.COLLAPSED_PROP,c=a?.hasChildrenPropName??m.treeDataProperties.HAS_CHILDREN_PROP,h=a?.levelPropName??m.treeDataProperties.TREE_LEVEL_PROP,d=a?.exportIndentMarginLeft??5,u=a?.exportIndentationLeadingChar??".",p=a?.exportIndentationLeadingSpaceCount??3,f=o?.excelExportOptions?.groupCollapsedSymbol??"â®",g=o?.excelExportOptions?.groupExpandedSymbol??"â®";let v=i;if(v=F(n,s,i),null==v||void 0===s)return"";if(!s.hasOwnProperty(h))throw new Error('[Slickgrid-Universal] You must provide valid "treeDataOptions" in your Grid Options, however it seems that we could not find any tree level info on the current item datacontext row.');const _=s?.[h]??0;let b="",y=0;s[c]?(b=s?.[l]?f:g,y=0===_?0:d*_):y=d*(0===_?0:_+1);const C=Se(y);return a?.titleFormatter&&(v=co(a.titleFormatter,e,t,n,s,r)),v=`${0===_&&b?"":0===_?`${u}${Se(p)}`:u}${C}${b} ${v}`,Qe(v)}},Pa={avgTotals:(e,t,i)=>{const n=t.field??"";let s=e.avg?.[n];const r=t?.params;let o=r?.groupFormatterPrefix||"";const a=r?.groupFormatterSuffix||"",{minDecimal:l,maxDecimal:c,decimalSeparator:h,thousandSeparator:d,wrapNegativeNumber:u}=oo(t,i,"regular","group");if(Me(s)){if(s<0){if(s=Math.abs(s),u)return isNaN(l)&&isNaN(c)?`${o}(${G(Math.round(s),d)})${a}`:`${o}(${P(s,l,c,h,d)})${a}`;o+="-"}return isNaN(l)&&isNaN(c)?`${o}${G(Math.round(s),d)}${a}`:`${o}${P(s,l,c,h,d)}${a}`}return""},avgTotalsCurrency:(e,t,i)=>{const n=t.field??"",s=e.avg?.[n],r=t?.params,o=r?.groupFormatterPrefix||"",a=r?.groupFormatterSuffix||"",l=r?.groupFormatterCurrencyPrefix||"",c=r?.groupFormatterCurrencySuffix||"",{minDecimal:h,maxDecimal:d,decimalSeparator:u,thousandSeparator:p,wrapNegativeNumber:f}=oo(t,i,"currency","group");return Me(s)?`${o}${N(s,h,d,f,l,c,u,p)}${a}`:""},avgTotalsDollar:(e,t,i)=>{const n=t.field??"",s=e.avg?.[n],r=t?.params,o=r?.groupFormatterPrefix||"",a=r?.groupFormatterSuffix||"",{minDecimal:l,maxDecimal:c,decimalSeparator:h,thousandSeparator:d,wrapNegativeNumber:u}=oo(t,i,"currency","group");return Me(s)?`${o}${N(s,l,c,u,"$","",h,d)}${a}`:""},avgTotalsPercentage:(e,t,i)=>{const n=t.field??"";let s=e.avg?.[n];const r=t?.params;let o=r?.groupFormatterPrefix||"";const a=r?.groupFormatterSuffix||"",{minDecimal:l,maxDecimal:c,decimalSeparator:h,thousandSeparator:d,wrapNegativeNumber:u}=oo(t,i,"percent","group");if(Me(s)){if(s<0){if(s=Math.abs(s),u)return isNaN(l)&&isNaN(c)?`${o}(${G(Math.round(s),d)}%)${a}`:`${o}(${P(s,l,c,h,d)}%)${a}`;o+="-"}return isNaN(l)&&isNaN(c)?`${o}${G(Math.round(s),d)}%${a}`:`${o}${P(s,l,c,h,d)}%${a}`}return""},maxTotals:(e,t,i)=>{const n=t.field??"",s=e.max?.[n],r=t?.params,o=r?.groupFormatterPrefix||"",a=r?.groupFormatterSuffix||"",{minDecimal:l,maxDecimal:c,decimalSeparator:h,thousandSeparator:d,wrapNegativeNumber:u}=oo(t,i,"regular","group");return Me(s)?`${o}${N(s,l,c,u,"","",h,d)}${a}`:""},minTotals:(e,t,i)=>{const n=t.field??"",s=e.min?.[n],r=t?.params,o=r?.groupFormatterPrefix||"",a=r?.groupFormatterSuffix||"",{minDecimal:l,maxDecimal:c,decimalSeparator:h,thousandSeparator:d,wrapNegativeNumber:u}=oo(t,i,"regular","group");return Me(s)?`${o}${N(s,l,c,u,"","",h,d)}${a}`:""},sumTotals:(e,t,i)=>{const n=t.field??"",s=e.sum?.[n],r=t?.params,o=r?.groupFormatterPrefix||"",a=r?.groupFormatterSuffix||"",{minDecimal:l,maxDecimal:c,decimalSeparator:h,thousandSeparator:d,wrapNegativeNumber:u}=oo(t,i,"regular","group");return Me(s)?`${o}${N(s,l,c,u,"","",h,d)}${a}`:""},sumTotalsBold:(e,t,i)=>{const n=t.field??"",s=e.sum?.[n],r=t?.params,o=r?.groupFormatterPrefix||"",a=r?.groupFormatterSuffix||"",{minDecimal:l,maxDecimal:c,decimalSeparator:h,thousandSeparator:d,wrapNegativeNumber:u}=oo(t,i,"regular","group");return Me(s)?Z("span",{style:{fontWeight:"bold"},textContent:`${o}${N(s,l,c,u,"","",h,d)}${a}`}):""},sumTotalsColored:(e,t,i)=>{const n=t.field??"",s=e.sum?.[n],r=t?.params,o=r?.groupFormatterPrefix||"",a=r?.groupFormatterSuffix||"",{minDecimal:l,maxDecimal:c,decimalSeparator:h,thousandSeparator:d,wrapNegativeNumber:u}=oo(t,i,"regular","group");return Me(s)?Z("span",{style:{color:s>=0?"green":"red"},textContent:`${o}${N(s,l,c,u,"","",h,d)}${a}`}):""},sumTotalsCurrency:(e,t,i)=>{const n=t.field??"",s=e.sum?.[n],r=t?.params,o=r?.groupFormatterPrefix||"",a=r?.groupFormatterSuffix||"",l=r?.groupFormatterCurrencyPrefix||"",c=r?.groupFormatterCurrencySuffix||"",{minDecimal:h,maxDecimal:d,decimalSeparator:u,thousandSeparator:p,wrapNegativeNumber:f}=oo(t,i,"currency","group");return Me(s)?`${o}${N(s,h,d,f,l,c,u,p)}${a}`:""},sumTotalsCurrencyColored:(e,t,i)=>{const n=t.field??"",s=e.sum?.[n],r=t?.params,o=r?.groupFormatterPrefix||"",a=r?.groupFormatterSuffix||"",l=r?.groupFormatterCurrencyPrefix||"",c=r?.groupFormatterCurrencySuffix||"",{minDecimal:h,maxDecimal:d,decimalSeparator:u,thousandSeparator:p,wrapNegativeNumber:f}=oo(t,i,"currency","group");return Me(s)?Z("span",{style:{color:s>=0?"green":"red"},textContent:`${o}${N(s,h,d,f,l,c,u,p)}${a}`}):""},sumTotalsDollar:(e,t,i)=>{const n=t.field??"",s=e.sum?.[n],r=t?.params,o=r?.groupFormatterPrefix||"",a=r?.groupFormatterSuffix||"",{minDecimal:l,maxDecimal:c,decimalSeparator:h,thousandSeparator:d,wrapNegativeNumber:u}=oo(t,i,"currency","group");return Me(s)?`${o}${N(s,l,c,u,"$","",h,d)}${a}`:""},sumTotalsDollarBold:(e,t,i)=>{const n=t.field??"",s=e.sum?.[n],r=t?.params,o=r?.groupFormatterPrefix||"",a=r?.groupFormatterSuffix||"",{minDecimal:l,maxDecimal:c,decimalSeparator:h,thousandSeparator:d,wrapNegativeNumber:u}=oo(t,i,"currency","group");return Me(s)?Z("span",{style:{fontWeight:"bold"},textContent:`${o}${N(s,l,c,u,"$","",h,d)}${a}`}):""},sumTotalsDollarColored:(e,t,i)=>{const n=t.field??"",s=e.sum?.[n],r=t?.params,o=r?.groupFormatterPrefix||"",a=r?.groupFormatterSuffix||"",{minDecimal:l,maxDecimal:c,decimalSeparator:h,thousandSeparator:d,wrapNegativeNumber:u}=oo(t,i,"currency","group");return Me(s)?Z("span",{style:{color:s>=0?"green":"red"},textContent:`${o}${N(s,l,c,u,"$","",h,d)}${a}`}):""},sumTotalsDollarColoredBold:(e,t,i)=>{const n=t.field??"",s=e.sum?.[n],r=t?.params,o=r?.groupFormatterPrefix||"",a=r?.groupFormatterSuffix||"",{minDecimal:l,maxDecimal:c,decimalSeparator:h,thousandSeparator:d,wrapNegativeNumber:u}=oo(t,i,"currency","group");return Me(s)?Z("span",{style:{color:s>=0?"green":"red",fontWeight:"bold"},textContent:`${o}${N(s,l,c,u,"$","",h,d)}${a}`}):""}};class Na{constructor(){this.options=Ea}}const Fa={...e,...t,...n,...r,...s,deepAssign:Te};class Ha{constructor(e){this._value=null,this._boundedEventWithListeners=[],this._elementBindings=[],this._binding=e,this._property=e.property||"",this._elementBindings=[],e.property&&e.variable&&(e.variable.hasOwnProperty(e.property)||e.property in e.variable)?this._value=e.variable[e.property]:this._value=e.variable,"object"==typeof e.variable&&Object.defineProperty(e.variable,e.property,{get:this.valueGetter.bind(this),set:this.valueSetter.bind(this)})}get boundedEventWithListeners(){return this._boundedEventWithListeners}get elementBindings(){return this._elementBindings}get property(){return this._property}dispose(){this.unbindAll(),this._boundedEventWithListeners=[],this._elementBindings=[]}valueGetter(){return this._value}valueSetter(e){if(this._value=e,Array.isArray(this._elementBindings))for(const t of this._elementBindings)t?.element&&t?.attribute&&(t.element[t.attribute]=e)}bind(e,t,i,n){return e&&e.forEach?e.forEach((e=>this.bindSingleElement(e,t,i,n))):e&&this.bindSingleElement(e,t,i,n),this}unbind(e,t,i,n,s){if(e){e.removeEventListener(t,i,n);const r=this._boundedEventWithListeners.findIndex((e=>e.uid===s));r>=0&&this._boundedEventWithListeners.splice(r,1)}}unbindAll(){let e=this._boundedEventWithListeners.pop();for(;e;){const{element:t,eventName:i,listener:n,uid:s}=e;this.unbind(t,i,n,void 0,s),e=this._boundedEventWithListeners.pop()}this._boundedEventWithListeners=[]}bindSingleElement(e,t,i,n){const s={element:e,attribute:t};if(e){if(i){const r=()=>{let i=e[t];if(this.hasData(i)&&"number"===e?.type&&(i=+i),this.valueSetter(i),(this._binding.variable.hasOwnProperty(this._binding.property)||this._binding.property in this._binding.variable)&&(this._binding.variable[this._binding.property]=this.valueGetter()),"function"==typeof n)return n(this.valueGetter())};s.event=i,s.listener=r,e.addEventListener(i,r),this._boundedEventWithListeners.push({element:e,eventName:i,listener:r,uid:this.generateUuidV4()})}this._elementBindings.push(s),e[t]=this._value}}generateUuidV4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}hasData(e){return null!=e&&""!==e}}class Ba{constructor(){this._isPreviouslyShown=!1,this._warningLeftElement=null,this._warningRightElement=null}get gridOptions(){return this._grid?.getOptions()??{}}init(e,t){this._grid=e,this._translaterService=t.get("TranslaterService")}dispose(){this._warningLeftElement?.remove(),this._warningRightElement?.remove(),this._warningLeftElement=null,this._warningRightElement=null}showEmptyDataMessage(e=!0,t){if(!this._grid||!this.gridOptions||this._isPreviouslyShown===e)return!1;this._isPreviouslyShown=e;const i=this._grid.getUID(),n={message:"No data to display.",...this.gridOptions.emptyDataWarning,...t},s=n?.className??"slick-empty-data-warning";this._warningLeftElement=document.querySelector(`.${i} .${s}`);const r=document.querySelector(`.${i} .grid-canvas.grid-canvas-left`),o=document.querySelector(`.${i} .grid-canvas.grid-canvas-right`),a=n.leftViewportMarginLeft??0,l=n.rightViewportMarginLeft??0,c=n.frozenLeftViewportMarginLeft??0,h=n.frozenRightViewportMarginLeft??0,d=void 0!==this.gridOptions?.frozenColumn&&this.gridOptions.frozenColumn>=0,u="string"==typeof a?a:`${a}px`,p="string"==typeof l?l:`${l}px`;if(this.gridOptions.autoHeight){const t=document.querySelector(`.${i} .slick-pane.slick-pane-top.slick-pane-left`);if(t&&t.style&&r&&r.style){const i=parseInt(t.style.height,10)||0,n=this.gridOptions?.rowHeight??0,s=this.gridOptions.enableFiltering?this.gridOptions?.headerRowHeight??0:0,o=this.gridOptions.createPreHeaderPanel?this.gridOptions?.preHeaderPanelHeight??0:0;if(e){let e=null!==i&&i<100?i:100;e+=s+o,t.style.minHeight=`${e}px`,r.style.minHeight=`${n}px`}}}let f=n.message;if(this.gridOptions.enableTranslate&&this._translaterService&&n?.messageKey&&(f=this._translaterService.translate(n.messageKey)),!this._warningLeftElement&&r&&o&&(this._warningLeftElement=document.createElement("div"),this._warningLeftElement.classList.add(...Q(s)),this._warningLeftElement.classList.add("left"),this._grid.applyHtmlCode(this._warningLeftElement,f),this._warningRightElement=this._warningLeftElement.cloneNode(!0),this._warningRightElement.classList.add("right"),o.appendChild(this._warningRightElement),r.appendChild(this._warningLeftElement)),this._warningLeftElement){let t=e?"flex":"none";d&&e&&(t=n.hideFrozenLeftWarning?"none":"flex"),this._warningLeftElement.style.display=t;const i="string"==typeof c?c:`${c}px`;this._warningLeftElement.style.marginLeft=d?i:u}if(this._warningRightElement){let t=e?"flex":"none";d&&e&&(t=n.hideFrozenRightWarning?"none":"flex"),this._warningRightElement.style.display=t;const i="string"==typeof h?h:`${h}px`;this._warningRightElement.style.marginLeft=d?i:p}return e}}class za{constructor(){this._observers=[],this._querySelectorPrefix=""}get querySelectorPrefix(){return this._querySelectorPrefix||""}set querySelectorPrefix(e){this._querySelectorPrefix=e}get observers(){return this._observers}dispose(){let e=this._observers.pop();for(;e;)e.dispose(),e=this._observers.pop();this._observers=[]}addElementBinding(e,t,i,n,s,r){const o=document.querySelectorAll(`${this.querySelectorPrefix}${i}`);let a=this._observers.find((t=>t.property===e));a||(a=new Ha({variable:e,property:t})),Array.isArray(s)?s.forEach((e=>a?.bind(o,n,e,r))):a?.bind(o,n,s,r),this._observers.push(a)}bindEventHandler(e,t,i,n){document.querySelectorAll(`${this.querySelectorPrefix}${e}`).forEach((e=>{e?.addEventListener&&e.addEventListener(t,i,n)}))}setElementAttributeValue(e,t,i){document.querySelectorAll(`${this.querySelectorPrefix}${e}`).forEach((e=>{e.textContent="",e&&t in e&&(e[t]=i)}))}}class Va{constructor(){this._enableTranslate=!1,this._subscriptions=[],this.currentPagination={},this.firstButtonClasses="",this.lastButtonClasses="",this.prevButtonClasses="",this.nextButtonClasses="",this.textItemsPerPage="items per page",this.textItems="items",this.textOf="of",this.textPage="Page",this._bindingHelper=new za,this._bindingEventService=new Ft}get availablePageSizes(){return this._paginationService.availablePageSizes||[]}get dataFrom(){return this._paginationService.dataFrom}get dataTo(){return this._paginationService.dataTo}get itemsPerPage(){return this._paginationService.itemsPerPage}set itemsPerPage(e){this._paginationService.changeItemPerPage(e)}get pageCount(){return this._paginationService.pageCount}get pageNumber(){return this._paginationService.pageNumber}get gridOptions(){return this._grid?.getOptions()??{}}get gridUid(){return this._grid?.getUID()||""}get locales(){return this.gridOptions?.locales??m.locales}get totalItems(){return this._paginationService.totalItems}get isLeftPaginationDisabled(){return 1===this.pageNumber||0===this.totalItems}get isRightPaginationDisabled(){return this.pageNumber===this.pageCount||0===this.totalItems}init(e,t,i,n){if(this._grid=e,this._pubSubService=i,this._translaterService=n,this._paginationService=t,this.currentPagination=t.getFullPagination(),this._bindingHelper.querySelectorPrefix=this.gridUid?`.${this.gridUid} `:"",this._enableTranslate=this.gridOptions?.enableTranslate??!1,this._enableTranslate&&(!this._translaterService||!this._translaterService.translate))throw new Error('[Slickgrid-Universal] requires a Translate Service to be installed and configured when the grid option "enableTranslate" is enabled.');if(this.translatePaginationTexts(),this._enableTranslate&&this._pubSubService?.subscribe){const e=this._translaterService?.eventName??"onLanguageChange";this._subscriptions.push(this._pubSubService.subscribe(e,(()=>this.translatePaginationTexts())))}this._subscriptions.push(this._pubSubService.subscribe("onPaginationRefreshed",(e=>{Object.keys(e).forEach((t=>this.currentPagination[t]=e[t])),this.updatePageButtonsUsability(),this._spanInfoFromToElm?.style&&(this._spanInfoFromToElm.style.display=0===this.currentPagination.totalItems?"none":"")})),this._pubSubService.subscribe("onPaginationSetCursorBased",(()=>{this.disposeDom(),this.renderPagination(this._gridContainerElm)})))}dispose(){this._pubSubService.unsubscribeAll(this._subscriptions),this.disposeDom()}disposeDom(){this._bindingEventService.unbindAll(),this._bindingHelper.dispose(),this._paginationElement.remove()}renderPagination(e){this._gridContainerElm=e;const t=this.createPaginationContainer(),i=Z("div",{className:"slick-pagination-nav"}),n=Z("nav",{ariaLabel:"Page navigation"}),s=Z("ul",{className:"pagination"});this._seekFirstElm=Z("li",{className:"page-item seek-first"},s),this._seekFirstElm.appendChild(Z("a",{className:"page-link icon-seek-first",ariaLabel:"First Page",role:"button"})),this._seekPrevElm=Z("li",{className:"page-item seek-prev"},s),this._seekPrevElm.appendChild(Z("a",{className:"page-link icon-seek-prev",ariaLabel:"Previous Page",role:"button"})),n.appendChild(s);const r=this.createPageNumberSection(),o=Z("nav",{ariaLabel:"Page navigation"}),a=Z("ul",{className:"pagination"});this._seekNextElm=Z("li",{className:"page-item seek-next"},a),this._seekNextElm.appendChild(Z("a",{className:"page-link icon-seek-next",ariaLabel:"Next Page",role:"button"})),this._seekEndElm=Z("li",{className:"page-item seek-end"},a),this._seekEndElm.appendChild(Z("a",{className:"page-link icon-seek-end",ariaLabel:"Last Page",role:"button"})),o.appendChild(a),t.appendChild(i),i.appendChild(n),i.appendChild(r),i.appendChild(o);const l=this.createPaginationSettingsSection();t.appendChild(i),t.appendChild(l),this._paginationElement.appendChild(t),e?.appendChild&&this._paginationElement&&e.appendChild(this._paginationElement),this.renderPageSizes(),this.addBindings(),this.addEventListeners(),this.updatePageButtonsUsability()}renderPageSizes(){if(this._itemPerPageElm&&Array.isArray(this.availablePageSizes))for(const e of this.availablePageSizes)this._itemPerPageElm.appendChild(Z("option",{value:`${e}`,text:`${e}`}))}addBindings(){this._bindingHelper.addElementBinding(this,"firstButtonClasses","li.page-item.seek-first","className"),this._bindingHelper.addElementBinding(this,"prevButtonClasses","li.page-item.seek-prev","className"),this._bindingHelper.addElementBinding(this,"lastButtonClasses","li.page-item.seek-end","className"),this._bindingHelper.addElementBinding(this,"nextButtonClasses","li.page-item.seek-next","className"),this._bindingHelper.addElementBinding(this.currentPagination,"dataFrom","span.item-from","textContent"),this._bindingHelper.addElementBinding(this.currentPagination,"dataTo","span.item-to","textContent"),this._bindingHelper.addElementBinding(this.currentPagination,"totalItems","span.total-items","textContent"),this._bindingHelper.addElementBinding(this.currentPagination,"pageCount","span.page-count","textContent"),this._bindingHelper.addElementBinding(this.currentPagination,"pageSize","select.items-per-page","value"),this._paginationService.isCursorBased?this._bindingHelper.addElementBinding(this.currentPagination,"pageNumber","span.page-number","textContent"):this._bindingHelper.addElementBinding(this.currentPagination,"pageNumber","input.page-number","value","change",this.changeToCurrentPage.bind(this)),this._bindingHelper.addElementBinding(this,"textItems","span.text-items","textContent"),this._bindingHelper.addElementBinding(this,"textItemsPerPage","span.text-item-per-page","textContent"),this._bindingHelper.addElementBinding(this,"textOf","span.text-of","textContent"),this._bindingHelper.addElementBinding(this,"textPage","span.text-page","textContent")}addEventListeners(){this._bindingEventService.bind(this._seekFirstElm,"click",this.changeToFirstPage.bind(this)),this._bindingEventService.bind(this._seekEndElm,"click",this.changeToLastPage.bind(this)),this._bindingEventService.bind(this._seekNextElm,"click",this.changeToNextPage.bind(this)),this._bindingEventService.bind(this._seekPrevElm,"click",this.changeToPreviousPage.bind(this)),this._bindingEventService.bind(this._itemPerPageElm,"change",this.updateItemsPerPage.bind(this))}changeToFirstPage(e){this.isLeftPaginationDisabled||this._paginationService.goToFirstPage(e)}changeToLastPage(e){this.isRightPaginationDisabled||this._paginationService.goToLastPage(e)}changeToNextPage(e){this.isRightPaginationDisabled||this._paginationService.goToNextPage(e)}changeToPreviousPage(e){this.isLeftPaginationDisabled||this._paginationService.goToPreviousPage(e)}changeToCurrentPage(e){this._paginationService.goToPageNumber(+e)}updateItemsPerPage(e){this.itemsPerPage=+(e?.target?.value??0)}translatePaginationTexts(){if(this._enableTranslate&&this._translaterService?.translate){const e=B(this.gridOptions);this.textItemsPerPage=this._translaterService.translate(`${e}ITEMS_PER_PAGE`),this.textItems=this._translaterService.translate(`${e}ITEMS`),this.textOf=this._translaterService.translate(`${e}OF`),this.textPage=this._translaterService.translate(`${e}PAGE`)}else this.locales&&(this.textItemsPerPage=this.locales.TEXT_ITEMS_PER_PAGE||"TEXT_ITEMS_PER_PAGE",this.textItems=this.locales.TEXT_ITEMS||"TEXT_ITEMS",this.textOf=this.locales.TEXT_OF||"TEXT_OF",this.textPage=this.locales.TEXT_PAGE||"TEXT_PAGE")}createPaginationContainer(){const e=Z("div",{id:"pager",className:`slick-pagination-container ${this.gridUid} pager`,style:{width:"100%"}}),t=Z("div",{className:"slick-pagination"});return e.appendChild(t),this._paginationElement=e,t}createPageNumberSection(){const e=Z("div",{className:"slick-page-number"});return Z("span",{className:"text-page",textContent:"Page"},e),e.appendChild(document.createTextNode(" ")),this._paginationService.isCursorBased?Z("span",{className:"page-number",ariaLabel:"Page Number",dataset:{test:"page-number-label"},textContent:"1"},e):Z("input",{type:"text",className:"form-control page-number",ariaLabel:"Page Number",value:"1",size:1,dataset:{test:"page-number-input"}},e),e.appendChild(document.createTextNode(" ")),Z("span",{className:"text-of",textContent:"of"},e),e.appendChild(document.createTextNode(" ")),Z("span",{className:"page-count",dataset:{test:"page-count"}},e),e}createPaginationSettingsSection(){const e=Z("span",{className:"slick-pagination-settings"});this._itemPerPageElm=Z("select",{id:"items-per-page-label",ariaLabel:"Items per Page",className:"items-per-page"},e),e.appendChild(document.createTextNode(" ")),Z("span",{className:"text-item-per-page",textContent:"items per page"},e),e.appendChild(document.createTextNode(", "));const t=Z("span",{className:"slick-pagination-count"},e);this._spanInfoFromToElm=Z("span",{className:"page-info-from-to"},t),Z("span",{className:"item-from",ariaLabel:"Page Item From",dataset:{test:"item-from"}},this._spanInfoFromToElm),this._spanInfoFromToElm.appendChild(document.createTextNode("-")),Z("span",{className:"item-to",ariaLabel:"Page Item To",dataset:{test:"item-to"}},this._spanInfoFromToElm),this._spanInfoFromToElm.appendChild(document.createTextNode(" ")),Z("span",{className:"text-of",textContent:"of"},this._spanInfoFromToElm),this._spanInfoFromToElm.appendChild(document.createTextNode(" "));const i=Z("span",{className:"page-info-total-items"},t);return Z("span",{className:"total-items",ariaLabel:"Total Items",dataset:{test:"total-items"}},i),i.appendChild(document.createTextNode(" ")),Z("span",{className:"text-items",textContent:"items"},i),i.appendChild(document.createTextNode(" ")),e}updatePageButtonsUsability(){this.firstButtonClasses=this.isLeftPaginationDisabled?"page-item seek-first disabled":"page-item seek-first",this.prevButtonClasses=this.isLeftPaginationDisabled?"page-item seek-prev disabled":"page-item seek-prev",this.lastButtonClasses=this.isRightPaginationDisabled?"page-item seek-end disabled":"page-item seek-end",this.nextButtonClasses=this.isRightPaginationDisabled?"page-item seek-next disabled":"page-item seek-next"}}class Wa{get eventHandler(){return this._eventHandler}get gridUid(){return this.grid?.getUID()??""}get gridUidSelector(){return this.gridUid?`.${this.gridUid}`:""}get gridOptions(){return this.grid?.getOptions()??{}}get locales(){return this.gridOptions?.locales??m.locales}set metrics(e){this.renderMetrics(e)}get leftFooterText(){return document.querySelector(`.slick-custom-footer${this.gridUidSelector} .left-footer`)?.textContent??""}set leftFooterText(e){this.renderLeftFooterText(e)}get rightFooterText(){return document.querySelector(`.slick-custom-footer${this.gridUidSelector} .right-footer`)?.textContent??""}set rightFooterText(e){this.renderRightFooterText(e)}constructor(e,t,i,n){if(this.grid=e,this.customFooterOptions=t,this.pubSubService=i,this.translaterService=n,this._enableTranslate=!1,this._isLeftFooterOriginallyEmpty=!0,this._isLeftFooterDisplayingSelectionRowCount=!1,this._isRightFooterOriginallyEmpty=!0,this._selectedRowCount=0,this._subscriptions=[],this._bindingHelper=new za,this._bindingHelper.querySelectorPrefix=`.${this.gridUid} `,this._eventHandler=new vn,this._enableTranslate=this.gridOptions?.enableTranslate??!1,this._isLeftFooterOriginallyEmpty=!this.gridOptions.customFooterOptions?.leftFooterText,this._isRightFooterOriginallyEmpty=!this.gridOptions.customFooterOptions?.rightFooterText,this.registerOnSelectedRowsChangedWhenEnabled(t),this._enableTranslate&&(!this.translaterService||!this.translaterService.translate))throw new Error('[Slickgrid-Universal] requires a Translate Service to be installed and configured when the grid option "enableTranslate" is enabled.');if(this.translateCustomFooterTexts(),this._enableTranslate&&this.pubSubService?.subscribe){const e=this.translaterService?.eventName??"onLanguageChange";this._subscriptions.push(this.pubSubService.subscribe(e,(()=>this.translateCustomFooterTexts())))}}dispose(){this._eventHandler.unsubscribeAll(),this.pubSubService.unsubscribeAll(this._subscriptions),this._bindingHelper.dispose(),this._footerElement?.remove()}renderFooter(e){this.translateCustomFooterTexts(),this.createFooterContainer(e)}renderMetrics(e){const t=e?.endTime?Tt(e.endTime,this.customFooterOptions.dateFormat,"en-US"):"";this._bindingHelper.setElementAttributeValue("span.last-update-timestamp","textContent",t),this._bindingHelper.setElementAttributeValue("span.item-count","textContent",e.itemCount),this._bindingHelper.setElementAttributeValue("span.total-count","textContent",e.totalItemCount),this.customFooterOptions.metricTexts?.lastUpdate&&this._bindingHelper.addElementBinding(this.customFooterOptions.metricTexts,"lastUpdate","span.text-last-update","textContent"),this._bindingHelper.addElementBinding(this.customFooterOptions.metricTexts,"items","span.text-items","textContent"),this._bindingHelper.addElementBinding(this.customFooterOptions.metricTexts,"of","span.text-of","textContent")}renderLeftFooterText(e){this._bindingHelper.setElementAttributeValue("div.left-footer","textContent",e)}renderRightFooterText(e){this._bindingHelper.setElementAttributeValue("div.right-footer","textContent",e)}translateCustomFooterTexts(){if(this.gridOptions.enableTranslate&&this.translaterService?.translate){this.customFooterOptions.metricTexts=this.customFooterOptions.metricTexts||{};for(const e of Object.keys(this.customFooterOptions.metricTexts))if(e.lastIndexOf("Key")>0){const t=e.substring(0,e.lastIndexOf("Key"));this.customFooterOptions.metricTexts[t]=this.translaterService.translate(this.customFooterOptions.metricTexts[e]||" ")}this._isLeftFooterDisplayingSelectionRowCount&&(this.leftFooterText=`${this._selectedRowCount} ${this.customFooterOptions.metricTexts.itemsSelected}`)}else this.locales&&(this.customFooterOptions.metricTexts=this.customFooterOptions.metricTexts||{},this.customFooterOptions.metricTexts.lastUpdate=this.customFooterOptions.metricTexts.lastUpdate||this.locales?.TEXT_LAST_UPDATE||"TEXT_LAST_UPDATE",this.customFooterOptions.metricTexts.items=this.customFooterOptions.metricTexts.items||this.locales?.TEXT_ITEMS||"TEXT_ITEMS",this.customFooterOptions.metricTexts.itemsSelected=this.customFooterOptions.metricTexts.itemsSelected||this.locales?.TEXT_ITEMS_SELECTED||"TEXT_ITEMS_SELECTED",this.customFooterOptions.metricTexts.of=this.customFooterOptions.metricTexts.of||this.locales?.TEXT_OF||"TEXT_OF")}createFooterContainer(e){const t=Z("div",{className:`slick-custom-footer ${this.gridUid}`,style:{width:"100%",height:`${this.customFooterOptions.footerHeight||20}px`}}),i=Z("div",{className:`left-footer ${this.customFooterOptions.leftContainerClass}`});this.grid.applyHtmlCode(i,this.customFooterOptions.leftFooterText),t.appendChild(i),t.appendChild(this.createFooterRightContainer()),this._footerElement=t,e?.appendChild&&this._footerElement&&e.appendChild(this._footerElement)}createFooterRightContainer(){const e=Z("div",{className:`right-footer ${this.customFooterOptions.rightContainerClass||""}`});if(this._isRightFooterOriginallyEmpty){if(!this.customFooterOptions.hideMetrics){e.classList.add("metrics");const t=Z("span",{className:"timestamp"},e);if(!this.customFooterOptions.hideLastUpdateTimestamp){const e=this.createFooterLastUpdate();e&&t.appendChild(e)}e.appendChild(Z("span",{className:"item-count",textContent:`${this.metrics?.itemCount??"0"}`})),this.customFooterOptions.hideTotalItemCount||(e.appendChild(document.createTextNode("\r\n")),e.appendChild(Z("span",{className:"text-of",textContent:` ${this.customFooterOptions.metricTexts?.of??"of"} `})),e.appendChild(document.createTextNode("\r\n")),e.appendChild(Z("span",{className:"total-count",textContent:`${this.metrics?.totalItemCount??"0"}`}))),e.appendChild(document.createTextNode("\r\n")),e.appendChild(Z("span",{className:"text-items",textContent:` ${this.customFooterOptions.metricTexts?.items??"items"} `}))}}else this.grid.applyHtmlCode(e,this.customFooterOptions.rightFooterText);return e}createFooterLastUpdate(){const e=this.customFooterOptions?.metricTexts?.lastUpdate??"Last Update",t=this.metrics?.endTime?Tt(this.metrics?.endTime,this.customFooterOptions.dateFormat,"en-US"):"",i=Z("span");return i.appendChild(Z("span",{className:"text-last-update",textContent:e})),i.appendChild(document.createTextNode("\r\n")),i.appendChild(Z("span",{className:"last-update-timestamp",textContent:t})),i.appendChild(Z("span",{className:"separator",textContent:` ${this.customFooterOptions.metricSeparator||""} `})),i}registerOnSelectedRowsChangedWhenEnabled(e){if((this.gridOptions.enableCheckboxSelector||this.gridOptions.enableRowSelection)&&e&&!e.hideRowSelectionCount&&this._isLeftFooterOriginallyEmpty){this._isLeftFooterDisplayingSelectionRowCount=!0;const t=e.metricTexts?.itemsSelected??this.locales?.TEXT_ITEMS_SELECTED??"TEXT_ITEMS_SELECTED";e.leftFooterText=`0 ${t}`,this._eventHandler.subscribe(this.grid.onSelectedRowsChanged,((t,i)=>{this._selectedRowCount=i.rows.length;const n=e.metricTexts?.itemsSelected??this.locales?.TEXT_ITEMS_SELECTED??"TEXT_ITEMS_SELECTED";this.leftFooterText=`${this._selectedRowCount} ${n}`}))}}}class $a{constructor(){this.dependencies=[]}get(e){const t=this.dependencies.find((t=>t.key===e));return t?.instance?t.instance:null}dispose(){this.dependencies=[]}registerInstance(e,t){this.dependencies.some((t=>t.key===e))||this.dependencies.push({key:e,instance:t})}}const Ua={GridBundle:class{get backendService(){return this.gridOptions.backendServiceApi?.service}get eventHandler(){return this._eventHandler}get columnDefinitions(){return this._columnDefinitions||[]}set columnDefinitions(e){this._columnDefinitions=e,this._slickgridInitialized&&this.updateColumnDefinitionsList(this._columnDefinitions),e.length>0&&this.copyColumnWidthsReference(e)}get dataset(){return this.dataView?.getItems()||[]}set dataset(e){const t=this._currentDatasetLength,i=Bt(e,this.dataset||[]);let n=this._gridOptions?.enableDeepCopyDatasetOnPageLoad?Ce(!0,[],e):e;this.slickGrid&&this.gridOptions?.enableTreeData&&Array.isArray(e)&&(e.length>0||e.length!==t||!i)&&(this._isDatasetHierarchicalInitialized=!1,n=this.sortTreeDataset(e,!i)),this.refreshGridData(n||[]),this._currentDatasetLength=(e||[]).length,this.slickGrid&&this.gridOptions.autoFitColumnsOnFirstLoad&&0===t&&!this._isAutosizeColsCalled&&(this.slickGrid.autosizeColumns(),this._isAutosizeColsCalled=!0),this.suggestDateParsingWhenHelpful()}get datasetHierarchical(){return this.sharedService.hierarchicalDataset}set datasetHierarchical(e){const t=Bt(e,this.sharedService.hierarchicalDataset||[]),i=this._currentDatasetLength;this.sharedService.hierarchicalDataset=e,e&&this.columnDefinitions&&this.filterService?.clearFilters&&this.filterService.clearFilters(),this.dataView&&e&&this.slickGrid&&this.sortService?.processTreeDataInitialSort&&(this.sortService.processTreeDataInitialSort(),queueMicrotask((()=>{const e=this.dataView?.getItemCount()??0;e>0&&(e!==i||!t)&&this.filterService.refreshTreeDataFilters()}))),this._isDatasetHierarchicalInitialized=!0}set eventPubSubService(e){this._eventPubSubService=e}set isDatasetHierarchicalInitialized(e){this._isDatasetHierarchicalInitialized=e}get gridOptions(){return this._gridOptions||{}}set gridOptions(e){let t;t=this.slickGrid?.getOptions?Ce(!0,{},this.slickGrid.getOptions(),e):this.mergeGridOptions(e),this.sharedService?.gridOptions&&this.slickGrid?.setOptions&&(this.sharedService.gridOptions=t,this.slickGrid.setOptions(t,!1,!0),this.slickGrid.reRenderColumns(!0)),this.setDarkMode(e.darkMode),this._gridOptions=t}get paginationOptions(){return this._paginationOptions}set paginationOptions(e){e&&this._paginationOptions?this._paginationOptions={...this._paginationOptions,...e}:this._paginationOptions=e,this.gridOptions.pagination=this._paginationOptions,this.paginationService.updateTotalItems(e?.totalItems??0,!0)}get isDatasetInitialized(){return this._isDatasetInitialized}set isDatasetInitialized(e){this._isDatasetInitialized=e}get isGridInitialized(){return this._isGridInitialized}get instances(){return this._slickerGridInstances}get extensions(){return this._extensions}get registeredResources(){return this._registeredResources}constructor(e,t,i,n,s,r){if(this._currentDatasetLength=0,this._darkMode=!1,this._hideHeaderRowAfterPageLoad=!1,this._isAutosizeColsCalled=!1,this._isDatasetInitialized=!1,this._isDatasetHierarchicalInitialized=!1,this._isGridInitialized=!1,this._isLocalGrid=!0,this._isPaginationInitialized=!1,this._registeredResources=[],this._scrollEndCalled=!1,this._slickgridInitialized=!1,this.customDataView=!1,this.totalItems=0,this.subscriptions=[],this.showPagination=!1,!e||0!==e.querySelectorAll(".slickgrid-container").length)return;e.classList.add("grid-pane"),this._gridParentContainerElm=e,this._gridContainerElm=document.createElement("div"),this._gridContainerElm.classList.add("slickgrid-container"),e.appendChild(this._gridContainerElm),this._hideHeaderRowAfterPageLoad=!1===i?.showHeaderRow,this._columnDefinitions=t||[],this._columnDefinitions.length>0&&this.copyColumnWidthsReference(this._columnDefinitions),this._registeredResources=i?.externalResources||[],this._gridOptions=this.mergeGridOptions(i||{});const o=!!this._gridOptions?.enableDeepCopyDatasetOnPageLoad;this._gridOptions.darkMode&&this.setDarkMode(!0),this.universalContainerService=r?.universalContainerService??new $a,this.translaterService=r?.translaterService??this._gridOptions?.translater,this._eventPubSubService=r?.eventPubSubService??new Pt(e),this._eventPubSubService.eventNamingStyle=this._gridOptions?.eventNamingStyle??Mt.camelCase;const a=new Na;this.backendUtilityService=r?.backendUtilityService??new d,this.gridEventService=r?.gridEventService??new Po,this.sharedService=r?.sharedService??new zo,this.collectionService=r?.collectionService??new un(this.translaterService),this.extensionUtility=r?.extensionUtility??new fn(this.sharedService,this.backendUtilityService,this.translaterService),this.filterFactory=new Sa(a,this.translaterService,this.collectionService),this.filterService=r?.filterService??new ko(this.filterFactory,this._eventPubSubService,this.sharedService,this.backendUtilityService),this.resizerService=r?.resizerService??new Bo(this._eventPubSubService),this.sortService=r?.sortService??new Vo(this.collectionService,this.sharedService,this._eventPubSubService,this.backendUtilityService),this.treeDataService=r?.treeDataService??new Wo(this._eventPubSubService,this.sharedService,this.sortService),this.paginationService=r?.paginationService??new Ho(this._eventPubSubService,this.sharedService,this.backendUtilityService),this.extensionService=r?.extensionService??new So(this.extensionUtility,this.filterService,this._eventPubSubService,this.sharedService,this.sortService,this.treeDataService,this.translaterService,(()=>this.gridService)),this.gridStateService=r?.gridStateService??new No(this.extensionService,this.filterService,this._eventPubSubService,this.sharedService,this.sortService,this.treeDataService),this.gridService=r?.gridService??new Mo(this.gridStateService,this.filterService,this._eventPubSubService,this.paginationService,this.sharedService,this.sortService,this.treeDataService),this.headerGroupingService=r?.headerGroupingService??new Fo(this.extensionUtility),s&&(this.sharedService.hierarchicalDataset=(o?Ce(!0,[],s):s)||[]);const l=new vn;this.universalContainerService.registerInstance("PubSubService",this._eventPubSubService),this.universalContainerService.registerInstance("EventPubSubService",this._eventPubSubService),this.universalContainerService.registerInstance("ExtensionUtility",this.extensionUtility),this.universalContainerService.registerInstance("FilterService",this.filterService),this.universalContainerService.registerInstance("CollectionService",this.collectionService),this.universalContainerService.registerInstance("ExtensionService",this.extensionService),this.universalContainerService.registerInstance("GridEventService",this.gridEventService),this.universalContainerService.registerInstance("GridService",this.gridService),this.universalContainerService.registerInstance("GridStateService",this.gridStateService),this.universalContainerService.registerInstance("HeaderGroupingService",this.headerGroupingService),this.universalContainerService.registerInstance("PaginationService",this.paginationService),this.universalContainerService.registerInstance("ResizerService",this.resizerService),this.universalContainerService.registerInstance("SharedService",this.sharedService),this.universalContainerService.registerInstance("SortService",this.sortService),this.universalContainerService.registerInstance("TranslaterService",this.translaterService),this.universalContainerService.registerInstance("TreeDataService",this.treeDataService),this.initialization(this._gridContainerElm,l,n)}emptyGridContainerElm(){const e=this.gridOptions?.gridContainerId??"grid1";ee(document.querySelector(`#${e}`))}dispose(e=!1){if(this._eventPubSubService?.publish("onBeforeGridDestroy",this.slickGrid),this._eventHandler?.unsubscribeAll(),this._eventPubSubService?.publish("onAfterGridDestroyed",!0),this.extensionService?.dispose(),this.filterService?.dispose(),this.gridEventService?.dispose(),this.gridService?.dispose(),this.gridStateService?.dispose(),this.headerGroupingService?.dispose(),this.paginationService?.dispose(),this.resizerService?.dispose(),this.sortService?.dispose(),this.treeDataService?.dispose(),this.universalContainerService?.dispose(),this.backendService?.dispose?.(),this.disposeExternalResources(),this.slickFooter?.dispose(),this.slickEmptyWarning?.dispose(),this.paginationComponent?.dispose(),Y(this.subscriptions),this._eventPubSubService?.unsubscribeAll(),this.dataView?.setItems([]),"function"==typeof this.dataView?.destroy&&this.dataView?.destroy(),this.slickGrid?.destroy(!0),this.slickGrid=null,ee(this._gridContainerElm),ee(this._gridParentContainerElm),this._gridContainerElm?.remove(),this._gridParentContainerElm?.remove(),this.backendServiceApi){for(const e of Object.keys(this.backendServiceApi))this.backendServiceApi[e]=null;this.backendServiceApi=void 0}for(const e of Object.keys(this.columnDefinitions))this.columnDefinitions[e]=null;for(const e of Object.keys(this.sharedService))this.sharedService[e]=null;this.datasetHierarchical=void 0,this._columnDefinitions=[],e&&this.emptyGridContainerElm(),this._eventPubSubService?.dispose(),this._slickerGridInstances=null}disposeExternalResources(){if(Array.isArray(this._registeredResources))for(;this._registeredResources.length>0;){const e=this._registeredResources.pop();e?.dispose&&e.dispose()}this._registeredResources=[]}initialization(e,t,i){if(this.gridOptions&&(void 0!==this.gridOptions.frozenRow&&this.gridOptions.frozenRow>=0||void 0!==this.gridOptions.frozenColumn&&this.gridOptions.frozenColumn>=0)&&void 0===this.gridOptions.enableMouseWheelScrollHandler&&(this.gridOptions.enableMouseWheelScrollHandler=!0),this._gridContainerElm=e,this._eventPubSubService.publish("onBeforeGridCreate",!0),this._isAutosizeColsCalled=!1,this._eventHandler=t,this._gridOptions=this.mergeGridOptions(this._gridOptions||{}),this.backendServiceApi=this._gridOptions?.backendServiceApi,this._isLocalGrid=!this.backendServiceApi,this._eventPubSubService.eventNamingStyle=this._gridOptions?.eventNamingStyle??Mt.camelCase,this._paginationOptions=this.gridOptions?.pagination,this._gridOptions.backendServiceApi&&!this._gridOptions.backendServiceApi?.disableInternalPostProcess&&this.createBackendApiInternalPostProcessCallback(this._gridOptions),!this.customDataView){const e=this._gridOptions?.dataView?.inlineFilters??!1;let t={...this._gridOptions.dataView,inlineFilters:e};(this.gridOptions.draggableGrouping||this.gridOptions.enableGrouping)&&(this.groupItemMetadataProvider=new En,this.sharedService.groupItemMetadataProvider=this.groupItemMetadataProvider,t={...t,groupItemMetadataProvider:this.groupItemMetadataProvider}),this.dataView=new xn(t,this._eventPubSubService),this._eventPubSubService.publish("onDataviewCreated",this.dataView)}this.preRegisterResources(),this._columnDefinitions=this.loadSlickGridEditors(this._columnDefinitions||[]),this._gridOptions?.autoAddCustomEditorFormatter&&ro(this._columnDefinitions,this._gridOptions.autoAddCustomEditorFormatter),this.sharedService.allColumns=this._columnDefinitions,this.sharedService.visibleColumns=this._columnDefinitions,this.extensionService.createExtensionsBeforeGridCreation(this._columnDefinitions,this._gridOptions),this.gridOptions.presets?.pinning&&(this.gridOptions={...this.gridOptions,...this.gridOptions.presets.pinning}),this.slickGrid=new Dr(e,this.dataView,this._columnDefinitions,this._gridOptions,this._eventPubSubService),this.sharedService.dataView=this.dataView,this.sharedService.slickGrid=this.slickGrid,this.sharedService.gridContainerElement=this._gridContainerElm,this.groupItemMetadataProvider&&this.slickGrid.registerPlugin(this.groupItemMetadataProvider),this.extensionService.bindDifferentExtensions(),this.bindDifferentHooks(this.slickGrid,this._gridOptions,this.dataView),this._slickgridInitialized=!0;const n=this._gridOptions?.frozenColumn??-1;n>=0&&n<=this._columnDefinitions.length&&this._columnDefinitions.length>0&&(this.sharedService.frozenVisibleColumnId=this._columnDefinitions[n]?.id??""),this.registerResources(),this.slickGrid.init(),this.resizerService.init(this.slickGrid,this._gridParentContainerElm),!this.gridOptions.enablePagination&&this.gridOptions.showCustomFooter&&this.gridOptions.customFooterOptions&&(this.slickFooter=new Wa(this.slickGrid,this.gridOptions.customFooterOptions,this._eventPubSubService,this.translaterService),this.slickFooter.renderFooter(this._gridParentContainerElm)),i=i||[];const s=this.gridOptions?.enableTreeData?this.sortTreeDataset(i):i;if(this.dataView&&(this.dataView.beginUpdate(),this.dataView.setItems(s,this._gridOptions.datasetIdPropertyName),this._currentDatasetLength=i.length,this.dataView.endUpdate()),this.slickGrid?.getSelectionModel()&&this._gridOptions?.dataView?.hasOwnProperty("syncGridSelection")){let e=!1;this._gridOptions.backendServiceApi&&this._gridOptions.dataView.hasOwnProperty("syncGridSelectionWithBackendService")&&(e=this._gridOptions.dataView.syncGridSelectionWithBackendService);const t=this._gridOptions.dataView.syncGridSelection;if("boolean"==typeof t){let i=t;this._isLocalGrid||(i=t&&e),this.dataView?.syncGridSelection(this.slickGrid,i)}else"object"==typeof t&&this.dataView?.syncGridSelection(this.slickGrid,t.preserveHidden,t.preserveHiddenOnSelectionChange)}(this.dataView?.getLength()??0)>0?(this._isDatasetInitialized||!this._gridOptions.enableCheckboxSelector&&!this._gridOptions.enableRowSelection||this.loadRowSelectionPresetWhenExists(),this.loadFilterPresetsWhenDatasetInitialized(),this._isDatasetInitialized=!0):this.displayEmptyDataWarning(!0),this._hideHeaderRowAfterPageLoad&&(this.showHeaderRow(!1),this.sharedService.hideHeaderRowAfterPageLoad=this._hideHeaderRowAfterPageLoad),this.gridEventService.bindOnBeforeEditCell(this.slickGrid),this.gridEventService.bindOnCellChange(this.slickGrid),this.gridEventService.bindOnClick(this.slickGrid),this.gridOptions?.backendServiceApi&&this.bindBackendCallbackFunctions(this.gridOptions),this._eventPubSubService.publish("onGridCreated",this.slickGrid),this.customDataView||this.executeAfterDataviewCreated(this.gridOptions),this.bindResizeHook(this.slickGrid,this.gridOptions),this.gridOptions?.enablePagination&&this._isLocalGrid&&(this.showPagination=!0,this.loadLocalGridPagination(this.dataset)),this._slickerGridInstances={dataView:this.dataView,slickGrid:this.slickGrid,dispose:this.dispose.bind(this),backendService:this.backendService,eventPubSubService:this._eventPubSubService,filterService:this.filterService,gridEventService:this.gridEventService,gridStateService:this.gridStateService,gridService:this.gridService,groupingService:this.headerGroupingService,headerGroupingService:this.headerGroupingService,extensionService:this.extensionService,extensionUtility:this.extensionUtility,paginationService:this.paginationService,resizerService:this.resizerService,sortService:this.sortService,treeDataService:this.treeDataService},this._extensions=this.extensionService?.extensionList,this._eventPubSubService.publish("onSlickerGridCreated",this.instances),this._isGridInitialized=!0,this.suggestDateParsingWhenHelpful()}hasBackendInfiniteScroll(){return!!this.backendService?.options?.infiniteScroll}mergeGridOptions(e){const t=Ce(!0,{},Ea,e);return t.enableFiltering&&!t.showHeaderRow&&(t.showHeaderRow=t.enableFiltering),t?.pagination&&(e.enablePagination||e.backendServiceApi)&&e.pagination&&Array.isArray(e.pagination.pageSizes)&&(t.pagination.pageSizes=e.pagination.pageSizes),this.sharedService&&!t.enableFiltering&&t.enablePagination&&this._isLocalGrid&&(t.enableFiltering=!0,t.showHeaderRow=!1,this._hideHeaderRowAfterPageLoad=!0,this.sharedService.hideHeaderRowAfterPageLoad=!0),t}createBackendApiInternalPostProcessCallback(e){const t=e?.backendServiceApi;if(t?.service){const e=t.service;"function"==typeof e.getDatasetName&&(t.internalPostProcess=i=>{const n=t&&e&&"function"==typeof e.getDatasetName?e.getDatasetName():"";if(i&&i.data&&i.data[n]){const e=i.data[n].hasOwnProperty("nodes")?i.data[n].nodes:i.data[n],t=i.data[n].hasOwnProperty("totalCount")?i.data[n].totalCount:i.data[n].length;this.refreshGridData(e,t||0)}})}}bindDifferentHooks(e,t,i){if(t.enableTranslate&&this.translaterService?.addPubSubMessaging&&this.translaterService.addPubSubMessaging(this._eventPubSubService),t.enableTranslate&&this.extensionService.translateAllExtensions(),this.subscriptions.push(this._eventPubSubService.subscribe("onLanguageChange",(e=>{t.enableTranslate&&(this.extensionService.translateAllExtensions(e.language),(t.createPreHeaderPanel&&t.createTopHeaderPanel||t.createPreHeaderPanel&&!t.enableDraggableGrouping)&&this.headerGroupingService.translateHeaderGrouping())}))),t.backendServiceApi){const e=t.backendServiceApi;e?.service?.init&&e.service.init(e.options,t.pagination,this.slickGrid,this.sharedService)}i&&e&&(t.enableFiltering&&(this.filterService.init(e),t.backendServiceApi&&!t.backendServiceApi.useLocalFiltering?this.filterService.bindBackendOnFilter(e):this.filterService.bindLocalOnFilter(e)),t.enableSorting&&(t.backendServiceApi&&!t.backendServiceApi.useLocalSorting?this.sortService.bindBackendOnSort(e):this.sortService.bindLocalOnSort(e)),this._eventHandler.subscribe(i.onRowCountChanged,(()=>{e.invalidate(),this.handleOnItemCountChanged(this.dataView?.getFilteredItemCount()||0,this.dataView?.getItemCount()??0)})),this._eventHandler.subscribe(i.onSetItemsCalled,((e,t)=>{this.sharedService.isItemsDateParsed=!1,this.handleOnItemCountChanged(this.dataView?.getFilteredItemCount()||0,t.itemCount),t.itemCount>0&&(this.gridOptions.autosizeColumnsByCellContentOnFirstLoad||this.gridOptions.enableAutoResizeColumnsByCellContent)&&this.resizerService.resizeColumnsByCellContent(!this.gridOptions?.resizeByContentOnlyOnFirstLoad)})),t?.enableFiltering&&!t.enableRowDetailView&&this._eventHandler.subscribe(i.onRowsChanged,((t,{calledOnRowCountChanged:i,rows:n})=>{if(!i&&Array.isArray(n)){const t=e.getRenderedRange();n.filter((e=>e>=t.top&&e<=t.bottom)).forEach((t=>e.updateRow(t))),e.render()}})),this._eventHandler.subscribe(e.onColumnsReordered,((e,t)=>{this.sharedService.hasColumnsReordered=!0,this.sharedService.visibleColumns=t.impactedColumns})),this._eventHandler.subscribe(e.onSetOptions,((e,t)=>{t.optionsBefore.darkMode!==t.optionsAfter.darkMode&&this.setDarkMode(t.optionsAfter.darkMode)})),this.loadColumnPresetsWhenDatasetInitialized(),this.loadFilterPresetsWhenDatasetInitialized()),t?.colspanCallback&&i?.getItem&&i?.getItemMetadata&&(i.getItemMetadata=e=>{let n=null;return t.colspanCallback&&(n=t.colspanCallback(i.getItem(e))),n})}bindBackendCallbackFunctions(e){const t=e.backendServiceApi,i=t?.service,n=i?.options??{},s=!!n&&(!n?.hasOwnProperty("executeProcessCommandOnInit")||n.executeProcessCommandOnInit);if(i){if(e?.presets){if(i.updateFilters&&Array.isArray(e.presets.filters)&&e.presets.filters.length>0&&i.updateFilters(e.presets.filters,!0),i.updateSorters&&Array.isArray(e.presets.sorters)&&e.presets.sorters.length>0){const t=this._gridOptions?.multiColumnSort?e.presets.sorters:e.presets.sorters.slice(0,1);i.updateSorters(void 0,t)}if(i.updatePagination&&e.presets.pagination&&!this.hasBackendInfiniteScroll()){const{pageNumber:t,pageSize:n}=e.presets.pagination;i.updatePagination(t,n)}}else{const e=this.filterService.getColumnFilters();e&&i.updateFilters&&i.updateFilters(e,!1)}if(t&&i&&(t.onInit||s)){const e="function"==typeof i.buildQuery?i.buildQuery():"",n=s?t.process?.(e)??null:t.onInit?.(e)??null;queueMicrotask((()=>{const e=this.backendUtilityService,i=new Date;t.preProcess&&t.preProcess();const s=this.gridOptions?.pagination?.totalItems??0;n instanceof Promise?n.then((n=>e.executeBackendProcessesCallback(i,n,t,s))).catch((i=>e.onBackendError(i,t))):n&&this.rxjs?.isObservable(n)&&this.subscriptions.push(n.subscribe((n=>e.executeBackendProcessesCallback(i,n,t,s)),(i=>e.onBackendError(i,t))))}))}t.service.options?.infiniteScroll&&this.addBackendInfiniteScrollCallback()}}addBackendInfiniteScrollCallback(){if(this.slickGrid&&this.gridOptions.backendServiceApi&&this.hasBackendInfiniteScroll()&&!this.gridOptions.backendServiceApi?.onScrollEnd){const e=()=>{this.backendUtilityService.setInfiniteScrollBottomHit(!0),this.paginationService.goToNextPage().then((e=>{e||this.backendUtilityService.setInfiniteScrollBottomHit(!1)}))};this.gridOptions.backendServiceApi.onScrollEnd=e,this._eventHandler.subscribe(this.slickGrid.onScroll,((t,i)=>{const n=i.grid.getViewportNode();["mousewheel","scroll"].includes(i.triggeredBy||"")&&this.paginationService?.totalItems&&i.scrollTop>0&&Math.ceil(n.offsetHeight+i.scrollTop)>=i.scrollHeight&&(this._scrollEndCalled||(e(),this._scrollEndCalled=!0))}));const t=this.gridOptions.backendServiceApi.postProcess;this.gridOptions.backendServiceApi.postProcess=e=>{this._scrollEndCalled=!1,t&&t(e)}}}bindResizeHook(e,t){if(t.autoFitColumnsOnFirstLoad&&t.autosizeColumnsByCellContentOnFirstLoad||t.enableAutoSizeColumns&&t.enableAutoResizeColumnsByCellContent)throw new Error('[Slickgrid-Universal] You cannot enable both autosize/fit viewport & resize by content, you must choose which resize technique to use. You can enable these 2 options ("autoFitColumnsOnFirstLoad" and "enableAutoSizeColumns") OR these other 2 options ("autosizeColumnsByCellContentOnFirstLoad" and "enableAutoResizeColumnsByCellContent").');t.gridHeight||t.gridWidth?this.resizerService.resizeGrid(0,{height:t.gridHeight,width:t.gridWidth}):this.resizerService.resizeGrid(),e&&t?.enableAutoResize&&t.autoFitColumnsOnFirstLoad&&t.enableAutoSizeColumns&&!this._isAutosizeColsCalled&&(e.autosizeColumns(),this._isAutosizeColsCalled=!0)}executeAfterDataviewCreated(e){if(e.enableSorting&&e.presets&&Array.isArray(e.presets.sorters)){const t=this._gridOptions?.multiColumnSort?e.presets.sorters:e.presets.sorters.slice(0,1);this.sortService.loadGridSorters(t)}}paginationChanged(e){const t=this.gridStateService?.needToPreserveRowSelection()??!1;this.slickGrid&&!t&&this._gridOptions?.backendServiceApi&&(this.gridOptions.enableRowSelection||this.gridOptions.enableCheckboxSelector)&&this.slickGrid.setSelectedRows([]);const{pageNumber:i,pageSize:n}=e;this.sharedService&&void 0!==n&&void 0!==i&&(this.sharedService.currentPagination={pageNumber:i,pageSize:n}),this._eventPubSubService.publish("onGridStateChanged",{change:{newValues:{pageNumber:i,pageSize:n},type:w.pagination},gridState:this.gridStateService.getCurrentGridState()})}refreshGridData(e,t){if(this.slickGrid&&this._gridOptions){if(this._gridOptions.enableEmptyDataWarningMessage&&Array.isArray(e)){const i=t||e.length;this.displayEmptyDataWarning(i<1)}if(Array.isArray(e)&&this.slickGrid&&this.dataView?.setItems){if(this.dataView.setItems(e,this._gridOptions.datasetIdPropertyName),this._gridOptions.backendServiceApi||this._gridOptions.enableTreeData||this.dataView.reSort(),e.length>0&&(this._isDatasetInitialized||(this.loadFilterPresetsWhenDatasetInitialized(),this._gridOptions.enableCheckboxSelector&&this.loadRowSelectionPresetWhenExists()),this._isDatasetInitialized=!0),e&&this.slickGrid.invalidate(),this.showPagination=!(!this._gridOptions||!(this._gridOptions.enablePagination||this._gridOptions.backendServiceApi&&void 0===this._gridOptions.enablePagination)),this._paginationOptions&&this._gridOptions?.pagination&&this._gridOptions?.backendServiceApi){const e=this.setPaginationOptionsWhenPresetDefined(this._gridOptions,this._paginationOptions),i=void 0!==t?t:this._gridOptions?.pagination?.totalItems;void 0!==i&&i!==this.totalItems&&(this.totalItems=+i),this._isPaginationInitialized?this.paginationService.updateTotalItems(this.totalItems):this.initializePaginationService(e)}if(this.slickGrid&&this._gridOptions.enableAutoResize){const e=this._gridOptions.autoResize&&this._gridOptions.autoResize.delay;this.resizerService.resizeGrid(e||10)}}}}updateColumnDefinitionsList(e){this.slickGrid&&this._gridOptions&&Array.isArray(e)&&(e=this.loadSlickGridEditors(e),this._gridOptions.autoAddCustomEditorFormatter&&ro(e,this._gridOptions.autoAddCustomEditorFormatter),this._gridOptions.enableTranslate?this.extensionService.translateColumnHeaders(void 0,e):this.extensionService.renderColumnHeaders(e,!0),this.slickGrid&&this._gridOptions?.enableAutoSizeColumns?this.slickGrid.autosizeColumns():this._gridOptions?.enableAutoResizeColumnsByCellContent&&this.resizerService?.resizeColumnsByCellContent&&this.resizerService.resizeColumnsByCellContent())}showHeaderRow(e=!0){return this.slickGrid?.setHeaderRowVisibility(e),this.slickGrid&&!0===e&&this._isGridInitialized&&this.slickGrid.setColumns(this.columnDefinitions),e}setData(e,t=!1){t&&(this._isAutosizeColsCalled=!1,this._currentDatasetLength=0),this.dataset=e||[]}setPaginationOptionsWhenPresetDefined(e,t){return e.presets?.pagination&&t&&!this._isPaginationInitialized&&(this.hasBackendInfiniteScroll()?console.warn("[Slickgrid-Universal] `presets.pagination` is not supported with Infinite Scroll, reverting to first page."):(t.pageSize=e.presets.pagination.pageSize,t.pageNumber=e.presets.pagination.pageNumber)),t}setDarkMode(e=!1){e?this._gridParentContainerElm.classList.add("slick-dark-mode"):this._gridParentContainerElm.classList.remove("slick-dark-mode")}copyColumnWidthsReference(e){e.forEach((e=>e.originalWidth=e.width))}displayEmptyDataWarning(e=!0){this.gridOptions.enableEmptyDataWarningMessage&&this.slickEmptyWarning?.showEmptyDataMessage(e)}handleOnItemCountChanged(e,t){this._currentDatasetLength=t,this.metrics={startTime:new Date,endTime:new Date,itemCount:e,totalItemCount:t},this.slickFooter&&(this.slickFooter.metrics=this.metrics),this._isLocalGrid&&this._gridOptions?.enableEmptyDataWarningMessage&&this.displayEmptyDataWarning(0===e)}initializePaginationService(e){this.slickGrid&&this.gridOptions&&(this.paginationData={gridOptions:this.gridOptions,paginationService:this.paginationService},this.paginationService.totalItems=this.totalItems,this.paginationService.init(this.slickGrid,e,this.backendServiceApi),this.subscriptions.push(this._eventPubSubService.subscribe("onPaginationChanged",(e=>this.paginationChanged(e))),this._eventPubSubService.subscribe("onPaginationVisibilityChanged",(e=>{this.showPagination=e?.visible??!1,this.gridOptions?.backendServiceApi&&this.backendUtilityService?.refreshBackendDataset(this.gridOptions),this.renderPagination(this.showPagination)}))),this.renderPagination(),this._isPaginationInitialized=!0)}renderPagination(e=!0){if(this.slickGrid&&this._gridOptions?.enablePagination&&!this._isPaginationInitialized&&e){const e=this.gridOptions.customPaginationComponent??Va;this.paginationComponent=new e,this.paginationComponent.init(this.slickGrid,this.paginationService,this._eventPubSubService,this.translaterService),this.paginationComponent.renderPagination(this._gridParentContainerElm),this._isPaginationInitialized=!0}else e||(this.paginationComponent?.dispose(),this._isPaginationInitialized=!1)}loadEditorCollectionAsync(e){if(e?.editor){const t=e.editor.collectionAsync;e.editor.disabled=!0,t instanceof Promise?t.then((t=>{Array.isArray(t)?this.updateEditorCollection(e,t):t?.status>=200&&t.status<300&&"function"==typeof t.json?t.bodyUsed?console.warn("[SlickGrid-Universal] The response body passed to collectionAsync was already read.Either pass the dataset from the Response or clone the response first using response.clone()"):t.json().then((t=>this.updateEditorCollection(e,t))):t?.content&&this.updateEditorCollection(e,t.content)})):this.rxjs?.isObservable(t)&&queueMicrotask((()=>{this.subscriptions.push(t.subscribe((t=>this.updateEditorCollection(e,t))))}))}}insertDynamicPresetColumns(e,t){if(this._columnDefinitions){const i=this._columnDefinitions.findIndex((t=>t.id===e));if(i>=0){const n=this._columnDefinitions[i];n?.id!==e||t.some((t=>t.id===e))||(i>0?t.splice(i,0,n):t.unshift(n))}}}loadColumnPresetsWhenDatasetInitialized(){if(this.slickGrid&&this.gridOptions.presets&&Array.isArray(this.gridOptions.presets.columns)&&this.gridOptions.presets.columns.length>0){const e=this.gridStateService.getAssociatedGridColumns(this.slickGrid,this.gridOptions.presets.columns);if(e&&Array.isArray(e)&&e.length>0&&Array.isArray(this._columnDefinitions)){if(this.gridOptions.enableRowMoveManager){const t=this.gridOptions?.rowMoveManager?.columnId??"_move";this.insertDynamicPresetColumns(t,e)}if(this.gridOptions.enableCheckboxSelector){const t=this.gridOptions?.checkboxSelector?.columnId??"_checkbox_selector";this.insertDynamicPresetColumns(t,e)}if(this.gridOptions.enableRowDetailView){const t=this.gridOptions?.rowDetailView?.columnId??"_detail_selector";this.insertDynamicPresetColumns(t,e)}e.forEach((e=>e.originalWidth=e.width)),this.slickGrid.setColumns(e),this.sharedService.visibleColumns=e}}}loadFilterPresetsWhenDatasetInitialized(){this.gridOptions&&!this.customDataView&&this.gridOptions.presets&&(Array.isArray(this.gridOptions.presets.filters)||Array.isArray(this.gridOptions.presets?.treeData?.toggledItems))&&this.filterService.populateColumnFilterSearchTermPresets(this.gridOptions.presets?.filters||[])}loadLocalGridPagination(e){if(this.gridOptions&&this._paginationOptions){if(this.totalItems=Array.isArray(e)?e.length:0,this._paginationOptions&&this.dataView?.getPagingInfo){const e=this.dataView.getPagingInfo();e?.hasOwnProperty("totalRows")&&this._paginationOptions.totalItems!==e.totalRows&&(this.totalItems=e?.totalRows||0)}this._paginationOptions.totalItems=this.totalItems;const t=this.setPaginationOptionsWhenPresetDefined(this.gridOptions,this._paginationOptions);this.initializePaginationService(t)}}loadRowSelectionPresetWhenExists(){const e=this.gridOptions?.presets,t=this.slickGrid?.getSelectionModel(),i=this.gridOptions&&(this.gridOptions.enableCheckboxSelector||this.gridOptions.enableRowSelection);if(this.slickGrid&&this.dataView&&i&&t&&e?.rowSelection&&(Array.isArray(e.rowSelection.gridRowIndexes)||Array.isArray(e.rowSelection.dataContextIds))){let t=e.rowSelection.dataContextIds,i=e.rowSelection.gridRowIndexes;Array.isArray(t)&&t.length>0?i=this.dataView.mapIdsToRows(t)||[]:Array.isArray(i)&&i.length>0&&(t=this.dataView.mapRowsToIds(i)||[]),this.slickGrid&&Array.isArray(i)&&(this.slickGrid.setSelectedRows(i),this.dataView.setSelectedIds(t||[],{isRowBeingAdded:!0,shouldTriggerEvent:!1,applyRowSelectionToGrid:!0}))}}registerExternalResources(e,t=!1){t&&this.disposeExternalResources(),e.forEach((e=>this._registeredResources.push(e))),this.initializeExternalResources(e)}resetExternalResources(){this._registeredResources=[]}preRegisterResources(){if(Array.isArray(this._registeredResources))for(const e of this._registeredResources)"RxJsResource"===e?.className&&this.registerRxJsResource(e)}initializeExternalResources(e){if(Array.isArray(e))for(const t of e)this.slickGrid&&"function"==typeof t.init&&t.init(this.slickGrid,this.universalContainerService)}registerResources(){Array.isArray(this._registeredResources)&&(this.sharedService.externalRegisteredResources=this._registeredResources),this._registeredResources.push(this.gridService,this.gridStateService),(this.gridOptions.createPreHeaderPanel&&this.gridOptions.createTopHeaderPanel||this.gridOptions.createPreHeaderPanel&&!this.gridOptions.enableDraggableGrouping)&&this._registeredResources.push(this.headerGroupingService),this.gridOptions.enableTreeData&&this._registeredResources.push(this.treeDataService),this.gridOptions.enableTranslate&&this.extensionService.translateColumnHeaders(),this.slickEmptyWarning=new Ba,this._registeredResources.push(this.slickEmptyWarning),this.initializeExternalResources(this._registeredResources)}registerRxJsResource(e){this.rxjs=e,this.backendUtilityService.addRxJsResource(this.rxjs),this.filterFactory.addRxJsResource(this.rxjs),this.filterService.addRxJsResource(this.rxjs),this.sortService.addRxJsResource(this.rxjs),this.paginationService.addRxJsResource(this.rxjs),this.universalContainerService.registerInstance("RxJsFacade",this.rxjs),this.universalContainerService.registerInstance("RxJsResource",this.rxjs)}sortTreeDataset(e,t=!1){const i=this._currentDatasetLength;let n,s=[];return this._isDatasetHierarchicalInitialized&&this.datasetHierarchical?(n=this.treeDataService.sortHierarchicalDataset(this.datasetHierarchical),s=n.flat):Array.isArray(e)&&e.length>0&&(n=this.treeDataService.convertFlatParentChildToTreeDatasetAndSort(e,this._columnDefinitions||[],this.gridOptions),this.sharedService.hierarchicalDataset=n.hierarchical,s=n.flat),e.length>0&&(t||e.length!==i)&&this.filterService.refreshTreeDataFilters(s),s}loadSlickGridEditors(e){const t=Array.isArray(e)?e:[];return t.some((e=>`${e.id}`.includes(".")))&&console.error('[Slickgrid-Universal] Make sure that none of your Column Definition "id" property includes a dot in its name because that will cause some problems with the Editors. For example if your column definition "field" property is "user.firstName" then use "firstName" as the column "id".'),t.map((e=>(e.editor?.collectionAsync&&this.loadEditorCollectionAsync(e),{...e,editorClass:e.editor?.model})))}suggestDateParsingWhenHelpful(){!this.gridOptions.silenceWarnings&&this.dataView&&this.dataView.getItemCount()>1e4&&!this.gridOptions.preParseDateColumns&&this.slickGrid?.getColumns().some((e=>V(e.type)))&&console.warn("[Slickgrid-Universal] For getting better perf, we suggest you enable the `preParseDateColumns` grid option, for more info visit => https://ghiscoding.gitbook.io/slickgrid-universal/column-functionalities/sorting#pre-parse-date-columns-for-better-perf")}updateEditorCollection(e,t){if(this.slickGrid&&e.editor){e.editor.collection=t,e.editor.disabled=!1;const i=this.slickGrid.getCellEditor();i?.disable&&i?.renderDomElement&&("function"==typeof i.destroy&&i.destroy(),i.disable(!1),i.renderDomElement(t))}}},Aggregators:Ta,BindingService:Ha,Editors:ja,Enums:i,Filters:wa,Formatters:Ma,GroupTotalFormatters:Pa,SortComparers:Rt,Utilities:Fa};"undefined"!=typeof window&&(window.Slicker=Ua);var qa="top",Ga="bottom",Ka="right",Ya="left",Xa="auto",Za=[qa,Ga,Ka,Ya],Qa="start",Ja="end",el="clippingParents",tl="viewport",il="popper",nl="reference",sl=Za.reduce((function(e,t){return e.concat([t+"-"+Qa,t+"-"+Ja])}),[]),rl=[].concat(Za,[Xa]).reduce((function(e,t){return e.concat([t,t+"-"+Qa,t+"-"+Ja])}),[]),ol="beforeRead",al="read",ll="afterRead",cl="beforeMain",hl="main",dl="afterMain",ul="beforeWrite",pl="write",fl="afterWrite",ml=[ol,al,ll,cl,hl,dl,ul,pl,fl];function gl(e){return e?(e.nodeName||"").toLowerCase():null}function vl(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function _l(e){return e instanceof vl(e).Element||e instanceof Element}function bl(e){return e instanceof vl(e).HTMLElement||e instanceof HTMLElement}function yl(e){return"undefined"!=typeof ShadowRoot&&(e instanceof vl(e).ShadowRoot||e instanceof ShadowRoot)}const Cl={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var i=t.styles[e]||{},n=t.attributes[e]||{},s=t.elements[e];bl(s)&&gl(s)&&(Object.assign(s.style,i),Object.keys(n).forEach((function(e){var t=n[e];!1===t?s.removeAttribute(e):s.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,i={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,i.popper),t.styles=i,t.elements.arrow&&Object.assign(t.elements.arrow.style,i.arrow),function(){Object.keys(t.elements).forEach((function(e){var n=t.elements[e],s=t.attributes[e]||{},r=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:i[e]).reduce((function(e,t){return e[t]="",e}),{});bl(n)&&gl(n)&&(Object.assign(n.style,r),Object.keys(s).forEach((function(e){n.removeAttribute(e)})))}))}},requires:["computeStyles"]};function wl(e){return e.split("-")[0]}var Sl=Math.max,El=Math.min,xl=Math.round;function Tl(){var e=navigator.userAgentData;return null!=e&&e.brands&&Array.isArray(e.brands)?e.brands.map((function(e){return e.brand+"/"+e.version})).join(" "):navigator.userAgent}function Al(){return!/^((?!chrome|android).)*safari/i.test(Tl())}function Ol(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=!1);var n=e.getBoundingClientRect(),s=1,r=1;t&&bl(e)&&(s=e.offsetWidth>0&&xl(n.width)/e.offsetWidth||1,r=e.offsetHeight>0&&xl(n.height)/e.offsetHeight||1);var o=(_l(e)?vl(e):window).visualViewport,a=!Al()&&i,l=(n.left+(a&&o?o.offsetLeft:0))/s,c=(n.top+(a&&o?o.offsetTop:0))/r,h=n.width/s,d=n.height/r;return{width:h,height:d,top:c,right:l+h,bottom:c+d,left:l,x:l,y:c}}function Il(e){var t=Ol(e),i=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-i)<=1&&(i=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:i,height:n}}function kl(e,t){var i=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(i&&yl(i)){var n=t;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function Dl(e){return vl(e).getComputedStyle(e)}function jl(e){return["table","td","th"].indexOf(gl(e))>=0}function Rl(e){return((_l(e)?e.ownerDocument:e.document)||window.document).documentElement}function Ll(e){return"html"===gl(e)?e:e.assignedSlot||e.parentNode||(yl(e)?e.host:null)||Rl(e)}function Ml(e){return bl(e)&&"fixed"!==Dl(e).position?e.offsetParent:null}function Pl(e){for(var t=vl(e),i=Ml(e);i&&jl(i)&&"static"===Dl(i).position;)i=Ml(i);return i&&("html"===gl(i)||"body"===gl(i)&&"static"===Dl(i).position)?t:i||function(e){var t=/firefox/i.test(Tl());if(/Trident/i.test(Tl())&&bl(e)&&"fixed"===Dl(e).position)return null;var i=Ll(e);for(yl(i)&&(i=i.host);bl(i)&&["html","body"].indexOf(gl(i))<0;){var n=Dl(i);if("none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||-1!==["transform","perspective"].indexOf(n.willChange)||t&&"filter"===n.willChange||t&&n.filter&&"none"!==n.filter)return i;i=i.parentNode}return null}(e)||t}function Nl(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function Fl(e,t,i){return Sl(e,El(t,i))}function Hl(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function Bl(e,t){return t.reduce((function(t,i){return t[i]=e,t}),{})}const zl={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,i=e.state,n=e.name,s=e.options,r=i.elements.arrow,o=i.modifiersData.popperOffsets,a=wl(i.placement),l=Nl(a),c=[Ya,Ka].indexOf(a)>=0?"height":"width";if(r&&o){var h=function(e,t){return Hl("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:Bl(e,Za))}(s.padding,i),d=Il(r),u="y"===l?qa:Ya,p="y"===l?Ga:Ka,f=i.rects.reference[c]+i.rects.reference[l]-o[l]-i.rects.popper[c],m=o[l]-i.rects.reference[l],g=Pl(r),v=g?"y"===l?g.clientHeight||0:g.clientWidth||0:0,_=f/2-m/2,b=h[u],y=v-d[c]-h[p],C=v/2-d[c]/2+_,w=Fl(b,C,y),S=l;i.modifiersData[n]=((t={})[S]=w,t.centerOffset=w-C,t)}},effect:function(e){var t=e.state,i=e.options.element,n=void 0===i?"[data-popper-arrow]":i;null!=n&&("string"!=typeof n||(n=t.elements.popper.querySelector(n)))&&kl(t.elements.popper,n)&&(t.elements.arrow=n)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Vl(e){return e.split("-")[1]}var Wl={top:"auto",right:"auto",bottom:"auto",left:"auto"};function $l(e){var t,i=e.popper,n=e.popperRect,s=e.placement,r=e.variation,o=e.offsets,a=e.position,l=e.gpuAcceleration,c=e.adaptive,h=e.roundOffsets,d=e.isFixed,u=o.x,p=void 0===u?0:u,f=o.y,m=void 0===f?0:f,g="function"==typeof h?h({x:p,y:m}):{x:p,y:m};p=g.x,m=g.y;var v=o.hasOwnProperty("x"),_=o.hasOwnProperty("y"),b=Ya,y=qa,C=window;if(c){var w=Pl(i),S="clientHeight",E="clientWidth";w===vl(i)&&"static"!==Dl(w=Rl(i)).position&&"absolute"===a&&(S="scrollHeight",E="scrollWidth"),(s===qa||(s===Ya||s===Ka)&&r===Ja)&&(y=Ga,m-=(d&&w===C&&C.visualViewport?C.visualViewport.height:w[S])-n.height,m*=l?1:-1),s!==Ya&&(s!==qa&&s!==Ga||r!==Ja)||(b=Ka,p-=(d&&w===C&&C.visualViewport?C.visualViewport.width:w[E])-n.width,p*=l?1:-1)}var x,T=Object.assign({position:a},c&&Wl),A=!0===h?function(e,t){var i=e.x,n=e.y,s=t.devicePixelRatio||1;return{x:xl(i*s)/s||0,y:xl(n*s)/s||0}}({x:p,y:m},vl(i)):{x:p,y:m};return p=A.x,m=A.y,l?Object.assign({},T,((x={})[y]=_?"0":"",x[b]=v?"0":"",x.transform=(C.devicePixelRatio||1)<=1?"translate("+p+"px, "+m+"px)":"translate3d("+p+"px, "+m+"px, 0)",x)):Object.assign({},T,((t={})[y]=_?m+"px":"",t[b]=v?p+"px":"",t.transform="",t))}const Ul={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,i=e.options,n=i.gpuAcceleration,s=void 0===n||n,r=i.adaptive,o=void 0===r||r,a=i.roundOffsets,l=void 0===a||a,c={placement:wl(t.placement),variation:Vl(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:s,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,$l(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:o,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,$l(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}};var ql={passive:!0};const Gl={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,i=e.instance,n=e.options,s=n.scroll,r=void 0===s||s,o=n.resize,a=void 0===o||o,l=vl(t.elements.popper),c=[].concat(t.scrollParents.reference,t.scrollParents.popper);return r&&c.forEach((function(e){e.addEventListener("scroll",i.update,ql)})),a&&l.addEventListener("resize",i.update,ql),function(){r&&c.forEach((function(e){e.removeEventListener("scroll",i.update,ql)})),a&&l.removeEventListener("resize",i.update,ql)}},data:{}};var Kl={left:"right",right:"left",bottom:"top",top:"bottom"};function Yl(e){return e.replace(/left|right|bottom|top/g,(function(e){return Kl[e]}))}var Xl={start:"end",end:"start"};function Zl(e){return e.replace(/start|end/g,(function(e){return Xl[e]}))}function Ql(e){var t=vl(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function Jl(e){return Ol(Rl(e)).left+Ql(e).scrollLeft}function ec(e){var t=Dl(e),i=t.overflow,n=t.overflowX,s=t.overflowY;return/auto|scroll|overlay|hidden/.test(i+s+n)}function tc(e){return["html","body","#document"].indexOf(gl(e))>=0?e.ownerDocument.body:bl(e)&&ec(e)?e:tc(Ll(e))}function ic(e,t){var i;void 0===t&&(t=[]);var n=tc(e),s=n===(null==(i=e.ownerDocument)?void 0:i.body),r=vl(n),o=s?[r].concat(r.visualViewport||[],ec(n)?n:[]):n,a=t.concat(o);return s?a:a.concat(ic(Ll(o)))}function nc(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function sc(e,t,i){return t===tl?nc(function(e,t){var i=vl(e),n=Rl(e),s=i.visualViewport,r=n.clientWidth,o=n.clientHeight,a=0,l=0;if(s){r=s.width,o=s.height;var c=Al();(c||!c&&"fixed"===t)&&(a=s.offsetLeft,l=s.offsetTop)}return{width:r,height:o,x:a+Jl(e),y:l}}(e,i)):_l(t)?function(e,t){var i=Ol(e,!1,"fixed"===t);return i.top=i.top+e.clientTop,i.left=i.left+e.clientLeft,i.bottom=i.top+e.clientHeight,i.right=i.left+e.clientWidth,i.width=e.clientWidth,i.height=e.clientHeight,i.x=i.left,i.y=i.top,i}(t,i):nc(function(e){var t,i=Rl(e),n=Ql(e),s=null==(t=e.ownerDocument)?void 0:t.body,r=Sl(i.scrollWidth,i.clientWidth,s?s.scrollWidth:0,s?s.clientWidth:0),o=Sl(i.scrollHeight,i.clientHeight,s?s.scrollHeight:0,s?s.clientHeight:0),a=-n.scrollLeft+Jl(e),l=-n.scrollTop;return"rtl"===Dl(s||i).direction&&(a+=Sl(i.clientWidth,s?s.clientWidth:0)-r),{width:r,height:o,x:a,y:l}}(Rl(e)))}function rc(e){var t,i=e.reference,n=e.element,s=e.placement,r=s?wl(s):null,o=s?Vl(s):null,a=i.x+i.width/2-n.width/2,l=i.y+i.height/2-n.height/2;switch(r){case qa:t={x:a,y:i.y-n.height};break;case Ga:t={x:a,y:i.y+i.height};break;case Ka:t={x:i.x+i.width,y:l};break;case Ya:t={x:i.x-n.width,y:l};break;default:t={x:i.x,y:i.y}}var c=r?Nl(r):null;if(null!=c){var h="y"===c?"height":"width";switch(o){case Qa:t[c]=t[c]-(i[h]/2-n[h]/2);break;case Ja:t[c]=t[c]+(i[h]/2-n[h]/2)}}return t}function oc(e,t){void 0===t&&(t={});var i=t,n=i.placement,s=void 0===n?e.placement:n,r=i.strategy,o=void 0===r?e.strategy:r,a=i.boundary,l=void 0===a?el:a,c=i.rootBoundary,h=void 0===c?tl:c,d=i.elementContext,u=void 0===d?il:d,p=i.altBoundary,f=void 0!==p&&p,m=i.padding,g=void 0===m?0:m,v=Hl("number"!=typeof g?g:Bl(g,Za)),_=u===il?nl:il,b=e.rects.popper,y=e.elements[f?_:u],C=function(e,t,i,n){var s="clippingParents"===t?function(e){var t=ic(Ll(e)),i=["absolute","fixed"].indexOf(Dl(e).position)>=0&&bl(e)?Pl(e):e;return _l(i)?t.filter((function(e){return _l(e)&&kl(e,i)&&"body"!==gl(e)})):[]}(e):[].concat(t),r=[].concat(s,[i]),o=r[0],a=r.reduce((function(t,i){var s=sc(e,i,n);return t.top=Sl(s.top,t.top),t.right=El(s.right,t.right),t.bottom=El(s.bottom,t.bottom),t.left=Sl(s.left,t.left),t}),sc(e,o,n));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}(_l(y)?y:y.contextElement||Rl(e.elements.popper),l,h,o),w=Ol(e.elements.reference),S=rc({reference:w,element:b,strategy:"absolute",placement:s}),E=nc(Object.assign({},b,S)),x=u===il?E:w,T={top:C.top-x.top+v.top,bottom:x.bottom-C.bottom+v.bottom,left:C.left-x.left+v.left,right:x.right-C.right+v.right},A=e.modifiersData.offset;if(u===il&&A){var O=A[s];Object.keys(T).forEach((function(e){var t=[Ka,Ga].indexOf(e)>=0?1:-1,i=[qa,Ga].indexOf(e)>=0?"y":"x";T[e]+=O[i]*t}))}return T}const ac={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,i=e.options,n=e.name;if(!t.modifiersData[n]._skip){for(var s=i.mainAxis,r=void 0===s||s,o=i.altAxis,a=void 0===o||o,l=i.fallbackPlacements,c=i.padding,h=i.boundary,d=i.rootBoundary,u=i.altBoundary,p=i.flipVariations,f=void 0===p||p,m=i.allowedAutoPlacements,g=t.options.placement,v=wl(g),_=l||(v!==g&&f?function(e){if(wl(e)===Xa)return[];var t=Yl(e);return[Zl(e),t,Zl(t)]}(g):[Yl(g)]),b=[g].concat(_).reduce((function(e,i){return e.concat(wl(i)===Xa?function(e,t){void 0===t&&(t={});var i=t,n=i.placement,s=i.boundary,r=i.rootBoundary,o=i.padding,a=i.flipVariations,l=i.allowedAutoPlacements,c=void 0===l?rl:l,h=Vl(n),d=h?a?sl:sl.filter((function(e){return Vl(e)===h})):Za,u=d.filter((function(e){return c.indexOf(e)>=0}));0===u.length&&(u=d);var p=u.reduce((function(t,i){return t[i]=oc(e,{placement:i,boundary:s,rootBoundary:r,padding:o})[wl(i)],t}),{});return Object.keys(p).sort((function(e,t){return p[e]-p[t]}))}(t,{placement:i,boundary:h,rootBoundary:d,padding:c,flipVariations:f,allowedAutoPlacements:m}):i)}),[]),y=t.rects.reference,C=t.rects.popper,w=new Map,S=!0,E=b[0],x=0;x<b.length;x++){var T=b[x],A=wl(T),O=Vl(T)===Qa,I=[qa,Ga].indexOf(A)>=0,k=I?"width":"height",D=oc(t,{placement:T,boundary:h,rootBoundary:d,altBoundary:u,padding:c}),j=I?O?Ka:Ya:O?Ga:qa;y[k]>C[k]&&(j=Yl(j));var R=Yl(j),L=[];if(r&&L.push(D[A]<=0),a&&L.push(D[j]<=0,D[R]<=0),L.every((function(e){return e}))){E=T,S=!1;break}w.set(T,L)}if(S)for(var M=function(e){var t=b.find((function(t){var i=w.get(t);if(i)return i.slice(0,e).every((function(e){return e}))}));if(t)return E=t,"break"},P=f?3:1;P>0&&"break"!==M(P);P--);t.placement!==E&&(t.modifiersData[n]._skip=!0,t.placement=E,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function lc(e,t,i){return void 0===i&&(i={x:0,y:0}),{top:e.top-t.height-i.y,right:e.right-t.width+i.x,bottom:e.bottom-t.height+i.y,left:e.left-t.width-i.x}}function cc(e){return[qa,Ka,Ga,Ya].some((function(t){return e[t]>=0}))}const hc={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,i=e.name,n=t.rects.reference,s=t.rects.popper,r=t.modifiersData.preventOverflow,o=oc(t,{elementContext:"reference"}),a=oc(t,{altBoundary:!0}),l=lc(o,n),c=lc(a,s,r),h=cc(l),d=cc(c);t.modifiersData[i]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:h,hasPopperEscaped:d},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":h,"data-popper-escaped":d})}},dc={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,i=e.options,n=e.name,s=i.offset,r=void 0===s?[0,0]:s,o=rl.reduce((function(e,i){return e[i]=function(e,t,i){var n=wl(e),s=[Ya,qa].indexOf(n)>=0?-1:1,r="function"==typeof i?i(Object.assign({},t,{placement:e})):i,o=r[0],a=r[1];return o=o||0,a=(a||0)*s,[Ya,Ka].indexOf(n)>=0?{x:a,y:o}:{x:o,y:a}}(i,t.rects,r),e}),{}),a=o[t.placement],l=a.x,c=a.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=c),t.modifiersData[n]=o}},uc={name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,i=e.name;t.modifiersData[i]=rc({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},pc={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,i=e.options,n=e.name,s=i.mainAxis,r=void 0===s||s,o=i.altAxis,a=void 0!==o&&o,l=i.boundary,c=i.rootBoundary,h=i.altBoundary,d=i.padding,u=i.tether,p=void 0===u||u,f=i.tetherOffset,m=void 0===f?0:f,g=oc(t,{boundary:l,rootBoundary:c,padding:d,altBoundary:h}),v=wl(t.placement),_=Vl(t.placement),b=!_,y=Nl(v),C="x"===y?"y":"x",w=t.modifiersData.popperOffsets,S=t.rects.reference,E=t.rects.popper,x="function"==typeof m?m(Object.assign({},t.rects,{placement:t.placement})):m,T="number"==typeof x?{mainAxis:x,altAxis:x}:Object.assign({mainAxis:0,altAxis:0},x),A=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,O={x:0,y:0};if(w){if(r){var I,k="y"===y?qa:Ya,D="y"===y?Ga:Ka,j="y"===y?"height":"width",R=w[y],L=R+g[k],M=R-g[D],P=p?-E[j]/2:0,N=_===Qa?S[j]:E[j],F=_===Qa?-E[j]:-S[j],H=t.elements.arrow,B=p&&H?Il(H):{width:0,height:0},z=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},V=z[k],W=z[D],$=Fl(0,S[j],B[j]),U=b?S[j]/2-P-$-V-T.mainAxis:N-$-V-T.mainAxis,q=b?-S[j]/2+P+$+W+T.mainAxis:F+$+W+T.mainAxis,G=t.elements.arrow&&Pl(t.elements.arrow),K=G?"y"===y?G.clientTop||0:G.clientLeft||0:0,Y=null!=(I=null==A?void 0:A[y])?I:0,X=R+q-Y,Z=Fl(p?El(L,R+U-Y-K):L,R,p?Sl(M,X):M);w[y]=Z,O[y]=Z-R}if(a){var Q,J="x"===y?qa:Ya,ee="x"===y?Ga:Ka,te=w[C],ie="y"===C?"height":"width",ne=te+g[J],se=te-g[ee],re=-1!==[qa,Ya].indexOf(v),oe=null!=(Q=null==A?void 0:A[C])?Q:0,ae=re?ne:te-S[ie]-E[ie]-oe+T.altAxis,le=re?te+S[ie]+E[ie]-oe-T.altAxis:se,ce=p&&re?function(e,t,i){var n=Fl(e,t,i);return n>i?i:n}(ae,te,le):Fl(p?ae:ne,te,p?le:se);w[C]=ce,O[C]=ce-te}t.modifiersData[n]=O}},requiresIfExists:["offset"]};function fc(e,t,i){void 0===i&&(i=!1);var n,s,r=bl(t),o=bl(t)&&function(e){var t=e.getBoundingClientRect(),i=xl(t.width)/e.offsetWidth||1,n=xl(t.height)/e.offsetHeight||1;return 1!==i||1!==n}(t),a=Rl(t),l=Ol(e,o,i),c={scrollLeft:0,scrollTop:0},h={x:0,y:0};return(r||!r&&!i)&&(("body"!==gl(t)||ec(a))&&(c=(n=t)!==vl(n)&&bl(n)?{scrollLeft:(s=n).scrollLeft,scrollTop:s.scrollTop}:Ql(n)),bl(t)?((h=Ol(t,!0)).x+=t.clientLeft,h.y+=t.clientTop):a&&(h.x=Jl(a))),{x:l.left+c.scrollLeft-h.x,y:l.top+c.scrollTop-h.y,width:l.width,height:l.height}}function mc(e){var t=new Map,i=new Set,n=[];function s(e){i.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!i.has(e)){var n=t.get(e);n&&s(n)}})),n.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){i.has(e.name)||s(e)})),n}var gc={placement:"bottom",modifiers:[],strategy:"absolute"};function vc(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return!t.some((function(e){return!(e&&"function"==typeof e.getBoundingClientRect)}))}function _c(e){void 0===e&&(e={});var t=e,i=t.defaultModifiers,n=void 0===i?[]:i,s=t.defaultOptions,r=void 0===s?gc:s;return function(e,t,i){void 0===i&&(i=r);var s,o,a={placement:"bottom",orderedModifiers:[],options:Object.assign({},gc,r),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},l=[],c=!1,h={state:a,setOptions:function(i){var s="function"==typeof i?i(a.options):i;d(),a.options=Object.assign({},r,a.options,s),a.scrollParents={reference:_l(e)?ic(e):e.contextElement?ic(e.contextElement):[],popper:ic(t)};var o,c,u=function(e){var t=mc(e);return ml.reduce((function(e,i){return e.concat(t.filter((function(e){return e.phase===i})))}),[])}((o=[].concat(n,a.options.modifiers),c=o.reduce((function(e,t){var i=e[t.name];return e[t.name]=i?Object.assign({},i,t,{options:Object.assign({},i.options,t.options),data:Object.assign({},i.data,t.data)}):t,e}),{}),Object.keys(c).map((function(e){return c[e]}))));return a.orderedModifiers=u.filter((function(e){return e.enabled})),a.orderedModifiers.forEach((function(e){var t=e.name,i=e.options,n=void 0===i?{}:i,s=e.effect;if("function"==typeof s){var r=s({state:a,name:t,instance:h,options:n});l.push(r||function(){})}})),h.update()},forceUpdate:function(){if(!c){var e=a.elements,t=e.reference,i=e.popper;if(vc(t,i)){a.rects={reference:fc(t,Pl(i),"fixed"===a.options.strategy),popper:Il(i)},a.reset=!1,a.placement=a.options.placement,a.orderedModifiers.forEach((function(e){return a.modifiersData[e.name]=Object.assign({},e.data)}));for(var n=0;n<a.orderedModifiers.length;n++)if(!0!==a.reset){var s=a.orderedModifiers[n],r=s.fn,o=s.options,l=void 0===o?{}:o,d=s.name;"function"==typeof r&&(a=r({state:a,options:l,name:d,instance:h})||a)}else a.reset=!1,n=-1}}},update:(s=function(){return new Promise((function(e){h.forceUpdate(),e(a)}))},function(){return o||(o=new Promise((function(e){Promise.resolve().then((function(){o=void 0,e(s())}))}))),o}),destroy:function(){d(),c=!0}};if(!vc(e,t))return h;function d(){l.forEach((function(e){return e()})),l=[]}return h.setOptions(i).then((function(e){!c&&i.onFirstUpdate&&i.onFirstUpdate(e)})),h}}var bc=_c(),yc=_c({defaultModifiers:[Gl,uc,Ul,Cl,dc,ac,pc,zl,hc]}),Cc=_c({defaultModifiers:[Gl,uc,Ul,Cl]});const wc="transitionend",Sc=e=>{let t=e.getAttribute("data-bs-target");if(!t||"#"===t){let i=e.getAttribute("href");if(!i||!i.includes("#")&&!i.startsWith("."))return null;i.includes("#")&&!i.startsWith("#")&&(i=`#${i.split("#")[1]}`),t=i&&"#"!==i?i.trim():null}return t},Ec=e=>{const t=Sc(e);return t&&document.querySelector(t)?t:null},xc=e=>{const t=Sc(e);return t?document.querySelector(t):null},Tc=e=>{e.dispatchEvent(new Event(wc))},Ac=e=>!(!e||"object"!=typeof e)&&(void 0!==e.jquery&&(e=e[0]),void 0!==e.nodeType),Oc=e=>Ac(e)?e.jquery?e[0]:e:"string"==typeof e&&e.length>0?document.querySelector(e):null,Ic=e=>{if(!Ac(e)||0===e.getClientRects().length)return!1;const t="visible"===getComputedStyle(e).getPropertyValue("visibility"),i=e.closest("details:not([open])");if(!i)return t;if(i!==e){const t=e.closest("summary");if(t&&t.parentNode!==i)return!1;if(null===t)return!1}return t},kc=e=>!e||e.nodeType!==Node.ELEMENT_NODE||!!e.classList.contains("disabled")||(void 0!==e.disabled?e.disabled:e.hasAttribute("disabled")&&"false"!==e.getAttribute("disabled")),Dc=e=>{if(!document.documentElement.attachShadow)return null;if("function"==typeof e.getRootNode){const t=e.getRootNode();return t instanceof ShadowRoot?t:null}return e instanceof ShadowRoot?e:e.parentNode?Dc(e.parentNode):null},jc=()=>{},Rc=e=>{e.offsetHeight},Lc=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Mc=[],Pc=()=>"rtl"===document.documentElement.dir,Nc=e=>{var t;t=()=>{const t=Lc();if(t){const i=e.NAME,n=t.fn[i];t.fn[i]=e.jQueryInterface,t.fn[i].Constructor=e,t.fn[i].noConflict=()=>(t.fn[i]=n,e.jQueryInterface)}},"loading"===document.readyState?(Mc.length||document.addEventListener("DOMContentLoaded",(()=>{for(const e of Mc)e()})),Mc.push(t)):t()},Fc=e=>{"function"==typeof e&&e()},Hc=(e,t,i=!0)=>{if(!i)return void Fc(e);const n=(e=>{if(!e)return 0;let{transitionDuration:t,transitionDelay:i}=window.getComputedStyle(e);const n=Number.parseFloat(t),s=Number.parseFloat(i);return n||s?(t=t.split(",")[0],i=i.split(",")[0],1e3*(Number.parseFloat(t)+Number.parseFloat(i))):0})(t)+5;let s=!1;const r=({target:i})=>{i===t&&(s=!0,t.removeEventListener(wc,r),Fc(e))};t.addEventListener(wc,r),setTimeout((()=>{s||Tc(t)}),n)},Bc=(e,t,i,n)=>{const s=e.length;let r=e.indexOf(t);return-1===r?!i&&n?e[s-1]:e[0]:(r+=i?1:-1,n&&(r=(r+s)%s),e[Math.max(0,Math.min(r,s-1))])},zc=/[^.]*(?=\..*)\.|.*/,Vc=/\..*/,Wc=/::\d+$/,$c={};let Uc=1;const qc={mouseenter:"mouseover",mouseleave:"mouseout"},Gc=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Kc(e,t){return t&&`${t}::${Uc++}`||e.uidEvent||Uc++}function Yc(e){const t=Kc(e);return e.uidEvent=t,$c[t]=$c[t]||{},$c[t]}function Xc(e,t,i=null){return Object.values(e).find((e=>e.callable===t&&e.delegationSelector===i))}function Zc(e,t,i){const n="string"==typeof t,s=n?i:t||i;let r=th(e);return Gc.has(r)||(r=e),[n,s,r]}function Qc(e,t,i,n,s){if("string"!=typeof t||!e)return;let[r,o,a]=Zc(t,i,n);if(t in qc){const e=e=>function(t){if(!t.relatedTarget||t.relatedTarget!==t.delegateTarget&&!t.delegateTarget.contains(t.relatedTarget))return e.call(this,t)};o=e(o)}const l=Yc(e),c=l[a]||(l[a]={}),h=Xc(c,o,r?i:null);if(h)return void(h.oneOff=h.oneOff&&s);const d=Kc(o,t.replace(zc,"")),u=r?function(e,t,i){return function n(s){const r=e.querySelectorAll(t);for(let{target:o}=s;o&&o!==this;o=o.parentNode)for(const a of r)if(a===o)return nh(s,{delegateTarget:o}),n.oneOff&&ih.off(e,s.type,t,i),i.apply(o,[s])}}(e,i,o):function(e,t){return function i(n){return nh(n,{delegateTarget:e}),i.oneOff&&ih.off(e,n.type,t),t.apply(e,[n])}}(e,o);u.delegationSelector=r?i:null,u.callable=o,u.oneOff=s,u.uidEvent=d,c[d]=u,e.addEventListener(a,u,r)}function Jc(e,t,i,n,s){const r=Xc(t[i],n,s);r&&(e.removeEventListener(i,r,Boolean(s)),delete t[i][r.uidEvent])}function eh(e,t,i,n){const s=t[i]||{};for(const r of Object.keys(s))if(r.includes(n)){const n=s[r];Jc(e,t,i,n.callable,n.delegationSelector)}}function th(e){return e=e.replace(Vc,""),qc[e]||e}const ih={on(e,t,i,n){Qc(e,t,i,n,!1)},one(e,t,i,n){Qc(e,t,i,n,!0)},off(e,t,i,n){if("string"!=typeof t||!e)return;const[s,r,o]=Zc(t,i,n),a=o!==t,l=Yc(e),c=l[o]||{},h=t.startsWith(".");if(void 0===r){if(h)for(const i of Object.keys(l))eh(e,l,i,t.slice(1));for(const i of Object.keys(c)){const n=i.replace(Wc,"");if(!a||t.includes(n)){const t=c[i];Jc(e,l,o,t.callable,t.delegationSelector)}}}else{if(!Object.keys(c).length)return;Jc(e,l,o,r,s?i:null)}},trigger(e,t,i){if("string"!=typeof t||!e)return null;const n=Lc();let s=null,r=!0,o=!0,a=!1;t!==th(t)&&n&&(s=n.Event(t,i),n(e).trigger(s),r=!s.isPropagationStopped(),o=!s.isImmediatePropagationStopped(),a=s.isDefaultPrevented());let l=new Event(t,{bubbles:r,cancelable:!0});return l=nh(l,i),a&&l.preventDefault(),o&&e.dispatchEvent(l),l.defaultPrevented&&s&&s.preventDefault(),l}};function nh(e,t){for(const[i,n]of Object.entries(t||{}))try{e[i]=n}catch(t){Object.defineProperty(e,i,{configurable:!0,get:()=>n})}return e}const sh=new Map,rh={set(e,t,i){sh.has(e)||sh.set(e,new Map);const n=sh.get(e);n.has(t)||0===n.size?n.set(t,i):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(n.keys())[0]}.`)},get:(e,t)=>sh.has(e)&&sh.get(e).get(t)||null,remove(e,t){if(!sh.has(e))return;const i=sh.get(e);i.delete(t),0===i.size&&sh.delete(e)}};function oh(e){if("true"===e)return!0;if("false"===e)return!1;if(e===Number(e).toString())return Number(e);if(""===e||"null"===e)return null;if("string"!=typeof e)return e;try{return JSON.parse(decodeURIComponent(e))}catch(t){return e}}function ah(e){return e.replace(/[A-Z]/g,(e=>`-${e.toLowerCase()}`))}const lh={setDataAttribute(e,t,i){e.setAttribute(`data-bs-${ah(t)}`,i)},removeDataAttribute(e,t){e.removeAttribute(`data-bs-${ah(t)}`)},getDataAttributes(e){if(!e)return{};const t={},i=Object.keys(e.dataset).filter((e=>e.startsWith("bs")&&!e.startsWith("bsConfig")));for(const n of i){let i=n.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1,i.length),t[i]=oh(e.dataset[n])}return t},getDataAttribute:(e,t)=>oh(e.getAttribute(`data-bs-${ah(t)}`))};class ch{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,t){const i=Ac(t)?lh.getDataAttribute(t,"config"):{};return{...this.constructor.Default,..."object"==typeof i?i:{},...Ac(t)?lh.getDataAttributes(t):{},..."object"==typeof e?e:{}}}_typeCheckConfig(e,t=this.constructor.DefaultType){for(const n of Object.keys(t)){const s=t[n],r=e[n],o=Ac(r)?"element":null==(i=r)?`${i}`:Object.prototype.toString.call(i).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(s).test(o))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${n}" provided type "${o}" but expected type "${s}".`)}var i}}class hh extends ch{constructor(e,t){super(),(e=Oc(e))&&(this._element=e,this._config=this._getConfig(t),rh.set(this._element,this.constructor.DATA_KEY,this))}dispose(){rh.remove(this._element,this.constructor.DATA_KEY),ih.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,t,i=!0){Hc(e,t,i)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return rh.get(Oc(e),this.DATA_KEY)}static getOrCreateInstance(e,t={}){return this.getInstance(e)||new this(e,"object"==typeof t?t:null)}static get VERSION(){return"5.2.3"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const dh=(e,t="hide")=>{const i=`click.dismiss${e.EVENT_KEY}`,n=e.NAME;ih.on(document,i,`[data-bs-dismiss="${n}"]`,(function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),kc(this))return;const s=xc(this)||this.closest(`.${n}`);e.getOrCreateInstance(s)[t]()}))},uh=".bs.alert",ph=`close${uh}`,fh=`closed${uh}`;class mh extends hh{static get NAME(){return"alert"}close(){if(ih.trigger(this._element,ph).defaultPrevented)return;this._element.classList.remove("show");const e=this._element.classList.contains("fade");this._queueCallback((()=>this._destroyElement()),this._element,e)}_destroyElement(){this._element.remove(),ih.trigger(this._element,fh),this.dispose()}static jQueryInterface(e){return this.each((function(){const t=mh.getOrCreateInstance(this);if("string"==typeof e){if(void 0===t[e]||e.startsWith("_")||"constructor"===e)throw new TypeError(`No method named "${e}"`);t[e](this)}}))}}dh(mh,"close"),Nc(mh);const gh='[data-bs-toggle="button"]';class vh extends hh{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(e){return this.each((function(){const t=vh.getOrCreateInstance(this);"toggle"===e&&t[e]()}))}}ih.on(document,"click.bs.button.data-api",gh,(e=>{e.preventDefault();const t=e.target.closest(gh);vh.getOrCreateInstance(t).toggle()})),Nc(vh);const _h={find:(e,t=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(t,e)),findOne:(e,t=document.documentElement)=>Element.prototype.querySelector.call(t,e),children:(e,t)=>[].concat(...e.children).filter((e=>e.matches(t))),parents(e,t){const i=[];let n=e.parentNode.closest(t);for(;n;)i.push(n),n=n.parentNode.closest(t);return i},prev(e,t){let i=e.previousElementSibling;for(;i;){if(i.matches(t))return[i];i=i.previousElementSibling}return[]},next(e,t){let i=e.nextElementSibling;for(;i;){if(i.matches(t))return[i];i=i.nextElementSibling}return[]},focusableChildren(e){const t=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map((e=>`${e}:not([tabindex^="-"])`)).join(",");return this.find(t,e).filter((e=>!kc(e)&&Ic(e)))}},bh=".bs.swipe",yh=`touchstart${bh}`,Ch=`touchmove${bh}`,wh=`touchend${bh}`,Sh=`pointerdown${bh}`,Eh=`pointerup${bh}`,xh={endCallback:null,leftCallback:null,rightCallback:null},Th={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class Ah extends ch{constructor(e,t){super(),this._element=e,e&&Ah.isSupported()&&(this._config=this._getConfig(t),this._deltaX=0,this._supportPointerEvents=Boolean(window.PointerEvent),this._initEvents())}static get Default(){return xh}static get DefaultType(){return Th}static get NAME(){return"swipe"}dispose(){ih.off(this._element,bh)}_start(e){this._supportPointerEvents?this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX):this._deltaX=e.touches[0].clientX}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Fc(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=40)return;const t=e/this._deltaX;this._deltaX=0,t&&Fc(t>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(ih.on(this._element,Sh,(e=>this._start(e))),ih.on(this._element,Eh,(e=>this._end(e))),this._element.classList.add("pointer-event")):(ih.on(this._element,yh,(e=>this._start(e))),ih.on(this._element,Ch,(e=>this._move(e))),ih.on(this._element,wh,(e=>this._end(e))))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&("pen"===e.pointerType||"touch"===e.pointerType)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const Oh=".bs.carousel",Ih=".data-api",kh="ArrowLeft",Dh="ArrowRight",jh="next",Rh="prev",Lh="left",Mh="right",Ph=`slide${Oh}`,Nh=`slid${Oh}`,Fh=`keydown${Oh}`,Hh=`mouseenter${Oh}`,Bh=`mouseleave${Oh}`,zh=`dragstart${Oh}`,Vh=`load${Oh}${Ih}`,Wh=`click${Oh}${Ih}`,$h="carousel",Uh="active",qh=".active",Gh=".carousel-item",Kh=qh+Gh,Yh={[kh]:Mh,[Dh]:Lh},Xh={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Zh={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Qh extends hh{constructor(e,t){super(e,t),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=_h.findOne(".carousel-indicators",this._element),this._addEventListeners(),this._config.ride===$h&&this.cycle()}static get Default(){return Xh}static get DefaultType(){return Zh}static get NAME(){return"carousel"}next(){this._slide(jh)}nextWhenVisible(){!document.hidden&&Ic(this._element)&&this.next()}prev(){this._slide(Rh)}pause(){this._isSliding&&Tc(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval((()=>this.nextWhenVisible()),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?ih.one(this._element,Nh,(()=>this.cycle())):this.cycle())}to(e){const t=this._getItems();if(e>t.length-1||e<0)return;if(this._isSliding)return void ih.one(this._element,Nh,(()=>this.to(e)));const i=this._getItemIndex(this._getActive());if(i===e)return;const n=e>i?jh:Rh;this._slide(n,t[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&ih.on(this._element,Fh,(e=>this._keydown(e))),"hover"===this._config.pause&&(ih.on(this._element,Hh,(()=>this.pause())),ih.on(this._element,Bh,(()=>this._maybeEnableCycle()))),this._config.touch&&Ah.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const e of _h.find(".carousel-item img",this._element))ih.on(e,zh,(e=>e.preventDefault()));const e={leftCallback:()=>this._slide(this._directionToOrder(Lh)),rightCallback:()=>this._slide(this._directionToOrder(Mh)),endCallback:()=>{"hover"===this._config.pause&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout((()=>this._maybeEnableCycle()),500+this._config.interval))}};this._swipeHelper=new Ah(this._element,e)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const t=Yh[e.key];t&&(e.preventDefault(),this._slide(this._directionToOrder(t)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const t=_h.findOne(qh,this._indicatorsElement);t.classList.remove(Uh),t.removeAttribute("aria-current");const i=_h.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);i&&(i.classList.add(Uh),i.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const t=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=t||this._config.defaultInterval}_slide(e,t=null){if(this._isSliding)return;const i=this._getActive(),n=e===jh,s=t||Bc(this._getItems(),i,n,this._config.wrap);if(s===i)return;const r=this._getItemIndex(s),o=t=>ih.trigger(this._element,t,{relatedTarget:s,direction:this._orderToDirection(e),from:this._getItemIndex(i),to:r});if(o(Ph).defaultPrevented)return;if(!i||!s)return;const a=Boolean(this._interval);this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(r),this._activeElement=s;const l=n?"carousel-item-start":"carousel-item-end",c=n?"carousel-item-next":"carousel-item-prev";s.classList.add(c),Rc(s),i.classList.add(l),s.classList.add(l),this._queueCallback((()=>{s.classList.remove(l,c),s.classList.add(Uh),i.classList.remove(Uh,c,l),this._isSliding=!1,o(Nh)}),i,this._isAnimated()),a&&this.cycle()}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return _h.findOne(Kh,this._element)}_getItems(){return _h.find(Gh,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return Pc()?e===Lh?Rh:jh:e===Lh?jh:Rh}_orderToDirection(e){return Pc()?e===Rh?Lh:Mh:e===Rh?Mh:Lh}static jQueryInterface(e){return this.each((function(){const t=Qh.getOrCreateInstance(this,e);if("number"!=typeof e){if("string"==typeof e){if(void 0===t[e]||e.startsWith("_")||"constructor"===e)throw new TypeError(`No method named "${e}"`);t[e]()}}else t.to(e)}))}}ih.on(document,Wh,"[data-bs-slide], [data-bs-slide-to]",(function(e){const t=xc(this);if(!t||!t.classList.contains($h))return;e.preventDefault();const i=Qh.getOrCreateInstance(t),n=this.getAttribute("data-bs-slide-to");return n?(i.to(n),void i._maybeEnableCycle()):"next"===lh.getDataAttribute(this,"slide")?(i.next(),void i._maybeEnableCycle()):(i.prev(),void i._maybeEnableCycle())})),ih.on(window,Vh,(()=>{const e=_h.find('[data-bs-ride="carousel"]');for(const t of e)Qh.getOrCreateInstance(t)})),Nc(Qh);const Jh=".bs.collapse",ed=`show${Jh}`,td=`shown${Jh}`,id=`hide${Jh}`,nd=`hidden${Jh}`,sd=`click${Jh}.data-api`,rd="show",od="collapse",ad="collapsing",ld=`:scope .${od} .${od}`,cd='[data-bs-toggle="collapse"]',hd={parent:null,toggle:!0},dd={parent:"(null|element)",toggle:"boolean"};class ud extends hh{constructor(e,t){super(e,t),this._isTransitioning=!1,this._triggerArray=[];const i=_h.find(cd);for(const e of i){const t=Ec(e),i=_h.find(t).filter((e=>e===this._element));null!==t&&i.length&&this._triggerArray.push(e)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return hd}static get DefaultType(){return dd}static get NAME(){return"collapse"}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter((e=>e!==this._element)).map((e=>ud.getOrCreateInstance(e,{toggle:!1})))),e.length&&e[0]._isTransitioning)return;if(ih.trigger(this._element,ed).defaultPrevented)return;for(const t of e)t.hide();const t=this._getDimension();this._element.classList.remove(od),this._element.classList.add(ad),this._element.style[t]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=`scroll${t[0].toUpperCase()+t.slice(1)}`;this._queueCallback((()=>{this._isTransitioning=!1,this._element.classList.remove(ad),this._element.classList.add(od,rd),this._element.style[t]="",ih.trigger(this._element,td)}),this._element,!0),this._element.style[t]=`${this._element[i]}px`}hide(){if(this._isTransitioning||!this._isShown())return;if(ih.trigger(this._element,id).defaultPrevented)return;const e=this._getDimension();this._element.style[e]=`${this._element.getBoundingClientRect()[e]}px`,Rc(this._element),this._element.classList.add(ad),this._element.classList.remove(od,rd);for(const e of this._triggerArray){const t=xc(e);t&&!this._isShown(t)&&this._addAriaAndCollapsedClass([e],!1)}this._isTransitioning=!0,this._element.style[e]="",this._queueCallback((()=>{this._isTransitioning=!1,this._element.classList.remove(ad),this._element.classList.add(od),ih.trigger(this._element,nd)}),this._element,!0)}_isShown(e=this._element){return e.classList.contains(rd)}_configAfterMerge(e){return e.toggle=Boolean(e.toggle),e.parent=Oc(e.parent),e}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(cd);for(const t of e){const e=xc(t);e&&this._addAriaAndCollapsedClass([t],this._isShown(e))}}_getFirstLevelChildren(e){const t=_h.find(ld,this._config.parent);return _h.find(e,this._config.parent).filter((e=>!t.includes(e)))}_addAriaAndCollapsedClass(e,t){if(e.length)for(const i of e)i.classList.toggle("collapsed",!t),i.setAttribute("aria-expanded",t)}static jQueryInterface(e){const t={};return"string"==typeof e&&/show|hide/.test(e)&&(t.toggle=!1),this.each((function(){const i=ud.getOrCreateInstance(this,t);if("string"==typeof e){if(void 0===i[e])throw new TypeError(`No method named "${e}"`);i[e]()}}))}}ih.on(document,sd,cd,(function(e){("A"===e.target.tagName||e.delegateTarget&&"A"===e.delegateTarget.tagName)&&e.preventDefault();const t=Ec(this),i=_h.find(t);for(const e of i)ud.getOrCreateInstance(e,{toggle:!1}).toggle()})),Nc(ud);const pd="dropdown",fd=".bs.dropdown",md=".data-api",gd="ArrowUp",vd="ArrowDown",_d=`hide${fd}`,bd=`hidden${fd}`,yd=`show${fd}`,Cd=`shown${fd}`,wd=`click${fd}${md}`,Sd=`keydown${fd}${md}`,Ed=`keyup${fd}${md}`,xd="show",Td='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',Ad=`${Td}.${xd}`,Od=".dropdown-menu",Id=Pc()?"top-end":"top-start",kd=Pc()?"top-start":"top-end",Dd=Pc()?"bottom-end":"bottom-start",jd=Pc()?"bottom-start":"bottom-end",Rd=Pc()?"left-start":"right-start",Ld=Pc()?"right-start":"left-start",Md={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Pd={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Nd extends hh{constructor(e,t){super(e,t),this._popper=null,this._parent=this._element.parentNode,this._menu=_h.next(this._element,Od)[0]||_h.prev(this._element,Od)[0]||_h.findOne(Od,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Md}static get DefaultType(){return Pd}static get NAME(){return pd}toggle(){return this._isShown()?this.hide():this.show()}show(){if(kc(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!ih.trigger(this._element,yd,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(const e of[].concat(...document.body.children))ih.on(e,"mouseover",jc);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(xd),this._element.classList.add(xd),ih.trigger(this._element,Cd,e)}}hide(){if(kc(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!ih.trigger(this._element,_d,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const e of[].concat(...document.body.children))ih.off(e,"mouseover",jc);this._popper&&this._popper.destroy(),this._menu.classList.remove(xd),this._element.classList.remove(xd),this._element.setAttribute("aria-expanded","false"),lh.removeDataAttribute(this._menu,"popper"),ih.trigger(this._element,bd,e)}}_getConfig(e){if("object"==typeof(e=super._getConfig(e)).reference&&!Ac(e.reference)&&"function"!=typeof e.reference.getBoundingClientRect)throw new TypeError(`${pd.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){let e=this._element;"parent"===this._config.reference?e=this._parent:Ac(this._config.reference)?e=Oc(this._config.reference):"object"==typeof this._config.reference&&(e=this._config.reference);const t=this._getPopperConfig();this._popper=yc(e,this._menu,t)}_isShown(){return this._menu.classList.contains(xd)}_getPlacement(){const e=this._parent;if(e.classList.contains("dropend"))return Rd;if(e.classList.contains("dropstart"))return Ld;if(e.classList.contains("dropup-center"))return"top";if(e.classList.contains("dropdown-center"))return"bottom";const t="end"===getComputedStyle(this._menu).getPropertyValue("--bs-position").trim();return e.classList.contains("dropup")?t?kd:Id:t?jd:Dd}_detectNavbar(){return null!==this._element.closest(".navbar")}_getOffset(){const{offset:e}=this._config;return"string"==typeof e?e.split(",").map((e=>Number.parseInt(e,10))):"function"==typeof e?t=>e(t,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||"static"===this._config.display)&&(lh.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,..."function"==typeof this._config.popperConfig?this._config.popperConfig(e):this._config.popperConfig}}_selectMenuItem({key:e,target:t}){const i=_h.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter((e=>Ic(e)));i.length&&Bc(i,t,e===vd,!i.includes(t)).focus()}static jQueryInterface(e){return this.each((function(){const t=Nd.getOrCreateInstance(this,e);if("string"==typeof e){if(void 0===t[e])throw new TypeError(`No method named "${e}"`);t[e]()}}))}static clearMenus(e){if(2===e.button||"keyup"===e.type&&"Tab"!==e.key)return;const t=_h.find(Ad);for(const i of t){const t=Nd.getInstance(i);if(!t||!1===t._config.autoClose)continue;const n=e.composedPath(),s=n.includes(t._menu);if(n.includes(t._element)||"inside"===t._config.autoClose&&!s||"outside"===t._config.autoClose&&s)continue;if(t._menu.contains(e.target)&&("keyup"===e.type&&"Tab"===e.key||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const r={relatedTarget:t._element};"click"===e.type&&(r.clickEvent=e),t._completeHide(r)}}static dataApiKeydownHandler(e){const t=/input|textarea/i.test(e.target.tagName),i="Escape"===e.key,n=[gd,vd].includes(e.key);if(!n&&!i)return;if(t&&!i)return;e.preventDefault();const s=this.matches(Td)?this:_h.prev(this,Td)[0]||_h.next(this,Td)[0]||_h.findOne(Td,e.delegateTarget.parentNode),r=Nd.getOrCreateInstance(s);if(n)return e.stopPropagation(),r.show(),void r._selectMenuItem(e);r._isShown()&&(e.stopPropagation(),r.hide(),s.focus())}}ih.on(document,Sd,Td,Nd.dataApiKeydownHandler),ih.on(document,Sd,Od,Nd.dataApiKeydownHandler),ih.on(document,wd,Nd.clearMenus),ih.on(document,Ed,Nd.clearMenus),ih.on(document,wd,Td,(function(e){e.preventDefault(),Nd.getOrCreateInstance(this).toggle()})),Nc(Nd);const Fd=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Hd=".sticky-top",Bd="padding-right",zd="margin-right";class Vd{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Bd,(t=>t+e)),this._setElementAttributes(Fd,Bd,(t=>t+e)),this._setElementAttributes(Hd,zd,(t=>t-e))}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Bd),this._resetElementAttributes(Fd,Bd),this._resetElementAttributes(Hd,zd)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,t,i){const n=this.getWidth();this._applyManipulationCallback(e,(e=>{if(e!==this._element&&window.innerWidth>e.clientWidth+n)return;this._saveInitialAttribute(e,t);const s=window.getComputedStyle(e).getPropertyValue(t);e.style.setProperty(t,`${i(Number.parseFloat(s))}px`)}))}_saveInitialAttribute(e,t){const i=e.style.getPropertyValue(t);i&&lh.setDataAttribute(e,t,i)}_resetElementAttributes(e,t){this._applyManipulationCallback(e,(e=>{const i=lh.getDataAttribute(e,t);null!==i?(lh.removeDataAttribute(e,t),e.style.setProperty(t,i)):e.style.removeProperty(t)}))}_applyManipulationCallback(e,t){if(Ac(e))t(e);else for(const i of _h.find(e,this._element))t(i)}}const Wd="backdrop",$d="show",Ud=`mousedown.bs.${Wd}`,qd={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Gd={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Kd extends ch{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return qd}static get DefaultType(){return Gd}static get NAME(){return Wd}show(e){if(!this._config.isVisible)return void Fc(e);this._append();const t=this._getElement();this._config.isAnimated&&Rc(t),t.classList.add($d),this._emulateAnimation((()=>{Fc(e)}))}hide(e){this._config.isVisible?(this._getElement().classList.remove($d),this._emulateAnimation((()=>{this.dispose(),Fc(e)}))):Fc(e)}dispose(){this._isAppended&&(ih.off(this._element,Ud),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add("fade"),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=Oc(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),ih.on(e,Ud,(()=>{Fc(this._config.clickCallback)})),this._isAppended=!0}_emulateAnimation(e){Hc(e,this._getElement(),this._config.isAnimated)}}const Yd=".bs.focustrap",Xd=`focusin${Yd}`,Zd=`keydown.tab${Yd}`,Qd="backward",Jd={autofocus:!0,trapElement:null},eu={autofocus:"boolean",trapElement:"element"};class tu extends ch{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Jd}static get DefaultType(){return eu}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),ih.off(document,Yd),ih.on(document,Xd,(e=>this._handleFocusin(e))),ih.on(document,Zd,(e=>this._handleKeydown(e))),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,ih.off(document,Yd))}_handleFocusin(e){const{trapElement:t}=this._config;if(e.target===document||e.target===t||t.contains(e.target))return;const i=_h.focusableChildren(t);0===i.length?t.focus():this._lastTabNavDirection===Qd?i[i.length-1].focus():i[0].focus()}_handleKeydown(e){"Tab"===e.key&&(this._lastTabNavDirection=e.shiftKey?Qd:"forward")}}const iu=".bs.modal",nu=`hide${iu}`,su=`hidePrevented${iu}`,ru=`hidden${iu}`,ou=`show${iu}`,au=`shown${iu}`,lu=`resize${iu}`,cu=`click.dismiss${iu}`,hu=`mousedown.dismiss${iu}`,du=`keydown.dismiss${iu}`,uu=`click${iu}.data-api`,pu="modal-open",fu="show",mu="modal-static",gu={backdrop:!0,focus:!0,keyboard:!0},vu={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class _u extends hh{constructor(e,t){super(e,t),this._dialog=_h.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Vd,this._addEventListeners()}static get Default(){return gu}static get DefaultType(){return vu}static get NAME(){return"modal"}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||ih.trigger(this._element,ou,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(pu),this._adjustDialog(),this._backdrop.show((()=>this._showElement(e))))}hide(){this._isShown&&!this._isTransitioning&&(ih.trigger(this._element,nu).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(fu),this._queueCallback((()=>this._hideModal()),this._element,this._isAnimated())))}dispose(){for(const e of[window,this._dialog])ih.off(e,iu);this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Kd({isVisible:Boolean(this._config.backdrop),isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new tu({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const t=_h.findOne(".modal-body",this._dialog);t&&(t.scrollTop=0),Rc(this._element),this._element.classList.add(fu),this._queueCallback((()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,ih.trigger(this._element,au,{relatedTarget:e})}),this._dialog,this._isAnimated())}_addEventListeners(){ih.on(this._element,du,(e=>{if("Escape"===e.key)return this._config.keyboard?(e.preventDefault(),void this.hide()):void this._triggerBackdropTransition()})),ih.on(window,lu,(()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()})),ih.on(this._element,hu,(e=>{ih.one(this._element,cu,(t=>{this._element===e.target&&this._element===t.target&&("static"!==this._config.backdrop?this._config.backdrop&&this.hide():this._triggerBackdropTransition())}))}))}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide((()=>{document.body.classList.remove(pu),this._resetAdjustments(),this._scrollBar.reset(),ih.trigger(this._element,ru)}))}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(ih.trigger(this._element,su).defaultPrevented)return;const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._element.style.overflowY;"hidden"===t||this._element.classList.contains(mu)||(e||(this._element.style.overflowY="hidden"),this._element.classList.add(mu),this._queueCallback((()=>{this._element.classList.remove(mu),this._queueCallback((()=>{this._element.style.overflowY=t}),this._dialog)}),this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._scrollBar.getWidth(),i=t>0;if(i&&!e){const e=Pc()?"paddingLeft":"paddingRight";this._element.style[e]=`${t}px`}if(!i&&e){const e=Pc()?"paddingRight":"paddingLeft";this._element.style[e]=`${t}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,t){return this.each((function(){const i=_u.getOrCreateInstance(this,e);if("string"==typeof e){if(void 0===i[e])throw new TypeError(`No method named "${e}"`);i[e](t)}}))}}ih.on(document,uu,'[data-bs-toggle="modal"]',(function(e){const t=xc(this);["A","AREA"].includes(this.tagName)&&e.preventDefault(),ih.one(t,ou,(e=>{e.defaultPrevented||ih.one(t,ru,(()=>{Ic(this)&&this.focus()}))}));const i=_h.findOne(".modal.show");i&&_u.getInstance(i).hide(),_u.getOrCreateInstance(t).toggle(this)})),dh(_u),Nc(_u);const bu=".bs.offcanvas",yu=".data-api",Cu=`load${bu}${yu}`,wu="show",Su="showing",Eu="hiding",xu=".offcanvas.show",Tu=`show${bu}`,Au=`shown${bu}`,Ou=`hide${bu}`,Iu=`hidePrevented${bu}`,ku=`hidden${bu}`,Du=`resize${bu}`,ju=`click${bu}${yu}`,Ru=`keydown.dismiss${bu}`,Lu={backdrop:!0,keyboard:!0,scroll:!1},Mu={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Pu extends hh{constructor(e,t){super(e,t),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return Lu}static get DefaultType(){return Mu}static get NAME(){return"offcanvas"}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||ih.trigger(this._element,Tu,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._backdrop.show(),this._config.scroll||(new Vd).hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(Su),this._queueCallback((()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate(),this._element.classList.add(wu),this._element.classList.remove(Su),ih.trigger(this._element,Au,{relatedTarget:e})}),this._element,!0))}hide(){this._isShown&&(ih.trigger(this._element,Ou).defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(Eu),this._backdrop.hide(),this._queueCallback((()=>{this._element.classList.remove(wu,Eu),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||(new Vd).reset(),ih.trigger(this._element,ku)}),this._element,!0)))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=Boolean(this._config.backdrop);return new Kd({className:"offcanvas-backdrop",isVisible:e,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:e?()=>{"static"!==this._config.backdrop?this.hide():ih.trigger(this._element,Iu)}:null})}_initializeFocusTrap(){return new tu({trapElement:this._element})}_addEventListeners(){ih.on(this._element,Ru,(e=>{"Escape"===e.key&&(this._config.keyboard?this.hide():ih.trigger(this._element,Iu))}))}static jQueryInterface(e){return this.each((function(){const t=Pu.getOrCreateInstance(this,e);if("string"==typeof e){if(void 0===t[e]||e.startsWith("_")||"constructor"===e)throw new TypeError(`No method named "${e}"`);t[e](this)}}))}}ih.on(document,ju,'[data-bs-toggle="offcanvas"]',(function(e){const t=xc(this);if(["A","AREA"].includes(this.tagName)&&e.preventDefault(),kc(this))return;ih.one(t,ku,(()=>{Ic(this)&&this.focus()}));const i=_h.findOne(xu);i&&i!==t&&Pu.getInstance(i).hide(),Pu.getOrCreateInstance(t).toggle(this)})),ih.on(window,Cu,(()=>{for(const e of _h.find(xu))Pu.getOrCreateInstance(e).show()})),ih.on(window,Du,(()=>{for(const e of _h.find("[aria-modal][class*=show][class*=offcanvas-]"))"fixed"!==getComputedStyle(e).position&&Pu.getOrCreateInstance(e).hide()})),dh(Pu),Nc(Pu);const Nu=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),Fu=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^#&/:?]*(?:[#/?]|$))/i,Hu=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i,Bu=(e,t)=>{const i=e.nodeName.toLowerCase();return t.includes(i)?!Nu.has(i)||Boolean(Fu.test(e.nodeValue)||Hu.test(e.nodeValue)):t.filter((e=>e instanceof RegExp)).some((e=>e.test(i)))},zu={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},Vu={allowList:zu,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},Wu={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},$u={entry:"(string|element|function|null)",selector:"(string|element)"};class Uu extends ch{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return Vu}static get DefaultType(){return Wu}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map((e=>this._resolvePossibleFunction(e))).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[t,i]of Object.entries(this._config.content))this._setContent(e,i,t);const t=e.children[0],i=this._resolvePossibleFunction(this._config.extraClass);return i&&t.classList.add(...i.split(" ")),t}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[t,i]of Object.entries(e))super._typeCheckConfig({selector:t,entry:i},$u)}_setContent(e,t,i){const n=_h.findOne(i,e);n&&((t=this._resolvePossibleFunction(t))?Ac(t)?this._putElementInTemplate(Oc(t),n):this._config.html?n.innerHTML=this._maybeSanitize(t):n.textContent=t:n.remove())}_maybeSanitize(e){return this._config.sanitize?function(e,t,i){if(!e.length)return e;if(i&&"function"==typeof i)return i(e);const n=(new window.DOMParser).parseFromString(e,"text/html"),s=[].concat(...n.body.querySelectorAll("*"));for(const e of s){const i=e.nodeName.toLowerCase();if(!Object.keys(t).includes(i)){e.remove();continue}const n=[].concat(...e.attributes),s=[].concat(t["*"]||[],t[i]||[]);for(const t of n)Bu(t,s)||e.removeAttribute(t.nodeName)}return n.body.innerHTML}(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return"function"==typeof e?e(this):e}_putElementInTemplate(e,t){if(this._config.html)return t.innerHTML="",void t.append(e);t.textContent=e.textContent}}const qu=new Set(["sanitize","allowList","sanitizeFn"]),Gu="fade",Ku="show",Yu=".tooltip-inner",Xu=".modal",Zu="hide.bs.modal",Qu="hover",Ju="focus",ep={AUTO:"auto",TOP:"top",RIGHT:Pc()?"left":"right",BOTTOM:"bottom",LEFT:Pc()?"right":"left"},tp={allowList:zu,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,0],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},ip={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class np extends hh{constructor(e,t){super(e,t),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return tp}static get DefaultType(){return ip}static get NAME(){return"tooltip"}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout),ih.off(this._element.closest(Xu),Zu,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if("none"===this._element.style.display)throw new Error("Please use show on visible elements");if(!this._isWithContent()||!this._isEnabled)return;const e=ih.trigger(this._element,this.constructor.eventName("show")),t=(Dc(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!t)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:n}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(n.append(i),ih.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(i),i.classList.add(Ku),"ontouchstart"in document.documentElement)for(const e of[].concat(...document.body.children))ih.on(e,"mouseover",jc);this._queueCallback((()=>{ih.trigger(this._element,this.constructor.eventName("shown")),!1===this._isHovered&&this._leave(),this._isHovered=!1}),this.tip,this._isAnimated())}hide(){if(this._isShown()&&!ih.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove(Ku),"ontouchstart"in document.documentElement)for(const e of[].concat(...document.body.children))ih.off(e,"mouseover",jc);this._activeTrigger.click=!1,this._activeTrigger[Ju]=!1,this._activeTrigger[Qu]=!1,this._isHovered=null,this._queueCallback((()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),ih.trigger(this._element,this.constructor.eventName("hidden")))}),this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return Boolean(this._getTitle())}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const t=this._getTemplateFactory(e).toHtml();if(!t)return null;t.classList.remove(Gu,Ku),t.classList.add(`bs-${this.constructor.NAME}-auto`);const i=(e=>{do{e+=Math.floor(1e6*Math.random())}while(document.getElementById(e));return e})(this.constructor.NAME).toString();return t.setAttribute("id",i),this._isAnimated()&&t.classList.add(Gu),t}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new Uu({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[Yu]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Gu)}_isShown(){return this.tip&&this.tip.classList.contains(Ku)}_createPopper(e){const t="function"==typeof this._config.placement?this._config.placement.call(this,e,this._element):this._config.placement,i=ep[t.toUpperCase()];return yc(this._element,e,this._getPopperConfig(i))}_getOffset(){const{offset:e}=this._config;return"string"==typeof e?e.split(",").map((e=>Number.parseInt(e,10))):"function"==typeof e?t=>e(t,this._element):e}_resolvePossibleFunction(e){return"function"==typeof e?e.call(this._element):e}_getPopperConfig(e){const t={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:e=>{this._getTipElement().setAttribute("data-popper-placement",e.state.placement)}}]};return{...t,..."function"==typeof this._config.popperConfig?this._config.popperConfig(t):this._config.popperConfig}}_setListeners(){const e=this._config.trigger.split(" ");for(const t of e)if("click"===t)ih.on(this._element,this.constructor.eventName("click"),this._config.selector,(e=>{this._initializeOnDelegatedTarget(e).toggle()}));else if("manual"!==t){const e=t===Qu?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),i=t===Qu?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");ih.on(this._element,e,this._config.selector,(e=>{const t=this._initializeOnDelegatedTarget(e);t._activeTrigger["focusin"===e.type?Ju:Qu]=!0,t._enter()})),ih.on(this._element,i,this._config.selector,(e=>{const t=this._initializeOnDelegatedTarget(e);t._activeTrigger["focusout"===e.type?Ju:Qu]=t._element.contains(e.relatedTarget),t._leave()}))}this._hideModalHandler=()=>{this._element&&this.hide()},ih.on(this._element.closest(Xu),Zu,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout((()=>{this._isHovered&&this.show()}),this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout((()=>{this._isHovered||this.hide()}),this._config.delay.hide))}_setTimeout(e,t){clearTimeout(this._timeout),this._timeout=setTimeout(e,t)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const t=lh.getDataAttributes(this._element);for(const e of Object.keys(t))qu.has(e)&&delete t[e];return e={...t,..."object"==typeof e&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=!1===e.container?document.body:Oc(e.container),"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),"number"==typeof e.title&&(e.title=e.title.toString()),"number"==typeof e.content&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const t in this._config)this.constructor.Default[t]!==this._config[t]&&(e[t]=this._config[t]);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each((function(){const t=np.getOrCreateInstance(this,e);if("string"==typeof e){if(void 0===t[e])throw new TypeError(`No method named "${e}"`);t[e]()}}))}}Nc(np);const sp=".popover-header",rp=".popover-body",op={...np.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},ap={...np.DefaultType,content:"(null|string|element|function)"};class lp extends np{static get Default(){return op}static get DefaultType(){return ap}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[sp]:this._getTitle(),[rp]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each((function(){const t=lp.getOrCreateInstance(this,e);if("string"==typeof e){if(void 0===t[e])throw new TypeError(`No method named "${e}"`);t[e]()}}))}}Nc(lp);const cp=".bs.scrollspy",hp=`activate${cp}`,dp=`click${cp}`,up=`load${cp}.data-api`,pp="active",fp="[href]",mp=".nav-link",gp=`${mp}, .nav-item > ${mp}, .list-group-item`,vp={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},_p={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class bp extends hh{constructor(e,t){super(e,t),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement="visible"===getComputedStyle(this._element).overflowY?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return vp}static get DefaultType(){return _p}static get NAME(){return"scrollspy"}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=Oc(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,"string"==typeof e.threshold&&(e.threshold=e.threshold.split(",").map((e=>Number.parseFloat(e)))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(ih.off(this._config.target,dp),ih.on(this._config.target,dp,fp,(e=>{const t=this._observableSections.get(e.target.hash);if(t){e.preventDefault();const i=this._rootElement||window,n=t.offsetTop-this._element.offsetTop;if(i.scrollTo)return void i.scrollTo({top:n,behavior:"smooth"});i.scrollTop=n}})))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver((e=>this._observerCallback(e)),e)}_observerCallback(e){const t=e=>this._targetLinks.get(`#${e.target.id}`),i=e=>{this._previousScrollData.visibleEntryTop=e.target.offsetTop,this._process(t(e))},n=(this._rootElement||document.documentElement).scrollTop,s=n>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=n;for(const r of e){if(!r.isIntersecting){this._activeTarget=null,this._clearActiveClass(t(r));continue}const e=r.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(s&&e){if(i(r),!n)return}else s||e||i(r)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=_h.find(fp,this._config.target);for(const t of e){if(!t.hash||kc(t))continue;const e=_h.findOne(t.hash,this._element);Ic(e)&&(this._targetLinks.set(t.hash,t),this._observableSections.set(t.hash,e))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(pp),this._activateParents(e),ih.trigger(this._element,hp,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains("dropdown-item"))_h.findOne(".dropdown-toggle",e.closest(".dropdown")).classList.add(pp);else for(const t of _h.parents(e,".nav, .list-group"))for(const e of _h.prev(t,gp))e.classList.add(pp)}_clearActiveClass(e){e.classList.remove(pp);const t=_h.find(`${fp}.${pp}`,e);for(const e of t)e.classList.remove(pp)}static jQueryInterface(e){return this.each((function(){const t=bp.getOrCreateInstance(this,e);if("string"==typeof e){if(void 0===t[e]||e.startsWith("_")||"constructor"===e)throw new TypeError(`No method named "${e}"`);t[e]()}}))}}ih.on(window,up,(()=>{for(const e of _h.find('[data-bs-spy="scroll"]'))bp.getOrCreateInstance(e)})),Nc(bp);const yp=".bs.tab",Cp=`hide${yp}`,wp=`hidden${yp}`,Sp=`show${yp}`,Ep=`shown${yp}`,xp=`click${yp}`,Tp=`keydown${yp}`,Ap=`load${yp}`,Op="ArrowLeft",Ip="ArrowRight",kp="ArrowUp",Dp="ArrowDown",jp="active",Rp="fade",Lp="show",Mp=":not(.dropdown-toggle)",Pp='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Np=`.nav-link${Mp}, .list-group-item${Mp}, [role="tab"]${Mp}, ${Pp}`,Fp=`.${jp}[data-bs-toggle="tab"], .${jp}[data-bs-toggle="pill"], .${jp}[data-bs-toggle="list"]`;class Hp extends hh{constructor(e){super(e),this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),ih.on(this._element,Tp,(e=>this._keydown(e))))}static get NAME(){return"tab"}show(){const e=this._element;if(this._elemIsActive(e))return;const t=this._getActiveElem(),i=t?ih.trigger(t,Cp,{relatedTarget:e}):null;ih.trigger(e,Sp,{relatedTarget:t}).defaultPrevented||i&&i.defaultPrevented||(this._deactivate(t,e),this._activate(e,t))}_activate(e,t){e&&(e.classList.add(jp),this._activate(xc(e)),this._queueCallback((()=>{"tab"===e.getAttribute("role")?(e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),ih.trigger(e,Ep,{relatedTarget:t})):e.classList.add(Lp)}),e,e.classList.contains(Rp)))}_deactivate(e,t){e&&(e.classList.remove(jp),e.blur(),this._deactivate(xc(e)),this._queueCallback((()=>{"tab"===e.getAttribute("role")?(e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),ih.trigger(e,wp,{relatedTarget:t})):e.classList.remove(Lp)}),e,e.classList.contains(Rp)))}_keydown(e){if(![Op,Ip,kp,Dp].includes(e.key))return;e.stopPropagation(),e.preventDefault();const t=[Ip,Dp].includes(e.key),i=Bc(this._getChildren().filter((e=>!kc(e))),e.target,t,!0);i&&(i.focus({preventScroll:!0}),Hp.getOrCreateInstance(i).show())}_getChildren(){return _h.find(Np,this._parent)}_getActiveElem(){return this._getChildren().find((e=>this._elemIsActive(e)))||null}_setInitialAttributes(e,t){this._setAttributeIfNotExists(e,"role","tablist");for(const e of t)this._setInitialAttributesOnChild(e)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const t=this._elemIsActive(e),i=this._getOuterElement(e);e.setAttribute("aria-selected",t),i!==e&&this._setAttributeIfNotExists(i,"role","presentation"),t||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const t=xc(e);t&&(this._setAttributeIfNotExists(t,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(t,"aria-labelledby",`#${e.id}`))}_toggleDropDown(e,t){const i=this._getOuterElement(e);if(!i.classList.contains("dropdown"))return;const n=(e,n)=>{const s=_h.findOne(e,i);s&&s.classList.toggle(n,t)};n(".dropdown-toggle",jp),n(".dropdown-menu",Lp),i.setAttribute("aria-expanded",t)}_setAttributeIfNotExists(e,t,i){e.hasAttribute(t)||e.setAttribute(t,i)}_elemIsActive(e){return e.classList.contains(jp)}_getInnerElement(e){return e.matches(Np)?e:_h.findOne(Np,e)}_getOuterElement(e){return e.closest(".nav-item, .list-group-item")||e}static jQueryInterface(e){return this.each((function(){const t=Hp.getOrCreateInstance(this);if("string"==typeof e){if(void 0===t[e]||e.startsWith("_")||"constructor"===e)throw new TypeError(`No method named "${e}"`);t[e]()}}))}}ih.on(document,xp,Pp,(function(e){["A","AREA"].includes(this.tagName)&&e.preventDefault(),kc(this)||Hp.getOrCreateInstance(this).show()})),ih.on(window,Ap,(()=>{for(const e of _h.find(Fp))Hp.getOrCreateInstance(e)})),Nc(Hp);const Bp=".bs.toast",zp=`mouseover${Bp}`,Vp=`mouseout${Bp}`,Wp=`focusin${Bp}`,$p=`focusout${Bp}`,Up=`hide${Bp}`,qp=`hidden${Bp}`,Gp=`show${Bp}`,Kp=`shown${Bp}`,Yp="hide",Xp="show",Zp="showing",Qp={animation:"boolean",autohide:"boolean",delay:"number"},Jp={animation:!0,autohide:!0,delay:5e3};class ef extends hh{constructor(e,t){super(e,t),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return Jp}static get DefaultType(){return Qp}static get NAME(){return"toast"}show(){ih.trigger(this._element,Gp).defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove(Yp),Rc(this._element),this._element.classList.add(Xp,Zp),this._queueCallback((()=>{this._element.classList.remove(Zp),ih.trigger(this._element,Kp),this._maybeScheduleHide()}),this._element,this._config.animation))}hide(){this.isShown()&&(ih.trigger(this._element,Up).defaultPrevented||(this._element.classList.add(Zp),this._queueCallback((()=>{this._element.classList.add(Yp),this._element.classList.remove(Zp,Xp),ih.trigger(this._element,qp)}),this._element,this._config.animation)))}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Xp),super.dispose()}isShown(){return this._element.classList.contains(Xp)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout((()=>{this.hide()}),this._config.delay)))}_onInteraction(e,t){switch(e.type){case"mouseover":case"mouseout":this._hasMouseInteraction=t;break;case"focusin":case"focusout":this._hasKeyboardInteraction=t}if(t)return void this._clearTimeout();const i=e.relatedTarget;this._element===i||this._element.contains(i)||this._maybeScheduleHide()}_setListeners(){ih.on(this._element,zp,(e=>this._onInteraction(e,!0))),ih.on(this._element,Vp,(e=>this._onInteraction(e,!1))),ih.on(this._element,Wp,(e=>this._onInteraction(e,!0))),ih.on(this._element,$p,(e=>this._onInteraction(e,!1)))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each((function(){const t=ef.getOrCreateInstance(this,e);if("string"==typeof e){if(void 0===t[e])throw new TypeError(`No method named "${e}"`);t[e](this)}}))}}dh(ef),Nc(ef);var tf=__webpack_require__(692),nf=__webpack_require__.n(tf),sf=__webpack_require__(744);const rf=Symbol.for("Dexie"),of=globalThis[rf]||(globalThis[rf]=sf);if(sf.semVer!==of.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${sf.semVer} and ${of.semVer}`);const{liveQuery:af,mergeRanges:lf,rangesOverlap:cf,RangeSet:hf,cmp:df,Entity:uf,PropModSymbol:pf,PropModification:ff,replacePrefix:mf,add:gf,remove:vf}=of,_f=of;var bf=__webpack_require__(189),yf=__webpack_require__.n(bf);const{entries:Cf,setPrototypeOf:wf,isFrozen:Sf,getPrototypeOf:Ef,getOwnPropertyDescriptor:xf}=Object;let{freeze:Tf,seal:Af,create:Of}=Object,{apply:If,construct:kf}="undefined"!=typeof Reflect&&Reflect;Tf||(Tf=function(e){return e}),Af||(Af=function(e){return e}),If||(If=function(e,t,i){return e.apply(t,i)}),kf||(kf=function(e,t){return new e(...t)});const Df=$f(Array.prototype.forEach),jf=$f(Array.prototype.pop),Rf=$f(Array.prototype.push),Lf=$f(String.prototype.toLowerCase),Mf=$f(String.prototype.toString),Pf=$f(String.prototype.match),Nf=$f(String.prototype.replace),Ff=$f(String.prototype.indexOf),Hf=$f(String.prototype.trim),Bf=$f(Object.prototype.hasOwnProperty),zf=$f(RegExp.prototype.test),Vf=(Wf=TypeError,function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return kf(Wf,t)});var Wf;function $f(e){return function(t){for(var i=arguments.length,n=new Array(i>1?i-1:0),s=1;s<i;s++)n[s-1]=arguments[s];return If(e,t,n)}}function Uf(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Lf;wf&&wf(e,null);let n=t.length;for(;n--;){let s=t[n];if("string"==typeof s){const e=i(s);e!==s&&(Sf(t)||(t[n]=e),s=e)}e[s]=!0}return e}function qf(e){for(let t=0;t<e.length;t++)Bf(e,t)||(e[t]=null);return e}function Gf(e){const t=Of(null);for(const[i,n]of Cf(e))Bf(e,i)&&(Array.isArray(n)?t[i]=qf(n):n&&"object"==typeof n&&n.constructor===Object?t[i]=Gf(n):t[i]=n);return t}function Kf(e,t){for(;null!==e;){const i=xf(e,t);if(i){if(i.get)return $f(i.get);if("function"==typeof i.value)return $f(i.value)}e=Ef(e)}return function(){return null}}const Yf=Tf(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Xf=Tf(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Zf=Tf(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Qf=Tf(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Jf=Tf(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),em=Tf(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),tm=Tf(["#text"]),im=Tf(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),nm=Tf(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),sm=Tf(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),rm=Tf(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),om=Af(/\{\{[\w\W]*|[\w\W]*\}\}/gm),am=Af(/<%[\w\W]*|[\w\W]*%>/gm),lm=Af(/\${[\w\W]*}/gm),cm=Af(/^data-[\-\w.\u00B7-\uFFFF]/),hm=Af(/^aria-[\-\w]+$/),dm=Af(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),um=Af(/^(?:\w+script|data):/i),pm=Af(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),fm=Af(/^html$/i),mm=Af(/^[a-z][.\w]*(-[.\w]+)+$/i);var gm=Object.freeze({__proto__:null,ARIA_ATTR:hm,ATTR_WHITESPACE:pm,CUSTOM_ELEMENT:mm,DATA_ATTR:cm,DOCTYPE_NAME:fm,ERB_EXPR:am,IS_ALLOWED_URI:dm,IS_SCRIPT_OR_DATA:um,MUSTACHE_EXPR:om,TMPLIT_EXPR:lm});const vm=function(){return"undefined"==typeof window?null:window};var _m=function e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vm();const i=t=>e(t);if(i.version="3.2.0",i.removed=[],!t||!t.document||9!==t.document.nodeType)return i.isSupported=!1,i;let{document:n}=t;const s=n,r=s.currentScript,{DocumentFragment:o,HTMLTemplateElement:a,Node:l,Element:c,NodeFilter:h,NamedNodeMap:d=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:u,DOMParser:p,trustedTypes:f}=t,m=c.prototype,g=Kf(m,"cloneNode"),v=Kf(m,"remove"),_=Kf(m,"nextSibling"),b=Kf(m,"childNodes"),y=Kf(m,"parentNode");if("function"==typeof a){const e=n.createElement("template");e.content&&e.content.ownerDocument&&(n=e.content.ownerDocument)}let C,w="";const{implementation:S,createNodeIterator:E,createDocumentFragment:x,getElementsByTagName:T}=n,{importNode:A}=s;let O={};i.isSupported="function"==typeof Cf&&"function"==typeof y&&S&&void 0!==S.createHTMLDocument;const{MUSTACHE_EXPR:I,ERB_EXPR:k,TMPLIT_EXPR:D,DATA_ATTR:j,ARIA_ATTR:R,IS_SCRIPT_OR_DATA:L,ATTR_WHITESPACE:M,CUSTOM_ELEMENT:P}=gm;let{IS_ALLOWED_URI:N}=gm,F=null;const H=Uf({},[...Yf,...Xf,...Zf,...Jf,...tm]);let B=null;const z=Uf({},[...im,...nm,...sm,...rm]);let V=Object.seal(Of(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),W=null,$=null,U=!0,q=!0,G=!1,K=!0,Y=!1,X=!0,Z=!1,Q=!1,J=!1,ee=!1,te=!1,ie=!1,ne=!0,se=!1,re=!0,oe=!1,ae={},le=null;const ce=Uf({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let he=null;const de=Uf({},["audio","video","img","source","image","track"]);let ue=null;const pe=Uf({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),fe="http://www.w3.org/1998/Math/MathML",me="http://www.w3.org/2000/svg",ge="http://www.w3.org/1999/xhtml";let ve=ge,_e=!1,be=null;const ye=Uf({},[fe,me,ge],Mf);let Ce=Uf({},["mi","mo","mn","ms","mtext"]),we=Uf({},["annotation-xml"]);const Se=Uf({},["title","style","font","a","script"]);let Ee=null;const xe=["application/xhtml+xml","text/html"];let Te=null,Ae=null;const Oe=n.createElement("form"),Ie=function(e){return e instanceof RegExp||e instanceof Function},ke=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!Ae||Ae!==e){if(e&&"object"==typeof e||(e={}),e=Gf(e),Ee=-1===xe.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,Te="application/xhtml+xml"===Ee?Mf:Lf,F=Bf(e,"ALLOWED_TAGS")?Uf({},e.ALLOWED_TAGS,Te):H,B=Bf(e,"ALLOWED_ATTR")?Uf({},e.ALLOWED_ATTR,Te):z,be=Bf(e,"ALLOWED_NAMESPACES")?Uf({},e.ALLOWED_NAMESPACES,Mf):ye,ue=Bf(e,"ADD_URI_SAFE_ATTR")?Uf(Gf(pe),e.ADD_URI_SAFE_ATTR,Te):pe,he=Bf(e,"ADD_DATA_URI_TAGS")?Uf(Gf(de),e.ADD_DATA_URI_TAGS,Te):de,le=Bf(e,"FORBID_CONTENTS")?Uf({},e.FORBID_CONTENTS,Te):ce,W=Bf(e,"FORBID_TAGS")?Uf({},e.FORBID_TAGS,Te):{},$=Bf(e,"FORBID_ATTR")?Uf({},e.FORBID_ATTR,Te):{},ae=!!Bf(e,"USE_PROFILES")&&e.USE_PROFILES,U=!1!==e.ALLOW_ARIA_ATTR,q=!1!==e.ALLOW_DATA_ATTR,G=e.ALLOW_UNKNOWN_PROTOCOLS||!1,K=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,Y=e.SAFE_FOR_TEMPLATES||!1,X=!1!==e.SAFE_FOR_XML,Z=e.WHOLE_DOCUMENT||!1,ee=e.RETURN_DOM||!1,te=e.RETURN_DOM_FRAGMENT||!1,ie=e.RETURN_TRUSTED_TYPE||!1,J=e.FORCE_BODY||!1,ne=!1!==e.SANITIZE_DOM,se=e.SANITIZE_NAMED_PROPS||!1,re=!1!==e.KEEP_CONTENT,oe=e.IN_PLACE||!1,N=e.ALLOWED_URI_REGEXP||dm,ve=e.NAMESPACE||ge,Ce=e.MATHML_TEXT_INTEGRATION_POINTS||Ce,we=e.HTML_INTEGRATION_POINTS||we,V=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&Ie(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(V.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&Ie(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(V.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(V.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Y&&(q=!1),te&&(ee=!0),ae&&(F=Uf({},tm),B=[],!0===ae.html&&(Uf(F,Yf),Uf(B,im)),!0===ae.svg&&(Uf(F,Xf),Uf(B,nm),Uf(B,rm)),!0===ae.svgFilters&&(Uf(F,Zf),Uf(B,nm),Uf(B,rm)),!0===ae.mathMl&&(Uf(F,Jf),Uf(B,sm),Uf(B,rm))),e.ADD_TAGS&&(F===H&&(F=Gf(F)),Uf(F,e.ADD_TAGS,Te)),e.ADD_ATTR&&(B===z&&(B=Gf(B)),Uf(B,e.ADD_ATTR,Te)),e.ADD_URI_SAFE_ATTR&&Uf(ue,e.ADD_URI_SAFE_ATTR,Te),e.FORBID_CONTENTS&&(le===ce&&(le=Gf(le)),Uf(le,e.FORBID_CONTENTS,Te)),re&&(F["#text"]=!0),Z&&Uf(F,["html","head","body"]),F.table&&(Uf(F,["tbody"]),delete W.tbody),e.TRUSTED_TYPES_POLICY){if("function"!=typeof e.TRUSTED_TYPES_POLICY.createHTML)throw Vf('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw Vf('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');C=e.TRUSTED_TYPES_POLICY,w=C.createHTML("")}else void 0===C&&(C=function(e,t){if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let i=null;const n="data-tt-policy-suffix";t&&t.hasAttribute(n)&&(i=t.getAttribute(n));const s="dompurify"+(i?"#"+i:"");try{return e.createPolicy(s,{createHTML:e=>e,createScriptURL:e=>e})}catch(e){return console.warn("TrustedTypes policy "+s+" could not be created."),null}}(f,r)),null!==C&&"string"==typeof w&&(w=C.createHTML(""));Tf&&Tf(e),Ae=e}},De=Uf({},[...Xf,...Zf,...Qf]),je=Uf({},[...Jf,...em]),Re=function(e){Rf(i.removed,{element:e});try{y(e).removeChild(e)}catch(t){v(e)}},Le=function(e,t){try{Rf(i.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){Rf(i.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!B[e])if(ee||te)try{Re(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},Me=function(e){let t=null,i=null;if(J)e="<remove></remove>"+e;else{const t=Pf(e,/^[\r\n\t ]+/);i=t&&t[0]}"application/xhtml+xml"===Ee&&ve===ge&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const s=C?C.createHTML(e):e;if(ve===ge)try{t=(new p).parseFromString(s,Ee)}catch(e){}if(!t||!t.documentElement){t=S.createDocument(ve,"template",null);try{t.documentElement.innerHTML=_e?w:s}catch(e){}}const r=t.body||t.documentElement;return e&&i&&r.insertBefore(n.createTextNode(i),r.childNodes[0]||null),ve===ge?T.call(t,Z?"html":"body")[0]:Z?t.documentElement:r},Pe=function(e){return E.call(e.ownerDocument||e,e,h.SHOW_ELEMENT|h.SHOW_COMMENT|h.SHOW_TEXT|h.SHOW_PROCESSING_INSTRUCTION|h.SHOW_CDATA_SECTION,null)},Ne=function(e){return e instanceof u&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof d)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},Fe=function(e){return"function"==typeof l&&e instanceof l};function He(e,t,n){O[e]&&Df(O[e],(e=>{e.call(i,t,n,Ae)}))}const Be=function(e){let t=null;if(He("beforeSanitizeElements",e,null),Ne(e))return Re(e),!0;const n=Te(e.nodeName);if(He("uponSanitizeElement",e,{tagName:n,allowedTags:F}),e.hasChildNodes()&&!Fe(e.firstElementChild)&&zf(/<[/\w]/g,e.innerHTML)&&zf(/<[/\w]/g,e.textContent))return Re(e),!0;if(7===e.nodeType)return Re(e),!0;if(X&&8===e.nodeType&&zf(/<[/\w]/g,e.data))return Re(e),!0;if(!F[n]||W[n]){if(!W[n]&&Ve(n)){if(V.tagNameCheck instanceof RegExp&&zf(V.tagNameCheck,n))return!1;if(V.tagNameCheck instanceof Function&&V.tagNameCheck(n))return!1}if(re&&!le[n]){const t=y(e)||e.parentNode,i=b(e)||e.childNodes;if(i&&t)for(let n=i.length-1;n>=0;--n){const s=g(i[n],!0);s.__removalCount=(e.__removalCount||0)+1,t.insertBefore(s,_(e))}}return Re(e),!0}return e instanceof c&&!function(e){let t=y(e);t&&t.tagName||(t={namespaceURI:ve,tagName:"template"});const i=Lf(e.tagName),n=Lf(t.tagName);return!!be[e.namespaceURI]&&(e.namespaceURI===me?t.namespaceURI===ge?"svg"===i:t.namespaceURI===fe?"svg"===i&&("annotation-xml"===n||Ce[n]):Boolean(De[i]):e.namespaceURI===fe?t.namespaceURI===ge?"math"===i:t.namespaceURI===me?"math"===i&&we[n]:Boolean(je[i]):e.namespaceURI===ge?!(t.namespaceURI===me&&!we[n])&&!(t.namespaceURI===fe&&!Ce[n])&&!je[i]&&(Se[i]||!De[i]):!("application/xhtml+xml"!==Ee||!be[e.namespaceURI]))}(e)?(Re(e),!0):"noscript"!==n&&"noembed"!==n&&"noframes"!==n||!zf(/<\/no(script|embed|frames)/i,e.innerHTML)?(Y&&3===e.nodeType&&(t=e.textContent,Df([I,k,D],(e=>{t=Nf(t,e," ")})),e.textContent!==t&&(Rf(i.removed,{element:e.cloneNode()}),e.textContent=t)),He("afterSanitizeElements",e,null),!1):(Re(e),!0)},ze=function(e,t,i){if(ne&&("id"===t||"name"===t)&&(i in n||i in Oe))return!1;if(q&&!$[t]&&zf(j,t));else if(U&&zf(R,t));else if(!B[t]||$[t]){if(!(Ve(e)&&(V.tagNameCheck instanceof RegExp&&zf(V.tagNameCheck,e)||V.tagNameCheck instanceof Function&&V.tagNameCheck(e))&&(V.attributeNameCheck instanceof RegExp&&zf(V.attributeNameCheck,t)||V.attributeNameCheck instanceof Function&&V.attributeNameCheck(t))||"is"===t&&V.allowCustomizedBuiltInElements&&(V.tagNameCheck instanceof RegExp&&zf(V.tagNameCheck,i)||V.tagNameCheck instanceof Function&&V.tagNameCheck(i))))return!1}else if(ue[t]);else if(zf(N,Nf(i,M,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==Ff(i,"data:")||!he[e])if(G&&!zf(L,Nf(i,M,"")));else if(i)return!1;return!0},Ve=function(e){return"annotation-xml"!==e&&Pf(e,P)},We=function(e){He("beforeSanitizeAttributes",e,null);const{attributes:t}=e;if(!t)return;const n={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:B,forceKeepAttr:void 0};let s=t.length;for(;s--;){const r=t[s],{name:o,namespaceURI:a,value:l}=r,c=Te(o);let h="value"===o?l:Hf(l);if(n.attrName=c,n.attrValue=h,n.keepAttr=!0,n.forceKeepAttr=void 0,He("uponSanitizeAttribute",e,n),h=n.attrValue,!se||"id"!==c&&"name"!==c||(Le(o,e),h="user-content-"+h),X&&zf(/((--!?|])>)|<\/(style|title)/i,h)){Le(o,e);continue}if(n.forceKeepAttr)continue;if(Le(o,e),!n.keepAttr)continue;if(!K&&zf(/\/>/i,h)){Le(o,e);continue}Y&&Df([I,k,D],(e=>{h=Nf(h,e," ")}));const d=Te(e.nodeName);if(ze(d,c,h)){if(C&&"object"==typeof f&&"function"==typeof f.getAttributeType)if(a);else switch(f.getAttributeType(d,c)){case"TrustedHTML":h=C.createHTML(h);break;case"TrustedScriptURL":h=C.createScriptURL(h)}try{a?e.setAttributeNS(a,o,h):e.setAttribute(o,h),Ne(e)?Re(e):jf(i.removed)}catch(e){}}}He("afterSanitizeAttributes",e,null)},$e=function e(t){let i=null;const n=Pe(t);for(He("beforeSanitizeShadowDOM",t,null);i=n.nextNode();)He("uponSanitizeShadowNode",i,null),Be(i)||(i.content instanceof o&&e(i.content),We(i));He("afterSanitizeShadowDOM",t,null)};return i.sanitize=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,r=null,a=null,c=null;if(_e=!e,_e&&(e="\x3c!--\x3e"),"string"!=typeof e&&!Fe(e)){if("function"!=typeof e.toString)throw Vf("toString is not a function");if("string"!=typeof(e=e.toString()))throw Vf("dirty is not a string, aborting")}if(!i.isSupported)return e;if(Q||ke(t),i.removed=[],"string"==typeof e&&(oe=!1),oe){if(e.nodeName){const t=Te(e.nodeName);if(!F[t]||W[t])throw Vf("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof l)n=Me("\x3c!----\x3e"),r=n.ownerDocument.importNode(e,!0),1===r.nodeType&&"BODY"===r.nodeName||"HTML"===r.nodeName?n=r:n.appendChild(r);else{if(!ee&&!Y&&!Z&&-1===e.indexOf("<"))return C&&ie?C.createHTML(e):e;if(n=Me(e),!n)return ee?null:ie?w:""}n&&J&&Re(n.firstChild);const h=Pe(oe?e:n);for(;a=h.nextNode();)Be(a)||(a.content instanceof o&&$e(a.content),We(a));if(oe)return e;if(ee){if(te)for(c=x.call(n.ownerDocument);n.firstChild;)c.appendChild(n.firstChild);else c=n;return(B.shadowroot||B.shadowrootmode)&&(c=A.call(s,c,!0)),c}let d=Z?n.outerHTML:n.innerHTML;return Z&&F["!doctype"]&&n.ownerDocument&&n.ownerDocument.doctype&&n.ownerDocument.doctype.name&&zf(fm,n.ownerDocument.doctype.name)&&(d="<!DOCTYPE "+n.ownerDocument.doctype.name+">\n"+d),Y&&Df([I,k,D],(e=>{d=Nf(d,e," ")})),C&&ie?C.createHTML(d):d},i.setConfig=function(){ke(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Q=!0},i.clearConfig=function(){Ae=null,Q=!1},i.isValidAttribute=function(e,t,i){Ae||ke({});const n=Te(e),s=Te(t);return ze(n,s,i)},i.addHook=function(e,t){"function"==typeof t&&(O[e]=O[e]||[],Rf(O[e],t))},i.removeHook=function(e){if(O[e])return jf(O[e])},i.removeHooks=function(e){O[e]&&(O[e]=[])},i.removeAllHooks=function(){O={}},i}(),bm=__webpack_require__(561),ym=__webpack_require__.n(bm),Cm=__webpack_require__(34).GoldenLayout,wm=__webpack_require__(140),Sm=__webpack_require__(668),Em=__webpack_require__(965),xm={GoldenLayout:Cm,Terminal:c.Terminal,FitAddon:h.FitAddon,download:wm,Slicker:Ua,$:nf(),bootstrap:a,pako:Sm,Dexie:_f,DiffMatchPatch:yf(),DOMPurify:_m,Mustache:Em,jspreadsheet:ym()};"undefined"!=typeof window&&(window.ide_dep=xm,window.$=nf())})()})();